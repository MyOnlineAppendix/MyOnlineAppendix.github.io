<h3 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFWorkbook (33 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(9)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56957CloseWorkbook() throws Exception {
  File file=TempFile.createTempFile("TestBug56957_",".xlsx");
  final Date dateExp=LocaleUtil.getLocaleCalendar(2014,10,9).getTime();
  try {
    FileHelper.copyFile(HSSFTestDataSamples.getSampleFile("56957.xlsx"),file);
    assertTrue(file.exists());
    Workbook workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ));
    Date dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ_WRITE));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ_WRITE));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
  }
  finally {
    assertTrue(file.exists());
    assertTrue(file.delete());
  }
}

</code></pre>

<pre class="type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void getFontAt() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    StylesTable styleSource=workbook.getStylesSource();
    short i=0;
    Font fontAt=workbook.getFontAt(i);
    assertNotNull(fontAt);
    XSSFFont customFont=new XSSFFont();
    customFont.setItalic(true);
    int x=styleSource.putFont(customFont);
    fontAt=workbook.getFontAt((short)x);
    assertNotNull(fontAt);
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-2 type-1 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the attached test data was not modified. If this test method
 * fails, the test data is not working properly.
 */
@Test public void bug47668() throws Exception {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("47668.xlsx");
  List<XSSFPictureData> allPictures=workbook.getAllPictures();
  assertEquals(1,allPictures.size());
  PackagePartName imagePartName=PackagingURIHelper.createPartName("/xl/media/image1.jpeg");
  PackagePart imagePart=workbook.getPackage().getPart(imagePartName);
  assertNotNull(imagePart);
  for (  XSSFPictureData pictureData : allPictures) {
    PackagePart picturePart=pictureData.getPackagePart();
    assertSame(imagePart,picturePart);
  }
  XSSFSheet sheet0=workbook.getSheetAt(0);
  XSSFDrawing drawing0=sheet0.createDrawingPatriarch();
  XSSFPictureData pictureData0=(XSSFPictureData)drawing0.getRelations().get(0);
  byte[] data0=pictureData0.getData();
  CRC32 crc0=new CRC32();
  crc0.update(data0);
  XSSFSheet sheet1=workbook.getSheetAt(1);
  XSSFDrawing drawing1=sheet1.createDrawingPatriarch();
  XSSFPictureData pictureData1=(XSSFPictureData)drawing1.getRelations().get(0);
  byte[] data1=pictureData1.getData();
  CRC32 crc1=new CRC32();
  crc1.update(data1);
  assertEquals(crc0.getValue(),crc1.getValue());
  workbook.close();
}

</code></pre>

<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLoadWorkbookWithPivotTable() throws Exception {
  File file=TempFile.createTempFile("ooxml-pivottable",".xlsx");
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    setPivotData(wb);
    FileOutputStream fileOut=new FileOutputStream(file);
    wb.write(fileOut);
    fileOut.close();
  }
  finally {
    wb.close();
  }
  XSSFWorkbook wb2=(XSSFWorkbook)WorkbookFactory.create(file);
  try {
    assertTrue(wb2.getPivotTables().size() == 1);
  }
  finally {
    wb2.close();
  }
  assertTrue(file.delete());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bug47090c() throws IOException {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("47090.xlsx");
  assertSheetOrder(workbook,"Sheet1","Sheet2");
  workbook.removeSheetAt(0);
  assertSheetOrder(workbook,"Sheet2");
  workbook.cloneSheet(0);
  assertSheetOrder(workbook,"Sheet2","Sheet2 (2)");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertSheetOrder(read,"Sheet2","Sheet2 (2)");
  read.close();
  workbook.close();
}

</code></pre>

<pre class="type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void getCellStyleAt() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    short i=0;
    CellStyle cellStyleAt=workbook.getCellStyleAt(i);
    assertNotNull(cellStyleAt);
    StylesTable styleSource=workbook.getStylesSource();
    XSSFCellStyle customStyle=new XSSFCellStyle(styleSource);
    XSSFFont font=new XSSFFont();
    font.setFontName("Verdana");
    customStyle.setFont(font);
    int x=styleSource.putStyle(customStyle);
    cellStyleAt=workbook.getCellStyleAt((short)x);
    assertNotNull(cellStyleAt);
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void columnWidthPOI52233() throws Exception {
  XSSFWorkbook workbook=new XSSFWorkbook();
  XSSFSheet sheet=workbook.createSheet();
  XSSFRow row=sheet.createRow(0);
  XSSFCell cell=row.createCell(0);
  cell.setCellValue("hello world");
  sheet=workbook.createSheet();
  sheet.setColumnWidth(4,5000);
  sheet.setColumnWidth(5,5000);
  sheet.groupColumn((short)4,(short)5);
  accessWorkbook(workbook);
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  try {
    workbook.write(stream);
  }
  finally {
    stream.close();
  }
  accessWorkbook(workbook);
  workbook.close();
}

</code></pre>

<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testAddPivotTableToWorkbookWithLoadedPivotTable() throws Exception {
  File file=TempFile.createTempFile("ooxml-pivottable",".xlsx");
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    setPivotData(wb);
    FileOutputStream fileOut=new FileOutputStream(file);
    try {
      wb.write(fileOut);
    }
  finally {
      fileOut.close();
    }
  }
  finally {
    wb.close();
  }
  XSSFWorkbook wb2=(XSSFWorkbook)WorkbookFactory.create(file);
  try {
    setPivotData(wb2);
    assertTrue(wb2.getPivotTables().size() == 2);
  }
  finally {
    wb2.close();
  }
  assertTrue(file.delete());
}

</code></pre>

<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can save, and then re-load a new document
 */
@Test public void saveLoadNew() throws IOException, InvalidFormatException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  CTWorkbookPr pr=wb1.getCTWorkbook().getWorkbookPr();
  assertNotNull(pr);
  assertTrue(pr.isSetDate1904());
  assertFalse("XSSF must use the 1900 date system",pr.getDate1904());
  Sheet sheet1=wb1.createSheet("sheet1");
  Sheet sheet2=wb1.createSheet("sheet2");
  wb1.createSheet("sheet3");
  RichTextString rts=wb1.getCreationHelper().createRichTextString("hello world");
  sheet1.createRow(0).createCell((short)0).setCellValue(1.2);
  sheet1.createRow(1).createCell((short)0).setCellValue(rts);
  sheet2.createRow(0);
  assertEquals(0,wb1.getSheetAt(0).getFirstRowNum());
  assertEquals(1,wb1.getSheetAt(0).getLastRowNum());
  assertEquals(0,wb1.getSheetAt(1).getFirstRowNum());
  assertEquals(0,wb1.getSheetAt(1).getLastRowNum());
  assertEquals(0,wb1.getSheetAt(2).getFirstRowNum());
  assertEquals(0,wb1.getSheetAt(2).getLastRowNum());
  File file=TempFile.createTempFile("poi-",".xlsx");
  OutputStream out=new FileOutputStream(file);
  wb1.write(out);
  out.close();
  OPCPackage pkg=OPCPackage.open(file.toString());
  PackagePart wbRelPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/_rels/workbook.xml.rels"));
  assertNotNull(wbRelPart);
  assertTrue(wbRelPart.isRelationshipPart());
  assertEquals(ContentTypes.RELATIONSHIPS_PART,wbRelPart.getContentType());
  PackagePart wbPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/workbook.xml"));
  assertTrue(wbPart.hasRelationships());
  assertEquals(5,wbPart.getRelationships().size());
  wb1.close();
  @SuppressWarnings("resource") XSSFWorkbook wb2=new XSSFWorkbook(pkg);
  assertEquals(3,wb2.getNumberOfSheets());
  assertNotNull(wb2.getSheetAt(0));
  assertNotNull(wb2.getSheetAt(1));
  assertNotNull(wb2.getSheetAt(2));
  assertNotNull(wb2.getSharedStringSource());
  assertNotNull(wb2.getStylesSource());
  assertEquals(0,wb2.getSheetAt(0).getFirstRowNum());
  assertEquals(1,wb2.getSheetAt(0).getLastRowNum());
  assertEquals(0,wb2.getSheetAt(1).getFirstRowNum());
  assertEquals(0,wb2.getSheetAt(1).getLastRowNum());
  assertEquals(0,wb2.getSheetAt(2).getFirstRowNum());
  assertEquals(0,wb2.getSheetAt(2).getLastRowNum());
  sheet1=wb2.getSheetAt(0);
  assertEquals(1.2,sheet1.getRow(0).getCell(0).getNumericCellValue(),0.0001);
  assertEquals("hello world",sheet1.getRow(1).getCell(0).getRichStringCellValue().getString());
  pkg.close();
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getNumCellStyles() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    assertEquals(1,workbook.getNumCellStyles());
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void changeSheetNameWithSharedFormulas() throws IOException {
  changeSheetNameWithSharedFormulas("shared_formulas.xlsx");
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @Override public void getSpreadsheetVersion() throws IOException {
  verifySpreadsheetVersion(SpreadsheetVersion.EXCEL2007);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bug47090d() throws IOException {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("47090.xlsx");
  assertSheetOrder(workbook,"Sheet1","Sheet2");
  workbook.createSheet();
  assertSheetOrder(workbook,"Sheet1","Sheet2","Sheet0");
  workbook.removeSheetAt(0);
  assertSheetOrder(workbook,"Sheet2","Sheet0");
  workbook.createSheet();
  assertSheetOrder(workbook,"Sheet2","Sheet0","Sheet1");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertSheetOrder(read,"Sheet2","Sheet0","Sheet1");
  read.close();
  workbook.close();
}

</code></pre>

<pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with the count of the number of styles
 * coming out wrong
 */
@Test public void bug49702() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  assertEquals(1,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  try {
    wb1.getCellStyleAt((short)1);
    fail("Shouldn't be able to get style at 1 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  CellStyle cs=wb1.createCellStyle();
  cs.setDataFormat((short)11);
  assertEquals(2,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  wb1.getCellStyleAt((short)1);
  try {
    wb1.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(2,nwb.getNumCellStyles());
  nwb.getCellStyleAt((short)0);
  nwb.getCellStyleAt((short)1);
  try {
    nwb.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.openSampleWorkbook("sample.xlsx");
  assertEquals(3,wb2.getNumCellStyles());
  wb2.getCellStyleAt((short)0);
  wb2.getCellStyleAt((short)1);
  wb2.getCellStyleAt((short)2);
  try {
    wb2.getCellStyleAt((short)3);
    fail("Shouldn't be able to get style at 3 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  wb2.close();
  wb1.close();
  nwb.close();
}

</code></pre>

<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test setting of core properties such as Title and Author
 * @throws IOException
 */
@Test public void workbookProperties() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    POIXMLProperties props=workbook.getProperties();
    assertNotNull(props);
    assertEquals("Apache POI",props.getExtendedProperties().getUnderlyingProperties().getApplication());
    PackagePropertiesPart opcProps=props.getCoreProperties().getUnderlyingProperties();
    assertNotNull(opcProps);
    opcProps.setTitleProperty("Testing Bugzilla #47460");
    assertEquals("Apache POI",opcProps.getCreatorProperty().getValue());
    opcProps.setCreatorProperty("poi-dev@poi.apache.org");
    XSSFWorkbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(workbook);
    assertEquals("Apache POI",wbBack.getProperties().getExtendedProperties().getUnderlyingProperties().getApplication());
    opcProps=wbBack.getProperties().getCoreProperties().getUnderlyingProperties();
    assertEquals("Testing Bugzilla #47460",opcProps.getTitleProperty().getValue());
    assertEquals("poi-dev@poi.apache.org",opcProps.getCreatorProperty().getValue());
    wbBack.close();
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void incrementSheetId() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    int sheetId=(int)wb.createSheet().sheet.getSheetId();
    assertEquals(1,sheetId);
    sheetId=(int)wb.createSheet().sheet.getSheetId();
    assertEquals(2,sheetId);
    XSSFWorkbook wbBack=XSSFTestDataSamples.openSampleWorkbook("47089.xlsm");
    try {
      int lastSheetId=(int)wbBack.getSheetAt(wbBack.getNumberOfSheets() - 1).sheet.getSheetId();
      sheetId=(int)wbBack.createSheet().sheet.getSheetId();
      assertEquals(lastSheetId + 1,sheetId);
    }
  finally {
      wbBack.close();
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void styles() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  StylesTable ss=wb1.getStylesSource();
  assertNotNull(ss);
  StylesTable st=ss;
  assertEquals(8,st.getNumDataFormats());
  assertEquals(2,st.getFonts().size());
  assertEquals(2,st.getFills().size());
  assertEquals(1,st.getBorders().size());
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 8,st.putNumberFormat("testFORMAT"));
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 8,st.putNumberFormat("testFORMAT"));
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 9,st.putNumberFormat("testFORMAT2"));
  assertEquals(10,st.getNumDataFormats());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  ss=wb2.getStylesSource();
  assertNotNull(ss);
  assertEquals(10,st.getNumDataFormats());
  assertEquals(2,st.getFonts().size());
  assertEquals(2,st.getFills().size());
  assertEquals(1,st.getBorders().size());
  wb2.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBug54399() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("54399.xlsx");
  for (int i=0; i < workbook.getNumberOfSheets(); i++) {
    workbook.setSheetName(i,"SheetRenamed" + (i + 1));
  }
  workbook.close();
}

</code></pre>

<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void bug48495() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("48495.xlsx");
  assertSheetOrder(wb,"Sheet1");
  Sheet sheet=wb.getSheetAt(0);
  sheet.shiftRows(2,sheet.getLastRowNum(),1,true,false);
  Row newRow=sheet.getRow(2);
  if (newRow == null)   newRow=sheet.createRow(2);
  newRow.createCell(0).setCellValue(" Another Header");
  wb.cloneSheet(0);
  assertSheetOrder(wb,"Sheet1","Sheet1 (2)");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertNotNull(read);
  assertSheetOrder(read,"Sheet1","Sheet1 (2)");
  read.close();
  wb.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetFirstVisibleTab_57373() throws IOException {
  Workbook wb=new XSSFWorkbook();
  try {
    wb.createSheet();
    Sheet sheet2=wb.createSheet();
    int idx2=wb.getSheetIndex(sheet2);
    Sheet sheet3=wb.createSheet();
    int idx3=wb.getSheetIndex(sheet3);
    for (int i=0; i < 30; i++) {
      wb.createSheet();
    }
    wb.setFirstVisibleTab(idx2);
    wb.setActiveSheet(idx3);
    assertEquals(idx2,wb.getFirstVisibleTab());
    assertEquals(idx3,wb.getActiveSheetIndex());
    Workbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
    sheet2=wbBack.getSheetAt(idx2);
    sheet3=wbBack.getSheetAt(idx3);
    assertEquals(idx2,wb.getFirstVisibleTab());
    assertEquals(idx3,wb.getActiveSheetIndex());
    wbBack.close();
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When deleting a sheet make sure that we adjust sheet indices of named ranges
 */
@Test public void bug47737() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("47737.xlsx");
  assertEquals(2,wb.getNumberOfNames());
  assertNotNull(wb.getCalculationChain());
  XSSFName nm0=wb.getNameAt(0);
  assertTrue(nm0.getCTName().isSetLocalSheetId());
  assertEquals(0,nm0.getCTName().getLocalSheetId());
  XSSFName nm1=wb.getNameAt(1);
  assertTrue(nm1.getCTName().isSetLocalSheetId());
  assertEquals(1,nm1.getCTName().getLocalSheetId());
  wb.removeSheetAt(0);
  assertEquals(1,wb.getNumberOfNames());
  XSSFName nm2=wb.getNameAt(0);
  assertTrue(nm2.getCTName().isSetLocalSheetId());
  assertEquals(0,nm2.getCTName().getLocalSheetId());
  assertNull(wb.getCalculationChain());
  wb.close();
}

</code></pre>

<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with XSSFWorkbook.removeSheetAt when workbook contains charts
 */
@Test public void bug47813() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47813.xlsx");
  assertEquals(3,wb1.getNumberOfSheets());
  assertNotNull(wb1.getCalculationChain());
  assertEquals("Numbers",wb1.getSheetName(0));
  assertEquals("Chart",wb1.getSheetName(1));
  assertTrue(wb1.getSheetAt(1) instanceof XSSFChartSheet);
  assertEquals("SomeJunk",wb1.getSheetName(2));
  wb1.removeSheetAt(2);
  assertEquals(2,wb1.getNumberOfSheets());
  assertNull(wb1.getCalculationChain());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(2,wb2.getNumberOfSheets());
  assertNull(wb2.getCalculationChain());
  assertEquals("Numbers",wb2.getSheetName(0));
  assertEquals("Chart",wb2.getSheetName(1));
  wb2.close();
  wb1.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void bug58245_XSSFSheetIterator() throws IOException {
  final XSSFWorkbook wb=new XSSFWorkbook();
  wb.createSheet();
  for (  XSSFSheet sh : (Iterable<XSSFSheet>)(Iterable<? extends Sheet>)wb) {
    sh.createRow(0);
  }
  for (  Sheet sh : wb) {
    sh.createRow(0);
  }
{
    Iterator<XSSFSheet> it=(Iterator<XSSFSheet>)(Iterator<? extends Sheet>)wb.iterator();
    XSSFSheet sh=it.next();
    sh.createRow(0);
  }
{
    @SuppressWarnings("deprecation") Iterator<XSSFSheet> it=wb.xssfSheetIterator();
    XSSFSheet sh=it.next();
    sh.createRow(0);
  }
{
    Iterator<Sheet> it=wb.iterator();
    Sheet sh=it.next();
    sh.createRow(0);
  }
  wb.close();
}

</code></pre>

<pre class="type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void existing() throws Exception {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  assertNotNull(workbook.getSharedStringSource());
  assertNotNull(workbook.getStylesSource());
  OPCPackage pkg=OPCPackage.open(HSSFTestDataSamples.openSampleFileStream("Formatting.xlsx"));
  PackagePart wbPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/workbook.xml"));
  assertTrue(wbPart.hasRelationships());
  assertEquals(6,wbPart.getRelationships().size());
  pkg.close();
  workbook.close();
}

</code></pre>

<pre class="type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void setTabColor() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sh=wb.createSheet();
    assertTrue(sh.getCTWorksheet().getSheetPr() == null || !sh.getCTWorksheet().getSheetPr().isSetTabColor());
    sh.setTabColor(IndexedColors.RED.index);
    assertTrue(sh.getCTWorksheet().getSheetPr().isSetTabColor());
    assertEquals(IndexedColors.RED.index,sh.getCTWorksheet().getSheetPr().getTabColor().getIndexed());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug51158() throws IOException {
  final XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("Test Sheet");
  XSSFRow row=sheet.createRow(2);
  XSSFCell cell=row.createCell(3);
  cell.setCellValue("test1");
  XSSFComment comment=sheet.createDrawingPatriarch().createCellComment(new XSSFClientAnchor());
  assertNotNull(comment);
  comment.setString("some comment");
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertNotNull(wb2);
  sheet=wb2.getSheetAt(0);
  row=sheet.getRow(2);
  assertEquals("test1",row.getCell(3).getStringCellValue());
  assertNull(row.getCell(4));
  cell=row.createCell(4);
  cell.setCellValue("test2");
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  assertNotNull(wb3);
  sheet=wb3.getSheetAt(0);
  row=sheet.getRow(2);
  assertEquals("test1",row.getCell(3).getStringCellValue());
  assertEquals("test2",row.getCell(4).getStringCellValue());
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug51158a() throws IOException {
  final XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    workbook.createSheet("Test Sheet");
    XSSFSheet sheetBack=workbook.getSheetAt(0);
    sheetBack.commit();
    if (sheetBack.getPackagePart() instanceof MemoryPackagePart) {
      ((MemoryPackagePart)sheetBack.getPackagePart()).clear();
    }
    sheetBack.commit();
    String str=new String(IOUtils.toByteArray(sheetBack.getPackagePart().getInputStream()),"UTF-8");
    assertEquals(1,countMatches(str,"<worksheet"));
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bug47090b() throws IOException {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("47090.xlsx");
  assertSheetOrder(workbook,"Sheet1","Sheet2");
  workbook.removeSheetAt(1);
  assertSheetOrder(workbook,"Sheet1");
  workbook.createSheet();
  assertSheetOrder(workbook,"Sheet1","Sheet0");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertSheetOrder(read,"Sheet1","Sheet0");
  read.close();
  workbook.close();
}

</code></pre>

<pre class="type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recalcId() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    assertFalse(wb.getForceFormulaRecalculation());
    CTWorkbook ctWorkbook=wb.getCTWorkbook();
    assertFalse(ctWorkbook.isSetCalcPr());
    wb.setForceFormulaRecalculation(true);
    CTCalcPr calcPr=ctWorkbook.getCalcPr();
    assertNotNull(calcPr);
    assertEquals(0,(int)calcPr.getCalcId());
    calcPr.setCalcId(100);
    assertTrue(wb.getForceFormulaRecalculation());
    wb.setForceFormulaRecalculation(true);
    assertEquals(0,(int)calcPr.getCalcId());
    assertFalse(wb.getForceFormulaRecalculation());
    calcPr.setCalcMode(STCalcMode.MANUAL);
    wb.setForceFormulaRecalculation(true);
    assertEquals(STCalcMode.AUTO,calcPr.getCalcMode());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bug47090a() throws IOException {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("47090.xlsx");
  assertSheetOrder(workbook,"Sheet1","Sheet2");
  workbook.removeSheetAt(0);
  assertSheetOrder(workbook,"Sheet2");
  workbook.createSheet();
  assertSheetOrder(workbook,"Sheet2","Sheet1");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertSheetOrder(read,"Sheet2","Sheet1");
  read.close();
  workbook.close();
}

</code></pre>

<pre class="type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPivotCache() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    CTWorkbook ctWb=wb.getCTWorkbook();
    CTPivotCache pivotCache=wb.addPivotCache("0");
    assertTrue(ctWb.isSetPivotCaches());
    assertSame(pivotCache,ctWb.getPivotCaches().getPivotCacheArray(0));
    assertEquals("0",pivotCache.getId());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void loadSave() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  assertEquals(3,workbook.getNumberOfSheets());
  assertEquals("dd/mm/yyyy",workbook.getSheetAt(0).getRow(1).getCell(0).getRichStringCellValue().getString());
  assertNotNull(workbook.getSharedStringSource());
  assertNotNull(workbook.getStylesSource());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertEquals(3,wb2.getNumberOfSheets());
  assertNotNull(wb2.getSheetAt(0));
  assertNotNull(wb2.getSheetAt(1));
  assertNotNull(wb2.getSheetAt(2));
  assertEquals("dd/mm/yyyy",wb2.getSheetAt(0).getRow(1).getCell(0).getRichStringCellValue().getString());
  assertEquals("yyyy/mm/dd",wb2.getSheetAt(0).getRow(2).getCell(0).getRichStringCellValue().getString());
  assertEquals("yyyy-mm-dd",wb2.getSheetAt(0).getRow(3).getCell(0).getRichStringCellValue().getString());
  assertEquals("yy/mm/dd",wb2.getSheetAt(0).getRow(4).getCell(0).getRichStringCellValue().getString());
  assertNotNull(wb2.getSharedStringSource());
  assertNotNull(wb2.getStylesSource());
  workbook.close();
  wb2.close();
}

</code></pre>

<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can save a workbook with macros and reload it.
 */
@Test public void testSetVBAProject() throws Exception {
  File file;
  final byte[] allBytes=new byte[256];
  for (int i=0; i < 256; i++) {
    allBytes[i]=(byte)(i - 128);
  }
  XSSFWorkbook wb1=new XSSFWorkbook();
  wb1.createSheet();
  wb1.setVBAProject(new ByteArrayInputStream(allBytes));
  file=TempFile.createTempFile("poi-",".xlsm");
  OutputStream out=new FileOutputStream(file);
  wb1.write(out);
  out.close();
  wb1.close();
  OPCPackage pkg=OPCPackage.open(file.toString());
  PackagePart wbPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/workbook.xml"));
  assertTrue(wbPart.hasRelationships());
  final PackageRelationshipCollection relationships=wbPart.getRelationships().getRelationships(XSSFRelation.VBA_MACROS.getRelation());
  assertEquals(1,relationships.size());
  assertEquals(XSSFRelation.VBA_MACROS.getDefaultFileName(),relationships.getRelationship(0).getTargetURI().toString());
  PackagePart vbaPart=pkg.getPart(PackagingURIHelper.createPartName(XSSFRelation.VBA_MACROS.getDefaultFileName()));
  assertNotNull(vbaPart);
  assertFalse(vbaPart.isRelationshipPart());
  assertEquals(XSSFRelation.VBA_MACROS.getContentType(),vbaPart.getContentType());
  final byte[] fromFile=IOUtils.toByteArray(vbaPart.getInputStream());
  assertArrayEquals(allBytes,fromFile);
  @SuppressWarnings("resource") XSSFWorkbook wb2=new XSSFWorkbook(pkg);
  assertEquals(1,wb2.getNumberOfSheets());
  assertEquals(XSSFWorkbookType.XLSM,wb2.getWorkbookType());
  pkg.close();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
