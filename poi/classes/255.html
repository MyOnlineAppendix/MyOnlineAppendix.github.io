<h3 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDataValidation (5 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAllowBlankToFalse() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    final XSSFDataValidation validation=createValidation(sheet);
    validation.getCtDdataValidation().setAllowBlank(false);
    sheet.addValidationData(validation);
    final List<XSSFDataValidation> dataValidations=sheet.getDataValidations();
    assertEquals(false,dataValidations.get(0).getCtDdataValidation().getAllowBlank());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAllowBlankToTrue() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    final XSSFDataValidation validation=createValidation(sheet);
    validation.getCtDdataValidation().setAllowBlank(true);
    sheet.addValidationData(validation);
    final List<XSSFDataValidation> dataValidations=sheet.getDataValidations();
    assertEquals(true,dataValidations.get(0).getCtDdataValidation().getAllowBlank());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultAllowBlank() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    final XSSFDataValidation validation=createValidation(sheet);
    sheet.addValidationData(validation);
    final List<XSSFDataValidation> dataValidations=sheet.getDataValidations();
    assertEquals(true,dataValidations.get(0).getCtDdataValidation().getAllowBlank());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test53965() throws Exception {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    List<XSSFDataValidation> lst=sheet.getDataValidations();
    assertEquals(0,lst.size());
    sheet.createRow(0).createCell(0);
    DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
    DataValidationConstraint constraint=dataValidationHelper.createCustomConstraint("SUM($A$1:$A$1) <= 3500");
    CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
    DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
    sheet.addValidationData(validation);
    lst=sheet.getDataValidations();
    assertEquals(1,lst.size());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-2 type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddValidations() throws Exception {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("DataValidations-49244.xlsx");
  Sheet sheet=wb1.getSheetAt(0);
  List<XSSFDataValidation> dataValidations=((XSSFSheet)sheet).getDataValidations();
  assertEquals(52,dataValidations.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  int[] validationTypes=new int[]{ValidationType.INTEGER,ValidationType.DECIMAL,ValidationType.TEXT_LENGTH};
  int[] singleOperandOperatorTypes=new int[]{OperatorType.LESS_THAN,OperatorType.LESS_OR_EQUAL,OperatorType.GREATER_THAN,OperatorType.GREATER_OR_EQUAL,OperatorType.EQUAL,OperatorType.NOT_EQUAL};
  int[] doubleOperandOperatorTypes=new int[]{OperatorType.BETWEEN,OperatorType.NOT_BETWEEN};
  BigDecimal value=new BigDecimal("10"), value2=new BigDecimal("20");
  BigDecimal dvalue=new BigDecimal("10.001"), dvalue2=new BigDecimal("19.999");
  final int lastRow=sheet.getLastRowNum();
  int offset=lastRow + 3;
  int lastKnownNumValidations=dataValidations.size();
  Row row=sheet.createRow(offset++);
  Cell cell=row.createCell(0);
  DataValidationConstraint explicitListValidation=dataValidationHelper.createExplicitListConstraint(new String[]{"MA","MI","CA"});
  CellRangeAddressList cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  DataValidation dataValidation=dataValidationHelper.createValidation(explicitListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  row=sheet.createRow(offset++);
  cell=row.createCell(0);
  cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  Cell firstCell=row.createCell(1);
  firstCell.setCellValue("UT");
  Cell secondCell=row.createCell(2);
  secondCell.setCellValue("MN");
  Cell thirdCell=row.createCell(3);
  thirdCell.setCellValue("IL");
  int rowNum=row.getRowNum() + 1;
  String listFormula=new StringBuilder("$B$").append(rowNum).append(":").append("$D$").append(rowNum).toString();
  DataValidationConstraint formulaListValidation=dataValidationHelper.createFormulaListConstraint(listFormula);
  dataValidation=dataValidationHelper.createValidation(formulaListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  offset++;
  offset++;
  for (int i=0; i < validationTypes.length; i++) {
    int validationType=validationTypes[i];
    offset=offset + 2;
    final Row row0=sheet.createRow(offset++);
    Cell cell_10=row0.createCell(0);
    cell_10.setCellValue(validationType == ValidationType.DECIMAL ? "Decimal " : validationType == ValidationType.INTEGER ? "Integer" : "Text Length");
    offset++;
    for (int j=0; j < singleOperandOperatorTypes.length; j++) {
      int operatorType=singleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      final Row row2=i == 0 && j < 2 ? sheet.createRow(offset++) : null;
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_22=i == 0 && j < 2 ? row2.createCell(2) : null;
      Cell cell_13=row1.createCell(3);
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value.toString(),null);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,null);
      if (i == 0 && j == 0) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else       if (i == 0 && j == 1) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
    }
    for (int j=0; j < doubleOperandOperatorTypes.length; j++) {
      int operatorType=doubleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_13=row1.createCell(3);
      Cell cell_14=row1.createCell(4);
      String value1String=validationType == ValidationType.DECIMAL ? dvalue.toString() : value.toString();
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      String value2String=validationType == ValidationType.DECIMAL ? dvalue2.toString() : value2.toString();
      cell_14.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_14.setCellValue(validationType == ValidationType.DECIMAL ? dvalue2.doubleValue() : value2.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value1String,value2String);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      String formula2=new CellReference(cell_14.getRowIndex(),cell_14.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,formula2);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
      validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
    }
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  Sheet sheetAt=wb2.getSheetAt(0);
  assertEquals(lastKnownNumValidations,((XSSFSheet)sheetAt).getDataValidations().size());
  wb2.close();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
