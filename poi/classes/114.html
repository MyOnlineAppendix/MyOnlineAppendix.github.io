<h3 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestPackageCoreProperties (6 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testListOfCustomProperties() throws Exception {
  File inp=POIDataSamples.getSpreadSheetInstance().getFile("ExcelWithAttachments.xlsm");
  OPCPackage pkg=OPCPackage.open(inp,PackageAccess.READ);
  XSSFWorkbook wb=new XSSFWorkbook(pkg);
  assertNotNull(wb.getProperties());
  assertNotNull(wb.getProperties().getCustomProperties());
  for (  CTProperty prop : wb.getProperties().getCustomProperties().getUnderlyingProperties().getPropertyList()) {
    assertNotNull(prop);
  }
  wb.close();
  pkg.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test package core properties setters.
 */
@Test public void testSetProperties() throws Exception {
  String inputPath=OpenXML4JTestDataSamples.getSampleFileName("TestPackageCoreProperiesSetters.docx");
  File outputFile=OpenXML4JTestDataSamples.getOutputFile("TestPackageCoreProperiesSettersOUTPUT.docx");
  @SuppressWarnings("resource") OPCPackage p=OPCPackage.open(inputPath,PackageAccess.READ_WRITE);
  SimpleDateFormat df=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'",Locale.ROOT);
  df.setTimeZone(LocaleUtil.TIMEZONE_UTC);
  Date dateToInsert=df.parse("2007-05-12T08:00:00Z",new ParsePosition(0));
  PackageProperties props=p.getPackageProperties();
  props.setCategoryProperty("MyCategory");
  props.setContentStatusProperty("MyContentStatus");
  props.setContentTypeProperty("MyContentType");
  props.setCreatedProperty(new Nullable<Date>(dateToInsert));
  props.setCreatorProperty("MyCreator");
  props.setDescriptionProperty("MyDescription");
  props.setIdentifierProperty("MyIdentifier");
  props.setKeywordsProperty("MyKeywords");
  props.setLanguageProperty("MyLanguage");
  props.setLastModifiedByProperty("Julien Chable");
  props.setLastPrintedProperty(new Nullable<Date>(dateToInsert));
  props.setModifiedProperty(new Nullable<Date>(dateToInsert));
  props.setRevisionProperty("2");
  props.setTitleProperty("MyTitle");
  props.setSubjectProperty("MySubject");
  props.setVersionProperty("2");
  p.save(outputFile);
  p.revert();
  @SuppressWarnings("resource") OPCPackage p2=OPCPackage.open(outputFile.getAbsolutePath(),PackageAccess.READ);
  compareProperties(p2);
  p2.revert();
  outputFile.delete();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPropertiesLO() throws Exception {
  OPCPackage pkg1=OPCPackage.open(OpenXML4JTestDataSamples.openSampleStream("51444.xlsx"));
  PackageProperties props1=pkg1.getPackageProperties();
  assertEquals(null,props1.getTitleProperty().getValue());
  props1.setTitleProperty("Bug 51444 fixed");
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  pkg1.save(out);
  out.close();
  pkg1.close();
  OPCPackage pkg2=OPCPackage.open(new ByteArrayInputStream(out.toByteArray()));
  PackageProperties props2=pkg2.getPackageProperties();
  props2.setTitleProperty("Bug 51444 fixed");
  pkg2.close();
}

</code></pre>

<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEntitiesInCoreProps_56164() throws Exception {
  InputStream is=OpenXML4JTestDataSamples.openSampleStream("CorePropertiesHasEntities.ooxml");
  OPCPackage p=OPCPackage.open(is);
  is.close();
  boolean foundDocRel=false, foundCorePropRel=false, foundExtPropRel=false;
  for (  PackageRelationship pr : p.getRelationships()) {
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.CORE_DOCUMENT))     foundDocRel=true;
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.CORE_PROPERTIES))     foundCorePropRel=true;
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.EXTENDED_PROPERTIES))     foundExtPropRel=true;
  }
  assertTrue("Core/Doc Relationship not found in " + p.getRelationships(),foundDocRel);
  assertTrue("Core Props Relationship not found in " + p.getRelationships(),foundCorePropRel);
  assertTrue("Ext Props Relationship not found in " + p.getRelationships(),foundExtPropRel);
  PackagePropertiesPart props=(PackagePropertiesPart)p.getPackageProperties();
  assertEquals("Stefan Kopf",props.getCreatorProperty().getValue());
  p.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test package core properties getters.
 */
@Test public void testGetProperties() throws Exception {
  @SuppressWarnings("resource") OPCPackage p=OPCPackage.open(OpenXML4JTestDataSamples.openSampleStream("TestPackageCoreProperiesGetters.docx"));
  compareProperties(p);
  p.revert();
}

</code></pre>

<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoreProperties_bug51374() throws Exception {
  SimpleDateFormat df=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'",Locale.ROOT);
  df.setTimeZone(LocaleUtil.TIMEZONE_UTC);
  String strDate="2007-05-12T08:00:00Z";
  Date date=df.parse(strDate);
  OPCPackage pkg=new ZipPackage();
  PackagePropertiesPart props=(PackagePropertiesPart)pkg.getPackageProperties();
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty((String)null);
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty(new Nullable<Date>());
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getCreatedPropertyString());
  assertEquals(date,props.getCreatedProperty().getValue());
  props.setCreatedProperty(strDate);
  assertEquals(strDate,props.getCreatedPropertyString());
  assertEquals(date,props.getCreatedProperty().getValue());
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty((String)null);
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(new Nullable<Date>());
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getLastPrintedPropertyString());
  assertEquals(date,props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(strDate);
  assertEquals(strDate,props.getLastPrintedPropertyString());
  assertEquals(date,props.getLastPrintedProperty().getValue());
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty((String)null);
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty(new Nullable<Date>());
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getModifiedPropertyString());
  assertEquals(date,props.getModifiedProperty().getValue());
  props.setModifiedProperty(strDate);
  assertEquals(strDate,props.getModifiedPropertyString());
  assertEquals(date,props.getModifiedProperty().getValue());
  pkg.close();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
