<h3 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWrite (12 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(4)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >ConditionMatcher&nbsp;(1)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Writes a simple property set with two sections to a POIFS and reads it
 * back in.</p>
 * @exception IOException if an I/O exception occurs
 * @exception WritingNotSupportedException if HPSF does not yet support
 * a variant type to be written
 */
@Test public void writeTwoSections() throws WritingNotSupportedException, IOException {
  final String STREAM_NAME="PropertySetStream";
  final String SECTION1="Section 1";
  final String SECTION2="Section 2";
  final File dataDir=_samples.getFile("");
  final File filename=new File(dataDir,POI_FS);
  filename.deleteOnExit();
  final OutputStream out=new FileOutputStream(filename);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps=new MutablePropertySet();
  ps.clearSections();
  final ClassID formatID=new ClassID();
  formatID.setBytes(new byte[]{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15});
  final MutableSection s1=new MutableSection();
  s1.setFormatID(formatID);
  s1.setProperty(2,SECTION1);
  ps.addSection(s1);
  final MutableSection s2=new MutableSection();
  s2.setFormatID(formatID);
  s2.setProperty(2,SECTION2);
  ps.addSection(s2);
  poiFs.createDocument(ps.toInputStream(),STREAM_NAME);
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final PropertySet[] psa=new PropertySet[1];
  final POIFSReader r=new POIFSReader();
  r.registerListener(new POIFSReaderListener(){
    public void processPOIFSReaderEvent(    final POIFSReaderEvent event){
      try {
        psa[0]=PropertySetFactory.create(event.getStream());
      }
 catch (      Exception ex) {
        throw new RuntimeException(ex);
      }
    }
  }
,STREAM_NAME);
  FileInputStream stream=new FileInputStream(filename);
  try {
    r.read(stream);
  }
  finally {
    stream.close();
  }
  assertNotNull(psa[0]);
  Section s=(psa[0].getSections().get(0));
  assertEquals(s.getFormatID(),formatID);
  Object p=s.getProperty(2);
  assertEquals(SECTION1,p);
  s=(psa[0].getSections().get(1));
  p=s.getProperty(2);
  assertEquals(SECTION2,p);
}

</code></pre>

<pre class="type-1 type-6 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when using NPOIFS, we can do an in-place write
 * without needing to stream in + out the whole kitchen sink
 */
@Test public void inPlaceNPOIFSWrite() throws Exception {
  NPOIFSFileSystem fs=null;
  DirectoryEntry root=null;
  DocumentNode sinfDoc=null;
  DocumentNode dinfDoc=null;
  SummaryInformation sinf=null;
  DocumentSummaryInformation dinf=null;
  final File copy=TempFile.createTempFile("Test-HPSF","ole2");
  copy.deleteOnExit();
  InputStream inp=_samples.openResourceAsStream("TestShiftJIS.doc");
  FileOutputStream out=new FileOutputStream(copy);
  IOUtils.copy(inp,out);
  inp.close();
  out.close();
  fs=new NPOIFSFileSystem(copy,false);
  root=fs.getRoot();
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  assertEquals("Reiichiro Hori",sinf.getAuthor());
  assertEquals("Microsoft Word 9.0",sinf.getApplicationName());
  assertEquals("\u7b2c1\u7ae0",sinf.getTitle());
  assertEquals("",dinf.getCompany());
  assertEquals(null,dinf.getManager());
  new NPOIFSDocument(sinfDoc).replaceContents(sinf.toInputStream());
  new NPOIFSDocument(dinfDoc).replaceContents(dinf.toInputStream());
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  fs.close();
  inp=_samples.openResourceAsStream("TestShiftJIS.doc");
  out=new FileOutputStream(copy);
  IOUtils.copy(inp,out);
  inp.close();
  out.close();
  fs=new NPOIFSFileSystem(copy,false);
  root=fs.getRoot();
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  sinf.write(new NDocumentOutputStream(sinfDoc));
  dinf.write(new NDocumentOutputStream(dinfDoc));
  ByteArrayOutputStream sinfBytes=new ByteArrayOutputStream();
  sinf.write(sinfBytes);
  ByteArrayOutputStream dinfBytes=new ByteArrayOutputStream();
  dinf.write(dinfBytes);
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  byte[] sinfData=IOUtils.toByteArray(new NDocumentInputStream(sinfDoc));
  byte[] dinfData=IOUtils.toByteArray(new NDocumentInputStream(dinfDoc));
  assertThat(sinfBytes.toByteArray(),equalTo(sinfData));
  assertThat(dinfBytes.toByteArray(),equalTo(dinfData));
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  assertEquals("Reiichiro Hori",sinf.getAuthor());
  assertEquals("Microsoft Word 9.0",sinf.getApplicationName());
  assertEquals("\u7b2c1\u7ae0",sinf.getTitle());
  assertEquals("",dinf.getCompany());
  assertEquals(null,dinf.getManager());
  sinf.setAuthor("Changed Author");
  sinf.setTitle("Le titre \u00e9tait chang\u00e9");
  dinf.setManager("Changed Manager");
  sinf.write(new NDocumentOutputStream(sinfDoc));
  dinf.write(new NDocumentOutputStream(dinfDoc));
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  assertEquals("Changed Author",sinf.getAuthor());
  assertEquals("Microsoft Word 9.0",sinf.getApplicationName());
  assertEquals("Le titre \u00e9tait chang\u00e9",sinf.getTitle());
  assertEquals("",dinf.getCompany());
  assertEquals("Changed Manager",dinf.getManager());
  fs.writeFilesystem();
  fs.close();
  fs=new NPOIFSFileSystem(copy);
  root=fs.getRoot();
  sinfDoc=(DocumentNode)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
  sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream(sinfDoc));
  assertEquals(131077,sinf.getOSVersion());
  dinfDoc=(DocumentNode)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream(dinfDoc));
  assertEquals(131077,dinf.getOSVersion());
  assertEquals("Changed Author",sinf.getAuthor());
  assertEquals("Microsoft Word 9.0",sinf.getApplicationName());
  assertEquals("Le titre \u00e9tait chang\u00e9",sinf.getTitle());
  assertEquals("",dinf.getCompany());
  assertEquals("Changed Manager",dinf.getManager());
  fs.close();
  copy.delete();
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * <p>Tests writing and reading back a proper dictionary with an invalid
 * codepage. (HPSF writes Unicode dictionaries only.)</p>
 * @throws IOException 
 * @throws HPSFException 
 */
@Test(expected=IllegalPropertySetDataException.class) public void dictionaryWithInvalidCodepage() throws IOException, HPSFException {
  final File copy=TempFile.createTempFile("Test-HPSF","ole2");
  copy.deleteOnExit();
  final OutputStream out=new FileOutputStream(copy);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps1=new MutablePropertySet();
  final MutableSection s=(MutableSection)ps1.getSections().get(0);
  final Map<Long,String> m=new HashMap<Long,String>(3,1.0f);
  m.put(Long.valueOf(1),"String 1");
  m.put(Long.valueOf(2),"String 2");
  m.put(Long.valueOf(3),"String 3");
  try {
    s.setDictionary(m);
    s.setFormatID(SectionIDMap.DOCUMENT_SUMMARY_INFORMATION_ID[0]);
    int codepage=12345;
    s.setProperty(PropertyIDMap.PID_CODEPAGE,Variant.VT_I2,Integer.valueOf(codepage));
    poiFs.createDocument(ps1.toInputStream(),"Test");
    poiFs.writeFilesystem(out);
  }
  finally {
    poiFs.close();
    out.close();
  }
}

</code></pre>

<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests writing and reading back a proper dictionary.</p>
 * @throws IOException 
 * @throws HPSFException 
 */
@Test public void dictionary() throws IOException, HPSFException {
  final File copy=TempFile.createTempFile("Test-HPSF","ole2");
  copy.deleteOnExit();
  final OutputStream out=new FileOutputStream(copy);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps1=new MutablePropertySet();
  final MutableSection s=(MutableSection)ps1.getSections().get(0);
  final Map<Long,String> m=new HashMap<Long,String>(3,1.0f);
  m.put(Long.valueOf(1),"String 1");
  m.put(Long.valueOf(2),"String 2");
  m.put(Long.valueOf(3),"String 3");
  s.setDictionary(m);
  s.setFormatID(SectionIDMap.DOCUMENT_SUMMARY_INFORMATION_ID[0]);
  int codepage=CodePageUtil.CP_UNICODE;
  s.setProperty(PropertyIDMap.PID_CODEPAGE,Variant.VT_I2,Integer.valueOf(codepage));
  poiFs.createDocument(ps1.toInputStream(),"Test");
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final POIFile[] psf=Util.readPropertySets(copy);
  assertEquals(1,psf.length);
  final byte[] bytes=psf[0].getBytes();
  final InputStream in=new ByteArrayInputStream(bytes);
  final PropertySet ps2=PropertySetFactory.create(in);
  assertTrue(ps2.isDocumentSummaryInformation());
  assertEquals(ps1,ps2);
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * <p>Writes an empty property set to a POIFS and reads it back
 * in.</p>
 * @exception IOException if an I/O exception occurs
 */
@Test(expected=NoFormatIDException.class) public void withoutAFormatID() throws Exception {
  final File filename=TempFile.createTempFile(POI_FS,".doc");
  final OutputStream out=new FileOutputStream(filename);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps=new MutablePropertySet();
  ps.clearSections();
  ps.addSection(new MutableSection());
  try {
    final ByteArrayOutputStream psStream=new ByteArrayOutputStream();
    ps.write(psStream);
    psStream.close();
    final byte[] streamData=psStream.toByteArray();
    poiFs.createDocument(new ByteArrayInputStream(streamData),SummaryInformation.DEFAULT_STREAM_NAME);
    poiFs.writeFilesystem(out);
  }
  finally {
    poiFs.close();
    out.close();
  }
}

</code></pre>

<pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back various variant types and checks whether the
 * stuff that has been read back equals the stuff that was written.</p>
 */
@Test public void variantTypes(){
  Throwable t=null;
  final int codepage=CODEPAGE_DEFAULT;
  if (!hasProperDefaultCharset()) {
    System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped.");
    return;
  }
  try {
    check(Variant.VT_EMPTY,null,codepage);
    check(Variant.VT_BOOL,Boolean.TRUE,codepage);
    check(Variant.VT_BOOL,Boolean.FALSE,codepage);
    check(Variant.VT_CF,new byte[]{8,0,0,0,1,0,0,0,1,2,3,4},codepage);
    check(Variant.VT_I4,Integer.valueOf(27),codepage);
    check(Variant.VT_I8,Long.valueOf(28),codepage);
    check(Variant.VT_R8,new Double(29.0),codepage);
    check(Variant.VT_I4,Integer.valueOf(-27),codepage);
    check(Variant.VT_I8,Long.valueOf(-28),codepage);
    check(Variant.VT_R8,new Double(-29.0),codepage);
    check(Variant.VT_FILETIME,new Date(),codepage);
    check(Variant.VT_I4,new Integer(Integer.MAX_VALUE),codepage);
    check(Variant.VT_I4,new Integer(Integer.MIN_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MAX_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MIN_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MAX_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MIN_VALUE),codepage);
    check(Variant.VT_LPSTR,"",codepage);
    check(Variant.VT_LPSTR,"\u00e4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
    check(Variant.VT_LPWSTR,"",codepage);
    check(Variant.VT_LPWSTR,"\u00e4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
  }
 catch (  Exception ex) {
    t=ex;
  }
catch (  Error ex) {
    t=ex;
  }
  if (t != null)   fail(org.apache.poi.hpsf.Util.toString(t));
}

</code></pre>

<pre class="type-12 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back strings using several different codepages and
 * checks whether the stuff that has been read back equals the stuff that
 * was written.</p>
 */
@Test public void codepages(){
  Throwable thr=null;
  final int[] validCodepages=new int[]{CODEPAGE_DEFAULT,CODEPAGE_UTF8,CODEPAGE_UTF16,CODEPAGE_1252};
  for (int i=0; i < validCodepages.length; i++) {
    final int cp=validCodepages[i];
    if (cp == -1 && !hasProperDefaultCharset()) {
      System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped for the default codepage.");
      continue;
    }
    final long t=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(t,"",cp);
      check(t,"\u00e4",cp);
      check(t,"\u00e4\u00f6",cp);
      check(t,"\u00e4\u00f6\u00fc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      if (cp == CodePageUtil.CP_UTF16 || cp == CodePageUtil.CP_UTF8)       check(t,"\u79D1\u5B78",cp);
    }
 catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr) + " with codepage " + cp);
  }
  final int[] invalidCodepages=new int[]{0,1,2,4711,815};
  for (int i=0; i < invalidCodepages.length; i++) {
    int cp=invalidCodepages[i];
    final long type=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(type,"",cp);
      check(type,"\u00e4",cp);
      check(type,"\u00e4\u00f6",cp);
      check(type,"\u00e4\u00f6\u00fc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      fail("UnsupportedEncodingException for codepage " + cp + " expected.");
    }
 catch (    UnsupportedEncodingException ex) {
    }
catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr));
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * <p>This test method does a write and read back test with all POI
 * filesystems in the "data" directory by performing the following
 * actions for each file:</p>
 * <ul>
 * <li><p>Read its property set streams.</p></li>
 * <li><p>Create a new POI filesystem containing the origin file's
 * property set streams.</p></li>
 * <li><p>Read the property set streams from the POI filesystem just
 * created.</p></li>
 * <li><p>Compare each property set stream with the corresponding one from
 * the origin file and check whether they are equal.</p></li>
 * </ul>
 * @throws IOException 
 */
@Test public void recreate() throws IOException {
  final File dataDir=_samples.getFile("");
  final File[] fileList=dataDir.listFiles(new FileFilter(){
    @Override public boolean accept(    final File f){
      return f.getName().startsWith("Test") && TestReadAllFiles.checkExclude(f);
    }
  }
);
  for (int i=0; i < fileList.length; i++) {
    try {
      testRecreate(fileList[i]);
    }
 catch (    Exception e) {
      throw new IOException("While handling file " + fileList[i],e);
    }
  }
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp(){
  VariantSupport.setLogUnsupportedTypes(false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * <p>Writes an empty property set to a POIFS and reads it back
 * in.</p>
 * @exception IOException if an I/O exception occurs
 * @exception UnsupportedVariantTypeException if HPSF does not yet support
 * a variant type to be written
 */
@Test public void writeEmptyPropertySet() throws IOException, UnsupportedVariantTypeException {
  final File dataDir=_samples.getFile("");
  final File filename=new File(dataDir,POI_FS);
  filename.deleteOnExit();
  final OutputStream out=new FileOutputStream(filename);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps=new MutablePropertySet();
  final MutableSection s=(MutableSection)ps.getSections().get(0);
  s.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  final ByteArrayOutputStream psStream=new ByteArrayOutputStream();
  ps.write(psStream);
  psStream.close();
  final byte[] streamData=psStream.toByteArray();
  poiFs.createDocument(new ByteArrayInputStream(streamData),SummaryInformation.DEFAULT_STREAM_NAME);
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final POIFSReader r=new POIFSReader();
  r.registerListener(new MyPOIFSReaderListener(),SummaryInformation.DEFAULT_STREAM_NAME);
  FileInputStream stream=new FileInputStream(filename);
  try {
    r.read(stream);
  }
  finally {
    stream.close();
  }
}

</code></pre>

<pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests whether writing 8-bit characters to a Unicode property
 * succeeds.</p>
 */
@Test public void unicodeWrite8Bit(){
  final String TITLE="This is a sample title";
  final MutablePropertySet mps=new MutablePropertySet();
  final MutableSection ms=(MutableSection)mps.getSections().get(0);
  ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_TITLE);
  p.setType(Variant.VT_LPSTR);
  p.setValue(TITLE);
  ms.setProperty(p);
  Throwable t=null;
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    mps.write(out);
    out.close();
    byte[] bytes=out.toByteArray();
    PropertySet psr=new PropertySet(bytes);
    assertTrue(psr.isSummaryInformation());
    Section sr=psr.getSections().get(0);
    String title=(String)sr.getProperty(PropertyIDMap.PID_TITLE);
    assertEquals(TITLE,title);
  }
 catch (  WritingNotSupportedException e) {
    t=e;
  }
catch (  IOException e) {
    t=e;
  }
catch (  NoPropertySetStreamException e) {
    t=e;
  }
  if (t != null)   fail(t.getMessage());
}

</code></pre>

<pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Writes a simple property set with a SummaryInformation section to a
 * POIFS and reads it back in.</p>
 * @exception IOException if an I/O exception occurs
 * @exception UnsupportedVariantTypeException if HPSF does not yet support
 * a variant type to be written
 */
@Test public void writeSimplePropertySet() throws IOException, UnsupportedVariantTypeException {
  final String AUTHOR="Rainer Klute";
  final String TITLE="Test Document";
  final File dataDir=_samples.getFile("");
  final File filename=new File(dataDir,POI_FS);
  filename.deleteOnExit();
  final OutputStream out=new FileOutputStream(filename);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps=new MutablePropertySet();
  final MutableSection si=new MutableSection();
  si.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  ps.getSections().set(0,si);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_AUTHOR);
  p.setType(Variant.VT_LPWSTR);
  p.setValue(AUTHOR);
  si.setProperty(p);
  si.setProperty(PropertyIDMap.PID_TITLE,Variant.VT_LPSTR,TITLE);
  poiFs.createDocument(ps.toInputStream(),SummaryInformation.DEFAULT_STREAM_NAME);
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final PropertySet[] psa=new PropertySet[1];
  final POIFSReader r=new POIFSReader();
  r.registerListener(new POIFSReaderListener(){
    public void processPOIFSReaderEvent(    final POIFSReaderEvent event){
      try {
        psa[0]=PropertySetFactory.create(event.getStream());
      }
 catch (      Exception ex) {
        fail(org.apache.poi.hpsf.Util.toString(ex));
      }
    }
  }
,SummaryInformation.DEFAULT_STREAM_NAME);
  InputStream stream=new FileInputStream(filename);
  try {
    r.read(stream);
  }
  finally {
    stream.close();
  }
  assertNotNull(psa[0]);
  assertTrue(psa[0].isSummaryInformation());
  final Section s=(psa[0].getSections().get(0));
  Object p1=s.getProperty(PropertyIDMap.PID_AUTHOR);
  Object p2=s.getProperty(PropertyIDMap.PID_TITLE);
  assertEquals(AUTHOR,p1);
  assertEquals(TITLE,p2);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
