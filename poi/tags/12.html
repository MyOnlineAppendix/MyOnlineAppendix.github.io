<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.poi.extractor.TestExtractorFactory </h4><pre class="type-2 type-12 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test embeded docs text extraction. For now, only
 * does poifs embeded, but will do ooxml ones 
 * at some point.
 */
@Test public void testEmbeded() throws Exception {
  POIOLE2TextExtractor ext;
  POITextExtractor[] embeds;
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(xls);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  assertEquals(0,embeds.length);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(xlsEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  assertEquals(6,embeds.length);
  int numWord=0, numXls=0, numPpt=0, numMsg=0, numWordX;
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(2,numPpt);
  assertEquals(2,numXls);
  assertEquals(2,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(docEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(4,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(1,numPpt);
  assertEquals(2,numXls);
  assertEquals(1,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(docEmbOOXML);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  numWordX=0;
  assertEquals(3,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
 else     if (embeds[i] instanceof XWPFWordExtractor)     numWordX++;
  }
  assertEquals(1,numPpt);
  assertEquals(1,numXls);
  assertEquals(0,numWord);
  assertEquals(1,numWordX);
  assertEquals(0,numMsg);
  ext.close();
  ext=(OutlookTextExtactor)ExtractorFactory.createExtractor(msgEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(1,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(0,numPpt);
  assertEquals(0,numXls);
  assertEquals(1,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(OutlookTextExtactor)ExtractorFactory.createExtractor(msgEmbMsg);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(1,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(0,numPpt);
  assertEquals(0,numXls);
  assertEquals(0,numWord);
  assertEquals(1,numMsg);
  ext.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestBasic </h4><pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <p>Checks the names of the files in the POI filesystem. They
 * are expected to be in a certain order.</p>
 */
@Test public void testReadFiles(){
  String[] expected=POI_FILES;
  for (int i=0; i < expected.length; i++)   assertEquals(poiFiles[i].getName(),expected[i]);
}

</code></pre>

<br>
<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <p>Tests whether property sets can be created from the POI
 * files in the POI file system. This test case expects the first
 * file to be a {@link SummaryInformation}, the second file to be
 * a {@link DocumentSummaryInformation} and the rest to be no
 * property sets. In the latter cases a {@link NoPropertySetStreamException} will be thrown when trying to
 * create a {@link PropertySet}.</p>
 * @exception IOException if an I/O exception occurs.
 * @exception UnsupportedEncodingException if a character encoding is not
 * supported.
 */
@Test public void testCreatePropertySets() throws UnsupportedEncodingException, IOException {
  Class<?>[] expected=new Class[]{SummaryInformation.class,DocumentSummaryInformation.class,NoPropertySetStreamException.class,NoPropertySetStreamException.class,NoPropertySetStreamException.class};
  for (int i=0; i < expected.length; i++) {
    InputStream in=new ByteArrayInputStream(poiFiles[i].getBytes());
    Object o;
    try {
      o=PropertySetFactory.create(in);
    }
 catch (    NoPropertySetStreamException ex) {
      o=ex;
    }
catch (    MarkUnsupportedException ex) {
      o=ex;
    }
    in.close();
    assertEquals(expected[i],o.getClass());
  }
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <p>Tests the {@link PropertySet} methods. The test file has two
 * property sets: the first one is a {@link SummaryInformation},
 * the second one is a {@link DocumentSummaryInformation}.</p>
 * @exception IOException if an I/O exception occurs
 * @exception HPSFException if any HPSF exception occurs
 */
@Test public void testPropertySetMethods() throws IOException, HPSFException {
  for (int i=0; i < 2; i++) {
    byte[] b=poiFiles[i].getBytes();
    PropertySet ps=PropertySetFactory.create(new ByteArrayInputStream(b));
    assertEquals(BYTE_ORDER,ps.getByteOrder());
    assertEquals(FORMAT,ps.getFormat());
    assertEquals(OS_VERSION,ps.getOSVersion());
    assertArrayEquals(CLASS_ID,ps.getClassID().getBytes());
    assertEquals(SECTION_COUNT[i],ps.getSectionCount());
    assertEquals(IS_SUMMARY_INFORMATION[i],ps.isSummaryInformation());
    assertEquals(IS_DOCUMENT_SUMMARY_INFORMATION[i],ps.isDocumentSummaryInformation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWrite </h4><pre class="type-12 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back strings using several different codepages and
 * checks whether the stuff that has been read back equals the stuff that
 * was written.</p>
 */
@Test public void codepages(){
  Throwable thr=null;
  final int[] validCodepages=new int[]{CODEPAGE_DEFAULT,CODEPAGE_UTF8,CODEPAGE_UTF16,CODEPAGE_1252};
  for (int i=0; i < validCodepages.length; i++) {
    final int cp=validCodepages[i];
    if (cp == -1 && !hasProperDefaultCharset()) {
      System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped for the default codepage.");
      continue;
    }
    final long t=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(t,"",cp);
      check(t,"\u00e4",cp);
      check(t,"\u00e4\u00f6",cp);
      check(t,"\u00e4\u00f6\u00fc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      if (cp == CodePageUtil.CP_UTF16 || cp == CodePageUtil.CP_UTF8)       check(t,"\u79D1\u5B78",cp);
    }
 catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr) + " with codepage " + cp);
  }
  final int[] invalidCodepages=new int[]{0,1,2,4711,815};
  for (int i=0; i < invalidCodepages.length; i++) {
    int cp=invalidCodepages[i];
    final long type=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(type,"",cp);
      check(type,"\u00e4",cp);
      check(type,"\u00e4\u00f6",cp);
      check(type,"\u00e4\u00f6\u00fc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      fail("UnsupportedEncodingException for codepage " + cp + " expected.");
    }
 catch (    UnsupportedEncodingException ex) {
    }
catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestShapes </h4><pre class="type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shapeId() throws IOException {
  HSLFSlideShow ss=new HSLFSlideShow();
  HSLFSlide slide=ss.createSlide();
  HSLFShape shape=null;
  EscherDggRecord dgg=ss.getDocumentRecord().getPPDrawingGroup().getEscherDggRecord();
  EscherDgRecord dg=slide.getSheetContainer().getPPDrawing().getEscherDgRecord();
  int dggShapesUsed=dgg.getNumShapesSaved();
  int dggMaxId=dgg.getShapeIdMax();
  int dgMaxId=dg.getLastMSOSPID();
  int dgShapesUsed=dg.getNumShapes();
  for (int i=0; i < 3; i++) {
    shape=new HSLFLine();
    assertEquals(0,shape.getShapeId());
    slide.addShape(shape);
    assertTrue(shape.getShapeId() > 0);
    assertEquals(shape.getShapeId(),dg.getLastMSOSPID());
    assertEquals(dgMaxId + 1,dg.getLastMSOSPID());
    assertEquals(dgShapesUsed + 1,dg.getNumShapes());
    assertEquals(shape.getShapeId() + 1,dgg.getShapeIdMax());
    assertEquals(dggMaxId + 1,dgg.getShapeIdMax());
    assertEquals(dggShapesUsed + 1,dgg.getNumShapesSaved());
    dggShapesUsed=dgg.getNumShapesSaved();
    dggMaxId=dgg.getShapeIdMax();
    dgMaxId=dg.getLastMSOSPID();
    dgShapesUsed=dg.getNumShapes();
  }
  int numClusters=dgg.getNumIdClusters();
  for (int i=0; i < 1025; i++) {
    shape=new HSLFLine();
    slide.addShape(shape);
  }
  assertEquals(numClusters + 1,dgg.getNumIdClusters());
  ss.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test functionality of Sheet.removeShape(Shape shape)
 */
@Test public void removeShapes() throws IOException {
  String file="with_textbox.ppt";
  HSLFSlideShow ss=new HSLFSlideShow(_slTests.openResourceAsStream(file));
  HSLFSlide sl=ss.getSlides().get(0);
  List<HSLFShape> sh=sl.getShapes();
  assertEquals("expected four shaped in " + file,4,sh.size());
  for (int i=0; i < sh.size(); i++) {
    boolean ok=sl.removeShape(sh.get(i));
    assertTrue("Failed to delete shape #" + i,ok);
  }
  assertEquals("expected 0 shaped in " + file,0,sl.getShapes().size());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ss.write(out);
  out.close();
  ss.close();
  ss=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  sl=ss.getSlides().get(0);
  assertEquals("expected 0 shaped in " + file,0,sl.getShapes().size());
  ss.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestTextRunReWrite </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritesOutTheSameNonRich() throws Exception {
  assertEquals(1,ss.getSlides().size());
  assertEquals(2,ss.getSlides().get(0).getTextParagraphs().size());
  List<HSLFTextParagraph> tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  List<HSLFTextParagraph> tr2=ss.getSlides().get(0).getTextParagraphs().get(1);
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(179,HSLFTextParagraph.getRawText(tr2).length());
  assertEquals(1,tr1.size());
  assertEquals(30,HSLFTextParagraph.getText(tr1).length());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(31,tr1.get(0).getTextRuns().get(0).getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  HSLFTextParagraph.setText(tr1,HSLFTextParagraph.getRawText(tr1));
  tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(179,HSLFTextParagraph.getRawText(tr2).length());
  assertEquals(1,tr1.size());
  assertEquals(30,HSLFTextParagraph.getText(tr1).length());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(31,tr1.get(0).getTextRuns().get(0).getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ss.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  POIFSFileSystem npfs=new POIFSFileSystem(bais);
  DocumentEntry oProps=(DocumentEntry)pfs.getRoot().getEntry("PowerPoint Document");
  DocumentEntry nProps=(DocumentEntry)npfs.getRoot().getEntry("PowerPoint Document");
  assertEquals(oProps.getSize(),nProps.getSize());
  byte[] _oData=new byte[oProps.getSize()];
  byte[] _nData=new byte[nProps.getSize()];
  pfs.createDocumentInputStream("PowerPoint Document").read(_oData);
  npfs.createDocumentInputStream("PowerPoint Document").read(_nData);
  for (int i=0; i < _oData.length; i++) {
    assertEquals(_oData[i],_nData[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritesOutTheSameRich() throws Exception {
  List<HSLFTextParagraph> tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  HSLFTextRun rtr1=tr1.get(0).getTextRuns().get(0);
  assertEquals(1,tr1.get(0).getTextRuns().size());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(30,rtr1.getLength());
  assertEquals(30,rtr1.getRawText().length());
  assertEquals(31,rtr1.getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  rtr1.setText(rtr1.getRawText());
  rtr1=tr1.get(0).getTextRuns().get(0);
  assertEquals(1,tr1.get(0).getTextRuns().size());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(30,tr1.get(0).getTextRuns().get(0).getRawText().length());
  assertEquals(30,rtr1.getLength());
  assertEquals(30,rtr1.getRawText().length());
  assertEquals(31,rtr1.getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ss.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  POIFSFileSystem npfs=new POIFSFileSystem(bais);
  DocumentEntry oProps=(DocumentEntry)pfs.getRoot().getEntry("PowerPoint Document");
  DocumentEntry nProps=(DocumentEntry)npfs.getRoot().getEntry("PowerPoint Document");
  assertEquals(oProps.getSize(),nProps.getSize());
  byte[] _oData=new byte[oProps.getSize()];
  byte[] _nData=new byte[nProps.getSize()];
  pfs.createDocumentInputStream("PowerPoint Document").read(_oData);
  npfs.createDocumentInputStream("PowerPoint Document").read(_nData);
  for (int i=0; i < _oData.length; i++) {
    assertEquals(_oData[i],_nData[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestComment2000 </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWrite() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChange() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  Comment2000 cb=new Comment2000(data_b,0,data_b.length);
  Comment2000 cn=new Comment2000();
  ca.setAuthor("Hogwarts");
  ca.setAuthorInitials("H");
  ca.setText("Comments are fun things to add in, aren't they?");
  cn.setAuthor("Hogwarts");
  cn.setAuthorInitials("H");
  cn.setText("Comments are fun things to add in, aren't they?");
  Comment2000Atom c2a=ca.getComment2000Atom();
  Comment2000Atom c2n=cn.getComment2000Atom();
  c2a.setNumber(1);
  c2a.setXOffset(0x0a);
  c2a.setYOffset(0x0a);
  c2n.setNumber(1);
  c2n.setXOffset(0x0a);
  c2n.setYOffset(0x0a);
  Date new_date=sdf.parse("2006-01-24 22:25:03.725");
  c2a.setDate(new_date);
  c2n.setDate(new_date);
  assertEquals(ca.getText(),cb.getText());
  assertEquals(cn.getText(),cb.getText());
  assertEquals(ca.getAuthor(),cb.getAuthor());
  assertEquals(cn.getAuthor(),cb.getAuthor());
  assertEquals(ca.getAuthorInitials(),cb.getAuthorInitials());
  assertEquals(cn.getAuthorInitials(),cb.getAuthorInitials());
  try {
    for (int i=0; i < data_a.length; i++) {
      assertEquals(data_a[i],data_b[i]);
    }
    fail();
  }
 catch (  Error e) {
  }
  ByteArrayOutputStream baosa=new ByteArrayOutputStream();
  ByteArrayOutputStream baosn=new ByteArrayOutputStream();
  ca.writeOut(baosa);
  cn.writeOut(baosn);
  byte[] ba=baosa.toByteArray();
  byte[] bn=baosn.toByteArray();
  assertEquals(data_b.length,ba.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],ba[i]);
  }
  assertEquals(data_b.length,bn.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],bn[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestComment2000Atom </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate() throws Exception {
  Comment2000Atom a=new Comment2000Atom();
  a.setNumber(1);
  a.setXOffset(0x92);
  a.setYOffset(0x92);
  Date date_a=sdf.parse("2006-01-24 10:26:15.205");
  a.setDate(date_a);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  a.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChange() throws Exception {
  Comment2000Atom ca=new Comment2000Atom(data_a,0,data_a.length);
  ca.setNumber(5);
  Date new_date=sdf.parse("2006-01-24 21:25:03.725");
  ca.setDate(new_date);
  ca.setXOffset(0x0A);
  ca.setYOffset(0x0E);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_b.length,b.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWrite() throws Exception {
  Comment2000Atom ca=new Comment2000Atom(data_a,0,data_a.length);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestDocumentEncryption </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void cryptoAPIChangeKeySize() throws Exception {
  String pptFile="cryptoapi-proc2356.ppt";
  Biff8EncryptionKey.setCurrentUserPassword("crypto");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(slTests.getFile(pptFile),true);
  HSLFSlideShowImpl hss=new HSLFSlideShowImpl(fs);
  List<HSLFPictureData> picsExpected=hss.getPictureData();
  hss.getDocumentSummaryInformation();
  EncryptionInfo ei=hss.getDocumentEncryptionAtom().getEncryptionInfo();
  ((CryptoAPIEncryptionHeader)ei.getHeader()).setKeySize(0x78);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  hss.write(bos);
  fs.close();
  fs=new NPOIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  hss=new HSLFSlideShowImpl(fs);
  List<HSLFPictureData> picsActual=hss.getPictureData();
  fs.close();
  assertEquals(picsExpected.size(),picsActual.size());
  for (int i=0; i < picsExpected.size(); i++) {
    assertArrayEquals(picsExpected.get(i).getRawData(),picsActual.get(i).getRawData());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestStyleTextPropAtom </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Try to recreate an existing StyleTextPropAtom (a) from the empty
 * constructor, and setting the required properties
 */
@Test public void testCreateAFromScatch() throws Exception {
  StyleTextPropAtom stpa=new StyleTextPropAtom(54);
  List<TextPropCollection> cs=stpa.getCharacterStyles();
  TextPropCollection tpca=cs.get(0);
  tpca.updateTextSize(21);
  TextPropCollection tpcb=stpa.addCharacterTextPropCollection(17);
  TextProp tpb=tpcb.addWithName("font.color");
  tpb.setValue(0x05000000);
  TextPropCollection tpcc=stpa.addCharacterTextPropCollection(16);
  TextProp tpc=tpcc.addWithName("font.color");
  tpc.setValue(0xFE0033FF);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  stpa.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Try to recreate an existing StyleTextPropAtom (b) from the empty
 * constructor, and setting the required properties
 */
@Test public void testCreateBFromScatch() throws Exception {
  StyleTextPropAtom stpa=new StyleTextPropAtom(data_b_text_len);
  List<TextPropCollection> ps=stpa.getParagraphStyles();
  TextPropCollection tppa=ps.get(0);
  tppa.updateTextSize(30);
  TextProp tp=tppa.addWithName("alignment");
  tp.setValue(0);
  tp=tppa.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppb=stpa.addParagraphTextPropCollection(28);
  tp=tppb.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppc=stpa.addParagraphTextPropCollection(25);
  tp=tppc.addWithName("alignment");
  tp.setValue(2);
  tp=tppc.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppd=stpa.addParagraphTextPropCollection(97);
  tp=tppd.addWithName("alignment");
  tp.setValue(0);
  tp=tppd.addWithName("linespacing");
  tp.setValue(80);
  List<TextPropCollection> cs=stpa.getCharacterStyles();
  TextPropCollection tpca=cs.get(0);
  tpca.updateTextSize(30);
  tp=tpca.addWithName("font.size");
  tp.setValue(20);
  CharFlagsTextProp cftp=(CharFlagsTextProp)tpca.addWithName("char_flags");
  assertEquals(0,cftp.getValue());
  cftp.setSubValue(true,CharFlagsTextProp.BOLD_IDX);
  assertEquals(1,cftp.getValue());
  TextPropCollection tpcb=stpa.addCharacterTextPropCollection(28);
  tp=tpcb.addWithName("font.size");
  tp.setValue(20);
  tp=tpcb.addWithName("font.color");
  tp.setValue(0x05000000);
  cftp=(CharFlagsTextProp)tpcb.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.ITALIC_IDX);
  assertEquals(2,cftp.getValue());
  TextPropCollection tpcc=stpa.addCharacterTextPropCollection(25);
  tp=tpcc.addWithName("font.size");
  tp.setValue(20);
  tp=tpcc.addWithName("font.color");
  tp.setValue(0xfe0033ff);
  TextPropCollection tpcd=stpa.addCharacterTextPropCollection(96);
  tp=tpcd.addWithName("font.size");
  tp.setValue(24);
  tp=tpcd.addWithName("font.index");
  tp.setValue(1);
  cftp=(CharFlagsTextProp)tpcd.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.UNDERLINE_IDX);
  assertEquals(4,cftp.getValue());
  TextPropCollection tpce=stpa.addCharacterTextPropCollection(1);
  tp=tpce.addWithName("font.size");
  tp.setValue(24);
  tp=tpce.addWithName("font.index");
  tp.setValue(1);
  tp=tpce.addWithName("font.color");
  tp.setValue(0xfe0033ff);
  cftp=(CharFlagsTextProp)tpce.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.UNDERLINE_IDX);
  assertEquals(4,cftp.getValue());
  assertEquals(4,stpa.getParagraphStyles().size());
  assertEquals(5,stpa.getCharacterStyles().size());
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> psb=stpb.getParagraphStyles();
  List<TextPropCollection> csb=stpb.getCharacterStyles();
  assertEquals(psb.size(),ps.size());
  assertEquals(csb.size(),cs.size());
  for (int z=0; z < 2; z++) {
    List<TextPropCollection> lla=cs;
    List<TextPropCollection> llb=csb;
    int upto=5;
    if (z == 1) {
      lla=ps;
      llb=psb;
      upto=4;
    }
    for (int i=0; i < upto; i++) {
      TextPropCollection ca=lla.get(i);
      TextPropCollection cb=llb.get(i);
      assertEquals(ca.getCharactersCovered(),cb.getCharactersCovered());
      assertEquals(ca.getTextPropList().size(),cb.getTextPropList().size());
      for (int j=0; j < ca.getTextPropList().size(); j++) {
        TextProp tpa=ca.getTextPropList().get(j);
        TextProp tpb=cb.getTextPropList().get(j);
        assertEquals(tpa.getName(),tpb.getName());
        assertEquals(tpa.getMask(),tpb.getMask());
        assertEquals(tpa.getWriteMask(),tpb.getWriteMask());
        assertEquals(tpa.getValue(),tpb.getValue());
      }
      ByteArrayOutputStream ba=new ByteArrayOutputStream();
      ByteArrayOutputStream bb=new ByteArrayOutputStream();
      ca.writeOut(ba);
      cb.writeOut(bb);
      byte[] cab=ba.toByteArray();
      byte[] cbb=bb.toByteArray();
      assertEquals(cbb.length,cab.length);
      for (int j=0; j < cab.length; j++) {
        assertEquals(cbb[j],cab[j]);
      }
    }
  }
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  stpa.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_b.length,b.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],b[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTable </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddText() throws IOException {
  HSLFSlideShow ppt1=new HSLFSlideShow();
  HSLFSlide slide=ppt1.createSlide();
  HSLFTable tab=slide.createTable(4,5);
  int rows=tab.getNumberOfRows();
  int cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      c.setText("r" + (row + 1) + "c"+ (col + 1));
    }
  }
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ppt1.write(bos);
  ppt1.close();
  ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
  HSLFSlideShow ppt2=new HSLFSlideShow(bis);
  slide=ppt2.getSlides().get(0);
  tab=(HSLFTable)slide.getShapes().get(0);
  rows=tab.getNumberOfRows();
  cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      c.setText(c.getText() + "...");
    }
  }
  bos.reset();
  ppt2.write(bos);
  ppt2.close();
  bis=new ByteArrayInputStream(bos.toByteArray());
  HSLFSlideShow ppt3=new HSLFSlideShow(bis);
  slide=ppt3.getSlides().get(0);
  tab=(HSLFTable)slide.getShapes().get(0);
  rows=tab.getNumberOfRows();
  cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      assertEquals("r" + (row + 1) + "c"+ (col + 1)+ "...",c.getText());
    }
  }
  ppt3.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextRun </h4><pre class="type-2 type-12 type-14 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test48916() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("SampleShow.ppt"));
  List<HSLFSlide> slides=ppt.getSlides();
  for (  HSLFSlide slide : slides) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (!(sh instanceof HSLFTextShape))       continue;
      HSLFTextShape tx=(HSLFTextShape)sh;
      List<HSLFTextParagraph> paras=tx.getTextParagraphs();
      Record[] runChildren=paras.get(0).getRecords();
      Record[] txboxChildren=tx.getEscherTextboxWrapper().getChildRecords();
      assertEquals(runChildren.length,txboxChildren.length);
      for (int i=0; i < txboxChildren.length; i++) {
        assertSame(txboxChildren[i],runChildren[i]);
      }
      for (      HSLFTextParagraph p : paras) {
        for (        HSLFTextRun rt : p.getTextRuns()) {
          rt.setBold(true);
          rt.setFontColor(Color.RED);
        }
      }
    }
  }
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  for (  HSLFSlide slide : ppt.getSlides()) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (sh instanceof HSLFTextShape) {
        HSLFTextShape tx=(HSLFTextShape)sh;
        List<HSLFTextParagraph> run=tx.getTextParagraphs();
        HSLFTextRun rt=run.get(0).getTextRuns().get(0);
        assertTrue(rt.isBold());
        assertTrue(sameColor(Color.RED,rt.getFontColor()));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.util.TestSystemTimeUtils </h4><pre class="type-12 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testWriteDateB() throws Exception {
  byte[] out_b=new byte[data_b.length];
  System.arraycopy(data_b,0,out_b,0,12);
  System.arraycopy(data_b,12 + 16,out_b,12 + 16,data_b.length - 12 - 16);
  Date date=sdf.parse("2006-01-24 21:25:03.725");
  SystemTimeUtils.storeDate(date,out_b,12);
  for (int i=0; i < out_b.length; i++) {
    assertEquals(data_b[i],out_b[i]);
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testWriteDateA() throws Exception {
  byte[] out_a=new byte[data_a.length];
  Date date=sdf.parse("2006-01-24 10:26:15.205");
  SystemTimeUtils.storeDate(date,out_a);
  for (int i=0; i < out_a.length; i++) {
    assertEquals(data_a[i],out_a[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.eventusermodel.TestFormatTrackingHSSFListener </h4><pre class="type-12 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that all number and formula records can be
 * turned into strings without problems.
 * For now, we're just looking to get text back, no
 * exceptions thrown, but in future we might also
 * want to check the exact strings!
 */
@Test public void testTurnToString() throws Exception {
  String[] files=new String[]{"45365.xls","45365-2.xls","MissingBits.xls"};
  for (int k=0; k < files.length; k++) {
    processFile(files[k]);
    assertTrue(listener.getNumberOfCustomFormats() > 5);
    assertTrue(listener.getNumberOfExtendedFormats() > 5);
    for (    Record r : mockListen._records) {
      CellValueRecordInterface cvr=null;
      if (r instanceof NumberRecord) {
        cvr=(CellValueRecordInterface)r;
      }
      if (r instanceof FormulaRecord) {
        cvr=(CellValueRecordInterface)r;
      }
      if (cvr != null) {
        String s=listener.formatNumberDateCell(cvr);
        assertNotNull(s);
        assertTrue(s.length() > 0);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.extractor.TestExcelExtractor </h4><pre class="type-12 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that we get text from headers and footers
 */
@Test public void test45538() throws IOException {
  String[] files={"45538_classic_Footer.xls","45538_form_Footer.xls","45538_classic_Header.xls","45538_form_Header.xls"};
  for (int i=0; i < files.length; i++) {
    ExcelExtractor extractor=createExtractor(files[i]);
    String text=extractor.getText();
    assertTrue("Unable to find expected word in text\n" + text,text.indexOf("testdoc") >= 0);
    assertTrue("Unable to find expected word in text\n" + text,text.indexOf("test phrase") >= 0);
    extractor.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestSheet </h4><pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure page break functionality works (in memory)
 */
@Test public void testRowPageBreaks(){
  short colFrom=0;
  short colTo=255;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(0,colFrom,colTo);
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(10,colFrom,colTo);
  sheet.setRowBreak(11,colFrom,colTo);
  assertTrue("no row break at 10",sheet.isRowBroken(10));
  assertTrue("no row break at 11",sheet.isRowBroken(11));
  assertEquals("3 row break available",3,sheet.getNumRowBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is11=false;
  int[] rowBreaks=sheet.getRowBreaks();
  for (int i=0; i < rowBreaks.length; i++) {
    int main=rowBreaks[i];
    if (main != 0 && main != 10 && main != 11)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 10)     is10=true;
    if (main == 11)     is11=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is10 && is11);
  sheet.removeRowBreak(11);
  assertFalse("row should be removed",sheet.isRowBroken(11));
  sheet.removeRowBreak(0);
  assertFalse("row should be removed",sheet.isRowBroken(0));
  sheet.removeRowBreak(10);
  assertFalse("row should be removed",sheet.isRowBroken(10));
  assertEquals("no more breaks",0,sheet.getNumRowBreaks());
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMergedRegion(){
  InternalSheet sheet=InternalSheet.createSheet();
  int regionsToAdd=4096;
  for (int n=0; n < regionsToAdd; n++) {
    int index=sheet.addMergedRegion(0,(short)0,1,(short)1);
    assertTrue("Merged region index expected to be " + n + " got "+ index,index == n);
  }
  assertTrue(sheet.getNumMergedRegions() == regionsToAdd);
  MergedCellListener mcListener=new MergedCellListener();
  sheet.visitContainedRecords(mcListener,0);
  int recordsAdded=mcListener.getCount();
  int recordsExpected=regionsToAdd / 1027;
  if ((regionsToAdd % 1027) != 0)   recordsExpected++;
  assertTrue("The " + regionsToAdd + " merged regions should have been spread out over "+ recordsExpected+ " records, not "+ recordsAdded,recordsAdded == recordsExpected);
  try {
    sheet.addMergedRegion(10,(short)10,9,(short)12);
    fail("Expected an exception to occur");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The 'to' row (9) must not be less than the 'from' row (10)",e.getMessage());
  }
  try {
    sheet.addMergedRegion(10,(short)10,12,(short)9);
    fail("Expected an exception to occur");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The 'to' col (9) must not be less than the 'from' col (10)",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure column pag breaks works properly (in-memory)
 */
@Test public void testColPageBreaks(){
  short rowFrom=0;
  short rowTo=(short)65535;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)1,rowFrom,rowTo);
  sheet.setColumnBreak((short)10,rowFrom,rowTo);
  sheet.setColumnBreak((short)15,rowFrom,rowTo);
  assertTrue("no col break at 1",sheet.isColumnBroken(1));
  assertTrue("no col break at 10",sheet.isColumnBroken(10));
  assertTrue("no col break at 15",sheet.isColumnBroken(15));
  assertEquals("4 col break available",4,sheet.getNumColumnBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is1=false;
  boolean is15=false;
  int[] colBreaks=sheet.getColumnBreaks();
  for (int i=0; i < colBreaks.length; i++) {
    int main=colBreaks[i];
    if (main != 0 && main != 1 && main != 10 && main != 15)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 1)     is1=true;
    if (main == 10)     is10=true;
    if (main == 15)     is15=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is1 && is10&& is15);
  sheet.removeColumnBreak(15);
  assertFalse("column break should not be there",sheet.isColumnBroken(15));
  sheet.removeColumnBreak(0);
  assertFalse("column break should not be there",sheet.isColumnBroken(0));
  sheet.removeColumnBreak(1);
  assertFalse("column break should not be there",sheet.isColumnBroken(1));
  sheet.removeColumnBreak(10);
  assertFalse("column break should not be there",sheet.isColumnBroken(10));
  assertEquals("no more breaks",0,sheet.getNumColumnBreaks());
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRemoveMergedRegion(){
  InternalSheet sheet=InternalSheet.createSheet();
  int regionsToAdd=4096;
  for (int n=0; n < regionsToAdd; n++) {
    sheet.addMergedRegion(n,0,n,1);
  }
  int nSheetRecords=sheet.getRecords().size();
  for (int n=0; n < regionsToAdd / 3; n++) {
    sheet.removeMergedRegion(0);
    assertEquals("Num of regions",regionsToAdd - n - 1,sheet.getNumMergedRegions());
  }
  assertEquals("Sheet Records",nSheetRecords,sheet.getRecords().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestHyperlinkRecord </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClone(){
  byte[][] data={data1,data2,data3,data4};
  for (int i=0; i < data.length; i++) {
    RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data[i]);
    HyperlinkRecord link=new HyperlinkRecord(is);
    HyperlinkRecord clone=link.clone();
    assertArrayEquals(link.serialize(),clone.serialize());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestSSTRecord </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test simple addString
 */
@Test public void testSimpleAddString(){
  SSTRecord record=new SSTRecord();
  UnicodeString s1=new UnicodeString("Hello world");
  UnicodeString s2=new UnicodeString("Hello world\u2122");
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(1,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(2,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(1,record.addString(s2));
  assertEquals(s2,record.getString(1));
  assertEquals(2,record.countStrings());
  assertEquals(3,record.getNumStrings());
  assertEquals(2,record.getNumUniqueStrings());
  Iterator<UnicodeString> iter=record.getStrings();
  while (iter.hasNext()) {
    UnicodeString ucs=iter.next();
    if (ucs.equals(s1)) {
      assertEquals((byte)0,ucs.getOptionFlags());
    }
 else     if (ucs.equals(s2)) {
      assertEquals((byte)1,ucs.getOptionFlags());
    }
 else {
      fail("cannot match string: " + ucs.getString());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * test simple constructor
 */
@Test public void testSimpleConstructor(){
  SSTRecord record=new SSTRecord();
  assertEquals(0,record.getNumStrings());
  assertEquals(0,record.getNumUniqueStrings());
  assertEquals(0,record.countStrings());
  byte[] output=record.serialize();
  byte[] expected={(byte)record.getSid(),(byte)(record.getSid() >> 8),(byte)8,(byte)0,(byte)0,(byte)0,(byte)0,(byte)0,(byte)0,(byte)0,(byte)0,(byte)0};
  assertEquals(expected.length,output.length);
  for (int k=0; k < expected.length; k++) {
    assertEquals(String.valueOf(k),expected[k],output[k]);
  }
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test capability of handling mondo big strings
 * @exception IOException
 */
@Test public void testHugeStrings(){
  SSTRecord record=new SSTRecord();
  byte[][] bstrings={new byte[9000],new byte[7433],new byte[9002],new byte[16998]};
  UnicodeString[] strings=new UnicodeString[bstrings.length];
  int total_length=0;
  for (int k=0; k < bstrings.length; k++) {
    Arrays.fill(bstrings[k],(byte)('a' + k));
    strings[k]=new UnicodeString(new String(bstrings[k],LocaleUtil.CHARSET_1252));
    record.addString(strings[k]);
    total_length+=3 + bstrings[k].length;
  }
  total_length+=8;
  total_length+=4;
  total_length+=(6 * 4);
  byte[] content=new byte[record.getRecordSize()];
  record.serialize(0,content);
  assertEquals(total_length,content.length);
  RecordInputStream recStream=new RecordInputStream(new ByteArrayInputStream(content));
  recStream.nextRecord();
  record=new SSTRecord(recStream);
  assertEquals(strings.length,record.getNumStrings());
  assertEquals(strings.length,record.getNumUniqueStrings());
  assertEquals(strings.length,record.countStrings());
  for (int k=0; k < strings.length; k++) {
    assertEquals(strings[k],record.getString(k));
  }
  record=new SSTRecord();
  bstrings[1]=new byte[bstrings[1].length - 1];
  for (int k=0; k < bstrings.length; k++) {
    if ((bstrings[k].length % 2) == 1) {
      Arrays.fill(bstrings[k],(byte)('a' + k));
      strings[k]=new UnicodeString(new String(bstrings[k],LocaleUtil.CHARSET_1252));
    }
 else {
      char[] data=new char[bstrings[k].length / 2];
      Arrays.fill(data,(char)('\u2122' + k));
      strings[k]=new UnicodeString(new String(data));
    }
    record.addString(strings[k]);
  }
  content=new byte[record.getRecordSize()];
  record.serialize(0,content);
  total_length--;
  assertEquals(total_length,content.length);
  recStream=new RecordInputStream(new ByteArrayInputStream(content));
  recStream.nextRecord();
  record=new SSTRecord(recStream);
  assertEquals(strings.length,record.getNumStrings());
  assertEquals(strings.length,record.getNumUniqueStrings());
  assertEquals(strings.length,record.countStrings());
  for (int k=0; k < strings.length; k++) {
    assertEquals(strings[k],record.getString(k));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestBugs </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug42016() throws Exception {
  Workbook wb=openSample("42016.xls");
  Sheet s=wb.getSheetAt(0);
  for (int row=0; row < 7; row++) {
    assertEquals("A$1+B$1",s.getRow(row).getCell(2).getCellFormula());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can delete sheets without
 * breaking the build in named ranges
 * used for printing stuff.
 */
@Test public void bug30978() throws Exception {
  HSSFWorkbook wb1=openSample("30978-alt.xls");
  assertEquals(1,wb1.getNumberOfNames());
  assertEquals(3,wb1.getNumberOfSheets());
  InternalWorkbook w=wb1.getWorkbook();
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb1.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  wb1.removeSheetAt(1);
  assertEquals(1,wb1.getNumberOfNames());
  assertEquals(2,wb1.getNumberOfSheets());
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb1.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  w=wb2.getWorkbook();
  assertEquals(1,wb2.getNumberOfNames());
  assertEquals(2,wb2.getNumberOfSheets());
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb2.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 40285:      CellIterator Skips First Column
 */
@Test public void bug40285() throws Exception {
  HSSFWorkbook wb=openSample("40285.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  int rownum=0;
  for (Iterator<Row> it=sheet.rowIterator(); it.hasNext(); rownum++) {
    Row row=it.next();
    assertEquals(rownum,row.getRowNum());
    int cellNum=0;
    for (Iterator<Cell> it2=row.cellIterator(); it2.hasNext(); cellNum++) {
      Cell cell=it2.next();
      assertEquals(cellNum,cell.getColumnIndex());
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * From the mailing list - ensure we can handle a formula
 * containing a zip code, eg ="70164"
 */
@Test public void bugZipCodeFormulas() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet();
  s.createRow(0);
  HSSFCell c1=s.getRow(0).createCell(0);
  HSSFCell c2=s.getRow(0).createCell(1);
  HSSFCell c3=s.getRow(0).createCell(2);
  c1.setCellFormula("70164");
  c2.setCellFormula("\"70164\"");
  c3.setCellFormula("\"90210\"");
  assertEquals("70164",c1.getCellFormula());
  assertEquals("\"70164\"",c2.getCellFormula());
  confirmCachedValue(0.0,c1);
  confirmCachedValue(0.0,c2);
  confirmCachedValue(0.0,c3);
  c3.setCellValue(new HSSFRichTextString("test"));
  confirmCachedValue("test",c3);
  try {
    c3.getNumericCellValue();
    fail("exception should have been thrown");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cannot get a numeric value from a text formula cell",e.getMessage());
  }
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  eval.evaluateFormulaCell(c1);
  eval.evaluateFormulaCell(c2);
  eval.evaluateFormulaCell(c3);
  confirmCachedValue(70164.0,c1);
  confirmCachedValue("70164",c2);
  confirmCachedValue("90210",c3);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet ns=wb2.getSheetAt(0);
  HSSFCell nc1=ns.getRow(0).getCell(0);
  HSSFCell nc2=ns.getRow(0).getCell(1);
  HSSFCell nc3=ns.getRow(0).getCell(2);
  confirmCachedValue(70164.0,nc1);
  confirmCachedValue("70164",nc2);
  confirmCachedValue("90210",nc3);
  @SuppressWarnings("deprecation") CellValueRecordInterface[] cvrs=ns.getSheet().getValueRecords();
  for (int i=0; i < cvrs.length; i++) {
    CellValueRecordInterface cvr=cvrs[i];
    if (cvr instanceof FormulaRecordAggregate) {
      FormulaRecordAggregate fr=(FormulaRecordAggregate)cvr;
      if (i == 0) {
        assertEquals(70164.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNull(fr.getStringRecord());
      }
 else       if (i == 1) {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("70164",fr.getStringRecord().getString());
      }
 else {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("90210",fr.getStringRecord().getString());
      }
    }
  }
  assertEquals(3,cvrs.length);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 29942: Importing Excel files that have been created by Open Office on Linux
 */
@Test public void bug29942() throws Exception {
  HSSFWorkbook wb=openSample("29942.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  int count=0;
  for (int i=sheet.getFirstRowNum(); i <= sheet.getLastRowNum(); i++) {
    HSSFRow row=sheet.getRow(i);
    if (row != null) {
      HSSFCell cell=row.getCell(0);
      assertEquals(Cell.CELL_TYPE_STRING,cell.getCellType());
      count++;
    }
  }
  assertEquals(85,count);
  writeOutAndReadBack(wb).close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * User reported the wrong number of rows from the
 * iterator, but we can't replicate that
 */
@Test public void bug44693() throws Exception {
  HSSFWorkbook wb=openSample("44693.xls");
  HSSFSheet s=wb.getSheetAt(0);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(712,s.getLastRowNum());
  assertEquals(713,s.getPhysicalNumberOfRows());
  int rowsSeen=0;
  for (Iterator<Row> i=s.rowIterator(); i.hasNext(); ) {
    Row r=i.next();
    assertNotNull(r);
    rowsSeen++;
  }
  assertEquals(713,rowsSeen);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestFormulaEvaluatorBugs </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void test55747_55324() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFFormulaEvaluator ev=wb.getCreationHelper().createFormulaEvaluator();
  HSSFSheet ws=wb.createSheet();
  HSSFRow row=ws.createRow(0);
  HSSFCell cell;
  cell=row.createCell(0);
  cell.setCellValue("abc");
  cell=row.createCell(1);
  cell.setCellFormula("IF(A1<>\"\",MID(A1,1,2),\"X\")");
  cell=row.createCell(2);
  cell.setCellFormula("IF(A1<>\"\",\"A\",\"B\")");
  cell=row.createCell(3);
  cell.setCellFormula("IF(A1=\"\",\"X\",MID(A1,1,2))");
  cell=row.createCell(4);
  cell.setCellFormula("IF(A1<>\"\",\"X\",MID(A1,1,2))");
  cell=row.createCell(5);
  cell.setCellFormula("IF(A1=\"\",MID(A1,1,2),MID(A1,2,2))");
  cell=row.createCell(6);
  cell.setCellFormula("IF(A1<>\"\",MID(A1,1,2),MID(A1,2,2))");
  cell=row.createCell(7);
  cell.setCellFormula("IF(MID(A1,1,2)<>\"\",\"A\",\"B\")");
  row=ws.createRow(1);
  cell=row.createCell(1);
  cell.setCellFormula("MID(A1,1,2)");
  cell=row.createCell(2);
  cell.setCellFormula("MID(A1,2,2)");
  cell=row.createCell(3);
  cell.setCellFormula("MID(A1,2,1)");
  cell=row.createCell(4);
  cell.setCellFormula("MID(A1,3,1)");
  ev.evaluateAll();
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  ws=wb.getSheetAt(0);
  row=ws.getRow(1);
  for (int i=1; i <= 4; i++) {
    cell=row.getCell(i);
    Ptg[] ptgs=getPtgs(cell);
    assertEquals(4,ptgs.length);
    assertEquals(FuncPtg.class,ptgs[3].getClass());
    assertEquals("MID",((FuncPtg)ptgs[3]).getName());
    assertRefPtgA1('V',ptgs,0);
  }
  row=ws.getRow(0);
  cell=row.getCell(CellReference.convertColStringToIndex("H"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("E"));
  assertRefPtgA1('V',getPtgs(cell),0);
  assertRefPtgA1('R',getPtgs(cell),6);
  cell=row.getCell(CellReference.convertColStringToIndex("B"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("D"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("F"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("G"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("A"));
  assertEquals("abc",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("B"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("C"));
  assertEquals("A",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("D"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("E"));
  assertEquals("X",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("F"));
  assertEquals("bc",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("G"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("H"));
  assertEquals("A",cell.getStringCellValue());
  if (OUTPUT_TEST_FILES) {
    FileOutputStream out=new FileOutputStream("/tmp/test.xls");
    wb.write(out);
    out.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFComment </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBug56380InsertTooManyComments() throws Exception {
  HSSFWorkbook workbook=new HSSFWorkbook();
  try {
    Sheet sheet=workbook.createSheet();
    Drawing drawing=sheet.createDrawingPatriarch();
    String comment="c";
    for (int rowNum=0; rowNum < 258; rowNum++) {
      sheet.createRow(rowNum);
    }
    for (int count=1025; count < 65535; count++) {
      int rowNum=count / 255;
      int cellNum=count % 255;
      Cell cell=sheet.getRow(rowNum).createCell(cellNum);
      try {
        Comment commentObj=insertComment(drawing,cell,comment + cellNum);
        assertEquals(count,((HSSFComment)commentObj).getNoteRecord().getShapeId());
      }
 catch (      IllegalArgumentException e) {
        throw new IllegalArgumentException("While adding shape number " + count,e);
      }
    }
    Row row=sheet.createRow(257);
    Cell cell=row.createCell(0);
    insertComment(drawing,cell,comment + 0);
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFDataFormatter </h4><pre class="type-2 type-12 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test using a default number format. The format should be used when a
 * format pattern cannot be parsed by DecimalFormat.
 */
@Test public void testSetDefaultNumberFormat(){
  HSSFRow row=wb.getSheetAt(0).getRow(3);
  Iterator<Cell> it=row.cellIterator();
  DecimalFormatSymbols dfs=DecimalFormatSymbols.getInstance(LocaleUtil.getUserLocale());
  Format defaultFormat=new DecimalFormat("Balance $#,#00.00 USD;Balance -$#,#00.00 USD",dfs);
  formatter.setDefaultNumberFormat(defaultFormat);
  log("\n==== DEFAULT NUMBER FORMAT ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    cell.setCellValue(cell.getNumericCellValue() * Math.random() / 1000000 - 1000);
    log(formatter.formatCellValue(cell));
    String formatted=formatter.formatCellValue(cell);
    assertTrue("Doesn't start with Balance: " + formatted,formatted.startsWith("Balance "));
    assertTrue("Doesn't end with USD: " + formatted,formatted.endsWith(" USD"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting formatted values from numeric and date cells.
 */
@Test public void testGetFormattedCellValueHSSFCell(){
  HSSFRow row=wb.getSheetAt(0).getRow(0);
  Iterator<Cell> it=row.cellIterator();
  log("==== VALID DATE FORMATS ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    String fmtval=formatter.formatCellValue(cell);
    log(fmtval);
    assertTrue(DateUtil.isCellDateFormatted(cell));
    assertTrue(!"555.555".equals(fmtval));
    String fmt=cell.getCellStyle().getDataFormatString();
    String monthPtrn=fmt.indexOf("mmmm") != -1 ? "MMMM" : "MMM";
    SimpleDateFormat sdf=new SimpleDateFormat(monthPtrn,LocaleUtil.getUserLocale());
    sdf.setTimeZone(LocaleUtil.getUserTimeZone());
    Calendar calDef=LocaleUtil.getLocaleCalendar(2010,6,15,0,0,0);
    String jul=sdf.format(calDef.getTime());
    if (fmt.indexOf("mmmmm") > -1) {
      jul=jul.substring(0,1);
    }
    assertTrue("Format came out incorrect - " + fmt,fmtval.indexOf(jul) > -1);
  }
  row=wb.getSheetAt(0).getRow(1);
  it=row.cellIterator();
  log("==== VALID TIME FORMATS ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    String fmt=cell.getCellStyle().getDataFormatString();
    String fmtval=formatter.formatCellValue(cell);
    log(fmtval);
    assertTrue(DateUtil.isCellDateFormatted(cell));
    assertTrue(!"555.47431".equals(fmtval));
    assertTrue("Format came out incorrect - " + fmt + " - found "+ fmtval+ ", but expected to find '11:23'",fmtval.indexOf("11:23") > -1);
  }
  row=wb.getSheetAt(0).getRow(1);
  it=row.cellIterator();
  log("\n==== VALID NUMBER FORMATS ====");
  while (it.hasNext()) {
    HSSFCell cell=(HSSFCell)it.next();
    final String formatted=formatter.formatCellValue(cell);
    log(formatted);
    assertTrue(formatted != null && !formatted.contains("12345678"));
  }
  row=wb.getSheetAt(0).getRow(3);
  it=row.cellIterator();
  log("\n==== INVALID NUMBER FORMATS ====");
  while (it.hasNext()) {
    HSSFCell cell=(HSSFCell)it.next();
    log(formatter.formatCellValue(cell));
    char decimalSeparator=DecimalFormatSymbols.getInstance(LocaleUtil.getUserLocale()).getDecimalSeparator();
    assertEquals("12345678" + decimalSeparator + "9",formatter.formatCellValue(cell));
  }
  row=wb.getSheetAt(0).getRow(4);
  HSSFCell cell=row.getCell(0);
  log("\n==== ZIP FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("12345-6789",formatter.formatCellValue(cell));
  row=wb.getSheetAt(0).getRow(5);
  cell=row.getCell(0);
  log("\n==== PHONE FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("(555) 123-4567",formatter.formatCellValue(cell));
  row=wb.getSheetAt(0).getRow(6);
  cell=row.getCell(0);
  log("\n==== SSN FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("444-55-1234",formatter.formatCellValue(cell));
  assertEquals(formatter.formatCellValue(null),"");
  assertEquals(formatter.formatCellValue(null),"");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFDateUtil </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of a java.util.date to Excel on a day when
 * Daylight Saving Time starts.
 */
@Test public void excelConversionOnDSTStart(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,MARCH,28,0,0,0);
  for (int hour=0; hour < 24; hour++) {
    if (hour == 2) {
      continue;
    }
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=cal.getTime();
    double excelDate=HSSFDateUtil.getExcelDate(javaDate,false);
    double difference=excelDate - Math.floor(excelDate);
    int differenceInHours=(int)(difference * 24 * 60 + 0.5) / 60;
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",hour,differenceInHours);
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",javaDate.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of an Excel date to a java.util.date on a day when
 * Daylight Saving Time starts.
 */
@Test public void javaConversionOnDSTStart(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,MARCH,28,0,0,0);
  double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
  double oneHour=1.0 / 24;
  double oneMinute=oneHour / 60;
  for (int hour=0; hour < 24; hour++, excelDate+=oneHour) {
    if (hour == 2) {
      continue;
    }
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=HSSFDateUtil.getJavaDate(excelDate,false);
    double actDate=HSSFDateUtil.getExcelDate(javaDate,false);
    assertEquals("Checking " + hour + " hours on Daylight Saving Time start date",excelDate,actDate,oneMinute);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of a java.util.Date to Excel on a day when
 * Daylight Saving Time ends.
 */
@Test public void excelConversionOnDSTEnd(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,OCTOBER,31,0,0,0);
  for (int hour=0; hour < 24; hour++) {
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=cal.getTime();
    double excelDate=HSSFDateUtil.getExcelDate(javaDate,false);
    double difference=excelDate - Math.floor(excelDate);
    int differenceInHours=(int)(difference * 24 * 60 + 0.5) / 60;
    assertEquals("Checking " + hour + " hour on Daylight Saving Time end date",hour,differenceInHours);
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",javaDate.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of an Excel date to java.util.Date on a day when
 * Daylight Saving Time ends.
 */
@Test public void javaConversionOnDSTEnd(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,OCTOBER,31,0,0,0);
  double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
  double oneHour=1.0 / 24;
  double oneMinute=oneHour / 60;
  for (int hour=0; hour < 24; hour++, excelDate+=oneHour) {
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=HSSFDateUtil.getJavaDate(excelDate,false);
    assertEquals("Checking " + hour + " hours on Daylight Saving Time start date",excelDate,HSSFDateUtil.getExcelDate(javaDate,false),oneMinute);
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that we correctly detect date formats as such
 */
@Test public void identifyDateFormats(){
  short[] builtins=new short[]{0x0e,0x0f,0x10,0x16,0x2d,0x2e};
  for (int i=0; i < builtins.length; i++) {
    String formatStr=HSSFDataFormat.getBuiltinFormat(builtins[i]);
    assertTrue(HSSFDateUtil.isInternalDateFormat(builtins[i]));
    assertTrue(HSSFDateUtil.isADateFormat(builtins[i],formatStr));
  }
  builtins=new short[]{0x01,0x02,0x17,0x1f,0x30};
  for (int i=0; i < builtins.length; i++) {
    String formatStr=HSSFDataFormat.getBuiltinFormat(builtins[i]);
    assertFalse(HSSFDateUtil.isInternalDateFormat(builtins[i]));
    assertFalse(HSSFDateUtil.isADateFormat(builtins[i],formatStr));
  }
  int numBuiltins=HSSFDataFormat.getNumberOfBuiltinBuiltinFormats();
  assertTrue(numBuiltins < 60);
  short formatId=60;
  assertFalse(HSSFDateUtil.isInternalDateFormat(formatId));
  String[] formats=new String[]{"yyyy-mm-dd","yyyy/mm/dd","yy/mm/dd","yy/mmm/dd","dd/mm/yy","dd/mm/yyyy","dd/mmm/yy","dd-mm-yy","dd-mm-yyyy","DD-MM-YY","DD-mm-YYYY","dd\\-mm\\-yy","dd.mm.yyyy","dd\\.mm\\.yyyy","dd\\ mm\\.yyyy AM","dd\\ mm\\.yyyy pm","dd\\ mm\\.yyyy\\-dd","[h]:mm:ss","mm/dd/yy","\"mm\"/\"dd\"/\"yy\"","m\\/d\\/yyyy","yyyy-mm-dd;@","yyyy/mm/dd;@","dd-mm-yy;@","dd-mm-yyyy;@","[$-F800]dddd\\,\\ mmm\\ dd\\,\\ yyyy","[$-F900]ddd/mm/yyy","[BLACK]dddd/mm/yy","[yeLLow]yyyy-mm-dd"};
  for (int i=0; i < formats.length; i++) {
    assertTrue(formats[i] + " is a date format",HSSFDateUtil.isADateFormat(formatId,formats[i]));
  }
  formats=new String[]{"yyyy-mm-dd hh:mm:ss","yyyy/mm/dd HH:MM:SS","mm/dd HH:MM","yy/mmm/dd SS","mm/dd HH:MM AM","mm/dd HH:MM am","mm/dd HH:MM PM","mm/dd HH:MM pm","m/d/yy h:mm AM/PM","hh:mm:ss","hh:mm:ss.0","mm:ss.0","[hh]","[mm]","[ss]","[SS]","[red][hh]"};
  for (int i=0; i < formats.length; i++) {
    assertTrue(formats[i] + " is a datetime format",HSSFDateUtil.isADateFormat(formatId,formats[i]));
  }
  formats=new String[]{"yyyy*mm*dd","0.0","0.000","0%","0.0%","[]Foo","[BLACK]0.00%","[ms]","[Mh]","",null};
  for (int i=0; i < formats.length; i++) {
    assertFalse(formats[i] + " is not a date or datetime format",HSSFDateUtil.isADateFormat(formatId,formats[i]));
  }
  formats=new String[]{"yyyy:mm:dd"};
  for (int i=0; i < formats.length; i++) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the date conversion functions in the HSSFDateUtil class.
 */
@Test public void dateConversion(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2002,JANUARY,1,0,1,1);
  for (int hour=0; hour < 23; hour++) {
    double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
    assertEquals("Checking hour = " + hour,cal.getTime().getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
    cal.add(Calendar.HOUR_OF_DAY,1);
  }
  double excelDate=36526.0;
  cal.set(2000,JANUARY,1,0,0,0);
  Date dateIf1900=cal.getTime();
  cal.add(Calendar.YEAR,4);
  cal.add(Calendar.DATE,1);
  Date dateIf1904=cal.getTime();
  assertEquals("Checking 1900 Date Windowing",dateIf1900.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  assertEquals("Checking 1904 Date Windowing",dateIf1904.getTime(),HSSFDateUtil.getJavaDate(excelDate,true).getTime());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that we deal with time-zones properly
 */
@Test public void calendarConversion(){
  TimeZone userTZ=LocaleUtil.getUserTimeZone();
  LocaleUtil.setUserTimeZone(TimeZone.getTimeZone("CET"));
  try {
    Calendar cal=LocaleUtil.getLocaleCalendar(2002,JANUARY,1,12,1,1);
    Date expected=cal.getTime();
    for (int hour=-12; hour <= 12; hour++) {
      String id="GMT" + (hour < 0 ? "" : "+") + hour+ ":00";
      cal.setTimeZone(TimeZone.getTimeZone(id));
      cal.set(Calendar.HOUR_OF_DAY,12);
      double excelDate=HSSFDateUtil.getExcelDate(cal,false);
      Date javaDate=HSSFDateUtil.getJavaDate(excelDate);
      assertEquals("Checking timezone " + id,expected.getTime(),javaDate.getTime());
    }
    TimeZone cet=TimeZone.getTimeZone("Europe/Copenhagen");
    TimeZone ldn=TimeZone.getTimeZone("Europe/London");
    double excelDate=41026.53125;
    assertEquals(HSSFDateUtil.getJavaDate(excelDate,false).getTime(),HSSFDateUtil.getJavaDate(excelDate,false,cet).getTime());
    Date cetDate=HSSFDateUtil.getJavaDate(excelDate,false);
    Date ldnDate=HSSFDateUtil.getJavaDate(excelDate,false,ldn);
    assertEquals(ldnDate.getTime() - cetDate.getTime(),60 * 60 * 1000);
  }
  finally {
    LocaleUtil.setUserTimeZone(userTZ);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFName </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * When setting A1 type of references with HSSFName.setRefersToFormula
 * must set the type of operands to Ptg.CLASS_REF,
 * otherwise created named don't appear in the drop-down to the left of formula bar in Excel
 */
@Test public void testTypeOfRootPtg() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  wb.createSheet("CSCO");
  Ptg[] ptgs=HSSFFormulaParser.parse("CSCO!$E$71",wb,FormulaType.NAMEDRANGE,0);
  for (int i=0; i < ptgs.length; i++) {
    assertEquals('R',ptgs[i].getRVAType());
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheet </h4><pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void columnWidthShort() throws IOException {
  HSSFWorkbook wb1=new HSSFWorkbook();
  Sheet sheet=wb1.createSheet();
  sheet.setDefaultColumnWidth((short)10);
  assertEquals(10,sheet.getDefaultColumnWidth());
  assertEquals(256 * 10,sheet.getColumnWidth((short)0));
  assertEquals(256 * 10,sheet.getColumnWidth((short)1));
  assertEquals(256 * 10,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    sheet.setColumnWidth((short)i,w);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setDefaultColumnWidth((short)20);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setColumnWidth((short)10,40000);
  assertEquals(40000,sheet.getColumnWidth((short)10));
  try {
    sheet.setColumnWidth((short)9,256 * 256);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum column width for an individual cell is 255 characters.",e.getMessage());
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  assertEquals(40000,sheet.getColumnWidth((short)10));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void columnWidthA() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("colwidth.xls");
  int[] ref={365,548,731,914,1097,1280,1462,1645,1828,2011,2194,2377,2560,2742,2925,3108,3291,3474,3657};
  HSSFSheet sh=wb1.getSheetAt(0);
  for (char i='A'; i <= 'S'; i++) {
    int idx=i - 'A';
    int w=sh.getColumnWidth(idx);
    assertEquals(ref[idx],w);
  }
  sh=wb1.getSheetAt(1);
  int def_width=sh.getDefaultColumnWidth();
  for (char i='A'; i <= 'S'; i++) {
    int idx=i - 'A';
    int w=sh.getColumnWidth(idx);
    assertEquals(def_width * 256,w);
  }
  wb1.close();
  HSSFWorkbook wb2=new HSSFWorkbook();
  sh=wb2.createSheet();
  sh.setDefaultColumnWidth(10);
  assertEquals(10,sh.getDefaultColumnWidth());
  assertEquals(256 * 10,sh.getColumnWidth(0));
  assertEquals(256 * 10,sh.getColumnWidth(1));
  assertEquals(256 * 10,sh.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    sh.setColumnWidth(i,w);
    assertEquals(w,sh.getColumnWidth(i));
  }
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sh=wb3.getSheetAt(0);
  assertEquals(10,sh.getDefaultColumnWidth());
  assertEquals(256 * 10,sh.getColumnWidth(0));
  assertEquals(256 * 10,sh.getColumnWidth(1));
  assertEquals(256 * 10,sh.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sh.getColumnWidth(i));
  }
  sh.setColumnWidth(0,40000);
  assertEquals(40000,sh.getColumnWidth(0));
  wb3.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void defaultColumnWidth() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("12843-1.xls");
  HSSFSheet sheet=wb1.getSheetAt(7);
  assertEquals(8,sheet.getDefaultColumnWidth());
  assertEquals(8 * 256,sheet.getColumnWidth(0));
  assertEquals(0xFF,sheet.getDefaultRowHeight());
  wb1.close();
  HSSFWorkbook wb2=HSSFTestDataSamples.openSampleWorkbook("34775.xls");
  for (int i=1; i <= 2; i++) {
    int dw=wb2.getSheetAt(i).getDefaultColumnWidth();
    assertEquals(8,dw);
    int cw=wb2.getSheetAt(i).getColumnWidth(0);
    assertEquals(8 * 256,cw);
    assertEquals(0xFF,sheet.getDefaultRowHeight());
  }
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFWorkbook </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void clonePictures() throws IOException {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("SimpleWithImages.xls");
  InternalWorkbook iwb=wb.getWorkbook();
  iwb.findDrawingGroup();
  for (int pictureIndex=1; pictureIndex <= 4; pictureIndex++) {
    EscherBSERecord bse=iwb.getBSERecord(pictureIndex);
    assertEquals(1,bse.getRef());
  }
  wb.cloneSheet(0);
  for (int pictureIndex=1; pictureIndex <= 4; pictureIndex++) {
    EscherBSERecord bse=iwb.getBSERecord(pictureIndex);
    assertEquals(2,bse.getRef());
  }
  wb.cloneSheet(0);
  for (int pictureIndex=1; pictureIndex <= 4; pictureIndex++) {
    EscherBSERecord bse=iwb.getBSERecord(pictureIndex);
    assertEquals(3,bse.getRef());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test49423() throws Exception {
  HSSFWorkbook workbook=HSSFTestDataSamples.openSampleWorkbook("49423.xls");
  boolean found=false;
  int numSheets=workbook.getNumberOfSheets();
  for (int i=0; i < numSheets; i++) {
    HSSFSheet sheet=workbook.getSheetAt(i);
    List<HSSFShape> shapes=sheet.getDrawingPatriarch().getChildren();
    for (    HSSFShape shape : shapes) {
      HSSFAnchor anchor=shape.getAnchor();
      if (anchor instanceof HSSFClientAnchor) {
        HSSFClientAnchor clientAnchor=(HSSFClientAnchor)anchor;
        assertNotNull(clientAnchor);
        found=true;
      }
 else       if (anchor instanceof HSSFChildAnchor) {
        HSSFChildAnchor childAnchor=(HSSFChildAnchor)anchor;
        assertNotNull(childAnchor);
        found=true;
      }
    }
  }
  assertTrue("Should find some images via Client or Child anchors, but did not find any at all",found);
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestUnfixedBugs </h4><pre class="type-12 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFormulaRecordAggregate() throws Exception {
  Workbook wb=HSSFTestDataSamples.openSampleWorkbook("44958.xls");
  try {
    for (int i=0; i < wb.getNumberOfSheets(); i++) {
      Sheet sheet=wb.getSheetAt(i);
      assertNotNull(wb.getSheet(sheet.getSheetName()));
      sheet.groupColumn((short)4,(short)5);
      sheet.setColumnGroupCollapsed(4,true);
      sheet.setColumnGroupCollapsed(4,false);
      for (      Row row : sheet) {
        for (        Cell cell : row) {
          try {
            cell.toString();
          }
 catch (          Exception e) {
            throw new Exception("While handling: " + sheet.getSheetName() + "/"+ row.getRowNum()+ "/"+ cell.getColumnIndex(),e);
          }
        }
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-12 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFormulaRecordAggregate_1() throws Exception {
  Workbook wb=HSSFTestDataSamples.openSampleWorkbook("44958_1.xls");
  try {
    for (int i=0; i < wb.getNumberOfSheets(); i++) {
      Sheet sheet=wb.getSheetAt(i);
      assertNotNull(wb.getSheet(sheet.getSheetName()));
      sheet.groupColumn((short)4,(short)5);
      sheet.setColumnGroupCollapsed(4,true);
      sheet.setColumnGroupCollapsed(4,false);
      for (      Row row : sheet) {
        for (        Cell cell : row) {
          try {
            cell.toString();
          }
 catch (          Exception e) {
            throw new Exception("While handling: " + sheet.getSheetName() + "/"+ row.getRowNum()+ "/"+ cell.getColumnIndex(),e);
          }
        }
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hwpf.usermodel.TestPictures </h4><pre class="type-2 type-12 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * emf image, nice and simple
 */
@Test public void testEmfImage(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("vector_image.doc");
  List<Picture> pics=doc.getPicturesTable().getAllPictures();
  assertNotNull(pics);
  assertEquals(1,pics.size());
  Picture pic=pics.get(0);
  assertNotNull(pic.suggestFileExtension());
  assertNotNull(pic.suggestFullFileName());
  assertTrue(pic.getSize() > 128);
  byte[] emf=POIDataSamples.getDocumentInstance().readFile("vector_image.emf");
  byte[] pemf=pic.getContent();
  assertEquals(emf.length,pemf.length);
  for (int i=0; i < emf.length; i++) {
    assertEquals(emf[i],pemf[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * two jpegs
 */
@Test public void testTwoImages(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("two_images.doc");
  List<Picture> pics=doc.getPicturesTable().getAllPictures();
  assertNotNull(pics);
  assertEquals(pics.size(),2);
  for (int i=0; i < pics.size(); i++) {
    Picture pic=pics.get(i);
    assertNotNull(pic.suggestFileExtension());
    assertNotNull(pic.suggestFullFileName());
  }
  Picture picA=pics.get(0);
  Picture picB=pics.get(1);
  assertEquals("jpg",picA.suggestFileExtension());
  assertEquals("png",picB.suggestFileExtension());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestDecryptor </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug57080() throws Exception {
  File f=POIDataSamples.getPOIFSInstance().getFile("extenxls_pwd123.xlsx");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(f,true);
  EncryptionInfo info=new EncryptionInfo(fs);
  Decryptor d=Decryptor.getInstance(info);
  d.verifyPassword("pwd123");
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ZipInputStream zis=new ZipInputStream(d.getDataStream(fs));
  ZipEntry ze;
  while ((ze=zis.getNextEntry()) != null) {
    bos.reset();
    IOUtils.copy(zis,bos);
    assertEquals(ze.getSize(),bos.size());
  }
  zis.close();
  fs.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestNPOIFSFileSystem </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check that for a given block, we can correctly figure
 * out what the next one is
 */
@Test public void nextBlock() throws Exception {
  NPOIFSFileSystem fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  NPOIFSFileSystem fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    for (int i=0; i < 21; i++) {
      assertEquals(i + 1,fs.getNextBlock(i));
    }
    assertEquals(89,fs.getNextBlock(21));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(89));
    for (int i=22; i < 88; i++) {
      assertEquals(i + 1,fs.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(88));
    for (int i=90; i < 96; i++) {
      assertEquals(i + 1,fs.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(96));
    assertEquals(98,fs.getNextBlock(97));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(98));
    assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(99));
    for (int i=100; i < fs.getBigBlockSizeDetails().getBATEntriesPerBlock(); i++) {
      assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(i));
    }
    fs.close();
  }
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    assertEquals(1,fs.getNextBlock(0));
    assertEquals(2,fs.getNextBlock(1));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
    for (int i=4; i < 11; i++) {
      assertEquals(i + 1,fs.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(11));
    fs.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ask for free blocks where no free ones exist, and so the
 * file needs to be extended and another BAT/XBAT added
 */
@Test public void getFreeBlockWithNoneSpare() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  int free;
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(99));
  assertBATCount(fs,1,0);
  for (int i=100; i < 128; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(i));
  }
  assertEquals(true,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  for (int i=100; i < 128; i++) {
    fs.setNextBlock(i,POIFSConstants.END_OF_CHAIN);
  }
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
    fail("Should only be one BAT");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,1,0);
  assertEquals(129,fs.getFreeBlock());
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(128));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(129));
  assertBATCount(fs,2,0);
  for (int i=0; i < 109; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
  }
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(109 * 128).getBlock().hasFreeSectors());
    fail("Should only be 109 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,109,0);
  HeaderBlock header=writeOutAndReadHeader(fs);
  assertEquals(109,header.getBATCount());
  assertEquals(0,header.getXBATCount());
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(110 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(110 * 128).getBlock().hasFreeSectors());
    fail("Should only be 110 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,110,1);
  header=writeOutAndReadHeader(fs);
  assertEquals(110,header.getBATCount());
  assertEquals(1,header.getXBATCount());
  for (int i=109; i < 109 + 127; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
    assertBATCount(fs,i + 1,1);
  }
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(236 * 128).getBlock().hasFreeSectors());
    fail("Should only be 236 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,236,1);
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,237,2);
  header=writeOutAndReadHeader(fs);
  fs=writeOutAndReadBack(fs);
  assertBATCount(fs,237,2);
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propertiesAndFatOnRead() throws Exception {
  NPOIFSFileSystem fsA, fsB;
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(140);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(98,fs.getNextBlock(97));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(98));
    NPropertyTable props=fs._get_property_table();
    assertEquals(90,props.getStartBlock());
    assertEquals(7,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    try {
      ministore.getBATBlockAndIndex(256);
      fail("Should only be two SBATs, but a 3rd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(1040);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(1,fs.getNextBlock(0));
    assertEquals(2,fs.getNextBlock(1));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
    NPropertyTable props=fs._get_property_table();
    assertEquals(12,props.getStartBlock());
    assertEquals(1,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    ministore.getBATBlockAndIndex(1023);
    try {
      ministore.getBATBlockAndIndex(1024);
      fail("Should only be one SBAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestNPOIFSMiniStore </h4><pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we will extend the underlying chain of 
 * big blocks that make up the ministream as needed
 */
@Test public void testCreateBlockIfNeeded() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSMiniStore ministore=fs.getMiniStore();
  assertEquals(179,ministore.getNextBlock(178));
  assertEquals(180,ministore.getNextBlock(179));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(180));
  for (int i=181; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  for (int i=0; i <= 183; i++) {
    ministore.getBlockAt(i);
  }
  try {
    ministore.getBlockAt(184);
    fail("No block at 184");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  Iterator<ByteBuffer> it=new NPOIFSStream(fs,fs.getRoot().getProperty().getStartBlock()).getBlockIterator();
  int count=0;
  while (it.hasNext()) {
    count++;
    it.next();
  }
  assertEquals(23,count);
  ministore.createBlockIfNeeded(184);
  it=new NPOIFSStream(fs,fs.getRoot().getProperty().getStartBlock()).getBlockIterator();
  count=0;
  while (it.hasNext()) {
    count++;
    it.next();
  }
  assertEquals(24,count);
  for (int i=0; i <= 191; i++) {
    ministore.getBlockAt(i);
  }
  try {
    ministore.getBlockAt(192);
    fail("No block at 192");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  byte[] data=new byte[15 * 64];
  NPOIFSStream stream=new NPOIFSStream(ministore,178);
  stream.updateContents(data);
  assertEquals(179,ministore.getNextBlock(178));
  assertEquals(180,ministore.getNextBlock(179));
  assertEquals(181,ministore.getNextBlock(180));
  assertEquals(182,ministore.getNextBlock(181));
  assertEquals(183,ministore.getNextBlock(182));
  assertEquals(184,ministore.getNextBlock(183));
  assertEquals(185,ministore.getNextBlock(184));
  assertEquals(186,ministore.getNextBlock(185));
  assertEquals(187,ministore.getNextBlock(186));
  assertEquals(188,ministore.getNextBlock(187));
  assertEquals(189,ministore.getNextBlock(188));
  assertEquals(190,ministore.getNextBlock(189));
  assertEquals(191,ministore.getNextBlock(190));
  assertEquals(192,ministore.getNextBlock(191));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(192));
  for (int i=193; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  fs.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ask for free blocks where no free ones exist, and so the
 * stream needs to be extended and another SBAT added
 */
@Test public void testGetFreeBlockWithNoneSpare() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSMiniStore ministore=fs.getMiniStore();
  for (int i=181; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(true,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  for (int i=181; i < 256; i++) {
    ministore.setNextBlock(i,POIFSConstants.END_OF_CHAIN);
  }
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(false,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  try {
    assertEquals(false,ministore.getBATBlockAndIndex(256).getBlock().hasFreeSectors());
    fail("Should only be two SBATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertEquals(256,ministore.getFreeBlock());
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(false,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  assertEquals(true,ministore.getBATBlockAndIndex(256).getBlock().hasFreeSectors());
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(254));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(255));
  assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(256));
  assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(257));
  fs.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check that for a given mini block, we can correctly figure
 * out what the next one is
 */
@Test public void testNextBlock() throws Exception {
  NPOIFSFileSystem fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  NPOIFSFileSystem fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSFileSystem fsC=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  NPOIFSFileSystem fsD=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB,fsC,fsD}) {
    NPOIFSMiniStore ministore=fs.getMiniStore();
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    for (int i=51; i < 103; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(103));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(104));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(105));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(106));
    for (int i=107; i < 154; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(154));
    for (int i=155; i < 160; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(160));
    for (int i=161; i < 166; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(166));
    for (int i=167; i < 172; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(172));
    assertEquals(174,ministore.getNextBlock(173));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(174));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(175));
    assertEquals(177,ministore.getNextBlock(176));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(177));
    assertEquals(179,ministore.getNextBlock(178));
    assertEquals(180,ministore.getNextBlock(179));
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(180));
    for (int i=181; i < fs.getBigBlockSizeDetails().getBATEntriesPerBlock(); i++) {
      assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
    }
  }
  fsD.close();
  fsC.close();
  fsB.close();
  fsA.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check we get the right data back for each block
 */
@Test public void testGetBlock() throws Exception {
  NPOIFSFileSystem fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  NPOIFSFileSystem fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSFileSystem fsC=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  NPOIFSFileSystem fsD=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB,fsC,fsD}) {
    assertEquals(0,fs._get_property_table().getRoot().getStartBlock());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ByteBuffer b;
    b=ministore.getBlockAt(0);
    assertEquals((byte)0x9e,b.get());
    assertEquals((byte)0x75,b.get());
    assertEquals((byte)0x97,b.get());
    assertEquals((byte)0xf6,b.get());
    assertEquals((byte)0xff,b.get());
    assertEquals((byte)0x21,b.get());
    assertEquals((byte)0xd2,b.get());
    assertEquals((byte)0x11,b.get());
    b=ministore.getBlockAt(1);
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x03,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x12,b.get());
    assertEquals((byte)0x02,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    b=ministore.getBlockAt(180);
    assertEquals((byte)0x30,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x00,b.get());
    assertEquals((byte)0x80,b.get());
    for (int i=181; i < 184; i++) {
      b=ministore.getBlockAt(i);
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
      assertEquals((byte)0,b.get());
    }
  }
  fsD.close();
  fsC.close();
  fsB.close();
  fsA.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.property.TestRootProperty </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetSize(){
  for (int j=0; j < 10; j++) {
    createBasicRootProperty();
    _property.setSize(j);
    assertEquals("trying block count of " + j,j * 64,_property.getSize());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.storage.TestBlockListImpl </h4><pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove() throws IOException {
  BlockListImpl list=create();
  RawDataBlock[] blocks=new RawDataBlock[5];
  byte[] data=new byte[512 * 5];
  for (int j=0; j < 5; j++) {
    Arrays.fill(data,j * 512,(j * 512) + 512,(byte)j);
  }
  ByteArrayInputStream stream=new ByteArrayInputStream(data);
  for (int j=0; j < 5; j++) {
    blocks[j]=new RawDataBlock(stream);
  }
  list.setBlocks(blocks);
  for (int j=-2; j < 10; j++) {
    if ((j < 0) || (j >= 5)) {
      try {
        list.remove(j);
        fail("removing item " + j + " should have failed");
      }
 catch (      IOException ignored) {
      }
    }
  }
  for (int j=0; j < 5; j++) {
    byte[] output=list.remove(j).getData();
    for (int k=0; k < 512; k++) {
      assertEquals("testing block " + j + ", index "+ k,data[(j * 512) + k],output[k]);
    }
  }
  for (int j=0; j < 5; j++) {
    try {
      list.remove(j);
      fail("removing item " + j + " should not have succeeded");
    }
 catch (    IOException ignored) {
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchBlocks() throws IOException {
  BlockListImpl list=create();
  List<RawDataBlock> raw_blocks=new ArrayList<RawDataBlock>();
  byte[] data=new byte[512];
  int offset=0;
  LittleEndian.putInt(data,offset,-3);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,6);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,8);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,0);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,10);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1000);
  offset+=LittleEndianConsts.INT_SIZE;
  int index=13;
  for (; offset < 508; offset+=LittleEndianConsts.INT_SIZE) {
    LittleEndian.putInt(data,offset,index++);
  }
  LittleEndian.putInt(data,offset,-2);
  raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(data)));
  for (int j=raw_blocks.size(); j < 128; j++) {
    raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(new byte[0])));
  }
  list.setBlocks(raw_blocks.toArray(new RawDataBlock[raw_blocks.size()]));
  int[] blocks={0};
  BlockAllocationTableReader table=new BlockAllocationTableReader(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,1,blocks,0,-2,list);
  int[] start_blocks={-2,1,2,3,5,7,9,11,12};
  int[] expected_length={0,1,-1,-1,-1,-1,-1,-1,116};
  for (int j=0; j < start_blocks.length; j++) {
    try {
      ListManagedBlock[] dataBlocks=list.fetchBlocks(start_blocks[j],-1);
      if (expected_length[j] == -1) {
        fail("document " + j + " should have failed");
      }
 else {
        assertEquals(expected_length[j],dataBlocks.length);
      }
    }
 catch (    IOException e) {
      if (expected_length[j] == -1) {
      }
 else {
        throw e;
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testZap() throws IOException {
  BlockListImpl list=create();
  for (int j=-2; j < 10; j++) {
    list.zap(j);
  }
  RawDataBlock[] blocks=new RawDataBlock[5];
  for (int j=0; j < 5; j++) {
    blocks[j]=new RawDataBlock(new ByteArrayInputStream(new byte[512]));
  }
  list.setBlocks(blocks);
  for (int j=-2; j < 10; j++) {
    list.zap(j);
  }
  for (int j=0; j < 5; j++) {
    try {
      list.remove(j);
      fail("removing item " + j + " should not have succeeded");
    }
 catch (    IOException ignored) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.TestFormulasFromSpreadsheet </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (int colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    if (c == null || c.getCellType() != Cell.CELL_TYPE_FORMULA) {
      continue;
    }
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
assertEquals(msg,ErrorEval.getText(expValue.getErrorCellValue()),ErrorEval.getText(actValue.getErrorValue()));
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.TestEOMonth </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void checkOffset(){
  for (int offset=-12; offset <= 12; offset++) {
    Calendar cal=LocaleUtil.getLocaleCalendar();
    Date startDate=cal.getTime();
    cal.add(Calendar.MONTH,offset);
    cal.set(Calendar.DAY_OF_MONTH,cal.getActualMaximum(Calendar.DAY_OF_MONTH));
    cal.clear(Calendar.HOUR);
    cal.set(Calendar.HOUR_OF_DAY,0);
    cal.clear(Calendar.MINUTE);
    cal.clear(Calendar.SECOND);
    cal.clear(Calendar.MILLISECOND);
    Date expDate=cal.getTime();
    ValueEval ve[]={new NumberEval(DateUtil.getExcelDate(startDate)),new NumberEval(offset)};
    NumberEval result=(NumberEval)eOMonth.evaluate(ve,ec);
    Date actDate=DateUtil.getJavaDate(result.getNumberValue());
    assertEquals(expDate,actDate);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestBugzillaIssues </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * another test for the number of unique strings issue
 * test opening the resulting file in Excel
 */
@Test public final void bug22568() throws IOException {
  int r=2000;
  int c=3;
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet("ExcelTest");
  int col_cnt=0, rw_cnt=0;
  col_cnt=c;
  rw_cnt=r;
  Row rw;
  rw=sheet.createRow(0);
  for (int j=0; j < col_cnt; j++) {
    Cell cell=rw.createCell(j);
    cell.setCellValue("Col " + (j + 1));
  }
  for (int i=1; i < rw_cnt; i++) {
    rw=sheet.createRow(i);
    for (int j=0; j < col_cnt; j++) {
      Cell cell=rw.createCell(j);
      cell.setCellValue("Row:" + (i + 1) + ",Column:"+ (j + 1));
    }
  }
  sheet.setDefaultColumnWidth(18);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  rw=sheet.getRow(0);
  for (int j=0; j < col_cnt; j++) {
    Cell cell=rw.getCell(j);
    assertEquals("Col " + (j + 1),cell.getStringCellValue());
  }
  for (int i=1; i < rw_cnt; i++) {
    rw=sheet.getRow(i);
    for (int j=0; j < col_cnt; j++) {
      Cell cell=rw.getCell(j);
      assertEquals("Row:" + (i + 1) + ",Column:"+ (j + 1),cell.getStringCellValue());
    }
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug58260() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  int maxStyles=(wb instanceof HSSFWorkbook) ? 4009 : 64000;
  for (int i=0; i < maxStyles; i++) {
    CellStyle style=null;
    try {
      style=wb.createCellStyle();
    }
 catch (    IllegalStateException e) {
      fail("Failed for row " + i);
    }
    style.setAlignment(CellStyle.ALIGN_RIGHT);
    if ((wb instanceof HSSFWorkbook)) {
      assertEquals(i + 21,style.getIndex());
    }
 else {
      assertEquals(i + 1,style.getIndex() & 0xffff);
    }
  }
  try {
    wb.createCellStyle();
    fail("Should fail after " + maxStyles + " styles, but did not fail");
  }
 catch (  IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestCellComment </h4><pre class="type-12 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that we can read cell comments from an existing workbook.
 */
@Test public final void readComments() throws IOException {
  Workbook wb=_testDataProvider.openSampleWorkbook("SimpleWithComments." + _testDataProvider.getStandardFileNameExtension());
  Sheet sheet=wb.getSheetAt(0);
  Cell cell;
  Row row;
  Comment comment;
  for (int rownum=0; rownum < 3; rownum++) {
    row=sheet.getRow(rownum);
    cell=row.getCell(0);
    comment=cell.getCellComment();
    assertNull("Cells in the first column are not commented",comment);
    assertNull(sheet.getCellComment(rownum,0));
  }
  for (int rownum=0; rownum < 3; rownum++) {
    row=sheet.getRow(rownum);
    cell=row.getCell(1);
    comment=cell.getCellComment();
    assertNotNull("Cells in the second column have comments",comment);
    assertNotNull("Cells in the second column have comments",sheet.getCellComment(rownum,1));
    assertEquals("Yegor Kozlov",comment.getAuthor());
    assertFalse("cells in the second column have not empyy notes","".equals(comment.getString().getString()));
    assertEquals(rownum,comment.getRow());
    assertEquals(cell.getColumnIndex(),comment.getColumn());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * test that we can modify existing cell comments
 */
@Test public final void modifyComments() throws IOException {
  Workbook wb1=_testDataProvider.openSampleWorkbook("SimpleWithComments." + _testDataProvider.getStandardFileNameExtension());
  CreationHelper factory=wb1.getCreationHelper();
  Sheet sheet=wb1.getSheetAt(0);
  Cell cell;
  Row row;
  Comment comment;
  for (int rownum=0; rownum < 3; rownum++) {
    row=sheet.getRow(rownum);
    cell=row.getCell(1);
    comment=cell.getCellComment();
    comment.setAuthor("Mofified[" + rownum + "] by Yegor");
    comment.setString(factory.createRichTextString("Modified comment at row " + rownum));
  }
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  for (int rownum=0; rownum < 3; rownum++) {
    row=sheet.getRow(rownum);
    cell=row.getCell(1);
    comment=cell.getCellComment();
    assertEquals("Mofified[" + rownum + "] by Yegor",comment.getAuthor());
    assertEquals("Modified comment at row " + rownum,comment.getString().getString());
  }
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestRow </h4><pre class="type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastAndFirstColumns() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  Row row=sheet.createRow(0);
  assertEquals(-1,row.getFirstCellNum());
  assertEquals(-1,row.getLastCellNum());
  for (int i=0; i < 10; i++)   assertNull(row.getCell(i));
  row.createCell(2);
  assertEquals(2,row.getFirstCellNum());
  assertEquals(3,row.getLastCellNum());
  row.createCell(1);
  assertEquals(1,row.getFirstCellNum());
  assertEquals(3,row.getLastCellNum());
  row.createCell(3);
  assertEquals(1,row.getFirstCellNum());
  assertEquals(4,row.getLastCellNum());
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheet </h4><pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void columnWidth() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet();
  sheet.setDefaultColumnWidth(10);
  assertEquals(10,sheet.getDefaultColumnWidth());
  assertEquals(256 * 10,sheet.getColumnWidth(0));
  assertEquals(256 * 10,sheet.getColumnWidth(1));
  assertEquals(256 * 10,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    sheet.setColumnWidth(i,w);
    assertEquals(w,sheet.getColumnWidth(i));
  }
  sheet.setDefaultColumnWidth(20);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth(0));
  assertEquals(256 * 20,sheet.getColumnWidth(1));
  assertEquals(256 * 20,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    assertEquals(w,sheet.getColumnWidth(i));
  }
  sheet.setColumnWidth(10,40000);
  assertEquals(40000,sheet.getColumnWidth(10));
  try {
    sheet.setColumnWidth(9,256 * 256);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum column width for an individual cell is 255 characters.",e.getMessage());
  }
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth(0));
  assertEquals(256 * 20,sheet.getColumnWidth(1));
  assertEquals(256 * 20,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sheet.getColumnWidth(i));
  }
  assertEquals(40000,sheet.getColumnWidth(10));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetShiftRows </h4><pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testShiftSharedFormulasBug54206() throws IOException {
  Workbook wb=_testDataProvider.openSampleWorkbook("54206." + _testDataProvider.getStandardFileNameExtension());
  Sheet sheet=wb.getSheetAt(0);
  assertEquals("SUMIF($B$19:$B$82,$B4,G$19:G$82)",sheet.getRow(3).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B4,H$19:H$82)",sheet.getRow(3).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B4,I$19:I$82)",sheet.getRow(3).getCell(8).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,G$19:G$82)",sheet.getRow(14).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,H$19:H$82)",sheet.getRow(14).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,I$19:I$82)",sheet.getRow(14).getCell(8).getCellFormula());
  for (int i=3; i <= 14; i++) {
    for (int j=6; j <= 8; j++) {
      String col=CellReference.convertNumToColString(j);
      String expectedFormula="SUMIF($B$19:$B$82,$B" + (i + 1) + ","+ col+ "$19:"+ col+ "$82)";
      assertEquals(expectedFormula,sheet.getRow(i).getCell(j).getCellFormula());
    }
  }
  assertEquals("SUM(G24:I24)",sheet.getRow(23).getCell(9).getCellFormula());
  assertEquals("SUM(G25:I25)",sheet.getRow(24).getCell(9).getCellFormula());
  assertEquals("SUM(G26:I26)",sheet.getRow(25).getCell(9).getCellFormula());
  sheet.shiftRows(24,sheet.getLastRowNum(),4,true,false);
  assertEquals("SUMIF($B$19:$B$86,$B4,G$19:G$86)",sheet.getRow(3).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B4,H$19:H$86)",sheet.getRow(3).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B4,I$19:I$86)",sheet.getRow(3).getCell(8).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,G$19:G$86)",sheet.getRow(14).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,H$19:H$86)",sheet.getRow(14).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,I$19:I$86)",sheet.getRow(14).getCell(8).getCellFormula());
  for (int i=3; i <= 14; i++) {
    for (int j=6; j <= 8; j++) {
      String col=CellReference.convertNumToColString(j);
      String expectedFormula="SUMIF($B$19:$B$86,$B" + (i + 1) + ","+ col+ "$19:"+ col+ "$86)";
      assertEquals(expectedFormula,sheet.getRow(i).getCell(j).getCellFormula());
    }
  }
  assertEquals("SUM(G24:I24)",sheet.getRow(23).getCell(9).getCellFormula());
  assertTrue(sheet.getRow(24) == null || sheet.getRow(24).getCell(9) == null);
  assertTrue(sheet.getRow(25) == null || sheet.getRow(25).getCell(9) == null);
  assertTrue(sheet.getRow(26) == null || sheet.getRow(26).getCell(9) == null);
  assertTrue(sheet.getRow(27) == null || sheet.getRow(27).getCell(9) == null);
  assertEquals("SUM(G29:I29)",sheet.getRow(28).getCell(9).getCellFormula());
  assertEquals("SUM(G30:I30)",sheet.getRow(29).getCell(9).getCellFormula());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetUpdateArrayFormulas </h4><pre class="type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that when reading a workbook from input stream, array formulas are recognized
 */
@Test public final void testReadArrayFormula() throws IOException {
  Cell[] cells;
  Workbook workbook1=_testDataProvider.createWorkbook();
  Sheet sheet1=workbook1.createSheet();
  cells=sheet1.setArrayFormula("SUM(A1:A3*B1:B3)",CellRangeAddress.valueOf("C4:C6")).getFlattenedCells();
  assertEquals(3,cells.length);
  cells=sheet1.setArrayFormula("MAX(A1:A3*B1:B3)",CellRangeAddress.valueOf("A4:A6")).getFlattenedCells();
  assertEquals(3,cells.length);
  Sheet sheet2=workbook1.createSheet();
  cells=sheet2.setArrayFormula("MIN(A1:A3*B1:B3)",CellRangeAddress.valueOf("D2:D4")).getFlattenedCells();
  assertEquals(3,cells.length);
  Workbook workbook2=_testDataProvider.writeOutAndReadBack(workbook1);
  workbook1.close();
  sheet1=workbook2.getSheetAt(0);
  for (int rownum=3; rownum <= 5; rownum++) {
    Cell cell1=sheet1.getRow(rownum).getCell(2);
    assertTrue(cell1.isPartOfArrayFormulaGroup());
    Cell cell2=sheet1.getRow(rownum).getCell(0);
    assertTrue(cell2.isPartOfArrayFormulaGroup());
  }
  sheet2=workbook2.getSheetAt(1);
  for (int rownum=1; rownum <= 3; rownum++) {
    Cell cell1=sheet2.getRow(rownum).getCell(3);
    assertTrue(cell1.isPartOfArrayFormulaGroup());
  }
  workbook2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestWorkbook </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void setSheetOrder() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  for (int i=0; i < 10; i++) {
    wb.createSheet("Sheet " + i);
  }
  assertEquals(0,wb.getSheetIndex("Sheet 0"));
  assertEquals(1,wb.getSheetIndex("Sheet 1"));
  assertEquals(2,wb.getSheetIndex("Sheet 2"));
  assertEquals(3,wb.getSheetIndex("Sheet 3"));
  assertEquals(4,wb.getSheetIndex("Sheet 4"));
  assertEquals(5,wb.getSheetIndex("Sheet 5"));
  assertEquals(6,wb.getSheetIndex("Sheet 6"));
  assertEquals(7,wb.getSheetIndex("Sheet 7"));
  assertEquals(8,wb.getSheetIndex("Sheet 8"));
  assertEquals(9,wb.getSheetIndex("Sheet 9"));
  assertEquals(0,wb.getActiveSheetIndex());
  wb.setSheetOrder("Sheet 6",0);
  assertEquals(1,wb.getActiveSheetIndex());
  wb.setSheetOrder("Sheet 3",7);
  wb.setSheetOrder("Sheet 1",9);
  assertEquals(1,wb.getActiveSheetIndex());
  assertEquals(0,wb.getSheetIndex("Sheet 6"));
  assertEquals(1,wb.getSheetIndex("Sheet 0"));
  assertEquals(2,wb.getSheetIndex("Sheet 2"));
  assertEquals(3,wb.getSheetIndex("Sheet 4"));
  assertEquals(4,wb.getSheetIndex("Sheet 5"));
  assertEquals(5,wb.getSheetIndex("Sheet 7"));
  assertEquals(6,wb.getSheetIndex("Sheet 3"));
  assertEquals(7,wb.getSheetIndex("Sheet 8"));
  assertEquals(8,wb.getSheetIndex("Sheet 9"));
  assertEquals(9,wb.getSheetIndex("Sheet 1"));
  Workbook wbr=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(0,wbr.getSheetIndex("Sheet 6"));
  assertEquals(1,wbr.getSheetIndex("Sheet 0"));
  assertEquals(2,wbr.getSheetIndex("Sheet 2"));
  assertEquals(3,wbr.getSheetIndex("Sheet 4"));
  assertEquals(4,wbr.getSheetIndex("Sheet 5"));
  assertEquals(5,wbr.getSheetIndex("Sheet 7"));
  assertEquals(6,wbr.getSheetIndex("Sheet 3"));
  assertEquals(7,wbr.getSheetIndex("Sheet 8"));
  assertEquals(8,wbr.getSheetIndex("Sheet 9"));
  assertEquals(9,wbr.getSheetIndex("Sheet 1"));
  assertEquals(1,wb.getActiveSheetIndex());
  for (int i=0; i < 10; i++) {
    Sheet s=wbr.getSheetAt(i);
    assertEquals(i,wbr.getSheetIndex(s));
  }
  wbr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.TestFractionFormat </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTruthFile() throws Exception {
  File truthFile=HSSFTestDataSamples.getSampleFile("54686_fraction_formats.txt");
  BufferedReader reader=new BufferedReader(new InputStreamReader(new FileInputStream(truthFile),LocaleUtil.CHARSET_1252));
  Workbook wb=HSSFTestDataSamples.openSampleWorkbook("54686_fraction_formats.xls");
  Sheet sheet=wb.getSheetAt(0);
  DataFormatter formatter=new DataFormatter();
  FormulaEvaluator evaluator=wb.getCreationHelper().createFormulaEvaluator();
  String truthLine=reader.readLine();
  String[] headers=truthLine.split("\t");
  truthLine=reader.readLine();
  for (int i=1; i < sheet.getLastRowNum() && truthLine != null; i++) {
    Row r=sheet.getRow(i);
    String[] truths=truthLine.split("\t");
    for (short j=3; j < 12; j++) {
      Cell cell=r.getCell(j,Row.CREATE_NULL_AS_BLANK);
      String formatted=clean(formatter.formatCellValue(cell,evaluator));
      if (truths.length <= j) {
        continue;
      }
      String truth=clean(truths[j]);
      String testKey=truths[0] + ":" + truths[1]+ ":"+ headers[j];
      assertEquals(testKey,truth,formatted);
    }
    truthLine=reader.readLine();
  }
  wb.close();
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.TestXSLFBugs </h4><pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When working with >9 images, make sure the sorting ensures
 * that image10.foo isn't between image1.foo and image2.foo
 */
@Test public void test57552() throws Exception {
  XMLSlideShow ss=new XMLSlideShow();
  for (  String s : new String[]{"Slide1","Slide2"}) {
    ss.createSlide().createTextBox().setText(s);
  }
  XSLFSlide slide=ss.getSlides().get(0);
  assertEquals(0,ss.getPictureData().size());
  assertEquals(1,slide.getShapes().size());
  assertEquals(1,slide.getRelations().size());
  assertRelationEquals(XSLFRelation.SLIDE_LAYOUT,slide.getRelations().get(0));
  byte[][] pics=new byte[15][3];
  for (int i=0; i < pics.length; i++) {
    for (int j=0; j < pics[i].length; j++) {
      pics[i][j]=(byte)i;
    }
  }
  for (int i=0; i < 10; i++) {
    XSLFPictureData data=ss.addPicture(pics[i],PictureType.JPEG);
    assertEquals(i,data.getIndex());
    assertEquals(i + 1,ss.getPictureData().size());
    XSLFPictureShape shape=slide.createPicture(data);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
    assertEquals(i + 2,slide.getShapes().size());
  }
  for (int i=0; i < 10; i++) {
    XSLFPictureShape shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  for (int i=10; i < 15; i++) {
    XSLFPictureData data=ss.addPicture(pics[i],PictureType.JPEG);
    assertEquals(i,data.getIndex());
    assertEquals(i + 1,ss.getPictureData().size());
    XSLFPictureShape shape=slide.createPicture(data);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
    assertEquals(i + 2,slide.getShapes().size());
  }
  for (int i=0; i < 15; i++) {
    XSLFPictureShape shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  XSLFPictureData data=ss.addPicture(pics[3],PictureType.JPEG);
  assertEquals(3,data.getIndex());
  assertEquals(15,ss.getPictureData().size());
  XSLFPictureShape shape=slide.createPicture(data);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[3],shape.getPictureData().getData());
  assertEquals(17,slide.getShapes().size());
  XMLSlideShow ss2=XSLFTestDataSamples.writeOutAndReadBack(ss);
  slide=ss2.getSlides().get(0);
  for (int i=0; i < 15; i++) {
    shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  shape=(XSLFPictureShape)slide.getShapes().get(16);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[3],shape.getPictureData().getData());
  data=ss2.addPicture(pics[5],PictureType.JPEG);
  assertEquals(5,data.getIndex());
  assertEquals(15,ss2.getPictureData().size());
  shape=slide.createPicture(data);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[5],shape.getPictureData().getData());
  assertEquals(18,slide.getShapes().size());
  ss2.close();
  ss.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFPictureShape </h4><pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateMultiplePictures() throws Exception {
  XMLSlideShow ppt1=new XMLSlideShow();
  XSLFSlide slide1=ppt1.createSlide();
  XSLFGroupShape group1=slide1.createGroup();
  int pictureIndex=0;
  for (int i=0; i < 20; i++, pictureIndex++) {
    byte[] data=new byte[]{(byte)pictureIndex};
    XSLFPictureData elementData=ppt1.addPicture(data,PictureType.PNG);
    assertEquals(pictureIndex,elementData.getIndex());
    XSLFPictureShape picture=slide1.createPicture(elementData);
    String fileName="image" + (elementData.getIndex() + 1) + ".png";
    assertEquals(fileName,picture.getPictureData().getFileName());
    assertArrayEquals(data,picture.getPictureData().getData());
  }
  for (int i=0; i < 20; i++, pictureIndex++) {
    byte[] data=new byte[]{(byte)pictureIndex};
    XSLFPictureData elementData=ppt1.addPicture(data,PictureType.PNG);
    XSLFPictureShape picture=group1.createPicture(elementData);
    assertEquals(pictureIndex,elementData.getIndex());
    String fileName="image" + (pictureIndex + 1) + ".png";
    assertEquals(fileName,picture.getPictureData().getFileName());
    assertArrayEquals(data,picture.getPictureData().getData());
  }
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  Map<String,XSLFPictureData> pics=new HashMap<String,XSLFPictureData>();
  for (  XSLFPictureData p : ppt2.getPictureData()) {
    pics.put(p.getFileName(),p);
  }
  assertEquals(40,pics.size());
  for (int i=0; i < 40; i++) {
    byte[] data1=new byte[]{(byte)i};
    String fileName="image" + (i + 1) + ".png";
    XSLFPictureData data=pics.get(fileName);
    assertNotNull(data);
    assertEquals(fileName,data.getFileName());
    assertArrayEquals(data1,data.getData());
  }
  ppt2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestThemesTable </h4><pre class="type-2 type-12 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that, for a file with themes, we can correctly
 * read both the themed and non-themed colours back.
 * Column A = Theme Foreground
 * Column B = Theme Foreground
 * Column C = Explicit Colour Foreground
 * Column E = Explicit Colour Background, Black Foreground
 * Column G = Conditional Formatting Backgrounds
 * Note - Grey Row has an odd way of doing the styling... 
 */
@Test public void themedAndNonThemedColours(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  XSSFSheet sheet=wb.getSheetAt(0);
  XSSFCellStyle style;
  XSSFColor color;
  XSSFCell cell;
  String[] names={"White","Black","Grey","Dark Blue","Blue","Red","Green"};
  String[] explicitFHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0070C0","FFFF0000","FF00B050"};
  String[] explicitBHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0000FF","FFFF0000","FF00FF00"};
  assertEquals(7,names.length);
  for (int rn=1; rn < 8; rn++) {
    int idx=rn - 1;
    XSSFRow row=sheet.getRow(rn);
    assertNotNull("Missing row " + rn,row);
    XSSFCell themeCell=row.getCell(0);
    ThemeElement themeElem=ThemeElement.byId(idx);
    assertCellContents(themeElem.name,themeCell);
    assertCellContents(names[idx],row.getCell(1));
    assertCellContents(names[idx],row.getCell(2));
    assertCellContents(names[idx],row.getCell(4));
    style=themeCell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals(idx,color.getTheme());
    assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    cell=row.getCell(1);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    if (idx != 2) {
      assertEquals(idx,color.getTheme());
      assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    }
 else {
      assertEquals(1,color.getTheme());
      assertEquals(0.50,color.getTint(),0.001);
    }
    cell=row.getCell(2);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitFHexes[idx],color.getARGBHex());
    cell=row.getCell(4);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals("FF000000",color.getARGBHex());
    color=style.getFillForegroundXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitBHexes[idx],color.getARGBHex());
    color=style.getFillBackgroundColorColor();
    assertEquals(false,color.isThemed());
    assertEquals(null,color.getARGBHex());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThemesTableColors() throws Exception {
  XSSFWorkbook simple=XSSFTestDataSamples.openSampleWorkbook(testFileSimple);
  XSSFWorkbook complex=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  XSSFWorkbook simpleRS=XSSFTestDataSamples.writeOutAndReadBack(simple);
  XSSFWorkbook complexRS=XSSFTestDataSamples.writeOutAndReadBack(complex);
  simple=XSSFTestDataSamples.openSampleWorkbook(testFileSimple);
  complex=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  Map<String,XSSFWorkbook> workbooks=new LinkedHashMap<String,XSSFWorkbook>();
  workbooks.put(testFileSimple,simple);
  workbooks.put("Re-Saved_" + testFileSimple,simpleRS);
  workbooks.put(testFileComplex,complex);
  workbooks.put("Re-Saved_" + testFileComplex,complexRS);
  assertEquals(rgbExpected.length,rgbExpected.length);
  boolean createFiles=false;
  for (  String whatWorkbook : workbooks.keySet()) {
    XSSFWorkbook workbook=workbooks.get(whatWorkbook);
    XSSFSheet sheet=workbook.getSheetAt(0);
    int startRN=0;
    if (whatWorkbook.endsWith(testFileComplex))     startRN++;
    for (int rn=startRN; rn < rgbExpected.length + startRN; rn++) {
      XSSFRow row=sheet.getRow(rn);
      assertNotNull("Missing row " + rn + " in "+ whatWorkbook,row);
      String ref=(new CellReference(rn,0)).formatAsString();
      XSSFCell cell=row.getCell(0);
      assertNotNull("Missing cell " + ref + " in "+ whatWorkbook,cell);
      int expectedThemeIdx=rn - startRN;
      ThemeElement themeElem=ThemeElement.byId(expectedThemeIdx);
      assertEquals("Wrong theme at " + ref + " in "+ whatWorkbook,themeElem.name.toLowerCase(Locale.ROOT),cell.getStringCellValue());
      XSSFFont font=cell.getCellStyle().getFont();
      CTColor ctColor=font.getCTFont().getColorArray(0);
      assertNotNull(ctColor);
      assertEquals(true,ctColor.isSetTheme());
      assertEquals(themeElem.idx,ctColor.getTheme());
      XSSFColor color=font.getXSSFColor();
      assertEquals(false,color.hasTint());
      assertEquals("Wrong theme colour " + themeElem.name + " on "+ whatWorkbook,rgbExpected[expectedThemeIdx],Hex.encodeHexString(color.getRGB()));
      long themeIdx=font.getCTFont().getColorArray(0).getTheme();
      assertEquals("Wrong theme index " + expectedThemeIdx + " on "+ whatWorkbook,expectedThemeIdx,themeIdx);
      if (createFiles) {
        XSSFCellStyle cs=row.getSheet().getWorkbook().createCellStyle();
        cs.setFillForegroundColor(color);
        cs.setFillPattern(CellStyle.SOLID_FOREGROUND);
        row.createCell(1).setCellStyle(cs);
      }
    }
    if (createFiles) {
      FileOutputStream fos=new FileOutputStream("Generated_" + whatWorkbook);
      workbook.write(fos);
      fos.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFWorkbook </h4><pre class="type-12 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("Crashes the JVM because of documented JVM behavior with concurrent writing/reading of zip-files, " + "see http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html") @Test public void bug53515a() throws Exception {
  File out=new File("Test.xlsx");
  out.delete();
  for (int i=0; i < 2; i++) {
    System.out.println("Iteration " + i);
    final SXSSFWorkbook wb;
    if (out.exists()) {
      wb=new SXSSFWorkbook((XSSFWorkbook)WorkbookFactory.create(out));
    }
 else {
      wb=new SXSSFWorkbook(10);
    }
    try {
      FileOutputStream outSteam=new FileOutputStream(out);
      if (i == 0) {
        populateWorkbook(wb);
      }
 else {
        System.gc();
        System.gc();
        System.gc();
      }
      wb.write(outSteam);
      outSteam.close();
    }
  finally {
      assertTrue(wb.dispose());
    }
  }
  out.delete();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gzipSheetdataWriter() throws IOException {
  SXSSFWorkbook wb=new SXSSFWorkbook();
  wb.setCompressTempFiles(true);
  int rowNum=1000;
  int sheetNum=5;
  for (int i=0; i < sheetNum; i++) {
    Sheet sh=wb.createSheet("sheet" + i);
    for (int j=0; j < rowNum; j++) {
      Row row=sh.createRow(j);
      Cell cell1=row.createCell(0);
      cell1.setCellValue(new CellReference(cell1).formatAsString());
      Cell cell2=row.createCell(1);
      cell2.setCellValue(i);
      Cell cell3=row.createCell(2);
      cell3.setCellValue(j);
    }
  }
  XSSFWorkbook xwb=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  for (int i=0; i < sheetNum; i++) {
    Sheet sh=xwb.getSheetAt(i);
    assertEquals("sheet" + i,sh.getSheetName());
    for (int j=0; j < rowNum; j++) {
      Row row=sh.getRow(j);
      assertNotNull("row[" + j + "]",row);
      Cell cell1=row.getCell(0);
      assertEquals(new CellReference(cell1).formatAsString(),cell1.getStringCellValue());
      Cell cell2=row.getCell(1);
      assertEquals(i,(int)cell2.getNumericCellValue());
      Cell cell3=row.getCell(2);
      assertEquals(j,(int)cell3.getNumericCellValue());
    }
  }
  assertTrue(wb.dispose());
  xwb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (short colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    assumeNotNull(c);
    assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
    ignoredFormulaTestCase(c.getCellFormula());
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestUnfixedBugs </h4><pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test54071() throws Exception {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("54071.xlsx");
  Sheet sheet=workbook.getSheetAt(0);
  int rows=sheet.getPhysicalNumberOfRows();
  System.out.println(">> file rows is:" + (rows - 1) + " <<");
  Row title=sheet.getRow(0);
  Date prev=null;
  for (int row=1; row < rows; row++) {
    Row rowObj=sheet.getRow(row);
    for (int col=0; col < 1; col++) {
      String titleName=title.getCell(col).toString();
      Cell cell=rowObj.getCell(col);
      if (titleName.startsWith("time")) {
        System.out.println("==Time:" + cell.getDateCellValue());
        if (prev != null) {
          assertEquals(prev,cell.getDateCellValue());
        }
        prev=cell.getDateCellValue();
      }
    }
  }
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFBugs </h4><pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * .xlsx supports 64000 cell styles, the style indexes after
 * 32,767 must not be -32,768, then -32,767, -32,766
 */
@Test public void bug57880() throws IOException {
  int numStyles=33000;
  XSSFWorkbook wb=new XSSFWorkbook();
  for (int i=1; i < numStyles; i++) {
    XSSFCellStyle style=wb.createCellStyle();
    assertEquals(i,style.getUIndex());
  }
  assertEquals(numStyles,wb.getNumCellStyles());
  File file=XSSFTestDataSamples.writeOutAndClose(wb,"bug57880");
  wb=null;
  double ratio=ZipSecureFile.getMinInflateRatio();
  ZipSecureFile.setMinInflateRatio(0.00005);
  wb=XSSFTestDataSamples.readBackAndDelete(file);
  ZipSecureFile.setMinInflateRatio(ratio);
  assertEquals(numStyles,wb.getNumCellStyles());
  for (int i=1; i < numStyles; i++) {
    XSSFCellStyle style=wb.getCellStyleAt(i);
    assertNotNull(style);
    assertEquals(i,style.getUIndex());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bugzilla 51710: problems reading shared formuals from .xlsx
 */
@Test public void bug51710() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("51710.xlsx");
  final String[] columns={"A","B","C","D","E","F","G","H","I","J","K","L","M","N"};
  final int rowMax=500;
  Sheet sheet=wb.getSheetAt(0);
  for (int rInd=2; rInd <= rowMax; rInd++) {
    Row row=sheet.getRow(rInd);
    for (int cInd=1; cInd <= 12; cInd++) {
      Cell cell=row.getCell(cInd);
      String formula=cell.getCellFormula();
      CellReference ref=new CellReference(cell);
      String correct="$A" + (rInd + 1) + "*"+ columns[cInd]+ "$2";
      assertEquals("Incorrect formula in " + ref.formatAsString(),correct,formula);
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test57236() throws Exception {
  DataFormatter formatter=new DataFormatter(true);
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("57236.xlsx");
  for (int sheetNum=0; sheetNum < wb.getNumberOfSheets(); sheetNum++) {
    Sheet sheet=wb.getSheetAt(sheetNum);
    for (int rowNum=sheet.getFirstRowNum(); rowNum < sheet.getLastRowNum(); rowNum++) {
      Row row=sheet.getRow(rowNum);
      for (int cellNum=row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++) {
        Cell cell=row.getCell(cellNum);
        String fmtCellValue=formatter.formatCellValue(cell);
        System.out.println("Cell: " + fmtCellValue);
        assertNotNull(fmtCellValue);
        assertFalse(fmtCellValue.equals("0"));
      }
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Problem with evaluation formulas due to
 * NameXPtgs.
 * Blows up on:
 * IF(B6= (ROUNDUP(B6,0) + ROUNDDOWN(B6,0))/2, MROUND(B6,2),ROUND(B6,0))
 * TODO: delete this test case when MROUND and VAR are implemented
 */
@Test public void bug48539() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("48539.xlsx");
  try {
    assertEquals(3,wb.getNumberOfSheets());
    assertEquals(0,wb.getNumberOfNames());
    XSSFFormulaEvaluator eval=new XSSFFormulaEvaluator(wb);
    for (int i=0; i < wb.getNumberOfSheets(); i++) {
      Sheet s=wb.getSheetAt(i);
      for (      Row r : s) {
        for (        Cell c : r) {
          if (c.getCellType() == Cell.CELL_TYPE_FORMULA) {
            CellValue cv=eval.evaluate(c);
            if (cv.getCellType() == Cell.CELL_TYPE_NUMERIC) {
              String formula=c.getCellFormula();
              double cachedFormulaResult=c.getNumericCellValue();
              double evaluatedFormulaResult=cv.getNumberValue();
              assertEquals(formula,cachedFormulaResult,evaluatedFormulaResult,1E-7);
            }
          }
        }
      }
    }
    XSSFFormulaEvaluator.evaluateAllFormulaCells(wb);
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFCell </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncodingbeloAscii() throws Exception {
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < Character.MAX_VALUE; i++) {
    sb.append((char)i);
  }
  String strAll=sb.toString();
  int pos=0;
  while (pos < strAll.length()) {
    String str=strAll.substring(pos,Math.min(strAll.length(),pos + SpreadsheetVersion.EXCEL2007.getMaxTextLength()));
    Workbook wb=HSSFITestDataProvider.instance.createWorkbook();
    Cell cell=wb.createSheet().createRow(0).createCell(0);
    Workbook xwb=XSSFITestDataProvider.instance.createWorkbook();
    Cell xCell=xwb.createSheet().createRow(0).createCell(0);
    Workbook swb=SXSSFITestDataProvider.instance.createWorkbook();
    Cell sCell=swb.createSheet().createRow(0).createCell(0);
    cell.setCellValue(str);
    assertEquals(str,cell.getStringCellValue());
    xCell.setCellValue(str);
    assertEquals(str,xCell.getStringCellValue());
    sCell.setCellValue(str);
    assertEquals(str,sCell.getStringCellValue());
    Workbook wbBack=HSSFITestDataProvider.instance.writeOutAndReadBack(wb);
    Workbook xwbBack=XSSFITestDataProvider.instance.writeOutAndReadBack(xwb);
    Workbook swbBack=SXSSFITestDataProvider.instance.writeOutAndReadBack(swb);
    cell=wbBack.getSheetAt(0).createRow(0).createCell(0);
    xCell=xwbBack.getSheetAt(0).createRow(0).createCell(0);
    sCell=swbBack.getSheetAt(0).createRow(0).createCell(0);
    assertEquals(cell.getStringCellValue(),xCell.getStringCellValue());
    assertEquals(cell.getStringCellValue(),sCell.getStringCellValue());
    pos+=SpreadsheetVersion.EXCEL97.getMaxTextLength();
    swbBack.close();
    xwbBack.close();
    wbBack.close();
    swb.close();
    xwb.close();
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFCellStyle </h4><pre class="type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSetBorderLeft(){
  assertEquals(CellStyle.BORDER_NONE,cellStyle.getBorderLeft());
  int num=stylesTable.getBorders().size();
  cellStyle.setBorderLeft(CellStyle.BORDER_MEDIUM);
  assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderLeft());
  assertEquals(num + 1,stylesTable.getBorders().size());
  int borderId=(int)cellStyle.getCoreXf().getBorderId();
  assertTrue(borderId > 0);
  CTBorder ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertEquals(STBorderStyle.MEDIUM,ctBorder.getLeft().getStyle());
  num=stylesTable.getBorders().size();
  for (int i=0; i < 3; i++) {
    cellStyle.setBorderLeft(CellStyle.BORDER_MEDIUM);
    assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderLeft());
  }
  assertEquals(borderId,cellStyle.getCoreXf().getBorderId());
  assertEquals(num,stylesTable.getBorders().size());
  assertSame(ctBorder,stylesTable.getBorderAt(borderId).getCTBorder());
  cellStyle.setBorderLeft(CellStyle.BORDER_NONE);
  assertEquals(num,stylesTable.getBorders().size());
  borderId=(int)cellStyle.getCoreXf().getBorderId();
  ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertFalse(ctBorder.isSetLeft());
}

</code></pre>

<br>
<pre class="type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSetBorderRight(){
  assertEquals(CellStyle.BORDER_NONE,cellStyle.getBorderRight());
  int num=stylesTable.getBorders().size();
  cellStyle.setBorderRight(CellStyle.BORDER_MEDIUM);
  assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderRight());
  assertEquals(num + 1,stylesTable.getBorders().size());
  int borderId=(int)cellStyle.getCoreXf().getBorderId();
  assertTrue(borderId > 0);
  CTBorder ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertEquals(STBorderStyle.MEDIUM,ctBorder.getRight().getStyle());
  num=stylesTable.getBorders().size();
  for (int i=0; i < 3; i++) {
    cellStyle.setBorderRight(CellStyle.BORDER_MEDIUM);
    assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderRight());
  }
  assertEquals(borderId,cellStyle.getCoreXf().getBorderId());
  assertEquals(num,stylesTable.getBorders().size());
  assertSame(ctBorder,stylesTable.getBorderAt(borderId).getCTBorder());
  cellStyle.setBorderRight(CellStyle.BORDER_NONE);
  assertEquals(num,stylesTable.getBorders().size());
  borderId=(int)cellStyle.getCoreXf().getBorderId();
  ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertFalse(ctBorder.isSetRight());
}

</code></pre>

<br>
<pre class="type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFillForegroundColor() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  StylesTable styles=wb.getStylesSource();
  assertEquals(1,wb.getNumCellStyles());
  assertEquals(2,styles.getFills().size());
  XSSFCellStyle defaultStyle=wb.getCellStyleAt((short)0);
  assertEquals(IndexedColors.AUTOMATIC.getIndex(),defaultStyle.getFillForegroundColor());
  assertEquals(null,defaultStyle.getFillForegroundXSSFColor());
  assertEquals(CellStyle.NO_FILL,defaultStyle.getFillPattern());
  XSSFCellStyle customStyle=wb.createCellStyle();
  customStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);
  assertEquals(CellStyle.SOLID_FOREGROUND,customStyle.getFillPattern());
  assertEquals(3,styles.getFills().size());
  customStyle.setFillForegroundColor(IndexedColors.BRIGHT_GREEN.getIndex());
  assertEquals(IndexedColors.BRIGHT_GREEN.getIndex(),customStyle.getFillForegroundColor());
  assertEquals(4,styles.getFills().size());
  for (int i=0; i < 3; i++) {
    XSSFCellStyle style=wb.createCellStyle();
    style.setFillPattern(CellStyle.SOLID_FOREGROUND);
    assertEquals(CellStyle.SOLID_FOREGROUND,style.getFillPattern());
    assertEquals(4,styles.getFills().size());
    style.setFillForegroundColor(IndexedColors.BRIGHT_GREEN.getIndex());
    assertEquals(IndexedColors.BRIGHT_GREEN.getIndex(),style.getFillForegroundColor());
    assertEquals(4,styles.getFills().size());
  }
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(wb));
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSetBorderBottom(){
  assertEquals(CellStyle.BORDER_NONE,cellStyle.getBorderBottom());
  int num=stylesTable.getBorders().size();
  cellStyle.setBorderBottom(CellStyle.BORDER_MEDIUM);
  assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderBottom());
  assertEquals(num + 1,stylesTable.getBorders().size());
  int borderId=(int)cellStyle.getCoreXf().getBorderId();
  assertTrue(borderId > 0);
  CTBorder ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertEquals(STBorderStyle.MEDIUM,ctBorder.getBottom().getStyle());
  num=stylesTable.getBorders().size();
  for (int i=0; i < 3; i++) {
    cellStyle.setBorderBottom(CellStyle.BORDER_MEDIUM);
    assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderBottom());
  }
  assertEquals(borderId,cellStyle.getCoreXf().getBorderId());
  assertEquals(num,stylesTable.getBorders().size());
  assertSame(ctBorder,stylesTable.getBorderAt(borderId).getCTBorder());
  cellStyle.setBorderBottom(CellStyle.BORDER_NONE);
  assertEquals(num,stylesTable.getBorders().size());
  borderId=(int)cellStyle.getCoreXf().getBorderId();
  ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertFalse(ctBorder.isSetBottom());
}

</code></pre>

<br>
<pre class="type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSetBorderTop(){
  assertEquals(CellStyle.BORDER_NONE,cellStyle.getBorderTop());
  int num=stylesTable.getBorders().size();
  cellStyle.setBorderTop(CellStyle.BORDER_MEDIUM);
  assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderTop());
  assertEquals(num + 1,stylesTable.getBorders().size());
  int borderId=(int)cellStyle.getCoreXf().getBorderId();
  assertTrue(borderId > 0);
  CTBorder ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertEquals(STBorderStyle.MEDIUM,ctBorder.getTop().getStyle());
  num=stylesTable.getBorders().size();
  for (int i=0; i < 3; i++) {
    cellStyle.setBorderTop(CellStyle.BORDER_MEDIUM);
    assertEquals(CellStyle.BORDER_MEDIUM,cellStyle.getBorderTop());
  }
  assertEquals(borderId,cellStyle.getCoreXf().getBorderId());
  assertEquals(num,stylesTable.getBorders().size());
  assertSame(ctBorder,stylesTable.getBorderAt(borderId).getCTBorder());
  cellStyle.setBorderTop(CellStyle.BORDER_NONE);
  assertEquals(num,stylesTable.getBorders().size());
  borderId=(int)cellStyle.getCoreXf().getBorderId();
  ctBorder=stylesTable.getBorderAt(borderId).getCTBorder();
  assertFalse(ctBorder.isSetTop());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFColGrouping </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_1_MINOR
 */
@Test public void testMergingOverlappingCols_OVERLAPS_1_MINOR() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)3,(short)5);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_1_MINOR/cols:" + cols);
  assertEquals(0,cols.getColArray(0).getOutlineLevel());
  assertEquals(3,cols.getColArray(0).getMin());
  assertEquals(3,cols.getColArray(0).getMax());
  assertEquals(true,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(4,cols.getColArray(1).getMin());
  assertEquals(5,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(1,cols.getColArray(2).getOutlineLevel());
  assertEquals(6,cols.getColArray(2).getMin());
  assertEquals(6,cols.getColArray(2).getMax());
  assertEquals(false,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_1_MINOR");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  assertEquals("Unexpected width of column " + 5,sheet.getDefaultColumnWidth() * 256,sheet.getColumnWidth(5));
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that POI doesn't produce "col" elements without "width" attribute. 
 * POI-52186
 */
@Test public void testNoColsWithoutWidthWhenGroupingAndCollapsing() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  sheet.setColumnWidth(4,5000);
  sheet.setColumnWidth(5,5000);
  sheet.groupColumn((short)4,(short)5);
  sheet.setColumnGroupCollapsed(4,true);
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"test52186_2/cols:" + cols);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testNoColsWithoutWidthWhenGroupingAndCollapsing");
  sheet=wb2.getSheet("test");
  for (int i=4; i <= 5; i++) {
    assertEquals("Unexpected width of column " + i,5000,sheet.getColumnWidth(i));
  }
  cols=sheet.getCTWorksheet().getColsArray(0);
  for (  CTCol col : cols.getColArray()) {
    assertTrue("Col width attribute is unset: " + col.toString(),col.isSetWidth());
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_2_MINOR
 */
@Test public void testMergingOverlappingCols_OVERLAPS_2_MINOR() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)1,(short)3);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_2_MINOR/cols:" + cols);
  assertEquals(1,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(false,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(4,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(0,cols.getColArray(2).getOutlineLevel());
  assertEquals(5,cols.getColArray(2).getMin());
  assertEquals(5,cols.getColArray(2).getMax());
  assertEquals(true,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_2_MINOR");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  assertEquals("Unexpected width of column " + 1,sheet.getDefaultColumnWidth() * 256,sheet.getColumnWidth(1));
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_2_WRAPS
 */
@Test public void testMergingOverlappingCols_OVERLAPS_2_WRAPS() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(1 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)2,(short)3);
  sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_2_WRAPS/cols:" + cols);
  assertEquals(0,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(true,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(4,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(0,cols.getColArray(2).getOutlineLevel());
  assertEquals(5,cols.getColArray(2).getMin());
  assertEquals(5,cols.getColArray(2).getMax());
  assertEquals(true,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_2_WRAPS");
  sheet=wb2.getSheet("test");
  for (int i=1; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_1_WRAPS
 */
@Test public void testMergingOverlappingCols_OVERLAPS_1_WRAPS() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)1,(short)5);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_1_WRAPS/cols:" + cols);
  assertEquals(1,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(false,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(5,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(1,cols.getColArray(2).getOutlineLevel());
  assertEquals(6,cols.getColArray(2).getMin());
  assertEquals(6,cols.getColArray(2).getMax());
  assertEquals(false,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_1_WRAPS");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDataValidation </h4><pre class="type-2 type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddValidations() throws Exception {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("DataValidations-49244.xlsx");
  Sheet sheet=wb1.getSheetAt(0);
  List<XSSFDataValidation> dataValidations=((XSSFSheet)sheet).getDataValidations();
  assertEquals(52,dataValidations.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  int[] validationTypes=new int[]{ValidationType.INTEGER,ValidationType.DECIMAL,ValidationType.TEXT_LENGTH};
  int[] singleOperandOperatorTypes=new int[]{OperatorType.LESS_THAN,OperatorType.LESS_OR_EQUAL,OperatorType.GREATER_THAN,OperatorType.GREATER_OR_EQUAL,OperatorType.EQUAL,OperatorType.NOT_EQUAL};
  int[] doubleOperandOperatorTypes=new int[]{OperatorType.BETWEEN,OperatorType.NOT_BETWEEN};
  BigDecimal value=new BigDecimal("10"), value2=new BigDecimal("20");
  BigDecimal dvalue=new BigDecimal("10.001"), dvalue2=new BigDecimal("19.999");
  final int lastRow=sheet.getLastRowNum();
  int offset=lastRow + 3;
  int lastKnownNumValidations=dataValidations.size();
  Row row=sheet.createRow(offset++);
  Cell cell=row.createCell(0);
  DataValidationConstraint explicitListValidation=dataValidationHelper.createExplicitListConstraint(new String[]{"MA","MI","CA"});
  CellRangeAddressList cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  DataValidation dataValidation=dataValidationHelper.createValidation(explicitListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  row=sheet.createRow(offset++);
  cell=row.createCell(0);
  cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  Cell firstCell=row.createCell(1);
  firstCell.setCellValue("UT");
  Cell secondCell=row.createCell(2);
  secondCell.setCellValue("MN");
  Cell thirdCell=row.createCell(3);
  thirdCell.setCellValue("IL");
  int rowNum=row.getRowNum() + 1;
  String listFormula=new StringBuilder("$B$").append(rowNum).append(":").append("$D$").append(rowNum).toString();
  DataValidationConstraint formulaListValidation=dataValidationHelper.createFormulaListConstraint(listFormula);
  dataValidation=dataValidationHelper.createValidation(formulaListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  offset++;
  offset++;
  for (int i=0; i < validationTypes.length; i++) {
    int validationType=validationTypes[i];
    offset=offset + 2;
    final Row row0=sheet.createRow(offset++);
    Cell cell_10=row0.createCell(0);
    cell_10.setCellValue(validationType == ValidationType.DECIMAL ? "Decimal " : validationType == ValidationType.INTEGER ? "Integer" : "Text Length");
    offset++;
    for (int j=0; j < singleOperandOperatorTypes.length; j++) {
      int operatorType=singleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      final Row row2=i == 0 && j < 2 ? sheet.createRow(offset++) : null;
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_22=i == 0 && j < 2 ? row2.createCell(2) : null;
      Cell cell_13=row1.createCell(3);
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value.toString(),null);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,null);
      if (i == 0 && j == 0) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else       if (i == 0 && j == 1) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
    }
    for (int j=0; j < doubleOperandOperatorTypes.length; j++) {
      int operatorType=doubleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_13=row1.createCell(3);
      Cell cell_14=row1.createCell(4);
      String value1String=validationType == ValidationType.DECIMAL ? dvalue.toString() : value.toString();
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      String value2String=validationType == ValidationType.DECIMAL ? dvalue2.toString() : value2.toString();
      cell_14.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_14.setCellValue(validationType == ValidationType.DECIMAL ? dvalue2.doubleValue() : value2.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value1String,value2String);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      String formula2=new CellReference(cell_14.getRowIndex(),cell_14.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,formula2);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
      validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
    }
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  Sheet sheetAt=wb2.getSheetAt(0);
  assertEquals(lastKnownNumValidations,((XSSFSheet)sheetAt).getDataValidations().size());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDrawing </h4><pre class="type-2 type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClone() throws Exception {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  XSSFSheet sheet1=wb.getSheetAt(0);
  XSSFSheet sheet2=wb.cloneSheet(0);
  List<POIXMLDocumentPart> rels1=sheet1.getRelations();
  assertEquals(1,rels1.size());
  assertTrue(rels1.get(0) instanceof XSSFDrawing);
  List<POIXMLDocumentPart> rels2=sheet2.getRelations();
  assertEquals(1,rels2.size());
  assertTrue(rels2.get(0) instanceof XSSFDrawing);
  XSSFDrawing drawing1=(XSSFDrawing)rels1.get(0);
  XSSFDrawing drawing2=(XSSFDrawing)rels2.get(0);
  assertNotSame(drawing1,drawing2);
  List<XSSFShape> shapes1=drawing1.getShapes();
  List<XSSFShape> shapes2=drawing2.getShapes();
  assertEquals(shapes1.size(),shapes2.size());
  for (int i=0; i < shapes1.size(); i++) {
    XSSFShape sh1=shapes1.get(i);
    XSSFShape sh2=shapes2.get(i);
    assertTrue(sh1.getClass() == sh2.getClass());
    assertEquals(sh1.getShapeProperties().toString(),sh2.getShapeProperties().toString());
  }
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDrawings() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  for (int i=0; i < 3; i++) {
    XSSFSheet sheet=wb.createSheet();
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    assertNotNull(drawing);
  }
  OPCPackage pkg=wb.getPackage();
  try {
    assertEquals(3,pkg.getPartsByContentType(XSSFRelation.DRAWINGS.getContentType()).size());
    checkRewrite(wb);
  }
  finally {
    pkg.close();
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaEvaluation </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Evaluation of cell references with column indexes greater than 255. See bugzilla 50096
 */
@Test public void testEvaluateColumnGreaterThan255() throws IOException {
  XSSFWorkbook wb=(XSSFWorkbook)_testDataProvider.openSampleWorkbook("50096.xlsx");
  XSSFFormulaEvaluator evaluator=wb.getCreationHelper().createFormulaEvaluator();
  for (int i=245; i < 265; i++) {
    XSSFCell cell_noformula=wb.getSheetAt(0).getRow(0).getCell(i);
    XSSFCell cell_formula=wb.getSheetAt(0).getRow(1).getCell(i);
    CellReference ref_noformula=new CellReference(cell_noformula.getRowIndex(),cell_noformula.getColumnIndex());
    CellReference ref_formula=new CellReference(cell_noformula.getRowIndex(),cell_noformula.getColumnIndex());
    String fmla=cell_formula.getCellFormula();
    assertEquals(ref_noformula.formatAsString(),fmla);
    CellValue cv_noformula=evaluator.evaluate(cell_noformula);
    CellValue cv_formula=evaluator.evaluate(cell_formula);
    assertEquals("Wrong evaluation result in " + ref_formula.formatAsString(),cv_noformula.getNumberValue(),cv_formula.getNumberValue(),0);
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFHyperlink </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate() throws Exception {
  XSSFWorkbook workbook=new XSSFWorkbook();
  XSSFSheet sheet=workbook.createSheet();
  XSSFRow row=sheet.createRow(0);
  XSSFCreationHelper createHelper=workbook.getCreationHelper();
  String[] urls={"http://apache.org","www.apache.org","/temp","c:/temp","http://apache.org/default.php?s=isTramsformed&submit=Search&la=*&li=*"};
  for (int i=0; i < urls.length; i++) {
    String s=urls[i];
    XSSFHyperlink link=createHelper.createHyperlink(Hyperlink.LINK_URL);
    link.setAddress(s);
    XSSFCell cell=row.createCell(i);
    cell.setHyperlink(link);
  }
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet=workbook.getSheetAt(0);
  PackageRelationshipCollection rels=sheet.getPackagePart().getRelationships();
  assertEquals(urls.length,rels.size());
  for (int i=0; i < rels.size(); i++) {
    PackageRelationship rel=rels.getRelationship(i);
    assertEquals(urls[i],rel.getTargetURI().toString());
  }
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet=workbook.getSheetAt(0);
  rels=sheet.getPackagePart().getRelationships();
  assertEquals(urls.length,rels.size());
  for (int i=0; i < rels.size(); i++) {
    PackageRelationship rel=rels.getRelationship(i);
    assertEquals(urls[i],rel.getTargetURI().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFPictureData </h4><pre class="type-2 type-12 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertSame(pictures,wb.getAllPictures());
  assertEquals(5,pictures.size());
  String[] ext={"jpeg","emf","png","emf","wmf"};
  String[] mimetype={"image/jpeg","image/x-emf","image/png","image/x-emf","image/x-wmf"};
  for (int i=0; i < pictures.size(); i++) {
    assertEquals(ext[i],pictures.get(i).suggestFileExtension());
    assertEquals(mimetype[i],pictures.get(i).getMimeType());
  }
  int num=pictures.size();
  byte[] pictureData={0xA,0xB,0XC,0xD,0xE,0xF};
  int idx=wb.addPicture(pictureData,XSSFWorkbook.PICTURE_TYPE_JPEG);
  assertEquals(num + 1,pictures.size());
  assertEquals(pictures.size() - 1,idx);
  XSSFPictureData pict=pictures.get(idx);
  assertEquals("jpeg",pict.suggestFileExtension());
  assertArrayEquals(pictureData,pict.getData());
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 53568:  XSSFPicture.getPictureData() can return null.
 */
@Test public void test53568() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("53568.xlsx");
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertNotNull(pictures);
  assertEquals(4,pictures.size());
  XSSFSheet sheet1=wb.getSheetAt(0);
  List<XSSFShape> shapes1=sheet1.createDrawingPatriarch().getShapes();
  assertNotNull(shapes1);
  assertEquals(5,shapes1.size());
  for (int i=0; i < wb.getNumberOfSheets(); i++) {
    XSSFSheet sheet=wb.getSheetAt(i);
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    for (    XSSFShape shape : drawing.getShapes()) {
      if (shape instanceof XSSFPicture) {
        XSSFPicture pic=(XSSFPicture)shape;
        XSSFPictureData picData=pic.getPictureData();
        assertNotNull(picData);
      }
    }
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheet </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Setting width of a column included in a column span
 */
@Test public void bug47862() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47862.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  assertEquals(1,cols.sizeOfColArray());
  CTCol col=cols.getColArray(0);
  assertEquals(1,col.getMin());
  assertEquals(5,col.getMax());
  double swidth=15.77734375;
  assertEquals(swidth,col.getWidth(),0.0);
  for (int i=0; i < 5; i++) {
    assertEquals((int)(swidth * 256),sheet.getColumnWidth(i));
  }
  int[] cw=new int[]{10,15,20,25,30};
  for (int i=0; i < 5; i++) {
    sheet.setColumnWidth(i,cw[i] * 256);
  }
  ColumnHelper.sortColumns(cols);
  assertEquals(5,cols.sizeOfColArray());
  for (int i=0; i < 5; i++) {
    assertEquals(cw[i] * 256,sheet.getColumnWidth(i));
    assertEquals(cw[i],cols.getColArray(i).getWidth(),0.0);
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  cols=sheet.getCTWorksheet().getColsArray(0);
  assertEquals(5,cols.sizeOfColArray());
  for (int i=0; i < 5; i++) {
    assertEquals(cw[i] * 256,sheet.getColumnWidth(i));
    assertEquals(cw[i],cols.getColArray(i).getWidth(),0.0);
  }
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFTable </h4><pre class="type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug56274() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("56274.xlsx");
  XSSFRow row=wb1.getSheetAt(0).getRow(0);
  List<String> headers=new ArrayList<String>();
  for (  Cell cell : row) {
    headers.add(cell.getStringCellValue());
  }
  File outputFile=TempFile.createTempFile("poi-56274",".xlsx");
  SXSSFWorkbook outputWorkbook=new SXSSFWorkbook(wb1);
  FileOutputStream fos=new FileOutputStream(outputFile);
  outputWorkbook.write(fos);
  fos.close();
  outputWorkbook.close();
  FileInputStream fis=new FileInputStream(outputFile);
  XSSFWorkbook wb2=new XSSFWorkbook(fis);
  fis.close();
  CTTable ctTable=wb2.getSheetAt(0).getTables().get(0).getCTTable();
  CTTableColumn[] ctTableColumnArray=ctTable.getTableColumns().getTableColumnArray();
  assertEquals("number of headers in xml table should match number of header cells in worksheet",headers.size(),ctTableColumnArray.length);
  for (int i=0; i < headers.size(); i++) {
    assertEquals("header name in xml table should match number of header cells in worksheet",headers.get(i),ctTableColumnArray[i].getName());
  }
  assertTrue(outputFile.delete());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestXWPFDocument </h4><pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddPicture() throws IOException, InvalidFormatException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("sample.docx");
  byte[] jpeg=XWPFTestDataSamples.getImage("nature1.jpg");
  String relationId=doc.addPictureData(jpeg,XWPFDocument.PICTURE_TYPE_JPEG);
  byte[] newJpeg=((XWPFPictureData)doc.getRelationById(relationId)).getData();
  assertEquals(newJpeg.length,jpeg.length);
  for (int i=0; i < jpeg.length; i++) {
    assertEquals(newJpeg[i],jpeg[i]);
  }
  doc.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
