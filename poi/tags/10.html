<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.poi.TestPOIXMLProperties </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test usermodel API for setting custom properties
 */
@Test public void testCustomProperties() throws Exception {
  POIXMLDocument wb1=new XSSFWorkbook();
  POIXMLProperties.CustomProperties customProps=wb1.getProperties().getCustomProperties();
  customProps.addProperty("test-1","string val");
  customProps.addProperty("test-2",1974);
  customProps.addProperty("test-3",36.6);
  try {
    customProps.addProperty("test-3",36.6);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("A property with this name already exists in the custom properties",e.getMessage());
  }
  customProps.addProperty("test-4",true);
  POIXMLDocument wb2=XSSFTestDataSamples.writeOutAndReadBack((XSSFWorkbook)wb1);
  wb1.close();
  org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties ctProps=wb2.getProperties().getCustomProperties().getUnderlyingProperties();
  assertEquals(4,ctProps.sizeOfPropertyArray());
  org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperty p;
  p=ctProps.getPropertyArray(0);
  assertEquals("{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",p.getFmtid());
  assertEquals("test-1",p.getName());
  assertEquals("string val",p.getLpwstr());
  assertEquals(2,p.getPid());
  p=ctProps.getPropertyArray(1);
  assertEquals("{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",p.getFmtid());
  assertEquals("test-2",p.getName());
  assertEquals(1974,p.getI4());
  assertEquals(3,p.getPid());
  p=ctProps.getPropertyArray(2);
  assertEquals("{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",p.getFmtid());
  assertEquals("test-3",p.getName());
  assertEquals(36.6,p.getR8(),0);
  assertEquals(4,p.getPid());
  p=ctProps.getPropertyArray(3);
  assertEquals("{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",p.getFmtid());
  assertEquals("test-4",p.getName());
  assertEquals(true,p.getBool());
  assertEquals(5,p.getPid());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.extractor.TestExtractorFactory </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOIFS() throws Exception {
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls))) instanceof ExcelExtractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls))).getText().length() > 200);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc))) instanceof WordExtractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc))).getText().length() > 120);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc6))) instanceof Word6Extractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc6))).getText().length() > 20);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc95))) instanceof Word6Extractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(doc95))).getText().length() > 120);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(ppt))) instanceof PowerPointExtractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(ppt))).getText().length() > 120);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(vsd))) instanceof VisioTextExtractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(vsd))).getText().length() > 50);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(pub))) instanceof PublisherTextExtractor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(pub))).getText().length() > 50);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(msg))) instanceof OutlookTextExtactor);
  assertTrue(ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(msg))).getText().length() > 50);
  try {
    ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(txt)));
    fail();
  }
 catch (  IOException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPackage() throws Exception {
  POIXMLTextExtractor extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString(),PackageAccess.READ));
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString()));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(docx.toString()));
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(docx.toString()));
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(pptx.toString()));
  assertTrue(extractor instanceof XSLFPowerPointExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(pptx.toString()));
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(vsdx.toString()));
  assertTrue(extractor instanceof XDGFVisioExtractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  try {
    ExtractorFactory.createExtractor(OPCPackage.open(txt.toString()));
    fail();
  }
 catch (  InvalidOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStream() throws Exception {
  POITextExtractor extractor=ExtractorFactory.createExtractor(new FileInputStream(xls));
  assertTrue(extractor instanceof ExcelExtractor);
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(xlsx));
  assertTrue(extractor instanceof XSSFExcelExtractor);
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(doc));
  assertTrue(extractor instanceof WordExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(doc6));
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(doc95));
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(docx));
  assertTrue(extractor instanceof XWPFWordExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(ppt));
  assertTrue(extractor instanceof PowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(pptx));
  assertTrue(extractor instanceof XSLFPowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(vsd));
  assertTrue(extractor instanceof VisioTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(vsdx));
  assertTrue(extractor instanceof XDGFVisioExtractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(pub));
  assertTrue(extractor instanceof PublisherTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new FileInputStream(msg));
  assertTrue(extractor instanceof OutlookTextExtactor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  try {
    FileInputStream stream=new FileInputStream(txt);
    try {
      ExtractorFactory.createExtractor(stream);
      fail();
    }
  finally {
      stream.close();
    }
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFile() throws Exception {
  POITextExtractor xlsExtractor=ExtractorFactory.createExtractor(xls);
  assertNotNull("Had empty extractor for " + xls,xlsExtractor);
  assertTrue("Expected instanceof ExcelExtractor, but had: " + xlsExtractor.getClass(),xlsExtractor instanceof ExcelExtractor);
  assertTrue(xlsExtractor.getText().length() > 200);
  xlsExtractor.close();
  POITextExtractor extractor=ExtractorFactory.createExtractor(xlsx);
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xlsx);
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xltx);
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xltx);
  assertTrue(extractor.getText().contains("test"));
  extractor.close();
  try {
    extractor=ExtractorFactory.createExtractor(xlsxStrict);
    fail("OOXML-Strict isn't yet supported");
  }
 catch (  POIXMLException e) {
  }
  extractor=ExtractorFactory.createExtractor(doc);
  assertTrue(extractor instanceof WordExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(doc6);
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(doc95);
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(docx);
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(docx);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(dotx);
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(dotx);
  assertTrue(extractor.getText().contains("Test"));
  extractor.close();
  extractor=ExtractorFactory.createExtractor(ppt);
  assertTrue(extractor instanceof PowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(pptx);
  assertTrue(extractor instanceof XSLFPowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(vsd);
  assertTrue(extractor instanceof VisioTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(vsdx);
  assertTrue(extractor instanceof XDGFVisioExtractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(pub);
  assertTrue(extractor instanceof PublisherTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(msg);
  assertTrue(extractor instanceof OutlookTextExtactor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  try {
    ExtractorFactory.createExtractor(txt);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWrite </h4><pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back various variant types and checks whether the
 * stuff that has been read back equals the stuff that was written.</p>
 */
@Test public void variantTypes(){
  Throwable t=null;
  final int codepage=CODEPAGE_DEFAULT;
  if (!hasProperDefaultCharset()) {
    System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped.");
    return;
  }
  try {
    check(Variant.VT_EMPTY,null,codepage);
    check(Variant.VT_BOOL,Boolean.TRUE,codepage);
    check(Variant.VT_BOOL,Boolean.FALSE,codepage);
    check(Variant.VT_CF,new byte[]{8,0,0,0,1,0,0,0,1,2,3,4},codepage);
    check(Variant.VT_I4,Integer.valueOf(27),codepage);
    check(Variant.VT_I8,Long.valueOf(28),codepage);
    check(Variant.VT_R8,new Double(29.0),codepage);
    check(Variant.VT_I4,Integer.valueOf(-27),codepage);
    check(Variant.VT_I8,Long.valueOf(-28),codepage);
    check(Variant.VT_R8,new Double(-29.0),codepage);
    check(Variant.VT_FILETIME,new Date(),codepage);
    check(Variant.VT_I4,new Integer(Integer.MAX_VALUE),codepage);
    check(Variant.VT_I4,new Integer(Integer.MIN_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MAX_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MIN_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MAX_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MIN_VALUE),codepage);
    check(Variant.VT_LPSTR,"",codepage);
    check(Variant.VT_LPSTR,"\u00e4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
    check(Variant.VT_LPWSTR,"",codepage);
    check(Variant.VT_LPWSTR,"\u00e4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
  }
 catch (  Exception ex) {
    t=ex;
  }
catch (  Error ex) {
    t=ex;
  }
  if (t != null)   fail(org.apache.poi.hpsf.Util.toString(t));
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back strings using several different codepages and
 * checks whether the stuff that has been read back equals the stuff that
 * was written.</p>
 */
@Test public void codepages(){
  Throwable thr=null;
  final int[] validCodepages=new int[]{CODEPAGE_DEFAULT,CODEPAGE_UTF8,CODEPAGE_UTF16,CODEPAGE_1252};
  for (int i=0; i < validCodepages.length; i++) {
    final int cp=validCodepages[i];
    if (cp == -1 && !hasProperDefaultCharset()) {
      System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped for the default codepage.");
      continue;
    }
    final long t=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(t,"",cp);
      check(t,"\u00e4",cp);
      check(t,"\u00e4\u00f6",cp);
      check(t,"\u00e4\u00f6\u00fc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      if (cp == CodePageUtil.CP_UTF16 || cp == CodePageUtil.CP_UTF8)       check(t,"\u79D1\u5B78",cp);
    }
 catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr) + " with codepage " + cp);
  }
  final int[] invalidCodepages=new int[]{0,1,2,4711,815};
  for (int i=0; i < invalidCodepages.length; i++) {
    int cp=invalidCodepages[i];
    final long type=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(type,"",cp);
      check(type,"\u00e4",cp);
      check(type,"\u00e4\u00f6",cp);
      check(type,"\u00e4\u00f6\u00fc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      fail("UnsupportedEncodingException for codepage " + cp + " expected.");
    }
 catch (    UnsupportedEncodingException ex) {
    }
catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr));
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests whether writing 8-bit characters to a Unicode property
 * succeeds.</p>
 */
@Test public void unicodeWrite8Bit(){
  final String TITLE="This is a sample title";
  final MutablePropertySet mps=new MutablePropertySet();
  final MutableSection ms=(MutableSection)mps.getSections().get(0);
  ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_TITLE);
  p.setType(Variant.VT_LPSTR);
  p.setValue(TITLE);
  ms.setProperty(p);
  Throwable t=null;
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    mps.write(out);
    out.close();
    byte[] bytes=out.toByteArray();
    PropertySet psr=new PropertySet(bytes);
    assertTrue(psr.isSummaryInformation());
    Section sr=psr.getSections().get(0);
    String title=(String)sr.getProperty(PropertyIDMap.PID_TITLE);
    assertEquals(TITLE,title);
  }
 catch (  WritingNotSupportedException e) {
    t=e;
  }
catch (  IOException e) {
    t=e;
  }
catch (  NoPropertySetStreamException e) {
    t=e;
  }
  if (t != null)   fail(t.getMessage());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Writes a simple property set with a SummaryInformation section to a
 * POIFS and reads it back in.</p>
 * @exception IOException if an I/O exception occurs
 * @exception UnsupportedVariantTypeException if HPSF does not yet support
 * a variant type to be written
 */
@Test public void writeSimplePropertySet() throws IOException, UnsupportedVariantTypeException {
  final String AUTHOR="Rainer Klute";
  final String TITLE="Test Document";
  final File dataDir=_samples.getFile("");
  final File filename=new File(dataDir,POI_FS);
  filename.deleteOnExit();
  final OutputStream out=new FileOutputStream(filename);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps=new MutablePropertySet();
  final MutableSection si=new MutableSection();
  si.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  ps.getSections().set(0,si);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_AUTHOR);
  p.setType(Variant.VT_LPWSTR);
  p.setValue(AUTHOR);
  si.setProperty(p);
  si.setProperty(PropertyIDMap.PID_TITLE,Variant.VT_LPSTR,TITLE);
  poiFs.createDocument(ps.toInputStream(),SummaryInformation.DEFAULT_STREAM_NAME);
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final PropertySet[] psa=new PropertySet[1];
  final POIFSReader r=new POIFSReader();
  r.registerListener(new POIFSReaderListener(){
    public void processPOIFSReaderEvent(    final POIFSReaderEvent event){
      try {
        psa[0]=PropertySetFactory.create(event.getStream());
      }
 catch (      Exception ex) {
        fail(org.apache.poi.hpsf.Util.toString(ex));
      }
    }
  }
,SummaryInformation.DEFAULT_STREAM_NAME);
  InputStream stream=new FileInputStream(filename);
  try {
    r.read(stream);
  }
  finally {
    stream.close();
  }
  assertNotNull(psa[0]);
  assertTrue(psa[0].isSummaryInformation());
  final Section s=(psa[0].getSections().get(0));
  Object p1=s.getProperty(PropertyIDMap.PID_AUTHOR);
  Object p2=s.getProperty(PropertyIDMap.PID_TITLE);
  assertEquals(AUTHOR,p1);
  assertEquals(TITLE,p2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestTable </h4><pre class="type-10 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalRowCnstruction() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  slide.createTable(0,5);
  fail("Table(rownum, colnum) must throw IllegalArgumentException if any of tghe arguments is less than 1");
  ppt.close();
}

</code></pre>

<br>
<pre class="type-10 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalColConstruction() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  slide.createTable(5,0);
  fail("Table(rownum, colnum) must throw IllegalArgumentException if any of tghe arguments is less than 1");
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestComment2000 </h4><pre class="type-2 type-12 type-10 type-1 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChange() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  Comment2000 cb=new Comment2000(data_b,0,data_b.length);
  Comment2000 cn=new Comment2000();
  ca.setAuthor("Hogwarts");
  ca.setAuthorInitials("H");
  ca.setText("Comments are fun things to add in, aren't they?");
  cn.setAuthor("Hogwarts");
  cn.setAuthorInitials("H");
  cn.setText("Comments are fun things to add in, aren't they?");
  Comment2000Atom c2a=ca.getComment2000Atom();
  Comment2000Atom c2n=cn.getComment2000Atom();
  c2a.setNumber(1);
  c2a.setXOffset(0x0a);
  c2a.setYOffset(0x0a);
  c2n.setNumber(1);
  c2n.setXOffset(0x0a);
  c2n.setYOffset(0x0a);
  Date new_date=sdf.parse("2006-01-24 22:25:03.725");
  c2a.setDate(new_date);
  c2n.setDate(new_date);
  assertEquals(ca.getText(),cb.getText());
  assertEquals(cn.getText(),cb.getText());
  assertEquals(ca.getAuthor(),cb.getAuthor());
  assertEquals(cn.getAuthor(),cb.getAuthor());
  assertEquals(ca.getAuthorInitials(),cb.getAuthorInitials());
  assertEquals(cn.getAuthorInitials(),cb.getAuthorInitials());
  try {
    for (int i=0; i < data_a.length; i++) {
      assertEquals(data_a[i],data_b[i]);
    }
    fail();
  }
 catch (  Error e) {
  }
  ByteArrayOutputStream baosa=new ByteArrayOutputStream();
  ByteArrayOutputStream baosn=new ByteArrayOutputStream();
  ca.writeOut(baosa);
  cn.writeOut(baosn);
  byte[] ba=baosa.toByteArray();
  byte[] bn=baosn.toByteArray();
  assertEquals(data_b.length,ba.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],ba[i]);
  }
  assertEquals(data_b.length,bn.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],bn[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestDocumentEncryption </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void cryptoAPIDecryptionOther() throws Exception {
  Biff8EncryptionKey.setCurrentUserPassword("hello");
  String encPpts[]={"Password_Protected-56-hello.ppt","Password_Protected-hello.ppt","Password_Protected-np-hello.ppt"};
  for (  String pptFile : encPpts) {
    try {
      NPOIFSFileSystem fs=new NPOIFSFileSystem(slTests.getFile(pptFile),true);
      HSLFSlideShowImpl hss=new HSLFSlideShowImpl(fs);
      new HSLFSlideShow(hss);
      fs.close();
    }
 catch (    EncryptedPowerPointFileException e) {
      fail(pptFile + " can't be decrypted");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextShape </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify we can get text from TextShape in the following cases:
 * - placeholders
 * - normal TextBox object
 * - text in auto-shapes
 */
@Test public void read() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("text_shapes.ppt"));
  List<String> lst1=new ArrayList<String>();
  HSLFSlide slide=ppt.getSlides().get(0);
  for (  HSLFShape shape : slide.getShapes()) {
    assertTrue("Expected TextShape but found " + shape.getClass().getName(),shape instanceof HSLFTextShape);
    HSLFTextShape tx=(HSLFTextShape)shape;
    List<HSLFTextParagraph> paras=tx.getTextParagraphs();
    assertNotNull(paras);
    int runType=paras.get(0).getRunType();
    ShapeType type=shape.getShapeType();
    String rawText=HSLFTextParagraph.getRawText(paras);
switch (type) {
case TEXT_BOX:
      assertEquals("Text in a TextBox",rawText);
    break;
case RECT:
  if (runType == TextHeaderAtom.OTHER_TYPE)   assertEquals("Rectangle",rawText);
 else   if (runType == TextHeaderAtom.TITLE_TYPE)   assertEquals("Title Placeholder",rawText);
break;
case OCTAGON:
assertEquals("Octagon",rawText);
break;
case ELLIPSE:
assertEquals("Ellipse",rawText);
break;
case ROUND_RECT:
assertEquals("RoundRectangle",rawText);
break;
default :
fail("Unexpected shape: " + shape.getShapeName());
}
lst1.add(rawText);
}
List<String> lst2=new ArrayList<String>();
for (List<HSLFTextParagraph> paras : slide.getTextParagraphs()) {
lst2.add(HSLFTextParagraph.getRawText(paras));
}
assertTrue(lst1.containsAll(lst2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.extractor.TestOldExcelExtractor </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDirectoryNodeInvalidFile() throws Exception {
  File file=POIDataSamples.getDocumentInstance().getFile("test.doc");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(file);
  try {
    OldExcelExtractor extractor=new OldExcelExtractor(fs.getRoot());
    extractor.close();
    fail("Should catch exception here");
  }
 catch (  FileNotFoundException e) {
  }
 finally {
    fs.close();
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testOpenNonExistingFile() throws Exception {
  try {
    OldExcelExtractor extractor=new OldExcelExtractor(new File("notexistingfile.xls"));
    extractor.close();
    fail("Should catch Exception here");
  }
 catch (  EmptyFileException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testOpenInvalidFile() throws Exception {
  try {
    createExtractor("WithVariousData.xlsx");
    fail("Should catch Exception here");
  }
 catch (  OfficeXmlFileException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRVA </h4><pre class="type-2 type-14 type-10 type-3 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void confirmCell(){
  Ptg[] excelPtgs=FormulaExtractor.getPtgs(formulaCell);
  Ptg[] poiPtgs=HSSFFormulaParser.parse(formula,workbook);
  int nExcelTokens=excelPtgs.length;
  int nPoiTokens=poiPtgs.length;
  if (nExcelTokens != nPoiTokens) {
    if (nExcelTokens == nPoiTokens + 1 && excelPtgs[0].getClass() == AttrPtg.class) {
      Ptg[] temp=new Ptg[nExcelTokens];
      temp[0]=excelPtgs[0];
      System.arraycopy(poiPtgs,0,temp,1,nPoiTokens);
      poiPtgs=temp;
    }
 else {
      fail("Expected " + nExcelTokens + " tokens but got "+ nPoiTokens);
    }
  }
  boolean hasMismatch=false;
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < nExcelTokens; i++) {
    Ptg poiPtg=poiPtgs[i];
    Ptg excelPtg=excelPtgs[i];
    if (excelPtg.getClass() != poiPtg.getClass()) {
      hasMismatch=true;
      sb.append("  mismatch token type[" + i + "] "+ getShortClassName(excelPtg)+ " "+ excelPtg.getRVAType()+ " - "+ getShortClassName(poiPtg)+ " "+ poiPtg.getRVAType());
      sb.append(NEW_LINE);
      continue;
    }
    if (poiPtg.isBaseToken()) {
      continue;
    }
    sb.append("  token[" + i + "] "+ excelPtg.toString()+ " "+ excelPtg.getRVAType());
    if (excelPtg.getPtgClass() != poiPtg.getPtgClass()) {
      hasMismatch=true;
      sb.append(" - was " + poiPtg.getRVAType());
    }
    sb.append(NEW_LINE);
  }
  assertFalse(hasMismatch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRowBlocksReader </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbnormalPivotTableRecords_bug46280(){
  int SXVIEW_SID=ViewDefinitionRecord.sid;
  Record[] inRecs={new RowRecord(0),new NumberRecord(),new UnknownRecord(SXVIEW_SID,"dummydata (SXVIEW: View Definition)".getBytes(LocaleUtil.CHARSET_1252)),new WindowTwoRecord()};
  RecordStream rs=new RecordStream(Arrays.asList(inRecs),0);
  RowBlocksReader rbr=new RowBlocksReader(rs);
  if (rs.peekNextClass() == WindowTwoRecord.class) {
    fail("Identified bug 46280b");
  }
  RecordStream rbStream=rbr.getPlainRecordStream();
  assertEquals(inRecs[0],rbStream.getNext());
  assertEquals(inRecs[1],rbStream.getNext());
  assertFalse(rbStream.hasNext());
  assertTrue(rs.hasNext());
  assertEquals(inRecs[2],rs.getNext());
  assertEquals(inRecs[3],rs.getNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestSheet </h4><pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure page break functionality works (in memory)
 */
@Test public void testRowPageBreaks(){
  short colFrom=0;
  short colTo=255;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(0,colFrom,colTo);
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(10,colFrom,colTo);
  sheet.setRowBreak(11,colFrom,colTo);
  assertTrue("no row break at 10",sheet.isRowBroken(10));
  assertTrue("no row break at 11",sheet.isRowBroken(11));
  assertEquals("3 row break available",3,sheet.getNumRowBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is11=false;
  int[] rowBreaks=sheet.getRowBreaks();
  for (int i=0; i < rowBreaks.length; i++) {
    int main=rowBreaks[i];
    if (main != 0 && main != 10 && main != 11)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 10)     is10=true;
    if (main == 11)     is11=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is10 && is11);
  sheet.removeRowBreak(11);
  assertFalse("row should be removed",sheet.isRowBroken(11));
  sheet.removeRowBreak(0);
  assertFalse("row should be removed",sheet.isRowBroken(0));
  sheet.removeRowBreak(10);
  assertFalse("row should be removed",sheet.isRowBroken(10));
  assertEquals("no more breaks",0,sheet.getNumRowBreaks());
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMergedRegion(){
  InternalSheet sheet=InternalSheet.createSheet();
  int regionsToAdd=4096;
  for (int n=0; n < regionsToAdd; n++) {
    int index=sheet.addMergedRegion(0,(short)0,1,(short)1);
    assertTrue("Merged region index expected to be " + n + " got "+ index,index == n);
  }
  assertTrue(sheet.getNumMergedRegions() == regionsToAdd);
  MergedCellListener mcListener=new MergedCellListener();
  sheet.visitContainedRecords(mcListener,0);
  int recordsAdded=mcListener.getCount();
  int recordsExpected=regionsToAdd / 1027;
  if ((regionsToAdd % 1027) != 0)   recordsExpected++;
  assertTrue("The " + regionsToAdd + " merged regions should have been spread out over "+ recordsExpected+ " records, not "+ recordsAdded,recordsAdded == recordsExpected);
  try {
    sheet.addMergedRegion(10,(short)10,9,(short)12);
    fail("Expected an exception to occur");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The 'to' row (9) must not be less than the 'from' row (10)",e.getMessage());
  }
  try {
    sheet.addMergedRegion(10,(short)10,12,(short)9);
    fail("Expected an exception to occur");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The 'to' col (9) must not be less than the 'from' col (10)",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure column pag breaks works properly (in-memory)
 */
@Test public void testColPageBreaks(){
  short rowFrom=0;
  short rowTo=(short)65535;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)1,rowFrom,rowTo);
  sheet.setColumnBreak((short)10,rowFrom,rowTo);
  sheet.setColumnBreak((short)15,rowFrom,rowTo);
  assertTrue("no col break at 1",sheet.isColumnBroken(1));
  assertTrue("no col break at 10",sheet.isColumnBroken(10));
  assertTrue("no col break at 15",sheet.isColumnBroken(15));
  assertEquals("4 col break available",4,sheet.getNumColumnBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is1=false;
  boolean is15=false;
  int[] colBreaks=sheet.getColumnBreaks();
  for (int i=0; i < colBreaks.length; i++) {
    int main=colBreaks[i];
    if (main != 0 && main != 1 && main != 10 && main != 15)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 1)     is1=true;
    if (main == 10)     is10=true;
    if (main == 15)     is15=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is1 && is10&& is15);
  sheet.removeColumnBreak(15);
  assertFalse("column break should not be there",sheet.isColumnBroken(15));
  sheet.removeColumnBreak(0);
  assertFalse("column break should not be there",sheet.isColumnBroken(0));
  sheet.removeColumnBreak(1);
  assertFalse("column break should not be there",sheet.isColumnBroken(1));
  sheet.removeColumnBreak(10);
  assertFalse("column break should not be there",sheet.isColumnBroken(10));
  assertEquals("no more breaks",0,sheet.getNumColumnBreaks());
}

</code></pre>

<br>
<pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * In 3.1, setting margins between creating first row and first cell caused an exception.
 */
@Test public void testSetMargins_bug45717() throws Exception {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Vorschauliste");
  HSSFRow row=sheet.createRow(0);
  sheet.setMargin(HSSFSheet.LeftMargin,0.3);
  try {
    row.createCell(0);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot create value records before row records exist")) {
      fail("Identified bug 45717");
    }
    throw e;
  }
 finally {
    workbook.close();
  }
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMisplacedMergedCellsRecords_bug45699() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("ex45698-22488.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  HSSFRow row=sheet.getRow(3);
  HSSFCell cell=row.getCell(4);
  if (cell == null) {
    fail("Identified bug 45699");
  }
  assertEquals("Informations",cell.getRichStringCellValue().getString());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestHyperlinkRecord </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReserializeUNC(){
  RecordInputStream in=TestcaseRecordInputStream.create(HyperlinkRecord.sid,dataUNC);
  HyperlinkRecord hr=new HyperlinkRecord(in);
  byte[] ser=hr.serialize();
  TestcaseRecordInputStream.confirmRecordEncoding(HyperlinkRecord.sid,dataUNC,ser);
  try {
    hr.toString();
  }
 catch (  NullPointerException e) {
    fail("Identified bug with option URL and UNC set at same time");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestSSTRecord </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test simple addString
 */
@Test public void testSimpleAddString(){
  SSTRecord record=new SSTRecord();
  UnicodeString s1=new UnicodeString("Hello world");
  UnicodeString s2=new UnicodeString("Hello world\u2122");
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(1,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(2,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(1,record.addString(s2));
  assertEquals(s2,record.getString(1));
  assertEquals(2,record.countStrings());
  assertEquals(3,record.getNumStrings());
  assertEquals(2,record.getNumUniqueStrings());
  Iterator<UnicodeString> iter=record.getStrings();
  while (iter.hasNext()) {
    UnicodeString ucs=iter.next();
    if (ucs.equals(s1)) {
      assertEquals((byte)0,ucs.getOptionFlags());
    }
 else     if (ucs.equals(s2)) {
      assertEquals((byte)1,ucs.getOptionFlags());
    }
 else {
      fail("cannot match string: " + ucs.getString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.aggregates.TestRowRecordsAggregate </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This problem was noted as the overt symptom of bug 46280.  The logic for skipping {@link UnknownRecord}s in the constructor {@link RowRecordsAggregate} did not allow for the
 * possibility of tailing {@link ContinueRecord}s.<br/>
 * The functionality change being tested here is actually not critical to the overall fix
 * for bug 46280, since the fix involved making sure the that offending <i>PivotTable</i>
 * records do not get into {@link RowRecordsAggregate}.<br/>
 * This fix in {@link RowRecordsAggregate} was implemented anyway since any {@link UnknownRecord} has the potential of being 'continued'.
 */
@Test public void testUnknownContinue_bug46280(){
  Record[] inRecs={new RowRecord(0),new NumberRecord(),new UnknownRecord(0x5555,"dummydata".getBytes(LocaleUtil.CHARSET_1252)),new ContinueRecord("moredummydata".getBytes(LocaleUtil.CHARSET_1252))};
  RecordStream rs=new RecordStream(Arrays.asList(inRecs),0);
  RowRecordsAggregate rra;
  try {
    rra=new RowRecordsAggregate(rs,SharedValueManager.createEmpty());
  }
 catch (  RuntimeException e) {
    if (e.getMessage().startsWith("Unexpected record type")) {
      fail("Identified bug 46280a");
    }
    throw e;
  }
  RecordCollector rv=new RecordCollector();
  rra.visitContainedRecords(rv);
  Record[] outRecs=rv.getRecords();
  assertEquals(5,outRecs.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestBugs </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void bug34775(){
  try {
    openSample("34775.xls");
  }
 catch (  NullPointerException e) {
    fail("identified bug 34775");
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * java.io.IOException: block[ 0 ] already removed
 * (is an excel 95 file though)
 */
@Test public void bug46904() throws Exception {
  try {
    OPOIFSFileSystem fs=new OPOIFSFileSystem(HSSFITestDataProvider.instance.openWorkbookStream("46904.xls"));
    new HSSFWorkbook(fs.getRoot(),false).close();
    fail("Should catch exception here");
  }
 catch (  OldExcelFormatException e) {
    assertTrue(e.getMessage().startsWith("The supplied spreadsheet seems to be Excel"));
  }
  try {
    NPOIFSFileSystem fs=new NPOIFSFileSystem(HSSFITestDataProvider.instance.openWorkbookStream("46904.xls"));
    try {
      new HSSFWorkbook(fs.getRoot(),false).close();
      fail("Should catch exception here");
    }
  finally {
      fs.close();
    }
  }
 catch (  OldExcelFormatException e) {
    assertTrue(e.getMessage().startsWith("The supplied spreadsheet seems to be Excel"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 42618: RecordFormatException reading a file containing
 * =CHOOSE(2,A2,A3,A4)
 */
@Test public void bug42618() throws Exception {
  HSSFWorkbook wb1=openSample("SimpleWithChoose.xls");
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet s=wb2.getSheetAt(0);
  HSSFRow r1=s.getRow(0);
  HSSFCell c1=r1.getCell(1);
  assertEquals("=CHOOSE(2,A2,A3,A4)",c1.getRichStringCellValue().toString());
  HSSFRow r2=s.getRow(1);
  HSSFCell c2=r2.getCell(1);
  assertEquals(25,(int)c2.getNumericCellValue());
  try {
    assertEquals("CHOOSE(2,A2,A3,A4)",c2.getCellFormula());
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("Too few arguments") && e.getMessage().indexOf("ConcatPtg") > 0) {
      fail("identified bug 44306");
    }
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * From the mailing list - ensure we can handle a formula
 * containing a zip code, eg ="70164"
 */
@Test public void bugZipCodeFormulas() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet();
  s.createRow(0);
  HSSFCell c1=s.getRow(0).createCell(0);
  HSSFCell c2=s.getRow(0).createCell(1);
  HSSFCell c3=s.getRow(0).createCell(2);
  c1.setCellFormula("70164");
  c2.setCellFormula("\"70164\"");
  c3.setCellFormula("\"90210\"");
  assertEquals("70164",c1.getCellFormula());
  assertEquals("\"70164\"",c2.getCellFormula());
  confirmCachedValue(0.0,c1);
  confirmCachedValue(0.0,c2);
  confirmCachedValue(0.0,c3);
  c3.setCellValue(new HSSFRichTextString("test"));
  confirmCachedValue("test",c3);
  try {
    c3.getNumericCellValue();
    fail("exception should have been thrown");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cannot get a numeric value from a text formula cell",e.getMessage());
  }
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  eval.evaluateFormulaCell(c1);
  eval.evaluateFormulaCell(c2);
  eval.evaluateFormulaCell(c3);
  confirmCachedValue(70164.0,c1);
  confirmCachedValue("70164",c2);
  confirmCachedValue("90210",c3);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet ns=wb2.getSheetAt(0);
  HSSFCell nc1=ns.getRow(0).getCell(0);
  HSSFCell nc2=ns.getRow(0).getCell(1);
  HSSFCell nc3=ns.getRow(0).getCell(2);
  confirmCachedValue(70164.0,nc1);
  confirmCachedValue("70164",nc2);
  confirmCachedValue("90210",nc3);
  @SuppressWarnings("deprecation") CellValueRecordInterface[] cvrs=ns.getSheet().getValueRecords();
  for (int i=0; i < cvrs.length; i++) {
    CellValueRecordInterface cvr=cvrs[i];
    if (cvr instanceof FormulaRecordAggregate) {
      FormulaRecordAggregate fr=(FormulaRecordAggregate)cvr;
      if (i == 0) {
        assertEquals(70164.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNull(fr.getStringRecord());
      }
 else       if (i == 1) {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("70164",fr.getStringRecord().getString());
      }
 else {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("90210",fr.getStringRecord().getString());
      }
    }
  }
  assertEquals(3,cvrs.length);
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestDataValidation </h4><pre class="type-2 type-14 type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddToExistingSheet() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("dvEmpty.xls");
  int dvRow=0;
  Sheet sheet=wb.getSheetAt(0);
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint dc=dataValidationHelper.createIntegerConstraint(OperatorType.EQUAL,"42",null);
  DataValidation dv=dataValidationHelper.createValidation(dc,new CellRangeAddressList(dvRow,dvRow,0,0));
  dv.setEmptyCellAllowed(false);
  dv.setErrorStyle(ErrorStyle.STOP);
  dv.setShowPromptBox(true);
  dv.createErrorBox("Xxx","Yyy");
  dv.setSuppressDropDownArrow(true);
  sheet.addValidationData(dv);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  wb.write(baos);
  byte[] wbData=baos.toByteArray();
  byte[] dvHeaderRecStart={(byte)0xB2,0x01,0x12,0x00};
  int dvHeaderOffset=findIndex(wbData,dvHeaderRecStart);
  assertTrue(dvHeaderOffset > 0);
  int nextRecIndex=dvHeaderOffset + 22;
  int nextSid=((wbData[nextRecIndex + 0] << 0) & 0x00FF) + ((wbData[nextRecIndex + 1] << 8) & 0xFF00);
  if (nextSid == 0x0867) {
    fail("Identified bug 45519");
  }
  assertEquals(DVRecord.sid,nextSid);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestEscherGraphics2d </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDrawString(){
  graphics.drawString("This is a test",10,10);
  HSSFTextbox t=(HSSFTextbox)escherGroup.getChildren().get(0);
  assertEquals("This is a test",t.getString().getString());
  Font font=new Font("Forte",Font.PLAIN,12);
  graphics.setFont(font);
  graphics.drawString("This is another test",10,10);
  font=new Font("dialog",Font.PLAIN,12);
  graphics.setFont(font);
  graphics.drawString("This is another test",10,10);
  font=new Font("dialog",Font.BOLD,12);
  graphics.setFont(font);
  graphics.drawString("This is another test",10,10);
  font=new Font("IamAmadeUPfont",Font.PLAIN,22);
  graphics.setFont(font);
  try {
    graphics.drawString("This is another test",10,10);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestFormulaEvaluatorBugs </h4><pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEvaluateInCellWithErrorCode_bug44950() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(1);
  HSSFCell cell=row.createCell(0);
  cell.setCellFormula("na()");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  try {
    fe.evaluateInCell(cell);
  }
 catch (  NumberFormatException e) {
    if (e.getMessage().equals("You cannot get an error value from a non-error cell")) {
      fail("Identified bug 44950 b");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testSlowEvaluate45376() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  for (int i=1; i < 10; i++) {
    HSSFCell cell=row.createCell(i);
    char prevCol=(char)('A' + i - 1);
    String prevCell=prevCol + "1";
    String formula="IF(DATE(YEAR(" + prevCell + "),MONTH("+ prevCell+ ")+1,1)<=$D$3,"+ "DATE(YEAR("+ prevCell+ "),MONTH("+ prevCell+ ")+1,1),NA())";
    cell.setCellFormula(formula);
  }
  Calendar cal=LocaleUtil.getLocaleCalendar(2000,0,1,0,0,0);
  row.createCell(0).setCellValue(cal);
  HSSFCell cell=row.getCell(8);
  EvalListener evalListener=new EvalListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cell));
  int evalCount=evalListener.getCountCacheMisses();
  if (evalCount > 10) {
    fail("Identifed bug 45376 - Formula evaluator should cache values");
  }
  assertEquals(8,evalCount);
  assertEquals(8,evalListener.getCountCacheHits());
  assertEquals(ErrorEval.NA,ve);
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can evaluate boolean cells properly
 */
@Test public void testEvaluateBooleanInCell_bug44508() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  wb.setSheetName(0,"Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cell=row.createCell(0);
  cell.setCellFormula("1=1");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  try {
    fe.evaluateInCell(cell);
  }
 catch (  NumberFormatException e) {
    fail("Identified bug 44508");
  }
  assertEquals(true,cell.getBooleanCellValue());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFCell </h4><pre class="type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void testDeprecatedMethods() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  HSSFRow row=sheet.createRow(0);
  HSSFCell cell=row.createCell(0);
  assertEquals(wb.getWorkbook(),cell.getBoundWorkbook());
  try {
    cell.getCachedFormulaResultType();
    fail("Should catch exception");
  }
 catch (  IllegalStateException e) {
  }
  try {
    assertNotNull(new HSSFCell(wb,sheet,0,(short)0,Cell.CELL_TYPE_ERROR + 1));
    fail("Should catch exception");
  }
 catch (  RuntimeException e) {
  }
  cell.removeCellComment();
  cell.removeCellComment();
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test to ensure we can only assign cell styles that belong
 * to our workbook, and not those from other workbooks.
 */
@Test public void testCellStyleWorkbookMatch() throws Exception {
  HSSFWorkbook wbA=new HSSFWorkbook();
  HSSFWorkbook wbB=new HSSFWorkbook();
  HSSFCellStyle styA=wbA.createCellStyle();
  HSSFCellStyle styB=wbB.createCellStyle();
  styA.verifyBelongsToWorkbook(wbA);
  styB.verifyBelongsToWorkbook(wbB);
  try {
    styA.verifyBelongsToWorkbook(wbB);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    styB.verifyBelongsToWorkbook(wbA);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  HSSFCell cellA=wbA.createSheet().createRow(0).createCell(0);
  HSSFCell cellB=wbB.createSheet().createRow(0).createCell(0);
  cellA.setCellStyle(styA);
  cellB.setCellStyle(styB);
  try {
    cellA.setCellStyle(styB);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    cellB.setCellStyle(styA);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  wbB.close();
  wbA.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFDateUtil </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void absoluteDayYearTooLow(){
  Calendar cal=LocaleUtil.getLocaleCalendar(1899,JANUARY,1,0,0,0);
  try {
    HSSFDateUtil.absoluteDay(cal,false);
    fail("Should fail here");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    cal.set(1903,JANUARY,1,0,0,0);
    HSSFDateUtil.absoluteDay(cal,true);
    fail("Should fail here");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFFormulaEvaluator </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for bug due to attempt to convert a cached formula error result to a boolean
 */
@Test @Override public void testUpdateCachedFormulaResultFromErrorToNumber_bug46479() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  HSSFCell cellB1=row.createCell(1);
  cellB1.setCellFormula("A1+1");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  cellA1.setCellErrorValue((byte)HSSFErrorConstants.ERROR_NAME);
  fe.evaluateFormulaCell(cellB1);
  cellA1.setCellValue(2.5);
  fe.notifyUpdateCell(cellA1);
  try {
    fe.evaluateInCell(cellB1);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot get a numeric value from a error formula cell")) {
      fail("Identified bug 46479a");
    }
  }
  assertEquals(3.5,cellB1.getNumericCellValue(),0.0);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensures that we can handle NameXPtgs in the formulas
 * we parse.
 */
@Test public void testXRefs() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("XRefCalc.xls");
  HSSFWorkbook wb2=HSSFTestDataSamples.openSampleWorkbook("XRefCalcData.xls");
  Cell cell;
  cell=wb1.getSheetAt(0).getRow(1).getCell(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(12.30,cell.getNumericCellValue(),0.0001);
  assertEquals("VLOOKUP(PART,COSTS,2,FALSE)",cell.getCellFormula());
  cell=wb1.getSheetAt(0).getRow(1).getCell(4);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(36.90,cell.getNumericCellValue(),0.0001);
  assertEquals("Cost*Markup_Cost",cell.getCellFormula());
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2)});
  eval.evaluateFormulaCell(wb1.getSheetAt(0).getRow(1).getCell(2));
  eval.evaluateFormulaCell(wb1.getSheetAt(0).getRow(1).getCell(4));
  cell=wb1.getSheetAt(0).getRow(1).getCell(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(12.30,cell.getNumericCellValue(),0.0001);
  cell=wb1.getSheetAt(0).getRow(1).getCell(4);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(36.90,cell.getNumericCellValue(),0.0001);
  cell=wb1.getSheetAt(0).getRow(1).createCell(40);
  cell.setCellFormula("Cost*[XRefCalcData.xls]MarkupSheet!$B$1");
  assertEquals("Cost*[XRefCalcData.xls]MarkupSheet!$B$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals(24.60 * 1.8,cell.getNumericCellValue(),0);
  try {
    cell=wb1.getSheetAt(0).getRow(1).createCell(42);
    cell.setCellFormula("[alt.xls]Sheet0!$A$1");
    fail("New workbook not linked, shouldn't be able to add");
  }
 catch (  Exception e) {
  }
  HSSFWorkbook wb3=new HSSFWorkbook();
  wb3.createSheet().createRow(0).createCell(0).setCellValue("In another workbook");
  wb1.linkExternalWorkbook("alt.xls",wb3);
  cell.setCellFormula("[alt.xls]Sheet0!$A$1");
  assertEquals("[alt.xls]Sheet0!$A$1",cell.getCellFormula());
  try {
    eval.evaluate(cell);
    fail("No cached value and no link to workbook, shouldn't evaluate");
  }
 catch (  Exception e) {
  }
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls","alt.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2),new HSSFFormulaEvaluator(wb3)});
  eval.evaluateFormulaCell(cell);
  assertEquals("In another workbook",cell.getStringCellValue());
  HSSFWorkbook wb4=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  eval=new HSSFFormulaEvaluator(wb4);
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls","alt.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2),new HSSFFormulaEvaluator(wb3)});
  cell=wb4.getSheetAt(0).getRow(1).getCell(40);
  assertEquals("Cost*[XRefCalcData.xls]MarkupSheet!$B$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals(24.60 * 1.8,cell.getNumericCellValue(),0);
  cell=wb4.getSheetAt(0).getRow(1).getCell(42);
  assertEquals("[alt.xls]Sheet0!$A$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals("In another workbook",cell.getStringCellValue());
  wb4.close();
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testShortCircuitIfEvaluation() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  cellA1.setCellFormula("if(B1,C1,D1+E1+F1)");
  for (int i=1; i < 6; i++) {
    row.createCell(i).setCellFormula(String.valueOf(i));
  }
  EvalCountListener evalListener=new EvalCountListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cellA1));
  int evalCount=evalListener.getEvalCount();
  if (evalCount == 6) {
    fail("Identifed bug 48195 - Formula evaluator should short-circuit IF() calculations.");
  }
  assertEquals(3,evalCount);
  assertEquals(2.0,((NumberEval)ve).getNumberValue(),0D);
  wb.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When evaluating defined names, POI has to decide whether it is capable.  Currently
 * (May2009) POI only supports simple cell and area refs.<br/>
 * The sample spreadsheet (bugzilla attachment 23508) had a name flagged as 'complex'
 * which contained a simple area ref.  It is not clear what the 'complex' flag is used
 * for but POI should look elsewhere to decide whether it can evaluate the name.
 */
@Test public void testDefinedNameWithComplexFlag_bug47048() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Input");
  HSSFName definedName=wb.createName();
  definedName.setNameName("Is_Multicar_Vehicle");
  definedName.setRefersToFormula("Input!$B$17:$G$17");
  HSSFRow row17=sheet.createRow(16);
  row17.createCell(0).setCellValue(25.0);
  row17.createCell(1).setCellValue(1.33);
  row17.createCell(2).setCellValue(4.0);
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  cellA1.setCellFormula("SUM(Is_Multicar_Vehicle)");
  NameRecord nameRec=TestHSSFName.getNameRecord(definedName);
  nameRec.setOptionFlag((short)0x10);
  HSSFFormulaEvaluator hsf=new HSSFFormulaEvaluator(wb);
  CellValue value;
  try {
    value=hsf.evaluate(cellA1);
    assertEquals(Cell.CELL_TYPE_NUMERIC,value.getCellType());
    assertEquals(5.33,value.getNumberValue(),0.0);
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Don't now how to evalate name 'Is_Multicar_Vehicle'")) {
      fail("Identified bug 47048a");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFName </h4><pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletedReference() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("24207.xls");
  assertEquals(2,wb.getNumberOfNames());
  HSSFName name1=wb.getNameAt(0);
  assertEquals("a",name1.getNameName());
  assertEquals("Sheet1!$A$1",name1.getRefersToFormula());
  new AreaReference(name1.getRefersToFormula());
  assertTrue("Successfully constructed first reference",true);
  HSSFName name2=wb.getNameAt(1);
  assertEquals("b",name2.getNameName());
  assertEquals("Sheet1!#REF!",name2.getRefersToFormula());
  assertTrue(name2.isDeleted());
  try {
    new AreaReference(name2.getRefersToFormula());
    fail("attempt to supply an invalid reference to AreaReference constructor results in exception");
  }
 catch (  IllegalArgumentException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFRow </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastAndFirstColumns_bug46654() throws IOException {
  int ROW_IX=10;
  int COL_IX=3;
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Sheet1");
  RowRecord rowRec=new RowRecord(ROW_IX);
  rowRec.setFirstCol((short)2);
  rowRec.setLastCol((short)5);
  BlankRecord br=new BlankRecord();
  br.setRow(ROW_IX);
  br.setColumn((short)COL_IX);
  sheet.getSheet().addValueRecord(ROW_IX,br);
  HSSFRow row=new HSSFRow(workbook,sheet,rowRec);
  HSSFCell cell=row.createCellFromRecord(br);
  if (row.getFirstCellNum() == 2 && row.getLastCellNum() == 5) {
    fail("Identified bug 46654a");
  }
  assertEquals(COL_IX,row.getFirstCellNum());
  assertEquals(COL_IX + 1,row.getLastCellNum());
  row.removeCell(cell);
  assertEquals(-1,row.getFirstCellNum());
  assertEquals(-1,row.getLastCellNum());
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveCell() throws IOException {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet();
  HSSFRow row=sheet.createRow(0);
  HSSFRow rowB=sheet.createRow(1);
  HSSFCell cellA2=rowB.createCell(0);
  assertEquals(0,rowB.getFirstCellNum());
  assertEquals(0,rowB.getFirstCellNum());
  assertEquals(-1,row.getLastCellNum());
  assertEquals(-1,row.getFirstCellNum());
  HSSFCell cellB2=row.createCell(1);
  row.createCell(2);
  row.createCell(3);
  assertEquals(1,row.getFirstCellNum());
  assertEquals(4,row.getLastCellNum());
  try {
    row.moveCell(cellB2,(short)3);
    fail("IllegalArgumentException should have been thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    row.moveCell(cellA2,(short)3);
    fail("IllegalArgumentException should have been thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  assertNotNull(row.getCell(1));
  row.moveCell(cellB2,(short)5);
  assertNull(row.getCell(1));
  assertNotNull(row.getCell(5));
  assertEquals(5,cellB2.getColumnIndex());
  assertEquals(2,row.getFirstCellNum());
  assertEquals(6,row.getLastCellNum());
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheet </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * POI now (Sep 2008) allows sheet names longer than 31 chars (for other apps besides Excel).
 * Since Excel silently truncates to 31, make sure that POI enforces uniqueness on the first
 * 31 chars.
 */
@Test public void longSheetNames() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  final String SAME_PREFIX="A123456789B123456789C123456789";
  wb.createSheet(SAME_PREFIX + "Dxxxx");
  try {
    wb.createSheet(SAME_PREFIX + "Dyyyy");
    fail("Expected exception not thrown");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  wb.createSheet(SAME_PREFIX + "Exxxx");
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void columnWidthShort() throws IOException {
  HSSFWorkbook wb1=new HSSFWorkbook();
  Sheet sheet=wb1.createSheet();
  sheet.setDefaultColumnWidth((short)10);
  assertEquals(10,sheet.getDefaultColumnWidth());
  assertEquals(256 * 10,sheet.getColumnWidth((short)0));
  assertEquals(256 * 10,sheet.getColumnWidth((short)1));
  assertEquals(256 * 10,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    sheet.setColumnWidth((short)i,w);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setDefaultColumnWidth((short)20);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setColumnWidth((short)10,40000);
  assertEquals(40000,sheet.getColumnWidth((short)10));
  try {
    sheet.setColumnWidth((short)9,256 * 256);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum column width for an individual cell is 255 characters.",e.getMessage());
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  assertEquals(40000,sheet.getColumnWidth((short)10));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void zoom() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  assertEquals(-1,sheet.getSheet().findFirstRecordLocBySid(SCLRecord.sid));
  sheet.setZoom(75);
  assertTrue(sheet.getSheet().findFirstRecordLocBySid(SCLRecord.sid) > 0);
  SCLRecord sclRecord=(SCLRecord)sheet.getSheet().findFirstRecordBySid(SCLRecord.sid);
  assertEquals(75,100 * sclRecord.getNumerator() / sclRecord.getDenominator());
  int sclLoc=sheet.getSheet().findFirstRecordLocBySid(SCLRecord.sid);
  int window2Loc=sheet.getSheet().findFirstRecordLocBySid(WindowTwoRecord.sid);
  assertTrue(sclLoc == window2Loc + 1);
  try {
    sheet.setZoom(0);
    fail("Should catch Exception here");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Numerator must be greater than 0 and less than 65536",e.getMessage());
  }
  try {
    sheet.setZoom(65536);
    fail("Should catch Exception here");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Numerator must be greater than 0 and less than 65536",e.getMessage());
  }
  try {
    sheet.setZoom(2,0);
    fail("Should catch Exception here");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Denominator must be greater than 0 and less than 65536",e.getMessage());
  }
  try {
    sheet.setZoom(2,65536);
    fail("Should catch Exception here");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Denominator must be greater than 0 and less than 65536",e.getMessage());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void groupRowsExisting() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("NoGutsRecords.xls");
  HSSFSheet s=wb1.getSheetAt(0);
  HSSFRow r1=s.getRow(0);
  HSSFRow r2=s.getRow(1);
  HSSFRow r3=s.getRow(2);
  HSSFRow r4=s.getRow(3);
  HSSFRow r5=s.getRow(4);
  HSSFRow r6=s.getRow(5);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(0,r3.getOutlineLevel());
  assertEquals(0,r4.getOutlineLevel());
  assertEquals(0,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  s.groupRow(2,4);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(1,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  HSSFWorkbook wb2=null;
  try {
    wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  }
 catch (  OutOfMemoryError e) {
    fail("Identified bug 39903");
  }
  s=wb2.getSheetAt(0);
  r1=s.getRow(0);
  r2=s.getRow(1);
  r3=s.getRow(2);
  r4=s.getRow(3);
  r5=s.getRow(4);
  r6=s.getRow(5);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(1,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * {@link PasswordRecord} belongs with the rest of the Worksheet Protection Block
 * (which should be before {@link DimensionsRecord}).
 */
@Test public void protectSheetRecordOrder_bug47363a() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet();
  s.protectSheet("secret");
  RecordCollector rc=new RecordCollector();
  s.getSheet().visitContainedRecords(rc,0);
  Record[] recs=rc.getRecords();
  int nRecs=recs.length;
  if (recs[nRecs - 2] instanceof PasswordRecord && recs[nRecs - 5] instanceof DimensionsRecord) {
    fail("Identified bug 47363a - PASSWORD after DIMENSION");
  }
  confirmRecordClass(recs,nRecs - 4,DimensionsRecord.class);
  confirmRecordClass(recs,nRecs - 9,ProtectRecord.class);
  confirmRecordClass(recs,nRecs - 8,ObjectProtectRecord.class);
  confirmRecordClass(recs,nRecs - 7,ScenarioProtectRecord.class);
  confirmRecordClass(recs,nRecs - 6,PasswordRecord.class);
  wb.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * There should be no problem with adding data validations after sheet protection
 */
@Test public void dvProtectionOrder_bug47363b() throws IOException {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Sheet1");
  sheet.protectSheet("secret");
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint dvc=dataValidationHelper.createIntegerConstraint(DataValidationConstraint.OperatorType.BETWEEN,"10","100");
  CellRangeAddressList numericCellAddressList=new CellRangeAddressList(0,0,1,1);
  DataValidation dv=dataValidationHelper.createValidation(dvc,numericCellAddressList);
  try {
    sheet.addValidationData(dv);
  }
 catch (  IllegalStateException e) {
    String expMsg="Unexpected (org.apache.poi.hssf.record.PasswordRecord) while looking for DV Table insert pos";
    if (expMsg.equals(e.getMessage())) {
      fail("Identified bug 47363b");
    }
    workbook.close();
    throw e;
  }
  RecordCollector rc;
  rc=new RecordCollector();
  sheet.getSheet().visitContainedRecords(rc,0);
  int nRecsWithProtection=rc.getRecords().length;
  sheet.protectSheet(null);
  rc=new RecordCollector();
  sheet.getSheet().visitContainedRecords(rc,0);
  int nRecsWithoutProtection=rc.getRecords().length;
  assertEquals(4,nRecsWithProtection - nRecsWithoutProtection);
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheetUpdateArrayFormulas </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Makes sure the internal state of HSSFSheet is consistent after removing array formulas
 */
@Test public void testAddRemoveArrayFormulas_recordUpdates() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet("Sheet1");
  CellRange<HSSFCell> cr=s.setArrayFormula("123",CellRangeAddress.valueOf("B5:C6"));
  Record[] recs;
  int ix;
  recs=RecordInspector.getRecords(s,0);
  ix=findRecordOfType(recs,ArrayRecord.class,0);
  confirmRecordClass(recs,ix - 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 2,FormulaRecord.class);
  confirmRecordClass(recs,ix + 3,FormulaRecord.class);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,ix + 1) < 0);
  s.removeArrayFormula(cr.getTopLeftCell());
  recs=RecordInspector.getRecords(s,0);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,0) < 0);
  assertTrue(findRecordOfType(recs,FormulaRecord.class,0) < 0);
  RowRecordsAggregate rra=s.getSheet().getRowsAggregate();
  SharedValueManager svm=TestSharedValueManager.extractFromRRA(rra);
  if (svm.getArrayRecord(4,1) != null) {
    fail("Array record was not cleaned up properly.");
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFWorkbook </h4><pre class="type-10 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addSheetTwice() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet1=wb.createSheet("Sheet1");
  assertNotNull(sheet1);
  try {
    wb.createSheet("Sheet1");
    fail("Should fail if we add the same sheet twice");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage(),e.getMessage().contains("already contains a sheet of this name"));
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * If we try to open an old (pre-97) workbook, we get a helpful
 * Exception give to explain what we've done wrong
 */
@Test public void helpfulExceptionOnOldFiles() throws Exception {
  InputStream excel4=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("testEXCEL_4.xls");
  try {
    new HSSFWorkbook(excel4).close();
    fail("Shouldn't be able to load an Excel 4 file");
  }
 catch (  OldExcelFormatException e) {
    assertContains(e.getMessage(),"BIFF4");
  }
  excel4.close();
  InputStream excel5=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("testEXCEL_5.xls");
  try {
    new HSSFWorkbook(excel5).close();
    fail("Shouldn't be able to load an Excel 5 file");
  }
 catch (  OldExcelFormatException e) {
    assertContains(e.getMessage(),"BIFF5");
  }
  excel5.close();
  InputStream excel95=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("testEXCEL_95.xls");
  try {
    new HSSFWorkbook(excel95).close();
    fail("Shouldn't be able to load an Excel 95 file");
  }
 catch (  OldExcelFormatException e) {
    assertContains(e.getMessage(),"BIFF5");
  }
  excel95.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void names() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  try {
    wb.getNameAt(0);
    fail("Fails without any defined names");
  }
 catch (  IllegalStateException e) {
    assertTrue(e.getMessage(),e.getMessage().contains("no defined names"));
  }
  HSSFName name=wb.createName();
  assertNotNull(name);
  assertNull(wb.getName("somename"));
  name.setNameName("myname");
  assertNotNull(wb.getName("myname"));
  assertEquals(0,wb.getNameIndex(name));
  assertEquals(0,wb.getNameIndex("myname"));
  try {
    wb.getNameAt(5);
    fail("Fails without any defined names");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage(),e.getMessage().contains("outside the allowable range"));
  }
  try {
    wb.getNameAt(-3);
    fail("Fails without any defined names");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage(),e.getMessage().contains("outside the allowable range"));
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * If Sheet.getSize() returns a different result to Sheet.serialize(), this will cause the BOF
 * records to be written with invalid offset indexes.  Excel does not like this, and such
 * errors are particularly hard to track down.  This test ensures that HSSFWorkbook throws
 * a specific exception as soon as the situation is detected. See bugzilla 45066
 * @throws IOException 
 */
@Test public void sheetSerializeSizeMismatch_bug45066() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  InternalSheet sheet=wb.createSheet("Sheet1").getSheet();
  List<RecordBase> sheetRecords=sheet.getRecords();
  sheetRecords.add(new BadlyBehavedRecord());
  try {
    wb.getBytes();
    fail("Identified bug 45066 a");
  }
 catch (  IllegalStateException e) {
    assertTrue(e.getMessage().startsWith("Actual serialized sheet size"));
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cellStylesLimit() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  int numBuiltInStyles=wb.getNumCellStyles();
  int MAX_STYLES=4030;
  int limit=MAX_STYLES - numBuiltInStyles;
  for (int i=0; i < limit; i++) {
    wb.createCellStyle();
  }
  assertEquals(MAX_STYLES,wb.getNumCellStyles());
  try {
    wb.createCellStyle();
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEquals("The maximum number of cell styles was exceeded. " + "You can define up to 4000 styles in a .xls workbook",e.getMessage());
  }
  assertEquals(MAX_STYLES,wb.getNumCellStyles());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to make sure that NameRecord.getSheetNumber() is interpreted as a
 * 1-based sheet tab index (not a 1-based extern sheet index)
 */
@Test public void findBuiltInNameRecord() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("testRRaC.xls");
  NameRecord nr;
  assertEquals(3,wb1.getWorkbook().getNumNames());
  nr=wb1.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!$A$1:$IV$1",HSSFFormulaParser.toFormulaString(wb1,nr.getNameDefinition()));
  try {
    wb1.getSheetAt(3).setRepeatingRows(CellRangeAddress.valueOf("9:12"));
    wb1.getSheetAt(3).setRepeatingColumns(CellRangeAddress.valueOf("E:F"));
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Builtin (7) already exists for sheet (4)")) {
      fail("Identified bug 45720b");
    }
    wb1.close();
    throw e;
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(3,wb2.getWorkbook().getNumNames());
  nr=wb2.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!E:F,Sheet2!$A$9:$IV$12",HSSFFormulaParser.toFormulaString(wb2,nr.getNameDefinition()));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.util.TestCellReference </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColNumConversion(){
  assertEquals(0,CellReference.convertColStringToIndex("A"));
  assertEquals(1,CellReference.convertColStringToIndex("B"));
  assertEquals(25,CellReference.convertColStringToIndex("Z"));
  assertEquals(26,CellReference.convertColStringToIndex("AA"));
  assertEquals(27,CellReference.convertColStringToIndex("AB"));
  assertEquals(51,CellReference.convertColStringToIndex("AZ"));
  assertEquals(701,CellReference.convertColStringToIndex("ZZ"));
  assertEquals(702,CellReference.convertColStringToIndex("AAA"));
  assertEquals(18277,CellReference.convertColStringToIndex("ZZZ"));
  assertEquals("A",CellReference.convertNumToColString(0));
  assertEquals("B",CellReference.convertNumToColString(1));
  assertEquals("Z",CellReference.convertNumToColString(25));
  assertEquals("AA",CellReference.convertNumToColString(26));
  assertEquals("ZZ",CellReference.convertNumToColString(701));
  assertEquals("AAA",CellReference.convertNumToColString(702));
  assertEquals("ZZZ",CellReference.convertNumToColString(18277));
  assertEquals(0,CellReference.convertColStringToIndex("$A"));
  assertEquals(25,CellReference.convertColStringToIndex("$Z"));
  assertEquals(26,CellReference.convertColStringToIndex("$AA"));
  try {
    CellReference.convertColStringToIndex("A$B$");
    fail("Column reference is invalid and shouldn't be accepted");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestPackage </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can open a file by path, and then
 * write changes to it.
 */
@Test public void openFileThenOverwrite() throws IOException, InvalidFormatException {
  File tempFile=TempFile.createTempFile("poiTesting","tmp");
  File origFile=OpenXML4JTestDataSamples.getSampleFile("TestPackageCommon.docx");
  FileHelper.copyFile(origFile,tempFile);
  OPCPackage p=OPCPackage.open(tempFile.toString(),PackageAccess.READ_WRITE);
  p.close();
  assertTrue(tempFile.delete());
  FileHelper.copyFile(origFile,tempFile);
  p=OPCPackage.open(tempFile.toString(),PackageAccess.READ_WRITE);
  try {
    p.save(tempFile);
    fail("You shouldn't be able to call save(File) to overwrite the current file");
  }
 catch (  InvalidOperationException e) {
  }
  p.close();
  assertTrue(tempFile.delete());
  FileHelper.copyFile(origFile,tempFile);
  p=OPCPackage.open(tempFile.toString(),PackageAccess.READ);
  p.close();
  assertTrue(tempFile.delete());
}

</code></pre>

<br>
<pre class="type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test package opening.
 */
@Test public void openPackage() throws IOException, InvalidFormatException {
  File targetFile=OpenXML4JTestDataSamples.getOutputFile("TestOpenPackageTMP.docx");
  File inputFile=OpenXML4JTestDataSamples.getSampleFile("TestOpenPackageINPUT.docx");
  File expectedFile=OpenXML4JTestDataSamples.getSampleFile("TestOpenPackageOUTPUT.docx");
  FileHelper.copyFile(inputFile,targetFile);
  OPCPackage pkg=OPCPackage.open(targetFile.getAbsolutePath());
  PackagePartName corePartName=PackagingURIHelper.createPartName("/word/document.xml");
  PackagePart corePart=pkg.getPart(corePartName);
  for (  PackageRelationship rel : corePart.getRelationships()) {
    corePart.removeRelationship(rel.getId());
    pkg.removePart(PackagingURIHelper.createPartName(PackagingURIHelper.resolvePartUri(corePart.getPartName().getURI(),rel.getTargetURI())));
  }
  Document doc=DocumentHelper.createDocument();
  Element elDocument=doc.createElementNS("http://schemas.openxmlformats.org/wordprocessingml/2006/main","w:document");
  doc.appendChild(elDocument);
  Element elBody=doc.createElementNS("http://schemas.openxmlformats.org/wordprocessingml/2006/main","w:body");
  elDocument.appendChild(elBody);
  Element elParagraph=doc.createElementNS("http://schemas.openxmlformats.org/wordprocessingml/2006/main","w:p");
  elBody.appendChild(elParagraph);
  Element elRun=doc.createElementNS("http://schemas.openxmlformats.org/wordprocessingml/2006/main","w:r");
  elParagraph.appendChild(elRun);
  Element elText=doc.createElementNS("http://schemas.openxmlformats.org/wordprocessingml/2006/main","w:t");
  elRun.appendChild(elText);
  elText.setTextContent("Hello Open XML !");
  StreamHelper.saveXmlInStream(doc,corePart.getOutputStream());
  try {
    pkg.close();
  }
 catch (  IOException e) {
    fail();
  }
  ZipFileAssert.assertEquals(expectedFile,targetFile);
  assertTrue(targetFile.delete());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestZipPackage </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZipEntityExpansionExceedsMemory() throws Exception {
  try {
    Workbook wb=WorkbookFactory.create(XSSFTestDataSamples.openSamplePackage("poc-xmlbomb.xlsx"));
    wb.close();
    fail("Should catch exception due to entity expansion limitations");
  }
 catch (  POIXMLException e) {
    assertEntityLimitReached(e);
  }
  try {
    POITextExtractor extractor=ExtractorFactory.createExtractor(HSSFTestDataSamples.getSampleFile("poc-xmlbomb.xlsx"));
    try {
      assertNotNull(extractor);
      try {
        extractor.getText();
      }
 catch (      IllegalStateException e) {
      }
    }
  finally {
      extractor.close();
    }
  }
 catch (  POIXMLException e) {
    assertEntityLimitReached(e);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testZipEntityExpansionTerminates() throws IOException {
  try {
    Workbook wb=XSSFTestDataSamples.openSampleWorkbook("poc-xmlbomb.xlsx");
    wb.close();
    fail("Should catch exception due to entity expansion limitations");
  }
 catch (  POIXMLException e) {
    assertEntityLimitReached(e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestCipherAlgorithm </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  assertEquals(128,CipherAlgorithm.aes128.defaultKeySize);
  for (  CipherAlgorithm alg : CipherAlgorithm.values()) {
    assertEquals(alg,CipherAlgorithm.valueOf(alg.toString()));
  }
  assertEquals(CipherAlgorithm.aes128,CipherAlgorithm.fromEcmaId(0x660E));
  assertEquals(CipherAlgorithm.aes192,CipherAlgorithm.fromXmlId("AES",192));
  try {
    CipherAlgorithm.fromEcmaId(0);
    fail("Should throw exception");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    CipherAlgorithm.fromXmlId("AES",1);
    fail("Should throw exception");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    CipherAlgorithm.fromXmlId("RC1",0x40);
    fail("Should throw exception");
  }
 catch (  EncryptedDocumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestNPOIFSFileSystem </h4><pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ask for free blocks where no free ones exist, and so the
 * file needs to be extended and another BAT/XBAT added
 */
@Test public void getFreeBlockWithNoneSpare() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  int free;
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(99));
  assertBATCount(fs,1,0);
  for (int i=100; i < 128; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(i));
  }
  assertEquals(true,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  for (int i=100; i < 128; i++) {
    fs.setNextBlock(i,POIFSConstants.END_OF_CHAIN);
  }
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
    fail("Should only be one BAT");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,1,0);
  assertEquals(129,fs.getFreeBlock());
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(128));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(129));
  assertBATCount(fs,2,0);
  for (int i=0; i < 109; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
  }
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(109 * 128).getBlock().hasFreeSectors());
    fail("Should only be 109 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,109,0);
  HeaderBlock header=writeOutAndReadHeader(fs);
  assertEquals(109,header.getBATCount());
  assertEquals(0,header.getXBATCount());
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(110 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(110 * 128).getBlock().hasFreeSectors());
    fail("Should only be 110 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,110,1);
  header=writeOutAndReadHeader(fs);
  assertEquals(110,header.getBATCount());
  assertEquals(1,header.getXBATCount());
  for (int i=109; i < 109 + 127; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
    assertBATCount(fs,i + 1,1);
  }
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(236 * 128).getBlock().hasFreeSectors());
    fail("Should only be 236 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,236,1);
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,237,2);
  header=writeOutAndReadHeader(fs);
  fs=writeOutAndReadBack(fs);
  assertBATCount(fs,237,2);
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propertiesAndFatOnRead() throws Exception {
  NPOIFSFileSystem fsA, fsB;
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(140);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(98,fs.getNextBlock(97));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(98));
    NPropertyTable props=fs._get_property_table();
    assertEquals(90,props.getStartBlock());
    assertEquals(7,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    try {
      ministore.getBATBlockAndIndex(256);
      fail("Should only be two SBATs, but a 3rd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(1040);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(1,fs.getNextBlock(0));
    assertEquals(2,fs.getNextBlock(1));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
    NPropertyTable props=fs._get_property_table();
    assertEquals(12,props.getStartBlock());
    assertEquals(1,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    ministore.getBATBlockAndIndex(1023);
    try {
      ministore.getBATBlockAndIndex(1024);
      fail("Should only be one SBAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestNPOIFSMiniStore </h4><pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we will extend the underlying chain of 
 * big blocks that make up the ministream as needed
 */
@Test public void testCreateBlockIfNeeded() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSMiniStore ministore=fs.getMiniStore();
  assertEquals(179,ministore.getNextBlock(178));
  assertEquals(180,ministore.getNextBlock(179));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(180));
  for (int i=181; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  for (int i=0; i <= 183; i++) {
    ministore.getBlockAt(i);
  }
  try {
    ministore.getBlockAt(184);
    fail("No block at 184");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  Iterator<ByteBuffer> it=new NPOIFSStream(fs,fs.getRoot().getProperty().getStartBlock()).getBlockIterator();
  int count=0;
  while (it.hasNext()) {
    count++;
    it.next();
  }
  assertEquals(23,count);
  ministore.createBlockIfNeeded(184);
  it=new NPOIFSStream(fs,fs.getRoot().getProperty().getStartBlock()).getBlockIterator();
  count=0;
  while (it.hasNext()) {
    count++;
    it.next();
  }
  assertEquals(24,count);
  for (int i=0; i <= 191; i++) {
    ministore.getBlockAt(i);
  }
  try {
    ministore.getBlockAt(192);
    fail("No block at 192");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  byte[] data=new byte[15 * 64];
  NPOIFSStream stream=new NPOIFSStream(ministore,178);
  stream.updateContents(data);
  assertEquals(179,ministore.getNextBlock(178));
  assertEquals(180,ministore.getNextBlock(179));
  assertEquals(181,ministore.getNextBlock(180));
  assertEquals(182,ministore.getNextBlock(181));
  assertEquals(183,ministore.getNextBlock(182));
  assertEquals(184,ministore.getNextBlock(183));
  assertEquals(185,ministore.getNextBlock(184));
  assertEquals(186,ministore.getNextBlock(185));
  assertEquals(187,ministore.getNextBlock(186));
  assertEquals(188,ministore.getNextBlock(187));
  assertEquals(189,ministore.getNextBlock(188));
  assertEquals(190,ministore.getNextBlock(189));
  assertEquals(191,ministore.getNextBlock(190));
  assertEquals(192,ministore.getNextBlock(191));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(192));
  for (int i=193; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  fs.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ask for free blocks where no free ones exist, and so the
 * stream needs to be extended and another SBAT added
 */
@Test public void testGetFreeBlockWithNoneSpare() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  NPOIFSMiniStore ministore=fs.getMiniStore();
  for (int i=181; i < 256; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(i));
  }
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(true,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  for (int i=181; i < 256; i++) {
    ministore.setNextBlock(i,POIFSConstants.END_OF_CHAIN);
  }
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(false,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  try {
    assertEquals(false,ministore.getBATBlockAndIndex(256).getBlock().hasFreeSectors());
    fail("Should only be two SBATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertEquals(256,ministore.getFreeBlock());
  assertEquals(false,ministore.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(false,ministore.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  assertEquals(true,ministore.getBATBlockAndIndex(256).getBlock().hasFreeSectors());
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(254));
  assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(255));
  assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(256));
  assertEquals(POIFSConstants.UNUSED_BLOCK,ministore.getNextBlock(257));
  fs.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.property.TestDirectoryProperty </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteChild() throws IOException {
  createBasicDirectoryProperty();
  Property p1=new LocalProperty(1);
  _property.addChild(p1);
  try {
    _property.addChild(new LocalProperty(1));
    fail("should have caught IOException");
  }
 catch (  IOException ignored) {
  }
  assertTrue(_property.deleteChild(p1));
  assertTrue(!_property.deleteChild(p1));
  _property.addChild(new LocalProperty(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddChild() throws IOException {
  createBasicDirectoryProperty();
  _property.addChild(new LocalProperty(1));
  _property.addChild(new LocalProperty(2));
  try {
    _property.addChild(new LocalProperty(1));
    fail("should have caught IOException");
  }
 catch (  IOException ignored) {
  }
  try {
    _property.addChild(new LocalProperty(2));
    fail("should have caught IOException");
  }
 catch (  IOException ignored) {
  }
  _property.addChild(new LocalProperty(3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.storage.TestBlockListImpl </h4><pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove() throws IOException {
  BlockListImpl list=create();
  RawDataBlock[] blocks=new RawDataBlock[5];
  byte[] data=new byte[512 * 5];
  for (int j=0; j < 5; j++) {
    Arrays.fill(data,j * 512,(j * 512) + 512,(byte)j);
  }
  ByteArrayInputStream stream=new ByteArrayInputStream(data);
  for (int j=0; j < 5; j++) {
    blocks[j]=new RawDataBlock(stream);
  }
  list.setBlocks(blocks);
  for (int j=-2; j < 10; j++) {
    if ((j < 0) || (j >= 5)) {
      try {
        list.remove(j);
        fail("removing item " + j + " should have failed");
      }
 catch (      IOException ignored) {
      }
    }
  }
  for (int j=0; j < 5; j++) {
    byte[] output=list.remove(j).getData();
    for (int k=0; k < 512; k++) {
      assertEquals("testing block " + j + ", index "+ k,data[(j * 512) + k],output[k]);
    }
  }
  for (int j=0; j < 5; j++) {
    try {
      list.remove(j);
      fail("removing item " + j + " should not have succeeded");
    }
 catch (    IOException ignored) {
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchBlocks() throws IOException {
  BlockListImpl list=create();
  List<RawDataBlock> raw_blocks=new ArrayList<RawDataBlock>();
  byte[] data=new byte[512];
  int offset=0;
  LittleEndian.putInt(data,offset,-3);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,6);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,8);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,0);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,10);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1000);
  offset+=LittleEndianConsts.INT_SIZE;
  int index=13;
  for (; offset < 508; offset+=LittleEndianConsts.INT_SIZE) {
    LittleEndian.putInt(data,offset,index++);
  }
  LittleEndian.putInt(data,offset,-2);
  raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(data)));
  for (int j=raw_blocks.size(); j < 128; j++) {
    raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(new byte[0])));
  }
  list.setBlocks(raw_blocks.toArray(new RawDataBlock[raw_blocks.size()]));
  int[] blocks={0};
  BlockAllocationTableReader table=new BlockAllocationTableReader(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,1,blocks,0,-2,list);
  int[] start_blocks={-2,1,2,3,5,7,9,11,12};
  int[] expected_length={0,1,-1,-1,-1,-1,-1,-1,116};
  for (int j=0; j < start_blocks.length; j++) {
    try {
      ListManagedBlock[] dataBlocks=list.fetchBlocks(start_blocks[j],-1);
      if (expected_length[j] == -1) {
        fail("document " + j + " should have failed");
      }
 else {
        assertEquals(expected_length[j],dataBlocks.length);
      }
    }
 catch (    IOException e) {
      if (expected_length[j] == -1) {
      }
 else {
        throw e;
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetBAT() throws IOException {
  BlockListImpl list=create();
  list.setBAT(null);
  list.setBAT(new BlockAllocationTableReader(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS));
  try {
    list.setBAT(new BlockAllocationTableReader(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS));
    fail("second attempt should have failed");
  }
 catch (  IOException ignored) {
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testZap() throws IOException {
  BlockListImpl list=create();
  for (int j=-2; j < 10; j++) {
    list.zap(j);
  }
  RawDataBlock[] blocks=new RawDataBlock[5];
  for (int j=0; j < 5; j++) {
    blocks[j]=new RawDataBlock(new ByteArrayInputStream(new byte[512]));
  }
  list.setBlocks(blocks);
  for (int j=-2; j < 10; j++) {
    list.zap(j);
  }
  for (int j=0; j < 5; j++) {
    try {
      list.remove(j);
      fail("removing item " + j + " should not have succeeded");
    }
 catch (    IOException ignored) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.TestWorkbookFactory </h4><pre class="type-2 type-10 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the overloaded stream methods which take passwords work properly
 */
@Test public void testCreateWithPasswordFromStream() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls),null);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx),null);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls_prot[0]),xls_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls_prot[0],wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx_prot[0]),xlsx_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xls_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Check that a helpful exception is given on an empty file
 */
@Test public void testEmptyFile() throws Exception {
  File emptyFile=TempFile.createTempFile("empty",".poi");
  try {
    WorkbookFactory.create(emptyFile);
    fail("Shouldn't be able to create for an empty file");
  }
 catch (  final EmptyFileException expected) {
  }
  emptyFile.delete();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Check that a helpful exception is given on an empty input stream
 */
@Test public void testEmptyInputStream() throws Exception {
  InputStream emptyStream=new ByteArrayInputStream(new byte[0]);
  try {
    WorkbookFactory.create(emptyStream);
    fail("Shouldn't be able to create for an empty stream");
  }
 catch (  final EmptyFileException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the overloaded file methods which take passwords work properly
 */
@Test public void testCreateWithPasswordFromFile() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls),null);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx),null);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls_prot[0]),xls_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls_prot[0],wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx_prot[0]),xlsx_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xls_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creates the appropriate kind of Workbook, but
 * checking the mime magic at the start of the
 * InputStream, then creating what's required.
 */
@Test public void testCreateGeneric() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls));
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx));
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls));
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx));
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  final byte[] before=HSSFTestDataSamples.getTestDataFileContent(txt);
  try {
    InputStream stream=HSSFTestDataSamples.openSampleFileStream(txt);
    try {
      wb=WorkbookFactory.create(stream);
    }
  finally {
      stream.close();
    }
    fail();
  }
 catch (  InvalidFormatException e) {
  }
  final byte[] after=HSSFTestDataSamples.getTestDataFileContent(txt);
  assertArrayEquals("Invalid type file was modified after trying to open the file as a spreadsheet",before,after);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.TestWorkbookEvaluator </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test makes sure that any {@link MissingArgEval} that propagates to
 * the result of a function gets translated to {@link BlankEval}.
 */
@Test public void testMissingArg(){
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cell=row.createCell(0);
  cell.setCellFormula("1+IF(1,,)");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  CellValue cv=null;
  try {
    cv=fe.evaluate(cell);
  }
 catch (  RuntimeException e) {
    fail("Missing arg result not being handled correctly.");
  }
  assertEquals(HSSFCell.CELL_TYPE_NUMERIC,cv.getCellType());
  assertEquals(1.0,cv.getNumberValue(),0.0);
  cell.setCellFormula("\"abc\"&IF(1,,)");
  fe.notifySetFormula(cell);
  cv=fe.evaluate(cell);
  assertEquals(HSSFCell.CELL_TYPE_STRING,cv.getCellType());
  assertEquals("abc",cv.getStringValue());
  cell.setCellFormula("\"abc\"&CHOOSE(2,5,,9)");
  fe.notifySetFormula(cell);
  cv=fe.evaluate(cell);
  assertEquals(HSSFCell.CELL_TYPE_STRING,cv.getCellType());
  assertEquals("abc",cv.getStringValue());
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Functions like IF, INDIRECT, INDEX, OFFSET etc can return AreaEvals which
 * should be dereferenced by the evaluator
 * @throws IOException 
 */
@Test public void testResultOutsideRange() throws IOException {
  Workbook wb=new HSSFWorkbook();
  try {
    Cell cell=wb.createSheet("Sheet1").createRow(0).createCell(0);
    cell.setCellFormula("D2:D5");
    FormulaEvaluator fe=wb.getCreationHelper().createFormulaEvaluator();
    CellValue cv;
    try {
      cv=fe.evaluate(cell);
    }
 catch (    IllegalArgumentException e) {
      if ("Specified row index (0) is outside the allowed range (1..4)".equals(e.getMessage())) {
        fail("Identified bug in result dereferencing");
      }
      throw new RuntimeException(e);
    }
    assertEquals(Cell.CELL_TYPE_ERROR,cv.getCellType());
    assertEquals(ErrorEval.VALUE_INVALID.getErrorCode(),cv.getErrorValue());
    fe.clearAllCachedResultValues();
    cell.setCellFormula("OFFSET(A1,0,0)");
    cv=fe.evaluate(cell);
    assertEquals(Cell.CELL_TYPE_ERROR,cv.getCellType());
    assertEquals(ErrorEval.CIRCULAR_REF_ERROR.getErrorCode(),cv.getErrorValue());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.atp.TestDateParser </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailWhenIsInvalidDate(){
  try {
    DateParser.parseDate("13/13/13");
    fail("Shouldn't parse this thing!");
  }
 catch (  EvaluationException e) {
    assertEquals(ErrorEval.VALUE_INVALID,e.getErrorEval());
  }
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailWhenNoDate(){
  try {
    DateParser.parseDate("potato");
    fail("Shouldn't parse potato!");
  }
 catch (  EvaluationException e) {
    assertEquals(ErrorEval.VALUE_INVALID,e.getErrorEval());
  }
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailWhenLooksLikeDateButItIsnt(){
  try {
    DateParser.parseDate("potato/cucumber/banana");
    fail("Shouldn't parse this thing!");
  }
 catch (  EvaluationException e) {
    assertEquals(ErrorEval.VALUE_INVALID,e.getErrorEval());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.TestFormulaBugs </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 42448 - Can't parse SUMPRODUCT(A!C7:A!C67, B8:B68) / B69 <p/>
 * @throws IOException 
 */
@Test public void test42448() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet1=wb.createSheet("Sheet1");
  HSSFRow row=sheet1.createRow(0);
  HSSFCell cell=row.createCell(0);
  HSSFSheet sheet2=wb.createSheet("A");
  String inputFormula="SUMPRODUCT(A!C7:A!C67, B8:B68) / B69";
  try {
    cell.setCellFormula(inputFormula);
  }
 catch (  StringIndexOutOfBoundsException e) {
    fail("Identified bug 42448");
  }
  assertEquals("SUMPRODUCT(A!C7:A!C67,B8:B68)/B69",cell.getCellFormula());
  addCell(sheet2,5,2,3.0);
  addCell(sheet2,6,2,4.0);
  addCell(sheet2,66,2,5.0);
  addCell(sheet2,67,2,6.0);
  addCell(sheet1,6,1,7.0);
  addCell(sheet1,7,1,8.0);
  addCell(sheet1,67,1,9.0);
  addCell(sheet1,68,1,10.0);
  double expectedResult=(4.0 * 8.0 + 5.0 * 9.0) / 10.0;
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  CellValue cv=fe.evaluate(cell);
  assertEquals(HSSFCell.CELL_TYPE_NUMERIC,cv.getCellType());
  assertEquals(expectedResult,cv.getNumberValue(),0.0);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.TestFormulasFromSpreadsheet </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (int colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    if (c == null || c.getCellType() != Cell.CELL_TYPE_FORMULA) {
      continue;
    }
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
assertEquals(msg,ErrorEval.getText(expValue.getErrorCellValue()),ErrorEval.getText(actValue.getErrorValue()));
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.function.TestReadMissingBuiltInFuncs </h4><pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDBCS(){
  String formula="";
  try {
    formula=getCellFormula(4);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("too much stuff")) {
      fail("DBCS() not registered");
    }
    throw e;
  }
catch (  NegativeArraySizeException e) {
    fail("found err- DBCS() registered with -1 args");
  }
  if ("JIS(\"abc\")".equals(formula)) {
    fail("func ix 215 registered as JIS() instead of DBCS()");
  }
  assertEquals("DBCS(\"abc\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsnontext(){
  String formula;
  try {
    formula=getCellFormula(5);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("too much stuff")) {
      fail("ISNONTEXT() registered with wrong index");
    }
    throw e;
  }
  assertEquals("ISNONTEXT(\"abc\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDdb(){
  String formula=getCellFormula(1);
  if ("externalflag(1,1,1,1,1)".equals(formula)) {
    fail("DDB() not registered");
  }
  assertEquals("DDB(1,1,1,1,1)",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAtan(){
  String formula=getCellFormula(2);
  if ("ARCTAN(1)".equals(formula)) {
    fail("func ix 18 registered as ARCTAN() instead of ATAN()");
  }
  assertEquals("ATAN(1)",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatedif(){
  String formula;
  try {
    formula=getCellFormula(0);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("Too few arguments")) {
      if (e.getMessage().indexOf("AttrPtg") > 0) {
        fail("tAttrVolatile not supported in FormulaParser.toFormulaString");
      }
      fail("NOW() registered with 1 arg instead of 0");
    }
    if (e.getMessage().startsWith("too much stuff")) {
      fail("DATEDIF() not registered");
    }
    throw e;
  }
  assertEquals("DATEDIF(NOW(),NOW(),\"d\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsdollar(){
  String formula=getCellFormula(3);
  if ("YEN(1)".equals(formula)) {
    fail("func ix 204 registered as YEN() instead of USDOLLAR()");
  }
  assertEquals("USDOLLAR(1)",formula);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.BaseTestFunctionsFromSpreadsheet </h4><pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow() throws Exception {
  HSSFRow r=sheet.getRow(formulasRowIdx);
  HSSFCell evalCell=r.getCell(SS.COLUMN_INDEX_EVALUATION);
  HSSFCell expectedCell=r.getCell(SS.COLUMN_INDEX_EXPECTED_RESULT);
  CellReference cr=new CellReference(sheet.getSheetName(),formulasRowIdx,evalCell.getColumnIndex(),false,false);
  String msg=String.format(Locale.ROOT,"In %s %s {=%s} '%s'",filename,cr.formatAsString(),evalCell.getCellFormula(),testName);
  CellValue actualValue=evaluator.evaluate(evalCell);
  assertNotNull(msg + " - Bad setup data expected value is null",expectedCell);
  assertNotNull(msg + " - actual value was null",actualValue);
  if (expectedCell.getCellType() == HSSFCell.CELL_TYPE_ERROR) {
    int expectedErrorCode=expectedCell.getErrorCellValue();
    assertEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),actualValue.formatAsString());
    assertEquals(msg,expectedErrorCode,actualValue.getErrorValue());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),ErrorEval.getText(actualValue.getErrorValue()));
    return;
  }
  assertNotEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
  assertNotEquals(msg,formatValue(expectedCell),ErrorEval.getText(actualValue.getErrorValue()));
  assertEquals(msg,expectedCell.getCellType(),actualValue.getCellType());
switch (expectedCell.getCellType()) {
case HSSFCell.CELL_TYPE_BOOLEAN:
    assertEquals(msg,expectedCell.getBooleanCellValue(),actualValue.getBooleanValue());
  break;
case HSSFCell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case HSSFCell.CELL_TYPE_NUMERIC:
assertEquals(expectedCell.getNumericCellValue(),actualValue.getNumberValue(),0.0);
break;
case HSSFCell.CELL_TYPE_STRING:
assertEquals(msg,expectedCell.getRichStringCellValue().getString(),actualValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestBugzillaIssues </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensures that XSSF and HSSF agree with each other,
 * and with the docs on when fetching the wrong
 * kind of value from a Formula cell
 */
@Test public void bug47815() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet s=wb.createSheet();
  Row r=s.createRow(0);
  Cell cn=r.createCell(0,Cell.CELL_TYPE_NUMERIC);
  cn.setCellValue(1.2);
  Cell cs=r.createCell(1,Cell.CELL_TYPE_STRING);
  cs.setCellValue("Testing");
  Cell cfn=r.createCell(2,Cell.CELL_TYPE_FORMULA);
  cfn.setCellFormula("A1");
  Cell cfs=r.createCell(3,Cell.CELL_TYPE_FORMULA);
  cfs.setCellFormula("B1");
  FormulaEvaluator fe=wb.getCreationHelper().createFormulaEvaluator();
  assertEquals(Cell.CELL_TYPE_NUMERIC,fe.evaluate(cfn).getCellType());
  assertEquals(Cell.CELL_TYPE_STRING,fe.evaluate(cfs).getCellType());
  fe.evaluateFormulaCell(cfn);
  fe.evaluateFormulaCell(cfs);
  assertEquals(Cell.CELL_TYPE_NUMERIC,cn.getCellType());
  assertEquals(Cell.CELL_TYPE_STRING,cs.getCellType());
  assertEquals(Cell.CELL_TYPE_FORMULA,cfn.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cfn.getCachedFormulaResultType());
  assertEquals(Cell.CELL_TYPE_FORMULA,cfs.getCellType());
  assertEquals(Cell.CELL_TYPE_STRING,cfs.getCachedFormulaResultType());
  assertEquals(1.2,cn.getNumericCellValue(),0);
  try {
    cn.getRichStringCellValue();
    fail();
  }
 catch (  IllegalStateException e) {
  }
  assertEquals("Testing",cs.getStringCellValue());
  try {
    cs.getNumericCellValue();
    fail();
  }
 catch (  IllegalStateException e) {
  }
  assertEquals(1.2,cfn.getNumericCellValue(),0);
  try {
    cfn.getRichStringCellValue();
    fail();
  }
 catch (  IllegalStateException e) {
  }
  assertEquals("Testing",cfs.getStringCellValue());
  try {
    cfs.getNumericCellValue();
    fail();
  }
 catch (  IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug46729_testMaxFunctionArguments() throws IOException {
  String[] func={"COUNT","AVERAGE","MAX","MIN","OR","SUBTOTAL","SKEW"};
  SpreadsheetVersion ssVersion=_testDataProvider.getSpreadsheetVersion();
  Workbook wb=_testDataProvider.createWorkbook();
  Cell cell=wb.createSheet().createRow(0).createCell(0);
  String fmla;
  for (  String name : func) {
    fmla=createFunction(name,5);
    cell.setCellFormula(fmla);
    fmla=createFunction(name,ssVersion.getMaxFunctionArgs());
    cell.setCellFormula(fmla);
    try {
      fmla=createFunction(name,ssVersion.getMaxFunctionArgs() + 1);
      cell.setCellFormula(fmla);
      fail("Expected FormulaParseException");
    }
 catch (    RuntimeException e) {
      assertTrue(e.getMessage().startsWith("Too many arguments to function '" + name + "'"));
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Should be able to write then read formulas with references
 * to cells in other files, eg '[refs/airport.xls]Sheet1'!$A$2
 * or 'http://192.168.1.2/[blank.xls]Sheet1'!$A$1 .
 * Additionally, if a reference to that file is provided, it should
 * be possible to evaluate them too
 * TODO Fix this to evaluate for XSSF
 * TODO Fix this to work at all for HSSF
 */
@Ignore("Fix this to evaluate for XSSF, Fix this to work at all for HSSF") @Test public void bug46670() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet s=wb1.createSheet();
  Row r1=s.createRow(0);
  String ext=_testDataProvider.getStandardFileNameExtension();
  String refLocal="'[test." + ext + "]Sheet1'!$A$2";
  String refHttp="'[http://example.com/test." + ext + "]Sheet1'!$A$2";
  String otherCellText="In Another Workbook";
  Cell c1=r1.createCell(0,Cell.CELL_TYPE_FORMULA);
  c1.setCellFormula(refLocal);
  Cell c2=r1.createCell(1,Cell.CELL_TYPE_FORMULA);
  c2.setCellFormula(refHttp);
  assertEquals(refLocal,c1.getCellFormula());
  assertEquals(refHttp,c2.getCellFormula());
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  r1=s.getRow(0);
  c1=r1.getCell(0);
  c2=r1.getCell(1);
  assertEquals(refLocal,c1.getCellFormula());
  assertEquals(refHttp,c2.getCellFormula());
  try {
    evaluateCell(wb2,c1);
    fail("Shouldn't be able to evaluate without the other file");
  }
 catch (  Exception e) {
  }
  try {
    evaluateCell(wb2,c2);
    fail("Shouldn't be able to evaluate without the other file");
  }
 catch (  Exception e) {
  }
  Workbook wb3=_testDataProvider.createWorkbook();
  wb3.createSheet().createRow(1).createCell(0).setCellValue(otherCellText);
  Map<String,FormulaEvaluator> evaluators=new HashMap<String,FormulaEvaluator>();
  evaluators.put(refLocal,wb3.getCreationHelper().createFormulaEvaluator());
  evaluators.put(refHttp,wb3.getCreationHelper().createFormulaEvaluator());
  FormulaEvaluator evaluator=wb2.getCreationHelper().createFormulaEvaluator();
  evaluator.setupReferencedWorkbooks(evaluators);
  evaluator.evaluateFormulaCell(c1);
  evaluator.evaluateFormulaCell(c2);
  assertEquals(otherCellText,c1.getStringCellValue());
  assertEquals(otherCellText,c2.getStringCellValue());
  wb3.close();
  wb2.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug58260() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  int maxStyles=(wb instanceof HSSFWorkbook) ? 4009 : 64000;
  for (int i=0; i < maxStyles; i++) {
    CellStyle style=null;
    try {
      style=wb.createCellStyle();
    }
 catch (    IllegalStateException e) {
      fail("Failed for row " + i);
    }
    style.setAlignment(CellStyle.ALIGN_RIGHT);
    if ((wb instanceof HSSFWorkbook)) {
      assertEquals(i + 21,style.getIndex());
    }
 else {
      assertEquals(i + 1,style.getIndex() & 0xffff);
    }
  }
  try {
    wb.createCellStyle();
    fail("Should fail after " + maxStyles + " styles, but did not fail");
  }
 catch (  IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestCell </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The maximum length of cell contents (text) is 32,767 characters.
 * @throws IOException 
 */
@Test public void testMaxTextLength() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  Cell cell=sheet.createRow(0).createCell(0);
  int maxlen=wb instanceof HSSFWorkbook ? SpreadsheetVersion.EXCEL97.getMaxTextLength() : SpreadsheetVersion.EXCEL2007.getMaxTextLength();
  assertEquals(32767,maxlen);
  StringBuffer b=new StringBuffer();
  for (int i=0; i < maxlen; i++) {
    b.append("X");
  }
  cell.setCellValue(b.toString());
  b.append("X");
  try {
    cell.setCellValue(b.toString());
    fail("Expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum length of cell contents (text) is 32,767 characters",e.getMessage());
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestConditionalFormatting </h4><pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sh=wb.createSheet();
  SheetConditionalFormatting sheetCF=sh.getSheetConditionalFormatting();
  assertEquals(0,sheetCF.getNumConditionalFormattings());
  try {
    assertNull(sheetCF.getConditionalFormattingAt(0));
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("Specified CF index 0 is outside the allowable range"));
  }
  try {
    sheetCF.removeConditionalFormatting(0);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("Specified CF index 0 is outside the allowable range"));
  }
  ConditionalFormattingRule rule1=sheetCF.createConditionalFormattingRule("1");
  ConditionalFormattingRule rule2=sheetCF.createConditionalFormattingRule("2");
  ConditionalFormattingRule rule3=sheetCF.createConditionalFormattingRule("3");
  ConditionalFormattingRule rule4=sheetCF.createConditionalFormattingRule("4");
  try {
    sheetCF.addConditionalFormatting(null,rule1);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("regions must not be null"));
  }
  try {
    sheetCF.addConditionalFormatting(new CellRangeAddress[]{CellRangeAddress.valueOf("A1:A3")},(ConditionalFormattingRule)null);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("cfRules must not be null"));
  }
  try {
    sheetCF.addConditionalFormatting(new CellRangeAddress[]{CellRangeAddress.valueOf("A1:A3")},new ConditionalFormattingRule[0]);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("cfRules must not be empty"));
  }
  try {
    sheetCF.addConditionalFormatting(new CellRangeAddress[]{CellRangeAddress.valueOf("A1:A3")},new ConditionalFormattingRule[]{rule1,rule2,rule3,rule4});
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("Number of rules must not exceed 3"));
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClone() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  String formula="7";
  SheetConditionalFormatting sheetCF=sheet.getSheetConditionalFormatting();
  ConditionalFormattingRule rule1=sheetCF.createConditionalFormattingRule(formula);
  FontFormatting fontFmt=rule1.createFontFormatting();
  fontFmt.setFontStyle(true,false);
  PatternFormatting patternFmt=rule1.createPatternFormatting();
  patternFmt.setFillBackgroundColor(IndexedColors.YELLOW.index);
  ConditionalFormattingRule rule2=sheetCF.createConditionalFormattingRule(ComparisonOperator.BETWEEN,"1","2");
  ConditionalFormattingRule[] cfRules={rule1,rule2};
  short col=1;
  CellRangeAddress[] regions={new CellRangeAddress(0,65535,col,col)};
  sheetCF.addConditionalFormatting(regions,cfRules);
  try {
    wb.cloneSheet(0);
    assertEquals(2,wb.getNumberOfSheets());
  }
 catch (  RuntimeException e) {
    if (e.getMessage().indexOf("needs to define a clone method") > 0) {
      fail("Indentified bug 45682");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet1=wb.createSheet();
  SheetConditionalFormatting sheetCF=sheet1.getSheetConditionalFormatting();
  assertEquals(0,sheetCF.getNumConditionalFormattings());
  ConditionalFormattingRule rule1=sheetCF.createConditionalFormattingRule(ComparisonOperator.EQUAL,"SUM(A1:A5)");
  int formatIndex=sheetCF.addConditionalFormatting(new CellRangeAddress[]{CellRangeAddress.valueOf("A1:A5")},rule1);
  assertEquals(0,formatIndex);
  assertEquals(1,sheetCF.getNumConditionalFormattings());
  sheetCF.removeConditionalFormatting(0);
  assertEquals(0,sheetCF.getNumConditionalFormattings());
  try {
    assertNull(sheetCF.getConditionalFormattingAt(0));
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("Specified CF index 0 is outside the allowable range"));
  }
  formatIndex=sheetCF.addConditionalFormatting(new CellRangeAddress[]{CellRangeAddress.valueOf("A1:A5")},rule1);
  assertEquals(0,formatIndex);
  assertEquals(1,sheetCF.getNumConditionalFormattings());
  sheetCF.removeConditionalFormatting(0);
  assertEquals(0,sheetCF.getNumConditionalFormattings());
  try {
    assertNull(sheetCF.getConditionalFormattingAt(0));
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().startsWith("Specified CF index 0 is outside the allowable range"));
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestFormulaEvaluator </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for bug due to attempt to convert a cached formula error result to a boolean
 */
@Test public void testUpdateCachedFormulaResultFromErrorToNumber_bug46479() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet("Sheet1");
  Row row=sheet.createRow(0);
  Cell cellA1=row.createCell(0);
  Cell cellB1=row.createCell(1);
  cellB1.setCellFormula("A1+1");
  FormulaEvaluator fe=wb.getCreationHelper().createFormulaEvaluator();
  cellA1.setCellErrorValue((byte)ErrorConstants.ERROR_NAME);
  fe.evaluateFormulaCell(cellB1);
  cellA1.setCellValue(2.5);
  fe.notifyUpdateCell(cellA1);
  try {
    fe.evaluateInCell(cellB1);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot get a numeric value from a error formula cell")) {
      fail("Identified bug 46479a");
    }
  }
  assertEquals(3.5,cellB1.getNumericCellValue(),0.0);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestNamedRange </h4><pre class="type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testDefferedSetting() throws Exception {
  Workbook wb=_testDataProvider.createWorkbook();
  Name n1=wb.createName();
  assertNull(n1.getRefersToFormula());
  assertEquals("",n1.getNameName());
  Name n2=wb.createName();
  assertNull(n2.getRefersToFormula());
  assertEquals("",n2.getNameName());
  n1.setNameName("sale_1");
  n1.setRefersToFormula("10");
  n2.setNameName("sale_2");
  n2.setRefersToFormula("20");
  try {
    n2.setNameName("sale_1");
    fail("Expected exception");
  }
 catch (  Exception e) {
    assertEquals("The workbook already contains this name: sale_1",e.getMessage());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testCreate() throws Exception {
  Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet("Test1");
  wb.createSheet("Testing Named Ranges");
  Name name1=wb.createName();
  name1.setNameName("testOne");
  Name name2=wb.createName();
  try {
    name2.setNameName("testOne");
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains this name: testOne",e.getMessage());
  }
  try {
    name2.setNameName("TESTone");
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains this name: TESTone",e.getMessage());
  }
  name2.setNameName("testTwo");
  String ref1="Test1!$A$1:$B$1";
  name1.setRefersToFormula(ref1);
  assertEquals(ref1,name1.getRefersToFormula());
  assertEquals("Test1",name1.getSheetName());
  String ref2="'Testing Named Ranges'!$A$1:$B$1";
  name1.setRefersToFormula(ref2);
  assertEquals("'Testing Named Ranges'!$A$1:$B$1",name1.getRefersToFormula());
  assertEquals("Testing Named Ranges",name1.getSheetName());
  assertEquals(-1,name1.getSheetIndex());
  name1.setSheetIndex(-1);
  assertEquals(-1,name1.getSheetIndex());
  try {
    name1.setSheetIndex(2);
    fail("should throw IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Sheet index (2) is out of range (0..1)",e.getMessage());
  }
  name1.setSheetIndex(1);
  assertEquals(1,name1.getSheetIndex());
  name1.setSheetIndex(-1);
  assertEquals(-1,name1.getSheetIndex());
  String[] invalidNames={"","123","1Name","Named Range"};
  for (  String name : invalidNames) {
    try {
      name1.setNameName(name);
      fail("should have thrown exceptiuon due to invalid name: " + name);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testScope() throws Exception {
  Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet();
  wb.createSheet();
  Name name;
  name=wb.createName();
  name.setNameName("aaa");
  name=wb.createName();
  try {
    name.setNameName("aaa");
    fail("Expected exception");
  }
 catch (  Exception e) {
    assertEquals("The workbook already contains this name: aaa",e.getMessage());
  }
  name=wb.createName();
  name.setSheetIndex(0);
  name.setNameName("aaa");
  name=wb.createName();
  name.setSheetIndex(0);
  try {
    name.setNameName("aaa");
    fail("Expected exception");
  }
 catch (  Exception e) {
    assertEquals("The sheet already contains this name: aaa",e.getMessage());
  }
  name=wb.createName();
  name.setSheetIndex(1);
  name.setNameName("aaa");
  name=wb.createName();
  name.setSheetIndex(1);
  try {
    name.setNameName("aaa");
    fail("Expected exception");
  }
 catch (  Exception e) {
    assertEquals("The sheet already contains this name: aaa",e.getMessage());
  }
  int cnt=0;
  for (int i=0; i < wb.getNumberOfNames(); i++) {
    if ("aaa".equals(wb.getNameAt(i).getNameName()))     cnt++;
  }
  assertEquals(3,cnt);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheet </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the setAsActiveCell and getActiveCell function pairs work together
 */
@Test public void setActiveCell() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet();
  CellAddress B42=new CellAddress("B42");
  if (sheet.getActiveCell() != null && !sheet.getActiveCell().equals(CellAddress.A1)) {
    fail("If not set, active cell should default to null or A1");
  }
  sheet.setActiveCell(B42);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  assertEquals(B42,sheet.getActiveCell());
  wb1.close();
  wb2.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void columnWidth() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet();
  sheet.setDefaultColumnWidth(10);
  assertEquals(10,sheet.getDefaultColumnWidth());
  assertEquals(256 * 10,sheet.getColumnWidth(0));
  assertEquals(256 * 10,sheet.getColumnWidth(1));
  assertEquals(256 * 10,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    sheet.setColumnWidth(i,w);
    assertEquals(w,sheet.getColumnWidth(i));
  }
  sheet.setDefaultColumnWidth(20);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth(0));
  assertEquals(256 * 20,sheet.getColumnWidth(1));
  assertEquals(256 * 20,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    assertEquals(w,sheet.getColumnWidth(i));
  }
  sheet.setColumnWidth(10,40000);
  assertEquals(40000,sheet.getColumnWidth(10));
  try {
    sheet.setColumnWidth(9,256 * 256);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum column width for an individual cell is 255 characters.",e.getMessage());
  }
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth(0));
  assertEquals(256 * 20,sheet.getColumnWidth(1));
  assertEquals(256 * 20,sheet.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sheet.getColumnWidth(i));
  }
  assertEquals(40000,sheet.getColumnWidth(10));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cloneSheet() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  CreationHelper factory=workbook.getCreationHelper();
  Sheet sheet=workbook.createSheet("Test Clone");
  Row row=sheet.createRow(0);
  Cell cell=row.createCell(0);
  Cell cell2=row.createCell(1);
  cell.setCellValue(factory.createRichTextString("clone_test"));
  cell2.setCellFormula("SIN(1)");
  Sheet clonedSheet=workbook.cloneSheet(0);
  Row clonedRow=clonedSheet.getRow(0);
  assertEquals(clonedRow.getCell(0).getRichStringCellValue().getString(),"clone_test");
  cell.setCellValue(factory.createRichTextString("Difference Check"));
  cell2.setCellFormula("cos(2)");
  if ("Difference Check".equals(clonedRow.getCell(0).getRichStringCellValue().getString())) {
    fail("string cell not properly cloned");
  }
  if ("COS(2)".equals(clonedRow.getCell(1).getCellFormula())) {
    fail("formula cell not properly cloned");
  }
  assertEquals(clonedRow.getCell(0).getRichStringCellValue().getString(),"clone_test");
  assertEquals(clonedRow.getCell(1).getCellFormula(),"SIN(1)");
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test adding merged regions. If the region's bounds are outside of the allowed range
 * then an IllegalArgumentException should be thrown
 */
@Test public void addMerged() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  assertEquals(0,sheet.getNumMergedRegions());
  SpreadsheetVersion ssVersion=_testDataProvider.getSpreadsheetVersion();
  CellRangeAddress region=new CellRangeAddress(0,1,0,1);
  sheet.addMergedRegion(region);
  assertEquals(1,sheet.getNumMergedRegions());
  try {
    region=new CellRangeAddress(-1,-1,-1,-1);
    sheet.addMergedRegion(region);
    fail("Expected exception");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    region=new CellRangeAddress(0,0,0,ssVersion.getLastColumnIndex() + 1);
    sheet.addMergedRegion(region);
    fail("Expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Maximum column number is " + ssVersion.getLastColumnIndex(),e.getMessage());
  }
  try {
    region=new CellRangeAddress(0,ssVersion.getLastRowIndex() + 1,0,1);
    sheet.addMergedRegion(region);
    fail("Expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Maximum row number is " + ssVersion.getLastRowIndex(),e.getMessage());
  }
  assertEquals(1,sheet.getNumMergedRegions());
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Dissallow creating wholly or partially overlapping merged regions
 * as this results in a corrupted workbook
 */
@Test public void addOverlappingMergedRegions(){
  final Workbook wb=_testDataProvider.createWorkbook();
  final Sheet sheet=wb.createSheet();
  final CellRangeAddress baseRegion=new CellRangeAddress(0,1,0,1);
  sheet.addMergedRegion(baseRegion);
  try {
    final CellRangeAddress duplicateRegion=new CellRangeAddress(0,1,0,1);
    sheet.addMergedRegion(duplicateRegion);
    fail("Should not be able to add a merged region if sheet already contains the same merged region");
  }
 catch (  final IllegalStateException e) {
  }
  try {
    final CellRangeAddress partiallyOverlappingRegion=new CellRangeAddress(1,2,1,2);
    sheet.addMergedRegion(partiallyOverlappingRegion);
    fail("Should not be able to add a merged region if it partially overlaps with an existing merged region");
  }
 catch (  final IllegalStateException e) {
  }
  try {
    final CellRangeAddress subsetRegion=new CellRangeAddress(0,1,0,0);
    sheet.addMergedRegion(subsetRegion);
    fail("Should not be able to add a merged region if it is a formal subset of an existing merged region");
  }
 catch (  final IllegalStateException e) {
  }
  try {
    final CellRangeAddress supersetRegion=new CellRangeAddress(0,2,0,2);
    sheet.addMergedRegion(supersetRegion);
    fail("Should not be able to add a merged region if it is a formal superset of an existing merged region");
  }
 catch (  final IllegalStateException e) {
  }
  final CellRangeAddress disjointRegion=new CellRangeAddress(10,11,10,11);
  sheet.addMergedRegion(disjointRegion);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetShiftRows </h4><pre class="type-14 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Unified test for:
 * bug 46742: XSSFSheet.shiftRows should shift hyperlinks
 * bug 52903: HSSFSheet.shiftRows should shift hyperlinks
 * @throws IOException
 */
@Test public void testBug46742_52903_shiftHyperlinks() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet("test");
  Row row=sheet.createRow(0);
  CreationHelper helper=wb.getCreationHelper();
  CellStyle hlinkStyle=wb.createCellStyle();
  Font hlinkFont=wb.createFont();
  hlinkFont.setUnderline(Font.U_SINGLE);
  hlinkFont.setColor(IndexedColors.BLUE.getIndex());
  hlinkStyle.setFont(hlinkFont);
  Cell cell=row.createCell(0);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_DOCUMENT,"test!E1");
  cell=row.createCell(1);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_URL,"http://poi.apache.org/");
  Row overwrittenRow=sheet.createRow(3);
  cell=overwrittenRow.createCell(2);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_EMAIL,"mailto:poi@apache.org");
  Row unaffectedRow=sheet.createRow(20);
  cell=unaffectedRow.createCell(3);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_FILE,"54524.xlsx");
  cell=wb.createSheet("other").createRow(0).createCell(0);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_URL,"http://apache.org/");
  int startRow=0;
  int endRow=0;
  int n=3;
  sheet.shiftRows(startRow,endRow,n);
  Workbook read=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  Sheet sh=read.getSheet("test");
  Row shiftedRow=sh.getRow(3);
  verifyHyperlink(shiftedRow.getCell(0),Hyperlink.LINK_DOCUMENT,"test!E1");
  verifyHyperlink(shiftedRow.getCell(1),Hyperlink.LINK_URL,"http://poi.apache.org/");
  assertNull("Document hyperlink should be moved, not copied",sh.getHyperlink(0,0));
  assertNull("URL hyperlink should be moved, not copied",sh.getHyperlink(0,1));
  assertEquals(3,sh.getHyperlinkList().size());
  CellAddress unexpectedLinkAddress=new CellAddress("C4");
  for (  Hyperlink link : sh.getHyperlinkList()) {
    final CellAddress linkAddress=new CellAddress(link.getFirstRow(),link.getFirstColumn());
    if (linkAddress.equals(unexpectedLinkAddress)) {
      fail("Row 4, including the hyperlink at C4, should have " + "been deleted when Row 1 was shifted on top of it.");
    }
  }
  Cell unaffectedCell=sh.getRow(20).getCell(3);
  assertTrue(cellHasHyperlink(unaffectedCell));
  verifyHyperlink(unaffectedCell,Hyperlink.LINK_FILE,"54524.xlsx");
  unaffectedCell=read.getSheet("other").getRow(0).getCell(0);
  assertTrue(cellHasHyperlink(unaffectedCell));
  verifyHyperlink(unaffectedCell,Hyperlink.LINK_URL,"http://apache.org/");
  read.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetUpdateArrayFormulas </h4><pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_setCellFormula() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",CellRangeAddress.valueOf("B5"));
  Cell scell=srange.getTopLeftCell();
  assertEquals("SUM(A4:A6,B4:B6)",scell.getCellFormula());
  assertEquals(Cell.CELL_TYPE_FORMULA,scell.getCellType());
  assertTrue(scell.isPartOfArrayFormulaGroup());
  scell.setCellFormula("SUM(A4,A6)");
  assertEquals("SUM(A4,A6)",scell.getCellFormula());
  assertFalse(scell.isPartOfArrayFormulaGroup());
  assertEquals(Cell.CELL_TYPE_FORMULA,scell.getCellType());
  assertEquals(0.0,scell.getNumericCellValue(),0);
  scell.setCellValue(33.0);
  assertEquals(33.0,scell.getNumericCellValue(),0);
  CellRange<? extends Cell> mrange=sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  for (  Cell mcell : mrange) {
    try {
      assertEquals("A1:A3*B1:B3",mcell.getCellFormula());
      mcell.setCellFormula("A1+A2");
      fail("expected exception");
    }
 catch (    IllegalStateException e) {
      CellReference ref=new CellReference(mcell);
      String msg="Cell " + ref.formatAsString() + " is part of a multi-cell array formula. You cannot change part of an array.";
      assertEquals(msg,e.getMessage());
    }
    assertEquals("A1:A3*B1:B3",mcell.getCellFormula());
    assertTrue(mcell.isPartOfArrayFormulaGroup());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_mergeCells() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  assertEquals(0,sheet.getNumMergedRegions());
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",CellRangeAddress.valueOf("B5"));
  Cell scell=srange.getTopLeftCell();
  sheet.addMergedRegion(CellRangeAddress.valueOf("B5:C6"));
  assertEquals(Cell.CELL_TYPE_FORMULA,scell.getCellType());
  assertTrue(scell.isPartOfArrayFormulaGroup());
  assertEquals(1,sheet.getNumMergedRegions());
  sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  CellRangeAddress cra=CellRangeAddress.valueOf("C1:C3");
  try {
    sheet.addMergedRegion(cra);
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    String msg="The range " + cra.formatAsString() + " intersects with a multi-cell array formula. You cannot merge cells of an array.";
    assertEquals(msg,e.getMessage());
  }
  assertEquals(1,sheet.getNumMergedRegions());
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Calls of cell.getArrayFormulaRange and sheet.removeArrayFormula
 * on a not-array-formula cell throw IllegalStateException
 */
@Test public final void testArrayFormulas_illegalCalls() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  Cell cell=sheet.createRow(0).createCell(0);
  assertFalse(cell.isPartOfArrayFormulaGroup());
  try {
    cell.getArrayFormulaRange();
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cell A1 is not part of an array formula.",e.getMessage());
  }
  try {
    sheet.removeArrayFormula(cell);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Cell A1 is not part of an array formula.",e.getMessage());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_removeCell() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRangeAddress cra=CellRangeAddress.valueOf("B5");
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",cra);
  Cell scell=srange.getTopLeftCell();
  Row srow=sheet.getRow(cra.getFirstRow());
  assertSame(srow,scell.getRow());
  srow.removeCell(scell);
  assertNull(srow.getCell(cra.getFirstColumn()));
  scell=srow.createCell(cra.getFirstColumn());
  assertEquals(Cell.CELL_TYPE_BLANK,scell.getCellType());
  assertFalse(scell.isPartOfArrayFormulaGroup());
  CellRange<? extends Cell> mrange=sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  for (  Cell mcell : mrange) {
    int columnIndex=mcell.getColumnIndex();
    Row mrow=mcell.getRow();
    try {
      mrow.removeCell(mcell);
      fail("expected exception");
    }
 catch (    IllegalStateException e) {
      CellReference ref=new CellReference(mcell);
      String msg="Cell " + ref.formatAsString() + " is part of a multi-cell array formula. You cannot change part of an array.";
      assertEquals(msg,e.getMessage());
    }
    assertSame(mcell,mrow.getCell(columnIndex));
    assertTrue(mcell.isPartOfArrayFormulaGroup());
    assertEquals(Cell.CELL_TYPE_FORMULA,mcell.getCellType());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Passing an incorrect formula to sheet.setArrayFormula
 * should throw FormulaParseException
 */
@Test public final void testSetArrayFormula_incorrectFormula() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  try {
    sheet.setArrayFormula("incorrect-formula(C11_C12*D11_D12)",new CellRangeAddress(10,10,10,10));
    fail("expected exception");
  }
 catch (  FormulaParseException e) {
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_shiftRows() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",CellRangeAddress.valueOf("B5"));
  Cell scell=srange.getTopLeftCell();
  assertEquals("SUM(A4:A6,B4:B6)",scell.getCellFormula());
  sheet.shiftRows(0,0,1);
  sheet.shiftRows(0,1,1);
  sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  try {
    sheet.shiftRows(0,0,1);
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    String msg="Row[rownum=0] contains cell(s) included in a multi-cell array formula. You cannot change part of an array.";
    assertEquals(msg,e.getMessage());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_setCellType() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",CellRangeAddress.valueOf("B5"));
  Cell scell=srange.getTopLeftCell();
  assertEquals(Cell.CELL_TYPE_FORMULA,scell.getCellType());
  assertEquals(0.0,scell.getNumericCellValue(),0);
  scell.setCellType(Cell.CELL_TYPE_STRING);
  assertEquals(Cell.CELL_TYPE_STRING,scell.getCellType());
  scell.setCellValue("string cell");
  assertEquals("string cell",scell.getStringCellValue());
  CellRange<? extends Cell> mrange=sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  for (  Cell mcell : mrange) {
    try {
      assertEquals(Cell.CELL_TYPE_FORMULA,mcell.getCellType());
      mcell.setCellType(Cell.CELL_TYPE_NUMERIC);
      fail("expected exception");
    }
 catch (    IllegalStateException e) {
      CellReference ref=new CellReference(mcell);
      String msg="Cell " + ref.formatAsString() + " is part of a multi-cell array formula. You cannot change part of an array.";
      assertEquals(msg,e.getMessage());
    }
    assertEquals(Cell.CELL_TYPE_FORMULA,mcell.getCellType());
    assertTrue(mcell.isPartOfArrayFormulaGroup());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyArrayCells_removeRow() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRangeAddress cra=CellRangeAddress.valueOf("B5");
  CellRange<? extends Cell> srange=sheet.setArrayFormula("SUM(A4:A6,B4:B6)",cra);
  Cell scell=srange.getTopLeftCell();
  assertEquals(Cell.CELL_TYPE_FORMULA,scell.getCellType());
  Row srow=scell.getRow();
  assertSame(srow,sheet.getRow(cra.getFirstRow()));
  sheet.removeRow(srow);
  assertNull(sheet.getRow(cra.getFirstRow()));
  scell=sheet.createRow(cra.getFirstRow()).createCell(cra.getFirstColumn());
  assertEquals(Cell.CELL_TYPE_BLANK,scell.getCellType());
  assertFalse(scell.isPartOfArrayFormulaGroup());
  CellRange<? extends Cell> mrange=sheet.setArrayFormula("A1:A3*B1:B3",CellRangeAddress.valueOf("C1:C3"));
  for (  Cell mcell : mrange) {
    int columnIndex=mcell.getColumnIndex();
    Row mrow=mcell.getRow();
    try {
      sheet.removeRow(mrow);
      fail("expected exception");
    }
 catch (    IllegalStateException e) {
    }
    assertSame(mrow,sheet.getRow(mrow.getRowNum()));
    assertSame(mcell,mrow.getCell(columnIndex));
    assertTrue(mcell.isPartOfArrayFormulaGroup());
    assertEquals(Cell.CELL_TYPE_FORMULA,mcell.getCellType());
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * create and remove array formulas
 */
@Test public final void testRemoveArrayFormula() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  CellRangeAddress range=new CellRangeAddress(3,5,2,2);
  assertEquals("C4:C6",range.formatAsString());
  CellRange<?> cr=sheet.setArrayFormula("SUM(A1:A3*B1:B3)",range);
  assertEquals(3,cr.size());
  CellRange<?> dcells=sheet.removeArrayFormula(cr.getTopLeftCell());
  assertArrayEquals(cr.getFlattenedCells(),dcells.getFlattenedCells());
  for (  Cell acell : cr) {
    assertFalse(acell.isPartOfArrayFormulaGroup());
    assertEquals(Cell.CELL_TYPE_BLANK,acell.getCellType());
  }
  for (  Cell acell : cr) {
    try {
      sheet.removeArrayFormula(acell);
      fail("expected exception");
    }
 catch (    IllegalArgumentException e) {
      String ref=new CellReference(acell).formatAsString();
      assertEquals("Cell " + ref + " is not part of an array formula.",e.getMessage());
    }
  }
  workbook.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Set single-cell array formula
 */
@Test public final void testSetArrayFormula_singleCell() throws IOException {
  Cell[] cells;
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  Cell cell=sheet.createRow(0).createCell(0);
  assertFalse(cell.isPartOfArrayFormulaGroup());
  try {
    cell.getArrayFormulaRange();
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cell A1 is not part of an array formula.",e.getMessage());
  }
  assertNull(sheet.getRow(2));
  CellRangeAddress range=new CellRangeAddress(2,2,2,2);
  cells=sheet.setArrayFormula("SUM(C11:C12*D11:D12)",range).getFlattenedCells();
  assertEquals(1,cells.length);
  assertNotNull(sheet.getRow(2));
  cell=sheet.getRow(2).getCell(2);
  assertNotNull(cell);
  assertTrue(cell.isPartOfArrayFormulaGroup());
  assertEquals(range.formatAsString(),cell.getArrayFormulaRange().formatAsString());
  assertEquals("SUM(C11:C12*D11:D12)",cell.getCellFormula());
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestWorkbook </h4><pre class="type-14 type-10 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSheet() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  assertEquals(0,wb.getNumberOfSheets());
  assertNull(wb.getSheet("Sheet1"));
  try {
    wb.getSheetAt(0);
    fail("should have thrown exceptiuon due to invalid sheet index");
  }
 catch (  IllegalArgumentException e) {
    assertFalse(e.getMessage().contains("-1"));
  }
  Sheet sheet0=wb.createSheet();
  Sheet sheet1=wb.createSheet();
  assertEquals("Sheet0",sheet0.getSheetName());
  assertEquals("Sheet1",sheet1.getSheetName());
  assertEquals(2,wb.getNumberOfSheets());
  Sheet originalSheet=wb.createSheet("Sheet3");
  Sheet fetchedSheet=wb.getSheet("sheet3");
  if (fetchedSheet == null) {
    fail("Identified bug 44892");
  }
  assertEquals("Sheet3",fetchedSheet.getSheetName());
  assertEquals(3,wb.getNumberOfSheets());
  assertSame(originalSheet,fetchedSheet);
  try {
    wb.createSheet("sHeeT3");
    fail("should have thrown exceptiuon due to duplicate sheet name");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String[] invalidNames={"","Sheet/","Sheet\\","Sheet?","Sheet*","Sheet[","Sheet]","'Sheet'","My:Sheet"};
  for (  String sheetName : invalidNames) {
    try {
      wb.createSheet(sheetName);
      fail("should have thrown exception due to invalid sheet name: " + sheetName);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  assertEquals(3,wb.getNumberOfSheets());
  wb.setSheetName(2,"I changed!");
  try {
    wb.setSheetName(1,"[I'm invalid]");
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.createSheet(null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.setSheetName(2,null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(0,wb.getSheetIndex("sheet0"));
  assertEquals(1,wb.getSheetIndex("sheet1"));
  assertEquals(2,wb.getSheetIndex("I changed!"));
  assertSame(sheet0,wb.getSheet("sheet0"));
  assertSame(sheet1,wb.getSheet("sheet1"));
  assertSame(originalSheet,wb.getSheet("I changed!"));
  assertNull(wb.getSheet("unknown"));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(3,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex("sheet0"));
  assertEquals(1,wb2.getSheetIndex("sheet1"));
  assertEquals(2,wb2.getSheetIndex("I changed!"));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void windowOneDefaults() throws IOException {
  Workbook b=_testDataProvider.createWorkbook();
  try {
    assertEquals(b.getActiveSheetIndex(),0);
    assertEquals(b.getFirstVisibleTab(),0);
  }
 catch (  NullPointerException npe) {
    fail("WindowOneRecord in Workbook is probably not initialized");
  }
  b.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * POI allows creating sheets with names longer than 31 characters.
 * Excel opens files with long sheet names without error or warning.
 * However, long sheet names are silently truncated to 31 chars.  In order to
 * avoid funny duplicate sheet name errors, POI enforces uniqueness on only the first 31 chars.
 * but for the purpose of uniqueness long sheet names are silently truncated to 31 chars.
 */
@Test public void createSheetWithLongNames() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  String sheetName1="My very long sheet name which is longer than 31 chars";
  String truncatedSheetName1=sheetName1.substring(0,31);
  Sheet sh1=wb1.createSheet(sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  wb1.setSheetName(0,sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  String sheetName2="My very long sheet name which is longer than 31 chars " + "and sheetName2.substring(0, 31) == sheetName1.substring(0, 31)";
  try {
    wb1.createSheet(sheetName2);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String sheetName3="POI allows creating sheets with names longer than 31 characters";
  String truncatedSheetName3=sheetName3.substring(0,31);
  Sheet sh3=wb1.createSheet(sheetName3);
  assertEquals(truncatedSheetName3,sh3.getSheetName());
  assertSame(sh3,wb1.getSheet(truncatedSheetName3));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(2,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex(truncatedSheetName1));
  assertEquals(1,wb2.getSheetIndex(truncatedSheetName3));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.TestDataFormatter </h4><pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug54786(){
  DataFormatter formatter=new DataFormatter();
  String format="[h]\"\"h\"\" m\"\"m\"\"";
  assertTrue(DateUtil.isADateFormat(-1,format));
  assertTrue(DateUtil.isValidExcelDate(_15_MINUTES));
  assertEquals("1h 0m",formatter.formatRawCellContents(_15_MINUTES,-1,format,false));
  assertEquals("0.041666667",formatter.formatRawCellContents(_15_MINUTES,-1,"[h]'h'",false));
  assertEquals("1h 0m\"",formatter.formatRawCellContents(_15_MINUTES,-1,"[h]\"\"h\"\" m\"\"m\"\"\"",false));
  assertEquals("1h",formatter.formatRawCellContents(_15_MINUTES,-1,"[h]\"\"h\"\"",false));
  assertEquals("h1",formatter.formatRawCellContents(_15_MINUTES,-1,"\"\"h\"\"[h]",false));
  assertEquals("h1",formatter.formatRawCellContents(_15_MINUTES,-1,"\"\"h\"\"h",false));
  assertEquals(" 60",formatter.formatRawCellContents(_15_MINUTES,-1," [m]",false));
  assertEquals("h60",formatter.formatRawCellContents(_15_MINUTES,-1,"\"\"h\"\"[m]",false));
  assertEquals("m1",formatter.formatRawCellContents(_15_MINUTES,-1,"\"\"m\"\"h",false));
  try {
    assertEquals("1h 0m\"",formatter.formatRawCellContents(_15_MINUTES,-1,"[h]\"\"h\"\" m\"\"m\"\"\"\"",false));
    fail("Catches exception because of invalid format, i.e. trailing quoting");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().contains("Cannot format given Object as a Number"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.util.TestCellReference </h4><pre class="type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertColStringToIndex(){
  assertEquals(0,CellReference.convertColStringToIndex("A"));
  assertEquals(1,CellReference.convertColStringToIndex("B"));
  assertEquals(14,CellReference.convertColStringToIndex("O"));
  assertEquals(701,CellReference.convertColStringToIndex("ZZ"));
  assertEquals(18252,CellReference.convertColStringToIndex("ZZA"));
  assertEquals(0,CellReference.convertColStringToIndex("$A"));
  assertEquals(1,CellReference.convertColStringToIndex("$B"));
  try {
    CellReference.convertColStringToIndex("A$");
    fail("Should throw exception here");
  }
 catch (  IllegalArgumentException expected) {
    assertTrue(expected.getMessage().contains("A$"));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidReference(){
  try {
    new CellReference("Sheet1!#REF!");
    fail("Shouldn't be able to create a #REF! refence");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    new CellReference("'MySheetName'!#REF!");
    fail("Shouldn't be able to create a #REF! refence");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    new CellReference("#REF!");
    fail("Shouldn't be able to create a #REF! refence");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.util.TestCellUtil </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void setFontFromDifferentWorkbook() throws IOException {
  Workbook wb1=new HSSFWorkbook();
  Workbook wb2=new HSSFWorkbook();
  Font font1=wb1.createFont();
  Font font2=wb2.createFont();
  font1.setItalic(true);
  Cell A1=wb1.createSheet().createRow(0).createCell(0);
  CellUtil.setFont(A1,wb1,font1);
  try {
    CellUtil.setFont(A1,wb1,font2);
    fail("setFont not allowed if font belongs to a different workbook");
  }
 catch (  final IllegalArgumentException e) {
    if (e.getMessage().startsWith("Font does not belong to this workbook")) {
    }
 else {
      throw e;
    }
  }
  try {
    CellUtil.setFont(A1,wb2,font2);
    fail("setFont not allowed if cell belongs to a different workbook");
  }
 catch (  final IllegalArgumentException e) {
    if (e.getMessage().startsWith("Cannot set cell style property. Cell does not belong to workbook.")) {
    }
 else {
      throw e;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.util.TestHexDump </h4><pre class="type-2 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDump() throws IOException {
  byte[] testArray=testArray();
  ByteArrayOutputStream streamAct=new ByteArrayOutputStream();
  HexDump.dump(testArray,0,streamAct,0);
  byte bytesAct[]=streamAct.toByteArray();
  byte bytesExp[]=toHexDump(0,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0x10000000L,streamAct,0);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0x10000000L,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0xFF000000L,streamAct,0);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0xFF000000L,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0xFF000000L,streamAct,0x81);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0xFF000000L,0x81);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  try {
    streamAct.reset();
    HexDump.dump(testArray,0x10000000L,streamAct,-1);
    fail("should have caught ArrayIndexOutOfBoundsException on negative index");
  }
 catch (  ArrayIndexOutOfBoundsException ignored_exception) {
  }
  try {
    streamAct.reset();
    HexDump.dump(testArray,0x10000000L,streamAct,testArray.length);
    fail("should have caught ArrayIndexOutOfBoundsException on large index");
  }
 catch (  ArrayIndexOutOfBoundsException ignored_exception) {
  }
  try {
    HexDump.dump(testArray,0x10000000L,null,0);
    fail("should have caught IllegalArgumentException on negative index");
  }
 catch (  IllegalArgumentException ignored_exception) {
  }
  streamAct.reset();
  HexDump.dump(new byte[0],0,streamAct,0);
  assertEquals("No Data" + System.getProperty("line.separator"),streamAct.toString(LocaleUtil.CHARSET_1252.name()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.TestXSLFBugs </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Slide relations with anchors in them
 */
@Test public void tika705() throws Exception {
  XMLSlideShow ss=XSLFTestDataSamples.openSampleDocument("with_japanese.pptx");
  assertEquals(1,ss.getSlides().size());
  XSLFSlide slide=ss.getSlides().get(0);
  Collection<RelationPart> rels=slide.getRelationParts();
  assertEquals(5,rels.size());
  int layouts=0;
  int hyperlinks=0;
  for (  RelationPart p : rels) {
    if (p.getRelationship().getRelationshipType().equals(XSLFRelation.HYPERLINK.getRelation())) {
      hyperlinks++;
    }
 else     if (p.getDocumentPart() instanceof XSLFSlideLayout) {
      layouts++;
    }
  }
  assertEquals(1,layouts);
  assertEquals(4,hyperlinks);
  for (  RelationPart p : rels) {
    if (p.getRelationship().getRelationshipType().equals(XSLFRelation.HYPERLINK.getRelation())) {
      URI target=p.getRelationship().getTargetURI();
      if (target.getFragment().equals("_ftn1") || target.getFragment().equals("_ftnref1")) {
      }
 else {
        fail("Invalid target " + target.getFragment() + " on "+ target);
      }
    }
  }
  ss.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFSimpleShape </h4><pre class="type-10 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidGeometry() throws Exception {
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide=ppt.createSlide();
  XSLFSimpleShape shape=slide.createAutoShape();
  CTShapeProperties spPr=shape.getSpPr();
  CTPresetGeometry2D prstGeom=CTPresetGeometry2D.Factory.newInstance();
  prstGeom.setPrst(STShapeType.Enum.forInt(1));
  assertNotNull(prstGeom.getPrst());
  assertNotNull(prstGeom.getPrst().toString());
  assertNotNull(spPr.getPrstGeom());
  spPr.setPrstGeom(prstGeom);
  assertNotNull(spPr.getPrstGeom().getPrst());
  assertNotNull(spPr.getPrstGeom().getPrst().toString());
  try {
    TestPresetGeometries.clearPreset();
    try {
      shape.getGeometry();
      fail("Should fail without the geometry");
    }
 catch (    IllegalStateException e) {
      assertTrue(e.getMessage(),e.getMessage().contains("line"));
    }
  }
  finally {
    TestPresetGeometries.resetPreset();
  }
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestStylesTable </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addDataFormatsBeyondUpperLimit() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    StylesTable styles=wb.getStylesSource();
    styles.setMaxNumberOfDataFormats(0);
    try {
      styles.putNumberFormat("\"test \"0");
      fail("Expected to raise IllegalStateException");
    }
 catch (    final IllegalStateException e) {
      if (e.getMessage().startsWith("The maximum number of Data Formats was exceeded.")) {
      }
 else {
        throw e;
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void decreaseUpperLimitBelowCurrentNumDataFormats() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    StylesTable styles=wb.getStylesSource();
    styles.putNumberFormat(customDataFormat);
    try {
      styles.setMaxNumberOfDataFormats(0);
      fail("Expected to raise IllegalStateException");
    }
 catch (    final IllegalStateException e) {
      if (e.getMessage().startsWith("Cannot set the maximum number of data formats less than the current quantity.")) {
      }
 else {
        throw e;
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void maxNumberOfDataFormats() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    StylesTable styles=wb.getStylesSource();
    int n=styles.getMaxNumberOfDataFormats();
    assertTrue(200 <= n);
    assertTrue(n <= 250);
    n=Integer.MAX_VALUE;
    styles.setMaxNumberOfDataFormats(n);
    assertEquals(n,styles.getMaxNumberOfDataFormats());
    try {
      styles.setMaxNumberOfDataFormats(-1);
      fail("Expected to get an IllegalArgumentException(\"Maximum Number of Data Formats must be greater than or equal to 0\")");
    }
 catch (    final IllegalArgumentException e) {
      if (e.getMessage().startsWith("Maximum Number of Data Formats must be greater than or equal to 0")) {
      }
 else {
        throw e;
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestOutlining </h4><pre class="type-10 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetRowGroupCollapsedError() throws IOException {
  SXSSFWorkbook wb2=new SXSSFWorkbook(100);
  wb2.setCompressTempFiles(true);
  SXSSFSheet sheet2=wb2.createSheet("new sheet");
  int rowCount=20;
  for (int i=0; i < rowCount; i++) {
    sheet2.createRow(i);
  }
  sheet2.groupRow(4,9);
  sheet2.groupRow(11,19);
  try {
    sheet2.setRowGroupCollapsed(3,true);
    fail("Should fail with an exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().contains("row (3)"));
  }
  try {
    sheet2.setRowGroupCollapsed(10,true);
    fail("Should fail with an exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().contains("row (10)"));
  }
  try {
    sheet2.setRowGroupCollapsed(0,true);
    fail("Should fail with an exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().contains("row (0)"));
  }
  try {
    sheet2.setRowGroupCollapsed(20,true);
    fail("Should fail with an exception");
  }
 catch (  IllegalArgumentException e) {
    assertTrue("Had: " + e.getMessage(),e.getMessage().contains("Row does not exist"));
  }
  SXSSFRow r=sheet2.getRow(8);
  assertNotNull(r);
  assertNull(r.getHidden());
  r=sheet2.getRow(10);
  assertNull(r.getCollapsed());
  r=sheet2.getRow(12);
  assertNull(r.getHidden());
  wb2.dispose();
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFFormulaEvaluation </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * EvaluateAll will normally fail, as any reference or
 * formula outside of the window will fail, and any
 * non-active sheets will fail
 */
@Test public void testEvaluateAllFails() throws IOException {
  SXSSFWorkbook wb=new SXSSFWorkbook(5);
  SXSSFSheet s=wb.createSheet();
  FormulaEvaluator eval=wb.getCreationHelper().createFormulaEvaluator();
  s.createRow(0).createCell(0).setCellFormula("1+2");
  s.createRow(1).createCell(0).setCellFormula("A21");
  for (int i=2; i < 19; i++) {
    s.createRow(i);
  }
  s.createRow(19).createCell(0).setCellFormula("A1+A2");
  s.createRow(20).createCell(0).setCellFormula("A1+A11+100");
  try {
    eval.evaluateAll();
    fail("Evaluate All shouldn't work, as some cells outside the window");
  }
 catch (  SXSSFFormulaEvaluator.RowFlushedException e) {
  }
  XSSFWorkbook xwb=new XSSFWorkbook();
  xwb.createSheet("Open");
  xwb.createSheet("Closed");
  wb.close();
  wb=new SXSSFWorkbook(xwb,5);
  s=wb.getSheet("Closed");
  s.flushRows();
  s=wb.getSheet("Open");
  s.createRow(0).createCell(0).setCellFormula("1+2");
  eval=wb.getCreationHelper().createFormulaEvaluator();
  try {
    eval.evaluateAll();
    fail("Evaluate All shouldn't work, as sheets flushed");
  }
 catch (  SXSSFFormulaEvaluator.SheetsFlushedException e) {
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEvaluateRefOutsideWindowFails() throws IOException {
  SXSSFWorkbook wb=new SXSSFWorkbook(5);
  SXSSFSheet s=wb.createSheet();
  s.createRow(0).createCell(0).setCellFormula("1+2");
  assertEquals(false,s.areAllRowsFlushed());
  assertEquals(-1,s.getLastFlushedRowNum());
  for (int i=1; i <= 19; i++) {
    s.createRow(i);
  }
  Cell c=s.createRow(20).createCell(0);
  c.setCellFormula("A1+100");
  assertEquals(false,s.areAllRowsFlushed());
  assertEquals(15,s.getLastFlushedRowNum());
  FormulaEvaluator eval=wb.getCreationHelper().createFormulaEvaluator();
  try {
    eval.evaluateFormulaCell(c);
    fail("Evaluate shouldn't work, as reference outside the window");
  }
 catch (  SXSSFFormulaEvaluator.RowFlushedException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFSheet </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void overrideRowsInTemplate() throws IOException {
  XSSFWorkbook template=new XSSFWorkbook();
  template.createSheet().createRow(1);
  Workbook wb=new SXSSFWorkbook(template);
  try {
    Sheet sheet=wb.getSheetAt(0);
    try {
      sheet.createRow(1);
      fail("expected exception");
    }
 catch (    Throwable e) {
      assertEquals("Attempting to write a row[1] in the range [0,1] that is already written to disk.",e.getMessage());
    }
    try {
      sheet.createRow(0);
      fail("expected exception");
    }
 catch (    Throwable e) {
      assertEquals("Attempting to write a row[0] in the range [0,1] that is already written to disk.",e.getMessage());
    }
    sheet.createRow(2);
  }
  finally {
    wb.close();
    template.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFSheetAutoSizeColumn </h4><pre class="type-10 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_untrackColumnsForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnForAutoSizing(15);
  sheet.trackColumnsForAutoSizing(columns);
  sheet.untrackColumnsForAutoSizing(columns);
  assumeTrue(sheet.getTrackedColumnsForAutoSizing().contains(15));
  sheet.autoSizeColumn(15,useMergedCells);
  try {
    assumeFalse(sheet.getTrackedColumnsForAutoSizing().contains(columns.first()));
    sheet.autoSizeColumn(columns.first(),useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_trackColumnsForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnsForAutoSizing(columns);
  SortedSet<Integer> sorted=new TreeSet<Integer>(columns);
  assertEquals(sorted,sheet.getTrackedColumnsForAutoSizing());
  sheet.autoSizeColumn(sorted.first(),useMergedCells);
  try {
    assumeFalse(columns.contains(5));
    sheet.autoSizeColumn(5,useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_untrackColumnForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnsForAutoSizing(columns);
  sheet.untrackColumnForAutoSizing(columns.first());
  assumeTrue(sheet.getTrackedColumnsForAutoSizing().contains(columns.last()));
  sheet.autoSizeColumn(columns.last(),useMergedCells);
  try {
    assumeFalse(sheet.getTrackedColumnsForAutoSizing().contains(columns.first()));
    sheet.autoSizeColumn(columns.first(),useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void autoSizeColumn_trackAllColumns(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackAllColumnsForAutoSizing();
  sheet.autoSizeColumn(0,useMergedCells);
  sheet.untrackAllColumnsForAutoSizing();
  try {
    sheet.autoSizeColumn(0,useMergedCells);
    fail("Should not be able to auto-size an implicitly untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_trackColumnForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnForAutoSizing(0);
  SortedSet<Integer> expected=new TreeSet<Integer>();
  expected.add(0);
  assertEquals(expected,sheet.getTrackedColumnsForAutoSizing());
  sheet.autoSizeColumn(0,useMergedCells);
  try {
    sheet.autoSizeColumn(1,useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void autoSizeColumn_trackAllColumns_explicitUntrackColumn(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnsForAutoSizing(columns);
  sheet.trackAllColumnsForAutoSizing();
  sheet.untrackColumnForAutoSizing(0);
  try {
    sheet.autoSizeColumn(0,useMergedCells);
    fail("Should not be able to auto-size an explicitly untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFWorkbook </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * cloning of sheets is not supported in SXSSF
 */
@Override @Test public void cloneSheet() throws IOException {
  try {
    super.cloneSheet();
    fail("expected exception");
  }
 catch (  RuntimeException e) {
    assertEquals("NotImplemented",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (short colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    assumeNotNull(c);
    assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
    ignoredFormulaTestCase(c.getCellFormula());
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestMultiSheetFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @return a constant from the local Result class denoting whether there were any evaluation
 * cases, and whether they all succeeded.
 */
@Test public void processFunctionRow(){
  Row r=sheet.getRow(formulasRowIdx);
  Cell expValue=r.getCell(SS.COLUMN_INDEX_EXPECTED_VALUE);
  assertNotNull("Missing expected values cell for function '" + targetFunctionName + ", test"+ targetTestName+ " (row "+ formulasRowIdx+ 1+ ")",expValue);
  Cell c=r.getCell(SS.COLUMN_INDEX_ACTUAL_VALUE);
  assumeNotNull(c);
  assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
  CellValue actValue=evaluator.evaluate(c);
  String msg=String.format(Locale.ROOT,"Function '%s': Test: '%s': Formula: %s @ %d:%d",targetFunctionName,targetTestName,c.getCellFormula(),formulasRowIdx,SS.COLUMN_INDEX_ACTUAL_VALUE);
  assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
    assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
  break;
case Cell.CELL_TYPE_BOOLEAN:
assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFBugs </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 */
@Test public void bug56800_xlsb() throws IOException, InvalidFormatException {
  OPCPackage pkg=XSSFTestDataSamples.openSamplePackage("Simple.xlsb");
  try {
    new XSSFWorkbook(pkg).close();
    fail(".xlsb files not supported");
  }
 catch (  XLSBUnsupportedException e) {
  }
  try {
    WorkbookFactory.create(pkg).close();
    fail(".xlsb files not supported");
  }
 catch (  XLSBUnsupportedException e) {
  }
  File xlsbFile=HSSFTestDataSamples.getSampleFile("Simple.xlsb");
  try {
    WorkbookFactory.create(xlsbFile).close();
    fail(".xlsb files not supported");
  }
 catch (  XLSBUnsupportedException e) {
  }
  pkg.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A .xlsx file with no Shared Strings table should open fine
 * in read-only mode
 * @throws InvalidFormatException 
 */
@Test public void bug57482() throws IOException, InvalidFormatException {
  for (  PackageAccess access : new PackageAccess[]{PackageAccess.READ_WRITE,PackageAccess.READ}) {
    File file=HSSFTestDataSamples.getSampleFile("57482-OnlyNumeric.xlsx");
    OPCPackage pkg=OPCPackage.open(file,access);
    try {
      XSSFWorkbook wb1=new XSSFWorkbook(pkg);
      assertNotNull(wb1.getSharedStringSource());
      assertEquals(0,wb1.getSharedStringSource().getCount());
      DataFormatter fmt=new DataFormatter();
      XSSFSheet s=wb1.getSheetAt(0);
      assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
      assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
      assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
      s.getRow(0).createCell(3).setCellValue("Testing");
      assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      XSSFWorkbook wb2=null;
      try {
        wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
        if (access == PackageAccess.READ) {
          fail("Shouln't be able to write from read-only mode");
        }
        s=wb2.getSheetAt(0);
        assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
        assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
        assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
        assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      }
 catch (      InvalidOperationException e) {
        if (access == PackageAccess.READ_WRITE) {
          throw e;
        }
      }
 finally {
        if (wb2 != null) {
          wb2.getPackage().revert();
        }
      }
      wb1.getPackage().revert();
    }
  finally {
      pkg.revert();
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug54764() throws IOException, OpenXML4JException, XmlException {
  OPCPackage pkg=XSSFTestDataSamples.openSamplePackage("54764.xlsx");
  POIXMLProperties props=new POIXMLProperties(pkg);
  assertEquals(null,props.getCoreProperties().getTitle());
  assertEquals(null,props.getCoreProperties().getSubject());
  assertEquals(null,props.getCoreProperties().getDescription());
  try {
    new XSSFWorkbook(pkg).close();
    fail("Should fail as too much expansion occurs");
  }
 catch (  POIXMLException e) {
  }
  pkg.close();
  try {
    XSSFTestDataSamples.openSamplePackage("54764-2.xlsx").close();
    fail("Should fail as too much expansion occurs");
  }
 catch (  Exception e) {
  }
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("sample.xlsx");
  assertEquals(3,wb.getNumberOfSheets());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFComment </h4><pre class="type-10 type-1 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void setString(){
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sh=wb.createSheet();
  XSSFComment comment=sh.createDrawingPatriarch().createCellComment(new XSSFClientAnchor());
  try {
    comment.setString(new HSSFRichTextString(TEST_RICHTEXTSTRING));
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Only XSSFRichTextString argument is supported",e.getMessage());
  }
  comment.setString(TEST_RICHTEXTSTRING);
  assertEquals(TEST_RICHTEXTSTRING,comment.getString().getString());
  comment.setString(TEST_RICHTEXTSTRING);
  CTComment ctComment=comment.getCTComment();
  XmlObject[] obj=ctComment.selectPath("declare namespace w='http://schemas.openxmlformats.org/spreadsheetml/2006/main' .//w:text");
  assertEquals(1,obj.length);
  assertEquals(TEST_RICHTEXTSTRING,comment.getString().getString());
  assertSame(comment.getString(),comment.getString());
  XSSFRichTextString richText=new XSSFRichTextString(TEST_RICHTEXTSTRING);
  XSSFFont font1=wb.createFont();
  font1.setFontName("Tahoma");
  font1.setFontHeight(8.5);
  font1.setItalic(true);
  font1.setColor(IndexedColors.BLUE_GREY.getIndex());
  richText.applyFont(0,5,font1);
  comment.setString(richText);
  obj=ctComment.selectPath("declare namespace w='http://schemas.openxmlformats.org/spreadsheetml/2006/main' .//w:text");
  assertEquals(1,obj.length);
  assertSame(comment.getString(),richText);
  CTRPrElt rPr=richText.getCTRst().getRArray(0).getRPr();
  assertEquals(true,rPr.getIArray(0).getVal());
  assertEquals(8.5,rPr.getSzArray(0).getVal(),0);
  assertEquals(IndexedColors.BLUE_GREY.getIndex(),rPr.getColorArray(0).getIndexed());
  assertEquals("Tahoma",rPr.getRFontArray(0).getVal());
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(wb));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFont </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharSet() throws IOException {
  CTFont ctFont=CTFont.Factory.newInstance();
  CTIntProperty prop=ctFont.addNewCharset();
  prop.setVal(FontCharset.ANSI.getValue());
  ctFont.setCharsetArray(0,prop);
  XSSFFont xssfFont=new XSSFFont(ctFont);
  assertEquals(Font.ANSI_CHARSET,xssfFont.getCharSet());
  xssfFont.setCharSet(FontCharset.DEFAULT);
  assertEquals(FontCharset.DEFAULT.getValue(),ctFont.getCharsetArray(0).getVal());
  xssfFont.setCharSet(FontCharset.RUSSIAN);
  assertEquals(FontCharset.RUSSIAN.getValue(),xssfFont.getCharSet());
  xssfFont.setCharSet(FontCharset.ARABIC.getValue());
  assertEquals(FontCharset.ARABIC.getValue(),xssfFont.getCharSet());
  xssfFont.setCharSet((byte)(FontCharset.ARABIC.getValue()));
  assertEquals(FontCharset.ARABIC.getValue(),xssfFont.getCharSet());
  assertEquals(null,FontCharset.valueOf(9999));
  try {
    xssfFont.setCharSet(9999);
    fail("Shouldn't be able to set an invalid charset");
  }
 catch (  POIXMLException e) {
  }
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  assertEquals(0,wb1.getSheetAt(0).getRow(0).getCell(0).getCellStyle().getFont().getCharSet());
  wb1.close();
  XSSFWorkbook wb2=XSSFTestDataSamples.openSampleWorkbook("49273.xlsx");
  assertEquals(134,wb2.getSheetAt(0).getRow(0).getCell(0).getCellStyle().getFont().getCharSet());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaEvaluation </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Related to bugs #56737 and #56752 - XSSF workbooks which have
 * formulas that refer to cells and named ranges in multiple other
 * workbooks, both HSSF and XSSF ones
 */
@Test public void testReferencesToOtherWorkbooks() throws Exception {
  XSSFWorkbook wb=(XSSFWorkbook)_testDataProvider.openSampleWorkbook("ref2-56737.xlsx");
  XSSFFormulaEvaluator evaluator=wb.getCreationHelper().createFormulaEvaluator();
  XSSFSheet s=wb.getSheetAt(0);
  Row rXSLX=s.getRow(2);
  Cell cXSLX_cell=rXSLX.getCell(4);
  Cell cXSLX_sNR=rXSLX.getCell(6);
  Cell cXSLX_gNR=rXSLX.getCell(8);
  assertEquals("[1]Uses!$A$1",cXSLX_cell.getCellFormula());
  assertEquals("[1]Defines!NR_To_A1",cXSLX_sNR.getCellFormula());
  assertEquals("[1]!NR_Global_B2",cXSLX_gNR.getCellFormula());
  assertEquals("Hello!",cXSLX_cell.getStringCellValue());
  assertEquals("Test A1",cXSLX_sNR.getStringCellValue());
  assertEquals(142.0,cXSLX_gNR.getNumericCellValue(),0);
  Row rXSL=s.getRow(4);
  Cell cXSL_cell=rXSL.getCell(4);
  Cell cXSL_sNR=rXSL.getCell(6);
  Cell cXSL_gNR=rXSL.getCell(8);
  assertEquals("[2]Uses!$C$1",cXSL_cell.getCellFormula());
  assertEquals("[2]Defines!NR_To_A1",cXSL_sNR.getCellFormula());
  assertEquals("[2]!NR_Global_B2",cXSL_gNR.getCellFormula());
  assertEquals("Hello!",cXSL_cell.getStringCellValue());
  assertEquals("Test A1",cXSL_sNR.getStringCellValue());
  assertEquals(142.0,cXSL_gNR.getNumericCellValue(),0);
  try {
    evaluator.evaluate(cXSL_cell);
    fail("Without a fix for #56752, shouldn't be able to evaluate a " + "reference to a non-provided linked workbook");
  }
 catch (  Exception e) {
  }
  Map<String,FormulaEvaluator> evaluators=new HashMap<String,FormulaEvaluator>();
  evaluators.put("ref2-56737.xlsx",evaluator);
  evaluators.put("56737.xlsx",_testDataProvider.openSampleWorkbook("56737.xlsx").getCreationHelper().createFormulaEvaluator());
  evaluators.put("56737.xls",HSSFTestDataSamples.openSampleWorkbook("56737.xls").getCreationHelper().createFormulaEvaluator());
  evaluator.setupReferencedWorkbooks(evaluators);
  for (  Row r : s) {
    for (    Cell c : r) {
      evaluator.evaluate(c);
    }
  }
  assertEquals("\"Hello!\"",evaluator.evaluate(cXSLX_cell).formatAsString());
  assertEquals("\"Test A1\"",evaluator.evaluate(cXSLX_sNR).formatAsString());
  assertEquals("142.0",evaluator.evaluate(cXSLX_gNR).formatAsString());
  assertEquals("\"Hello!\"",evaluator.evaluate(cXSL_cell).formatAsString());
  assertEquals("\"Test A1\"",evaluator.evaluate(cXSL_sNR).formatAsString());
  assertEquals("142.0",evaluator.evaluate(cXSL_gNR).formatAsString());
  Cell cXSL_cell2=rXSL.createCell(40);
  cXSL_cell2.setCellFormula("[56737.xls]Uses!$C$1");
  assertEquals("[56737.xls]Uses!$C$1",cXSL_cell2.getCellFormula());
  assertEquals("\"Hello!\"",evaluator.evaluate(cXSL_cell2).formatAsString());
  Cell cXSLX_nw_cell=rXSLX.createCell(42);
  try {
    cXSLX_nw_cell.setCellFormula("[alt.xlsx]Sheet1!$A$1");
    fail("New workbook not linked, shouldn't be able to add");
  }
 catch (  Exception e) {
  }
  Workbook alt=new XSSFWorkbook();
  try {
    alt.createSheet().createRow(0).createCell(0).setCellValue("In another workbook");
  }
  finally {
    alt.close();
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaParser </h4><pre class="type-2 type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void basicParsing(){
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"ABC10");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"A500000");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"ABC500000");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"XFD1048576");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  try {
    ptgs=parse(fpb,"XFE10");
    fail("expected exception");
  }
 catch (  FormulaParseException e) {
    assertEquals("Specified named range 'XFE10' does not exist in the current workbook.",e.getMessage());
  }
  try {
    ptgs=parse(fpb,"XFD1048577");
    fail("expected exception");
  }
 catch (  FormulaParseException e) {
    assertEquals("Specified named range 'XFD1048577' does not exist in the current workbook.",e.getMessage());
  }
  ptgs=parse(fpb,"ISEVEN(A1)");
  assertEquals(3,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(RefPtg.class,ptgs[1].getClass());
  assertEquals(FuncVarPtg.class,ptgs[2].getClass());
  assertEquals("ISEVEN",ptgs[0].toFormulaString());
  assertEquals("A1",ptgs[1].toFormulaString());
  assertEquals("#external#",ptgs[2].toFormulaString());
  ptgs=parse(fpb,"SUM(A1:B3)");
  assertEquals(2,ptgs.length);
  assertEquals(AreaPtg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("A1:B3",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
  ptgs=parse(fpb,"SUM(Sheet1!A1)");
  assertEquals(2,ptgs.length);
  assertEquals(Ref3DPxg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("Sheet1!A1",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
  ptgs=parse(fpb,"SUM(Sheet1!A1:B3)");
  assertEquals(2,ptgs.length);
  assertEquals(Area3DPxg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("Sheet1!A1:B3",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFHyperlink </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidURLs() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  XSSFCreationHelper createHelper=workbook.getCreationHelper();
  String[] invalidURLs={"http:\\apache.org","www.apache .org","c:\\temp","\\poi"};
  for (  String s : invalidURLs) {
    try {
      createHelper.createHyperlink(Hyperlink.LINK_URL).setAddress(s);
      fail("expected IllegalArgumentException: " + s);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheet </h4><pre class="type-10 type-1 type-3 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * bug 58885: checking for overlapping merged regions when
 * adding a merged region is safe, but runs in O(n).
 * the check for merged regions when adding a merged region
 * can be skipped (unsafe) and run in O(1).
 */
@Test public void addMergedRegionUnsafe() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sh=wb.createSheet();
  CellRangeAddress region1=CellRangeAddress.valueOf("A1:B2");
  CellRangeAddress region2=CellRangeAddress.valueOf("B2:C3");
  CellRangeAddress region3=CellRangeAddress.valueOf("C3:D4");
  CellRangeAddress region4=CellRangeAddress.valueOf("J10:K11");
  assumeTrue(region1.intersects(region2));
  assumeTrue(region2.intersects(region3));
  sh.addMergedRegionUnsafe(region1);
  assertTrue(sh.getMergedRegions().contains(region1));
  sh.addMergedRegionUnsafe(region2);
  assertTrue(sh.getMergedRegions().contains(region2));
  try {
    sh.addMergedRegion(region3);
    fail("Expected IllegalStateException. region3 overlaps already added merged region2.");
  }
 catch (  final IllegalStateException e) {
    assertFalse(sh.getMergedRegions().contains(region3));
  }
  sh.addMergedRegion(region4);
  try {
    sh.validateMergedRegions();
    fail("Expected validation to fail. Sheet contains merged regions A1:B2 and B2:C3, which overlap at B2.");
  }
 catch (  final IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheetShiftRows </h4><pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveSheetAndAdjustActiveSheet() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("57171_57163_57165.xlsx");
  assertEquals(5,wb.getActiveSheetIndex());
  wb.removeSheetAt(0);
  assertEquals(4,wb.getActiveSheetIndex());
  wb.setActiveSheet(3);
  assertEquals(3,wb.getActiveSheetIndex());
  wb.removeSheetAt(4);
  assertEquals(3,wb.getActiveSheetIndex());
  wb.removeSheetAt(3);
  assertEquals(2,wb.getActiveSheetIndex());
  wb.removeSheetAt(0);
  assertEquals(1,wb.getActiveSheetIndex());
  wb.removeSheetAt(1);
  assertEquals(0,wb.getActiveSheetIndex());
  wb.removeSheetAt(0);
  assertEquals(0,wb.getActiveSheetIndex());
  try {
    wb.removeSheetAt(0);
    fail("Should catch exception as no more sheets are there");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(0,wb.getActiveSheetIndex());
  wb.createSheet();
  assertEquals(0,wb.getActiveSheetIndex());
  wb.removeSheetAt(0);
  assertEquals(0,wb.getActiveSheetIndex());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFTextRun </h4><pre class="type-2 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXSSFTextParagraph() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
    XSSFTextParagraph para=shape.addNewTextParagraph();
    para.addNewTextRun().setText("Line 1");
    List<XSSFTextRun> runs=para.getTextRuns();
    assertEquals(1,runs.size());
    XSSFTextRun run=runs.get(0);
    assertEquals("Line 1",run.getText());
    assertNotNull(run.getParentParagraph());
    assertNotNull(run.getXmlObject());
    assertNotNull(run.getRPr());
    assertEquals(new Color(0,0,0),run.getFontColor());
    Color color=new Color(0,255,255);
    run.setFontColor(color);
    assertEquals(color,run.getFontColor());
    assertEquals(11.0,run.getFontSize(),0.01);
    run.setFontSize(12.32);
    assertEquals(12.32,run.getFontSize(),0.01);
    run.setFontSize(-1.0);
    assertEquals(11.0,run.getFontSize(),0.01);
    run.setFontSize(-1.0);
    assertEquals(11.0,run.getFontSize(),0.01);
    try {
      run.setFontSize(0.9);
      fail("Should fail");
    }
 catch (    IllegalArgumentException e) {
      assertTrue(e.getMessage().contains("0.9"));
    }
    assertEquals(11.0,run.getFontSize(),0.01);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(12.31);
    assertEquals(12.31,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(0.0);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(0.0);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    assertEquals("Calibri",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)-1,(byte)1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)-1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)1,true);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily(null,(byte)1,(byte)1,false);
    assertEquals("Calibri",run.getFontFamily());
    run.setFontFamily(null,(byte)1,(byte)1,false);
    assertEquals("Calibri",run.getFontFamily());
    run.setFont("Arial");
    assertEquals("Arial",run.getFontFamily());
    assertEquals((byte)0,run.getPitchAndFamily());
    run.setFont(null);
    assertEquals((byte)0,run.getPitchAndFamily());
    assertFalse(run.isStrikethrough());
    run.setStrikethrough(true);
    assertTrue(run.isStrikethrough());
    run.setStrikethrough(false);
    assertFalse(run.isStrikethrough());
    assertFalse(run.isSuperscript());
    run.setSuperscript(true);
    assertTrue(run.isSuperscript());
    run.setSuperscript(false);
    assertFalse(run.isSuperscript());
    assertFalse(run.isSubscript());
    run.setSubscript(true);
    assertTrue(run.isSubscript());
    run.setSubscript(false);
    assertFalse(run.isSubscript());
    assertEquals(TextCap.NONE,run.getTextCap());
    assertFalse(run.isBold());
    run.setBold(true);
    assertTrue(run.isBold());
    run.setBold(false);
    assertFalse(run.isBold());
    assertFalse(run.isItalic());
    run.setItalic(true);
    assertTrue(run.isItalic());
    run.setItalic(false);
    assertFalse(run.isItalic());
    assertFalse(run.isUnderline());
    run.setUnderline(true);
    assertTrue(run.isUnderline());
    run.setUnderline(false);
    assertFalse(run.isUnderline());
    assertNotNull(run.toString());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFWorkbook </h4><pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with the count of the number of styles
 * coming out wrong
 */
@Test public void bug49702() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  assertEquals(1,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  try {
    wb1.getCellStyleAt((short)1);
    fail("Shouldn't be able to get style at 1 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  CellStyle cs=wb1.createCellStyle();
  cs.setDataFormat((short)11);
  assertEquals(2,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  wb1.getCellStyleAt((short)1);
  try {
    wb1.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(2,nwb.getNumCellStyles());
  nwb.getCellStyleAt((short)0);
  nwb.getCellStyleAt((short)1);
  try {
    nwb.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.openSampleWorkbook("sample.xlsx");
  assertEquals(3,wb2.getNumCellStyles());
  wb2.getCellStyleAt((short)0);
  wb2.getCellStyleAt((short)1);
  wb2.getCellStyleAt((short)2);
  try {
    wb2.getCellStyleAt((short)3);
    fail("Shouldn't be able to get style at 3 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  wb2.close();
  wb1.close();
  nwb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestXWPFDocument </h4><pre class="type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllPictures() throws IOException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("issue_51265_3.docx");
  List<XWPFPictureData> allPictures=doc.getAllPictures();
  List<XWPFPictureData> allPackagePictures=doc.getAllPackagePictures();
  assertNotNull(allPictures);
  assertEquals(3,allPictures.size());
  for (  XWPFPictureData xwpfPictureData : allPictures) {
    assertTrue(allPackagePictures.contains(xwpfPictureData));
  }
  try {
    allPictures.add(allPictures.get(0));
    fail("This list must be unmodifiable!");
  }
 catch (  UnsupportedOperationException e) {
  }
  doc.getPackage().revert();
  doc.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllPackagePictures() throws IOException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("issue_51265_3.docx");
  List<XWPFPictureData> allPackagePictures=doc.getAllPackagePictures();
  assertNotNull(allPackagePictures);
  assertEquals(5,allPackagePictures.size());
  try {
    allPackagePictures.add(allPackagePictures.get(0));
    fail("This list must be unmodifiable!");
  }
 catch (  UnsupportedOperationException e) {
  }
  doc.getPackage().revert();
  doc.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
