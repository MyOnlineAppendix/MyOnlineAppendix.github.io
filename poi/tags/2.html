<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.poi.TestAllFiles </h4><pre class="type-2 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllFiles() throws Exception {
  assertNotNull("Unknown file extension for file: " + file + ": "+ getExtension(file),handler);
  File inputFile=new File(ROOT_DIR,file);
  try {
    InputStream stream=new BufferedInputStream(new FileInputStream(inputFile),64 * 1024);
    try {
      handler.handleFile(stream);
      assertFalse("Expected to fail for file " + file + " and handler "+ handler+ ", but did not fail!",OLD_FILES.contains(file));
    }
  finally {
      stream.close();
    }
    handler.handleExtracting(inputFile);
    boolean ignoredOPC=(file.endsWith(".docx") || file.endsWith(".xlsx") || file.endsWith(".xlsb")) && handler instanceof OPCFileHandler;
    assertFalse("Expected to fail for file " + file + " and handler "+ handler+ ", but did not fail!",EXPECTED_FAILURES.contains(file) && !ignoredOPC);
  }
 catch (  OldWordFileFormatException e) {
    if (OLD_FILES.contains(file)) {
      handler.handleExtracting(inputFile);
    }
 else {
      if (!EXPECTED_FAILURES.contains(file) && !AbstractFileHandler.EXPECTED_EXTRACTOR_FAILURES.contains(file)) {
        System.out.println("Failed: " + file);
        throw new Exception("While handling " + file,e);
      }
    }
  }
catch (  Exception e) {
    if (!EXPECTED_FAILURES.contains(file) && !AbstractFileHandler.EXPECTED_EXTRACTOR_FAILURES.contains(file)) {
      System.out.println("Failed: " + file);
      throw new Exception("While handling " + file,e);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.TestPOIDocumentMain </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createNewPropertiesOnExistingFile() throws IOException {
  POIDocument doc=new HSSFWorkbook();
  assertNull(doc.getSummaryInformation());
  assertNull(doc.getDocumentSummaryInformation());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  doc.write(baos);
  ((HSSFWorkbook)doc).close();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  doc=new HSSFWorkbook(bais);
  assertNull(doc.getSummaryInformation());
  assertNull(doc.getDocumentSummaryInformation());
  doc.createInformationProperties();
  doc.getSummaryInformation().setAuthor("POI Testing");
  doc.getDocumentSummaryInformation().setCompany("ASF");
  baos=new ByteArrayOutputStream();
  doc.write(baos);
  ((HSSFWorkbook)doc).close();
  bais=new ByteArrayInputStream(baos.toByteArray());
  doc=new HSSFWorkbook(bais);
  assertNotNull(doc.getSummaryInformation());
  assertNotNull(doc.getDocumentSummaryInformation());
  assertEquals("POI Testing",doc.getSummaryInformation().getAuthor());
  assertEquals("ASF",doc.getDocumentSummaryInformation().getCompany());
  doc.createInformationProperties();
  assertNotNull(doc.getSummaryInformation());
  assertNotNull(doc.getDocumentSummaryInformation());
  assertEquals("POI Testing",doc.getSummaryInformation().getAuthor());
  assertEquals("ASF",doc.getDocumentSummaryInformation().getCompany());
  ((HSSFWorkbook)doc).close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void createNewProperties() throws IOException {
  POIDocument doc=new HSSFWorkbook();
  assertNull(doc.getSummaryInformation());
  assertNull(doc.getDocumentSummaryInformation());
  doc.createInformationProperties();
  assertNotNull(doc.getSummaryInformation());
  assertNotNull(doc.getDocumentSummaryInformation());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  doc.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  ((HSSFWorkbook)doc).close();
  doc=new HSSFWorkbook(bais);
  assertNotNull(doc.getSummaryInformation());
  assertNotNull(doc.getDocumentSummaryInformation());
  ((HSSFWorkbook)doc).close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.TestPOIXMLProperties </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWorkbookExtendedProperties() throws Exception {
  XSSFWorkbook workbook=new XSSFWorkbook();
  POIXMLProperties props=workbook.getProperties();
  assertNotNull(props);
  org.apache.poi.POIXMLProperties.ExtendedProperties properties=props.getExtendedProperties();
  org.openxmlformats.schemas.officeDocument.x2006.extendedProperties.CTProperties ctProps=properties.getUnderlyingProperties();
  String appVersion="3.5 beta";
  String application="POI";
  ctProps.setApplication(application);
  ctProps.setAppVersion(appVersion);
  ctProps=null;
  properties=null;
  props=null;
  XSSFWorkbook newWorkbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  workbook.close();
  assertTrue(workbook != newWorkbook);
  POIXMLProperties newProps=newWorkbook.getProperties();
  assertNotNull(newProps);
  org.apache.poi.POIXMLProperties.ExtendedProperties newProperties=newProps.getExtendedProperties();
  assertEquals(application,newProperties.getApplication());
  assertEquals(appVersion,newProperties.getAppVersion());
  org.openxmlformats.schemas.officeDocument.x2006.extendedProperties.CTProperties newCtProps=newProperties.getUnderlyingProperties();
  assertEquals(application,newCtProps.getApplication());
  assertEquals(appVersion,newCtProps.getAppVersion());
  newWorkbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ddf.TestEscherDump </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWithSamplefile() throws Exception {
  byte[] data=POIDataSamples.getDDFInstance().readFile("Container.dat");
  new EscherDump().dump(data.length,data,new NullPrinterStream());
  data=new byte[2586114];
  InputStream stream=HSSFTestDataSamples.openSampleFileStream("44593.xls");
  try {
    int bytes=IOUtils.readFully(stream,data);
    assertTrue(bytes != -1);
  }
  finally {
    stream.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.extractor.TestExtractorFactory </h4><pre class="type-2 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreferEventBased() throws Exception {
  assertFalse(ExtractorFactory.getPreferEventExtractor());
  assertFalse(ExtractorFactory.getThreadPrefersEventExtractors());
  assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
  ExtractorFactory.setThreadPrefersEventExtractors(true);
  assertTrue(ExtractorFactory.getPreferEventExtractor());
  assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
  assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
  ExtractorFactory.setAllThreadsPreferEventExtractors(false);
  assertFalse(ExtractorFactory.getPreferEventExtractor());
  assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
  assertEquals(Boolean.FALSE,ExtractorFactory.getAllThreadsPreferEventExtractors());
  ExtractorFactory.setAllThreadsPreferEventExtractors(null);
  assertTrue(ExtractorFactory.getPreferEventExtractor());
  assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
  assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
  POITextExtractor extractor=ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)));
  assertTrue(extractor instanceof EventBasedExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString(),PackageAccess.READ));
  assertTrue(extractor instanceof XSSFEventBasedExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString(),PackageAccess.READ));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  ExtractorFactory.setThreadPrefersEventExtractors(false);
  assertFalse(ExtractorFactory.getPreferEventExtractor());
  assertFalse(ExtractorFactory.getThreadPrefersEventExtractors());
  assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
  extractor=ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)));
  assertTrue(extractor instanceof ExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString(),PackageAccess.READ));
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString()));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test embeded docs text extraction. For now, only
 * does poifs embeded, but will do ooxml ones 
 * at some point.
 */
@Test public void testEmbeded() throws Exception {
  POIOLE2TextExtractor ext;
  POITextExtractor[] embeds;
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(xls);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  assertEquals(0,embeds.length);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(xlsEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  assertEquals(6,embeds.length);
  int numWord=0, numXls=0, numPpt=0, numMsg=0, numWordX;
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(2,numPpt);
  assertEquals(2,numXls);
  assertEquals(2,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(docEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(4,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(1,numPpt);
  assertEquals(2,numXls);
  assertEquals(1,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(POIOLE2TextExtractor)ExtractorFactory.createExtractor(docEmbOOXML);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  numWordX=0;
  assertEquals(3,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
 else     if (embeds[i] instanceof XWPFWordExtractor)     numWordX++;
  }
  assertEquals(1,numPpt);
  assertEquals(1,numXls);
  assertEquals(0,numWord);
  assertEquals(1,numWordX);
  assertEquals(0,numMsg);
  ext.close();
  ext=(OutlookTextExtactor)ExtractorFactory.createExtractor(msgEmb);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(1,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(0,numPpt);
  assertEquals(0,numXls);
  assertEquals(1,numWord);
  assertEquals(0,numMsg);
  ext.close();
  ext=(OutlookTextExtactor)ExtractorFactory.createExtractor(msgEmbMsg);
  embeds=ExtractorFactory.getEmbededDocsTextExtractors(ext);
  numWord=0;
  numXls=0;
  numPpt=0;
  numMsg=0;
  assertEquals(1,embeds.length);
  for (int i=0; i < embeds.length; i++) {
    assertTrue(embeds[i].getText().length() > 20);
    if (embeds[i] instanceof PowerPointExtractor)     numPpt++;
 else     if (embeds[i] instanceof ExcelExtractor)     numXls++;
 else     if (embeds[i] instanceof WordExtractor)     numWord++;
 else     if (embeds[i] instanceof OutlookTextExtactor)     numMsg++;
  }
  assertEquals(0,numPpt);
  assertEquals(0,numXls);
  assertEquals(0,numWord);
  assertEquals(1,numMsg);
  ext.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPackage() throws Exception {
  POIXMLTextExtractor extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString(),PackageAccess.READ));
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString()));
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(docx.toString()));
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(docx.toString()));
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(pptx.toString()));
  assertTrue(extractor instanceof XSLFPowerPointExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(pptx.toString()));
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(OPCPackage.open(vsdx.toString()));
  assertTrue(extractor instanceof XDGFVisioExtractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  try {
    ExtractorFactory.createExtractor(OPCPackage.open(txt.toString()));
    fail();
  }
 catch (  InvalidOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFile() throws Exception {
  POITextExtractor xlsExtractor=ExtractorFactory.createExtractor(xls);
  assertNotNull("Had empty extractor for " + xls,xlsExtractor);
  assertTrue("Expected instanceof ExcelExtractor, but had: " + xlsExtractor.getClass(),xlsExtractor instanceof ExcelExtractor);
  assertTrue(xlsExtractor.getText().length() > 200);
  xlsExtractor.close();
  POITextExtractor extractor=ExtractorFactory.createExtractor(xlsx);
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xlsx);
  assertTrue(extractor.getText().length() > 200);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xltx);
  assertTrue(extractor instanceof XSSFExcelExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(xltx);
  assertTrue(extractor.getText().contains("test"));
  extractor.close();
  try {
    extractor=ExtractorFactory.createExtractor(xlsxStrict);
    fail("OOXML-Strict isn't yet supported");
  }
 catch (  POIXMLException e) {
  }
  extractor=ExtractorFactory.createExtractor(doc);
  assertTrue(extractor instanceof WordExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(doc6);
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(doc95);
  assertTrue(extractor instanceof Word6Extractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(docx);
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(docx);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(dotx);
  assertTrue(extractor instanceof XWPFWordExtractor);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(dotx);
  assertTrue(extractor.getText().contains("Test"));
  extractor.close();
  extractor=ExtractorFactory.createExtractor(ppt);
  assertTrue(extractor instanceof PowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(pptx);
  assertTrue(extractor instanceof XSLFPowerPointExtractor);
  assertTrue(extractor.getText().length() > 120);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(vsd);
  assertTrue(extractor instanceof VisioTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(vsdx);
  assertTrue(extractor instanceof XDGFVisioExtractor);
  assertTrue(extractor.getText().length() > 20);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(pub);
  assertTrue(extractor instanceof PublisherTextExtractor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  extractor=ExtractorFactory.createExtractor(msg);
  assertTrue(extractor instanceof OutlookTextExtactor);
  assertTrue(extractor.getText().length() > 50);
  extractor.close();
  try {
    ExtractorFactory.createExtractor(txt);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hdgf.chunks.TestChunks </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChunkHeaderA() throws Exception {
  ChunkHeader h=ChunkHeader.createChunkHeader(11,data_a,0);
  assertTrue(h instanceof ChunkHeaderV11);
  ChunkHeaderV11 header=(ChunkHeaderV11)h;
  assertEquals(70,header.getType());
  assertEquals(-1,header.getId());
  assertEquals(2,header.getUnknown1());
  assertEquals(68,header.getLength());
  assertEquals(0,header.getUnknown2());
  assertEquals(0,header.getUnknown3());
  assertTrue(header.hasTrailer());
  assertTrue(header.hasSeparator());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChunkHeaderB() throws Exception {
  ChunkHeader h=ChunkHeader.createChunkHeader(11,data_b,0);
  assertTrue(h instanceof ChunkHeaderV11);
  ChunkHeaderV11 header=(ChunkHeaderV11)h;
  assertEquals(70,header.getType());
  assertEquals(-1,header.getId());
  assertEquals(3,header.getUnknown1());
  assertEquals(68,header.getLength());
  assertEquals(0,header.getUnknown2());
  assertEquals(0,header.getUnknown3());
  assertTrue(header.hasTrailer());
  assertTrue(header.hasSeparator());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestBasic </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests the {@link Section} methods. The test file has two
 * property sets: the first one is a {@link SummaryInformation},
 * the second one is a {@link DocumentSummaryInformation}.</p>
 * @exception IOException if an I/O exception occurs
 * @exception HPSFException if any HPSF exception occurs
 */
@Test public void testSectionMethods() throws IOException, HPSFException {
  final SummaryInformation si=(SummaryInformation)PropertySetFactory.create(new ByteArrayInputStream(poiFiles[0].getBytes()));
  final List<Section> sections=si.getSections();
  final Section s=sections.get(0);
  assertTrue(org.apache.poi.hpsf.Util.equal(s.getFormatID().getBytes(),SectionIDMap.SUMMARY_INFORMATION_ID));
  assertNotNull(s.getProperties());
  assertEquals(17,s.getPropertyCount());
  assertEquals("Titel",s.getProperty(2));
  assertEquals(1764,s.getSize());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWrite </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests writing and reading back a proper dictionary.</p>
 * @throws IOException 
 * @throws HPSFException 
 */
@Test public void dictionary() throws IOException, HPSFException {
  final File copy=TempFile.createTempFile("Test-HPSF","ole2");
  copy.deleteOnExit();
  final OutputStream out=new FileOutputStream(copy);
  final POIFSFileSystem poiFs=new POIFSFileSystem();
  final MutablePropertySet ps1=new MutablePropertySet();
  final MutableSection s=(MutableSection)ps1.getSections().get(0);
  final Map<Long,String> m=new HashMap<Long,String>(3,1.0f);
  m.put(Long.valueOf(1),"String 1");
  m.put(Long.valueOf(2),"String 2");
  m.put(Long.valueOf(3),"String 3");
  s.setDictionary(m);
  s.setFormatID(SectionIDMap.DOCUMENT_SUMMARY_INFORMATION_ID[0]);
  int codepage=CodePageUtil.CP_UNICODE;
  s.setProperty(PropertyIDMap.PID_CODEPAGE,Variant.VT_I2,Integer.valueOf(codepage));
  poiFs.createDocument(ps1.toInputStream(),"Test");
  poiFs.writeFilesystem(out);
  poiFs.close();
  out.close();
  final POIFile[] psf=Util.readPropertySets(copy);
  assertEquals(1,psf.length);
  final byte[] bytes=psf[0].getBytes();
  final InputStream in=new ByteArrayInputStream(bytes);
  final PropertySet ps2=PropertySetFactory.create(in);
  assertTrue(ps2.isDocumentSummaryInformation());
  assertEquals(ps1,ps2);
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests whether writing 8-bit characters to a Unicode property
 * succeeds.</p>
 */
@Test public void unicodeWrite8Bit(){
  final String TITLE="This is a sample title";
  final MutablePropertySet mps=new MutablePropertySet();
  final MutableSection ms=(MutableSection)mps.getSections().get(0);
  ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_TITLE);
  p.setType(Variant.VT_LPSTR);
  p.setValue(TITLE);
  ms.setProperty(p);
  Throwable t=null;
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    mps.write(out);
    out.close();
    byte[] bytes=out.toByteArray();
    PropertySet psr=new PropertySet(bytes);
    assertTrue(psr.isSummaryInformation());
    Section sr=psr.getSections().get(0);
    String title=(String)sr.getProperty(PropertyIDMap.PID_TITLE);
    assertEquals(TITLE,title);
  }
 catch (  WritingNotSupportedException e) {
    t=e;
  }
catch (  IOException e) {
    t=e;
  }
catch (  NoPropertySetStreamException e) {
    t=e;
  }
  if (t != null)   fail(t.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWriteWellKnown </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <p>This test method test the writing of properties in the well-known
 * property set streams "SummaryInformation" and
 * "DocumentSummaryInformation" by performing the following steps:</p>
 * <ol>
 * <li><p>Read a test document <em>doc1</em> into a POI filesystem.</p></li>
 * <li><p>Read the summary information stream and the document summary
 * information stream from the POI filesystem.</p></li>
 * <li><p>Write all properties supported by HPSF to the summary
 * information (e.g. author, edit date, application name) and to the
 * document summary information (e.g. company, manager).</p></li>
 * <li><p>Write the summary information stream and the document summary
 * information stream to the POI filesystem.</p></li>
 * <li><p>Write the POI filesystem to a (temporary) file <em>doc2</em>
 * and close the latter.</p></li>
 * <li><p>Open <em>doc2</em> for reading and check summary information
 * and document summary information. All properties written before must be
 * found in the property streams of <em>doc2</em> and have the correct
 * values.</p></li>
 * <li><p>Remove all properties supported by HPSF from the summary
 * information (e.g. author, edit date, application name) and from the
 * document summary information (e.g. company, manager).</p></li>
 * <li><p>Write the summary information stream and the document summary
 * information stream to the POI filesystem.</p></li>
 * <li><p>Write the POI filesystem to a (temporary) file <em>doc3</em>
 * and close the latter.</p></li>
 * <li><p>Open <em>doc3</em> for reading and check summary information
 * and document summary information. All properties removed before must not
 * be found in the property streams of <em>doc3</em>.</p></li> </ol>
 * @throws IOException if some I/O error occurred.
 * @throws MarkUnsupportedException
 * @throws NoPropertySetStreamException
 * @throws UnexpectedPropertySetTypeException
 * @throws WritingNotSupportedException
 */
@Test public void testWriteWellKnown() throws Exception {
  POIDataSamples _samples=POIDataSamples.getHPSFInstance();
  final File doc1=TempFile.createTempFile("POI_HPSF_Test1.",".tmp");
  final File doc2=TempFile.createTempFile("POI_HPSF_Test2.",".tmp");
  final File doc3=TempFile.createTempFile("POI_HPSF_Test3.",".tmp");
  FileInputStream fis=new FileInputStream(_samples.getFile(POI_FS));
  FileOutputStream fos=new FileOutputStream(doc1);
  IOUtils.copy(fis,fos);
  fos.close();
  fis.close();
  CustomProperties cps1=write1stFile(doc1,doc2);
  CustomProperties cps2=write2ndFile(doc2,doc3);
  write3rdFile(doc3,null);
  assertEquals(cps1,cps2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.TestReWrite </h4><pre class="type-2 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithMacroStreams() throws IOException {
  assertSlideShowWritesOutTheSame(hssC,pfsC);
  assertNotNull(pfsC.getRoot().getEntry("Macros"));
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hssC.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  POIFSFileSystem pfsNew=new POIFSFileSystem(bais);
  assertFalse(pfsNew.getRoot().hasEntry("Macros"));
  pfsNew.close();
  baos.reset();
  hssC.write(baos,true);
  bais=new ByteArrayInputStream(baos.toByteArray());
  pfsNew=new POIFSFileSystem(bais);
  assertTrue(pfsNew.getRoot().hasEntry("Macros"));
  pfsNew.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.extractor.TestExtractor </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * A powerpoint file with embeded powerpoint files
 */
@SuppressWarnings("unused") @Test public void testExtractFromOwnEmbeded() throws Exception {
  String path="ppt_with_embeded.ppt";
  ppe.close();
  ppe=new PowerPointExtractor(POIDataSamples.getSlideShowInstance().openResourceAsStream(path));
  List<OLEShape> shapes=ppe.getOLEShapes();
  assertEquals("Expected 6 ole shapes in " + path,6,shapes.size());
  int num_ppt=0, num_doc=0, num_xls=0;
  for (  OLEShape ole : shapes) {
    String name=ole.getInstanceName();
    InputStream data=ole.getObjectData().getData();
    if ("Worksheet".equals(name)) {
      HSSFWorkbook wb=new HSSFWorkbook(data);
      num_xls++;
      wb.close();
    }
 else     if ("Document".equals(name)) {
      HWPFDocument doc=new HWPFDocument(data);
      num_doc++;
    }
 else     if ("Presentation".equals(name)) {
      num_ppt++;
      HSLFSlideShow ppt=new HSLFSlideShow(data);
      ppt.close();
    }
    data.close();
  }
  assertEquals("Expected 2 embedded Word Documents",2,num_doc);
  assertEquals("Expected 2 embedded Excel Spreadsheets",2,num_xls);
  assertEquals("Expected 2 embedded PowerPoint Presentations",2,num_ppt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestBackground </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read fill information from an reference ppt file
 */
@Test public void readBackground() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("backgrounds.ppt"));
  HSLFFill fill;
  HSLFShape shape;
  List<HSLFSlide> slide=ppt.getSlides();
  fill=slide.get(0).getBackground().getFill();
  assertEquals(HSLFFill.FILL_PICTURE,fill.getFillType());
  shape=slide.get(0).getShapes().get(0);
  assertEquals(HSLFFill.FILL_SOLID,shape.getFill().getFillType());
  fill=slide.get(1).getBackground().getFill();
  assertEquals(HSLFFill.FILL_PATTERN,fill.getFillType());
  shape=slide.get(1).getShapes().get(0);
  assertEquals(HSLFFill.FILL_BACKGROUND,shape.getFill().getFillType());
  fill=slide.get(2).getBackground().getFill();
  assertEquals(HSLFFill.FILL_TEXTURE,fill.getFillType());
  shape=slide.get(2).getShapes().get(0);
  assertEquals(HSLFFill.FILL_PICTURE,shape.getFill().getFillType());
  fill=slide.get(3).getBackground().getFill();
  assertEquals(HSLFFill.FILL_SHADE_CENTER,fill.getFillType());
  shape=slide.get(3).getShapes().get(0);
  assertEquals(HSLFFill.FILL_SHADE,shape.getFill().getFillType());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Create a ppt with various fill effects
 */
@Test public void backgroundPicture() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide;
  HSLFFill fill;
  HSLFShape shape;
  HSLFPictureData data;
  slide=ppt.createSlide();
  slide.setFollowMasterBackground(false);
  fill=slide.getBackground().getFill();
  data=ppt.addPicture(_slTests.readFile("tomcat.png"),PictureType.PNG);
  fill.setFillType(HSLFFill.FILL_PICTURE);
  fill.setPictureData(data);
  shape=new HSLFAutoShape(ShapeType.RECT);
  shape.setAnchor(new java.awt.Rectangle(100,100,200,200));
  fill=shape.getFill();
  fill.setFillType(HSLFFill.FILL_SOLID);
  slide.addShape(shape);
  slide=ppt.createSlide();
  slide.setFollowMasterBackground(false);
  fill=slide.getBackground().getFill();
  data=ppt.addPicture(_slTests.readFile("tomcat.png"),PictureType.PNG);
  fill.setFillType(HSLFFill.FILL_PATTERN);
  fill.setPictureData(data);
  fill.setBackgroundColor(Color.green);
  fill.setForegroundColor(Color.red);
  shape=new HSLFAutoShape(ShapeType.RECT);
  shape.setAnchor(new java.awt.Rectangle(100,100,200,200));
  fill=shape.getFill();
  fill.setFillType(HSLFFill.FILL_BACKGROUND);
  slide.addShape(shape);
  slide=ppt.createSlide();
  slide.setFollowMasterBackground(false);
  fill=slide.getBackground().getFill();
  data=ppt.addPicture(_slTests.readFile("tomcat.png"),PictureType.PNG);
  fill.setFillType(HSLFFill.FILL_TEXTURE);
  fill.setPictureData(data);
  shape=new HSLFAutoShape(ShapeType.RECT);
  shape.setAnchor(new java.awt.Rectangle(100,100,200,200));
  fill=shape.getFill();
  fill.setFillType(HSLFFill.FILL_PICTURE);
  data=ppt.addPicture(_slTests.readFile("clock.jpg"),PictureType.JPEG);
  fill.setPictureData(data);
  slide.addShape(shape);
  slide=ppt.createSlide();
  slide.setFollowMasterBackground(false);
  fill=slide.getBackground().getFill();
  fill.setFillType(HSLFFill.FILL_SHADE_CENTER);
  fill.setBackgroundColor(Color.white);
  fill.setForegroundColor(Color.darkGray);
  shape=new HSLFAutoShape(ShapeType.RECT);
  shape.setAnchor(new java.awt.Rectangle(100,100,200,200));
  fill=shape.getFill();
  fill.setFillType(HSLFFill.FILL_SHADE);
  fill.setBackgroundColor(Color.red);
  fill.setForegroundColor(Color.green);
  slide.addShape(shape);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFSlide> slides=ppt.getSlides();
  fill=slides.get(0).getBackground().getFill();
  assertEquals(HSLFFill.FILL_PICTURE,fill.getFillType());
  assertEquals(3,getFillPictureRefCount(slides.get(0).getBackground(),fill));
  shape=slides.get(0).getShapes().get(0);
  assertEquals(HSLFFill.FILL_SOLID,shape.getFill().getFillType());
  fill=slides.get(1).getBackground().getFill();
  assertEquals(HSLFFill.FILL_PATTERN,fill.getFillType());
  shape=slides.get(1).getShapes().get(0);
  assertEquals(HSLFFill.FILL_BACKGROUND,shape.getFill().getFillType());
  fill=slides.get(2).getBackground().getFill();
  assertEquals(HSLFFill.FILL_TEXTURE,fill.getFillType());
  assertEquals(3,getFillPictureRefCount(slides.get(2).getBackground(),fill));
  shape=slides.get(2).getShapes().get(0);
  assertEquals(HSLFFill.FILL_PICTURE,shape.getFill().getFillType());
  assertEquals(1,getFillPictureRefCount(shape,fill));
  fill=slides.get(3).getBackground().getFill();
  assertEquals(HSLFFill.FILL_SHADE_CENTER,fill.getFillType());
  shape=slides.get(3).getShapes().get(0);
  assertEquals(HSLFFill.FILL_SHADE,shape.getFill().getFillType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestHeadersFooters </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSlideFooters() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HeadersFooters hdd=ppt.getSlideHeadersFooters();
  hdd.setFootersText("My slide footer");
  hdd.setSlideNumberVisible(true);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  byte[] b=out.toByteArray();
  HSLFSlideShow ppt2=new HSLFSlideShow(new ByteArrayInputStream(b));
  HeadersFooters hdd2=ppt2.getSlideHeadersFooters();
  assertTrue(hdd2.isSlideNumberVisible());
  assertTrue(hdd2.isFooterVisible());
  assertEquals("My slide footer",hdd2.getFooterText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("headers_footers.ppt"));
  HeadersFooters slideHdd=ppt.getSlideHeadersFooters();
  assertTrue(slideHdd.isFooterVisible());
  assertEquals("Global Slide Footer",slideHdd.getFooterText());
  assertTrue(slideHdd.isSlideNumberVisible());
  assertFalse(slideHdd.isHeaderVisible());
  assertNull(slideHdd.getHeaderText());
  assertFalse(slideHdd.isUserDateVisible());
  assertNull(slideHdd.getDateTimeText());
  HeadersFooters notesHdd=ppt.getNotesHeadersFooters();
  assertTrue(notesHdd.isFooterVisible());
  assertEquals("Notes Footer",notesHdd.getFooterText());
  assertTrue(notesHdd.isHeaderVisible());
  assertEquals("Notes Header",notesHdd.getHeaderText());
  assertTrue(notesHdd.isUserDateVisible());
  assertNull(notesHdd.getDateTimeText());
  List<HSLFSlide> slide=ppt.getSlides();
  HeadersFooters hd1=slide.get(0).getHeadersFooters();
  assertEquals(slideHdd.isFooterVisible(),hd1.isFooterVisible());
  assertEquals(slideHdd.getFooterText(),hd1.getFooterText());
  assertEquals(slideHdd.isSlideNumberVisible(),hd1.isSlideNumberVisible());
  assertEquals(slideHdd.isHeaderVisible(),hd1.isHeaderVisible());
  assertEquals(slideHdd.getHeaderText(),hd1.getHeaderText());
  assertEquals(slideHdd.isUserDateVisible(),hd1.isUserDateVisible());
  assertEquals(slideHdd.getDateTimeText(),hd1.getDateTimeText());
  HeadersFooters hd2=slide.get(1).getHeadersFooters();
  assertEquals(true,hd2.isFooterVisible());
  assertEquals("per-slide footer",hd2.getFooterText());
  assertEquals(true,hd2.isUserDateVisible());
  assertEquals("custom date format",hd2.getDateTimeText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test extraction of headers / footers from PPTs saved in Office 2007
 */
@Test public void testRead2007() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("headers_footers_2007.ppt"));
  HeadersFooters slideHdd=ppt.getSlideHeadersFooters();
  assertTrue(slideHdd.isFooterVisible());
  assertEquals("THE FOOTER TEXT",slideHdd.getFooterText());
  assertTrue(slideHdd.isSlideNumberVisible());
  assertFalse(slideHdd.isHeaderVisible());
  assertNull(slideHdd.getHeaderText());
  assertTrue(slideHdd.isUserDateVisible());
  assertEquals("Wednesday, August 06, 2008",slideHdd.getDateTimeText());
  HeadersFooters notesHdd=ppt.getNotesHeadersFooters();
  assertTrue(notesHdd.isFooterVisible());
  assertEquals("THE NOTES FOOTER TEXT",notesHdd.getFooterText());
  assertTrue(notesHdd.isHeaderVisible());
  assertEquals("THE NOTES HEADER TEXT",notesHdd.getHeaderText());
  assertTrue(notesHdd.isUserDateVisible());
  assertTrue(notesHdd.isDateTimeVisible());
  List<HSLFSlide> slide=ppt.getSlides();
  HeadersFooters hd1=slide.get(0).getHeadersFooters();
  assertTrue(hd1.isFooterVisible());
  assertEquals("THE FOOTER TEXT",hd1.getFooterText());
  assertTrue(hd1.isSlideNumberVisible());
  assertFalse(hd1.isHeaderVisible());
  assertNull(hd1.getHeaderText());
  assertTrue(hd1.isUserDateVisible());
  assertTrue(hd1.isDateTimeVisible());
  assertEquals("Wednesday, August 06, 2008",hd1.getDateTimeText());
  HeadersFooters hd2=slide.get(1).getHeadersFooters();
  assertTrue(hd2.isFooterVisible());
  assertEquals("THE FOOTER TEXT FOR SLIDE 2",hd2.getFooterText());
  assertTrue(hd2.isSlideNumberVisible());
  assertFalse(hd2.isHeaderVisible());
  assertNull(hd2.getHeaderText());
  assertTrue(hd2.isUserDateVisible());
  assertTrue(hd2.isDateTimeVisible());
  assertEquals("August 06, 2008",hd2.getDateTimeText());
  HeadersFooters hd3=slide.get(2).getHeadersFooters();
  assertTrue(hd3.isFooterVisible());
  assertEquals("THE FOOTER TEXT",hd3.getFooterText());
  assertTrue(hd3.isSlideNumberVisible());
  assertFalse(hd3.isHeaderVisible());
  assertNull(hd3.getHeaderText());
  assertTrue(hd3.isUserDateVisible());
  assertTrue(hd3.isDateTimeVisible());
  assertEquals("Wednesday, August 06, 2008",hd3.getDateTimeText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNotesFooters() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HeadersFooters hdd=ppt.getNotesHeadersFooters();
  hdd.setFootersText("My notes footer");
  hdd.setHeaderText("My notes header");
  hdd.setSlideNumberVisible(true);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  byte[] b=out.toByteArray();
  HSLFSlideShow ppt2=new HSLFSlideShow(new ByteArrayInputStream(b));
  HeadersFooters hdd2=ppt2.getNotesHeadersFooters();
  assertTrue(hdd2.isSlideNumberVisible());
  assertTrue(hdd2.isFooterVisible());
  assertEquals("My notes footer",hdd2.getFooterText());
  assertTrue(hdd2.isHeaderVisible());
  assertEquals("My notes header",hdd2.getHeaderText());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestHyperlink </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug47291() throws IOException {
  HSLFSlideShow ppt1=new HSLFSlideShow();
  HSLFSlide slide1=ppt1.createSlide();
  HSLFTextRun r1=slide1.createTextBox().setText("page1");
  HSLFHyperlink hl1=r1.createHyperlink();
  hl1.linkToEmail("dev@poi.apache.org");
  HSLFTextRun r2=ppt1.createSlide().createTextBox().setText("page2");
  HSLFHyperlink hl2=r2.createHyperlink();
  hl2.linkToLastSlide();
  HSLFSlide sl1=ppt1.createSlide();
  HSLFTextBox tb1=sl1.createTextBox();
  tb1.setAnchor(new Rectangle2D.Double(100,100,100,100));
  tb1.appendText("text1 ",false);
  HSLFTextRun r3=tb1.appendText("lin\u000bk",false);
  tb1.appendText(" text2",false);
  HSLFHyperlink hl3=r3.createHyperlink();
  hl3.linkToSlide(slide1);
  HSLFTextRun r4=ppt1.createSlide().createTextBox().setText("page4");
  HSLFHyperlink hl4=r4.createHyperlink();
  hl4.linkToUrl("http://poi.apache.org");
  HSLFTextBox tb5=ppt1.createSlide().createTextBox();
  tb5.setText("page5");
  HSLFHyperlink hl5=tb5.createHyperlink();
  hl5.linkToFirstSlide();
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  List<HSLFSlide> slides=ppt2.getSlides();
  tb1=(HSLFTextBox)slides.get(0).getShapes().get(0);
  hl1=tb1.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl1);
  assertEquals("dev@poi.apache.org",hl1.getLabel());
  assertEquals(Hyperlink.LINK_EMAIL,hl1.getType());
  HSLFTextBox tb2=(HSLFTextBox)slides.get(1).getShapes().get(0);
  hl2=tb2.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl2);
  assertEquals(InteractiveInfoAtom.LINK_LastSlide,hl2.getInfo().getInteractiveInfoAtom().getHyperlinkType());
  assertEquals(Hyperlink.LINK_DOCUMENT,hl2.getType());
  HSLFTextBox tb3=(HSLFTextBox)slides.get(2).getShapes().get(0);
  hl3=tb3.getTextParagraphs().get(0).getTextRuns().get(1).getHyperlink();
  assertNotNull(hl3);
  assertEquals(ppt2.getSlides().get(0)._getSheetNumber(),Integer.parseInt(hl3.getAddress().split(",")[0]));
  assertEquals(Hyperlink.LINK_DOCUMENT,hl3.getType());
  HSLFTextBox tb4=(HSLFTextBox)slides.get(3).getShapes().get(0);
  hl4=tb4.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl4);
  assertEquals("http://poi.apache.org",hl4.getLabel());
  assertEquals(Hyperlink.LINK_URL,hl4.getType());
  tb5=(HSLFTextBox)slides.get(4).getShapes().get(0);
  hl5=tb5.getHyperlink();
  assertNotNull(hl5);
  assertEquals(InteractiveInfoAtom.LINK_FirstSlide,hl5.getInfo().getInteractiveInfoAtom().getHyperlinkType());
  assertEquals(Hyperlink.LINK_DOCUMENT,hl5.getType());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextRunHyperlinks() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("WithLinks.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  List<HSLFTextParagraph> para=slide.getTextParagraphs().get(1);
  String rawText=toExternalString(getRawText(para),para.get(0).getRunType());
  String expected="This page has two links:\n" + "http://jakarta.apache.org/poi/\n" + "\n"+ "http://slashdot.org/\n"+ "\n"+ "In addition, its notes has one link";
  assertEquals(expected,rawText);
  List<HSLFHyperlink> links=findHyperlinks(para);
  assertEquals(2,links.size());
  assertEquals("http://jakarta.apache.org/poi/",links.get(0).getLabel());
  assertEquals("http://jakarta.apache.org/poi/",links.get(0).getAddress());
  assertEquals("http://jakarta.apache.org/poi/",rawText.substring(links.get(0).getStartIndex(),links.get(0).getEndIndex() - 1));
  assertEquals("http://slashdot.org/",links.get(1).getLabel());
  assertEquals("http://slashdot.org/",links.get(1).getAddress());
  assertEquals("http://slashdot.org/",rawText.substring(links.get(1).getStartIndex(),links.get(1).getEndIndex() - 1));
  slide=ppt.getSlides().get(1);
  para=slide.getTextParagraphs().get(1);
  rawText=toExternalString(getRawText(para),para.get(0).getRunType());
  expected="I have the one link:\n" + "Jakarta HSSF";
  assertEquals(expected,rawText);
  links.clear();
  links=findHyperlinks(para);
  assertNotNull(links);
  assertEquals(1,links.size());
  assertEquals("Open Jakarta POI HSSF module test  ",links.get(0).getLabel());
  assertEquals("http://jakarta.apache.org/poi/hssf/",links.get(0).getAddress());
  assertEquals("Jakarta HSSF",rawText.substring(links.get(0).getStartIndex(),links.get(0).getEndIndex() - 1));
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestMovieShape </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  String path="/test-movie.mpg";
  int movieIdx=ppt.addMovie(path,MovieShape.MOVIE_MPEG);
  HSLFPictureData thumbnailData=ppt.addPicture(_slTests.readFile("tomcat.png"),PictureType.PNG);
  MovieShape shape=new MovieShape(movieIdx,thumbnailData);
  shape.setAnchor(new Rectangle2D.Double(300,225,120,90));
  slide.addShape(shape);
  assertEquals(path,shape.getPath());
  assertTrue(shape.isAutoPlay());
  shape.setAutoPlay(false);
  assertFalse(shape.isAutoPlay());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  slide=ppt.getSlides().get(0);
  shape=(MovieShape)slide.getShapes().get(0);
  assertEquals(path,shape.getPath());
  assertFalse(shape.isAutoPlay());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestOleEmbedding </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmbedding() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  File pict=POIDataSamples.getSlideShowInstance().getFile("clock.jpg");
  HSLFPictureData pictData=ppt.addPicture(pict,PictureType.JPEG);
  InputStream is=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("Employee.xls");
  POIFSFileSystem poiData1=new POIFSFileSystem(is);
  is.close();
  int oleObjectId1=ppt.addEmbed(poiData1);
  HSLFSlide slide1=ppt.createSlide();
  OLEShape oleShape1=new OLEShape(pictData);
  oleShape1.setObjectID(oleObjectId1);
  slide1.addShape(oleShape1);
  oleShape1.setAnchor(new Rectangle2D.Double(100,100,100,100));
  HSLFSlide slide2=ppt.createSlide();
  OLEShape oleShape2=new OLEShape(pictData);
  is=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("SimpleWithImages.xls");
  POIFSFileSystem poiData2=new POIFSFileSystem(is);
  is.close();
  int oleObjectId2=ppt.addEmbed(poiData2);
  oleShape2.setObjectID(oleObjectId2);
  slide2.addShape(oleShape2);
  oleShape2.setAnchor(new Rectangle2D.Double(100,100,100,100));
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ppt.write(bos);
  ppt=new HSLFSlideShow(new ByteArrayInputStream(bos.toByteArray()));
  OLEShape comp=(OLEShape)ppt.getSlides().get(0).getShapes().get(0);
  byte compData[]=IOUtils.toByteArray(comp.getObjectData().getData());
  bos.reset();
  poiData1.writeFilesystem(bos);
  byte expData[]=bos.toByteArray();
  assertArrayEquals(expData,compData);
  poiData1.close();
  poiData2.close();
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestPPGraphics2D </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGraphics() throws Exception {
  assertTrue(ppt.getSlides().isEmpty());
  HSLFSlide slide=ppt.createSlide();
  assertEquals(1,ppt.getSlides().size());
  HSLFGroupShape group=new HSLFGroupShape();
  Dimension pgsize=ppt.getPageSize();
  java.awt.Rectangle bounds=new java.awt.Rectangle(0,0,(int)pgsize.getWidth(),(int)pgsize.getHeight());
  group.setAnchor(bounds);
  slide.addShape(group);
  PPGraphics2D graphics=new PPGraphics2D(group);
  graphics.setColor(Color.blue);
  graphics.draw(new Rectangle(1296,2544,1344,0));
  graphics.setColor(Color.red);
  graphics.setStroke(new BasicStroke((float)2.5));
  graphics.drawLine(500,500,1500,2500);
  graphics.setColor(Color.green);
  graphics.setPaint(Color.gray);
  graphics.drawOval(4000,1000,1000,1000);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(1,ppt.getSlides().size());
  slide=ppt.getSlides().get(0);
  List<HSLFShape> shape=slide.getShapes();
  assertEquals(shape.size(),1);
  assertTrue(shape.get(0) instanceof HSLFGroupShape);
  group=(HSLFGroupShape)shape.get(0);
  shape=group.getShapes();
  assertEquals(shape.size(),3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestSetBoldItalic </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that we can add TextBox shapes to a slide
 * and set some of the style attributes
 */
@Test public void testTextBoxWrite() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide sl=ppt.createSlide();
  HSLFTextRun rt;
  String val="Hello, World!";
  HSLFTextBox txtbox=new HSLFTextBox();
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  txtbox.setText(val);
  rt.setFontSize(42d);
  rt.setBold(true);
  rt.setItalic(true);
  rt.setUnderlined(false);
  sl.addShape(txtbox);
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals(val,rt.getRawText());
  assertEquals(42,rt.getFontSize(),0);
  assertTrue(rt.isBold());
  assertTrue(rt.isItalic());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  sl=ppt.getSlides().get(0);
  txtbox=(HSLFTextBox)sl.getShapes().get(0);
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals(val,rt.getRawText());
  assertEquals(42,rt.getFontSize(),0);
  assertTrue(rt.isBold());
  assertTrue(rt.isItalic());
  assertFalse(rt.isUnderlined());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestShapes </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test adding shapes to <code>ShapeGroup</code>
 */
@Test public void shapeGroup() throws IOException {
  HSLFSlideShow ss=new HSLFSlideShow();
  HSLFSlide slide=ss.createSlide();
  Dimension pgsize=ss.getPageSize();
  HSLFGroupShape group=new HSLFGroupShape();
  group.setAnchor(new Rectangle2D.Double(0,0,pgsize.getWidth(),pgsize.getHeight()));
  slide.addShape(group);
  HSLFPictureData data=ss.addPicture(_slTests.readFile("clock.jpg"),PictureType.JPEG);
  HSLFPictureShape pict=new HSLFPictureShape(data,group);
  pict.setAnchor(new Rectangle2D.Double(0,0,200,200));
  group.addShape(pict);
  HSLFLine line=new HSLFLine(group);
  line.setAnchor(new Rectangle2D.Double(300,300,500,0));
  group.addShape(line);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ss.write(out);
  out.close();
  ss.close();
  ByteArrayInputStream is=new ByteArrayInputStream(out.toByteArray());
  ss=new HSLFSlideShow(is);
  is.close();
  slide=ss.getSlides().get(0);
  List<HSLFShape> shape=slide.getShapes();
  assertEquals(1,shape.size());
  assertTrue(shape.get(0) instanceof HSLFGroupShape);
  group=(HSLFGroupShape)shape.get(0);
  List<HSLFShape> grshape=group.getShapes();
  assertEquals(2,grshape.size());
  assertTrue(grshape.get(0) instanceof HSLFPictureShape);
  assertTrue(grshape.get(1) instanceof HSLFLine);
  pict=(HSLFPictureShape)grshape.get(0);
  assertEquals(new Rectangle2D.Double(0,0,200,200),pict.getAnchor());
  line=(HSLFLine)grshape.get(1);
  assertEquals(new Rectangle2D.Double(300,300,500,0),line.getAnchor());
  ss.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test functionality of Sheet.removeShape(Shape shape)
 */
@Test public void removeShapes() throws IOException {
  String file="with_textbox.ppt";
  HSLFSlideShow ss=new HSLFSlideShow(_slTests.openResourceAsStream(file));
  HSLFSlide sl=ss.getSlides().get(0);
  List<HSLFShape> sh=sl.getShapes();
  assertEquals("expected four shaped in " + file,4,sh.size());
  for (int i=0; i < sh.size(); i++) {
    boolean ok=sl.removeShape(sh.get(i));
    assertTrue("Failed to delete shape #" + i,ok);
  }
  assertEquals("expected 0 shaped in " + file,0,sl.getShapes().size());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ss.write(out);
  out.close();
  ss.close();
  ss=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  sl=ss.getSlides().get(0);
  assertEquals("expected 0 shaped in " + file,0,sl.getShapes().size());
  ss.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void lineWidth(){
  HSLFSimpleShape sh=new HSLFAutoShape(ShapeType.RT_TRIANGLE);
  AbstractEscherOptRecord opt=sh.getEscherOptRecord();
  EscherSimpleProperty prop=HSLFSimpleShape.getEscherProperty(opt,EscherProperties.LINESTYLE__LINEWIDTH);
  assertNull(prop);
  assertEquals(HSLFSimpleShape.DEFAULT_LINE_WIDTH,sh.getLineWidth(),0);
  sh.setLineWidth(1.0);
  prop=HSLFSimpleShape.getEscherProperty(opt,EscherProperties.LINESTYLE__LINEWIDTH);
  assertNotNull(prop);
  assertEquals(1.0,sh.getLineWidth(),0);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void lineColor() throws IOException {
  HSLFSlideShow ss=new HSLFSlideShow(_slTests.openResourceAsStream("51731.ppt"));
  List<HSLFShape> shape=ss.getSlides().get(0).getShapes();
  assertEquals(4,shape.size());
  HSLFTextShape sh1=(HSLFTextShape)shape.get(0);
  assertEquals("Hello Apache POI",sh1.getText());
  assertNull(sh1.getLineColor());
  HSLFTextShape sh2=(HSLFTextShape)shape.get(1);
  assertEquals("Why are you showing this border?",sh2.getText());
  assertNull(sh2.getLineColor());
  HSLFTextShape sh3=(HSLFTextShape)shape.get(2);
  assertEquals("Text in a black border",sh3.getText());
  assertEquals(Color.black,sh3.getLineColor());
  assertEquals(0.75,sh3.getLineWidth(),0);
  HSLFTextShape sh4=(HSLFTextShape)shape.get(3);
  assertEquals("Border width is 5 pt",sh4.getText());
  assertEquals(Color.black,sh4.getLineColor());
  assertEquals(5.0,sh4.getLineWidth(),0);
  ss.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void graphics() throws IOException {
  HSLFSlide slide=ppt.createSlide();
  HSLFLine line=new HSLFLine();
  java.awt.Rectangle lineAnchor=new java.awt.Rectangle(100,200,50,60);
  line.setAnchor(lineAnchor);
  line.setLineWidth(3);
  line.setLineDash(LineDash.DASH);
  line.setLineColor(Color.red);
  slide.addShape(line);
  HSLFAutoShape ellipse=new HSLFAutoShape(ShapeType.ELLIPSE);
  Rectangle2D ellipseAnchor=new Rectangle2D.Double(320,154,55,111);
  ellipse.setAnchor(ellipseAnchor);
  ellipse.setLineWidth(2);
  ellipse.setLineDash(LineDash.SOLID);
  ellipse.setLineColor(Color.green);
  ellipse.setFillColor(Color.lightGray);
  slide.addShape(ellipse);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  HSLFSlideShow ppt2=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  assertEquals(1,ppt2.getSlides().size());
  slide=ppt2.getSlides().get(0);
  List<HSLFShape> shape=slide.getShapes();
  assertEquals(2,shape.size());
  assertTrue(shape.get(0) instanceof HSLFLine);
  assertEquals(lineAnchor,shape.get(0).getAnchor());
  assertTrue(shape.get(1) instanceof HSLFAutoShape);
  assertEquals(ellipseAnchor,shape.get(1).getAnchor());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unused") @Test public void testParagraphs() throws IOException {
  HSLFSlideShow ss=new HSLFSlideShow();
  HSLFSlide slide=ss.createSlide();
  HSLFTextBox shape=new HSLFTextBox();
  HSLFTextRun p1r1=shape.setText("para 1 run 1. ");
  HSLFTextRun p1r2=shape.appendText("para 1 run 2.",false);
  HSLFTextRun p2r1=shape.appendText("para 2 run 1. ",true);
  HSLFTextRun p2r2=shape.appendText("para 2 run 2. ",false);
  p1r1.setFontColor(Color.black);
  p1r2.setFontColor(Color.red);
  p2r1.setFontColor(Color.yellow);
  p2r2.setStrikethrough(true);
  HSLFTextRun p2r3=shape.appendText("para 2 run 3.",false);
  shape.setAnchor(new Rectangle2D.Double(100,100,100,10));
  slide.addShape(shape);
  shape.resizeToFitText();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ss.write(bos);
  ss=new HSLFSlideShow(new ByteArrayInputStream(bos.toByteArray()));
  slide=ss.getSlides().get(0);
  HSLFTextBox tb=(HSLFTextBox)slide.getShapes().get(0);
  List<HSLFTextParagraph> para=tb.getTextParagraphs();
  HSLFTextRun tr=para.get(0).getTextRuns().get(0);
  assertEquals("para 1 run 1. ",tr.getRawText());
  assertTrue(sameColor(Color.black,tr.getFontColor()));
  tr=para.get(0).getTextRuns().get(1);
  assertEquals("para 1 run 2.\r",tr.getRawText());
  assertTrue(sameColor(Color.red,tr.getFontColor()));
  tr=para.get(1).getTextRuns().get(0);
  assertEquals("para 2 run 1. ",tr.getRawText());
  assertTrue(sameColor(Color.yellow,tr.getFontColor()));
  tr=para.get(1).getTextRuns().get(1);
  assertEquals("para 2 run 2. para 2 run 3.",tr.getRawText());
  assertTrue(sameColor(Color.black,tr.getFontColor()));
  assertTrue(tr.isStrikethrough());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that we can add TextBox shapes to a slide
 * and set some of the style attributes
 */
@Test public void textBoxWriteBytes() throws IOException {
  ppt=new HSLFSlideShow();
  HSLFSlide sl=ppt.createSlide();
  HSLFTextRun rt;
  String val="Hello, World!";
  HSLFTextBox txtbox=new HSLFTextBox();
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  txtbox.setText(val);
  rt.setFontFamily("Arial");
  rt.setFontSize(42d);
  rt.setBold(true);
  rt.setItalic(true);
  rt.setUnderlined(false);
  rt.setFontColor(Color.red);
  sl.addShape(txtbox);
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals(val,rt.getRawText());
  assertEquals(42,rt.getFontSize(),0);
  assertTrue(rt.isBold());
  assertTrue(rt.isItalic());
  assertFalse(rt.isUnderlined());
  assertEquals("Arial",rt.getFontFamily());
  assertTrue(sameColor(Color.red,rt.getFontColor()));
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  HSLFSlideShow ppt2=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  sl=ppt2.getSlides().get(0);
  txtbox=(HSLFTextBox)sl.getShapes().get(0);
  rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals(val,rt.getRawText());
  assertEquals(42,rt.getFontSize(),0);
  assertTrue(rt.isBold());
  assertTrue(rt.isItalic());
  assertFalse(rt.isUnderlined());
  assertEquals("Arial",rt.getFontFamily());
  assertTrue(sameColor(Color.red,rt.getFontColor()));
  ppt2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestSlideMaster </h4><pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Slide 3 has title layout and follows the TitleMaster. Verify that.
 */
@Test public void testTitleMaster() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  HSLFSlide slide=ppt.getSlides().get(2);
  HSLFMasterSheet masterSheet=slide.getMasterSheet();
  assertTrue(masterSheet instanceof HSLFTitleMaster);
  for (  List<HSLFTextParagraph> txt : slide.getTextParagraphs()) {
    HSLFTextRun rt=txt.get(0).getTextRuns().get(0);
switch (txt.get(0).getRunType()) {
case TextHeaderAtom.CENTER_TITLE_TYPE:
      assertEquals("Arial",rt.getFontFamily());
    assertEquals(32,rt.getFontSize(),0);
  assertEquals(true,rt.isBold());
assertEquals(true,rt.isUnderlined());
break;
case TextHeaderAtom.CENTRE_BODY_TYPE:
assertEquals("Courier New",rt.getFontFamily());
assertEquals(20,rt.getFontSize(),0);
assertEquals(true,rt.isBold());
assertEquals(false,rt.isUnderlined());
break;
}
}
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * The reference ppt has two masters.
 * Check we can read their attributes.
 */
@Test public void testSlideMaster() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  Environment env=ppt.getDocumentRecord().getEnvironment();
  List<HSLFSlideMaster> master=ppt.getSlideMasters();
  assertEquals(2,master.size());
  assertEquals(40,master.get(0).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"font.size",true).getValue());
  assertEquals(48,master.get(1).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"font.size",true).getValue());
  int font1=master.get(0).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"font.index",true).getValue();
  int font2=master.get(1).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"font.index",true).getValue();
  assertEquals("Arial",env.getFontCollection().getFontWithId(font1));
  assertEquals("Georgia",env.getFontCollection().getFontWithId(font2));
  CharFlagsTextProp prop1=(CharFlagsTextProp)master.get(0).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"char_flags",true);
  assertEquals(false,prop1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(false,prop1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(true,prop1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  CharFlagsTextProp prop2=(CharFlagsTextProp)master.get(1).getStyleAttribute(TextHeaderAtom.TITLE_TYPE,0,"char_flags",true);
  assertEquals(false,prop2.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(true,prop2.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,prop2.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  assertEquals(0x266B,master.get(0).getStyleAttribute(TextHeaderAtom.BODY_TYPE,0,"bullet.char",false).getValue());
  assertEquals(0x2022,master.get(1).getStyleAttribute(TextHeaderAtom.BODY_TYPE,0,"bullet.char",false).getValue());
  int b1=master.get(0).getStyleAttribute(TextHeaderAtom.BODY_TYPE,0,"bullet.font",false).getValue();
  int b2=master.get(1).getStyleAttribute(TextHeaderAtom.BODY_TYPE,0,"bullet.font",false).getValue();
  assertEquals("Arial",env.getFontCollection().getFontWithId(b1));
  assertEquals("Georgia",env.getFontCollection().getFontWithId(b2));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check we can dynamically assign a slide master to a slide.
 */
@Test public void testChangeSlideMaster() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  List<HSLFSlideMaster> master=ppt.getSlideMasters();
  List<HSLFSlide> slide=ppt.getSlides();
  int sheetNo;
  assertEquals(slide.get(0).getMasterSheet()._getSheetNumber(),master.get(0)._getSheetNumber());
  assertEquals(slide.get(1).getMasterSheet()._getSheetNumber(),master.get(1)._getSheetNumber());
  sheetNo=master.get(0)._getSheetNumber();
  for (  HSLFSlide s : slide) {
    s.setMasterSheet(master.get(0));
  }
  ByteArrayOutputStream out;
  out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  master=ppt.getSlideMasters();
  slide=ppt.getSlides();
  for (  HSLFSlide s : slide) {
    assertEquals(sheetNo,s.getMasterSheet()._getSheetNumber());
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test we can read default text attributes for a title master sheet
 */
@Test public void testTitleMasterTextAttributes() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  List<HSLFTitleMaster> master=ppt.getTitleMasters();
  assertEquals(1,master.size());
  assertEquals(32,master.get(0).getStyleAttribute(TextHeaderAtom.CENTER_TITLE_TYPE,0,"font.size",true).getValue());
  CharFlagsTextProp prop1=(CharFlagsTextProp)master.get(0).getStyleAttribute(TextHeaderAtom.CENTER_TITLE_TYPE,0,"char_flags",true);
  assertEquals(true,prop1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(false,prop1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(true,prop1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  assertEquals(20,master.get(0).getStyleAttribute(TextHeaderAtom.CENTRE_BODY_TYPE,0,"font.size",true).getValue());
  CharFlagsTextProp prop2=(CharFlagsTextProp)master.get(0).getStyleAttribute(TextHeaderAtom.CENTRE_BODY_TYPE,0,"char_flags",true);
  assertEquals(true,prop2.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(false,prop2.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,prop2.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * If a style attribute is not set ensure it is read from the master
 */
@Test public void testMasterAttributes() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  List<HSLFSlide> slide=ppt.getSlides();
  assertEquals(3,slide.size());
  for (  List<HSLFTextParagraph> tparas : slide.get(0).getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(40,rt.getFontSize(),0);
      assertEquals(true,rt.isUnderlined());
      assertEquals("Arial",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(0,tpara.getIndentLevel());
      assertEquals(32,rt.getFontSize(),0);
      assertEquals("Arial",rt.getFontFamily());
      tpara=tparas.get(1);
      rt=tpara.getTextRuns().get(0);
      assertEquals(1,tpara.getIndentLevel());
      assertEquals(28,rt.getFontSize(),0);
      assertEquals("Arial",rt.getFontFamily());
    }
  }
  ;
  for (  List<HSLFTextParagraph> tparas : slide.get(1).getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(48,rt.getFontSize(),0);
      assertEquals(true,rt.isItalic());
      assertEquals("Georgia",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      HSLFTextRun rt;
      rt=tpara.getTextRuns().get(0);
      assertEquals(0,tpara.getIndentLevel());
      assertEquals(32,rt.getFontSize(),0);
      assertEquals("Courier New",rt.getFontFamily());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Varify we can read attrubutes for different identtation levels.
 * (typical for the "bullted body" placeholder)
 */
@Test public void testIndentation() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  for (  List<HSLFTextParagraph> tparas : slide.getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(40,rt.getFontSize(),0);
      assertEquals(true,rt.isUnderlined());
      assertEquals("Arial",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      int indents[]={32,28,24};
      for (      HSLFTextRun rt : tpara.getTextRuns()) {
        int indent=tpara.getIndentLevel();
        assertEquals(indents[indent],rt.getFontSize(),0);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestSlides </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add 3 slides to an empty ppt
 * @throws Exception
 */
@Test public void testAddSlides3() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(new HSLFSlideShowImpl(TestSlides.class.getResourceAsStream("/org/apache/poi/hslf/data/empty.ppt")));
  assertTrue(ppt.getSlides().isEmpty());
  HSLFSlide s1=ppt.createSlide();
  assertEquals(1,ppt.getSlides().size());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(256,s1._getSheetNumber());
  assertEquals(1,s1.getSlideNumber());
  HSLFSlide s2=ppt.createSlide();
  assertEquals(2,ppt.getSlides().size());
  assertEquals(4,s2._getSheetRefId());
  assertEquals(257,s2._getSheetNumber());
  assertEquals(2,s2.getSlideNumber());
  HSLFSlide s3=ppt.createSlide();
  assertEquals(3,ppt.getSlides().size());
  assertEquals(5,s3._getSheetRefId());
  assertEquals(258,s3._getSheetNumber());
  assertEquals(3,s3.getSlideNumber());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(3,ppt.getSlides().size());
  s1=ppt.getSlides().get(0);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  s2=ppt.getSlides().get(1);
  assertEquals(257,s2._getSheetNumber());
  assertEquals(4,s2._getSheetRefId());
  s3=ppt.getSlides().get(2);
  ;
  assertEquals(3,ppt.getSlides().size());
  assertEquals(258,s3._getSheetNumber());
  assertEquals(5,s3._getSheetRefId());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add 2 slides to an empty ppt
 * @throws Exception
 */
@Test public void testAddSlides2() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(new HSLFSlideShowImpl(TestSlides.class.getResourceAsStream("/org/apache/poi/hslf/data/empty.ppt")));
  assertTrue(ppt.getSlides().isEmpty());
  HSLFSlide s1=ppt.createSlide();
  assertEquals(1,ppt.getSlides().size());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(256,s1._getSheetNumber());
  assertEquals(1,s1.getSlideNumber());
  HSLFSlide s2=ppt.createSlide();
  assertEquals(2,ppt.getSlides().size());
  assertEquals(4,s2._getSheetRefId());
  assertEquals(257,s2._getSheetNumber());
  assertEquals(2,s2.getSlideNumber());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(2,ppt.getSlides().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Add slides to ppt which already has two slides
 */
@Test public void testAddSlides2to3() throws Exception {
  POIDataSamples slTests=POIDataSamples.getSlideShowInstance();
  HSLFSlideShow ppt=new HSLFSlideShow(slTests.openResourceAsStream("basic_test_ppt_file.ppt"));
  assertEquals(2,ppt.getSlides().size());
  HSLFSlide s1=ppt.getSlides().get(0);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(4,s1._getSheetRefId());
  HSLFSlide s2=ppt.getSlides().get(1);
  assertEquals(257,s2._getSheetNumber());
  assertEquals(6,s2._getSheetRefId());
  HSLFSlide s3=ppt.createSlide();
  assertEquals(3,ppt.getSlides().size());
  assertEquals(258,s3._getSheetNumber());
  assertEquals(8,s3._getSheetRefId());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(3,ppt.getSlides().size());
  s1=ppt.getSlides().get(0);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(4,s1._getSheetRefId());
  s2=ppt.getSlides().get(1);
  assertEquals(257,s2._getSheetNumber());
  assertEquals(6,s2._getSheetRefId());
  s3=ppt.getSlides().get(2);
  assertEquals(3,ppt.getSlides().size());
  assertEquals(258,s3._getSheetNumber());
  assertEquals(8,s3._getSheetRefId());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add 1 slide to an empty ppt.
 * @throws Exception
 */
@Test public void testAddSlides1() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(new HSLFSlideShowImpl(TestSlides.class.getResourceAsStream("/org/apache/poi/hslf/data/empty.ppt")));
  assertTrue(ppt.getSlides().isEmpty());
  HSLFSlide s1=ppt.createSlide();
  assertEquals(1,ppt.getSlides().size());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(256,s1._getSheetNumber());
  assertEquals(1,s1.getSlideNumber());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(1,ppt.getSlides().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestTable </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ShapeFactory works properly and returns <code>Table</code>
 */
@Test public void testShapeFactory() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  HSLFTable tbl=slide.createTable(2,5);
  HSLFTableCell cell=tbl.getCell(0,0);
  assertEquals(TextHeaderAtom.OTHER_TYPE,cell.getTextParagraphs().get(0).getRunType());
  HSLFShape tblSh=slide.getShapes().get(0);
  assertTrue(tblSh instanceof HSLFTable);
  HSLFTable tbl2=(HSLFTable)tblSh;
  assertEquals(tbl.getNumberOfColumns(),tbl2.getNumberOfColumns());
  assertEquals(tbl.getNumberOfRows(),tbl2.getNumberOfRows());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt.close();
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  slide=ppt.getSlides().get(0);
  assertTrue(slide.getShapes().get(0) instanceof HSLFTable);
  HSLFTable tbl3=(HSLFTable)slide.getShapes().get(0);
  assertEquals(tbl.getNumberOfColumns(),tbl3.getNumberOfColumns());
  assertEquals(tbl.getNumberOfRows(),tbl3.getNumberOfRows());
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Error constructing Table when rownum=1
 */
@Test public void test45889() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  List<HSLFShape> shapes;
  HSLFTable tbl1=slide.createTable(1,5);
  assertEquals(5,tbl1.getNumberOfColumns());
  assertEquals(1,tbl1.getNumberOfRows());
  shapes=slide.getShapes();
  assertEquals(1,shapes.size());
  HSLFTable tbl2=(HSLFTable)shapes.get(0);
  assertSame(tbl1.getSpContainer(),tbl2.getSpContainer());
  assertEquals(tbl1.getNumberOfColumns(),tbl2.getNumberOfColumns());
  assertEquals(tbl1.getNumberOfRows(),tbl2.getNumberOfRows());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestTextRunReWrite </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritesOutTheSameNonRich() throws Exception {
  assertEquals(1,ss.getSlides().size());
  assertEquals(2,ss.getSlides().get(0).getTextParagraphs().size());
  List<HSLFTextParagraph> tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  List<HSLFTextParagraph> tr2=ss.getSlides().get(0).getTextParagraphs().get(1);
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(179,HSLFTextParagraph.getRawText(tr2).length());
  assertEquals(1,tr1.size());
  assertEquals(30,HSLFTextParagraph.getText(tr1).length());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(31,tr1.get(0).getTextRuns().get(0).getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  HSLFTextParagraph.setText(tr1,HSLFTextParagraph.getRawText(tr1));
  tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(179,HSLFTextParagraph.getRawText(tr2).length());
  assertEquals(1,tr1.size());
  assertEquals(30,HSLFTextParagraph.getText(tr1).length());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(31,tr1.get(0).getTextRuns().get(0).getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ss.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  POIFSFileSystem npfs=new POIFSFileSystem(bais);
  DocumentEntry oProps=(DocumentEntry)pfs.getRoot().getEntry("PowerPoint Document");
  DocumentEntry nProps=(DocumentEntry)npfs.getRoot().getEntry("PowerPoint Document");
  assertEquals(oProps.getSize(),nProps.getSize());
  byte[] _oData=new byte[oProps.getSize()];
  byte[] _nData=new byte[nProps.getSize()];
  pfs.createDocumentInputStream("PowerPoint Document").read(_oData);
  npfs.createDocumentInputStream("PowerPoint Document").read(_nData);
  for (int i=0; i < _oData.length; i++) {
    assertEquals(_oData[i],_nData[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritesOutTheSameRich() throws Exception {
  List<HSLFTextParagraph> tr1=ss.getSlides().get(0).getTextParagraphs().get(0);
  HSLFTextRun rtr1=tr1.get(0).getTextRuns().get(0);
  assertEquals(1,tr1.get(0).getTextRuns().size());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(30,rtr1.getLength());
  assertEquals(30,rtr1.getRawText().length());
  assertEquals(31,rtr1.getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  rtr1.setText(rtr1.getRawText());
  rtr1=tr1.get(0).getTextRuns().get(0);
  assertEquals(1,tr1.get(0).getTextRuns().size());
  assertEquals(30,HSLFTextParagraph.getRawText(tr1).length());
  assertEquals(30,tr1.get(0).getTextRuns().get(0).getRawText().length());
  assertEquals(30,rtr1.getLength());
  assertEquals(30,rtr1.getRawText().length());
  assertEquals(31,rtr1.getCharacterStyle().getCharactersCovered());
  assertEquals(31,tr1.get(0).getParagraphStyle().getCharactersCovered());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ss.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  POIFSFileSystem npfs=new POIFSFileSystem(bais);
  DocumentEntry oProps=(DocumentEntry)pfs.getRoot().getEntry("PowerPoint Document");
  DocumentEntry nProps=(DocumentEntry)npfs.getRoot().getEntry("PowerPoint Document");
  assertEquals(oProps.getSize(),nProps.getSize());
  byte[] _oData=new byte[oProps.getSize()];
  byte[] _nData=new byte[nProps.getSize()];
  pfs.createDocumentInputStream("PowerPoint Document").read(_oData);
  npfs.createDocumentInputStream("PowerPoint Document").read(_nData);
  for (int i=0; i < _oData.length; i++) {
    assertEquals(_oData[i],_nData[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestComment2000 </h4><pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCommentAtomB() throws Exception {
  Comment2000 cb=new Comment2000(data_b,0,data_b.length);
  Comment2000Atom c2b=cb.getComment2000Atom();
  assertEquals(1,c2b.getNumber());
  assertEquals(0x0a,c2b.getXOffset());
  assertEquals(0x0a,c2b.getYOffset());
  Date exp_b=sdf.parse("2006-01-24 22:25:03.725");
  assertEquals(exp_b,c2b.getDate());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWrite() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChange() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  Comment2000 cb=new Comment2000(data_b,0,data_b.length);
  Comment2000 cn=new Comment2000();
  ca.setAuthor("Hogwarts");
  ca.setAuthorInitials("H");
  ca.setText("Comments are fun things to add in, aren't they?");
  cn.setAuthor("Hogwarts");
  cn.setAuthorInitials("H");
  cn.setText("Comments are fun things to add in, aren't they?");
  Comment2000Atom c2a=ca.getComment2000Atom();
  Comment2000Atom c2n=cn.getComment2000Atom();
  c2a.setNumber(1);
  c2a.setXOffset(0x0a);
  c2a.setYOffset(0x0a);
  c2n.setNumber(1);
  c2n.setXOffset(0x0a);
  c2n.setYOffset(0x0a);
  Date new_date=sdf.parse("2006-01-24 22:25:03.725");
  c2a.setDate(new_date);
  c2n.setDate(new_date);
  assertEquals(ca.getText(),cb.getText());
  assertEquals(cn.getText(),cb.getText());
  assertEquals(ca.getAuthor(),cb.getAuthor());
  assertEquals(cn.getAuthor(),cb.getAuthor());
  assertEquals(ca.getAuthorInitials(),cb.getAuthorInitials());
  assertEquals(cn.getAuthorInitials(),cb.getAuthorInitials());
  try {
    for (int i=0; i < data_a.length; i++) {
      assertEquals(data_a[i],data_b[i]);
    }
    fail();
  }
 catch (  Error e) {
  }
  ByteArrayOutputStream baosa=new ByteArrayOutputStream();
  ByteArrayOutputStream baosn=new ByteArrayOutputStream();
  ca.writeOut(baosa);
  cn.writeOut(baosn);
  byte[] ba=baosa.toByteArray();
  byte[] bn=baosn.toByteArray();
  assertEquals(data_b.length,ba.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],ba[i]);
  }
  assertEquals(data_b.length,bn.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],bn[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCommentAtom() throws Exception {
  Comment2000 ca=new Comment2000(data_a,0,data_a.length);
  Comment2000Atom c2a=ca.getComment2000Atom();
  assertEquals(1,c2a.getNumber());
  assertEquals(0x92,c2a.getXOffset());
  assertEquals(0x92,c2a.getYOffset());
  Date exp_a=sdf.parse("2006-01-24 10:26:15.205");
  assertEquals(exp_a,c2a.getDate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestComment2000Atom </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate() throws Exception {
  Comment2000Atom a=new Comment2000Atom();
  a.setNumber(1);
  a.setXOffset(0x92);
  a.setYOffset(0x92);
  Date date_a=sdf.parse("2006-01-24 10:26:15.205");
  a.setDate(date_a);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  a.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testGetDate() throws Exception {
  Comment2000Atom ca=new Comment2000Atom(data_a,0,data_a.length);
  Comment2000Atom cb=new Comment2000Atom(data_b,0,data_b.length);
  Date exp_a=sdf.parse("2006-01-24 10:26:15.205");
  Date exp_b=sdf.parse("2006-01-24 21:25:03.725");
  assertEquals(exp_a,ca.getDate());
  assertEquals(exp_b,cb.getDate());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChange() throws Exception {
  Comment2000Atom ca=new Comment2000Atom(data_a,0,data_a.length);
  ca.setNumber(5);
  Date new_date=sdf.parse("2006-01-24 21:25:03.725");
  ca.setDate(new_date);
  ca.setXOffset(0x0A);
  ca.setYOffset(0x0E);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_b.length,b.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWrite() throws Exception {
  Comment2000Atom ca=new Comment2000Atom(data_a,0,data_a.length);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ca.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestCurrentUserAtom </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeNormal() throws Exception {
  POIFSFileSystem fs=new POIFSFileSystem(_slTests.getFile(normalFile));
  DocumentEntry docProps=(DocumentEntry)fs.getRoot().getEntry("Current User");
  byte[] contents=new byte[docProps.getSize()];
  InputStream in=fs.getRoot().createDocumentInputStream("Current User");
  in.read(contents);
  in.close();
  fs.close();
  CurrentUserAtom cu=new CurrentUserAtom();
  cu.setLastEditUsername("Hogwarts");
  cu.setCurrentEditOffset(0x2942);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  cu.writeOut(baos);
  byte[] out=baos.toByteArray();
  assertArrayEquals(contents,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestDocumentEncryption </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cryptoAPIDecryption() throws Exception {
  Biff8EncryptionKey.setCurrentUserPassword("crypto");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(slTests.getFile("cryptoapi-proc2356.ppt"));
  HSLFSlideShowImpl hss=new HSLFSlideShowImpl(fs);
  HSLFSlideShow ss=new HSLFSlideShow(hss);
  HSLFSlide slide=ss.getSlides().get(0);
  String rawText=HSLFTextParagraph.getRawText(slide.getTextParagraphs().get(0));
  assertEquals("Dominic Salemno",rawText);
  String picCmp[][]={{"0","nKsDTKqxTCR8LFkVVWlP9GSTvZ0="},{"95163","SuNOR+9V1UVYZIoeD65l3VTaLoc="},{"100864","Ql3IGrr4bNq07ZTp5iPg7b+pva8="},{"714114","8pdst9NjBGSfWezSZE8+aVhIRe0="},{"723752","go6xqW7lvkCtlOO5tYLiMfb4oxw="},{"770128","gZUM8YqRNL5kGNfyyYvEEernvCc="},{"957958","CNU2iiqUFAnk3TDXsXV1ihH9eRM="}};
  MessageDigest md=CryptoFunctions.getMessageDigest(HashAlgorithm.sha1);
  List<HSLFPictureData> pd=hss.getPictureData();
  int i=0;
  for (  HSLFPictureData p : pd) {
    byte hash[]=md.digest(p.getData());
    assertEquals(Integer.parseInt(picCmp[i][0]),p.getOffset());
    assertEquals(picCmp[i][1],Base64.encodeBase64String(hash));
    i++;
  }
  DocumentEncryptionAtom dea=hss.getDocumentEncryptionAtom();
  POIFSFileSystem fs2=new POIFSFileSystem(dea.getEncryptionInfo().getDecryptor().getDataStream(fs));
  PropertySet ps=PropertySetFactory.create(fs2.getRoot(),SummaryInformation.DEFAULT_STREAM_NAME);
  assertTrue(ps.isSummaryInformation());
  assertEquals("RC4 CryptoAPI Encryption",ps.getProperties()[1].getValue());
  ps=PropertySetFactory.create(fs2.getRoot(),DocumentSummaryInformation.DEFAULT_STREAM_NAME);
  assertTrue(ps.isDocumentSummaryInformation());
  assertEquals("On-screen Show (4:3)",ps.getProperties()[1].getValue());
  fs.close();
  fs2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void cryptoAPIChangeKeySize() throws Exception {
  String pptFile="cryptoapi-proc2356.ppt";
  Biff8EncryptionKey.setCurrentUserPassword("crypto");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(slTests.getFile(pptFile),true);
  HSLFSlideShowImpl hss=new HSLFSlideShowImpl(fs);
  List<HSLFPictureData> picsExpected=hss.getPictureData();
  hss.getDocumentSummaryInformation();
  EncryptionInfo ei=hss.getDocumentEncryptionAtom().getEncryptionInfo();
  ((CryptoAPIEncryptionHeader)ei.getHeader()).setKeySize(0x78);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  hss.write(bos);
  fs.close();
  fs=new NPOIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  hss=new HSLFSlideShowImpl(fs);
  List<HSLFPictureData> picsActual=hss.getPictureData();
  fs.close();
  assertEquals(picsExpected.size(),picsActual.size());
  for (int i=0; i < picsExpected.size(); i++) {
    assertArrayEquals(picsExpected.get(i).getRawData(),picsActual.get(i).getRawData());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.record.TestStyleTextPropAtom </h4><pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCharacterStyleLengths(){
  StyleTextPropAtom stpa=new StyleTextPropAtom(data_a,0,data_a.length);
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpa.setParentTextSize(data_a_text_len);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> a_ch_l=stpa.getCharacterStyles();
  TextPropCollection a_ch_1=a_ch_l.get(0);
  TextPropCollection a_ch_2=a_ch_l.get(1);
  TextPropCollection a_ch_3=a_ch_l.get(2);
  assertEquals(21,a_ch_1.getCharactersCovered());
  assertEquals(17,a_ch_2.getCharactersCovered());
  assertEquals(16,a_ch_3.getCharactersCovered());
  List<TextPropCollection> b_ch_l=stpb.getCharacterStyles();
  TextPropCollection b_ch_1=b_ch_l.get(0);
  TextPropCollection b_ch_2=b_ch_l.get(1);
  TextPropCollection b_ch_3=b_ch_l.get(2);
  TextPropCollection b_ch_4=b_ch_l.get(3);
  assertEquals(30,b_ch_1.getCharactersCovered());
  assertEquals(28,b_ch_2.getCharactersCovered());
  assertEquals(25,b_ch_3.getCharactersCovered());
  assertEquals(96,b_ch_4.getCharactersCovered());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCharacterPropOrdering(){
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> b_ch_l=stpb.getCharacterStyles();
  TextPropCollection b_ch_1=b_ch_l.get(0);
  TextPropCollection b_ch_2=b_ch_l.get(1);
  TextPropCollection b_ch_3=b_ch_l.get(2);
  TextPropCollection b_ch_4=b_ch_l.get(3);
  assertEquals(2,b_ch_1.getTextPropList().size());
  TextProp tp_1_1=b_ch_1.getTextPropList().get(0);
  TextProp tp_1_2=b_ch_1.getTextPropList().get(1);
  assertEquals(true,tp_1_1 instanceof CharFlagsTextProp);
  assertEquals("font.size",tp_1_2.getName());
  assertEquals(20,tp_1_2.getValue());
  assertEquals(3,b_ch_2.getTextPropList().size());
  TextProp tp_2_1=b_ch_2.getTextPropList().get(0);
  TextProp tp_2_2=b_ch_2.getTextPropList().get(1);
  TextProp tp_2_3=b_ch_2.getTextPropList().get(2);
  assertEquals(true,tp_2_1 instanceof CharFlagsTextProp);
  assertEquals("font.size",tp_2_2.getName());
  assertEquals("font.color",tp_2_3.getName());
  assertEquals(20,tp_2_2.getValue());
  assertEquals(2,b_ch_3.getTextPropList().size());
  TextProp tp_3_1=b_ch_3.getTextPropList().get(0);
  TextProp tp_3_2=b_ch_3.getTextPropList().get(1);
  assertEquals("font.size",tp_3_1.getName());
  assertEquals("font.color",tp_3_2.getName());
  assertEquals(20,tp_3_1.getValue());
  assertEquals(3,b_ch_4.getTextPropList().size());
  TextProp tp_4_1=b_ch_4.getTextPropList().get(0);
  TextProp tp_4_2=b_ch_4.getTextPropList().get(1);
  TextProp tp_4_3=b_ch_4.getTextPropList().get(2);
  assertEquals(true,tp_4_1 instanceof CharFlagsTextProp);
  assertEquals("font.index",tp_4_2.getName());
  assertEquals("font.size",tp_4_3.getName());
  assertEquals(24,tp_4_3.getValue());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Try to recreate an existing StyleTextPropAtom (a) from the empty
 * constructor, and setting the required properties
 */
@Test public void testCreateAFromScatch() throws Exception {
  StyleTextPropAtom stpa=new StyleTextPropAtom(54);
  List<TextPropCollection> cs=stpa.getCharacterStyles();
  TextPropCollection tpca=cs.get(0);
  tpca.updateTextSize(21);
  TextPropCollection tpcb=stpa.addCharacterTextPropCollection(17);
  TextProp tpb=tpcb.addWithName("font.color");
  tpb.setValue(0x05000000);
  TextPropCollection tpcc=stpa.addCharacterTextPropCollection(16);
  TextProp tpc=tpcc.addWithName("font.color");
  tpc.setValue(0xFE0033FF);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  stpa.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_a.length,b.length);
  for (int i=0; i < data_a.length; i++) {
    assertEquals(data_a[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharacterProps(){
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> b_ch_l=stpb.getCharacterStyles();
  TextPropCollection b_ch_1=b_ch_l.get(0);
  TextPropCollection b_ch_2=b_ch_l.get(1);
  TextPropCollection b_ch_3=b_ch_l.get(2);
  TextPropCollection b_ch_4=b_ch_l.get(3);
  CharFlagsTextProp cf_1_1=(CharFlagsTextProp)b_ch_1.getTextPropList().get(0);
  assertEquals(true,cf_1_1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_1_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_2_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.RELIEF_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.RESET_NUMBERING_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.SHADOW_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.STRIKETHROUGH_IDX));
  assertEquals(false,cf_1_1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  CharFlagsTextProp cf_2_1=(CharFlagsTextProp)b_ch_2.getTextPropList().get(0);
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(true,cf_2_1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_1_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_2_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.RELIEF_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.RESET_NUMBERING_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.SHADOW_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.STRIKETHROUGH_IDX));
  assertEquals(false,cf_2_1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  assertFalse(b_ch_3.getTextPropList().get(0) instanceof CharFlagsTextProp);
  CharFlagsTextProp cf_4_1=(CharFlagsTextProp)b_ch_4.getTextPropList().get(0);
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_1_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_2_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.RELIEF_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.RESET_NUMBERING_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.SHADOW_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.STRIKETHROUGH_IDX));
  assertEquals(true,cf_4_1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  assertEquals(0x0004,cf_4_1.getValue());
  cf_4_1.setSubValue(true,CharFlagsTextProp.BOLD_IDX);
  cf_4_1.setSubValue(true,CharFlagsTextProp.ITALIC_IDX);
  cf_4_1.setSubValue(false,CharFlagsTextProp.UNDERLINE_IDX);
  assertEquals(true,cf_4_1.getSubValue(CharFlagsTextProp.BOLD_IDX));
  assertEquals(true,cf_4_1.getSubValue(CharFlagsTextProp.ITALIC_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_1_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.ENABLE_NUMBERING_2_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.RELIEF_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.RESET_NUMBERING_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.SHADOW_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.STRIKETHROUGH_IDX));
  assertEquals(false,cf_4_1.getSubValue(CharFlagsTextProp.UNDERLINE_IDX));
  assertEquals(0x0003,cf_4_1.getValue());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Try to recreate an existing StyleTextPropAtom (b) from the empty
 * constructor, and setting the required properties
 */
@Test public void testCreateBFromScatch() throws Exception {
  StyleTextPropAtom stpa=new StyleTextPropAtom(data_b_text_len);
  List<TextPropCollection> ps=stpa.getParagraphStyles();
  TextPropCollection tppa=ps.get(0);
  tppa.updateTextSize(30);
  TextProp tp=tppa.addWithName("alignment");
  tp.setValue(0);
  tp=tppa.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppb=stpa.addParagraphTextPropCollection(28);
  tp=tppb.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppc=stpa.addParagraphTextPropCollection(25);
  tp=tppc.addWithName("alignment");
  tp.setValue(2);
  tp=tppc.addWithName("linespacing");
  tp.setValue(80);
  TextPropCollection tppd=stpa.addParagraphTextPropCollection(97);
  tp=tppd.addWithName("alignment");
  tp.setValue(0);
  tp=tppd.addWithName("linespacing");
  tp.setValue(80);
  List<TextPropCollection> cs=stpa.getCharacterStyles();
  TextPropCollection tpca=cs.get(0);
  tpca.updateTextSize(30);
  tp=tpca.addWithName("font.size");
  tp.setValue(20);
  CharFlagsTextProp cftp=(CharFlagsTextProp)tpca.addWithName("char_flags");
  assertEquals(0,cftp.getValue());
  cftp.setSubValue(true,CharFlagsTextProp.BOLD_IDX);
  assertEquals(1,cftp.getValue());
  TextPropCollection tpcb=stpa.addCharacterTextPropCollection(28);
  tp=tpcb.addWithName("font.size");
  tp.setValue(20);
  tp=tpcb.addWithName("font.color");
  tp.setValue(0x05000000);
  cftp=(CharFlagsTextProp)tpcb.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.ITALIC_IDX);
  assertEquals(2,cftp.getValue());
  TextPropCollection tpcc=stpa.addCharacterTextPropCollection(25);
  tp=tpcc.addWithName("font.size");
  tp.setValue(20);
  tp=tpcc.addWithName("font.color");
  tp.setValue(0xfe0033ff);
  TextPropCollection tpcd=stpa.addCharacterTextPropCollection(96);
  tp=tpcd.addWithName("font.size");
  tp.setValue(24);
  tp=tpcd.addWithName("font.index");
  tp.setValue(1);
  cftp=(CharFlagsTextProp)tpcd.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.UNDERLINE_IDX);
  assertEquals(4,cftp.getValue());
  TextPropCollection tpce=stpa.addCharacterTextPropCollection(1);
  tp=tpce.addWithName("font.size");
  tp.setValue(24);
  tp=tpce.addWithName("font.index");
  tp.setValue(1);
  tp=tpce.addWithName("font.color");
  tp.setValue(0xfe0033ff);
  cftp=(CharFlagsTextProp)tpce.addWithName("char_flags");
  cftp.setSubValue(true,CharFlagsTextProp.UNDERLINE_IDX);
  assertEquals(4,cftp.getValue());
  assertEquals(4,stpa.getParagraphStyles().size());
  assertEquals(5,stpa.getCharacterStyles().size());
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> psb=stpb.getParagraphStyles();
  List<TextPropCollection> csb=stpb.getCharacterStyles();
  assertEquals(psb.size(),ps.size());
  assertEquals(csb.size(),cs.size());
  for (int z=0; z < 2; z++) {
    List<TextPropCollection> lla=cs;
    List<TextPropCollection> llb=csb;
    int upto=5;
    if (z == 1) {
      lla=ps;
      llb=psb;
      upto=4;
    }
    for (int i=0; i < upto; i++) {
      TextPropCollection ca=lla.get(i);
      TextPropCollection cb=llb.get(i);
      assertEquals(ca.getCharactersCovered(),cb.getCharactersCovered());
      assertEquals(ca.getTextPropList().size(),cb.getTextPropList().size());
      for (int j=0; j < ca.getTextPropList().size(); j++) {
        TextProp tpa=ca.getTextPropList().get(j);
        TextProp tpb=cb.getTextPropList().get(j);
        assertEquals(tpa.getName(),tpb.getName());
        assertEquals(tpa.getMask(),tpb.getMask());
        assertEquals(tpa.getWriteMask(),tpb.getWriteMask());
        assertEquals(tpa.getValue(),tpb.getValue());
      }
      ByteArrayOutputStream ba=new ByteArrayOutputStream();
      ByteArrayOutputStream bb=new ByteArrayOutputStream();
      ca.writeOut(ba);
      cb.writeOut(bb);
      byte[] cab=ba.toByteArray();
      byte[] cbb=bb.toByteArray();
      assertEquals(cbb.length,cab.length);
      for (int j=0; j < cab.length; j++) {
        assertEquals(cbb[j],cab[j]);
      }
    }
  }
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  stpa.writeOut(baos);
  byte[] b=baos.toByteArray();
  assertEquals(data_b.length,b.length);
  for (int i=0; i < data_b.length; i++) {
    assertEquals(data_b[i],b[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-9 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=HSLFException.class) public void testFindAddTextProp(){
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> b_p_l=stpb.getParagraphStyles();
  TextPropCollection b_p_1=b_p_l.get(0);
  TextPropCollection b_p_2=b_p_l.get(1);
  TextPropCollection b_p_3=b_p_l.get(2);
  TextPropCollection b_p_4=b_p_l.get(3);
  List<TextPropCollection> b_ch_l=stpb.getCharacterStyles();
  TextPropCollection b_ch_1=b_ch_l.get(0);
  TextPropCollection b_ch_2=b_ch_l.get(1);
  TextPropCollection b_ch_3=b_ch_l.get(2);
  TextPropCollection b_ch_4=b_ch_l.get(3);
  assertNotNull(b_p_1);
  assertNotNull(b_p_2);
  assertNotNull(b_p_3);
  assertNotNull(b_p_4);
  assertNotNull(b_ch_1);
  assertNotNull(b_ch_2);
  assertNotNull(b_ch_3);
  assertNotNull(b_ch_4);
  assertNull(b_ch_3.findByName("char_flags"));
  assertNotNull(b_ch_4.findByName("char_flags"));
  assertEquals(2,b_ch_3.getTextPropList().size());
  TextProp new_cftp=b_ch_3.addWithName("char_flags");
  assertEquals(3,b_ch_3.getTextPropList().size());
  assertEquals(new_cftp,b_ch_3.getTextPropList().get(0));
  assertNotNull(b_p_1.findByName("alignment"));
  assertNull(b_p_2.findByName("alignment"));
  assertEquals(1,b_p_2.getTextPropList().size());
  TextProp new_al=b_p_2.addWithName("alignment");
  assertEquals(2,b_p_2.getTextPropList().size());
  assertEquals(new_al,b_p_2.getTextPropList().get(0));
  TextProp new_sa=b_p_2.addWithName("spaceafter");
  assertEquals(3,b_p_2.getTextPropList().size());
  assertEquals(new_sa,b_p_2.getTextPropList().get(2));
  b_p_2.addWithName("madeUpOne");
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testParagraphProps(){
  StyleTextPropAtom stpb=new StyleTextPropAtom(data_b,0,data_b.length);
  stpb.setParentTextSize(data_b_text_len);
  List<TextPropCollection> b_p_l=stpb.getParagraphStyles();
  TextPropCollection b_p_1=b_p_l.get(0);
  TextPropCollection b_p_2=b_p_l.get(1);
  TextPropCollection b_p_3=b_p_l.get(2);
  TextPropCollection b_p_4=b_p_l.get(3);
  assertEquals(2,b_p_1.getTextPropList().size());
  TextProp tp_1_1=b_p_1.getTextPropList().get(0);
  TextProp tp_1_2=b_p_1.getTextPropList().get(1);
  assertEquals("alignment",tp_1_1.getName());
  assertEquals("linespacing",tp_1_2.getName());
  assertEquals(0,tp_1_1.getValue());
  assertEquals(80,tp_1_2.getValue());
  assertEquals(1,b_p_2.getTextPropList().size());
  TextProp tp_2_1=b_p_2.getTextPropList().get(0);
  assertEquals("linespacing",tp_2_1.getName());
  assertEquals(80,tp_2_1.getValue());
  assertEquals(2,b_p_3.getTextPropList().size());
  TextProp tp_3_1=b_p_3.getTextPropList().get(0);
  TextProp tp_3_2=b_p_3.getTextPropList().get(1);
  assertEquals("alignment",tp_3_1.getName());
  assertEquals("linespacing",tp_3_2.getName());
  assertEquals(2,tp_3_1.getValue());
  assertEquals(80,tp_3_2.getValue());
  assertEquals(2,b_p_4.getTextPropList().size());
  TextProp tp_4_1=b_p_4.getTextPropList().get(0);
  TextProp tp_4_2=b_p_4.getTextPropList().get(1);
  assertEquals("alignment",tp_4_1.getName());
  assertEquals("linespacing",tp_4_2.getName());
  assertEquals(0,tp_4_1.getValue());
  assertEquals(80,tp_4_2.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestBugs </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug46441() throws IOException {
  HSLFSlideShow ppt=open("bug46441.ppt");
  HSLFAutoShape as=(HSLFAutoShape)ppt.getSlides().get(0).getShapes().get(0);
  AbstractEscherOptRecord opt=as.getEscherOptRecord();
  EscherArrayProperty ep=HSLFShape.getEscherProperty(opt,EscherProperties.FILL__SHADECOLORS);
  double exp[][]={{94,158,255,0},{133,194,255,0.399994},{196,214,235,0.699997},{255,235,250,1}};
  int i=0;
  for (  byte data[] : ep) {
    EscherColorRef ecr=new EscherColorRef(data,0,4);
    int rgb[]=ecr.getRGB();
    double pos=Units.fixedPointToDouble(LittleEndian.getInt(data,4));
    assertEquals((int)exp[i][0],rgb[0]);
    assertEquals((int)exp[i][1],rgb[1]);
    assertEquals((int)exp[i][2],rgb[2]);
    assertEquals(exp[i][3],pos,0.01);
    i++;
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 38256:  RuntimeException: Couldn't instantiate the class for type with id 0.
 * ( also fixed followup: getTextRuns() returns no text )
 */
@Test public void bug38256() throws IOException {
  HSLFSlideShow ppt=open("38256.ppt");
  List<HSLFSlide> slide=ppt.getSlides();
  assertEquals(1,slide.size());
  List<List<HSLFTextParagraph>> paras=slide.get(0).getTextParagraphs();
  assertEquals(4,paras.size());
  Set<String> txt=new HashSet<String>();
  txt.add("\u201CHAPPY BIRTHDAY SCOTT\u201D");
  txt.add("Have a HAPPY DAY");
  txt.add("PS Nobody is allowed to hassle Scott TODAY\u2026");
  txt.add("Drinks will be in the Boardroom at 5pm today to celebrate Scott\u2019s B\u2019Day\u2026  See you all there!");
  for (  List<HSLFTextParagraph> para : paras) {
    String text=HSLFTextParagraph.getRawText(para);
    assertTrue(text,txt.contains(text));
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug57272() throws IOException {
  HSLFSlideShow ppt1=open("57272_corrupted_usereditatom.ppt");
  assertEquals(6,ppt1.getSlides().size());
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  assertNotNull(ppt2);
  assertEquals(6,ppt2.getSlides().size());
  ppt2.close();
  ppt1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 45776: Fix corrupt file problem using TextRun.setText
 */
@Test public void bug45776() throws IOException {
  HSLFSlideShow ppt=open("45776.ppt");
  for (  HSLFSlide slide : ppt.getSlides()) {
    for (    HSLFShape shape : slide.getShapes()) {
      if (!(shape instanceof HSLFTextBox))       continue;
      HSLFTextBox tb=(HSLFTextBox)shape;
      String str=tb.getText();
      if (!str.contains("$$DATE$$"))       continue;
      str=str.replace("$$DATE$$",new Date().toString());
      tb.setText(str);
      List<HSLFTextParagraph> tr=tb.getTextParagraphs();
      assertEquals(str.length() + 1,tr.get(0).getParagraphStyle().getCharactersCovered());
      assertEquals(str.length() + 1,tr.get(0).getTextRuns().get(0).getCharacterStyle().getCharactersCovered());
    }
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void bug58733() throws IOException {
  File sample=HSLFTestDataSamples.getSampleFile("bug58733_671884.ppt");
  PowerPointExtractor ex=new PowerPointExtractor(sample.getAbsolutePath());
  assertNotNull(ex.getText());
  ex.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 41071: Will not extract text from Powerpoint TextBoxes
 */
@Test public void bug41071() throws IOException {
  HSLFSlideShow ppt=open("41071.ppt");
  HSLFSlide slide=ppt.getSlides().get(0);
  List<HSLFShape> sh=slide.getShapes();
  assertEquals(1,sh.size());
  assertTrue(sh.get(0) instanceof HSLFTextShape);
  HSLFTextShape tx=(HSLFTextShape)sh.get(0);
  assertEquals("Fundera, planera och involvera.",HSLFTextParagraph.getRawText(tx.getTextParagraphs()));
  List<List<HSLFTextParagraph>> run=slide.getTextParagraphs();
  assertEquals(3,run.size());
  assertEquals("Fundera, planera och involvera.",HSLFTextParagraph.getRawText(run.get(2)));
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug57796() throws IOException {
  HSLFSlideShow ppt=open("WithLinks.ppt");
  HSLFSlide slide=ppt.getSlides().get(0);
  HSLFTextShape shape=(HSLFTextShape)slide.getShapes().get(1);
  List<HSLFHyperlink> hlList=HSLFHyperlink.find(shape);
  HSLFHyperlink hlShape=hlList.get(0);
  HSLFTextRun r=shape.getTextParagraphs().get(1).getTextRuns().get(0);
  HSLFHyperlink hlRun=r.getHyperlink();
  assertEquals(hlRun.getId(),hlShape.getId());
  assertEquals(hlRun.getAddress(),hlShape.getAddress());
  assertEquals(hlRun.getLabel(),hlShape.getLabel());
  assertEquals(hlRun.getType(),hlShape.getType());
  assertEquals(hlRun.getStartIndex(),hlShape.getStartIndex());
  assertEquals(hlRun.getEndIndex(),hlShape.getEndIndex());
  OutputStream nullOutput=new OutputStream(){
    public void write(    int b) throws IOException {
    }
  }
;
  final boolean found[]={false};
  DummyGraphics2d dgfx=new DummyGraphics2d(new PrintStream(nullOutput)){
    public void drawString(    AttributedCharacterIterator iterator,    float x,    float y){
      Map<Attribute,Object> attributes=null;
      StringBuffer sb=new StringBuffer();
      for (char c=iterator.first(); c != AttributedCharacterIterator.DONE; c=iterator.next()) {
        sb.append(c);
        attributes=iterator.getAttributes();
      }
      if ("Jakarta HSSF".equals(sb.toString())) {
        String href=(String)attributes.get(DrawTextParagraph.HYPERLINK_HREF);
        String label=(String)attributes.get(DrawTextParagraph.HYPERLINK_LABEL);
        assertEquals("http://jakarta.apache.org/poi/hssf/",href);
        assertEquals("Open Jakarta POI HSSF module test  ",label);
        found[0]=true;
      }
    }
  }
;
  ppt.getSlides().get(1).draw(dgfx);
  assertTrue(found[0]);
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug47904() throws IOException {
  HSLFSlideShow ppt1=new HSLFSlideShow();
  HSLFSlideMaster sm=ppt1.getSlideMasters().get(0);
  HSLFAutoShape as=(HSLFAutoShape)sm.getShapes().get(0);
  HSLFTextParagraph tp=as.getTextParagraphs().get(0);
  HSLFTextRun tr=tp.getTextRuns().get(0);
  tr.setFontFamily("Tahoma");
  tr.setShadowed(true);
  tr.setFontSize(44.);
  tr.setFontColor(Color.red);
  tp.setTextAlign(TextAlign.RIGHT);
  ppt1.createSlide().addTitle().setText("foobaa");
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  HSLFTextShape ts=(HSLFTextShape)ppt2.getSlides().get(0).getShapes().get(0);
  tp=ts.getTextParagraphs().get(0);
  tr=tp.getTextRuns().get(0);
  assertEquals(44.,tr.getFontSize(),0);
  assertEquals("Tahoma",tr.getFontFamily());
  Color colorAct=DrawPaint.applyColorTransform(tr.getFontColor().getSolidColor());
  assertEquals(Color.red,colorAct);
  assertEquals(TextAlign.RIGHT,tp.getTextAlign());
  assertEquals("foobaa",tr.getRawText());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void bug58718() throws IOException {
  String files[]={"bug58718_008524.ppt","bug58718_008558.ppt","bug58718_349008.ppt","bug58718_008495.ppt"};
  for (  String f : files) {
    File sample=HSLFTestDataSamples.getSampleFile(f);
    PowerPointExtractor ex=new PowerPointExtractor(sample.getAbsolutePath());
    assertNotNull(ex.getText());
    ex.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug45088() throws IOException {
  String template="[SYSDATE]";
  String textExp="REPLACED_DATE_WITH_A_LONG_ONE";
  HSLFSlideShow ppt1=open("bug45088.ppt");
  for (  HSLFSlide slide : ppt1.getSlides()) {
    for (    List<HSLFTextParagraph> paraList : slide.getTextParagraphs()) {
      for (      HSLFTextParagraph para : paraList) {
        for (        HSLFTextRun run : para.getTextRuns()) {
          String text=run.getRawText();
          if (text != null && text.contains(template)) {
            String replacedText=text.replace(template,textExp);
            run.setText(replacedText);
            para.setDirty();
          }
        }
      }
    }
  }
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  HSLFTextBox tb=(HSLFTextBox)ppt2.getSlides().get(0).getShapes().get(1);
  String textAct=tb.getTextParagraphs().get(0).getTextRuns().get(0).getRawText().trim();
  assertEquals(textExp,textAct);
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug45908() throws IOException {
  HSLFSlideShow ppt1=open("bug45908.ppt");
  HSLFSlide slide=ppt1.getSlides().get(0);
  HSLFAutoShape styleShape=(HSLFAutoShape)slide.getShapes().get(1);
  HSLFTextParagraph tp0=styleShape.getTextParagraphs().get(0);
  HSLFTextRun tr0=tp0.getTextRuns().get(0);
  int rows=5;
  int cols=2;
  HSLFTable table=slide.createTable(rows,cols);
  for (int i=0; i < rows; i++) {
    for (int j=0; j < cols; j++) {
      HSLFTableCell cell=table.getCell(i,j);
      cell.setText("Test");
      HSLFTextParagraph tp=cell.getTextParagraphs().get(0);
      tp.setBulletStyle('%',tp0.getBulletColor(),tp0.getBulletFont(),tp0.getBulletSize());
      tp.setIndent(tp0.getIndent());
      tp.setTextAlign(tp0.getTextAlign());
      tp.setIndentLevel(tp0.getIndentLevel());
      tp.setSpaceAfter(tp0.getSpaceAfter());
      tp.setSpaceBefore(tp0.getSpaceBefore());
      tp.setBulletStyle();
      HSLFTextRun tr=tp.getTextRuns().get(0);
      tr.setBold(tr0.isBold());
      tr.setFontColor(Color.BLACK);
      tr.setFontFamily(tr0.getFontFamily());
      tr.setFontSize(tr0.getFontSize());
      tr.setItalic(tr0.isItalic());
      tr.setShadowed(tr0.isShadowed());
      tr.setStrikethrough(tr0.isStrikethrough());
      tr.setUnderlined(tr0.isUnderlined());
    }
  }
  table.moveTo(100,100);
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  HSLFTable tab=(HSLFTable)ppt2.getSlides().get(0).getShapes().get(2);
  HSLFTableCell c2=tab.getCell(0,0);
  HSLFTextParagraph tp1=c2.getTextParagraphs().get(0);
  HSLFTextRun tr1=tp1.getTextRuns().get(0);
  assertFalse(tp1.isBullet());
  assertEquals(tp0.getBulletColor(),tp1.getBulletColor());
  assertEquals(tp0.getBulletFont(),tp1.getBulletFont());
  assertEquals(tp0.getBulletSize(),tp1.getBulletSize());
  assertEquals(tp0.getIndent(),tp1.getIndent());
  assertEquals(tp0.getTextAlign(),tp1.getTextAlign());
  assertEquals(tp0.getIndentLevel(),tp1.getIndentLevel());
  assertEquals(tp0.getSpaceAfter(),tp1.getSpaceAfter());
  assertEquals(tp0.getSpaceBefore(),tp1.getSpaceBefore());
  assertEquals(tr0.isBold(),tr1.isBold());
  assertEquals(Color.black,DrawPaint.applyColorTransform(tr1.getFontColor().getSolidColor()));
  assertEquals(tr0.getFontFamily(),tr1.getFontFamily());
  assertEquals(tr0.getFontSize(),tr1.getFontSize());
  assertEquals(tr0.isItalic(),tr1.isItalic());
  assertEquals(tr0.isShadowed(),tr1.isShadowed());
  assertEquals(tr0.isStrikethrough(),tr1.isStrikethrough());
  assertEquals(tr0.isUnderlined(),tr1.isUnderlined());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug37625() throws IOException {
  HSLFSlideShow ppt1=open("37625.ppt");
  assertEquals(29,ppt1.getSlides().size());
  HSLFSlideShow ppt2=HSLFTestDataSamples.writeOutAndReadBack(ppt1);
  assertNotNull(ppt2);
  assertEquals(29,ppt2.getSlides().size());
  ppt2.close();
  ppt1.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Second fix from Bug 42474: Incorrect matching of notes to slides
 */
@Test public void bug42474_2() throws IOException {
  HSLFSlideShow ppt=open("42474-2.ppt");
  Map<Integer,String> notesMap=new HashMap<Integer,String>();
  notesMap.put(Integer.valueOf(4),"For  decades before calculators");
  notesMap.put(Integer.valueOf(5),"Several commercial applications");
  notesMap.put(Integer.valueOf(6),"There are three variations of LNS that are discussed here");
  notesMap.put(Integer.valueOf(7),"Although multiply and square root are easier");
  notesMap.put(Integer.valueOf(8),"The bus Z is split into Z_H and Z_L");
  for (  HSLFSlide slide : ppt.getSlides()) {
    Integer slideNumber=Integer.valueOf(slide.getSlideNumber());
    HSLFNotes notes=slide.getNotes();
    if (notesMap.containsKey(slideNumber)) {
      assertNotNull(notes);
      String text=HSLFTextParagraph.getRawText(notes.getTextParagraphs().get(0));
      String startingPhrase=notesMap.get(slideNumber);
      assertTrue("Notes for slide " + slideNumber + " must start with "+ startingPhrase,text.startsWith(startingPhrase));
    }
  }
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestFontRendering </h4><pre class="type-2 type-1 type-17 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug55902mixedFontWithChineseCharacters() throws Exception {
  String fontFiles[][]={{"build/scratchpad-test-resources/Cabin-Regular.ttf","mapped","Calibri"},{"build/scratchpad-test-resources/mona.ttf","fallback","Cabin"}};
  GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
  Map<String,String> fontMap=new HashMap<String,String>();
  Map<String,String> fallbackMap=new HashMap<String,String>();
  for (  String fontFile[] : fontFiles) {
    File f=new File(fontFile[0]);
    assumeTrue("necessary font file " + f.getName() + " not downloaded.",f.exists());
    Font font=Font.createFont(Font.TRUETYPE_FONT,f);
    ge.registerFont(font);
    Map<String,String> map=("mapped".equals(fontFile[1]) ? fontMap : fallbackMap);
    map.put(fontFile[2],font.getFamily());
  }
  InputStream is=slTests.openResourceAsStream("bug55902-mixedFontChineseCharacters.ppt");
  HSLFSlideShow ss=new HSLFSlideShow(is);
  is.close();
  Dimension pgsize=ss.getPageSize();
  HSLFSlide slide=ss.getSlides().get(0);
  double zoom=1;
  AffineTransform at=new AffineTransform();
  at.setToScale(zoom,zoom);
  BufferedImage imgActual=new BufferedImage((int)Math.ceil(pgsize.width * zoom),(int)Math.ceil(pgsize.height * zoom),BufferedImage.TYPE_3BYTE_BGR);
  Graphics2D graphics=imgActual.createGraphics();
  graphics.setRenderingHint(Drawable.FONT_FALLBACK,fallbackMap);
  graphics.setRenderingHint(Drawable.FONT_MAP,fontMap);
  graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  graphics.setRenderingHint(RenderingHints.KEY_RENDERING,RenderingHints.VALUE_RENDER_QUALITY);
  graphics.setRenderingHint(RenderingHints.KEY_INTERPOLATION,RenderingHints.VALUE_INTERPOLATION_BICUBIC);
  graphics.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS,RenderingHints.VALUE_FRACTIONALMETRICS_ON);
  graphics.setTransform(at);
  graphics.setPaint(Color.white);
  graphics.fill(new Rectangle2D.Float(0,0,pgsize.width,pgsize.height));
  slide.draw(graphics);
  BufferedImage imgExpected=ImageIO.read(slTests.getFile("bug55902-mixedChars.png"));
  DataBufferByte expectedDB=(DataBufferByte)imgExpected.getRaster().getDataBuffer();
  DataBufferByte actualDB=(DataBufferByte)imgActual.getRaster().getDataBuffer();
  byte[] expectedData=expectedDB.getData(0);
  byte[] actualData=actualDB.getData(0);
  if (!Arrays.equals(expectedData,actualData)) {
    ImageIO.write(imgActual,"PNG",TempFile.createTempFile("TestFontRendering",".png"));
  }
  assertArrayEquals("Expected to have matching raster-arrays, but found differences",expectedData,actualData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestPictures </h4><pre class="type-2 type-1 type-3 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Read pictures in different formats from a reference slide show
 */
@Test public void testReadPictures() throws Exception {
  byte[] src_bytes, ppt_bytes, b1, b2;
  HSLFPictureShape pict;
  HSLFPictureData pdata;
  HSLFSlideShow ppt=new HSLFSlideShow(slTests.openResourceAsStream("pictures.ppt"));
  List<HSLFSlide> slides=ppt.getSlides();
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(5,pictures.size());
  pict=(HSLFPictureShape)slides.get(0).getShapes().get(0);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof JPEG);
  assertEquals(PictureType.JPEG,pdata.getType());
  src_bytes=pdata.getData();
  ppt_bytes=slTests.readFile("clock.jpg");
  assertArrayEquals(src_bytes,ppt_bytes);
  pict=(HSLFPictureShape)slides.get(1).getShapes().get(0);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof PNG);
  assertEquals(PictureType.PNG,pdata.getType());
  src_bytes=pdata.getData();
  ppt_bytes=slTests.readFile("tomcat.png");
  assertArrayEquals(src_bytes,ppt_bytes);
  pict=(HSLFPictureShape)slides.get(2).getShapes().get(0);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof WMF);
  assertEquals(PictureType.WMF,pdata.getType());
  src_bytes=pdata.getData();
  ppt_bytes=slTests.readFile("santa.wmf");
  assertEquals(src_bytes.length,ppt_bytes.length);
  b1=new byte[src_bytes.length - 22];
  System.arraycopy(src_bytes,22,b1,0,b1.length);
  b2=new byte[ppt_bytes.length - 22];
  System.arraycopy(ppt_bytes,22,b2,0,b2.length);
  assertArrayEquals(b1,b2);
  pict=(HSLFPictureShape)slides.get(3).getShapes().get(0);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof PICT);
  assertEquals(PictureType.PICT,pdata.getType());
  src_bytes=pdata.getData();
  ppt_bytes=slTests.readFile("cow.pict");
  assertEquals(src_bytes.length,ppt_bytes.length);
  b1=new byte[src_bytes.length - 512];
  System.arraycopy(src_bytes,512,b1,0,b1.length);
  b2=new byte[ppt_bytes.length - 512];
  System.arraycopy(ppt_bytes,512,b2,0,b2.length);
  assertArrayEquals(b1,b2);
  pict=(HSLFPictureShape)slides.get(4).getShapes().get(0);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof EMF);
  assertEquals(PictureType.EMF,pdata.getType());
  src_bytes=pdata.getData();
  ppt_bytes=slTests.readFile("wrench.emf");
  assertArrayEquals(src_bytes,ppt_bytes);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * YK: The test is disabled because the owner asked to delete the test file from POI svn.
 * See "Please remove my file from your svn" on @poi-dev from Dec 12, 2013
 */
@Test @Ignore public void testZeroPictureLength() throws Exception {
  URL url=new URL("http://www.cs.sfu.ca/~anoop/courses/CMPT-882-Fall-2002/chris.ppt");
  HSLFSlideShowImpl hslf=new HSLFSlideShowImpl(url.openStream());
  assertEquals(2,hslf.getPictureData().size());
  assertEquals(PictureType.WMF,hslf.getPictureData().get(0).getType());
  assertEquals(PictureType.WMF,hslf.getPictureData().get(1).getType());
  HSLFSlideShow ppt=new HSLFSlideShow(hslf);
  List<HSLFSlide> slides=ppt.getSlides();
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(27,slides.size());
  assertEquals(2,pictures.size());
  HSLFPictureShape pict;
  HSLFPictureData pdata;
  pict=(HSLFPictureShape)slides.get(6).getShapes().get(13);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof WMF);
  assertEquals(PictureType.WMF,pdata.getType());
  pict=(HSLFPictureShape)slides.get(7).getShapes().get(13);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof WMF);
  assertEquals(PictureType.WMF,pdata.getType());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  for (  HSLFPictureData p : pictures)   p.write(out);
  out.close();
  int streamSize=out.size();
  HSLFPictureData data=HSLFPictureData.create(PictureType.JPEG);
  data.setData(new byte[100]);
  int offset=hslf.addPicture(data);
  assertEquals(streamSize,offset);
  assertEquals(3,ppt.getPictureData().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write EMF
 */
@Test public void testEMF() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("wrench.emf");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.EMF);
  EMF.NativeHeader nHeader=new EMF.NativeHeader(src_bytes,0);
  final int expWidth=190, expHeight=115;
  Dimension nDim=nHeader.getSize();
  assertEquals(expWidth,nDim.getWidth(),0);
  assertEquals(expHeight,nDim.getHeight(),0);
  Dimension dim=data.getImageDimensionInPixels();
  assertEquals(Units.pointsToPixel(expWidth),dim.getWidth(),0);
  assertEquals(Units.pointsToPixel(expHeight),dim.getHeight(),0);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(1,pictures.size());
  HSLFPictureData pd=pictures.get(0);
  dim=pd.getImageDimension();
  assertEquals(expWidth,dim.width);
  assertEquals(expHeight,dim.height);
  assertEquals(pict.getPictureData(),pd);
  assertEquals(1,pictures.size());
  assertEquals(PictureType.EMF,pd.getType());
  assertTrue(pd instanceof EMF);
  byte[] ppt_bytes=pd.getData();
  assertArrayEquals(src_bytes,ppt_bytes);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that on a party corrupt powerpoint document, which has
 * crazy pictures of type 0, we do our best.
 */
@Test public void testZeroPictureType() throws Exception {
  HSLFSlideShowImpl hslf=new HSLFSlideShowImpl(slTests.openResourceAsStream("PictureTypeZero.ppt"));
  assertEquals(2,hslf.getPictureData().size());
  assertEquals(PictureType.WMF,hslf.getPictureData().get(0).getType());
  assertEquals(PictureType.WMF,hslf.getPictureData().get(1).getType());
  HSLFSlideShow ppt=new HSLFSlideShow(hslf);
  List<HSLFSlide> slides=ppt.getSlides();
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(12,slides.size());
  assertEquals(2,pictures.size());
  HSLFPictureShape pict;
  HSLFPictureData pdata;
  pict=(HSLFPictureShape)slides.get(0).getShapes().get(1);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof WMF);
  assertEquals(PictureType.WMF,pdata.getType());
  pict=(HSLFPictureShape)slides.get(0).getShapes().get(2);
  pdata=pict.getPictureData();
  assertTrue(pdata instanceof WMF);
  assertEquals(PictureType.WMF,pdata.getType());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write WMF
 */
@Test public void testWMF() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("santa.wmf");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.WMF);
  WMF.NativeHeader nHeader=new WMF.NativeHeader(src_bytes,0);
  final int expWidth=136, expHeight=146;
  Dimension nDim=nHeader.getSize();
  assertEquals(expWidth,nDim.getWidth(),0);
  assertEquals(expHeight,nDim.getHeight(),0);
  Dimension dim=data.getImageDimensionInPixels();
  assertEquals(Units.pointsToPixel(expWidth),dim.getWidth(),0);
  assertEquals(Units.pointsToPixel(expHeight),dim.getHeight(),0);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(1,pictures.size());
  HSLFPictureData pd=pictures.get(0);
  dim=pd.getImageDimension();
  assertEquals(expWidth,dim.width);
  assertEquals(expHeight,dim.height);
  assertEquals(pict.getPictureData(),pd);
  assertEquals(PictureType.WMF,pd.getType());
  assertTrue(pd instanceof WMF);
  byte[] ppt_bytes=pd.getData();
  assertEquals(src_bytes.length,ppt_bytes.length);
  byte[] b1=new byte[src_bytes.length - 22];
  System.arraycopy(src_bytes,22,b1,0,b1.length);
  byte[] b2=new byte[ppt_bytes.length - 22];
  System.arraycopy(ppt_bytes,22,b2,0,b2.length);
  assertArrayEquals(b1,b2);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write PNG
 */
@Test public void testPNG() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("tomcat.png");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.PNG);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(pict.getPictureData(),pictures.get(0));
  assertEquals(1,pictures.size());
  assertEquals(PictureType.PNG,pictures.get(0).getType());
  assertTrue(pictures.get(0) instanceof PNG);
  byte[] ppt_bytes=pictures.get(0).getData();
  assertArrayEquals(src_bytes,ppt_bytes);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write DIB
 */
@Test public void testDIB() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("clock.dib");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.DIB);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(pict.getPictureData(),pictures.get(0));
  assertEquals(1,pictures.size());
  assertEquals(PictureType.DIB,pictures.get(0).getType());
  assertTrue(pictures.get(0) instanceof DIB);
  byte[] ppt_bytes=pictures.get(0).getData();
  assertArrayEquals(src_bytes,ppt_bytes);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write JPEG
 */
@Test public void testJPEG() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("clock.jpg");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.JPEG);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(pict.getPictureData(),pictures.get(0));
  assertEquals(1,pictures.size());
  assertEquals(PictureType.JPEG,pictures.get(0).getType());
  assertTrue(pictures.get(0) instanceof JPEG);
  byte[] ppt_bytes=pictures.get(0).getData();
  assertArrayEquals(src_bytes,ppt_bytes);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test read/write Macintosh PICT
 */
@Test public void testPICT() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] src_bytes=slTests.readFile("cow.pict");
  HSLFPictureData data=ppt.addPicture(src_bytes,PictureType.PICT);
  PICT.NativeHeader nHeader=new PICT.NativeHeader(src_bytes,512);
  final int expWidth=197, expHeight=137;
  Dimension nDim=nHeader.getSize();
  assertEquals(expWidth,nDim.getWidth(),0);
  assertEquals(expHeight,nDim.getHeight(),0);
  Dimension dim=data.getImageDimensionInPixels();
  assertEquals(Units.pointsToPixel(expWidth),dim.getWidth(),0);
  assertEquals(Units.pointsToPixel(expHeight),dim.getHeight(),0);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new HSLFSlideShowImpl(new ByteArrayInputStream(out.toByteArray())));
  List<HSLFShape> sh=ppt.getSlides().get(0).getShapes();
  assertEquals(1,sh.size());
  pict=(HSLFPictureShape)sh.get(0);
  assertEquals(data.getIndex(),pict.getPictureIndex());
  List<HSLFPictureData> pictures=ppt.getPictureData();
  assertEquals(1,pictures.size());
  HSLFPictureData pd=pictures.get(0);
  dim=pd.getImageDimension();
  assertEquals(expWidth,dim.width);
  assertEquals(expHeight,dim.height);
  assertEquals(pict.getPictureData(),pd);
  assertEquals(1,pictures.size());
  assertEquals(PictureType.PICT,pd.getType());
  assertTrue(pd instanceof PICT);
  byte[] ppt_bytes=pd.getData();
  assertEquals(src_bytes.length,ppt_bytes.length);
  byte[] b1=new byte[src_bytes.length - 512];
  System.arraycopy(src_bytes,512,b1,0,b1.length);
  byte[] b2=new byte[ppt_bytes.length - 512];
  System.arraycopy(ppt_bytes,512,b2,0,b2.length);
  assertArrayEquals(b1,b2);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetPictureName() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  byte[] img=slTests.readFile("tomcat.png");
  HSLFPictureData data=ppt.addPicture(img,PictureType.PNG);
  HSLFPictureShape pict=new HSLFPictureShape(data);
  pict.setPictureName("tomcat.png");
  slide.addShape(pict);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  HSLFPictureShape p=(HSLFPictureShape)ppt.getSlides().get(0).getShapes().get(0);
  assertEquals("tomcat.png",p.getPictureName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestReOrderingSlides </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test doing a dummy re-order on a slideshow with
 * three slides in it
 */
@Test public void testReOrder3() throws Exception {
  assertEquals(3,ss_three.getSlides().size());
  HSLFSlide s1=ss_three.getSlides().get(0);
  HSLFSlide s2=ss_three.getSlides().get(1);
  HSLFSlide s3=ss_three.getSlides().get(2);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(258,s2._getSheetNumber());
  assertEquals(5,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  assertEquals(257,s3._getSheetNumber());
  assertEquals(4,s3._getSheetRefId());
  assertEquals(3,s3.getSlideNumber());
  ss_three.reorderSlide(2,2);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hss_three.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  HSLFSlideShowImpl hss_read=new HSLFSlideShowImpl(bais);
  HSLFSlideShow ss_read=new HSLFSlideShow(hss_read);
  assertEquals(3,ss_read.getSlides().size());
  s1=ss_read.getSlides().get(0);
  s2=ss_read.getSlides().get(1);
  s3=ss_read.getSlides().get(2);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(258,s2._getSheetNumber());
  assertEquals(5,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  assertEquals(257,s3._getSheetNumber());
  assertEquals(4,s3._getSheetRefId());
  assertEquals(3,s3.getSlideNumber());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can "re-order" a slideshow with only 1 slide on it
 */
@Test public void testReOrder1() throws Exception {
  assertEquals(1,ss_one.getSlides().size());
  HSLFSlide s1=ss_one.getSlides().get(0);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  ss_one.reorderSlide(1,1);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hss_one.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  HSLFSlideShowImpl hss_read=new HSLFSlideShowImpl(bais);
  HSLFSlideShow ss_read=new HSLFSlideShow(hss_read);
  assertEquals(1,ss_read.getSlides().size());
  s1=ss_read.getSlides().get(0);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test re-ordering slides in a slideshow with 3 slides on it
 */
@Test public void testReOrder3swap() throws Exception {
  assertEquals(3,ss_three.getSlides().size());
  HSLFSlide s1=ss_three.getSlides().get(0);
  HSLFSlide s2=ss_three.getSlides().get(1);
  HSLFSlide s3=ss_three.getSlides().get(2);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(3,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(258,s2._getSheetNumber());
  assertEquals(5,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  assertEquals(257,s3._getSheetNumber());
  assertEquals(4,s3._getSheetRefId());
  assertEquals(3,s3.getSlideNumber());
  ss_three.reorderSlide(3,1);
  s1=ss_three.getSlides().get(0);
  s2=ss_three.getSlides().get(1);
  s3=ss_three.getSlides().get(2);
  assertEquals(1,s1.getSlideNumber());
  assertEquals(2,s2.getSlideNumber());
  assertEquals(3,s3.getSlideNumber());
  assertEquals("Slide 3",((HSLFTextShape)s1.getShapes().get(0)).getText());
  assertEquals("Slide 1",((HSLFTextShape)s3.getShapes().get(0)).getText());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hss_three.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  HSLFSlideShowImpl hss_read=new HSLFSlideShowImpl(bais);
  HSLFSlideShow ss_read=new HSLFSlideShow(hss_read);
  assertEquals(3,ss_read.getSlides().size());
  HSLFSlide _s1=ss_read.getSlides().get(0);
  HSLFSlide _s2=ss_read.getSlides().get(1);
  HSLFSlide _s3=ss_read.getSlides().get(2);
  assertEquals(s1._getSheetNumber(),_s1._getSheetNumber());
  assertEquals(s1._getSheetRefId(),_s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(s2._getSheetNumber(),_s2._getSheetNumber());
  assertEquals(s2._getSheetRefId(),_s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  assertEquals(s3._getSheetNumber(),_s3._getSheetNumber());
  assertEquals(s3._getSheetRefId(),_s3._getSheetRefId());
  assertEquals(3,s3.getSlideNumber());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test doing a dummy re-order on a slideshow with
 * two slides in it
 */
@Test public void testReOrder2() throws Exception {
  assertEquals(2,ss_two.getSlides().size());
  HSLFSlide s1=ss_two.getSlides().get(0);
  HSLFSlide s2=ss_two.getSlides().get(1);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(4,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(257,s2._getSheetNumber());
  assertEquals(6,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  ss_two.reorderSlide(2,2);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hss_two.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  HSLFSlideShowImpl hss_read=new HSLFSlideShowImpl(bais);
  HSLFSlideShow ss_read=new HSLFSlideShow(hss_read);
  assertEquals(2,ss_read.getSlides().size());
  s1=ss_read.getSlides().get(0);
  s2=ss_read.getSlides().get(1);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(4,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(257,s2._getSheetNumber());
  assertEquals(6,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test re-ordering slides in a slideshow with 2 slides on it
 */
@Test public void testReOrder2swap() throws Exception {
  assertEquals(2,ss_two.getSlides().size());
  HSLFSlide s1=ss_two.getSlides().get(0);
  HSLFSlide s2=ss_two.getSlides().get(1);
  assertEquals(256,s1._getSheetNumber());
  assertEquals(4,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(257,s2._getSheetNumber());
  assertEquals(6,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
  ss_two.reorderSlide(2,1);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  hss_two.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  HSLFSlideShowImpl hss_read=new HSLFSlideShowImpl(bais);
  HSLFSlideShow ss_read=new HSLFSlideShow(hss_read);
  assertEquals(2,ss_read.getSlides().size());
  s1=ss_read.getSlides().get(0);
  s2=ss_read.getSlides().get(1);
  assertEquals(257,s1._getSheetNumber());
  assertEquals(6,s1._getSheetRefId());
  assertEquals(1,s1.getSlideNumber());
  assertEquals(256,s2._getSheetNumber());
  assertEquals(4,s2._getSheetRefId());
  assertEquals(2,s2.getSlideNumber());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestRichTextRun </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can do the right things when the paragraph styles
 * run out before the character styles do, when we tweak something
 * and write back out.
 */
@Test @SuppressWarnings("unused") public void testParagraphStylesShorterTheCharStylesWrite() throws Exception {
  assertMatchesSLTWC(ssRichC);
  assertMatchesFileC(ssRichC);
  HSLFSlide slideSevenC=ssRichC.getSlides().get(6);
  List<List<HSLFTextParagraph>> s7tr=slideSevenC.getTextParagraphs();
  List<HSLFTextRun> s7rtr0=s7tr.get(0).get(0).getTextRuns();
  List<HSLFTextRun> s7rtr1=s7tr.get(1).get(0).getTextRuns();
  List<HSLFTextRun> s7rtr2=s7tr.get(2).get(0).getTextRuns();
  String oldText;
  oldText=s7rtr2.get(0).getRawText();
  s7rtr2.get(0).setText(oldText);
  HSLFTextParagraph.storeText(s7tr.get(2));
  assertEquals(oldText,s7rtr2.get(0).getRawText());
  assertEquals(oldText,HSLFTextParagraph.getRawText(s7tr.get(2)));
  assertEquals(oldText.length() + 1,s7rtr2.get(0).getCharacterStyle().getCharactersCovered());
  assertEquals(oldText.length() + 1,s7rtr2.get(0).getTextParagraph().getParagraphStyle().getCharactersCovered());
  assertMatchesSLTWC(ssRichC);
  assertMatchesFileC(ssRichC);
  oldText=s7rtr1.get(0).getRawText();
  s7rtr1.get(0).setText(oldText);
  HSLFTextParagraph.storeText(s7tr.get(1));
  assertEquals(oldText,s7rtr1.get(0).getRawText());
  assertEquals(oldText.length(),s7rtr1.get(0).getCharacterStyle().getCharactersCovered());
  assertMatchesSLTWC(ssRichC);
  assertMatchesFileC(ssRichC);
  s7rtr1.get(0).setText(s7rtr1.get(0).getRawText());
  HSLFTextParagraph.storeText(s7tr.get(1));
  assertMatchesSLTWC(ssRichC);
  assertMatchesFileC(ssRichC);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the stuff about getting/setting bold
 * on a rich text run
 */
@Test public void testBoldRich(){
  HSLFSlide slideOneR=ssRichA.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOneR.getTextParagraphs();
  List<HSLFTextParagraph> textParas=textParass.get(1);
  assertEquals(3,textParas.size());
  assertTrue(textParas.get(0).getTextRuns().get(0).isBold());
  assertFalse(textParas.get(1).getTextRuns().get(0).isBold());
  assertFalse(textParas.get(2).getTextRuns().get(0).isBold());
  textParas.get(0).getTextRuns().get(0).setBold(true);
  textParas.get(1).getTextRuns().get(0).setBold(true);
  assertTrue(textParas.get(0).getTextRuns().get(0).isBold());
  assertTrue(textParas.get(1).getTextRuns().get(0).isBold());
  textParas.get(0).getTextRuns().get(0).setBold(false);
  textParas.get(1).getTextRuns().get(0).setBold(false);
  assertFalse(textParas.get(0).getTextRuns().get(0).isBold());
  assertFalse(textParas.get(1).getTextRuns().get(0).isBold());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChineseParagraphs() throws Exception {
  List<HSLFTextRun> rts;
  HSLFTextRun rt;
  List<List<HSLFTextParagraph>> txt;
  List<HSLFSlide> slides=ssChinese.getSlides();
  assertEquals(1,slides.size());
  txt=slides.get(0).getTextParagraphs();
  assertEquals(1,txt.size());
  rts=txt.get(0).get(0).getTextRuns();
  assertEquals(1,rts.size());
  rt=rts.get(0);
  String text=rt.getRawText();
  assertContains(text,"Single byte");
  assertContains(txt.get(0).get(3).getTextRuns().get(0).getRawText(),"\uff8a\uff9d\uff76\uff78");
  assertFalse(rt.isBold());
  assertFalse(rt.isItalic());
  assertEquals("Calibri",rt.getFontFamily());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the stuff about getting/setting bold
 * on a non rich text run
 */
@Test public void testBoldNonRich(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  List<HSLFTextParagraph> textParas=textParass.get(0);
  HSLFTextRun rtr=textParas.get(0).getTextRuns().get(0);
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(textParas.get(0).getParagraphStyle());
  assertFalse(rtr.isBold());
  rtr.setBold(false);
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(textParas.get(0).getParagraphStyle());
  assertFalse(rtr.isBold());
  rtr.setBold(true);
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(textParas.get(0).getParagraphStyle());
  assertTrue(rtr.isBold());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests getting and setting the font size on rich and non
 * rich text runs
 */
@Test public void testFontSize(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  HSLFTextRun rtr=textParass.get(0).get(0).getTextRuns().get(0);
  HSLFSlide slideOneR=ssRichB.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParassR=slideOneR.getTextParagraphs();
  HSLFTextRun rtrRa=textParassR.get(0).get(0).getTextRuns().get(0);
  HSLFTextRun rtrRb=textParassR.get(1).get(0).getTextRuns().get(0);
  HSLFTextRun rtrRc=textParassR.get(1).get(3).getTextRuns().get(0);
  String defaultFont="Arial";
  assertEquals(44,rtrRa.getFontSize(),0);
  assertEquals(defaultFont,rtrRa.getFontFamily());
  assertEquals(20,rtrRb.getFontSize(),0);
  assertEquals(defaultFont,rtrRb.getFontFamily());
  assertEquals(24,rtrRc.getFontSize(),0);
  assertEquals("Times New Roman",rtrRc.getFontFamily());
  assertEquals(2,ssRichB.getFontCollection().getChildRecords().length);
  rtrRb.setFontSize(18d);
  rtrRb.setFontFamily("Courier");
  assertEquals(3,ssRichB.getFontCollection().getChildRecords().length);
  assertEquals(18,rtrRb.getFontSize(),0);
  assertEquals("Courier",rtrRb.getFontFamily());
  assertEquals(44,rtr.getFontSize(),0);
  assertEquals(defaultFont,rtr.getFontFamily());
  assertEquals(1,ss.getFontCollection().getChildRecords().length);
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(rtr.getTextParagraph().getParagraphStyle());
  rtr.setFontSize(99d);
  assertEquals(99,rtr.getFontSize(),0);
  assertEquals(defaultFont,rtr.getFontFamily());
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(rtr.getTextParagraph().getParagraphStyle());
  assertEquals(1,ss.getFontCollection().getChildRecords().length);
  rtr.setFontSize(25d);
  rtr.setFontFamily("Times New Roman");
  assertEquals(25,rtr.getFontSize(),0);
  assertEquals("Times New Roman",rtr.getFontFamily());
  assertNotNull(rtr.getCharacterStyle());
  assertNotNull(rtr.getTextParagraph().getParagraphStyle());
  assertEquals(2,ss.getFontCollection().getChildRecords().length);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetParagraphStyles() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  HSLFTextBox shape=new HSLFTextBox();
  shape.setText("Hello, World!\r" + "This should be\r" + "Multiline text");
  HSLFTextParagraph rt=shape.getTextParagraphs().get(0);
  HSLFTextRun tr=rt.getTextRuns().get(0);
  tr.setFontSize(42d);
  rt.setBullet(true);
  rt.setLeftMargin(50d);
  rt.setIndent(0d);
  rt.setBulletChar('\u263A');
  slide.addShape(shape);
  assertEquals(42.0,tr.getFontSize(),0);
  assertEquals(true,rt.isBullet());
  assertEquals(50.0,rt.getLeftMargin(),0);
  assertEquals(0,rt.getIndent(),0);
  assertEquals('\u263A',(char)rt.getBulletChar());
  shape.setAnchor(new java.awt.Rectangle(50,50,500,300));
  slide.addShape(shape);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  slide=ppt.getSlides().get(0);
  shape=(HSLFTextBox)slide.getShapes().get(0);
  rt=shape.getTextParagraphs().get(0);
  tr=rt.getTextRuns().get(0);
  assertEquals(42.0,tr.getFontSize(),0);
  assertEquals(true,rt.isBullet());
  assertEquals(50.0,rt.getLeftMargin(),0);
  assertEquals(0,rt.getIndent(),0);
  assertEquals('\u263A',(char)rt.getBulletChar());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddText() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("bullets.ppt"));
  assertTrue("No Exceptions while reading file",true);
  HSLFTextParagraph rt;
  HSLFTextRun tr;
  List<List<HSLFTextParagraph>> txt;
  List<HSLFSlide> slides=ppt.getSlides();
  assertEquals(2,slides.size());
  txt=slides.get(0).getTextParagraphs();
  assertEquals(2,txt.size());
  assertEquals("Title text",HSLFTextParagraph.getRawText(txt.get(0)));
  assertEquals(1,txt.get(0).size());
  rt=txt.get(0).get(0);
  assertFalse(rt.isBullet());
  HSLFTextParagraph.appendText(txt.get(0),"Foo! I'm new!",true);
  assertEquals(2,txt.get(0).size());
  rt=txt.get(0).get(0);
  tr=rt.getTextRuns().get(0);
  assertFalse(tr.isBold());
  assertEquals("Title text\r",tr.getRawText());
  rt=txt.get(0).get(1);
  tr=rt.getTextRuns().get(0);
  assertFalse(tr.isBold());
  assertEquals("Foo! I'm new!",tr.getRawText());
  tr.setBold(true);
  HSLFTextParagraph.storeText(txt.get(0));
  HSLFTextParagraph.appendText(txt.get(0),"Me too!",true);
  HSLFTextParagraph.storeText(txt.get(0));
  assertEquals(3,txt.get(0).size());
  rt=txt.get(0).get(0);
  tr=rt.getTextRuns().get(0);
  assertFalse(tr.isBold());
  assertEquals("Title text\r",tr.getRawText());
  rt=txt.get(0).get(1);
  tr=rt.getTextRuns().get(0);
  assertTrue(tr.isBold());
  assertEquals("Foo! I'm new!\r",tr.getRawText());
  rt=txt.get(0).get(2);
  tr=rt.getTextRuns().get(0);
  assertTrue(tr.isBold());
  assertEquals("Me too!",tr.getRawText());
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  slides=ppt.getSlides();
  assertEquals(2,slides.size());
  txt=slides.get(0).getTextParagraphs();
  assertEquals(2,txt.size());
  assertEquals(3,txt.get(0).size());
  rt=txt.get(0).get(0);
  tr=rt.getTextRuns().get(0);
  assertFalse(tr.isBold());
  assertEquals("Title text\r",tr.getRawText());
  rt=txt.get(0).get(1);
  tr=rt.getTextRuns().get(0);
  assertTrue(tr.isBold());
  assertEquals("Foo! I'm new!\r",tr.getRawText());
  rt=txt.get(0).get(2);
  tr=rt.getTextRuns().get(0);
  assertTrue(tr.isBold());
  assertEquals("Me too!",tr.getRawText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadParagraphStyles() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("bullets.ppt"));
  assertTrue("No Exceptions while reading file",true);
  HSLFTextParagraph rt;
  List<List<HSLFTextParagraph>> txt;
  List<HSLFSlide> slide=ppt.getSlides();
  assertEquals(2,slide.size());
  txt=slide.get(0).getTextParagraphs();
  assertEquals(2,txt.size());
  assertEquals("Title text",HSLFTextParagraph.getRawText(txt.get(0)));
  assertEquals(1,txt.get(0).size());
  rt=txt.get(0).get(0);
  assertFalse(rt.isBullet());
  String expected="This is a text placeholder that \r" + "follows the design pattern\r" + "Defined in the slide master\r"+ "and has bullets by default";
  assertEquals(expected,HSLFTextParagraph.getRawText(txt.get(1)));
  assertEquals(4,txt.get(1).size());
  rt=txt.get(1).get(0);
  assertEquals('\u2022',(char)rt.getBulletChar());
  assertTrue(rt.isBullet());
  txt=slide.get(1).getTextParagraphs();
  assertEquals(2,txt.size());
  expected="I\u2019m a text box\r" + "With bullets\r" + "That follow the design pattern\r"+ "From the slide master";
  assertEquals(expected,HSLFTextParagraph.getRawText(txt.get(0)));
  assertEquals(4,txt.get(0).size());
  rt=txt.get(0).get(0);
  assertTrue(rt.isBullet());
  assertEquals('\u2022',(char)rt.getBulletChar());
  expected="I\u2019m a text box with user-defined\r" + "bullet character";
  assertEquals(expected,HSLFTextParagraph.getRawText(txt.get(1)));
  assertEquals(2,txt.get(1).size());
  rt=txt.get(1).get(0);
  assertTrue(rt.isBullet());
  assertEquals('\u263A',(char)rt.getBulletChar());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangeWriteRead() throws Exception {
  for (  HSLFSlideShow h : new HSLFSlideShow[]{ss,ssRichA,ssRichB}) {
    HSLFSlide slideOne=h.getSlides().get(0);
    List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
    HSLFTextRun rtr=textParass.get(0).get(0).getTextRuns().get(0);
    rtr.setBold(true);
    rtr.setFontSize(18d);
    rtr.setFontFamily("Courier");
    HSLFTextParagraph.storeText(textParass.get(0));
    assertTrue(rtr.isBold());
    assertEquals(18.,rtr.getFontSize(),0);
    assertEquals("Courier",rtr.getFontFamily());
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    h.write(baos);
    ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
    HSLFSlideShowImpl readHSLF=new HSLFSlideShowImpl(bais);
    HSLFSlideShow readS=new HSLFSlideShow(readHSLF);
    rtr.setBold(false);
    rtr.setFontSize(17d);
    rtr.setFontFamily("CourierZZ");
    assertFalse(rtr.isBold());
    assertEquals(17.,rtr.getFontSize(),0);
    assertEquals("CourierZZ",rtr.getFontFamily());
    HSLFSlide slideOneRR=readS.getSlides().get(0);
    List<List<HSLFTextParagraph>> textParassRR=slideOneRR.getTextParagraphs();
    HSLFTextRun rtrRRa=textParassRR.get(0).get(0).getTextRuns().get(0);
    assertTrue(rtrRRa.isBold());
    assertEquals(18.,rtrRRa.getFontSize(),0);
    assertEquals("Courier",rtrRRa.getFontFamily());
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can do the right things when the paragraph styles
 * run out before the character styles do
 */
@Test public void testParagraphStylesShorterTheCharStyles(){
  List<HSLFSlide> slides=ssRichC.getSlides();
  assertEquals(14,slides.size());
  HSLFSlide slideThreeC=ssRichC.getSlides().get(2);
  HSLFSlide slideSevenC=ssRichC.getSlides().get(6);
  assertEquals(4,slideThreeC.getTextParagraphs().size());
  assertEquals(5,slideSevenC.getTextParagraphs().size());
  List<List<HSLFTextParagraph>> s3tr=slideThreeC.getTextParagraphs();
  List<HSLFTextRun> s3rtr0=s3tr.get(0).get(0).getTextRuns();
  List<HSLFTextRun> s3rtr1=s3tr.get(2).get(0).getTextRuns();
  List<HSLFTextRun> s3rtr2=s3tr.get(3).get(0).getTextRuns();
  assertEquals(2,s3rtr0.size());
  assertEquals(1,s3rtr1.size());
  assertEquals(2,s3rtr2.size());
  assertEquals("You are an important supplier of various items that I need",s3rtr0.get(0).getRawText());
  assertEquals("",s3rtr0.get(1).getRawText());
  assertEquals("Source: Internal focus groups",s3rtr1.get(0).getRawText());
  assertEquals("Illustrative Example",s3rtr2.get(0).getRawText());
  assertEquals("",s3rtr2.get(1).getRawText());
  List<List<HSLFTextParagraph>> s7tr=slideSevenC.getTextParagraphs();
  List<HSLFTextParagraph> s7rtr0=s7tr.get(0);
  List<HSLFTextParagraph> s7rtr1=s7tr.get(1);
  List<HSLFTextParagraph> s7rtr2=s7tr.get(2);
  assertEquals(1,s7rtr0.size());
  assertEquals(8,s7rtr1.size());
  assertEquals(1,s7rtr2.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTable </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddText() throws IOException {
  HSLFSlideShow ppt1=new HSLFSlideShow();
  HSLFSlide slide=ppt1.createSlide();
  HSLFTable tab=slide.createTable(4,5);
  int rows=tab.getNumberOfRows();
  int cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      c.setText("r" + (row + 1) + "c"+ (col + 1));
    }
  }
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ppt1.write(bos);
  ppt1.close();
  ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
  HSLFSlideShow ppt2=new HSLFSlideShow(bis);
  slide=ppt2.getSlides().get(0);
  tab=(HSLFTable)slide.getShapes().get(0);
  rows=tab.getNumberOfRows();
  cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      c.setText(c.getText() + "...");
    }
  }
  bos.reset();
  ppt2.write(bos);
  ppt2.close();
  bis=new ByteArrayInputStream(bos.toByteArray());
  HSLFSlideShow ppt3=new HSLFSlideShow(bis);
  slide=ppt3.getSlides().get(0);
  tab=(HSLFTable)slide.getShapes().get(0);
  rows=tab.getNumberOfRows();
  cols=tab.getNumberOfColumns();
  for (int row=0; row < rows; row++) {
    for (int col=0; col < cols; col++) {
      HSLFTableCell c=tab.getCell(row,col);
      assertEquals("r" + (row + 1) + "c"+ (col + 1)+ "...",c.getText());
    }
  }
  ppt3.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextRun </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test to ensure changing non rich text bytes->bytes works correctly
 */
@Test public void testSetText(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textRuns=slideOne.getTextParagraphs();
  HSLFTextParagraph run=textRuns.get(0).get(0);
  HSLFTextRun tr=run.getTextRuns().get(0);
  assertEquals("This is a test title",tr.getRawText());
  String changeTo="New test title";
  tr.setText(changeTo);
  assertEquals(changeTo,tr.getRawText());
  tr.setText(changeTo + "\n");
  assertEquals(changeTo + "\r",tr.getRawText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test case for Bug 41015.
 * In some cases RichTextRun.getText() threw StringIndexOutOfBoundsException because
 * of the wrong list of potential paragraph properties defined in StyleTextPropAtom.
 */
@Test public void testBug41015() throws IOException {
  List<HSLFTextRun> rt;
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("bug-41015.ppt"));
  HSLFSlide sl=ppt.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=sl.getTextParagraphs();
  assertEquals(2,textParass.size());
  List<HSLFTextParagraph> textParas=textParass.get(0);
  rt=textParass.get(0).get(0).getTextRuns();
  assertEquals(1,rt.size());
  assertEquals(0,textParass.get(0).get(0).getIndentLevel());
  assertEquals("sdfsdfsdf",rt.get(0).getRawText());
  textParas=textParass.get(1);
  String texts[]={"Sdfsdfsdf\r","Dfgdfg\r","Dfgdfgdfg\r","Sdfsdfs\r","Sdfsdf\r"};
  int indents[]={0,0,0,1,1};
  int i=0;
  for (  HSLFTextParagraph p : textParas) {
    assertEquals(texts[i],p.getTextRuns().get(0).getRawText());
    assertEquals(indents[i],p.getIndentLevel());
    i++;
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests to ensure that setting the text where the text is rich
 * sets everything to the same styling
 */
@Test public void testSetTextWhereRich(){
  HSLFSlide slideOne=ssRich.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  List<HSLFTextParagraph> trB=textParass.get(1);
  assertEquals(3,trB.size());
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  HSLFTextRun rtrC=trB.get(1).getTextRuns().get(0);
  HSLFTextRun rtrD=trB.get(2).getTextRuns().get(0);
  TextPropCollection tpBP=rtrB.getTextParagraph().getParagraphStyle();
  TextPropCollection tpBC=rtrB.getCharacterStyle();
  TextPropCollection tpCP=rtrC.getTextParagraph().getParagraphStyle();
  TextPropCollection tpCC=rtrC.getCharacterStyle();
  TextPropCollection tpDP=rtrD.getTextParagraph().getParagraphStyle();
  TextPropCollection tpDC=rtrD.getCharacterStyle();
  assertNotNull(tpBP);
  assertNotNull(tpBC);
  assertNotNull(tpCP);
  assertNotNull(tpCC);
  assertNotNull(tpDP);
  assertNotNull(tpDC);
  assertEquals(tpBP,tpCP);
  assertEquals(tpBP,tpDP);
  assertEquals(tpCP,tpDP);
  assertNotEquals(tpBC,tpCC);
  assertNotEquals(tpBC,tpDC);
  assertNotEquals(tpCC,tpDC);
  HSLFTextParagraph.setText(trB,"Test Foo Test");
  assertEquals(1,trB.get(0).getTextRuns().size());
  rtrB=trB.get(0).getTextRuns().get(0);
  assertEquals("Test Foo Test",HSLFTextParagraph.getRawText(trB));
  assertEquals("Test Foo Test",rtrB.getRawText());
  assertNotNull(rtrB.getCharacterStyle());
  assertNotNull(rtrB.getTextParagraph().getParagraphStyle());
  assertEquals(tpBP,rtrB.getTextParagraph().getParagraphStyle());
  assertEquals(tpBC,rtrB.getCharacterStyle());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests to ensure that non rich text has the right default rich text run
 * set up for it
 */
@Test public void testGetRichTextNonRich(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  assertEquals(2,textParass.size());
  List<HSLFTextParagraph> trA=textParass.get(0);
  List<HSLFTextParagraph> trB=textParass.get(1);
  assertEquals(1,trA.size());
  assertEquals(2,trB.size());
  HSLFTextRun rtrA=trA.get(0).getTextRuns().get(0);
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  assertEquals(HSLFTextParagraph.getRawText(trA),rtrA.getRawText());
  assertEquals(HSLFTextParagraph.getRawText(trB.subList(0,1)),rtrB.getRawText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to ensure the right stuff happens if we change the text
 * in a rich text run, that doesn't happen to actually be rich
 */
@Test public void testChangeTextInRichTextRunNonRich(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textRuns=slideOne.getTextParagraphs();
  List<HSLFTextParagraph> trB=textRuns.get(1);
  assertEquals(1,trB.get(0).getTextRuns().size());
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  assertEquals(HSLFTextParagraph.getRawText(trB.subList(0,1)),rtrB.getRawText());
  assertNotNull(rtrB.getCharacterStyle());
  assertNotNull(rtrB.getTextParagraph().getParagraphStyle());
  rtrB.setText("Test Test Test");
  assertEquals("Test Test Test",HSLFTextParagraph.getRawText(trB.subList(0,1)));
  assertEquals("Test Test Test",rtrB.getRawText());
  assertNotNull(rtrB.getCharacterStyle());
  assertNotNull(rtrB.getTextParagraph().getParagraphStyle());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to ensure that changing non rich text between bytes and
 * chars works correctly
 */
@SuppressWarnings("unused") @Test public void testAdvancedSetText(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<HSLFTextParagraph> paras=slideOne.getTextParagraphs().get(0);
  HSLFTextParagraph para=paras.get(0);
  TextHeaderAtom tha=null;
  TextBytesAtom tba=null;
  TextCharsAtom tca=null;
  for (  Record r : para.getRecords()) {
    if (r instanceof TextHeaderAtom)     tha=(TextHeaderAtom)r;
 else     if (r instanceof TextBytesAtom)     tba=(TextBytesAtom)r;
 else     if (r instanceof TextCharsAtom)     tca=(TextCharsAtom)r;
  }
  assertNull(tca);
  assertNotNull(tba);
  assertEquals("This is a test title",para.getTextRuns().get(0).getRawText());
  String changeBytesOnly="New Test Title";
  HSLFTextParagraph.setText(paras,changeBytesOnly);
  para=paras.get(0);
  tha=null;
  tba=null;
  tca=null;
  for (  Record r : para.getRecords()) {
    if (r instanceof TextHeaderAtom)     tha=(TextHeaderAtom)r;
 else     if (r instanceof TextBytesAtom)     tba=(TextBytesAtom)r;
 else     if (r instanceof TextCharsAtom)     tca=(TextCharsAtom)r;
  }
  assertEquals(changeBytesOnly,HSLFTextParagraph.getRawText(paras));
  assertNull(tca);
  assertNotNull(tba);
  assertNull(tca);
  assertNotNull(tba);
  assertEquals(changeBytesOnly,HSLFTextParagraph.getRawText(paras));
  String changeByteChar="This is a test title with a '\u0121' g with a dot";
  HSLFTextParagraph.setText(paras,changeByteChar);
  para=paras.get(0);
  tha=null;
  tba=null;
  tca=null;
  for (  Record r : para.getRecords()) {
    if (r instanceof TextHeaderAtom)     tha=(TextHeaderAtom)r;
 else     if (r instanceof TextBytesAtom)     tba=(TextBytesAtom)r;
 else     if (r instanceof TextCharsAtom)     tca=(TextCharsAtom)r;
  }
  assertEquals(changeByteChar,HSLFTextParagraph.getRawText(paras));
  assertNotNull(tca);
  assertNull(tba);
  assertNull(tba);
  assertNotNull(tca);
  assertEquals(changeByteChar,HSLFTextParagraph.getRawText(paras));
  String changeCharChar="This is a test title with a '\u0147' N with a hat";
  HSLFTextParagraph.setText(paras,changeCharChar);
  para=paras.get(0);
  tha=null;
  tba=null;
  tca=null;
  for (  Record r : para.getRecords()) {
    if (r instanceof TextHeaderAtom)     tha=(TextHeaderAtom)r;
 else     if (r instanceof TextBytesAtom)     tba=(TextBytesAtom)r;
 else     if (r instanceof TextCharsAtom)     tca=(TextCharsAtom)r;
  }
  assertEquals(changeCharChar,HSLFTextParagraph.getRawText(paras));
  assertNotNull(tca);
  assertNull(tba);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests to ensure that setting the text where the text isn't rich,
 * ensuring that everything stays with the same default styling
 */
@Test public void testSetTextWhereNotRich(){
  HSLFSlide slideOne=ss.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  List<HSLFTextParagraph> trB=textParass.get(0);
  assertEquals(1,trB.size());
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  assertEquals(HSLFTextParagraph.getText(trB),rtrB.getRawText());
  HSLFTextParagraph.setText(trB,"Test Foo Test");
  rtrB=trB.get(0).getTextRuns().get(0);
  assertEquals("Test Foo Test",HSLFTextParagraph.getRawText(trB));
  assertEquals("Test Foo Test",rtrB.getRawText());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test48916() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("SampleShow.ppt"));
  List<HSLFSlide> slides=ppt.getSlides();
  for (  HSLFSlide slide : slides) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (!(sh instanceof HSLFTextShape))       continue;
      HSLFTextShape tx=(HSLFTextShape)sh;
      List<HSLFTextParagraph> paras=tx.getTextParagraphs();
      Record[] runChildren=paras.get(0).getRecords();
      Record[] txboxChildren=tx.getEscherTextboxWrapper().getChildRecords();
      assertEquals(runChildren.length,txboxChildren.length);
      for (int i=0; i < txboxChildren.length; i++) {
        assertSame(txboxChildren[i],runChildren[i]);
      }
      for (      HSLFTextParagraph p : paras) {
        for (        HSLFTextRun rt : p.getTextRuns()) {
          rt.setBold(true);
          rt.setFontColor(Color.RED);
        }
      }
    }
  }
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  for (  HSLFSlide slide : ppt.getSlides()) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (sh instanceof HSLFTextShape) {
        HSLFTextShape tx=(HSLFTextShape)sh;
        List<HSLFTextParagraph> run=tx.getTextParagraphs();
        HSLFTextRun rt=run.get(0).getTextRuns().get(0);
        assertTrue(rt.isBold());
        assertTrue(sameColor(Color.RED,rt.getFontColor()));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests to ensure that the rich text runs are built up correctly
 */
@Test public void testGetRichText(){
  HSLFSlide slideOne=ssRich.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  assertEquals(2,textParass.size());
  List<HSLFTextParagraph> trA=textParass.get(0);
  List<HSLFTextParagraph> trB=textParass.get(1);
  assertEquals(1,trA.size());
  assertEquals(3,trB.size());
  HSLFTextRun rtrA=trA.get(0).getTextRuns().get(0);
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  HSLFTextRun rtrC=trB.get(1).getTextRuns().get(0);
  HSLFTextRun rtrD=trB.get(2).getTextRuns().get(0);
  assertEquals(HSLFTextParagraph.getRawText(trA),rtrA.getRawText());
  String trBstr=HSLFTextParagraph.getRawText(trB);
  assertEquals(trBstr.substring(0,30),rtrB.getRawText());
  assertEquals(trBstr.substring(30,58),rtrC.getRawText());
  assertEquals(trBstr.substring(58,82),rtrD.getRawText());
  assertEquals(trB.get(0).getParagraphStyle(),trB.get(1).getParagraphStyle());
  assertEquals(trB.get(0).getParagraphStyle(),trB.get(2).getParagraphStyle());
  assertNotEquals(rtrB.getCharacterStyle(),rtrC.getCharacterStyle());
  assertNotEquals(rtrB.getCharacterStyle(),rtrD.getCharacterStyle());
  assertNotEquals(rtrC.getCharacterStyle(),rtrD.getCharacterStyle());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests to ensure changing the text within rich text runs works
 * correctly
 */
@Test public void testChangeTextInRichTextRun(){
  HSLFSlide slideOne=ssRich.getSlides().get(0);
  List<List<HSLFTextParagraph>> textParass=slideOne.getTextParagraphs();
  List<HSLFTextParagraph> trB=textParass.get(1);
  assertEquals(3,trB.size());
  HSLFTextRun rtrB=trB.get(0).getTextRuns().get(0);
  HSLFTextRun rtrC=trB.get(1).getTextRuns().get(0);
  HSLFTextRun rtrD=trB.get(2).getTextRuns().get(0);
  TextPropCollection tpBP=rtrB.getTextParagraph().getParagraphStyle();
  TextPropCollection tpBC=rtrB.getCharacterStyle();
  TextPropCollection tpCP=rtrC.getTextParagraph().getParagraphStyle();
  TextPropCollection tpCC=rtrC.getCharacterStyle();
  TextPropCollection tpDP=rtrD.getTextParagraph().getParagraphStyle();
  TextPropCollection tpDC=rtrD.getCharacterStyle();
  assertEquals(HSLFTextParagraph.getRawText(trB).substring(0,30),rtrB.getRawText());
  assertNotNull(tpBP);
  assertNotNull(tpBC);
  assertNotNull(tpCP);
  assertNotNull(tpCC);
  assertNotNull(tpDP);
  assertNotNull(tpDC);
  assertEquals(tpBP,tpCP);
  assertEquals(tpBP,tpDP);
  assertEquals(tpCP,tpDP);
  assertNotEquals(tpBC,tpCC);
  assertNotEquals(tpBC,tpDC);
  assertNotEquals(tpCC,tpDC);
  assertEquals("This is the subtitle, in bold\r",rtrB.getRawText());
  assertEquals("This bit is blue and italic\r",rtrC.getRawText());
  assertEquals("This bit is red (normal)",rtrD.getRawText());
  String newBText="New Subtitle, will still be bold\n";
  String newCText="New blue and italic text\n";
  String newDText="Funky new normal red text";
  rtrB.setText(newBText);
  rtrC.setText(newCText);
  rtrD.setText(newDText);
  HSLFTextParagraph.storeText(trB);
  assertEquals(newBText.replace('\n','\r'),rtrB.getRawText());
  assertEquals(newCText.replace('\n','\r'),rtrC.getRawText());
  assertEquals(newDText.replace('\n','\r'),rtrD.getRawText());
  assertEquals(newBText.replace('\n','\r') + newCText.replace('\n','\r') + newDText.replace('\n','\r'),HSLFTextParagraph.getRawText(trB));
  assertEquals(newBText.length(),tpBC.getCharactersCovered());
  assertEquals(newCText.length(),tpCC.getCharactersCovered());
  assertEquals(newDText.length() + 1,tpDC.getCharactersCovered());
  assertEquals(newBText.length() + newCText.length() + newDText.length()+ 1,tpBP.getCharactersCovered() + tpCP.getCharactersCovered() + tpDP.getCharactersCovered());
  TextPropCollection ntpBC=rtrB.getCharacterStyle();
  TextPropCollection ntpCC=rtrC.getCharacterStyle();
  TextPropCollection ntpDC=rtrD.getCharacterStyle();
  assertEquals(tpBC.getTextPropList(),ntpBC.getTextPropList());
  assertEquals(tpCC.getTextPropList(),ntpCC.getTextPropList());
  assertEquals(tpDC.getTextPropList(),ntpDC.getTextPropList());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test creation of TextRun objects.
 */
@Test public void testAddTextRun(){
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  assertEquals(0,slide.getTextParagraphs().size());
  HSLFTextBox shape1=new HSLFTextBox();
  List<HSLFTextParagraph> run1=shape1.getTextParagraphs();
  shape1.setText("Text 1");
  slide.addShape(shape1);
  List<List<HSLFTextParagraph>> runs=slide.getTextParagraphs();
  assertNotNull(runs);
  assertSame(run1,runs.get(0));
  HSLFTextBox shape2=new HSLFTextBox();
  List<HSLFTextParagraph> run2=shape2.getTextParagraphs();
  shape2.setText("Text 2");
  slide.addShape(shape2);
  runs=slide.getTextParagraphs();
  assertEquals(2,runs.size());
  assertSame(run1,runs.get(0));
  assertSame(run2,runs.get(1));
  List<HSLFShape> sh=slide.getShapes();
  assertEquals(2,sh.size());
  assertTrue(sh.get(0) instanceof HSLFTextBox);
  HSLFTextBox box1=(HSLFTextBox)sh.get(0);
  assertSame(run1,box1.getTextParagraphs());
  HSLFTextBox box2=(HSLFTextBox)sh.get(1);
  assertSame(run2,box2.getTextParagraphs());
  HSLFSlide slide2=ppt.createSlide();
  assertTrue(slide2.getTextParagraphs().isEmpty());
  HSLFTable table=new HSLFTable(2,2);
  slide2.addShape(table);
  runs=slide2.getTextParagraphs();
  assertNotNull(runs);
  assertEquals(4,runs.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextShape </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify we can get text from TextShape in the following cases:
 * - placeholders
 * - normal TextBox object
 * - text in auto-shapes
 */
@Test public void read() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("text_shapes.ppt"));
  List<String> lst1=new ArrayList<String>();
  HSLFSlide slide=ppt.getSlides().get(0);
  for (  HSLFShape shape : slide.getShapes()) {
    assertTrue("Expected TextShape but found " + shape.getClass().getName(),shape instanceof HSLFTextShape);
    HSLFTextShape tx=(HSLFTextShape)shape;
    List<HSLFTextParagraph> paras=tx.getTextParagraphs();
    assertNotNull(paras);
    int runType=paras.get(0).getRunType();
    ShapeType type=shape.getShapeType();
    String rawText=HSLFTextParagraph.getRawText(paras);
switch (type) {
case TEXT_BOX:
      assertEquals("Text in a TextBox",rawText);
    break;
case RECT:
  if (runType == TextHeaderAtom.OTHER_TYPE)   assertEquals("Rectangle",rawText);
 else   if (runType == TextHeaderAtom.TITLE_TYPE)   assertEquals("Title Placeholder",rawText);
break;
case OCTAGON:
assertEquals("Octagon",rawText);
break;
case ELLIPSE:
assertEquals("Ellipse",rawText);
break;
case ROUND_RECT:
assertEquals("RoundRectangle",rawText);
break;
default :
fail("Unexpected shape: " + shape.getShapeName());
}
lst1.add(rawText);
}
List<String> lst2=new ArrayList<String>();
for (List<HSLFTextParagraph> paras : slide.getTextParagraphs()) {
lst2.add(HSLFTextParagraph.getRawText(paras));
}
assertTrue(lst1.containsAll(lst2));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readWrite() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow();
  HSLFSlide slide=ppt.createSlide();
  HSLFTextShape shape1=new HSLFTextBox();
  shape1.setText("Hello, World!");
  slide.addShape(shape1);
  shape1.moveTo(100,100);
  HSLFTextShape shape2=new HSLFAutoShape(ShapeType.RIGHT_ARROW);
  shape2.setText("Testing TextShape");
  slide.addShape(shape2);
  shape2.moveTo(300,300);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  out.close();
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  slide=ppt.getSlides().get(0);
  List<HSLFShape> shape=slide.getShapes();
  assertTrue(shape.get(0) instanceof HSLFTextShape);
  shape1=(HSLFTextShape)shape.get(0);
  assertEquals(ShapeType.TEXT_BOX,shape1.getShapeType());
  assertEquals("Hello, World!",shape1.getText());
  assertTrue(shape.get(1) instanceof HSLFTextShape);
  shape1=(HSLFTextShape)shape.get(1);
  assertEquals(ShapeType.RIGHT_ARROW,shape1.getShapeType());
  assertEquals("Testing TextShape",shape1.getText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void margins() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("text-margins.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  Map<String,HSLFTextShape> map=new HashMap<String,HSLFTextShape>();
  for (  HSLFShape shape : slide.getShapes()) {
    if (shape instanceof HSLFTextShape) {
      HSLFTextShape tx=(HSLFTextShape)shape;
      map.put(tx.getText(),tx);
    }
  }
  HSLFTextShape tx;
  tx=map.get("TEST1");
  assertEquals(7.2,tx.getLeftInset(),0);
  assertEquals(7.2,tx.getRightInset(),0);
  assertEquals(28.34,tx.getTopInset(),0.01);
  assertEquals(3.6,tx.getBottomInset(),0);
  tx=map.get("TEST2");
  assertEquals(7.2,tx.getLeftInset(),0);
  assertEquals(7.2,tx.getRightInset(),0);
  assertEquals(3.6,tx.getTopInset(),0);
  assertEquals(28.34,tx.getBottomInset(),0.01);
  tx=map.get("TEST3");
  assertEquals(28.34,tx.getLeftInset(),0.01);
  assertEquals(7.2,tx.getRightInset(),0);
  assertEquals(3.6,tx.getTopInset(),0);
  assertEquals(3.6,tx.getBottomInset(),0);
  tx=map.get("TEST4");
  assertEquals(7.2,tx.getLeftInset(),0);
  assertEquals(28.34,tx.getRightInset(),0.01);
  assertEquals(3.6,tx.getTopInset(),0);
  assertEquals(3.6,tx.getBottomInset(),0);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug52599() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("52599.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  List<HSLFShape> sh=slide.getShapes();
  assertEquals(3,sh.size());
  HSLFTextShape sh0=(HSLFTextShape)sh.get(0);
  assertNotNull(sh0.getTextParagraphs());
  assertEquals("",sh0.getText());
  HSLFTextShape sh1=(HSLFTextShape)sh.get(1);
  assertNotNull(sh1.getTextParagraphs());
  assertEquals("",sh1.getText());
  HSLFTextShape sh2=(HSLFTextShape)sh.get(2);
  assertEquals("this box should be shown just once",sh2.getText());
  assertEquals(-1,sh2.getTextParagraphs().get(0).getIndex());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.util.TestSystemTimeUtils </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDateA() throws Exception {
  Date date=SystemTimeUtils.getDate(data_a);
  Date exp=sdf.parse("2006-01-24 10:26:15.205");
  assertEquals(exp.getTime(),date.getTime());
  assertEquals(exp,date);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDateB() throws Exception {
  Date date=SystemTimeUtils.getDate(data_b,8 + 4);
  Date exp=sdf.parse("2006-01-24 21:25:03.725");
  assertEquals(exp.getTime(),date.getTime());
  assertEquals(exp,date);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hsmf.TestFixedSizedProperties </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Will be based on the ClientSubmit time
 */
@Test public void testClientSubmitTime() throws Exception {
  Calendar clientSubmitTime=mapiMessageSucceeds.getMessageDate();
  assertEquals("Fri, 22 Jun 2012 18:32:54",messageDateFormat.format(clientSubmitTime.getTime()));
  Map<MAPIProperty,List<PropertyValue>> props=mapiMessageSucceeds.getMainChunks().getProperties();
  List<PropertyValue> pv=props.get(MAPIProperty.CLIENT_SUBMIT_TIME);
  assertNotNull(pv);
  assertEquals(1,pv.size());
  clientSubmitTime=(Calendar)pv.get(0).getValue();
  assertEquals("Fri, 22 Jun 2012 18:32:54",messageDateFormat.format(clientSubmitTime.getTime()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.extractor.TestOldExcelExtractor </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMain() throws Exception {
  File file=HSSFTestDataSamples.getSampleFile("testEXCEL_3.xls");
  PrintStream save=System.out;
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    try {
      PrintStream str=new PrintStream(out,false,"UTF-8");
      System.setOut(str);
      OldExcelExtractor.main(new String[]{file.getAbsolutePath()});
    }
  finally {
      out.close();
    }
    String string=new String(out.toByteArray(),"UTF-8");
    assertTrue("Had: " + string,string.contains("Table C-13--Lemons"));
  }
  finally {
    System.setOut(save);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromFile() throws Exception {
  for (  String ver : new String[]{"4","5","95"}) {
    String filename="testEXCEL_" + ver + ".xls";
    File f=HSSFTestDataSamples.getSampleFile(filename);
    OldExcelExtractor extractor=new OldExcelExtractor(f);
    String text=extractor.getText();
    assertNotNull(text);
    assertTrue(text.length() > 100);
    extractor.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestFormulaParser </h4><pre class="type-2 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test57196_Formula(){
  HSSFWorkbook wb=new HSSFWorkbook();
  Ptg[] ptgs=HSSFFormulaParser.parse("DEC2HEX(HEX2DEC(O8)-O2+D2)",wb,FormulaType.CELL,-1);
  assertNotNull("Ptg array should not be null",ptgs);
  confirmTokenClasses(ptgs,NameXPtg.class,NameXPtg.class,RefPtg.class,FuncVarPtg.class,RefPtg.class,SubtractPtg.class,RefPtg.class,AddPtg.class,FuncVarPtg.class);
  RefPtg o8=(RefPtg)ptgs[2];
  FuncVarPtg hex2Dec=(FuncVarPtg)ptgs[3];
  RefPtg o2=(RefPtg)ptgs[4];
  RefPtg d2=(RefPtg)ptgs[6];
  FuncVarPtg dec2Hex=(FuncVarPtg)ptgs[8];
  assertEquals("O8",o8.toFormulaString());
  assertEquals(255,hex2Dec.getFunctionIndex());
  assertEquals("O2",o2.toFormulaString());
  assertEquals("D2",d2.toFormulaString());
  assertEquals(255,dec2Hex.getFunctionIndex());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRVA </h4><pre class="type-2 type-14 type-10 type-3 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void confirmCell(){
  Ptg[] excelPtgs=FormulaExtractor.getPtgs(formulaCell);
  Ptg[] poiPtgs=HSSFFormulaParser.parse(formula,workbook);
  int nExcelTokens=excelPtgs.length;
  int nPoiTokens=poiPtgs.length;
  if (nExcelTokens != nPoiTokens) {
    if (nExcelTokens == nPoiTokens + 1 && excelPtgs[0].getClass() == AttrPtg.class) {
      Ptg[] temp=new Ptg[nExcelTokens];
      temp[0]=excelPtgs[0];
      System.arraycopy(poiPtgs,0,temp,1,nPoiTokens);
      poiPtgs=temp;
    }
 else {
      fail("Expected " + nExcelTokens + " tokens but got "+ nPoiTokens);
    }
  }
  boolean hasMismatch=false;
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < nExcelTokens; i++) {
    Ptg poiPtg=poiPtgs[i];
    Ptg excelPtg=excelPtgs[i];
    if (excelPtg.getClass() != poiPtg.getClass()) {
      hasMismatch=true;
      sb.append("  mismatch token type[" + i + "] "+ getShortClassName(excelPtg)+ " "+ excelPtg.getRVAType()+ " - "+ getShortClassName(poiPtg)+ " "+ poiPtg.getRVAType());
      sb.append(NEW_LINE);
      continue;
    }
    if (poiPtg.isBaseToken()) {
      continue;
    }
    sb.append("  token[" + i + "] "+ excelPtg.toString()+ " "+ excelPtg.getRVAType());
    if (excelPtg.getPtgClass() != poiPtg.getPtgClass()) {
      hasMismatch=true;
      sb.append(" - was " + poiPtg.getRVAType());
    }
    sb.append(NEW_LINE);
  }
  assertFalse(hasMismatch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRowBlocksReader </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbnormalPivotTableRecords_bug46280(){
  int SXVIEW_SID=ViewDefinitionRecord.sid;
  Record[] inRecs={new RowRecord(0),new NumberRecord(),new UnknownRecord(SXVIEW_SID,"dummydata (SXVIEW: View Definition)".getBytes(LocaleUtil.CHARSET_1252)),new WindowTwoRecord()};
  RecordStream rs=new RecordStream(Arrays.asList(inRecs),0);
  RowBlocksReader rbr=new RowBlocksReader(rs);
  if (rs.peekNextClass() == WindowTwoRecord.class) {
    fail("Identified bug 46280b");
  }
  RecordStream rbStream=rbr.getPlainRecordStream();
  assertEquals(inRecs[0],rbStream.getNext());
  assertEquals(inRecs[1],rbStream.getNext());
  assertFalse(rbStream.hasNext());
  assertTrue(rs.hasNext());
  assertEquals(inRecs[2],rs.getNext());
  assertEquals(inRecs[3],rs.getNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestSheet </h4><pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Makes sure all rows registered for this sheet are aggregated, they were being skipped
 */
@Test public void testRowAggregation(){
  List<Record> records=new ArrayList<Record>();
  records.add(InternalSheet.createBOF());
  records.add(new DimensionsRecord());
  records.add(new RowRecord(0));
  records.add(new RowRecord(1));
  FormulaRecord formulaRecord=new FormulaRecord();
  formulaRecord.setCachedResultTypeString();
  records.add(formulaRecord);
  records.add(new StringRecord());
  records.add(new RowRecord(2));
  records.add(createWindow2Record());
  records.add(EOFRecord.instance);
  InternalSheet sheet=createSheet(records);
  assertNotNull("Row [2] was skipped",sheet.getRow(2));
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCreateSheet(){
  List<Record> records=new ArrayList<Record>();
  records.add(BOFRecord.createSheetBOF());
  records.add(new DimensionsRecord());
  records.add(createWindow2Record());
  records.add(EOFRecord.instance);
  InternalSheet sheet=createSheet(records);
  Record[] outRecs=getSheetRecords(sheet,0);
  int pos=0;
  assertTrue(outRecs[pos++] instanceof BOFRecord);
  assertTrue(outRecs[pos++] instanceof IndexRecord);
  assertTrue(outRecs[pos++] instanceof DimensionsRecord);
  assertTrue(outRecs[pos++] instanceof WindowTwoRecord);
  assertTrue(outRecs[pos++] instanceof EOFRecord);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Prior to bug 45145 <tt>RowRecordsAggregate</tt> and <tt>ValueRecordsAggregate</tt> could
 * sometimes occur in reverse order.  This test reproduces one of those situations and makes
 * sure that RRA comes before VRA.<br/>
 * The code here represents a normal POI use case where a spreadsheet is created from scratch.
 */
@Test public void testRowValueAggregatesOrder_bug45145(){
  InternalSheet sheet=InternalSheet.createSheet();
  RowRecord rr=new RowRecord(5);
  sheet.addRow(rr);
  CellValueRecordInterface cvr=new BlankRecord();
  cvr.setColumn((short)0);
  cvr.setRow(5);
  sheet.addValueRecord(5,cvr);
  int dbCellRecordPos=getDbCellRecordPos(sheet);
  if (dbCellRecordPos == 252) {
    throw new AssertionFailedError("Identified  bug 45145");
  }
  assertEquals(242,dbCellRecordPos);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug: 22922 (Reported by Xuemin Guan)
 * <p>
 * Remove mergedregion fails when a sheet loses records after an initial CreateSheet
 * fills up the records.
 */
@Test public void testMovingMergedRegion(){
  List<Record> records=new ArrayList<Record>();
  CellRangeAddress[] cras={new CellRangeAddress(0,1,0,2)};
  MergeCellsRecord merged=new MergeCellsRecord(cras,0,cras.length);
  records.add(BOFRecord.createSheetBOF());
  records.add(new DimensionsRecord());
  records.add(new RowRecord(0));
  records.add(new RowRecord(1));
  records.add(new RowRecord(2));
  records.add(createWindow2Record());
  records.add(EOFRecord.instance);
  records.add(merged);
  InternalSheet sheet=createSheet(records);
  sheet.getRecords().remove(0);
  sheet.removeMergedRegion(0);
  assertEquals("Should be no more merged regions",0,sheet.getNumMergedRegions());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestHyperlinkRecord </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadURLLink(){
  RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data1);
  HyperlinkRecord link=new HyperlinkRecord(is);
  assertEquals(2,link.getFirstRow());
  assertEquals(2,link.getLastRow());
  assertEquals(0,link.getFirstColumn());
  assertEquals(0,link.getLastColumn());
  confirmGUID(HyperlinkRecord.STD_MONIKER,link.getGuid());
  confirmGUID(HyperlinkRecord.URL_MONIKER,link.getMoniker());
  assertEquals(2,link.getLabelOptions());
  int opts=HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_ABS | HyperlinkRecord.HLINK_LABEL;
  assertEquals(0x17,opts);
  assertEquals(opts,link.getLinkOptions());
  assertEquals(0,link.getFileOptions());
  assertEquals("My Link",link.getLabel());
  assertEquals("http://www.lakings.com/",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadDocumentLink(){
  RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data4);
  HyperlinkRecord link=new HyperlinkRecord(is);
  assertEquals(3,link.getFirstRow());
  assertEquals(3,link.getLastRow());
  assertEquals(0,link.getFirstColumn());
  assertEquals(0,link.getLastColumn());
  confirmGUID(HyperlinkRecord.STD_MONIKER,link.getGuid());
  assertEquals(2,link.getLabelOptions());
  int opts=HyperlinkRecord.HLINK_LABEL | HyperlinkRecord.HLINK_PLACE;
  assertEquals(0x1C,opts);
  assertEquals(opts,link.getLinkOptions());
  assertEquals("place",link.getLabel());
  assertEquals("Sheet1!A1",link.getTextMark());
  assertEquals("Sheet1!A1",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadEmailLink(){
  RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data3);
  HyperlinkRecord link=new HyperlinkRecord(is);
  assertEquals(1,link.getFirstRow());
  assertEquals(1,link.getLastRow());
  assertEquals(0,link.getFirstColumn());
  assertEquals(0,link.getLastColumn());
  confirmGUID(HyperlinkRecord.STD_MONIKER,link.getGuid());
  confirmGUID(HyperlinkRecord.URL_MONIKER,link.getMoniker());
  assertEquals(2,link.getLabelOptions());
  int opts=HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_ABS | HyperlinkRecord.HLINK_LABEL;
  assertEquals(0x17,opts);
  assertEquals(opts,link.getLinkOptions());
  assertEquals("email",link.getLabel());
  assertEquals("mailto:ebgans@mail.ru?subject=Hello,%20Ebgans!",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test47498(){
  RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data_47498);
  HyperlinkRecord link=new HyperlinkRecord(is);
  assertEquals(2,link.getFirstRow());
  assertEquals(2,link.getLastRow());
  assertEquals(0,link.getFirstColumn());
  assertEquals(0,link.getLastColumn());
  confirmGUID(HyperlinkRecord.STD_MONIKER,link.getGuid());
  confirmGUID(HyperlinkRecord.URL_MONIKER,link.getMoniker());
  assertEquals(2,link.getLabelOptions());
  int opts=HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_LABEL;
  assertEquals(opts,link.getLinkOptions());
  assertEquals(0,link.getFileOptions());
  assertEquals("PDF",link.getLabel());
  assertEquals("testfolder/test.PDF",link.getAddress());
  byte[] ser=link.serialize();
  TestcaseRecordInputStream.confirmRecordEncoding(HyperlinkRecord.sid,data_47498,ser);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadFileLink(){
  RecordInputStream is=TestcaseRecordInputStream.create(HyperlinkRecord.sid,data2);
  HyperlinkRecord link=new HyperlinkRecord(is);
  assertEquals(0,link.getFirstRow());
  assertEquals(0,link.getLastRow());
  assertEquals(0,link.getFirstColumn());
  assertEquals(0,link.getLastColumn());
  confirmGUID(HyperlinkRecord.STD_MONIKER,link.getGuid());
  confirmGUID(HyperlinkRecord.FILE_MONIKER,link.getMoniker());
  assertEquals(2,link.getLabelOptions());
  int opts=HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_LABEL;
  assertEquals(0x15,opts);
  assertEquals(opts,link.getLinkOptions());
  assertEquals("file",link.getLabel());
  assertEquals("link1.xls",link.getShortFilename());
  assertEquals("link1.xls",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReserializeLinkToWorkbook(){
  RecordInputStream in=TestcaseRecordInputStream.create(HyperlinkRecord.sid,dataLinkToWorkbook);
  HyperlinkRecord hr=new HyperlinkRecord(in);
  byte[] ser=hr.serialize();
  TestcaseRecordInputStream.confirmRecordEncoding(HyperlinkRecord.sid,dataLinkToWorkbook,ser);
  assertNotEquals("Identified bug in reading workbook link","YEARFR~1.XLS",hr.getAddress());
  assertEquals("yearfracExamples.xls",hr.getAddress());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestSSTRecord </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * SST is often split over several {@link ContinueRecord}s
 * @throws IOException 
 */
@Test public void testContinuedRecord() throws IOException {
  byte[] origData;
  SSTRecord record;
  byte[] ser_output;
  origData=concatHexDumps("BigSSTRecord","BigSSTRecordCR");
  record=createSSTFromRawData(origData);
  assertEquals(1464,record.getNumStrings());
  assertEquals(688,record.getNumUniqueStrings());
  assertEquals(688,record.countStrings());
  ser_output=record.serialize();
  assertArrayEquals(origData,ser_output);
  origData=concatHexDumps("BigSSTRecord2","BigSSTRecord2CR1","BigSSTRecord2CR2","BigSSTRecord2CR3","BigSSTRecord2CR4","BigSSTRecord2CR5","BigSSTRecord2CR6","BigSSTRecord2CR7");
  record=createSSTFromRawData(origData);
  assertEquals(158642,record.getNumStrings());
  assertEquals(5249,record.getNumUniqueStrings());
  assertEquals(5249,record.countStrings());
  ser_output=record.serialize();
  SSTRecord rec2=createSSTFromRawData(ser_output);
  if (!areSameSSTs(record,rec2)) {
    throw new AssertionFailedError("large SST re-serialized incorrectly");
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test50779_2(){
  byte[] bytes=HexRead.readFromString(data_50779_2);
  RecordInputStream in=TestcaseRecordInputStream.create(bytes);
  assertEquals(SSTRecord.sid,in.getSid());
  SSTRecord src=new SSTRecord(in);
  assertEquals(81,src.getNumStrings());
  byte[] serialized=src.serialize();
  in=TestcaseRecordInputStream.create(serialized);
  assertEquals(SSTRecord.sid,in.getSid());
  SSTRecord dst=new SSTRecord(in);
  assertEquals(81,dst.getNumStrings());
  assertRecordEquals(src,dst);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test57456(){
  byte[] bytes=HexRead.readFromString("FC, 00, 08, 00, 00, 00, 00, 00, E1, 06, 00, 00");
  RecordInputStream in=TestcaseRecordInputStream.create(bytes);
  assertEquals(SSTRecord.sid,in.getSid());
  SSTRecord src=new SSTRecord(in);
  assertEquals(0,src.getNumStrings());
  assertEquals(0,src.getNumUniqueStrings());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test50779_1(){
  byte[] bytes=HexRead.readFromString(data_50779_1);
  RecordInputStream in=TestcaseRecordInputStream.create(bytes);
  assertEquals(SSTRecord.sid,in.getSid());
  SSTRecord src=new SSTRecord(in);
  assertEquals(81,src.getNumStrings());
  byte[] serialized=src.serialize();
  in=TestcaseRecordInputStream.create(serialized);
  assertEquals(SSTRecord.sid,in.getSid());
  SSTRecord dst=new SSTRecord(in);
  assertEquals(81,dst.getNumStrings());
  assertRecordEquals(src,dst);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test simple addString
 */
@Test public void testSimpleAddString(){
  SSTRecord record=new SSTRecord();
  UnicodeString s1=new UnicodeString("Hello world");
  UnicodeString s2=new UnicodeString("Hello world\u2122");
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(1,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(2,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(1,record.addString(s2));
  assertEquals(s2,record.getString(1));
  assertEquals(2,record.countStrings());
  assertEquals(3,record.getNumStrings());
  assertEquals(2,record.getNumUniqueStrings());
  Iterator<UnicodeString> iter=record.getStrings();
  while (iter.hasNext()) {
    UnicodeString ucs=iter.next();
    if (ucs.equals(s1)) {
      assertEquals((byte)0,ucs.getOptionFlags());
    }
 else     if (ucs.equals(s2)) {
      assertEquals((byte)1,ucs.getOptionFlags());
    }
 else {
      fail("cannot match string: " + ucs.getString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.aggregates.TestRowRecordsAggregate </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Prior to Aug 2008, POI would re-serialize spreadsheets with {@link ArrayRecord}s or{@link TableRecord}s with those records out of order.  Similar to{@link SharedFormulaRecord}s, these records should appear immediately after the first{@link FormulaRecord}s that they apply to (and only once).<br/>
 */
@Test public void testArraysAndTables() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("testArraysAndTables.xls");
  Record[] sheetRecs=RecordInspector.getRecords(wb.getSheetAt(0),0);
  int countArrayFormulas=verifySharedValues(sheetRecs,ArrayRecord.class);
  assertEquals(5,countArrayFormulas);
  int countTableFormulas=verifySharedValues(sheetRecs,TableRecord.class);
  assertEquals(3,countTableFormulas);
  int countSharedFormulas=verifySharedValues(sheetRecs,SharedFormulaRecord.class);
  assertEquals(0,countSharedFormulas);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.aggregates.TestValueRecordsAggregate </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Sometimes the 'shared formula' flag (<tt>FormulaRecord.isSharedFormula()</tt>) is set when
 * there is no corresponding SharedFormulaRecord available. SharedFormulaRecord definitions do
 * not span multiple sheets.  They are are only defined within a sheet, and thus they do not
 * have a sheet index field (only row and column range fields).<br/>
 * So it is important that the code which locates the SharedFormulaRecord for each
 * FormulaRecord does not allow matches across sheets.</br>
 * Prior to bugzilla 44449 (Feb 2008), POI <tt>ValueRecordsAggregate.construct(int, List)</tt>
 * allowed <tt>SharedFormulaRecord</tt>s to be erroneously used across sheets.  That incorrect
 * behaviour is shown by this test.<p/>
 * <b>Notes on how to produce the test spreadsheet</b>:</p>
 * The setup for this test (AbnormalSharedFormulaFlag.xls) is rather fragile, insomuchas
 * re-saving the file (either with Excel or POI) clears the flag.<br/>
 * <ol>
 * <li>A new spreadsheet was created in Excel (File | New | Blank Workbook).</li>
 * <li>Sheet3 was deleted.</li>
 * <li>Sheet2!A1 formula was set to '="second formula"', and fill-dragged through A1:A8.</li>
 * <li>Sheet1!A1 formula was set to '="first formula"', and also fill-dragged through A1:A8.</li>
 * <li>Four rows on Sheet1 "5" through "8" were deleted ('delete rows' alt-E D, not 'clear' Del).</li>
 * <li>The spreadsheet was saved as AbnormalSharedFormulaFlag.xls.</li>
 * </ol>
 * Prior to the row delete action the spreadsheet has two <tt>SharedFormulaRecord</tt>s. One
 * for each sheet. To expose the bug, the shared formulas have been made to overlap.<br/>
 * The row delete action (as described here) seems to to delete the
 * <tt>SharedFormulaRecord</tt> from Sheet1 (but not clear the 'shared formula' flags.<br/>
 * There are other variations on this theme to create the same effect.
 */
@Test public void testSpuriousSharedFormulaFlag() throws Exception {
  long actualCRC=getFileCRC(HSSFTestDataSamples.openSampleFileStream(ABNORMAL_SHARED_FORMULA_FLAG_TEST_FILE));
  long expectedCRC=2277445406L;
  if (actualCRC != expectedCRC) {
    System.err.println("Expected crc " + expectedCRC + " but got "+ actualCRC);
    throw failUnexpectedTestFileChange();
  }
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook(ABNORMAL_SHARED_FORMULA_FLAG_TEST_FILE);
  HSSFSheet s=wb.getSheetAt(0);
  String cellFormula;
  cellFormula=getFormulaFromFirstCell(s,0);
  assertEquals("Something else wrong with this test case","\"first formula\"",cellFormula);
  cellFormula=getFormulaFromFirstCell(s,1);
  assertNotEquals("found bug 44449 (Wrong SharedFormulaRecord was used).","\"second formula\"",cellFormula);
  assertEquals("Something else wrong with this test case","\"first formula\"",cellFormula);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.common.TestUnicodeString </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void formatRun() throws Exception {
  FormatRun fr=new FormatRun((short)4,(short)0x15c);
  assertEquals(4,fr.getCharacterPos());
  assertEquals(0x15c,fr.getFontIndex());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  LittleEndianOutputStream out=new LittleEndianOutputStream(baos);
  fr.serialize(out);
  byte[] b=baos.toByteArray();
  assertEquals(4,b.length);
  assertEquals(4,b[0]);
  assertEquals(0,b[1]);
  assertEquals(0x5c,b[2]);
  assertEquals(0x01,b[3]);
  LittleEndianInputStream inp=new LittleEndianInputStream(new ByteArrayInputStream(b));
  fr=new FormatRun(inp);
  assertEquals(4,fr.getCharacterPos());
  assertEquals(0x15c,fr.getFontIndex());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void extRstFromEmpty() throws Exception {
  ExtRst ext=new ExtRst();
  assertEquals(0,ext.getNumberOfRuns());
  assertEquals(0,ext.getFormattingFontIndex());
  assertEquals(0,ext.getFormattingOptions());
  assertEquals("",ext.getPhoneticText());
  assertEquals(0,ext.getPhRuns().length);
  assertEquals(10,ext.getDataSize());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  LittleEndianOutputStream out=new LittleEndianOutputStream(baos);
  ContinuableRecordOutput cout=new ContinuableRecordOutput(out,0xffff);
  ext.serialize(cout);
  cout.writeContinue();
  byte[] b=baos.toByteArray();
  assertEquals(20,b.length);
  assertEquals(-1,b[0]);
  assertEquals(-1,b[1]);
  assertEquals(14,b[2]);
  assertEquals(00,b[3]);
  assertEquals(1,b[4]);
  assertEquals(0,b[5]);
  assertEquals(10,b[6]);
  assertEquals(00,b[7]);
  assertEquals(0,b[8]);
  assertEquals(0,b[9]);
  assertEquals(0,b[10]);
  assertEquals(0,b[11]);
  assertEquals(0,b[12]);
  assertEquals(0,b[13]);
  assertEquals(0,b[14]);
  assertEquals(0,b[15]);
  assertEquals(0,b[16]);
  assertEquals(0,b[17]);
  assertEquals(ContinueRecord.sid,b[18]);
  assertEquals(0,b[19]);
  byte[] data=new byte[14];
  System.arraycopy(b,4,data,0,data.length);
  LittleEndianInputStream inp=new LittleEndianInputStream(new ByteArrayInputStream(data));
  ext=new ExtRst(inp,data.length);
  assertEquals(0,ext.getNumberOfRuns());
  assertEquals(0,ext.getFormattingFontIndex());
  assertEquals(0,ext.getFormattingOptions());
  assertEquals("",ext.getPhoneticText());
  assertEquals(0,ext.getPhRuns().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestBugs </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Round trip a file with an unusual UnicodeString/ExtRst record parts
 */
@Test public void bug47847() throws Exception {
  HSSFWorkbook wb1=openSample("47847.xls");
  assertEquals(3,wb1.getNumberOfSheets());
  UnicodeString withExt=wb1.getWorkbook().getSSTString(0);
  UnicodeString withoutExt=wb1.getWorkbook().getSSTString(31);
  assertEquals("O:Alloc:Qty",withExt.getString());
  assertTrue((withExt.getOptionFlags() & 0x0004) == 0x0004);
  assertEquals("RT",withoutExt.getString());
  assertTrue((withoutExt.getOptionFlags() & 0x0004) == 0x0000);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(3,wb2.getNumberOfSheets());
  withExt=wb2.getWorkbook().getSSTString(0);
  withoutExt=wb2.getWorkbook().getSSTString(31);
  assertEquals("O:Alloc:Qty",withExt.getString());
  assertTrue((withExt.getOptionFlags() & 0x0004) == 0x0004);
  assertEquals("RT",withoutExt.getString());
  assertTrue((withoutExt.getOptionFlags() & 0x0004) == 0x0000);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Very hidden sheets not displaying as such
 */
@Test public void bug45761() throws Exception {
  HSSFWorkbook wb1=openSample("45761.xls");
  assertEquals(3,wb1.getNumberOfSheets());
  assertFalse(wb1.isSheetHidden(0));
  assertFalse(wb1.isSheetVeryHidden(0));
  assertTrue(wb1.isSheetHidden(1));
  assertFalse(wb1.isSheetVeryHidden(1));
  assertFalse(wb1.isSheetHidden(2));
  assertTrue(wb1.isSheetVeryHidden(2));
  wb1.setSheetHidden(0,Workbook.SHEET_STATE_VERY_HIDDEN);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertFalse(wb2.isSheetHidden(0));
  assertTrue(wb2.isSheetVeryHidden(0));
  assertTrue(wb2.isSheetHidden(1));
  assertFalse(wb2.isSheetVeryHidden(1));
  assertFalse(wb2.isSheetHidden(2));
  assertTrue(wb2.isSheetVeryHidden(2));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with extracting check boxes from
 * HSSFObjectData
 * @throws Exception
 */
@Test(expected=FileNotFoundException.class) public void bug44840() throws Exception {
  HSSFWorkbook wb=openSample("WithCheckBoxes.xls");
  List<HSSFObjectData> objects=wb.getAllEmbeddedObjects();
  assertEquals(1,objects.size());
  HSSFObjectData obj=objects.get(0);
  assertNotNull(obj);
  EmbeddedObjectRefSubRecord rec=obj.findObjectRecord();
  assertNotNull(rec);
  assertEquals(0,rec.getStreamId().intValue());
  assertEquals("Forms.CheckBox.1",rec.getOLEClassName());
  assertEquals(12,rec.getObjectData().length);
  assertFalse(obj.hasDirectoryEntry());
  assertNotNull(obj.getObjectData());
  assertEquals(12,obj.getObjectData().length);
  assertEquals("Forms.CheckBox.1",obj.getOLE2ClassName());
  try {
    obj.getDirectory();
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 41546: Constructing HSSFWorkbook is failed,
 * Unknown Ptg in Formula: 0x1a (26)
 */
@Test public void bug41546() throws Exception {
  HSSFWorkbook wb1=openSample("41546.xls");
  assertEquals(1,wb1.getNumberOfSheets());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  assertEquals(1,wb2.getNumberOfSheets());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Problems with formula references to
 * sheets via URLs
 */
@Test public void bug45970() throws Exception {
  HSSFWorkbook wb1=openSample("FormulaRefs.xls");
  assertEquals(3,wb1.getNumberOfSheets());
  HSSFSheet s=wb1.getSheetAt(0);
  HSSFRow row;
  row=s.getRow(0);
  assertEquals(Cell.CELL_TYPE_NUMERIC,row.getCell(1).getCellType());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(1);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("B1",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("Sheet1!B1",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(3);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("[Formulas2.xls]Sheet1!B2",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(4);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("'[$http://gagravarr.org/FormulaRefs.xls]Sheet1'!B1",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row.getCell(1).setCellFormula("'[$http://gagravarr.org/FormulaRefs2.xls]Sheet1'!B2");
  row.getCell(1).setCellValue(123.0);
  row=s.createRow(5);
  row.createCell(1,Cell.CELL_TYPE_FORMULA);
  row.getCell(1).setCellFormula("'[$http://example.com/FormulaRefs.xls]Sheet1'!B1");
  row.getCell(1).setCellValue(234.0);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  row=s.getRow(0);
  assertEquals(Cell.CELL_TYPE_NUMERIC,row.getCell(1).getCellType());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(1);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("B1",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("Sheet1!B1",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  row=s.getRow(3);
  assertEquals(Cell.CELL_TYPE_FORMULA,row.getCell(1).getCellType());
  assertEquals("[Formulas2.xls]Sheet1!B2",row.getCell(1).getCellFormula());
  assertEquals(112.0,row.getCell(1).getNumericCellValue(),0);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Multiple calls of HSSFWorkbook.write result in corrupted xls
 */
@Test public void bug32191() throws IOException {
  HSSFWorkbook wb=openSample("27394.xls");
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  wb.write(out);
  out.close();
  int size1=out.size();
  out=new ByteArrayOutputStream();
  wb.write(out);
  out.close();
  int size2=out.size();
  assertEquals(size1,size2);
  out=new ByteArrayOutputStream();
  wb.write(out);
  out.close();
  int size3=out.size();
  assertEquals(size2,size3);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug56325() throws IOException {
  HSSFWorkbook wb1;
  POIFSFileSystem fs;
  File file=HSSFTestDataSamples.getSampleFile("56325.xls");
  InputStream stream=new FileInputStream(file);
  try {
    fs=new POIFSFileSystem(stream);
    wb1=new HSSFWorkbook(fs);
  }
  finally {
    stream.close();
  }
  assertEquals(3,wb1.getNumberOfSheets());
  wb1.removeSheetAt(0);
  assertEquals(2,wb1.getNumberOfSheets());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  fs.close();
  assertEquals(2,wb2.getNumberOfSheets());
  wb2.removeSheetAt(0);
  assertEquals(1,wb2.getNumberOfSheets());
  wb2.removeSheetAt(0);
  assertEquals(0,wb2.getNumberOfSheets());
  HSSFWorkbook wb3=writeOutAndReadBack(wb2);
  wb2.close();
  assertEquals(0,wb3.getNumberOfSheets());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * We used to add too many UncalcRecords to sheets
 * with diagrams on. Don't any more
 */
@Test public void bug45414() throws Exception {
  HSSFWorkbook wb1=openSample("WithThreeCharts.xls");
  wb1.getSheetAt(0).setForceFormulaRecalculation(true);
  wb1.getSheetAt(1).setForceFormulaRecalculation(false);
  wb1.getSheetAt(2).setForceFormulaRecalculation(true);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertTrue(wb2.getSheetAt(0).getForceFormulaRecalculation());
  assertFalse(wb2.getSheetAt(1).getForceFormulaRecalculation());
  assertTrue(wb2.getSheetAt(2).getForceFormulaRecalculation());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can delete sheets without
 * breaking the build in named ranges
 * used for printing stuff.
 */
@Test public void bug30978() throws Exception {
  HSSFWorkbook wb1=openSample("30978-alt.xls");
  assertEquals(1,wb1.getNumberOfNames());
  assertEquals(3,wb1.getNumberOfSheets());
  InternalWorkbook w=wb1.getWorkbook();
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb1.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  wb1.removeSheetAt(1);
  assertEquals(1,wb1.getNumberOfNames());
  assertEquals(2,wb1.getNumberOfSheets());
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb1.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  w=wb2.getWorkbook();
  assertEquals(1,wb2.getNumberOfNames());
  assertEquals(2,wb2.getNumberOfSheets());
  for (int i=0; i < w.getNumNames(); i++) {
    NameRecord r=w.getNameRecord(i);
    assertTrue(r.getSheetNumber() <= wb2.getNumberOfSheets());
    Ptg[] nd=r.getNameDefinition();
    assertEquals(1,nd.length);
    assertTrue(nd[0] instanceof DeletedArea3DPtg);
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A protected sheet with comments, when written out by
 * POI, ends up upsetting excel.
 * TODO Identify the cause and add extra asserts for
 * the bit excel cares about
 */
@Test public void bug50833() throws Exception {
  Biff8EncryptionKey.setCurrentUserPassword(null);
  HSSFWorkbook wb1=openSample("50833.xls");
  HSSFSheet s=wb1.getSheetAt(0);
  assertEquals("Sheet1",s.getSheetName());
  assertEquals(false,s.getProtect());
  HSSFCell c=s.getRow(0).getCell(0);
  assertEquals("test cell value",c.getRichStringCellValue().getString());
  HSSFComment cmt=c.getCellComment();
  assertNotNull(cmt);
  assertEquals("Robert Lawrence",cmt.getAuthor());
  assertEquals("Robert Lawrence:\ntest comment",cmt.getString().getString());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  c=s.getRow(0).getCell(0);
  cmt=c.getCellComment();
  assertNotNull(cmt);
  assertEquals("Robert Lawrence",cmt.getAuthor());
  assertEquals("Robert Lawrence:\ntest comment",cmt.getString().getString());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 40285:      CellIterator Skips First Column
 */
@Test public void bug40285() throws Exception {
  HSSFWorkbook wb=openSample("40285.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  int rownum=0;
  for (Iterator<Row> it=sheet.rowIterator(); it.hasNext(); rownum++) {
    Row row=it.next();
    assertEquals(rownum,row.getRowNum());
    int cellNum=0;
    for (Iterator<Cell> it2=row.cellIterator(); it2.hasNext(); cellNum++) {
      Cell cell=it2.next();
      assertEquals(cellNum,cell.getColumnIndex());
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test bug 38266: NPE when adding a row break
 * User's diagnosis:
 * 1. Manually (i.e., not using POI) create an Excel Workbook, making sure it
 * contains a sheet that doesn't have any row breaks
 * 2. Using POI, create a new HSSFWorkbook from the template in step #1
 * 3. Try adding a row break (via sheet.setRowBreak()) to the sheet mentioned in step #1
 * 4. Get a NullPointerException
 */
@Test public void bug38266() throws Exception {
  String[] files={"Simple.xls","SimpleMultiCell.xls","duprich1.xls"};
  for (  String file : files) {
    HSSFWorkbook wb=openSample(file);
    HSSFSheet sheet=wb.getSheetAt(0);
    int[] breaks=sheet.getRowBreaks();
    assertEquals(0,breaks.length);
    for (int j=1; j <= 3; j++) {
      sheet.setRowBreak(j * 20);
    }
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test48043() throws IOException {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("56325a.xls");
  wb.removeSheetAt(2);
  wb.removeSheetAt(1);
  Sheet s=wb.getSheetAt(0);
  Row row=s.createRow(0);
  Cell cell=row.createCell(0);
  cell.setCellFormula("IF(AND(ISBLANK(A10)," + "ISBLANK(B10)),\"\"," + "CONCATENATE(A10,\"-\",B10))");
  FormulaEvaluator eval=wb.getCreationHelper().createFormulaEvaluator();
  eval.evaluateAll();
  Workbook wbBack=HSSFTestDataSamples.writeOutAndReadBack(wb);
  assertNotNull(wbBack);
  wbBack.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 42618: RecordFormatException reading a file containing
 * =CHOOSE(2,A2,A3,A4)
 */
@Test public void bug42618() throws Exception {
  HSSFWorkbook wb1=openSample("SimpleWithChoose.xls");
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet s=wb2.getSheetAt(0);
  HSSFRow r1=s.getRow(0);
  HSSFCell c1=r1.getCell(1);
  assertEquals("=CHOOSE(2,A2,A3,A4)",c1.getRichStringCellValue().toString());
  HSSFRow r2=s.getRow(1);
  HSSFCell c2=r2.getCell(1);
  assertEquals(25,(int)c2.getNumericCellValue());
  try {
    assertEquals("CHOOSE(2,A2,A3,A4)",c2.getCellFormula());
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("Too few arguments") && e.getMessage().indexOf("ConcatPtg") > 0) {
      fail("identified bug 44306");
    }
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problem with "Vector Rows", eg a whole
 * column which is set to the result of
 * {=sin(B1:B9)}(9,1), so that each cell is
 * shown to have the contents
 * {=sin(B1:B9){9,1)[rownum][0]
 * In this sample file, the vector column
 * is C, and the data column is B.
 * For now, blows up with an exception from ExtPtg
 * Expected ExpPtg to be converted from Shared to Non-Shared...
 */
@Ignore public void test43623() throws Exception {
  HSSFWorkbook wb1=openSample("43623.xls");
  assertEquals(1,wb1.getNumberOfSheets());
  HSSFSheet s1=wb1.getSheetAt(0);
  HSSFCell c1=s1.getRow(0).getCell(2);
  HSSFCell c2=s1.getRow(1).getCell(2);
  HSSFCell c3=s1.getRow(2).getCell(2);
  assertEquals("{=sin(B1:B9){9,1)[0][0]",c1.getCellFormula());
  assertEquals("{=sin(B1:B9){9,1)[1][0]",c2.getCellFormula());
  assertEquals("{=sin(B1:B9){9,1)[2][0]",c3.getCellFormula());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet ns1=wb2.getSheetAt(0);
  HSSFCell nc1=ns1.getRow(0).getCell(2);
  HSSFCell nc2=ns1.getRow(1).getCell(2);
  HSSFCell nc3=ns1.getRow(2).getCell(2);
  assertEquals("{=sin(B1:B9){9,1)[0][0]",nc1.getCellFormula());
  assertEquals("{=sin(B1:B9){9,1)[1][0]",nc2.getCellFormula());
  assertEquals("{=sin(B1:B9){9,1)[2][0]",nc3.getCellFormula());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * From the mailing list - ensure we can handle a formula
 * containing a zip code, eg ="70164"
 */
@Test public void bugZipCodeFormulas() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet();
  s.createRow(0);
  HSSFCell c1=s.getRow(0).createCell(0);
  HSSFCell c2=s.getRow(0).createCell(1);
  HSSFCell c3=s.getRow(0).createCell(2);
  c1.setCellFormula("70164");
  c2.setCellFormula("\"70164\"");
  c3.setCellFormula("\"90210\"");
  assertEquals("70164",c1.getCellFormula());
  assertEquals("\"70164\"",c2.getCellFormula());
  confirmCachedValue(0.0,c1);
  confirmCachedValue(0.0,c2);
  confirmCachedValue(0.0,c3);
  c3.setCellValue(new HSSFRichTextString("test"));
  confirmCachedValue("test",c3);
  try {
    c3.getNumericCellValue();
    fail("exception should have been thrown");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cannot get a numeric value from a text formula cell",e.getMessage());
  }
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  eval.evaluateFormulaCell(c1);
  eval.evaluateFormulaCell(c2);
  eval.evaluateFormulaCell(c3);
  confirmCachedValue(70164.0,c1);
  confirmCachedValue("70164",c2);
  confirmCachedValue("90210",c3);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet ns=wb2.getSheetAt(0);
  HSSFCell nc1=ns.getRow(0).getCell(0);
  HSSFCell nc2=ns.getRow(0).getCell(1);
  HSSFCell nc3=ns.getRow(0).getCell(2);
  confirmCachedValue(70164.0,nc1);
  confirmCachedValue("70164",nc2);
  confirmCachedValue("90210",nc3);
  @SuppressWarnings("deprecation") CellValueRecordInterface[] cvrs=ns.getSheet().getValueRecords();
  for (int i=0; i < cvrs.length; i++) {
    CellValueRecordInterface cvr=cvrs[i];
    if (cvr instanceof FormulaRecordAggregate) {
      FormulaRecordAggregate fr=(FormulaRecordAggregate)cvr;
      if (i == 0) {
        assertEquals(70164.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNull(fr.getStringRecord());
      }
 else       if (i == 1) {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("70164",fr.getStringRecord().getString());
      }
 else {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("90210",fr.getStringRecord().getString());
      }
    }
  }
  assertEquals(3,cvrs.length);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Newly created sheets need to get a
 * proper TabID, otherwise print setup
 * gets confused on them.
 * Also ensure that print setup refs are
 * by reference not value
 */
@Test public void bug46664() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet sheet=wb1.createSheet("new_sheet");
  HSSFRow row=sheet.createRow((short)0);
  row.createCell(0).setCellValue(new HSSFRichTextString("Column A"));
  row.createCell(1).setCellValue(new HSSFRichTextString("Column B"));
  row.createCell(2).setCellValue(new HSSFRichTextString("Column C"));
  row.createCell(3).setCellValue(new HSSFRichTextString("Column D"));
  row.createCell(4).setCellValue(new HSSFRichTextString("Column E"));
  row.createCell(5).setCellValue(new HSSFRichTextString("Column F"));
  wb1.setPrintArea(0,0,2,0,0);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  TabIdRecord tr=null;
  for (  Record r : wb2.getWorkbook().getRecords()) {
    if (r instanceof TabIdRecord) {
      tr=(TabIdRecord)r;
    }
  }
  assertNotNull(tr);
  assertEquals(1,tr._tabids.length);
  assertEquals(0,tr._tabids[0]);
  assertEquals("new_sheet!$A$1:$C$1",wb2.getPrintArea(0));
  assertEquals("new_sheet!$A$1:$C$1",wb2.getName("Print_Area").getRefersToFormula());
  NameRecord nr=wb2.getWorkbook().getNameRecord(wb2.getNameIndex("Print_Area"));
  assertEquals("Print_Area",nr.getNameText());
  assertEquals(1,nr.getNameDefinition().length);
  assertEquals("new_sheet!$A$1:$C$1",((Area3DPtg)nr.getNameDefinition()[0]).toFormulaString(HSSFEvaluationWorkbook.create(wb2)));
  assertEquals('R',nr.getNameDefinition()[0].getRVAType());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void test53109a() throws IOException {
  HSSFWorkbook wb1=openSample("com.aida-tour.www_SPO_files_maldives%20august%20october.xls");
  Workbook wb2=writeOutAndReadBack(wb1);
  assertNotNull(wb2);
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Setting the user style name on custom styles
 */
@Test public void bug49689() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet("Test");
  HSSFRow r=s.createRow(0);
  HSSFCell c=r.createCell(0);
  HSSFCellStyle cs1=wb1.createCellStyle();
  HSSFCellStyle cs2=wb1.createCellStyle();
  HSSFCellStyle cs3=wb1.createCellStyle();
  assertEquals(21,cs1.getIndex());
  cs1.setUserStyleName("Testing");
  assertEquals(22,cs2.getIndex());
  cs2.setUserStyleName("Testing 2");
  assertEquals(23,cs3.getIndex());
  cs3.setUserStyleName("Testing 3");
  c.setCellStyle(cs1);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals("Testing",wb2.getCellStyleAt((short)21).getUserStyleName());
  assertEquals("Testing 2",wb2.getCellStyleAt((short)22).getUserStyleName());
  assertEquals("Testing 3",wb2.getCellStyleAt((short)23).getUserStyleName());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Mixture of Ascii and Unicode strings in a
 * NameComment record
 */
@Test public void bug51143() throws Exception {
  HSSFWorkbook wb1=openSample("51143.xls");
  assertEquals(1,wb1.getNumberOfSheets());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(1,wb2.getNumberOfSheets());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * User reported the wrong number of rows from the
 * iterator, but we can't replicate that
 */
@Test public void bug44693() throws Exception {
  HSSFWorkbook wb=openSample("44693.xls");
  HSSFSheet s=wb.getSheetAt(0);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(712,s.getLastRowNum());
  assertEquals(713,s.getPhysicalNumberOfRows());
  int rowsSeen=0;
  for (Iterator<Row> i=s.rowIterator(); i.hasNext(); ) {
    Row r=i.next();
    assertNotNull(r);
    rowsSeen++;
  }
  assertEquals(713,rowsSeen);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug56325a() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("56325a.xls");
  HSSFSheet sheet=wb1.cloneSheet(2);
  wb1.setSheetName(3,"Clone 1");
  sheet.setRepeatingRows(CellRangeAddress.valueOf("2:3"));
  wb1.setPrintArea(3,"$A$4:$C$10");
  sheet=wb1.cloneSheet(2);
  wb1.setSheetName(4,"Clone 2");
  sheet.setRepeatingRows(CellRangeAddress.valueOf("2:3"));
  wb1.setPrintArea(4,"$A$4:$C$10");
  wb1.removeSheetAt(2);
  Workbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(4,wb2.getNumberOfSheets());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void test53109() throws IOException {
  HSSFWorkbook wb1=openSample("53109.xls");
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  assertNotNull(wb2);
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test for a file with NameRecord with NameCommentRecord comments
 */
@Test public void bug49185() throws Exception {
  HSSFWorkbook wb1=openSample("49185.xls");
  Name name=wb1.getName("foobarName");
  assertEquals("This is a comment",name.getComment());
  name.setNameName("ChangedName");
  assertEquals("This is a comment",name.getComment());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  name=wb2.getName("ChangedName");
  assertEquals("This is a comment",name.getComment());
  name.setComment("Changed Comment");
  assertEquals("Changed Comment",name.getComment());
  HSSFWorkbook wb3=writeOutAndReadBack(wb2);
  wb2.close();
  name=wb3.getName("ChangedName");
  assertEquals("Changed Comment",name.getComment());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problem with cloning a sheet with a chart
 * contained in it.
 */
@Test public void bug49096() throws Exception {
  HSSFWorkbook wb1=openSample("49096.xls");
  assertEquals(1,wb1.getNumberOfSheets());
  assertNotNull(wb1.getSheetAt(0));
  wb1.cloneSheet(0);
  assertEquals(2,wb1.getNumberOfSheets());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(2,wb2.getNumberOfSheets());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Vertically aligned text
 */
@Test public void bug49524() throws Exception {
  HSSFWorkbook wb1=openSample("49524.xls");
  Sheet s=wb1.getSheetAt(0);
  Row r=s.getRow(0);
  Cell rotated=r.getCell(0);
  Cell normal=r.getCell(1);
  assertEquals(0,normal.getCellStyle().getRotation());
  assertEquals(0xff,rotated.getCellStyle().getRotation());
  CellStyle cs=wb1.createCellStyle();
  cs.setRotation((short)0xff);
  Cell nc=r.createCell(2);
  nc.setCellValue("New Rotated Text");
  nc.setCellStyle(cs);
  assertEquals(0xff,nc.getCellStyle().getRotation());
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  r=s.getRow(0);
  rotated=r.getCell(0);
  normal=r.getCell(1);
  nc=r.getCell(2);
  assertEquals(0,normal.getCellStyle().getRotation());
  assertEquals(0xff,rotated.getCellStyle().getRotation());
  assertEquals(0xff,nc.getCellStyle().getRotation());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Read, write, read for formulas point to cells in other files.
 * See {@link #bug46670()} for the main test, this just
 * covers reading an existing file and checking it.
 * TODO Fix this so that it works - formulas are ending up as
 * #REF when being changed
 */
@Test @Ignore public void bug46670_existing() throws Exception {
  Sheet s;
  Cell c;
  String refLocal="'[refs/airport.xls]Sheet1'!$A$2";
  String refHttp="'[9http://www.principlesofeconometrics.com/excel/airline.xls]Sheet1'!$A$2";
  HSSFWorkbook wb1=openSample("46670_local.xls");
  s=wb1.getSheetAt(0);
  assertEquals(refLocal,s.getRow(0).getCell(0).getCellFormula());
  wb1.close();
  HSSFWorkbook wb2=openSample("46670_http.xls");
  s=wb2.getSheetAt(0);
  assertEquals(refHttp,s.getRow(0).getCell(0).getCellFormula());
  wb2.close();
  HSSFWorkbook wb3=openSample("46670_local.xls");
  s=wb3.getSheetAt(0);
  c=s.getRow(0).getCell(0);
  c.setCellFormula(refLocal);
  assertEquals(refLocal,c.getCellFormula());
  HSSFWorkbook wb4=HSSFTestDataSamples.writeOutAndReadBack(wb3);
  wb3.close();
  s=wb4.getSheetAt(0);
  assertEquals(refLocal,s.getRow(0).getCell(0).getCellFormula());
  wb4.close();
  HSSFWorkbook wb5=openSample("46670_http.xls");
  s=wb5.getSheetAt(0);
  c=s.getRow(0).getCell(0);
  c.setCellFormula(refHttp);
  assertEquals(refHttp,c.getCellFormula());
  HSSFWorkbook wb6=HSSFTestDataSamples.writeOutAndReadBack(wb5);
  wb5.close();
  s=wb6.getSheetAt(0);
  assertEquals(refHttp,s.getRow(0).getCell(0).getCellFormula());
  wb6.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestDataValidation </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsFormula() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createCustomConstraint("A2:A3");
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.FORMULA,c.getValidationType());
  assertEquals("A2:A3",c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(null,c.getValue1());
  assertEquals(null,c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsListExplicit() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createExplicitListConstraint(new String[]{"aaa","bbb","ccc"});
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  validation.setSuppressDropDownArrow(true);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  assertEquals(true,dv.getSuppressDropDownArrow());
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.LIST,c.getValidationType());
  assertEquals(null,c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(null,c.getValue1());
  assertEquals(null,c.getValue2());
  String[] values=c.getExplicitListValues();
  assertEquals(3,values.length);
  assertEquals("aaa",values[0]);
  assertEquals("bbb",values[1]);
  assertEquals("ccc",values[2]);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsDate() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createDateConstraint(OperatorType.EQUAL,"2014/10/25",null,null);
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.DATE,c.getValidationType());
  assertEquals(OperatorType.EQUAL,c.getOperator());
  assertEquals(null,c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(DateUtil.getExcelDate(DateUtil.parseYYYYMMDDDate("2014/10/25")),c.getValue1(),0);
  assertEquals(null,c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsListFormula() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createFormulaListConstraint("A2");
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  validation.setSuppressDropDownArrow(true);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  assertEquals(true,dv.getSuppressDropDownArrow());
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.LIST,c.getValidationType());
  assertEquals("A2",c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(null,c.getValue1());
  assertEquals(null,c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsDecimal() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createDecimalConstraint(OperatorType.BETWEEN,"=A2","200");
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.DECIMAL,c.getValidationType());
  assertEquals(OperatorType.BETWEEN,c.getOperator());
  assertEquals("A2",c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(null,c.getValue1());
  assertEquals(new Double("200"),c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddToExistingSheet() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("dvEmpty.xls");
  int dvRow=0;
  Sheet sheet=wb.getSheetAt(0);
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint dc=dataValidationHelper.createIntegerConstraint(OperatorType.EQUAL,"42",null);
  DataValidation dv=dataValidationHelper.createValidation(dc,new CellRangeAddressList(dvRow,dvRow,0,0));
  dv.setEmptyCellAllowed(false);
  dv.setErrorStyle(ErrorStyle.STOP);
  dv.setShowPromptBox(true);
  dv.createErrorBox("Xxx","Yyy");
  dv.setSuppressDropDownArrow(true);
  sheet.addValidationData(dv);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  wb.write(baos);
  byte[] wbData=baos.toByteArray();
  byte[] dvHeaderRecStart={(byte)0xB2,0x01,0x12,0x00};
  int dvHeaderOffset=findIndex(wbData,dvHeaderRecStart);
  assertTrue(dvHeaderOffset > 0);
  int nextRecIndex=dvHeaderOffset + 22;
  int nextSid=((wbData[nextRecIndex + 0] << 0) & 0x00FF) + ((wbData[nextRecIndex + 1] << 8) & 0xFF00);
  if (nextSid == 0x0867) {
    fail("Identified bug 45519");
  }
  assertEquals(DVRecord.sid,nextSid);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsIntegerValue() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createIntegerConstraint(OperatorType.BETWEEN,"100","200");
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.INTEGER,c.getValidationType());
  assertEquals(OperatorType.BETWEEN,c.getOperator());
  assertEquals(null,c.getFormula1());
  assertEquals(null,c.getFormula2());
  assertEquals(new Double("100"),c.getValue1());
  assertEquals(new Double("200"),c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsIntegerFormula() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createIntegerConstraint(OperatorType.BETWEEN,"=A2","=A3");
  CellRangeAddressList addressList=new CellRangeAddressList(0,0,0,0);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
  DVConstraint c=dv.getConstraint();
  assertEquals(ValidationType.INTEGER,c.getValidationType());
  assertEquals(OperatorType.BETWEEN,c.getOperator());
  assertEquals("A2",c.getFormula1());
  assertEquals("A3",c.getFormula2());
  assertEquals(null,c.getValue1());
  assertEquals(null,c.getValue2());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDataValidationsAny() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet();
  List<HSSFDataValidation> list=sheet.getDataValidations();
  assertEquals(0,list.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(ValidationType.ANY,OperatorType.IGNORED,null,null);
  CellRangeAddressList addressList=new CellRangeAddressList(1,2,3,4);
  DataValidation validation=dataValidationHelper.createValidation(constraint,addressList);
  validation.setEmptyCellAllowed(true);
  validation.createErrorBox("error-title","error-text");
  validation.createPromptBox("prompt-title","prompt-text");
  sheet.addValidationData(validation);
  list=sheet.getDataValidations();
  assertEquals(1,list.size());
  HSSFDataValidation dv=list.get(0);
{
    CellRangeAddressList regions=dv.getRegions();
    assertEquals(1,regions.countRanges());
    CellRangeAddress address=regions.getCellRangeAddress(0);
    assertEquals(1,address.getFirstRow());
    assertEquals(2,address.getLastRow());
    assertEquals(3,address.getFirstColumn());
    assertEquals(4,address.getLastColumn());
  }
  assertEquals(true,dv.getEmptyCellAllowed());
  assertEquals(false,dv.getSuppressDropDownArrow());
  assertEquals(true,dv.getShowErrorBox());
  assertEquals("error-title",dv.getErrorBoxTitle());
  assertEquals("error-text",dv.getErrorBoxText());
  assertEquals(true,dv.getShowPromptBox());
  assertEquals("prompt-title",dv.getPromptBoxTitle());
  assertEquals("prompt-text",dv.getPromptBoxText());
  DataValidationConstraint c=dv.getValidationConstraint();
  assertEquals(ValidationType.ANY,c.getValidationType());
  assertEquals(OperatorType.IGNORED,c.getOperator());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestEscherGraphics </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDataBackAgain() throws Exception {
  HSSFSheet s;
  HSSFShapeGroup s1;
  HSSFShapeGroup s2;
  patriarch.setCoordinates(10,20,30,40);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  workbook.write(baos);
  workbook=new HSSFWorkbook(new ByteArrayInputStream(baos.toByteArray()));
  s=workbook.getSheetAt(0);
  patriarch=s.getDrawingPatriarch();
  assertNotNull(patriarch);
  assertEquals(10,patriarch.getX1());
  assertEquals(20,patriarch.getY1());
  assertEquals(30,patriarch.getX2());
  assertEquals(40,patriarch.getY2());
  assertEquals(2,patriarch.countOfAllChildren());
  assertTrue(patriarch.getChildren().get(0) instanceof HSSFShapeGroup);
  assertTrue(patriarch.getChildren().get(1) instanceof HSSFShapeGroup);
  s1=(HSSFShapeGroup)patriarch.getChildren().get(0);
  s2=(HSSFShapeGroup)patriarch.getChildren().get(1);
  assertEquals(0,s1.getX1());
  assertEquals(0,s1.getY1());
  assertEquals(1023,s1.getX2());
  assertEquals(255,s1.getY2());
  assertEquals(0,s2.getX1());
  assertEquals(0,s2.getY1());
  assertEquals(1023,s2.getX2());
  assertEquals(255,s2.getY2());
  assertEquals(0,s1.getAnchor().getDx1());
  assertEquals(0,s1.getAnchor().getDy1());
  assertEquals(1022,s1.getAnchor().getDx2());
  assertEquals(255,s1.getAnchor().getDy2());
  assertEquals(20,s2.getAnchor().getDx1());
  assertEquals(30,s2.getAnchor().getDy1());
  assertEquals(500,s2.getAnchor().getDx2());
  assertEquals(200,s2.getAnchor().getDy2());
  baos=new ByteArrayOutputStream();
  workbook.write(baos);
  workbook=new HSSFWorkbook(new ByteArrayInputStream(baos.toByteArray()));
  s=workbook.getSheetAt(0);
  patriarch=s.getDrawingPatriarch();
  assertNotNull(patriarch);
  assertEquals(10,patriarch.getX1());
  assertEquals(20,patriarch.getY1());
  assertEquals(30,patriarch.getX2());
  assertEquals(40,patriarch.getY2());
  assertEquals(2,patriarch.countOfAllChildren());
  assertTrue(patriarch.getChildren().get(0) instanceof HSSFShapeGroup);
  assertTrue(patriarch.getChildren().get(1) instanceof HSSFShapeGroup);
  s1=(HSSFShapeGroup)patriarch.getChildren().get(0);
  s2=(HSSFShapeGroup)patriarch.getChildren().get(1);
  assertEquals(0,s1.getX1());
  assertEquals(0,s1.getY1());
  assertEquals(1023,s1.getX2());
  assertEquals(255,s1.getY2());
  assertEquals(0,s2.getX1());
  assertEquals(0,s2.getY1());
  assertEquals(1023,s2.getX2());
  assertEquals(255,s2.getY2());
  assertEquals(0,s1.getAnchor().getDx1());
  assertEquals(0,s1.getAnchor().getDy1());
  assertEquals(1022,s1.getAnchor().getDx2());
  assertEquals(255,s1.getAnchor().getDy2());
  assertEquals(20,s2.getAnchor().getDx1());
  assertEquals(30,s2.getAnchor().getDy1());
  assertEquals(500,s2.getAnchor().getDx2());
  assertEquals(200,s2.getAnchor().getDy2());
  s1.setCoordinates(2,3,1021,242);
  baos=new ByteArrayOutputStream();
  workbook.write(baos);
  workbook=new HSSFWorkbook(new ByteArrayInputStream(baos.toByteArray()));
  s=workbook.getSheetAt(0);
  patriarch=s.getDrawingPatriarch();
  assertNotNull(patriarch);
  assertEquals(10,patriarch.getX1());
  assertEquals(20,patriarch.getY1());
  assertEquals(30,patriarch.getX2());
  assertEquals(40,patriarch.getY2());
  assertEquals(2,patriarch.countOfAllChildren());
  assertEquals(2,patriarch.getChildren().size());
  assertTrue(patriarch.getChildren().get(0) instanceof HSSFShapeGroup);
  assertTrue(patriarch.getChildren().get(1) instanceof HSSFShapeGroup);
  s1=(HSSFShapeGroup)patriarch.getChildren().get(0);
  s2=(HSSFShapeGroup)patriarch.getChildren().get(1);
  assertEquals(2,s1.getX1());
  assertEquals(3,s1.getY1());
  assertEquals(1021,s1.getX2());
  assertEquals(242,s1.getY2());
  assertEquals(0,s2.getX1());
  assertEquals(0,s2.getY1());
  assertEquals(1023,s2.getX2());
  assertEquals(255,s2.getY2());
  assertEquals(0,s1.getAnchor().getDx1());
  assertEquals(0,s1.getAnchor().getDy1());
  assertEquals(1022,s1.getAnchor().getDx2());
  assertEquals(255,s1.getAnchor().getDy2());
  assertEquals(20,s2.getAnchor().getDx1());
  assertEquals(30,s2.getAnchor().getDy1());
  assertEquals(500,s2.getAnchor().getDx2());
  assertEquals(200,s2.getAnchor().getDy2());
  HSSFTextbox tbox1=patriarch.createTextbox(new HSSFClientAnchor(1,2,3,4,(short)0,0,(short)0,0));
  tbox1.setString(new HSSFRichTextString("I am text box 1"));
  HSSFTextbox tbox2=s2.createTextbox(new HSSFChildAnchor(41,42,43,44));
  tbox2.setString(new HSSFRichTextString("This is text box 2"));
  assertEquals(3,patriarch.getChildren().size());
  baos=new ByteArrayOutputStream();
  workbook.write(baos);
  workbook=new HSSFWorkbook(new ByteArrayInputStream(baos.toByteArray()));
  s=workbook.getSheetAt(0);
  patriarch=s.getDrawingPatriarch();
  assertNotNull(patriarch);
  assertEquals(10,patriarch.getX1());
  assertEquals(20,patriarch.getY1());
  assertEquals(30,patriarch.getX2());
  assertEquals(40,patriarch.getY2());
  assertEquals(3,patriarch.getChildren().size());
  assertTrue(patriarch.getChildren().get(0) instanceof HSSFShapeGroup);
  assertTrue(patriarch.getChildren().get(1) instanceof HSSFShapeGroup);
  assertTrue(patriarch.getChildren().get(2) instanceof HSSFTextbox);
  s1=(HSSFShapeGroup)patriarch.getChildren().get(0);
  tbox1=(HSSFTextbox)patriarch.getChildren().get(2);
  s2=(HSSFShapeGroup)patriarch.getChildren().get(1);
  assertEquals(2,s1.getX1());
  assertEquals(3,s1.getY1());
  assertEquals(1021,s1.getX2());
  assertEquals(242,s1.getY2());
  assertEquals(0,s2.getX1());
  assertEquals(0,s2.getY1());
  assertEquals(1023,s2.getX2());
  assertEquals(255,s2.getY2());
  assertEquals(0,s1.getAnchor().getDx1());
  assertEquals(0,s1.getAnchor().getDy1());
  assertEquals(1022,s1.getAnchor().getDx2());
  assertEquals(255,s1.getAnchor().getDy2());
  assertEquals(20,s2.getAnchor().getDx1());
  assertEquals(30,s2.getAnchor().getDy1());
  assertEquals(500,s2.getAnchor().getDx2());
  assertEquals(200,s2.getAnchor().getDy2());
  assertEquals("I am text box 1",tbox1.getString().getString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestFormulaEvaluatorBugs </h4><pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testSlowEvaluate45376() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  for (int i=1; i < 10; i++) {
    HSSFCell cell=row.createCell(i);
    char prevCol=(char)('A' + i - 1);
    String prevCell=prevCol + "1";
    String formula="IF(DATE(YEAR(" + prevCell + "),MONTH("+ prevCell+ ")+1,1)<=$D$3,"+ "DATE(YEAR("+ prevCell+ "),MONTH("+ prevCell+ ")+1,1),NA())";
    cell.setCellFormula(formula);
  }
  Calendar cal=LocaleUtil.getLocaleCalendar(2000,0,1,0,0,0);
  row.createCell(0).setCellValue(cal);
  HSSFCell cell=row.getCell(8);
  EvalListener evalListener=new EvalListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cell));
  int evalCount=evalListener.getCountCacheMisses();
  if (evalCount > 10) {
    fail("Identifed bug 45376 - Formula evaluator should cache values");
  }
  assertEquals(8,evalCount);
  assertEquals(8,evalListener.getCountCacheHits());
  assertEquals(ErrorEval.NA,ve);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void test55747_55324() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFFormulaEvaluator ev=wb.getCreationHelper().createFormulaEvaluator();
  HSSFSheet ws=wb.createSheet();
  HSSFRow row=ws.createRow(0);
  HSSFCell cell;
  cell=row.createCell(0);
  cell.setCellValue("abc");
  cell=row.createCell(1);
  cell.setCellFormula("IF(A1<>\"\",MID(A1,1,2),\"X\")");
  cell=row.createCell(2);
  cell.setCellFormula("IF(A1<>\"\",\"A\",\"B\")");
  cell=row.createCell(3);
  cell.setCellFormula("IF(A1=\"\",\"X\",MID(A1,1,2))");
  cell=row.createCell(4);
  cell.setCellFormula("IF(A1<>\"\",\"X\",MID(A1,1,2))");
  cell=row.createCell(5);
  cell.setCellFormula("IF(A1=\"\",MID(A1,1,2),MID(A1,2,2))");
  cell=row.createCell(6);
  cell.setCellFormula("IF(A1<>\"\",MID(A1,1,2),MID(A1,2,2))");
  cell=row.createCell(7);
  cell.setCellFormula("IF(MID(A1,1,2)<>\"\",\"A\",\"B\")");
  row=ws.createRow(1);
  cell=row.createCell(1);
  cell.setCellFormula("MID(A1,1,2)");
  cell=row.createCell(2);
  cell.setCellFormula("MID(A1,2,2)");
  cell=row.createCell(3);
  cell.setCellFormula("MID(A1,2,1)");
  cell=row.createCell(4);
  cell.setCellFormula("MID(A1,3,1)");
  ev.evaluateAll();
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  ws=wb.getSheetAt(0);
  row=ws.getRow(1);
  for (int i=1; i <= 4; i++) {
    cell=row.getCell(i);
    Ptg[] ptgs=getPtgs(cell);
    assertEquals(4,ptgs.length);
    assertEquals(FuncPtg.class,ptgs[3].getClass());
    assertEquals("MID",((FuncPtg)ptgs[3]).getName());
    assertRefPtgA1('V',ptgs,0);
  }
  row=ws.getRow(0);
  cell=row.getCell(CellReference.convertColStringToIndex("H"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("E"));
  assertRefPtgA1('V',getPtgs(cell),0);
  assertRefPtgA1('R',getPtgs(cell),6);
  cell=row.getCell(CellReference.convertColStringToIndex("B"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("D"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("F"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("G"));
  assertRefPtgA1('V',getPtgs(cell),0);
  cell=row.getCell(CellReference.convertColStringToIndex("A"));
  assertEquals("abc",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("B"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("C"));
  assertEquals("A",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("D"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("E"));
  assertEquals("X",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("F"));
  assertEquals("bc",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("G"));
  assertEquals("ab",cell.getStringCellValue());
  cell=row.getCell(CellReference.convertColStringToIndex("H"));
  assertEquals("A",cell.getStringCellValue());
  if (OUTPUT_TEST_FILES) {
    FileOutputStream out=new FileOutputStream("/tmp/test.xls");
    wb.write(out);
    out.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFCell </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testActiveCellBug56114() throws IOException {
  Workbook wb=new HSSFWorkbook();
  Sheet sh=wb.createSheet();
  sh.createRow(0);
  sh.createRow(1);
  sh.createRow(2);
  sh.createRow(3);
  Cell cell=sh.getRow(1).createCell(3);
  sh.getRow(3).createCell(3);
  assertEquals(0,((HSSFSheet)wb.getSheetAt(0)).getSheet().getActiveCellRow());
  assertEquals(0,((HSSFSheet)wb.getSheetAt(0)).getSheet().getActiveCellCol());
  cell.setAsActiveCell();
  assertEquals(1,((HSSFSheet)wb.getSheetAt(0)).getSheet().getActiveCellRow());
  assertEquals(3,((HSSFSheet)wb.getSheetAt(0)).getSheet().getActiveCellCol());
  Workbook wbBack=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(1,((HSSFSheet)wbBack.getSheetAt(0)).getSheet().getActiveCellRow());
  assertEquals(3,((HSSFSheet)wbBack.getSheetAt(0)).getSheet().getActiveCellCol());
  wbBack.getSheetAt(0).getRow(3).getCell(3).setAsActiveCell();
  assertEquals(3,((HSSFSheet)wbBack.getSheetAt(0)).getSheet().getActiveCellRow());
  assertEquals(3,((HSSFSheet)wbBack.getSheetAt(0)).getSheet().getActiveCellCol());
  Workbook wbBack2=_testDataProvider.writeOutAndReadBack(wbBack);
  wbBack.close();
  assertEquals(3,((HSSFSheet)wbBack2.getSheetAt(0)).getSheet().getActiveCellRow());
  assertEquals(3,((HSSFSheet)wbBack2.getSheetAt(0)).getSheet().getActiveCellCol());
  wbBack2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks that the recognition of files using 1904 date windowing
 * is working properly. Conversion of the date is also an issue,
 * but there's a separate unit test for that.
 */
@Test public void testDateWindowingRead() throws Exception {
  Calendar cal=LocaleUtil.getLocaleCalendar(2000,0,1,0,0,0);
  Date date=cal.getTime();
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("1900DateWindowing.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  assertEquals("Date from file using 1900 Date Windowing",date.getTime(),sheet.getRow(0).getCell(0).getDateCellValue().getTime());
  wb.close();
  wb=HSSFTestDataSamples.openSampleWorkbook("1904DateWindowing.xls");
  sheet=wb.getSheetAt(0);
  assertEquals("Date from file using 1904 Date Windowing",date.getTime(),sheet.getRow(0).getCell(0).getDateCellValue().getTime());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that the active cell can be correctly read and set
 */
@Test public void testActiveCell() throws Exception {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("Simple.xls");
  HSSFSheet umSheet=wb1.getSheetAt(0);
  InternalSheet s=umSheet.getSheet();
  assertEquals("Initial active cell should be in col 0",(short)0,s.getActiveCellCol());
  assertEquals("Initial active cell should be on row 1",1,s.getActiveCellRow());
  HSSFCell cell=umSheet.createRow(3).createCell(2);
  cell.setAsActiveCell();
  assertEquals("After modify, active cell should be in col 2",(short)2,s.getActiveCellCol());
  assertEquals("After modify, active cell should be on row 3",3,s.getActiveCellRow());
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  umSheet=wb2.getSheetAt(0);
  s=umSheet.getSheet();
  assertEquals("After serialize, active cell should be in col 2",(short)2,s.getActiveCellCol());
  assertEquals("After serialize, active cell should be on row 3",3,s.getActiveCellRow());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks that dates are properly written to both types of files:
 * those with 1900 and 1904 date windowing.  Note that if the
 * previous test ({@link #testDateWindowingRead}) fails, the
 * results of this test are meaningless.
 */
@Test public void testDateWindowingWrite() throws Exception {
  Calendar cal=LocaleUtil.getLocaleCalendar(2000,0,1,0,0,0);
  Date date=cal.getTime();
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("1900DateWindowing.xls");
  setCell(wb1,0,1,date);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals("Date from file using 1900 Date Windowing",date.getTime(),readCell(wb2,0,1).getTime());
  wb1.close();
  wb2.close();
  wb1=HSSFTestDataSamples.openSampleWorkbook("1904DateWindowing.xls");
  setCell(wb1,0,1,date);
  wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals("Date from file using 1900 Date Windowing",date.getTime(),readCell(wb2,0,1).getTime());
  wb1.close();
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFChart </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExistingSheet2() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("49581.xls");
  HSSFSheet sheet=wb.getSheetAt(1);
  HSSFChart[] charts=HSSFChart.getSheetCharts(sheet);
  assertEquals(1,charts.length);
  for (  HSSFChart chart : charts) {
    HSSFSeries series;
    assertEquals(1,chart.getSeries().length);
    series=chart.createSeries();
    series.setCategoryLabelsCellRange(new CellRangeAddress(3,4,0,0));
    series.setValuesCellRange(new CellRangeAddress(3,4,1,1));
    series=chart.createSeries();
    series.setCategoryLabelsCellRange(new CellRangeAddress(6,7,0,0));
    series.setValuesCellRange(new CellRangeAddress(6,7,1,1));
  }
  wb=HSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  sheet=wb.getSheetAt(1);
  assertEquals(1,HSSFChart.getSheetCharts(sheet).length);
  HSSFChart c=HSSFChart.getSheetCharts(sheet)[0];
  assertEquals(3,c.getSeries().length);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeCharts(){
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("WithThreeCharts.xls");
  HSSFSheet s1=wb.getSheetAt(0);
  HSSFSheet s2=wb.getSheetAt(1);
  HSSFSheet s3=wb.getSheetAt(2);
  assertEquals(0,HSSFChart.getSheetCharts(s1).length);
  assertEquals(2,HSSFChart.getSheetCharts(s2).length);
  assertEquals(1,HSSFChart.getSheetCharts(s3).length);
  HSSFChart[] charts;
  charts=HSSFChart.getSheetCharts(s2);
  assertEquals(2,charts.length);
  assertEquals(2,charts[0].getSeries().length);
  assertEquals("1st Column",charts[0].getSeries()[0].getSeriesTitle());
  assertEquals("2nd Column",charts[0].getSeries()[1].getSeriesTitle());
  assertEquals(6,charts[0].getSeries()[0].getNumValues());
  assertEquals(6,charts[0].getSeries()[1].getNumValues());
  assertEquals(SeriesRecord.CATEGORY_DATA_TYPE_NUMERIC,charts[0].getSeries()[0].getValueType());
  assertEquals(SeriesRecord.CATEGORY_DATA_TYPE_NUMERIC,charts[0].getSeries()[1].getValueType());
  assertNull(charts[0].getChartTitle());
  assertEquals(1,charts[1].getSeries().length);
  assertNull(charts[1].getSeries()[0].getSeriesTitle());
  assertEquals("Pie Chart Title Thingy",charts[1].getChartTitle());
  charts=HSSFChart.getSheetCharts(s3);
  assertEquals(1,charts.length);
  assertEquals(2,charts[0].getSeries().length);
  assertEquals("Squares",charts[0].getSeries()[0].getSeriesTitle());
  assertEquals("Base Numbers",charts[0].getSeries()[1].getSeriesTitle());
  assertEquals("Sheet 3 Chart with Title",charts[0].getChartTitle());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleChart(){
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("WithChart.xls");
  HSSFSheet s1=wb.getSheetAt(0);
  HSSFSheet s2=wb.getSheetAt(1);
  HSSFSheet s3=wb.getSheetAt(2);
  assertEquals(0,HSSFChart.getSheetCharts(s1).length);
  assertEquals(1,HSSFChart.getSheetCharts(s2).length);
  assertEquals(0,HSSFChart.getSheetCharts(s3).length);
  HSSFChart[] charts;
  charts=HSSFChart.getSheetCharts(s2);
  assertEquals(1,charts.length);
  assertEquals(2,charts[0].getSeries().length);
  assertEquals("1st Column",charts[0].getSeries()[0].getSeriesTitle());
  assertEquals("2nd Column",charts[0].getSeries()[1].getSeriesTitle());
  assertNull(charts[0].getChartTitle());
  assertEquals(0,charts[0].getChartX());
  assertEquals(0,charts[0].getChartY());
  assertEquals(26492928,charts[0].getChartWidth());
  assertEquals(15040512,charts[0].getChartHeight());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExistingSheet3() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("49581.xls");
  HSSFSheet sheet=wb.getSheetAt(2);
  HSSFChart[] charts=HSSFChart.getSheetCharts(sheet);
  assertEquals(1,charts.length);
  for (  HSSFChart chart : charts) {
    for (    HSSFSeries series : chart.getSeries()) {
      chart.removeSeries(series);
    }
  }
  wb=HSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  sheet=wb.getSheetAt(2);
  assertEquals(1,HSSFChart.getSheetCharts(sheet).length);
  HSSFChart c=HSSFChart.getSheetCharts(sheet)[0];
  assertEquals(0,c.getSeries().length);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 26862: HSSFWorkbook.cloneSheet copies charts
 */
@Test public void test26862() throws IOException, Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("SimpleChart.xls");
  HSSFSheet srcSheet=wb.getSheetAt(0);
  HSSFChart[] srcCharts=HSSFChart.getSheetCharts(srcSheet);
  assertEquals(1,srcCharts.length);
  HSSFChart srcChart=srcCharts[0];
  HSSFSheet clonedSheet=wb.cloneSheet(0);
  HSSFChart[] clonedCharts=HSSFChart.getSheetCharts(clonedSheet);
  assertEquals(1,clonedCharts.length);
  HSSFChart clonedChart=clonedCharts[0];
  assertNotSame(srcChart,clonedChart);
  assertEquals(srcChart.getType(),clonedChart.getType());
  assertEquals(srcChart.getChartTitle(),clonedChart.getChartTitle());
  assertEquals(srcChart.getChartWidth(),clonedChart.getChartWidth());
  assertEquals(srcChart.getChartHeight(),clonedChart.getChartHeight());
  assertEquals(srcChart.getChartX(),clonedChart.getChartX());
  assertEquals(srcChart.getChartY(),clonedChart.getChartY());
  clonedChart.setChartWidth(clonedChart.getChartWidth() + 10);
  assertEquals(srcChart.getChartWidth() + 10,clonedChart.getChartWidth());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoCharts(){
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("WithTwoCharts.xls");
  HSSFSheet s1=wb.getSheetAt(0);
  HSSFSheet s2=wb.getSheetAt(1);
  HSSFSheet s3=wb.getSheetAt(2);
  assertEquals(0,HSSFChart.getSheetCharts(s1).length);
  assertEquals(1,HSSFChart.getSheetCharts(s2).length);
  assertEquals(1,HSSFChart.getSheetCharts(s3).length);
  HSSFChart[] charts;
  charts=HSSFChart.getSheetCharts(s2);
  assertEquals(1,charts.length);
  assertEquals(2,charts[0].getSeries().length);
  assertEquals("1st Column",charts[0].getSeries()[0].getSeriesTitle());
  assertEquals("2nd Column",charts[0].getSeries()[1].getSeriesTitle());
  assertNull(charts[0].getChartTitle());
  charts=HSSFChart.getSheetCharts(s3);
  assertEquals(1,charts.length);
  assertEquals(2,charts[0].getSeries().length);
  assertEquals("Squares",charts[0].getSeries()[0].getSeriesTitle());
  assertEquals("Base Numbers",charts[0].getSeries()[1].getSeriesTitle());
  assertNull(charts[0].getChartTitle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFComment </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBug56380InsertTooManyComments() throws Exception {
  HSSFWorkbook workbook=new HSSFWorkbook();
  try {
    Sheet sheet=workbook.createSheet();
    Drawing drawing=sheet.createDrawingPatriarch();
    String comment="c";
    for (int rowNum=0; rowNum < 258; rowNum++) {
      sheet.createRow(rowNum);
    }
    for (int count=1025; count < 65535; count++) {
      int rowNum=count / 255;
      int cellNum=count % 255;
      Cell cell=sheet.getRow(rowNum).createCell(cellNum);
      try {
        Comment commentObj=insertComment(drawing,cell,comment + cellNum);
        assertEquals(count,((HSSFComment)commentObj).getNoteRecord().getShapeId());
      }
 catch (      IllegalArgumentException e) {
        throw new IllegalArgumentException("While adding shape number " + count,e);
      }
    }
    Row row=sheet.createRow(257);
    Cell cell=row.createCell(0);
    insertComment(drawing,cell,comment + 0);
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFDataFormatter </h4><pre class="type-2 type-12 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test using a default number format. The format should be used when a
 * format pattern cannot be parsed by DecimalFormat.
 */
@Test public void testSetDefaultNumberFormat(){
  HSSFRow row=wb.getSheetAt(0).getRow(3);
  Iterator<Cell> it=row.cellIterator();
  DecimalFormatSymbols dfs=DecimalFormatSymbols.getInstance(LocaleUtil.getUserLocale());
  Format defaultFormat=new DecimalFormat("Balance $#,#00.00 USD;Balance -$#,#00.00 USD",dfs);
  formatter.setDefaultNumberFormat(defaultFormat);
  log("\n==== DEFAULT NUMBER FORMAT ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    cell.setCellValue(cell.getNumericCellValue() * Math.random() / 1000000 - 1000);
    log(formatter.formatCellValue(cell));
    String formatted=formatter.formatCellValue(cell);
    assertTrue("Doesn't start with Balance: " + formatted,formatted.startsWith("Balance "));
    assertTrue("Doesn't end with USD: " + formatted,formatted.endsWith(" USD"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting formatted values from numeric and date cells.
 */
@Test public void testGetFormattedCellValueHSSFCell(){
  HSSFRow row=wb.getSheetAt(0).getRow(0);
  Iterator<Cell> it=row.cellIterator();
  log("==== VALID DATE FORMATS ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    String fmtval=formatter.formatCellValue(cell);
    log(fmtval);
    assertTrue(DateUtil.isCellDateFormatted(cell));
    assertTrue(!"555.555".equals(fmtval));
    String fmt=cell.getCellStyle().getDataFormatString();
    String monthPtrn=fmt.indexOf("mmmm") != -1 ? "MMMM" : "MMM";
    SimpleDateFormat sdf=new SimpleDateFormat(monthPtrn,LocaleUtil.getUserLocale());
    sdf.setTimeZone(LocaleUtil.getUserTimeZone());
    Calendar calDef=LocaleUtil.getLocaleCalendar(2010,6,15,0,0,0);
    String jul=sdf.format(calDef.getTime());
    if (fmt.indexOf("mmmmm") > -1) {
      jul=jul.substring(0,1);
    }
    assertTrue("Format came out incorrect - " + fmt,fmtval.indexOf(jul) > -1);
  }
  row=wb.getSheetAt(0).getRow(1);
  it=row.cellIterator();
  log("==== VALID TIME FORMATS ====");
  while (it.hasNext()) {
    Cell cell=it.next();
    String fmt=cell.getCellStyle().getDataFormatString();
    String fmtval=formatter.formatCellValue(cell);
    log(fmtval);
    assertTrue(DateUtil.isCellDateFormatted(cell));
    assertTrue(!"555.47431".equals(fmtval));
    assertTrue("Format came out incorrect - " + fmt + " - found "+ fmtval+ ", but expected to find '11:23'",fmtval.indexOf("11:23") > -1);
  }
  row=wb.getSheetAt(0).getRow(1);
  it=row.cellIterator();
  log("\n==== VALID NUMBER FORMATS ====");
  while (it.hasNext()) {
    HSSFCell cell=(HSSFCell)it.next();
    final String formatted=formatter.formatCellValue(cell);
    log(formatted);
    assertTrue(formatted != null && !formatted.contains("12345678"));
  }
  row=wb.getSheetAt(0).getRow(3);
  it=row.cellIterator();
  log("\n==== INVALID NUMBER FORMATS ====");
  while (it.hasNext()) {
    HSSFCell cell=(HSSFCell)it.next();
    log(formatter.formatCellValue(cell));
    char decimalSeparator=DecimalFormatSymbols.getInstance(LocaleUtil.getUserLocale()).getDecimalSeparator();
    assertEquals("12345678" + decimalSeparator + "9",formatter.formatCellValue(cell));
  }
  row=wb.getSheetAt(0).getRow(4);
  HSSFCell cell=row.getCell(0);
  log("\n==== ZIP FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("12345-6789",formatter.formatCellValue(cell));
  row=wb.getSheetAt(0).getRow(5);
  cell=row.getCell(0);
  log("\n==== PHONE FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("(555) 123-4567",formatter.formatCellValue(cell));
  row=wb.getSheetAt(0).getRow(6);
  cell=row.getCell(0);
  log("\n==== SSN FORMAT ====");
  log(formatter.formatCellValue(cell));
  assertEquals("444-55-1234",formatter.formatCellValue(cell));
  assertEquals(formatter.formatCellValue(null),"");
  assertEquals(formatter.formatCellValue(null),"");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFDateUtil </h4><pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of a java.util.date to Excel on a day when
 * Daylight Saving Time starts.
 */
@Test public void excelConversionOnDSTStart(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,MARCH,28,0,0,0);
  for (int hour=0; hour < 24; hour++) {
    if (hour == 2) {
      continue;
    }
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=cal.getTime();
    double excelDate=HSSFDateUtil.getExcelDate(javaDate,false);
    double difference=excelDate - Math.floor(excelDate);
    int differenceInHours=(int)(difference * 24 * 60 + 0.5) / 60;
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",hour,differenceInHours);
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",javaDate.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of an Excel date to a java.util.date on a day when
 * Daylight Saving Time starts.
 */
@Test public void javaConversionOnDSTStart(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,MARCH,28,0,0,0);
  double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
  double oneHour=1.0 / 24;
  double oneMinute=oneHour / 60;
  for (int hour=0; hour < 24; hour++, excelDate+=oneHour) {
    if (hour == 2) {
      continue;
    }
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=HSSFDateUtil.getJavaDate(excelDate,false);
    double actDate=HSSFDateUtil.getExcelDate(javaDate,false);
    assertEquals("Checking " + hour + " hours on Daylight Saving Time start date",excelDate,actDate,oneMinute);
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug56269() throws Exception {
  double excelFraction=41642.45833321759d;
  Calendar calNoRound=HSSFDateUtil.getJavaCalendar(excelFraction,false);
  assertEquals(10,calNoRound.get(Calendar.HOUR));
  assertEquals(59,calNoRound.get(Calendar.MINUTE));
  assertEquals(59,calNoRound.get(Calendar.SECOND));
  Calendar calRound=HSSFDateUtil.getJavaCalendar(excelFraction,false,null,true);
  assertEquals(11,calRound.get(Calendar.HOUR));
  assertEquals(0,calRound.get(Calendar.MINUTE));
  assertEquals(0,calRound.get(Calendar.SECOND));
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check if HSSFDateUtil.getAbsoluteDay works as advertised.
 */
@Test public void absoluteDay(){
  Calendar cal=LocaleUtil.getLocaleCalendar(1900,JANUARY,1,0,0,0);
  assertEquals("Checking absolute day (1 Jan 1900)",1,HSSFDateUtil.absoluteDay(cal,false));
  cal.set(1901,JANUARY,1,0,0,0);
  assertEquals("Checking absolute day (1 Jan 1901)",366,HSSFDateUtil.absoluteDay(cal,false));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * User reported a datetime issue in POI-2.5:
 * Setting Cell's value to Jan 1, 1900 without a time doesn't return the same value set to
 * @throws IOException 
 */
@Test public void bug19172() throws IOException {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet();
  HSSFCell cell=sheet.createRow(0).createCell(0);
  Calendar cal=LocaleUtil.getLocaleCalendar(1900,JANUARY,1);
  Date valueToTest=cal.getTime();
  cell.setCellValue(valueToTest);
  Date returnedValue=cell.getDateCellValue();
  assertEquals(valueToTest.getTime(),returnedValue.getTime());
  workbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of a java.util.Date to Excel on a day when
 * Daylight Saving Time ends.
 */
@Test public void excelConversionOnDSTEnd(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,OCTOBER,31,0,0,0);
  for (int hour=0; hour < 24; hour++) {
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=cal.getTime();
    double excelDate=HSSFDateUtil.getExcelDate(javaDate,false);
    double difference=excelDate - Math.floor(excelDate);
    int differenceInHours=(int)(difference * 24 * 60 + 0.5) / 60;
    assertEquals("Checking " + hour + " hour on Daylight Saving Time end date",hour,differenceInHours);
    assertEquals("Checking " + hour + " hour on Daylight Saving Time start date",javaDate.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the conversion of an Excel date to java.util.Date on a day when
 * Daylight Saving Time ends.
 */
@Test public void javaConversionOnDSTEnd(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2004,OCTOBER,31,0,0,0);
  double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
  double oneHour=1.0 / 24;
  double oneMinute=oneHour / 60;
  for (int hour=0; hour < 24; hour++, excelDate+=oneHour) {
    cal.set(Calendar.HOUR_OF_DAY,hour);
    Date javaDate=HSSFDateUtil.getJavaDate(excelDate,false);
    assertEquals("Checking " + hour + " hours on Daylight Saving Time start date",excelDate,HSSFDateUtil.getExcelDate(javaDate,false),oneMinute);
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks the date conversion functions in the HSSFDateUtil class.
 */
@Test public void dateConversion(){
  Calendar cal=LocaleUtil.getLocaleCalendar(2002,JANUARY,1,0,1,1);
  for (int hour=0; hour < 23; hour++) {
    double excelDate=HSSFDateUtil.getExcelDate(cal.getTime(),false);
    assertEquals("Checking hour = " + hour,cal.getTime().getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
    cal.add(Calendar.HOUR_OF_DAY,1);
  }
  double excelDate=36526.0;
  cal.set(2000,JANUARY,1,0,0,0);
  Date dateIf1900=cal.getTime();
  cal.add(Calendar.YEAR,4);
  cal.add(Calendar.DATE,1);
  Date dateIf1904=cal.getTime();
  assertEquals("Checking 1900 Date Windowing",dateIf1900.getTime(),HSSFDateUtil.getJavaDate(excelDate,false).getTime());
  assertEquals("Checking 1904 Date Windowing",dateIf1904.getTime(),HSSFDateUtil.getJavaDate(excelDate,true).getTime());
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * DateUtil.isCellFormatted(Cell) should not true for a numeric cell 
 * that's formatted as ".0000"
 */
@Test public void bug54557() throws Exception {
  final String format=".0000";
  boolean isDateFormat=HSSFDateUtil.isADateFormat(165,format);
  assertEquals(false,isDateFormat);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that we deal with time-zones properly
 */
@Test public void calendarConversion(){
  TimeZone userTZ=LocaleUtil.getUserTimeZone();
  LocaleUtil.setUserTimeZone(TimeZone.getTimeZone("CET"));
  try {
    Calendar cal=LocaleUtil.getLocaleCalendar(2002,JANUARY,1,12,1,1);
    Date expected=cal.getTime();
    for (int hour=-12; hour <= 12; hour++) {
      String id="GMT" + (hour < 0 ? "" : "+") + hour+ ":00";
      cal.setTimeZone(TimeZone.getTimeZone(id));
      cal.set(Calendar.HOUR_OF_DAY,12);
      double excelDate=HSSFDateUtil.getExcelDate(cal,false);
      Date javaDate=HSSFDateUtil.getJavaDate(excelDate);
      assertEquals("Checking timezone " + id,expected.getTime(),javaDate.getTime());
    }
    TimeZone cet=TimeZone.getTimeZone("Europe/Copenhagen");
    TimeZone ldn=TimeZone.getTimeZone("Europe/London");
    double excelDate=41026.53125;
    assertEquals(HSSFDateUtil.getJavaDate(excelDate,false).getTime(),HSSFDateUtil.getJavaDate(excelDate,false,cet).getTime());
    Date cetDate=HSSFDateUtil.getJavaDate(excelDate,false);
    Date ldnDate=HSSFDateUtil.getJavaDate(excelDate,false,ldn);
    assertEquals(ldnDate.getTime() - cetDate.getTime(),60 * 60 * 1000);
  }
  finally {
    LocaleUtil.setUserTimeZone(userTZ);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFFormulaEvaluator </h4><pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensures that we can handle NameXPtgs in the formulas
 * we parse.
 */
@Test public void testXRefs() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("XRefCalc.xls");
  HSSFWorkbook wb2=HSSFTestDataSamples.openSampleWorkbook("XRefCalcData.xls");
  Cell cell;
  cell=wb1.getSheetAt(0).getRow(1).getCell(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(12.30,cell.getNumericCellValue(),0.0001);
  assertEquals("VLOOKUP(PART,COSTS,2,FALSE)",cell.getCellFormula());
  cell=wb1.getSheetAt(0).getRow(1).getCell(4);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(36.90,cell.getNumericCellValue(),0.0001);
  assertEquals("Cost*Markup_Cost",cell.getCellFormula());
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2)});
  eval.evaluateFormulaCell(wb1.getSheetAt(0).getRow(1).getCell(2));
  eval.evaluateFormulaCell(wb1.getSheetAt(0).getRow(1).getCell(4));
  cell=wb1.getSheetAt(0).getRow(1).getCell(2);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(12.30,cell.getNumericCellValue(),0.0001);
  cell=wb1.getSheetAt(0).getRow(1).getCell(4);
  assertEquals(Cell.CELL_TYPE_FORMULA,cell.getCellType());
  assertEquals(Cell.CELL_TYPE_NUMERIC,cell.getCachedFormulaResultType());
  assertEquals(36.90,cell.getNumericCellValue(),0.0001);
  cell=wb1.getSheetAt(0).getRow(1).createCell(40);
  cell.setCellFormula("Cost*[XRefCalcData.xls]MarkupSheet!$B$1");
  assertEquals("Cost*[XRefCalcData.xls]MarkupSheet!$B$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals(24.60 * 1.8,cell.getNumericCellValue(),0);
  try {
    cell=wb1.getSheetAt(0).getRow(1).createCell(42);
    cell.setCellFormula("[alt.xls]Sheet0!$A$1");
    fail("New workbook not linked, shouldn't be able to add");
  }
 catch (  Exception e) {
  }
  HSSFWorkbook wb3=new HSSFWorkbook();
  wb3.createSheet().createRow(0).createCell(0).setCellValue("In another workbook");
  wb1.linkExternalWorkbook("alt.xls",wb3);
  cell.setCellFormula("[alt.xls]Sheet0!$A$1");
  assertEquals("[alt.xls]Sheet0!$A$1",cell.getCellFormula());
  try {
    eval.evaluate(cell);
    fail("No cached value and no link to workbook, shouldn't evaluate");
  }
 catch (  Exception e) {
  }
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls","alt.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2),new HSSFFormulaEvaluator(wb3)});
  eval.evaluateFormulaCell(cell);
  assertEquals("In another workbook",cell.getStringCellValue());
  HSSFWorkbook wb4=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  eval=new HSSFFormulaEvaluator(wb4);
  HSSFFormulaEvaluator.setupEnvironment(new String[]{"XRefCalc.xls","XRefCalcData.xls","alt.xls"},new HSSFFormulaEvaluator[]{eval,new HSSFFormulaEvaluator(wb2),new HSSFFormulaEvaluator(wb3)});
  cell=wb4.getSheetAt(0).getRow(1).getCell(40);
  assertEquals("Cost*[XRefCalcData.xls]MarkupSheet!$B$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals(24.60 * 1.8,cell.getNumericCellValue(),0);
  cell=wb4.getSheetAt(0).getRow(1).getCell(42);
  assertEquals("[alt.xls]Sheet0!$A$1",cell.getCellFormula());
  eval.evaluateFormulaCell(cell);
  assertEquals("In another workbook",cell.getStringCellValue());
  wb4.close();
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testShortCircuitIfEvaluation() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  cellA1.setCellFormula("if(B1,C1,D1+E1+F1)");
  for (int i=1; i < 6; i++) {
    row.createCell(i).setCellFormula(String.valueOf(i));
  }
  EvalCountListener evalListener=new EvalCountListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cellA1));
  int evalCount=evalListener.getEvalCount();
  if (evalCount == 6) {
    fail("Identifed bug 48195 - Formula evaluator should short-circuit IF() calculations.");
  }
  assertEquals(3,evalCount);
  assertEquals(2.0,((NumberEval)ve).getNumberValue(),0D);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFHyperlink </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModify(){
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("HyperlinksOnManySheets.xls");
  HSSFSheet sheet;
  HSSFCell cell;
  HSSFHyperlink link;
  sheet=wb.getSheet("WebLinks");
  cell=sheet.getRow(4).getCell(0);
  link=cell.getHyperlink();
  link.setAddress("www.apache.org");
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  sheet=wb.getSheet("WebLinks");
  cell=sheet.getRow(4).getCell(0);
  link=cell.getHyperlink();
  assertNotNull(link);
  assertEquals("www.apache.org",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFHyperlink link;
  HSSFCell cell;
  HSSFSheet sheet=wb.createSheet("Hyperlinks");
  cell=sheet.createRow(1).createCell(0);
  cell.setCellValue("File Link");
  link=new HSSFHyperlink(HSSFHyperlink.LINK_FILE);
  link.setAddress("testfolder\\test.PDF");
  cell.setHyperlink(link);
  HSSFWorkbook wbBack=HSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  sheet=wbBack.getSheet("Hyperlinks");
  cell=sheet.getRow(1).getCell(0);
  link=cell.getHyperlink();
  assertNotNull(link);
  assertEquals("testfolder\\test.PDF",link.getAddress());
  wbBack.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * HSSF-specific ways of creating links to a place in workbook.
 * You can set the target  in two ways:
 * link.setTextMark("'Target Sheet-1'!A1"); //HSSF-specific
 * or
 * link.setAddress("'Target Sheet-1'!A1"); //common between XSSF and HSSF
 * @throws IOException 
 */
@Test public void testCreateDocumentLink() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFHyperlink link;
  HSSFCell cell;
  HSSFSheet sheet=wb.createSheet("Hyperlinks");
  HSSFSheet sheet2=wb.createSheet("Target Sheet");
  sheet2.createRow(0).createCell(0).setCellValue("Target Cell");
  cell=sheet.createRow(0).createCell(0);
  cell.setCellValue("Worksheet Link");
  link=new HSSFHyperlink(HSSFHyperlink.LINK_DOCUMENT);
  link.setTextMark("'Target Sheet'!A1");
  cell.setHyperlink(link);
  cell=sheet.createRow(1).createCell(0);
  cell.setCellValue("Worksheet Link");
  link=new HSSFHyperlink(HSSFHyperlink.LINK_DOCUMENT);
  link.setAddress("'Hyperlinks'!A1");
  cell.setHyperlink(link);
  HSSFWorkbook wbBack=HSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  sheet=wbBack.getSheet("Hyperlinks");
  cell=sheet.getRow(0).getCell(0);
  link=cell.getHyperlink();
  assertNotNull(link);
  assertEquals("'Target Sheet'!A1",link.getTextMark());
  assertEquals("'Target Sheet'!A1",link.getAddress());
  cell=sheet.getRow(1).getCell(0);
  link=cell.getHyperlink();
  assertNotNull(link);
  assertEquals("'Hyperlinks'!A1",link.getTextMark());
  assertEquals("'Hyperlinks'!A1",link.getAddress());
  wbBack.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFName </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * When setting A1 type of references with HSSFName.setRefersToFormula
 * must set the type of operands to Ptg.CLASS_REF,
 * otherwise created named don't appear in the drop-down to the left of formula bar in Excel
 */
@Test public void testTypeOfRootPtg() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  wb.createSheet("CSCO");
  Ptg[] ptgs=HSSFFormulaParser.parse("CSCO!$E$71",wb,FormulaType.NAMEDRANGE,0);
  for (int i=0; i < ptgs.length; i++) {
    assertEquals('R',ptgs[i].getRVAType());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRepeatingRowsAndColumsNames() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("FirstSheet");
  for (int i=0; i < 2; i++) {
    wb.setRepeatingRowsAndColumns(0,0,0,0,3 - 1);
    sheet.createFreezePane(0,3);
  }
  assertEquals(1,wb.getNumberOfNames());
  HSSFName nr1=wb.getNameAt(0);
  assertEquals("Print_Titles",nr1.getNameName());
  assertEquals("FirstSheet!A:A,FirstSheet!$A$1:$IV$3",nr1.getRefersToFormula());
  HSSFWorkbook nwb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(1,nwb.getNumberOfNames());
  nr1=nwb.getNameAt(0);
  assertEquals("Print_Titles",nr1.getNameName());
  assertEquals("FirstSheet!A:A,FirstSheet!$A$1:$IV$3",nr1.getRefersToFormula());
  sheet=nwb.createSheet("SecondSheet");
  nwb.setRepeatingRowsAndColumns(1,1,2,0,0);
  assertEquals(2,nwb.getNumberOfNames());
  HSSFName nr2=nwb.getNameAt(1);
  assertEquals("Print_Titles",nr2.getNameName());
  assertEquals("SecondSheet!B:C,SecondSheet!$A$1:$IV$1",nr2.getRefersToFormula());
  nwb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamedRange() throws Exception {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("Simple.xls");
  HSSFName newNamedRange=wb1.createName();
  String sheetName=wb1.getSheetName(0);
  newNamedRange.setNameName("RangeTest");
  newNamedRange.setRefersToFormula(sheetName + "!$D$4:$E$8");
  HSSFName namedRange1=wb1.getNameAt(0);
  sheetName=namedRange1.getSheetName();
  SanityChecker c=new SanityChecker();
  c.checkHSSFWorkbook(wb1);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  HSSFName nm=wb2.getNameAt(wb2.getNameIndex("RangeTest"));
  assertTrue("Name is " + nm.getNameName(),"RangeTest".equals(nm.getNameName()));
  assertEquals(wb2.getSheetName(0) + "!$D$4:$E$8",nm.getRefersToFormula());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFPalette </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test48403() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  Color color=Color.decode("#006B6B");
  HSSFPalette palette=wb.getCustomPalette();
  HSSFColor hssfColor=palette.findColor((byte)color.getRed(),(byte)color.getGreen(),(byte)color.getBlue());
  assertNull(hssfColor);
  palette.setColorAtIndex((short)(PaletteRecord.STANDARD_PALETTE_SIZE - 1),(byte)color.getRed(),(byte)color.getGreen(),(byte)color.getBlue());
  hssfColor=palette.getColor((short)(PaletteRecord.STANDARD_PALETTE_SIZE - 1));
  assertNotNull(hssfColor);
  assertEquals(55,hssfColor.getIndex());
  assertArrayEquals(new short[]{0,107,107},hssfColor.getTriplet());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFPicture </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void setGetProperties() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sh=wb.createSheet("Pictures");
  HSSFPatriarch dr=sh.createDrawingPatriarch();
  HSSFClientAnchor anchor=new HSSFClientAnchor();
  byte[] data1=new byte[]{1,2,3};
  int idx1=wb.addPicture(data1,Workbook.PICTURE_TYPE_JPEG);
  HSSFPicture p1=dr.createPicture(anchor,idx1);
  assertEquals(p1.getFileName(),"");
  p1.setFileName("aaa");
  assertEquals(p1.getFileName(),"aaa");
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  sh=wb.getSheet("Pictures");
  dr=sh.getDrawingPatriarch();
  p1=(HSSFPicture)dr.getChildren().get(0);
  assertEquals(p1.getFileName(),"aaa");
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings("resource") @Test public void bug49658() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  byte pictureDataEmf[]=POIDataSamples.getDocumentInstance().readFile("vector_image.emf");
  int indexEmf=wb.addPicture(pictureDataEmf,HSSFWorkbook.PICTURE_TYPE_EMF);
  byte pictureDataPng[]=POIDataSamples.getSpreadSheetInstance().readFile("logoKarmokar4.png");
  int indexPng=wb.addPicture(pictureDataPng,HSSFWorkbook.PICTURE_TYPE_PNG);
  byte pictureDataWmf[]=POIDataSamples.getSlideShowInstance().readFile("santa.wmf");
  int indexWmf=wb.addPicture(pictureDataWmf,HSSFWorkbook.PICTURE_TYPE_WMF);
  HSSFSheet sheet=wb.createSheet();
  HSSFPatriarch patriarch=sheet.createDrawingPatriarch();
  CreationHelper ch=wb.getCreationHelper();
  ClientAnchor anchor=ch.createClientAnchor();
  anchor.setCol1(2);
  anchor.setCol2(5);
  anchor.setRow1(1);
  anchor.setRow2(6);
  patriarch.createPicture(anchor,indexEmf);
  anchor=ch.createClientAnchor();
  anchor.setCol1(2);
  anchor.setCol2(5);
  anchor.setRow1(10);
  anchor.setRow2(16);
  patriarch.createPicture(anchor,indexPng);
  anchor=ch.createClientAnchor();
  anchor.setCol1(6);
  anchor.setCol2(9);
  anchor.setRow1(1);
  anchor.setRow2(6);
  patriarch.createPicture(anchor,indexWmf);
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  byte pictureDataOut[]=wb.getAllPictures().get(0).getData();
  assertArrayEquals(pictureDataEmf,pictureDataOut);
  byte wmfNoHeader[]=new byte[pictureDataWmf.length - 22];
  System.arraycopy(pictureDataWmf,22,wmfNoHeader,0,pictureDataWmf.length - 22);
  pictureDataOut=wb.getAllPictures().get(2).getData();
  assertArrayEquals(wmfNoHeader,pictureDataOut);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void addPictures() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sh=wb.createSheet("Pictures");
  HSSFPatriarch dr=sh.createDrawingPatriarch();
  assertEquals(0,dr.getChildren().size());
  HSSFClientAnchor anchor=wb.getCreationHelper().createClientAnchor();
  byte[] data1=new byte[]{1,2,3};
  int idx1=wb.addPicture(data1,Workbook.PICTURE_TYPE_JPEG);
  assertEquals(1,idx1);
  HSSFPicture p1=dr.createPicture(anchor,idx1);
  assertArrayEquals(data1,p1.getPictureData().getData());
  byte[] data2=new byte[]{4,5,6};
  int idx2=wb.addPicture(data2,Workbook.PICTURE_TYPE_JPEG);
  assertEquals(2,idx2);
  HSSFPicture p2=dr.createPicture(anchor,idx2);
  assertEquals(2,dr.getChildren().size());
  assertArrayEquals(data2,p2.getPictureData().getData());
  assertArrayEquals(data1,((HSSFPicture)dr.getChildren().get(0)).getPictureData().getData());
  assertArrayEquals(data2,((HSSFPicture)dr.getChildren().get(1)).getPictureData().getData());
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  List<? extends PictureData> lst2=wb.getAllPictures();
  assertEquals(2,lst2.size());
  assertArrayEquals(data1,lst2.get(0).getData());
  assertArrayEquals(data2,lst2.get(1).getData());
  sh=wb.getSheet("Pictures");
  dr=sh.createDrawingPatriarch();
  assertEquals(2,dr.getChildren().size());
  assertArrayEquals(data1,((HSSFPicture)dr.getChildren().get(0)).getPictureData().getData());
  assertArrayEquals(data2,((HSSFPicture)dr.getChildren().get(1)).getPictureData().getData());
  byte[] data3=new byte[]{7,8,9};
  int idx3=wb.addPicture(data3,Workbook.PICTURE_TYPE_JPEG);
  assertEquals(3,idx3);
  HSSFPicture p3=dr.createPicture(anchor,idx3);
  assertArrayEquals(data3,p3.getPictureData().getData());
  assertEquals(3,dr.getChildren().size());
  assertArrayEquals(data1,((HSSFPicture)dr.getChildren().get(0)).getPictureData().getData());
  assertArrayEquals(data2,((HSSFPicture)dr.getChildren().get(1)).getPictureData().getData());
  assertArrayEquals(data3,((HSSFPicture)dr.getChildren().get(2)).getPictureData().getData());
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  List<? extends PictureData> lst3=wb.getAllPictures();
  assertEquals(3,lst3.size());
  assertArrayEquals(data1,lst3.get(0).getData());
  assertArrayEquals(data2,lst3.get(1).getData());
  assertArrayEquals(data3,lst3.get(2).getData());
  sh=wb.getSheet("Pictures");
  dr=sh.createDrawingPatriarch();
  assertEquals(3,dr.getChildren().size());
  byte[] data4=new byte[]{10,11,12};
  int idx4=wb.addPicture(data4,Workbook.PICTURE_TYPE_JPEG);
  assertEquals(4,idx4);
  dr.createPicture(anchor,idx4);
  assertEquals(4,dr.getChildren().size());
  assertArrayEquals(data1,((HSSFPicture)dr.getChildren().get(0)).getPictureData().getData());
  assertArrayEquals(data2,((HSSFPicture)dr.getChildren().get(1)).getPictureData().getData());
  assertArrayEquals(data3,((HSSFPicture)dr.getChildren().get(2)).getPictureData().getData());
  assertArrayEquals(data4,((HSSFPicture)dr.getChildren().get(3)).getPictureData().getData());
  wb=HSSFTestDataSamples.writeOutAndReadBack(wb);
  List<? extends PictureData> lst4=wb.getAllPictures();
  assertEquals(4,lst4.size());
  assertArrayEquals(data1,lst4.get(0).getData());
  assertArrayEquals(data2,lst4.get(1).getData());
  assertArrayEquals(data3,lst4.get(2).getData());
  assertArrayEquals(data4,lst4.get(3).getData());
  sh=wb.getSheet("Pictures");
  dr=sh.createDrawingPatriarch();
  assertEquals(4,dr.getChildren().size());
  assertArrayEquals(data1,((HSSFPicture)dr.getChildren().get(0)).getPictureData().getData());
  assertArrayEquals(data2,((HSSFPicture)dr.getChildren().get(1)).getPictureData().getData());
  assertArrayEquals(data3,((HSSFPicture)dr.getChildren().get(2)).getPictureData().getData());
  assertArrayEquals(data4,((HSSFPicture)dr.getChildren().get(3)).getPictureData().getData());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unused") @Test public void bsePictureRef() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sh=wb.createSheet("Pictures");
  HSSFPatriarch dr=sh.createDrawingPatriarch();
  HSSFClientAnchor anchor=new HSSFClientAnchor();
  InternalSheet ish=HSSFTestHelper.getSheetForTest(sh);
  byte[] data1=new byte[]{1,2,3};
  int idx1=wb.addPicture(data1,Workbook.PICTURE_TYPE_JPEG);
  assertEquals(1,idx1);
  HSSFPicture p1=dr.createPicture(anchor,idx1);
  EscherBSERecord bse=wb.getWorkbook().getBSERecord(idx1);
  assertEquals(bse.getRef(),1);
  dr.createPicture(new HSSFClientAnchor(),idx1);
  assertEquals(bse.getRef(),2);
  HSSFShapeGroup gr=dr.createGroup(new HSSFClientAnchor());
  gr.createPicture(new HSSFChildAnchor(),idx1);
  assertEquals(bse.getRef(),3);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheet </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void groupRows() throws IOException {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet();
  HSSFRow r1=s.createRow(0);
  HSSFRow r2=s.createRow(1);
  HSSFRow r3=s.createRow(2);
  HSSFRow r4=s.createRow(3);
  HSSFRow r5=s.createRow(4);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(0,r3.getOutlineLevel());
  assertEquals(0,r4.getOutlineLevel());
  assertEquals(0,r5.getOutlineLevel());
  s.groupRow(2,3);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(0,r5.getOutlineLevel());
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  r1=s.getRow(0);
  r2=s.getRow(1);
  r3=s.getRow(2);
  r4=s.getRow(3);
  r5=s.getRow(4);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(0,r5.getOutlineLevel());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * If we clone a sheet containing drawings,
 * we must allocate a new ID of the drawing group and re-create shape IDs
 * See bug #45720.
 */
@Test public void cloneSheetWithDrawings() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("45720.xls");
  HSSFSheet sheet1=wb1.getSheetAt(0);
  wb1.getWorkbook().findDrawingGroup();
  DrawingManager2 dm1=wb1.getWorkbook().getDrawingManager();
  wb1.cloneSheet(0);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  wb2.getWorkbook().findDrawingGroup();
  DrawingManager2 dm2=wb2.getWorkbook().getDrawingManager();
  assertEquals(dm1.getDgg().getMaxDrawingGroupId() + 1,dm2.getDgg().getMaxDrawingGroupId());
  HSSFSheet sheet2=wb2.getSheetAt(1);
  EscherDgRecord dg1=(EscherDgRecord)sheet1.getDrawingPatriarch().getBoundAggregate().findFirstWithId(EscherDgRecord.RECORD_ID);
  EscherDgRecord dg2=(EscherDgRecord)sheet2.getDrawingPatriarch().getBoundAggregate().findFirstWithId(EscherDgRecord.RECORD_ID);
  int dg_id_1=dg1.getOptions() >> 4;
  int dg_id_2=dg2.getOptions() >> 4;
  assertEquals(dg_id_1 + 1,dg_id_2);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void columnWidthShort() throws IOException {
  HSSFWorkbook wb1=new HSSFWorkbook();
  Sheet sheet=wb1.createSheet();
  sheet.setDefaultColumnWidth((short)10);
  assertEquals(10,sheet.getDefaultColumnWidth());
  assertEquals(256 * 10,sheet.getColumnWidth((short)0));
  assertEquals(256 * 10,sheet.getColumnWidth((short)1));
  assertEquals(256 * 10,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    sheet.setColumnWidth((short)i,w);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setDefaultColumnWidth((short)20);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    int w=256 * 12;
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  sheet.setColumnWidth((short)10,40000);
  assertEquals(40000,sheet.getColumnWidth((short)10));
  try {
    sheet.setColumnWidth((short)9,256 * 256);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The maximum column width for an individual cell is 255 characters.",e.getMessage());
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertEquals(20,sheet.getDefaultColumnWidth());
  assertEquals(256 * 20,sheet.getColumnWidth((short)0));
  assertEquals(256 * 20,sheet.getColumnWidth((short)1));
  assertEquals(256 * 20,sheet.getColumnWidth((short)2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sheet.getColumnWidth((short)i));
  }
  assertEquals(40000,sheet.getColumnWidth((short)10));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When removing one merged region, it would break
 * Make sure the excel file loads work
 */
@Test public void pageBreakFiles() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("SimpleWithPageBreaks.xls");
  HSSFSheet sheet=wb1.getSheetAt(0);
  assertNotNull(sheet);
  assertEquals("1 row page break",1,sheet.getRowBreaks().length);
  assertEquals("1 column page break",1,sheet.getColumnBreaks().length);
  assertTrue("No row page break",sheet.isRowBroken(22));
  assertTrue("No column page break",sheet.isColumnBroken((short)4));
  sheet.setRowBreak(10);
  sheet.setColumnBreak((short)13);
  assertEquals("row breaks number",2,sheet.getRowBreaks().length);
  assertEquals("column breaks number",2,sheet.getColumnBreaks().length);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertTrue("No row page break",sheet.isRowBroken(22));
  assertTrue("No column page break",sheet.isColumnBroken((short)4));
  assertEquals("row breaks number",2,sheet.getRowBreaks().length);
  assertEquals("column breaks number",2,sheet.getColumnBreaks().length);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoFilter() throws IOException {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet sh=wb1.createSheet();
  InternalWorkbook iwb=wb1.getWorkbook();
  InternalSheet ish=sh.getSheet();
  assertNull(iwb.getSpecificBuiltinRecord(NameRecord.BUILTIN_FILTER_DB,1));
  assertNull(ish.findFirstRecordBySid(AutoFilterInfoRecord.sid));
  CellRangeAddress range=CellRangeAddress.valueOf("A1:B10");
  sh.setAutoFilter(range);
  NameRecord name=iwb.getSpecificBuiltinRecord(NameRecord.BUILTIN_FILTER_DB,1);
  assertNotNull(name);
  Ptg[] ptg=name.getNameDefinition();
  assertEquals("The built-in name for auto-filter must consist of a single Area3d Ptg",1,ptg.length);
  assertTrue("The built-in name for auto-filter must consist of a single Area3d Ptg",ptg[0] instanceof Area3DPtg);
  Area3DPtg aref=(Area3DPtg)ptg[0];
  assertEquals(range.getFirstColumn(),aref.getFirstColumn());
  assertEquals(range.getFirstRow(),aref.getFirstRow());
  assertEquals(range.getLastColumn(),aref.getLastColumn());
  assertEquals(range.getLastRow(),aref.getLastRow());
  AutoFilterInfoRecord afilter=(AutoFilterInfoRecord)ish.findFirstRecordBySid(AutoFilterInfoRecord.sid);
  assertNotNull(afilter);
  assertEquals(2,afilter.getNumEntries());
  HSSFPatriarch dr=sh.getDrawingPatriarch();
  assertNotNull(dr);
  HSSFSimpleShape comboBoxShape=(HSSFSimpleShape)dr.getChildren().get(0);
  assertEquals(comboBoxShape.getShapeType(),HSSFSimpleShape.OBJECT_TYPE_COMBO_BOX);
  assertNull(ish.findFirstRecordBySid(ObjRecord.sid));
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sh=wb2.getSheetAt(0);
  ish=sh.getSheet();
  ObjRecord objRecord=(ObjRecord)ish.findFirstRecordBySid(ObjRecord.sid);
  List<SubRecord> subRecords=objRecord.getSubRecords();
  assertEquals(3,subRecords.size());
  assertTrue(subRecords.get(0) instanceof CommonObjectDataSubRecord);
  assertTrue(subRecords.get(1) instanceof FtCblsSubRecord);
  assertTrue(subRecords.get(2) instanceof LbsDataSubRecord);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void groupRowsExisting() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("NoGutsRecords.xls");
  HSSFSheet s=wb1.getSheetAt(0);
  HSSFRow r1=s.getRow(0);
  HSSFRow r2=s.getRow(1);
  HSSFRow r3=s.getRow(2);
  HSSFRow r4=s.getRow(3);
  HSSFRow r5=s.getRow(4);
  HSSFRow r6=s.getRow(5);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(0,r3.getOutlineLevel());
  assertEquals(0,r4.getOutlineLevel());
  assertEquals(0,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  s.groupRow(2,4);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(1,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  HSSFWorkbook wb2=null;
  try {
    wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  }
 catch (  OutOfMemoryError e) {
    fail("Identified bug 39903");
  }
  s=wb2.getSheetAt(0);
  r1=s.getRow(0);
  r2=s.getRow(1);
  r3=s.getRow(2);
  r4=s.getRow(3);
  r5=s.getRow(4);
  r6=s.getRow(5);
  assertEquals(0,r1.getOutlineLevel());
  assertEquals(0,r2.getOutlineLevel());
  assertEquals(1,r3.getOutlineLevel());
  assertEquals(1,r4.getOutlineLevel());
  assertEquals(1,r5.getOutlineLevel());
  assertEquals(0,r6.getOutlineLevel());
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Setting ForceFormulaRecalculation on sheets
 */
@Test public void forceRecalculation() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("UncalcedRecord.xls");
  HSSFSheet sheet=wb1.getSheetAt(0);
  HSSFSheet sheet2=wb1.getSheetAt(0);
  HSSFRow row=sheet.getRow(0);
  row.createCell(0).setCellValue(5);
  row.createCell(1).setCellValue(8);
  assertFalse(sheet.getForceFormulaRecalculation());
  assertFalse(sheet2.getForceFormulaRecalculation());
  HSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  sheet.setForceFormulaRecalculation(true);
  assertTrue(sheet.getForceFormulaRecalculation());
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  sheet2=wb2.getSheetAt(1);
  assertTrue(sheet.getForceFormulaRecalculation());
  assertFalse(sheet2.getForceFormulaRecalculation());
  sheet.setForceFormulaRecalculation(false);
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  assertFalse(wb3.getSheetAt(0).getForceFormulaRecalculation());
  assertFalse(wb3.getSheetAt(1).getForceFormulaRecalculation());
  assertFalse(wb3.getSheetAt(2).getForceFormulaRecalculation());
  HSSFSheet s4=wb3.createSheet();
  s4.setForceFormulaRecalculation(true);
  assertFalse(sheet.getForceFormulaRecalculation());
  assertFalse(sheet2.getForceFormulaRecalculation());
  assertTrue(s4.getForceFormulaRecalculation());
  HSSFWorkbook wb4=HSSFTestDataSamples.writeOutAndReadBack(wb3);
  wb3.close();
  assertFalse(wb4.getSheetAt(0).getForceFormulaRecalculation());
  assertFalse(wb4.getSheetAt(1).getForceFormulaRecalculation());
  assertFalse(wb4.getSheetAt(2).getForceFormulaRecalculation());
  assertTrue(wb4.getSheetAt(3).getForceFormulaRecalculation());
  wb4.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("43902.xls");
  String sheetName="my sheet";
  HSSFSheet sheet=wb1.getSheet(sheetName);
  int minWithRow1And2=6400;
  int maxWithRow1And2=7800;
  int minWithRow1Only=2750;
  int maxWithRow1Only=3400;
  sheet.autoSizeColumn((short)0);
  assertTrue("Column autosized with only one row: wrong width",sheet.getColumnWidth(0) >= minWithRow1And2);
  assertTrue("Column autosized with only one row: wrong width",sheet.getColumnWidth(0) <= maxWithRow1And2);
  sheet.addMergedRegion(new CellRangeAddress(1,1,0,1));
  assertNotNull(sheet.getMergedRegion(0));
  sheet.autoSizeColumn((short)0);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  HSSFSheet sheet2=wb2.getSheet(sheetName);
  assertTrue(sheet2.getColumnWidth(0) >= minWithRow1Only);
  assertTrue(sheet2.getColumnWidth(0) <= maxWithRow1Only);
  sheet2.removeMergedRegion(1);
  sheet2.autoSizeColumn((short)0);
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  HSSFSheet sheet3=wb3.getSheet(sheetName);
  assertTrue(sheet3.getColumnWidth(0) >= minWithRow1And2);
  assertTrue(sheet3.getColumnWidth(0) <= maxWithRow1And2);
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void columnWidthA() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("colwidth.xls");
  int[] ref={365,548,731,914,1097,1280,1462,1645,1828,2011,2194,2377,2560,2742,2925,3108,3291,3474,3657};
  HSSFSheet sh=wb1.getSheetAt(0);
  for (char i='A'; i <= 'S'; i++) {
    int idx=i - 'A';
    int w=sh.getColumnWidth(idx);
    assertEquals(ref[idx],w);
  }
  sh=wb1.getSheetAt(1);
  int def_width=sh.getDefaultColumnWidth();
  for (char i='A'; i <= 'S'; i++) {
    int idx=i - 'A';
    int w=sh.getColumnWidth(idx);
    assertEquals(def_width * 256,w);
  }
  wb1.close();
  HSSFWorkbook wb2=new HSSFWorkbook();
  sh=wb2.createSheet();
  sh.setDefaultColumnWidth(10);
  assertEquals(10,sh.getDefaultColumnWidth());
  assertEquals(256 * 10,sh.getColumnWidth(0));
  assertEquals(256 * 10,sh.getColumnWidth(1));
  assertEquals(256 * 10,sh.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    sh.setColumnWidth(i,w);
    assertEquals(w,sh.getColumnWidth(i));
  }
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sh=wb3.getSheetAt(0);
  assertEquals(10,sh.getDefaultColumnWidth());
  assertEquals(256 * 10,sh.getColumnWidth(0));
  assertEquals(256 * 10,sh.getColumnWidth(1));
  assertEquals(256 * 10,sh.getColumnWidth(2));
  for (char i='D'; i <= 'F'; i++) {
    short w=(256 * 12);
    assertEquals(w,sh.getColumnWidth(i));
  }
  sh.setColumnWidth(0,40000);
  assertEquals(40000,sh.getColumnWidth(0));
  wb3.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheetUpdateArrayFormulas </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Makes sure the internal state of HSSFSheet is consistent after removing array formulas
 */
@Test public void testAddRemoveArrayFormulas_recordUpdates() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet("Sheet1");
  CellRange<HSSFCell> cr=s.setArrayFormula("123",CellRangeAddress.valueOf("B5:C6"));
  Record[] recs;
  int ix;
  recs=RecordInspector.getRecords(s,0);
  ix=findRecordOfType(recs,ArrayRecord.class,0);
  confirmRecordClass(recs,ix - 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 2,FormulaRecord.class);
  confirmRecordClass(recs,ix + 3,FormulaRecord.class);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,ix + 1) < 0);
  s.removeArrayFormula(cr.getTopLeftCell());
  recs=RecordInspector.getRecords(s,0);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,0) < 0);
  assertTrue(findRecordOfType(recs,FormulaRecord.class,0) < 0);
  RowRecordsAggregate rra=s.getSheet().getRowsAggregate();
  SharedValueManager svm=TestSharedValueManager.extractFromRRA(rra);
  if (svm.getArrayRecord(4,1) != null) {
    fail("Array record was not cleaned up properly.");
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFWorkbook </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests for {@link HSSFWorkbook#isHidden()} etc
 * @throws IOException 
 */
@Test public void hidden() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  WindowOneRecord w1=wb.getWorkbook().getWindowOne();
  assertEquals(false,wb.isHidden());
  assertEquals(false,w1.getHidden());
  wb.setHidden(true);
  assertEquals(true,wb.isHidden());
  assertEquals(true,w1.getHidden());
  HSSFWorkbook wbBack=HSSFTestDataSamples.writeOutAndReadBack(wb);
  w1=wbBack.getWorkbook().getWindowOne();
  wbBack.setHidden(true);
  assertEquals(true,wbBack.isHidden());
  assertEquals(true,w1.getHidden());
  wbBack.setHidden(false);
  assertEquals(false,wbBack.isHidden());
  assertEquals(false,w1.getHidden());
  wbBack.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readWriteWithCharts() throws IOException {
  HSSFSheet s;
  HSSFWorkbook b1=HSSFTestDataSamples.openSampleWorkbook("44010-SingleChart.xls");
  assertEquals(2,b1.getNumberOfSheets());
  assertEquals("Graph2",b1.getSheetName(1));
  s=b1.getSheetAt(1);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  assertNotNull(b1.getSheetAt(0).getDrawingPatriarch());
  assertNull(b1.getSheetAt(1).getDrawingPatriarch());
  assertFalse(b1.getSheetAt(0).getDrawingPatriarch().containsChart());
  b1.close();
  HSSFWorkbook b2=HSSFTestDataSamples.openSampleWorkbook("44010-SingleChart.xls");
  HSSFWorkbook b3=HSSFTestDataSamples.writeOutAndReadBack(b2);
  b2.close();
  assertEquals(2,b3.getNumberOfSheets());
  s=b3.getSheetAt(1);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  b3.close();
  HSSFWorkbook b4=HSSFTestDataSamples.openSampleWorkbook("44010-TwoCharts.xls");
  assertEquals(3,b4.getNumberOfSheets());
  s=b4.getSheetAt(1);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  s=b4.getSheetAt(2);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  assertNotNull(b4.getSheetAt(0).getDrawingPatriarch());
  assertNull(b4.getSheetAt(1).getDrawingPatriarch());
  assertNull(b4.getSheetAt(2).getDrawingPatriarch());
  assertFalse(b4.getSheetAt(0).getDrawingPatriarch().containsChart());
  b4.close();
  HSSFWorkbook b5=HSSFTestDataSamples.openSampleWorkbook("44010-TwoCharts.xls");
  HSSFWorkbook b6=HSSFTestDataSamples.writeOutAndReadBack(b5);
  b5.close();
  assertEquals(3,b6.getNumberOfSheets());
  s=b6.getSheetAt(1);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  s=b6.getSheetAt(2);
  assertEquals(0,s.getFirstRowNum());
  assertEquals(8,s.getLastRowNum());
  b6.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Checks that we can open a workbook with NPOIFS, and write it out
 * again (via POIFS) and have it be valid
 * @throws IOException
 */
@Test public void writeWorkbookFromNPOIFS() throws IOException {
  InputStream is=HSSFTestDataSamples.openSampleFileStream("WithEmbeddedObjects.xls");
  try {
    NPOIFSFileSystem fs=new NPOIFSFileSystem(is);
    try {
      HSSFWorkbook wb=new HSSFWorkbook(fs.getRoot(),true);
      assertEquals(3,wb.getNumberOfSheets());
      assertEquals("Root xls",wb.getSheetAt(0).getRow(0).getCell(0).getStringCellValue());
      HSSFWorkbook wbBack=HSSFTestDataSamples.writeOutAndReadBack(wb);
      assertEquals(3,wbBack.getNumberOfSheets());
      assertEquals("Root xls",wbBack.getSheetAt(0).getRow(0).getCell(0).getStringCellValue());
      wbBack.close();
      wb.close();
    }
  finally {
      fs.close();
    }
  }
  finally {
    is.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that the storage clsid property is preserved
 */
@Test public void bug47920() throws IOException {
  POIFSFileSystem fs1=new POIFSFileSystem(POIDataSamples.getSpreadSheetInstance().openResourceAsStream("47920.xls"));
  HSSFWorkbook wb=new HSSFWorkbook(fs1);
  ClassID clsid1=fs1.getRoot().getStorageClsid();
  ByteArrayOutputStream out=new ByteArrayOutputStream(4096);
  wb.write(out);
  byte[] bytes=out.toByteArray();
  POIFSFileSystem fs2=new POIFSFileSystem(new ByteArrayInputStream(bytes));
  ClassID clsid2=fs2.getRoot().getStorageClsid();
  assertTrue(clsid1.equals(clsid2));
  fs2.close();
  wb.close();
  fs1.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to make sure that NameRecord.getSheetNumber() is interpreted as a
 * 1-based sheet tab index (not a 1-based extern sheet index)
 */
@Test public void findBuiltInNameRecord() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("testRRaC.xls");
  NameRecord nr;
  assertEquals(3,wb1.getWorkbook().getNumNames());
  nr=wb1.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!$A$1:$IV$1",HSSFFormulaParser.toFormulaString(wb1,nr.getNameDefinition()));
  try {
    wb1.getSheetAt(3).setRepeatingRows(CellRangeAddress.valueOf("9:12"));
    wb1.getSheetAt(3).setRepeatingColumns(CellRangeAddress.valueOf("E:F"));
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Builtin (7) already exists for sheet (4)")) {
      fail("Identified bug 45720b");
    }
    wb1.close();
    throw e;
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(3,wb2.getWorkbook().getNumNames());
  nr=wb2.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!E:F,Sheet2!$A$9:$IV$12",HSSFFormulaParser.toFormulaString(wb2,nr.getNameDefinition()));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestOLE2Embeding </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReallyEmbedSomething() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet sheet=wb1.createSheet();
  HSSFPatriarch patriarch=sheet.createDrawingPatriarch();
  byte[] pictureData=HSSFTestDataSamples.getTestDataFileContent("logoKarmokar4.png");
  byte[] picturePPT=POIDataSamples.getSlideShowInstance().readFile("clock.jpg");
  int imgIdx=wb1.addPicture(pictureData,HSSFWorkbook.PICTURE_TYPE_PNG);
  POIFSFileSystem pptPoifs=getSamplePPT();
  int pptIdx=wb1.addOlePackage(pptPoifs,"Sample-PPT","sample.ppt","sample.ppt");
  POIFSFileSystem xlsPoifs=getSampleXLS();
  int imgPPT=wb1.addPicture(picturePPT,HSSFWorkbook.PICTURE_TYPE_JPEG);
  int xlsIdx=wb1.addOlePackage(xlsPoifs,"Sample-XLS","sample.xls","sample.xls");
  int txtIdx=wb1.addOlePackage(getSampleTXT(),"Sample-TXT","sample.txt","sample.txt");
  int rowoffset=5;
  int coloffset=5;
  CreationHelper ch=wb1.getCreationHelper();
  HSSFClientAnchor anchor=(HSSFClientAnchor)ch.createClientAnchor();
  anchor.setAnchor((short)(2 + coloffset),1 + rowoffset,0,0,(short)(3 + coloffset),5 + rowoffset,0,0);
  anchor.setAnchorType(AnchorType.DONT_MOVE_AND_RESIZE);
  patriarch.createObjectData(anchor,pptIdx,imgPPT);
  anchor=(HSSFClientAnchor)ch.createClientAnchor();
  anchor.setAnchor((short)(5 + coloffset),1 + rowoffset,0,0,(short)(6 + coloffset),5 + rowoffset,0,0);
  anchor.setAnchorType(AnchorType.DONT_MOVE_AND_RESIZE);
  patriarch.createObjectData(anchor,xlsIdx,imgIdx);
  anchor=(HSSFClientAnchor)ch.createClientAnchor();
  anchor.setAnchor((short)(3 + coloffset),10 + rowoffset,0,0,(short)(5 + coloffset),11 + rowoffset,0,0);
  anchor.setAnchorType(AnchorType.DONT_MOVE_AND_RESIZE);
  patriarch.createObjectData(anchor,txtIdx,imgIdx);
  anchor=(HSSFClientAnchor)ch.createClientAnchor();
  anchor.setAnchor((short)(1 + coloffset),-2 + rowoffset,0,0,(short)(7 + coloffset),14 + rowoffset,0,0);
  anchor.setAnchorType(AnchorType.DONT_MOVE_AND_RESIZE);
  HSSFSimpleShape circle=patriarch.createSimpleShape(anchor);
  circle.setShapeType(HSSFSimpleShape.OBJECT_TYPE_OVAL);
  circle.setNoFill(true);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  HSSFObjectData od=wb2.getAllEmbeddedObjects().get(0);
  Ole10Native ole10=Ole10Native.createFromEmbeddedOleObject((DirectoryNode)od.getDirectory());
  bos.reset();
  pptPoifs.writeFilesystem(bos);
  assertArrayEquals(ole10.getDataBuffer(),bos.toByteArray());
  od=wb2.getAllEmbeddedObjects().get(1);
  ole10=Ole10Native.createFromEmbeddedOleObject((DirectoryNode)od.getDirectory());
  bos.reset();
  xlsPoifs.writeFilesystem(bos);
  assertArrayEquals(ole10.getDataBuffer(),bos.toByteArray());
  od=wb2.getAllEmbeddedObjects().get(2);
  ole10=Ole10Native.createFromEmbeddedOleObject((DirectoryNode)od.getDirectory());
  assertArrayEquals(ole10.getDataBuffer(),getSampleTXT());
  xlsPoifs.close();
  pptPoifs.close();
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestText </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResultEqualsToAbstractShape() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sh=wb.createSheet();
  HSSFPatriarch patriarch=sh.createDrawingPatriarch();
  HSSFTextbox textbox=patriarch.createTextbox(new HSSFClientAnchor());
  TextboxShape textboxShape=HSSFTestModelHelper.createTextboxShape(1025,textbox);
  assertEquals(textbox.getEscherContainer().getChildRecords().size(),5);
  assertEquals(textboxShape.getSpContainer().getChildRecords().size(),5);
  byte[] expected=textboxShape.getSpContainer().getChild(0).serialize();
  byte[] actual=textbox.getEscherContainer().getChild(0).serialize();
  assertEquals(expected.length,actual.length);
  assertArrayEquals(expected,actual);
  expected=textboxShape.getSpContainer().getChild(2).serialize();
  actual=textbox.getEscherContainer().getChild(2).serialize();
  assertEquals(expected.length,actual.length);
  assertArrayEquals(expected,actual);
  expected=textboxShape.getSpContainer().getChild(3).serialize();
  actual=textbox.getEscherContainer().getChild(3).serialize();
  assertEquals(expected.length,actual.length);
  assertArrayEquals(expected,actual);
  expected=textboxShape.getSpContainer().getChild(4).serialize();
  actual=textbox.getEscherContainer().getChild(4).serialize();
  assertEquals(expected.length,actual.length);
  assertArrayEquals(expected,actual);
  ObjRecord obj=textbox.getObjRecord();
  ObjRecord objShape=textboxShape.getObjRecord();
  expected=obj.serialize();
  actual=objShape.serialize();
  TextObjectRecord tor=textbox.getTextObjectRecord();
  TextObjectRecord torShape=textboxShape.getTextObjectRecord();
  expected=tor.serialize();
  actual=torShape.serialize();
  assertEquals(expected.length,actual.length);
  assertArrayEquals(expected,actual);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddTextToExistingFile() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet sh=wb1.createSheet();
  HSSFPatriarch patriarch=sh.createDrawingPatriarch();
  HSSFTextbox textbox=patriarch.createTextbox(new HSSFClientAnchor());
  textbox.setString(new HSSFRichTextString("just for test"));
  HSSFTextbox textbox2=patriarch.createTextbox(new HSSFClientAnchor());
  textbox2.setString(new HSSFRichTextString("just for test2"));
  assertEquals(patriarch.getChildren().size(),2);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sh=wb2.getSheetAt(0);
  patriarch=sh.getDrawingPatriarch();
  assertEquals(patriarch.getChildren().size(),2);
  HSSFTextbox text3=patriarch.createTextbox(new HSSFClientAnchor());
  text3.setString(new HSSFRichTextString("text3"));
  assertEquals(patriarch.getChildren().size(),3);
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sh=wb3.getSheetAt(0);
  patriarch=sh.getDrawingPatriarch();
  assertEquals(patriarch.getChildren().size(),3);
  assertEquals(((HSSFTextbox)patriarch.getChildren().get(0)).getString().getString(),"just for test");
  assertEquals(((HSSFTextbox)patriarch.getChildren().get(1)).getString().getString(),"just for test2");
  assertEquals(((HSSFTextbox)patriarch.getChildren().get(2)).getString().getString(),"text3");
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetGetProperties() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet sh=wb1.createSheet();
  HSSFPatriarch patriarch=sh.createDrawingPatriarch();
  HSSFTextbox textbox=patriarch.createTextbox(new HSSFClientAnchor());
  textbox.setString(new HSSFRichTextString("test"));
  assertEquals(textbox.getString().getString(),"test");
  textbox.setHorizontalAlignment((short)5);
  assertEquals(textbox.getHorizontalAlignment(),5);
  textbox.setVerticalAlignment((short)6);
  assertEquals(textbox.getVerticalAlignment(),(short)6);
  textbox.setMarginBottom(7);
  assertEquals(textbox.getMarginBottom(),7);
  textbox.setMarginLeft(8);
  assertEquals(textbox.getMarginLeft(),8);
  textbox.setMarginRight(9);
  assertEquals(textbox.getMarginRight(),9);
  textbox.setMarginTop(10);
  assertEquals(textbox.getMarginTop(),10);
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sh=wb2.getSheetAt(0);
  patriarch=sh.getDrawingPatriarch();
  textbox=(HSSFTextbox)patriarch.getChildren().get(0);
  assertEquals(textbox.getString().getString(),"test");
  assertEquals(textbox.getHorizontalAlignment(),5);
  assertEquals(textbox.getVerticalAlignment(),(short)6);
  assertEquals(textbox.getMarginBottom(),7);
  assertEquals(textbox.getMarginLeft(),8);
  assertEquals(textbox.getMarginRight(),9);
  assertEquals(textbox.getMarginTop(),10);
  textbox.setString(new HSSFRichTextString("test1"));
  textbox.setHorizontalAlignment(HSSFTextbox.HORIZONTAL_ALIGNMENT_CENTERED);
  textbox.setVerticalAlignment(HSSFTextbox.VERTICAL_ALIGNMENT_TOP);
  textbox.setMarginBottom(71);
  textbox.setMarginLeft(81);
  textbox.setMarginRight(91);
  textbox.setMarginTop(101);
  assertEquals(textbox.getString().getString(),"test1");
  assertEquals(textbox.getHorizontalAlignment(),HSSFTextbox.HORIZONTAL_ALIGNMENT_CENTERED);
  assertEquals(textbox.getVerticalAlignment(),HSSFTextbox.VERTICAL_ALIGNMENT_TOP);
  assertEquals(textbox.getMarginBottom(),71);
  assertEquals(textbox.getMarginLeft(),81);
  assertEquals(textbox.getMarginRight(),91);
  assertEquals(textbox.getMarginTop(),101);
  HSSFWorkbook wb3=HSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sh=wb3.getSheetAt(0);
  patriarch=sh.getDrawingPatriarch();
  textbox=(HSSFTextbox)patriarch.getChildren().get(0);
  assertEquals(textbox.getString().getString(),"test1");
  assertEquals(textbox.getHorizontalAlignment(),HSSFTextbox.HORIZONTAL_ALIGNMENT_CENTERED);
  assertEquals(textbox.getVerticalAlignment(),HSSFTextbox.VERTICAL_ALIGNMENT_TOP);
  assertEquals(textbox.getMarginBottom(),71);
  assertEquals(textbox.getMarginLeft(),81);
  assertEquals(textbox.getMarginRight(),91);
  assertEquals(textbox.getMarginTop(),101);
  wb3.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hwpf.usermodel.TestPictures </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void testCroppedPictures(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("testCroppedPictures.doc");
  List<Picture> pics=doc.getPicturesTable().getAllPictures();
  assertNotNull(pics);
  assertEquals(2,pics.size());
  Picture pic1=pics.get(0);
  assertEquals(27,pic1.getAspectRatioX());
  assertEquals(270,pic1.getHorizontalScalingFactor());
  assertEquals(27,pic1.getAspectRatioY());
  assertEquals(271,pic1.getVerticalScalingFactor());
  assertEquals(12000,pic1.getDxaGoal());
  assertEquals(9000,pic1.getDyaGoal());
  assertEquals(0,pic1.getDxaCropLeft());
  assertEquals(0,pic1.getDxaCropRight());
  assertEquals(0,pic1.getDyaCropTop());
  assertEquals(0,pic1.getDyaCropBottom());
  Picture pic2=pics.get(1);
  System.out.println(pic2.getWidth());
  assertEquals(76,pic2.getAspectRatioX());
  assertEquals(764,pic2.getHorizontalScalingFactor());
  assertEquals(68,pic2.getAspectRatioY());
  assertEquals(685,pic2.getVerticalScalingFactor());
  assertEquals(12000,pic2.getDxaGoal());
  assertEquals(9000,pic2.getDyaGoal());
  assertEquals(0,pic2.getDxaCropLeft());
  assertEquals(0,pic2.getDxaCropRight());
  assertEquals(0,pic2.getDyaCropTop());
  assertEquals(0,pic2.getDyaCropBottom());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquation(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("equation.doc");
  PicturesTable pictures=doc.getPicturesTable();
  final List<Picture> allPictures=pictures.getAllPictures();
  assertEquals(1,allPictures.size());
  Picture picture=allPictures.get(0);
  assertNotNull(picture);
  assertEquals(PictureType.EMF,picture.suggestPictureType());
  assertEquals(PictureType.EMF.getExtension(),picture.suggestFileExtension());
  assertEquals(PictureType.EMF.getMime(),picture.getMimeType());
  assertEquals("0.emf",picture.suggestFullFileName());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * emf image, nice and simple
 */
@Test public void testEmfImage(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("vector_image.doc");
  List<Picture> pics=doc.getPicturesTable().getAllPictures();
  assertNotNull(pics);
  assertEquals(1,pics.size());
  Picture pic=pics.get(0);
  assertNotNull(pic.suggestFileExtension());
  assertNotNull(pic.suggestFullFileName());
  assertTrue(pic.getSize() > 128);
  byte[] emf=POIDataSamples.getDocumentInstance().readFile("vector_image.emf");
  byte[] pemf=pic.getContent();
  assertEquals(emf.length,pemf.length);
  for (int i=0; i < emf.length; i++) {
    assertEquals(emf[i],pemf[i]);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * When you embed another office document into Word, it stores
 * a rendered "icon" picture of what that document looks like.
 * This image is re-created when you edit the embeded document,
 * then used as-is to speed things up.
 * Check that we can properly read one of these
 */
@Test public void testEmbededDocumentIcon(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("word_with_embeded.doc");
  doc.getPicturesTable().getAllPictures();
  PicturesTable pictureTable=doc.getPicturesTable();
  Paragraph p;
  Range r=doc.getRange();
  assertEquals(1,r.numSections());
  assertEquals(5,r.numParagraphs());
  p=r.getParagraph(0);
  assertEquals(2,p.numCharacterRuns());
  assertEquals("I have lots of embedded files in me\r",p.text());
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(0)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(1)));
  p=r.getParagraph(1);
  assertEquals(5,p.numCharacterRuns());
  assertEquals("\u0013 EMBED Excel.Sheet.8  \u0014\u0001\u0015\r",p.text());
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(0)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(1)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(2)));
  assertEquals(true,pictureTable.hasPicture(p.getCharacterRun(3)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(4)));
  p=r.getParagraph(2);
  assertEquals(6,p.numCharacterRuns());
  assertEquals("\u0013 EMBED Excel.Sheet.8  \u0014\u0001\u0015\r",p.text());
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(0)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(1)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(2)));
  assertEquals(true,pictureTable.hasPicture(p.getCharacterRun(3)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(4)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(5)));
  p=r.getParagraph(3);
  assertEquals(6,p.numCharacterRuns());
  assertEquals("\u0013 EMBED PowerPoint.Show.8  \u0014\u0001\u0015\r",p.text());
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(0)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(1)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(2)));
  assertEquals(true,pictureTable.hasPicture(p.getCharacterRun(3)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(4)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(5)));
  p=r.getParagraph(4);
  assertEquals(6,p.numCharacterRuns());
  assertEquals("\u0013 EMBED Word.Document.8 \\s \u0014\u0001\u0015\r",p.text());
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(0)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(1)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(2)));
  assertEquals(true,pictureTable.hasPicture(p.getCharacterRun(3)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(4)));
  assertEquals(false,pictureTable.hasPicture(p.getCharacterRun(5)));
  List<Picture> pictures=pictureTable.getAllPictures();
  assertEquals(4,pictures.size());
  Picture picture=pictures.get(0);
  assertEquals("emf",picture.suggestFileExtension());
  assertEquals("0.emf",picture.suggestFullFileName());
  assertEquals("image/x-emf",picture.getMimeType());
  picture=pictures.get(1);
  assertEquals("emf",picture.suggestFileExtension());
  assertEquals("469.emf",picture.suggestFullFileName());
  assertEquals("image/x-emf",picture.getMimeType());
  picture=pictures.get(2);
  assertEquals("emf",picture.suggestFileExtension());
  assertEquals("8c7.emf",picture.suggestFullFileName());
  assertEquals("image/x-emf",picture.getMimeType());
  picture=pictures.get(3);
  assertEquals("emf",picture.suggestFileExtension());
  assertEquals("10a8.emf",picture.suggestFullFileName());
  assertEquals("image/x-emf",picture.getMimeType());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * two jpegs
 */
@Test public void testTwoImages(){
  HWPFDocument doc=HWPFTestDataSamples.openSampleFile("two_images.doc");
  List<Picture> pics=doc.getPicturesTable().getAllPictures();
  assertNotNull(pics);
  assertEquals(pics.size(),2);
  for (int i=0; i < pics.size(); i++) {
    Picture pic=pics.get(i);
    assertNotNull(pic.suggestFileExtension());
    assertNotNull(pic.suggestFullFileName());
  }
  Picture picA=pics.get(0);
  Picture picB=pics.get(1);
  assertEquals("jpg",picA.suggestFileExtension());
  assertEquals("png",picB.suggestFileExtension());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestFileHelper </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * TODO - use simple JDK methods on {@link File} instead:<br/>{@link File#getParentFile()} instead of {@link FileHelper#getDirectory(File)}{{@link File#getName()} instead of {@link FileHelper#getFilename(File)}
 */
@Test public void testGetDirectory(){
  TreeMap<String,String> expectedValue=new TreeMap<String,String>();
  expectedValue.put("/dir1/test.doc","/dir1");
  expectedValue.put("/dir1/dir2/test.doc.xml","/dir1/dir2");
  for (  String filename : expectedValue.keySet()) {
    File f1=new File(expectedValue.get(filename));
    File f2=FileHelper.getDirectory(new File(filename));
    assertTrue(f1.equals(f2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestPackage </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that when we create a new Package, we give it
 * the correct default content types
 * @throws IllegalAccessException 
 * @throws NoSuchFieldException 
 * @throws IllegalArgumentException 
 * @throws SecurityException 
 */
@Test public void createGetsContentTypes() throws IOException, InvalidFormatException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException {
  File targetFile=OpenXML4JTestDataSamples.getOutputFile("TestCreatePackageTMP.docx");
  if (targetFile.exists())   targetFile.delete();
  @SuppressWarnings("resource") OPCPackage pkg=OPCPackage.create(targetFile);
  ContentTypeManager ctm=getContentTypeManager(pkg);
  assertEquals("application/xml",ctm.getContentType(PackagingURIHelper.createPartName("/foo.xml")));
  assertEquals(ContentTypes.RELATIONSHIPS_PART,ctm.getContentType(PackagingURIHelper.createPartName("/foo.rels")));
  assertNull(ctm.getContentType(PackagingURIHelper.createPartName("/foo.txt")));
  pkg.revert();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void replaceContentType() throws IOException, InvalidFormatException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException {
  InputStream is=OpenXML4JTestDataSamples.openSampleStream("sample.xlsx");
  @SuppressWarnings("resource") OPCPackage p=OPCPackage.open(is);
  ContentTypeManager mgr=getContentTypeManager(p);
  assertTrue(mgr.isContentTypeRegister("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"));
  assertFalse(mgr.isContentTypeRegister("application/vnd.ms-excel.sheet.macroEnabled.main+xml"));
  assertTrue(p.replaceContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml","application/vnd.ms-excel.sheet.macroEnabled.main+xml"));
  assertFalse(mgr.isContentTypeRegister("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"));
  assertTrue(mgr.isContentTypeRegister("application/vnd.ms-excel.sheet.macroEnabled.main+xml"));
  p.revert();
  is.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can create a new package, add a core
 * document and another part, save and re-load and
 * have everything setup as expected
 * @throws SAXException 
 */
@Test public void createPackageWithCoreDocument() throws IOException, InvalidFormatException, URISyntaxException, SAXException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  OPCPackage pkg=OPCPackage.create(baos);
  PackagePartName corePartName=PackagingURIHelper.createPartName("/xl/workbook.xml");
  pkg.addRelationship(corePartName,TargetMode.INTERNAL,PackageRelationshipTypes.CORE_DOCUMENT,"rId1");
  PackagePart corePart=pkg.createPart(corePartName,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml");
  OutputStream coreOut=corePart.getOutputStream();
  coreOut.write("<dummy-xml />".getBytes("UTF-8"));
  coreOut.close();
  PackagePartName sheetPartName=PackagingURIHelper.createPartName("/xl/worksheets/sheet1.xml");
  PackageRelationship rel=corePart.addRelationship(sheetPartName,TargetMode.INTERNAL,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","rSheet1");
  PackagePart part=pkg.createPart(sheetPartName,"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml");
  assertNotNull(part);
  coreOut=corePart.getOutputStream();
  coreOut.write("<dummy-xml2 />".getBytes("UTF-8"));
  coreOut.close();
  corePart.addRelationship(new URI("#Sheet1!A1"),TargetMode.INTERNAL,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink","rId2");
  PackageRelationshipCollection coreRels=pkg.getRelationshipsByType(PackageRelationshipTypes.CORE_DOCUMENT);
  assertEquals(1,coreRels.size());
  PackageRelationship coreRel=coreRels.getRelationship(0);
  assertEquals("/",coreRel.getSourceURI().toString());
  assertEquals("/xl/workbook.xml",coreRel.getTargetURI().toString());
  assertNotNull(pkg.getPart(coreRel));
  pkg.close();
  File tmp=TempFile.createTempFile("testCreatePackageWithCoreDocument",".zip");
  OutputStream fout=new FileOutputStream(tmp);
  try {
    fout.write(baos.toByteArray());
  }
  finally {
    fout.close();
  }
  pkg=OPCPackage.open(tmp.getPath());
  try {
    coreRels=pkg.getRelationshipsByType(PackageRelationshipTypes.CORE_DOCUMENT);
    assertEquals(1,coreRels.size());
    coreRel=coreRels.getRelationship(0);
    assertEquals("/",coreRel.getSourceURI().toString());
    assertEquals("/xl/workbook.xml",coreRel.getTargetURI().toString());
    corePart=pkg.getPart(coreRel);
    assertNotNull(corePart);
    PackageRelationshipCollection rels=corePart.getRelationshipsByType("http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink");
    assertEquals(1,rels.size());
    rel=rels.getRelationship(0);
    assertEquals("Sheet1!A1",rel.getTargetURI().getRawFragment());
    assertMSCompatibility(pkg);
  }
  finally {
    pkg.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Checks that we can open+read a package from a
 * simple InputStream, in addition to the normal
 * reading from a file
 */
@Test public void openFromInputStream() throws IOException, InvalidFormatException {
  String originalFile=OpenXML4JTestDataSamples.getSampleFileName("TestPackageCommon.docx");
  FileInputStream finp=new FileInputStream(originalFile);
  @SuppressWarnings("resource") OPCPackage p=OPCPackage.open(finp);
  assertNotNull(p);
  assertNotNull(p.getRelationships());
  assertEquals(12,p.getParts().size());
  assertTrue(p.hasRelationships());
  assertTrue(p.containPart(PackagingURIHelper.createPartName("/_rels/.rels")));
  p.revert();
  finp.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestPackageCoreProperties </h4><pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testListOfCustomProperties() throws Exception {
  File inp=POIDataSamples.getSpreadSheetInstance().getFile("ExcelWithAttachments.xlsm");
  OPCPackage pkg=OPCPackage.open(inp,PackageAccess.READ);
  XSSFWorkbook wb=new XSSFWorkbook(pkg);
  assertNotNull(wb.getProperties());
  assertNotNull(wb.getProperties().getCustomProperties());
  for (  CTProperty prop : wb.getProperties().getCustomProperties().getUnderlyingProperties().getPropertyList()) {
    assertNotNull(prop);
  }
  wb.close();
  pkg.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEntitiesInCoreProps_56164() throws Exception {
  InputStream is=OpenXML4JTestDataSamples.openSampleStream("CorePropertiesHasEntities.ooxml");
  OPCPackage p=OPCPackage.open(is);
  is.close();
  boolean foundDocRel=false, foundCorePropRel=false, foundExtPropRel=false;
  for (  PackageRelationship pr : p.getRelationships()) {
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.CORE_DOCUMENT))     foundDocRel=true;
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.CORE_PROPERTIES))     foundCorePropRel=true;
    if (pr.getRelationshipType().equals(PackageRelationshipTypes.EXTENDED_PROPERTIES))     foundExtPropRel=true;
  }
  assertTrue("Core/Doc Relationship not found in " + p.getRelationships(),foundDocRel);
  assertTrue("Core Props Relationship not found in " + p.getRelationships(),foundCorePropRel);
  assertTrue("Ext Props Relationship not found in " + p.getRelationships(),foundExtPropRel);
  PackagePropertiesPart props=(PackagePropertiesPart)p.getPackageProperties();
  assertEquals("Stefan Kopf",props.getCreatorProperty().getValue());
  p.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoreProperties_bug51374() throws Exception {
  SimpleDateFormat df=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'",Locale.ROOT);
  df.setTimeZone(LocaleUtil.TIMEZONE_UTC);
  String strDate="2007-05-12T08:00:00Z";
  Date date=df.parse(strDate);
  OPCPackage pkg=new ZipPackage();
  PackagePropertiesPart props=(PackagePropertiesPart)pkg.getPackageProperties();
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty((String)null);
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty(new Nullable<Date>());
  assertEquals("",props.getCreatedPropertyString());
  assertNull(props.getCreatedProperty().getValue());
  props.setCreatedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getCreatedPropertyString());
  assertEquals(date,props.getCreatedProperty().getValue());
  props.setCreatedProperty(strDate);
  assertEquals(strDate,props.getCreatedPropertyString());
  assertEquals(date,props.getCreatedProperty().getValue());
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty((String)null);
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(new Nullable<Date>());
  assertEquals("",props.getLastPrintedPropertyString());
  assertNull(props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getLastPrintedPropertyString());
  assertEquals(date,props.getLastPrintedProperty().getValue());
  props.setLastPrintedProperty(strDate);
  assertEquals(strDate,props.getLastPrintedPropertyString());
  assertEquals(date,props.getLastPrintedProperty().getValue());
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty((String)null);
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty(new Nullable<Date>());
  assertNull(props.getModifiedProperty().getValue());
  props.setModifiedProperty(new Nullable<Date>(date));
  assertEquals(strDate,props.getModifiedPropertyString());
  assertEquals(date,props.getModifiedProperty().getValue());
  props.setModifiedProperty(strDate);
  assertEquals(strDate,props.getModifiedPropertyString());
  assertEquals(date,props.getModifiedProperty().getValue());
  pkg.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestZipPackage </h4><pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56479() throws Exception {
  InputStream is=OpenXML4JTestDataSamples.openSampleStream("dcterms_bug_56479.zip");
  OPCPackage p=OPCPackage.open(is);
  boolean foundCoreProps=false, foundDocument=false, foundTheme1=false;
  for (  PackagePart part : p.getParts()) {
    if (part.getPartName().toString().equals("/docProps/core.xml")) {
      assertEquals(ContentTypes.CORE_PROPERTIES_PART,part.getContentType());
      foundCoreProps=true;
    }
    if (part.getPartName().toString().equals("/word/document.xml")) {
      assertEquals(XWPFRelation.DOCUMENT.getContentType(),part.getContentType());
      foundDocument=true;
    }
    if (part.getPartName().toString().equals("/word/theme/theme1.xml")) {
      assertEquals(XWPFRelation.THEME.getContentType(),part.getContentType());
      foundTheme1=true;
    }
  }
  assertTrue("Core not found in " + p.getParts(),foundCoreProps);
  assertFalse("Document should not be found in " + p.getParts(),foundDocument);
  assertFalse("Theme1 should not found in " + p.getParts(),foundTheme1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.osgi.TestOSGiBundle </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHSSF() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet("OSGi");
  s.createRow(0).createCell(0).setCellValue("With OSGi");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  wb.write(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  wb=new HSSFWorkbook(bais);
  assertEquals(1,wb.getNumberOfSheets());
  s=wb.getSheet("OSGi");
  assertEquals("With OSGi",s.getRow(0).getCell(0).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestAgileEncryptionParameters </h4><pre class="type-2 type-1 type-3 type-17 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAgileEncryptionModes() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength(ca.jceId);
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files",maxKeyLen >= ca.defaultKeySize);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  POIFSFileSystem fsEnc=new POIFSFileSystem();
  EncryptionInfo infoEnc=new EncryptionInfo(EncryptionMode.agile,ca,ha,-1,-1,cm);
  Encryptor enc=infoEnc.getEncryptor();
  enc.confirmPassword("foobaa");
  OutputStream os=enc.getDataStream(fsEnc);
  os.write(testData);
  os.close();
  bos.reset();
  fsEnc.writeFilesystem(bos);
  POIFSFileSystem fsDec=new POIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  EncryptionInfo infoDec=new EncryptionInfo(fsDec);
  Decryptor dec=infoDec.getDecryptor();
  boolean passed=dec.verifyPassword("foobaa");
  assertTrue(passed);
  InputStream is=dec.getDataStream(fsDec);
  byte actualData[]=IOUtils.toByteArray(is);
  is.close();
  assertThat("Failed roundtrip - " + ca + "-"+ ha+ "-"+ cm,testData,equalTo(actualData));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestCertificateEncryption </h4><pre class="type-2 type-1 type-3 type-13 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies logic rules using matcher-style statements
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCertificateEncryption() throws Exception {
  POIFSFileSystem fs=new POIFSFileSystem();
  EncryptionInfo info=new EncryptionInfo(fs,EncryptionMode.agile,CipherAlgorithm.aes128,HashAlgorithm.sha1,-1,-1,ChainingMode.cbc);
  AgileEncryptionVerifier aev=(AgileEncryptionVerifier)info.getVerifier();
  CertData certData=loadKeystore();
  aev.addCertificate(certData.x509);
  Encryptor enc=info.getEncryptor();
  enc.confirmPassword("foobaa");
  File file=POIDataSamples.getDocumentInstance().getFile("VariousPictures.docx");
  InputStream fis=new FileInputStream(file);
  byte byteExpected[]=IOUtils.toByteArray(fis);
  fis.close();
  OutputStream os=enc.getDataStream(fs);
  IOUtils.copy(new ByteArrayInputStream(byteExpected),os);
  os.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  fs.writeFilesystem(bos);
  bos.close();
  fs=new POIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  info=new EncryptionInfo(fs);
  AgileDecryptor agDec=(AgileDecryptor)info.getDecryptor();
  boolean passed=agDec.verifyPassword(certData.keypair,certData.x509);
  assertTrue("certificate verification failed",passed);
  fis=agDec.getDataStream(fs);
  byte byteActual[]=IOUtils.toByteArray(fis);
  fis.close();
  assertThat(byteExpected,equalTo(byteActual));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestDecryptor </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug57080() throws Exception {
  File f=POIDataSamples.getPOIFSInstance().getFile("extenxls_pwd123.xlsx");
  NPOIFSFileSystem fs=new NPOIFSFileSystem(f,true);
  EncryptionInfo info=new EncryptionInfo(fs);
  Decryptor d=Decryptor.getInstance(info);
  d.verifyPassword("pwd123");
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ZipInputStream zis=new ZipInputStream(d.getDataStream(fs));
  ZipEntry ze;
  while ((ze=zis.getNextEntry()) != null) {
    bos.reset();
    IOUtils.copy(zis,bos);
    assertEquals(ze.getSize(),bos.size());
  }
  zis.close();
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void passwordVerification() throws IOException, GeneralSecurityException {
  POIFSFileSystem fs=new POIFSFileSystem(POIDataSamples.getPOIFSInstance().openResourceAsStream("protect.xlsx"));
  EncryptionInfo info=new EncryptionInfo(fs);
  Decryptor d=Decryptor.getInstance(info);
  assertTrue(d.verifyPassword(Decryptor.DEFAULT_PASSWORD));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dataLength() throws Exception {
  POIFSFileSystem fs=new POIFSFileSystem(POIDataSamples.getPOIFSInstance().openResourceAsStream("protected_agile.docx"));
  EncryptionInfo info=new EncryptionInfo(fs);
  Decryptor d=Decryptor.getInstance(info);
  d.verifyPassword(Decryptor.DEFAULT_PASSWORD);
  InputStream is=d.getDataStream(fs);
  long len=d.getLength();
  assertEquals(12810,len);
  byte[] buf=new byte[(int)len];
  is.read(buf);
  ZipInputStream zin=new ZipInputStream(new ByteArrayInputStream(buf));
  while (true) {
    ZipEntry entry=zin.getNextEntry();
    if (entry == null) {
      break;
    }
    while (zin.available() > 0) {
      zin.skip(zin.available());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void agile() throws IOException, GeneralSecurityException {
  POIFSFileSystem fs=new POIFSFileSystem(POIDataSamples.getPOIFSInstance().openResourceAsStream("protected_agile.docx"));
  EncryptionInfo info=new EncryptionInfo(fs);
  assertTrue(info.getVersionMajor() == 4 && info.getVersionMinor() == 4);
  Decryptor d=Decryptor.getInstance(info);
  assertTrue(d.verifyPassword(Decryptor.DEFAULT_PASSWORD));
  zipOk(fs.getRoot(),d);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestEncryptor </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void binaryRC4Encryption() throws Exception {
  String password="pass";
  InputStream is=POIDataSamples.getSpreadSheetInstance().openResourceAsStream("SimpleMultiCell.xlsx");
  ByteArrayOutputStream payloadExpected=new ByteArrayOutputStream();
  IOUtils.copy(is,payloadExpected);
  is.close();
  POIFSFileSystem fs=new POIFSFileSystem();
  EncryptionInfo ei=new EncryptionInfo(EncryptionMode.binaryRC4);
  Encryptor enc=ei.getEncryptor();
  enc.confirmPassword(password);
  OutputStream os=enc.getDataStream(fs.getRoot());
  payloadExpected.writeTo(os);
  os.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  fs.writeFilesystem(bos);
  fs=new POIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  ei=new EncryptionInfo(fs);
  Decryptor dec=ei.getDecryptor();
  boolean b=dec.verifyPassword(password);
  assertTrue(b);
  ByteArrayOutputStream payloadActual=new ByteArrayOutputStream();
  is=dec.getDataStream(fs.getRoot());
  IOUtils.copy(is,payloadActual);
  is.close();
  assertArrayEquals(payloadExpected.toByteArray(),payloadActual.toByteArray());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void standardEncryption() throws Exception {
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-solrcell.docx");
  String pass="solrcell";
  NPOIFSFileSystem nfs=new NPOIFSFileSystem(file);
  EncryptionInfo infoExpected=new EncryptionInfo(nfs);
  Decryptor d=Decryptor.getInstance(infoExpected);
  boolean passed=d.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  InputStream is=d.getDataStream(nfs);
  IOUtils.copy(is,bos);
  is.close();
  nfs.close();
  byte payloadExpected[]=bos.toByteArray();
  byte verifierSaltExpected[]=infoExpected.getVerifier().getSalt();
  byte verifierExpected[]=d.getVerifier();
  byte keySpec[]=d.getSecretKey().getEncoded();
  byte keySalt[]=infoExpected.getHeader().getKeySalt();
  POIFSFileSystem fs=new POIFSFileSystem();
  EncryptionInfo infoActual=new EncryptionInfo(EncryptionMode.standard,infoExpected.getVerifier().getCipherAlgorithm(),infoExpected.getVerifier().getHashAlgorithm(),infoExpected.getHeader().getKeySize(),infoExpected.getHeader().getBlockSize(),infoExpected.getVerifier().getChainingMode());
  Encryptor e=Encryptor.getInstance(infoActual);
  e.confirmPassword(pass,keySpec,keySalt,verifierExpected,verifierSaltExpected,null);
  assertArrayEquals(infoExpected.getVerifier().getEncryptedVerifier(),infoActual.getVerifier().getEncryptedVerifier());
  assertArrayEquals(infoExpected.getVerifier().getEncryptedVerifierHash(),infoActual.getVerifier().getEncryptedVerifierHash());
  fs=new POIFSFileSystem();
  infoActual=new EncryptionInfo(EncryptionMode.standard,infoExpected.getVerifier().getCipherAlgorithm(),infoExpected.getVerifier().getHashAlgorithm(),infoExpected.getHeader().getKeySize(),infoExpected.getHeader().getBlockSize(),infoExpected.getVerifier().getChainingMode());
  e=Encryptor.getInstance(infoActual);
  e.confirmPassword(pass);
  OutputStream os=e.getDataStream(fs);
  IOUtils.copy(new ByteArrayInputStream(payloadExpected),os);
  os.close();
  bos.reset();
  fs.writeFilesystem(bos);
  ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
  nfs=new NPOIFSFileSystem(bis);
  infoExpected=new EncryptionInfo(nfs);
  d=Decryptor.getInstance(infoExpected);
  passed=d.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  bos.reset();
  is=d.getDataStream(nfs);
  IOUtils.copy(is,bos);
  is.close();
  nfs.close();
  byte payloadActual[]=bos.toByteArray();
  assertArrayEquals(payloadExpected,payloadActual);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure we can encrypt a package that is missing the Core
 * Properties, eg one from dodgy versions of Jasper Reports 
 * See https://github.com/nestoru/xlsxenc/ and
 * http://stackoverflow.com/questions/28593223
 */
@Test public void encryptPackageWithoutCoreProperties() throws Exception {
  File inp=POIDataSamples.getOpenXML4JInstance().getFile("OPCCompliance_NoCoreProperties.xlsx");
  OPCPackage pkg=OPCPackage.open(inp.getPath());
  assertEquals(0,pkg.getPartsByContentType(ContentTypes.CORE_PROPERTIES_PART).size());
  assertNotNull(pkg.getPackageProperties());
  assertNotNull(pkg.getPackageProperties().getLanguageProperty());
  assertNull(pkg.getPackageProperties().getLanguageProperty().getValue());
  EncryptionInfo info=new EncryptionInfo(EncryptionMode.agile);
  NPOIFSFileSystem fs=new NPOIFSFileSystem();
  Encryptor enc=info.getEncryptor();
  enc.confirmPassword("password");
  OutputStream os=enc.getDataStream(fs);
  pkg.save(os);
  pkg.revert();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  fs.writeFilesystem(baos);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  NPOIFSFileSystem inpFS=new NPOIFSFileSystem(bais);
  info=new EncryptionInfo(inpFS);
  Decryptor d=Decryptor.getInstance(info);
  assertEquals(true,d.verifyPassword("password"));
  OPCPackage inpPkg=OPCPackage.open(d.getDataStream(inpFS));
  assertEquals(1,inpPkg.getPartsByContentType(ContentTypes.CORE_PROPERTIES_PART).size());
  assertNotNull(inpPkg.getPackageProperties());
  assertNotNull(inpPkg.getPackageProperties().getLanguageProperty());
  assertNull(inpPkg.getPackageProperties().getLanguageProperty().getValue());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void agileEncryption() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength("AES");
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files for AES 256",maxKeyLen == 2147483647);
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-pass.docx");
  String pass="pass";
  NPOIFSFileSystem nfs=new NPOIFSFileSystem(file);
  EncryptionInfo infoExpected=new EncryptionInfo(nfs);
  Decryptor decExpected=Decryptor.getInstance(infoExpected);
  boolean passed=decExpected.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  InputStream is=decExpected.getDataStream(nfs);
  byte payloadExpected[]=IOUtils.toByteArray(is);
  is.close();
  long decPackLenExpected=decExpected.getLength();
  assertEquals(decPackLenExpected,payloadExpected.length);
  is=nfs.getRoot().createDocumentInputStream(Decryptor.DEFAULT_POIFS_ENTRY);
  is=new BoundedInputStream(is,is.available() - 16);
  byte encPackExpected[]=IOUtils.toByteArray(is);
  is.close();
  nfs.close();
  byte verifierSaltExpected[]=infoExpected.getVerifier().getSalt();
  byte verifierExpected[]=decExpected.getVerifier();
  byte keySalt[]=infoExpected.getHeader().getKeySalt();
  byte keySpec[]=decExpected.getSecretKey().getEncoded();
  byte integritySalt[]=decExpected.getIntegrityHmacKey();
  POIFSFileSystem fs=new POIFSFileSystem();
  EncryptionInfo infoActual=new EncryptionInfo(EncryptionMode.agile,infoExpected.getVerifier().getCipherAlgorithm(),infoExpected.getVerifier().getHashAlgorithm(),infoExpected.getHeader().getKeySize(),infoExpected.getHeader().getBlockSize(),infoExpected.getVerifier().getChainingMode());
  Encryptor e=Encryptor.getInstance(infoActual);
  e.confirmPassword(pass,keySpec,keySalt,verifierExpected,verifierSaltExpected,integritySalt);
  OutputStream os=e.getDataStream(fs);
  IOUtils.copy(new ByteArrayInputStream(payloadExpected),os);
  os.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  fs.writeFilesystem(bos);
  nfs=new NPOIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  infoActual=new EncryptionInfo(nfs.getRoot());
  Decryptor decActual=Decryptor.getInstance(infoActual);
  passed=decActual.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  is=decActual.getDataStream(nfs);
  byte payloadActual[]=IOUtils.toByteArray(is);
  is.close();
  long decPackLenActual=decActual.getLength();
  is=nfs.getRoot().createDocumentInputStream(Decryptor.DEFAULT_POIFS_ENTRY);
  is=new BoundedInputStream(is,is.available() - 16);
  byte encPackActual[]=IOUtils.toByteArray(is);
  is.close();
  nfs.close();
  AgileEncryptionHeader aehExpected=(AgileEncryptionHeader)infoExpected.getHeader();
  AgileEncryptionHeader aehActual=(AgileEncryptionHeader)infoActual.getHeader();
  assertArrayEquals(aehExpected.getEncryptedHmacKey(),aehActual.getEncryptedHmacKey());
  assertEquals(decPackLenExpected,decPackLenActual);
  assertArrayEquals(payloadExpected,payloadActual);
  assertArrayEquals(encPackExpected,encPackActual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestSignatureInfo </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignEnvelopingDocument() throws Exception {
  String testFile="hello-world-unsigned.xlsx";
  OPCPackage pkg=OPCPackage.open(copy(testdata.getFile(testFile)),PackageAccess.READ_WRITE);
  initKeyPair("Test","CN=Test");
  final X509CRL crl=PkiTestUtils.generateCrl(x509,keyPair.getPrivate());
  SignatureConfig signatureConfig=new SignatureConfig();
  signatureConfig.setOpcPackage(pkg);
  signatureConfig.setKey(keyPair.getPrivate());
  List<X509Certificate> certificateChain=new ArrayList<X509Certificate>();
  certificateChain.add(x509);
  certificateChain.add(x509);
  signatureConfig.setSigningCertificateChain(certificateChain);
  signatureConfig.addSignatureFacet(new EnvelopedSignatureFacet());
  signatureConfig.addSignatureFacet(new KeyInfoSignatureFacet());
  signatureConfig.addSignatureFacet(new XAdESSignatureFacet());
  signatureConfig.addSignatureFacet(new XAdESXLSignatureFacet());
  boolean mockTsp=(getAccessError("http://timestamp.comodoca.com/rfc3161",true,10000) != null);
  signatureConfig.setTspUrl("http://timestamp.comodoca.com/rfc3161");
  signatureConfig.setTspRequestPolicy(null);
  signatureConfig.setTspOldProtocol(false);
  String proxy=System.getProperty("http_proxy");
  if (proxy != null && proxy.trim().length() > 0) {
    signatureConfig.setProxyUrl(proxy);
  }
  if (mockTsp) {
    TimeStampService tspService=new TimeStampService(){
      @Override public byte[] timeStamp(      byte[] data,      RevocationData revocationData) throws Exception {
        revocationData.addCRL(crl);
        return "time-stamp-token".getBytes(LocaleUtil.CHARSET_1252);
      }
      @Override public void setSignatureConfig(      SignatureConfig config){
      }
    }
;
    signatureConfig.setTspService(tspService);
  }
 else {
    TimeStampServiceValidator tspValidator=new TimeStampServiceValidator(){
      @Override public void validate(      List<X509Certificate> validateChain,      RevocationData revocationData) throws Exception {
        for (        X509Certificate certificate : validateChain) {
          LOG.log(POILogger.DEBUG,"certificate: " + certificate.getSubjectX500Principal());
          LOG.log(POILogger.DEBUG,"validity: " + certificate.getNotBefore() + " - "+ certificate.getNotAfter());
        }
      }
    }
;
    signatureConfig.setTspValidator(tspValidator);
    signatureConfig.setTspOldProtocol(signatureConfig.getTspUrl().contains("edelweb"));
  }
  final RevocationData revocationData=new RevocationData();
  revocationData.addCRL(crl);
  OCSPResp ocspResp=PkiTestUtils.createOcspResp(x509,false,x509,x509,keyPair.getPrivate(),"SHA1withRSA",cal.getTimeInMillis());
  revocationData.addOCSP(ocspResp.getEncoded());
  RevocationDataService revocationDataService=new RevocationDataService(){
    @Override public RevocationData getRevocationData(    List<X509Certificate> revocationChain){
      return revocationData;
    }
  }
;
  signatureConfig.setRevocationDataService(revocationDataService);
  SignatureInfo si=new SignatureInfo();
  si.setSignatureConfig(signatureConfig);
  try {
    si.confirmSignature();
  }
 catch (  RuntimeException e) {
    pkg.close();
    if (e.getCause() == null) {
      throw e;
    }
    if (!(e.getCause() instanceof ConnectException)) {
      throw e;
    }
    assertTrue("Only allowing ConnectException with 'timed out' as message here, but had: " + e,e.getCause().getMessage().contains("timed out"));
  }
  Iterator<SignaturePart> spIter=si.getSignatureParts().iterator();
  assertTrue(spIter.hasNext());
  SignaturePart sp=spIter.next();
  boolean valid=sp.validate();
  assertTrue(valid);
  SignatureDocument sigDoc=sp.getSignatureDocument();
  String declareNS="declare namespace xades='http://uri.etsi.org/01903/v1.3.2#'; " + "declare namespace ds='http://www.w3.org/2000/09/xmldsig#'; ";
  String digestValXQuery=declareNS + "$this/ds:Signature/ds:SignedInfo/ds:Reference";
  for (  ReferenceType rt : (ReferenceType[])sigDoc.selectPath(digestValXQuery)) {
    assertNotNull(rt.getDigestValue());
    assertEquals(signatureConfig.getDigestMethodUri(),rt.getDigestMethod().getAlgorithm());
  }
  String certDigestXQuery=declareNS + "$this//xades:SigningCertificate/xades:Cert/xades:CertDigest";
  XmlObject xoList[]=sigDoc.selectPath(certDigestXQuery);
  assertEquals(xoList.length,1);
  DigestAlgAndValueType certDigest=(DigestAlgAndValueType)xoList[0];
  assertNotNull(certDigest.getDigestValue());
  String qualPropXQuery=declareNS + "$this/ds:Signature/ds:Object/xades:QualifyingProperties";
  xoList=sigDoc.selectPath(qualPropXQuery);
  assertEquals(xoList.length,1);
  QualifyingPropertiesType qualProp=(QualifyingPropertiesType)xoList[0];
  boolean qualPropXsdOk=qualProp.validate();
  assertTrue(qualPropXsdOk);
  pkg.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestNPOIFSFileSystem </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that we can get the correct contents for
 * a document in the filesystem 
 */
@Test public void getDocumentEntry() throws Exception {
  for (  NPOIFSFileSystem fs : get512and4kFileAndInput()) {
    DirectoryEntry root=fs.getRoot();
    Entry si=root.getEntry("\u0005SummaryInformation");
    assertEquals(true,si.isDocumentEntry());
    DocumentNode doc=(DocumentNode)si;
    assertContentsMatches(null,doc);
    DocumentInputStream inp=new NDocumentInputStream(doc);
    PropertySet ps=PropertySetFactory.create(inp);
    SummaryInformation inf=(SummaryInformation)ps;
    assertEquals(null,inf.getApplicationName());
    assertEquals(null,inf.getAuthor());
    assertEquals(null,inf.getSubject());
    assertEquals(131333,inf.getOSVersion());
    inp.close();
    si=root.getEntry("\u0005DocumentSummaryInformation");
    assertEquals(true,si.isDocumentEntry());
    doc=(DocumentNode)si;
    assertContentsMatches(null,doc);
    inp=new NDocumentInputStream(doc);
    ps=PropertySetFactory.create(inp);
    DocumentSummaryInformation dinf=(DocumentSummaryInformation)ps;
    assertEquals(131333,dinf.getOSVersion());
    fs.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void addBeforeWrite() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem();
  DocumentEntry miniDoc;
  DocumentEntry normDoc;
  HeaderBlock hdr;
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(2));
  hdr=writeOutAndReadHeader(fs);
  assertEquals(1,hdr.getBATCount());
  assertEquals(1,hdr.getBATArray()[0]);
  assertEquals(0,hdr.getPropertyStart());
  assertEquals(POIFSConstants.END_OF_CHAIN,hdr.getSBATStart());
  assertEquals(POIFSConstants.END_OF_CHAIN,hdr.getXBATIndex());
  assertEquals(POIFSConstants.SMALLER_BIG_BLOCK_SIZE * 3,fs.size());
  fs=new NPOIFSFileSystem();
  DirectoryEntry parentDir=fs.createDirectory("Parent Directory");
  DirectoryEntry testDir=parentDir.createDirectory("Test Directory");
  byte[] mini=new byte[]{42,0,1,2,3,4,42};
  testDir.createDocument("Mini",new ByteArrayInputStream(mini));
  byte[] main4096=new byte[4096];
  main4096[0]=-10;
  main4096[4095]=-11;
  testDir.createDocument("Normal4096",new ByteArrayInputStream(main4096));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(10,fs.getNextBlock(9));
  assertEquals(11,fs.getNextBlock(10));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(11));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(12));
  assertEquals(POIFSConstants.SMALLER_BIG_BLOCK_SIZE * 13,fs.size());
  miniDoc=(DocumentEntry)testDir.getEntry("Mini");
  assertContentsMatches(mini,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4096");
  assertContentsMatches(main4096,normDoc);
  hdr=writeOutAndReadHeader(fs);
  fs=writeOutAndReadBack(fs);
  assertEquals(1,hdr.getBATCount());
  assertEquals(1,hdr.getBATArray()[0]);
  assertEquals(2,hdr.getSBATStart());
  assertEquals(0,hdr.getPropertyStart());
  assertEquals(POIFSConstants.END_OF_CHAIN,hdr.getXBATIndex());
  assertEquals(12,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(10,fs.getNextBlock(9));
  assertEquals(11,fs.getNextBlock(10));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(11));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(12));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(13));
  assertEquals(POIFSConstants.SMALLER_BIG_BLOCK_SIZE * 14,fs.size());
  DirectoryEntry fsRoot=fs.getRoot();
  assertEquals(1,fsRoot.getEntryCount());
  parentDir=(DirectoryEntry)fsRoot.getEntry("Parent Directory");
  assertEquals(1,parentDir.getEntryCount());
  testDir=(DirectoryEntry)parentDir.getEntry("Test Directory");
  assertEquals(2,testDir.getEntryCount());
  miniDoc=(DocumentEntry)testDir.getEntry("Mini");
  assertContentsMatches(mini,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4096");
  assertContentsMatches(main4096,normDoc);
  byte[] mini2=new byte[]{-42,0,-1,-2,-3,-4,-42};
  testDir.createDocument("Mini2",new ByteArrayInputStream(mini2));
  byte[] main4106=new byte[4106];
  main4106[0]=41;
  main4106[4105]=42;
  testDir.createDocument("Normal4106",new ByteArrayInputStream(main4106));
  fs=writeOutAndReadBack(fs);
  fsRoot=fs.getRoot();
  assertEquals(1,fsRoot.getEntryCount());
  parentDir=(DirectoryEntry)fsRoot.getEntry("Parent Directory");
  assertEquals(1,parentDir.getEntryCount());
  testDir=(DirectoryEntry)parentDir.getEntry("Test Directory");
  assertEquals(4,testDir.getEntryCount());
  miniDoc=(DocumentEntry)testDir.getEntry("Mini");
  assertContentsMatches(mini,miniDoc);
  miniDoc=(DocumentEntry)testDir.getEntry("Mini2");
  assertContentsMatches(mini2,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4106");
  assertContentsMatches(main4106,normDoc);
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Read a file, write it and read it again.
 * Then, alter+add some streams, write and read
 */
@Test public void readWriteRead() throws Exception {
  SummaryInformation sinf=null;
  DocumentSummaryInformation dinf=null;
  DirectoryEntry root=null, testDir=null;
  for (  NPOIFSFileSystem fs : get512and4kFileAndInput()) {
    root=fs.getRoot();
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Tags"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Tags"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,sinf.getOSVersion());
    dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,dinf.getOSVersion());
    testDir=root.createDirectory("Testing 123");
    testDir.createDirectory("Testing 456");
    testDir.createDirectory("Testing 789");
    byte[] mini=new byte[]{42,0,1,2,3,4,42};
    testDir.createDocument("Mini",new ByteArrayInputStream(mini));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(6,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Tags"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,sinf.getOSVersion());
    dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,dinf.getOSVersion());
    assertContentsMatches(mini,(DocumentEntry)testDir.getEntry("Mini"));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(6,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Tags"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,sinf.getOSVersion());
    dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,dinf.getOSVersion());
    assertContentsMatches(mini,(DocumentEntry)testDir.getEntry("Mini"));
    byte[] main4096=new byte[4096];
    main4096[0]=-10;
    main4096[4095]=-11;
    testDir.createDocument("Normal4096",new ByteArrayInputStream(main4096));
    root.getEntry("Tags").delete();
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    sinf=(SummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(SummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,sinf.getOSVersion());
    dinf=(DocumentSummaryInformation)PropertySetFactory.create(new NDocumentInputStream((DocumentEntry)root.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME)));
    assertEquals(131333,dinf.getOSVersion());
    assertContentsMatches(mini,(DocumentEntry)testDir.getEntry("Mini"));
    assertContentsMatches(main4096,(DocumentEntry)testDir.getEntry("Normal4096"));
    testDir.getEntry("Testing 456").delete();
    testDir.createDirectory("Testing ABC");
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    assertEquals(4,testDir.getEntryCount());
    assertThat(testDir.getEntryNames(),hasItem("Mini"));
    assertThat(testDir.getEntryNames(),hasItem("Normal4096"));
    assertThat(testDir.getEntryNames(),hasItem("Testing 789"));
    assertThat(testDir.getEntryNames(),hasItem("Testing ABC"));
    byte[] mini2=new byte[]{-42,0,-1,-2,-3,-4,-42};
    testDir.createDocument("Mini2",new ByteArrayInputStream(mini2));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    assertEquals(5,testDir.getEntryCount());
    assertThat(testDir.getEntryNames(),hasItem("Mini"));
    assertThat(testDir.getEntryNames(),hasItem("Mini2"));
    assertThat(testDir.getEntryNames(),hasItem("Normal4096"));
    assertThat(testDir.getEntryNames(),hasItem("Testing 789"));
    assertThat(testDir.getEntryNames(),hasItem("Testing ABC"));
    assertContentsMatches(mini,(DocumentEntry)testDir.getEntry("Mini"));
    assertContentsMatches(mini2,(DocumentEntry)testDir.getEntry("Mini2"));
    assertContentsMatches(main4096,(DocumentEntry)testDir.getEntry("Normal4096"));
    testDir.getEntry("Mini").delete();
    byte[] mini3=new byte[]{42,0,42,0,42,0,42};
    testDir.createDocument("Mini3",new ByteArrayInputStream(mini3));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    assertEquals(5,testDir.getEntryCount());
    assertThat(testDir.getEntryNames(),hasItem("Mini2"));
    assertThat(testDir.getEntryNames(),hasItem("Mini3"));
    assertThat(testDir.getEntryNames(),hasItem("Normal4096"));
    assertThat(testDir.getEntryNames(),hasItem("Testing 789"));
    assertThat(testDir.getEntryNames(),hasItem("Testing ABC"));
    assertContentsMatches(mini2,(DocumentEntry)testDir.getEntry("Mini2"));
    assertContentsMatches(mini3,(DocumentEntry)testDir.getEntry("Mini3"));
    assertContentsMatches(main4096,(DocumentEntry)testDir.getEntry("Normal4096"));
    NPOIFSDocument mini2Doc=new NPOIFSDocument((DocumentNode)testDir.getEntry("Mini2"));
    mini2Doc.replaceContents(new ByteArrayInputStream(mini));
    byte[] main4106=new byte[4106];
    main4106[0]=41;
    main4106[4105]=42;
    NPOIFSDocument mainDoc=new NPOIFSDocument((DocumentNode)testDir.getEntry("Normal4096"));
    mainDoc.replaceContents(new ByteArrayInputStream(main4106));
    fs=writeOutAndReadBack(fs);
    root=fs.getRoot();
    testDir=(DirectoryEntry)root.getEntry("Testing 123");
    assertEquals(5,root.getEntryCount());
    assertThat(root.getEntryNames(),hasItem("Thumbnail"));
    assertThat(root.getEntryNames(),hasItem("Image"));
    assertThat(root.getEntryNames(),hasItem("Testing 123"));
    assertThat(root.getEntryNames(),hasItem("\u0005DocumentSummaryInformation"));
    assertThat(root.getEntryNames(),hasItem("\u0005SummaryInformation"));
    assertEquals(5,testDir.getEntryCount());
    assertThat(testDir.getEntryNames(),hasItem("Mini2"));
    assertThat(testDir.getEntryNames(),hasItem("Mini3"));
    assertThat(testDir.getEntryNames(),hasItem("Normal4096"));
    assertThat(testDir.getEntryNames(),hasItem("Testing 789"));
    assertThat(testDir.getEntryNames(),hasItem("Testing ABC"));
    assertContentsMatches(mini,(DocumentEntry)testDir.getEntry("Mini2"));
    assertContentsMatches(mini3,(DocumentEntry)testDir.getEntry("Mini3"));
    assertContentsMatches(main4106,(DocumentEntry)testDir.getEntry("Normal4096"));
    fs.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Create a new file, write it and read it again
 * Then, add some streams, write and read
 */
@Test @SuppressWarnings("resource") public void createWriteRead() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem();
  DocumentEntry miniDoc;
  DocumentEntry normDoc;
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(2));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getRoot().getProperty().getStartBlock());
  assertEquals(0,fs._get_property_table().getStartBlock());
  fs=writeOutAndReadBack(fs);
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(2));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(3));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getRoot().getProperty().getStartBlock());
  assertEquals(0,fs._get_property_table().getStartBlock());
  DirectoryEntry testDir=fs.createDirectory("Test Directory");
  byte[] main4096=new byte[4096];
  main4096[0]=-10;
  main4096[4095]=-11;
  testDir.createDocument("Normal4096",new ByteArrayInputStream(main4096));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(3,fs.getNextBlock(2));
  assertEquals(4,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(9));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(10));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(11));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getRoot().getProperty().getStartBlock());
  byte[] main5124=new byte[5124];
  main5124[0]=-22;
  main5124[5123]=-33;
  testDir.createDocument("Normal5124",new ByteArrayInputStream(main5124));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(3,fs.getNextBlock(2));
  assertEquals(4,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(9));
  assertEquals(11,fs.getNextBlock(10));
  assertEquals(12,fs.getNextBlock(11));
  assertEquals(13,fs.getNextBlock(12));
  assertEquals(14,fs.getNextBlock(13));
  assertEquals(15,fs.getNextBlock(14));
  assertEquals(16,fs.getNextBlock(15));
  assertEquals(17,fs.getNextBlock(16));
  assertEquals(18,fs.getNextBlock(17));
  assertEquals(19,fs.getNextBlock(18));
  assertEquals(20,fs.getNextBlock(19));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(20));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(21));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(22));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getRoot().getProperty().getStartBlock());
  byte[] mini=new byte[]{42,0,1,2,3,4,42};
  testDir.createDocument("Mini",new ByteArrayInputStream(mini));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(3,fs.getNextBlock(2));
  assertEquals(4,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(9));
  assertEquals(11,fs.getNextBlock(10));
  assertEquals(12,fs.getNextBlock(11));
  assertEquals(13,fs.getNextBlock(12));
  assertEquals(14,fs.getNextBlock(13));
  assertEquals(15,fs.getNextBlock(14));
  assertEquals(16,fs.getNextBlock(15));
  assertEquals(17,fs.getNextBlock(16));
  assertEquals(18,fs.getNextBlock(17));
  assertEquals(19,fs.getNextBlock(18));
  assertEquals(20,fs.getNextBlock(19));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(20));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(21));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(22));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(23));
  assertEquals(22,fs.getRoot().getProperty().getStartBlock());
  fs=writeOutAndReadBack(fs);
  HeaderBlock header=writeOutAndReadHeader(fs);
  assertEquals(1,header.getBATCount());
  assertEquals(1,header.getBATArray()[0]);
  assertEquals(0,header.getPropertyStart());
  assertEquals(1,header.getSBATCount());
  assertEquals(21,header.getSBATStart());
  assertEquals(22,fs._get_property_table().getRoot().getStartBlock());
  assertEquals(23,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(3,fs.getNextBlock(2));
  assertEquals(4,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(9));
  assertEquals(11,fs.getNextBlock(10));
  assertEquals(12,fs.getNextBlock(11));
  assertEquals(13,fs.getNextBlock(12));
  assertEquals(14,fs.getNextBlock(13));
  assertEquals(15,fs.getNextBlock(14));
  assertEquals(16,fs.getNextBlock(15));
  assertEquals(17,fs.getNextBlock(16));
  assertEquals(18,fs.getNextBlock(17));
  assertEquals(19,fs.getNextBlock(18));
  assertEquals(20,fs.getNextBlock(19));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(20));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(21));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(22));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(23));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(24));
  assertEquals(1,fs.getRoot().getEntryCount());
  testDir=(DirectoryEntry)fs.getRoot().getEntry("Test Directory");
  assertEquals(3,testDir.getEntryCount());
  miniDoc=(DocumentEntry)testDir.getEntry("Mini");
  assertContentsMatches(mini,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4096");
  assertContentsMatches(main4096,normDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal5124");
  assertContentsMatches(main5124,normDoc);
  miniDoc.delete();
  normDoc.delete();
  fs=writeOutAndReadBack(fs);
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(0));
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(1));
  assertEquals(3,fs.getNextBlock(2));
  assertEquals(4,fs.getNextBlock(3));
  assertEquals(5,fs.getNextBlock(4));
  assertEquals(6,fs.getNextBlock(5));
  assertEquals(7,fs.getNextBlock(6));
  assertEquals(8,fs.getNextBlock(7));
  assertEquals(9,fs.getNextBlock(8));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(9));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(10));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(11));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(12));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(13));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(14));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(15));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(16));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(17));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(18));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(19));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(20));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(21));
  assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(22));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(23));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(24));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(25));
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeZeroLengthEntries() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem();
  DirectoryNode testDir=fs.getRoot();
  DocumentEntry miniDoc;
  DocumentEntry normDoc;
  DocumentEntry emptyDoc;
  byte[] mini2=new byte[]{-42,0,-1,-2,-3,-4,-42};
  testDir.createDocument("Mini2",new ByteArrayInputStream(mini2));
  byte[] main4106=new byte[4106];
  main4106[0]=41;
  main4106[4105]=42;
  testDir.createDocument("Normal4106",new ByteArrayInputStream(main4106));
  byte[] empty=new byte[0];
  testDir.createDocument("empty-1",new ByteArrayInputStream(empty));
  testDir.createDocument("empty-2",new ByteArrayInputStream(empty));
  testDir.createDocument("empty-3",new ByteArrayInputStream(empty));
  miniDoc=(DocumentEntry)testDir.getEntry("Mini2");
  assertContentsMatches(mini2,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4106");
  assertContentsMatches(main4106,normDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-1");
  assertContentsMatches(empty,emptyDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-2");
  assertContentsMatches(empty,emptyDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-3");
  assertContentsMatches(empty,emptyDoc);
  NPropertyTable props=fs._get_property_table();
  Iterator<Property> propsIt=props.getRoot().getChildren();
  Property prop=propsIt.next();
  assertEquals("Mini2",prop.getName());
  assertEquals(0,prop.getStartBlock());
  assertEquals(7,prop.getSize());
  prop=propsIt.next();
  assertEquals("Normal4106",prop.getName());
  assertEquals(4,prop.getStartBlock());
  assertEquals(4106,prop.getSize());
  prop=propsIt.next();
  assertEquals("empty-1",prop.getName());
  assertEquals(POIFSConstants.END_OF_CHAIN,prop.getStartBlock());
  assertEquals(0,prop.getSize());
  prop=propsIt.next();
  assertEquals("empty-2",prop.getName());
  assertEquals(POIFSConstants.END_OF_CHAIN,prop.getStartBlock());
  assertEquals(0,prop.getSize());
  prop=propsIt.next();
  assertEquals("empty-3",prop.getName());
  assertEquals(POIFSConstants.END_OF_CHAIN,prop.getStartBlock());
  assertEquals(0,prop.getSize());
  fs=writeOutAndReadBack(fs);
  testDir=fs.getRoot();
  miniDoc=(DocumentEntry)testDir.getEntry("Mini2");
  assertContentsMatches(mini2,miniDoc);
  normDoc=(DocumentEntry)testDir.getEntry("Normal4106");
  assertContentsMatches(main4106,normDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-1");
  assertContentsMatches(empty,emptyDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-2");
  assertContentsMatches(empty,emptyDoc);
  emptyDoc=(DocumentEntry)testDir.getEntry("empty-3");
  assertContentsMatches(empty,emptyDoc);
  assertEquals(3,testDir.getProperty().getStartBlock());
  assertEquals(64,testDir.getProperty().getSize());
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
/** 
 * Test that we can read a file with NPOIFS, create a new NPOIFS instance,
 * write it out, read it with POIFS, and see the original data
 */
@Test public void NPOIFSReadCopyWritePOIFSRead() throws Exception {
  File testFile=POIDataSamples.getSpreadSheetInstance().getFile("Simple.xls");
  NPOIFSFileSystem src=new NPOIFSFileSystem(testFile);
  byte wbDataExp[]=IOUtils.toByteArray(src.createDocumentInputStream("Workbook"));
  NPOIFSFileSystem nfs=new NPOIFSFileSystem();
  EntryUtils.copyNodes(src.getRoot(),nfs.getRoot());
  src.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  nfs.writeFilesystem(bos);
  nfs.close();
  POIFSFileSystem pfs=new POIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  byte wbDataAct[]=IOUtils.toByteArray(pfs.createDocumentInputStream("Workbook"));
  assertThat(wbDataExp,equalTo(wbDataAct));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ask for free blocks where no free ones exist, and so the
 * file needs to be extended and another BAT/XBAT added
 */
@Test public void getFreeBlockWithNoneSpare() throws Exception {
  NPOIFSFileSystem fs=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  int free;
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(99));
  assertBATCount(fs,1,0);
  for (int i=100; i < 128; i++) {
    assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(i));
  }
  assertEquals(true,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  for (int i=100; i < 128; i++) {
    fs.setNextBlock(i,POIFSConstants.END_OF_CHAIN);
  }
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
    fail("Should only be one BAT");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,1,0);
  assertEquals(129,fs.getFreeBlock());
  assertEquals(false,fs.getBATBlockAndIndex(0).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(128).getBlock().hasFreeSectors());
  assertEquals(POIFSConstants.FAT_SECTOR_BLOCK,fs.getNextBlock(128));
  assertEquals(POIFSConstants.UNUSED_BLOCK,fs.getNextBlock(129));
  assertBATCount(fs,2,0);
  for (int i=0; i < 109; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
  }
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(109 * 128).getBlock().hasFreeSectors());
    fail("Should only be 109 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,109,0);
  HeaderBlock header=writeOutAndReadHeader(fs);
  assertEquals(109,header.getBATCount());
  assertEquals(0,header.getXBATCount());
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(109 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(110 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(110 * 128).getBlock().hasFreeSectors());
    fail("Should only be 110 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,110,1);
  header=writeOutAndReadHeader(fs);
  assertEquals(110,header.getBATCount());
  assertEquals(1,header.getXBATCount());
  for (int i=109; i < 109 + 127; i++) {
    fs.getFreeBlock();
    int startOffset=i * 128;
    while (fs.getBATBlockAndIndex(startOffset).getBlock().hasFreeSectors()) {
      free=fs.getFreeBlock();
      fs.setNextBlock(free,POIFSConstants.END_OF_CHAIN);
    }
    assertBATCount(fs,i + 1,1);
  }
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(236 * 128).getBlock().hasFreeSectors());
    fail("Should only be 236 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,236,1);
  free=fs.getFreeBlock();
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  assertBATCount(fs,237,2);
  header=writeOutAndReadHeader(fs);
  fs=writeOutAndReadBack(fs);
  assertBATCount(fs,237,2);
  assertEquals(false,fs.getBATBlockAndIndex(236 * 128 - 1).getBlock().hasFreeSectors());
  assertEquals(true,fs.getBATBlockAndIndex(237 * 128 - 1).getBlock().hasFreeSectors());
  try {
    assertEquals(false,fs.getBATBlockAndIndex(237 * 128).getBlock().hasFreeSectors());
    fail("Should only be 237 BATs");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  fs.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propertiesAndFatOnRead() throws Exception {
  NPOIFSFileSystem fsA, fsB;
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize512.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize512.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(140);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(98,fs.getNextBlock(97));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(98));
    NPropertyTable props=fs._get_property_table();
    assertEquals(90,props.getStartBlock());
    assertEquals(7,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    try {
      ministore.getBATBlockAndIndex(256);
      fail("Should only be two SBATs, but a 3rd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
  fsA=new NPOIFSFileSystem(_inst.getFile("BlockSize4096.zvi"));
  fsB=new NPOIFSFileSystem(_inst.openResourceAsStream("BlockSize4096.zvi"));
  for (  NPOIFSFileSystem fs : new NPOIFSFileSystem[]{fsA,fsB}) {
    fs.getBATBlockAndIndex(0);
    fs.getBATBlockAndIndex(1);
    try {
      fs.getBATBlockAndIndex(1040);
      fail("Should only be one BAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    assertEquals(1,fs.getNextBlock(0));
    assertEquals(2,fs.getNextBlock(1));
    assertEquals(POIFSConstants.END_OF_CHAIN,fs.getNextBlock(2));
    NPropertyTable props=fs._get_property_table();
    assertEquals(12,props.getStartBlock());
    assertEquals(1,props.countBlocks());
    RootProperty root=props.getRoot();
    assertEquals("Root Entry",root.getName());
    assertEquals(11564,root.getSize());
    assertEquals(0,root.getStartBlock());
    Property prop;
    Iterator<Property> pi=root.getChildren();
    prop=pi.next();
    assertEquals("Thumbnail",prop.getName());
    prop=pi.next();
    assertEquals("\u0005DocumentSummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("\u0005SummaryInformation",prop.getName());
    prop=pi.next();
    assertEquals("Image",prop.getName());
    prop=pi.next();
    assertEquals("Tags",prop.getName());
    assertEquals(false,pi.hasNext());
    NPOIFSMiniStore ministore=fs.getMiniStore();
    ministore.getBATBlockAndIndex(0);
    ministore.getBATBlockAndIndex(128);
    ministore.getBATBlockAndIndex(1023);
    try {
      ministore.getBATBlockAndIndex(1024);
      fail("Should only be one SBAT, but a 2nd was found");
    }
 catch (    IndexOutOfBoundsException e) {
    }
    for (int i=0; i < 50; i++) {
      assertEquals(i + 1,ministore.getNextBlock(i));
    }
    assertEquals(POIFSConstants.END_OF_CHAIN,ministore.getNextBlock(50));
    fs.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.filesystem.TestOle10Native </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOleNative() throws IOException, Ole10NativeException {
  POIFSFileSystem fs=new POIFSFileSystem(dataSamples.openResourceAsStream("oleObject1.bin"));
  Ole10Native ole=Ole10Native.createFromEmbeddedOleObject(fs);
  assertEquals("File1.svg",ole.getLabel());
  assertEquals("D:\\Documents and Settings\\rsc\\My Documents\\file1.svg",ole.getCommand());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.storage.TestPropertyBlock </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreatePropertyBlocks() throws Exception {
  List<Property> properties=new ArrayList<Property>();
  BlockWritable[] blocks=PropertyBlock.createPropertyBlockArray(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,properties);
  assertEquals(0,blocks.length);
  properties.add(new LocalProperty("Root Entry"));
  blocks=PropertyBlock.createPropertyBlockArray(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,properties);
  assertEquals(1,blocks.length);
  byte[] testblock=new byte[512];
  for (int j=0; j < 4; j++) {
    setDefaultBlock(testblock,j);
  }
  testblock[0x0000]=(byte)'R';
  testblock[0x0002]=(byte)'o';
  testblock[0x0004]=(byte)'o';
  testblock[0x0006]=(byte)'t';
  testblock[0x0008]=(byte)' ';
  testblock[0x000A]=(byte)'E';
  testblock[0x000C]=(byte)'n';
  testblock[0x000E]=(byte)'t';
  testblock[0x0010]=(byte)'r';
  testblock[0x0012]=(byte)'y';
  testblock[0x0040]=(byte)22;
  verifyCorrect(blocks,testblock);
  properties.add(new LocalProperty("workbook"));
  properties.add(new LocalProperty("summary"));
  blocks=PropertyBlock.createPropertyBlockArray(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,properties);
  assertEquals(1,blocks.length);
  testblock[0x0080]=(byte)'w';
  testblock[0x0082]=(byte)'o';
  testblock[0x0084]=(byte)'r';
  testblock[0x0086]=(byte)'k';
  testblock[0x0088]=(byte)'b';
  testblock[0x008A]=(byte)'o';
  testblock[0x008C]=(byte)'o';
  testblock[0x008E]=(byte)'k';
  testblock[0x00C0]=(byte)18;
  testblock[0x0100]=(byte)'s';
  testblock[0x0102]=(byte)'u';
  testblock[0x0104]=(byte)'m';
  testblock[0x0106]=(byte)'m';
  testblock[0x0108]=(byte)'a';
  testblock[0x010A]=(byte)'r';
  testblock[0x010C]=(byte)'y';
  testblock[0x0140]=(byte)16;
  verifyCorrect(blocks,testblock);
  properties.add(new LocalProperty("wintery"));
  blocks=PropertyBlock.createPropertyBlockArray(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,properties);
  assertEquals(1,blocks.length);
  testblock[0x0180]=(byte)'w';
  testblock[0x0182]=(byte)'i';
  testblock[0x0184]=(byte)'n';
  testblock[0x0186]=(byte)'t';
  testblock[0x0188]=(byte)'e';
  testblock[0x018A]=(byte)'r';
  testblock[0x018C]=(byte)'y';
  testblock[0x01C0]=(byte)16;
  verifyCorrect(blocks,testblock);
  properties.add(new LocalProperty("foo"));
  blocks=PropertyBlock.createPropertyBlockArray(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,properties);
  assertEquals(2,blocks.length);
  testblock=new byte[1024];
  for (int j=0; j < 8; j++) {
    setDefaultBlock(testblock,j);
  }
  testblock[0x0000]=(byte)'R';
  testblock[0x0002]=(byte)'o';
  testblock[0x0004]=(byte)'o';
  testblock[0x0006]=(byte)'t';
  testblock[0x0008]=(byte)' ';
  testblock[0x000A]=(byte)'E';
  testblock[0x000C]=(byte)'n';
  testblock[0x000E]=(byte)'t';
  testblock[0x0010]=(byte)'r';
  testblock[0x0012]=(byte)'y';
  testblock[0x0040]=(byte)22;
  testblock[0x0080]=(byte)'w';
  testblock[0x0082]=(byte)'o';
  testblock[0x0084]=(byte)'r';
  testblock[0x0086]=(byte)'k';
  testblock[0x0088]=(byte)'b';
  testblock[0x008A]=(byte)'o';
  testblock[0x008C]=(byte)'o';
  testblock[0x008E]=(byte)'k';
  testblock[0x00C0]=(byte)18;
  testblock[0x0100]=(byte)'s';
  testblock[0x0102]=(byte)'u';
  testblock[0x0104]=(byte)'m';
  testblock[0x0106]=(byte)'m';
  testblock[0x0108]=(byte)'a';
  testblock[0x010A]=(byte)'r';
  testblock[0x010C]=(byte)'y';
  testblock[0x0140]=(byte)16;
  testblock[0x0180]=(byte)'w';
  testblock[0x0182]=(byte)'i';
  testblock[0x0184]=(byte)'n';
  testblock[0x0186]=(byte)'t';
  testblock[0x0188]=(byte)'e';
  testblock[0x018A]=(byte)'r';
  testblock[0x018C]=(byte)'y';
  testblock[0x01C0]=(byte)16;
  testblock[0x0200]=(byte)'f';
  testblock[0x0202]=(byte)'o';
  testblock[0x0204]=(byte)'o';
  testblock[0x0240]=(byte)8;
  verifyCorrect(blocks,testblock);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.sl.draw.TestDrawPictureShape </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResize() throws Exception {
  String files[]={"pictures.ppt","shapes.pptx"};
  for (  String file : files) {
    SlideShow<?,?> ss=openSampleDocument(file);
    Slide<?,?> slide=ss.getSlides().get(0);
    PictureShape<?,?> picShape=null;
    for (    Shape<?,?> shape : slide.getShapes()) {
      if (shape instanceof PictureShape) {
        picShape=(PictureShape<?,?>)shape;
        break;
      }
    }
    assertNotNull(picShape);
    PictureData pd=picShape.getPictureData();
    Dimension dimPd=pd.getImageDimension();
    new DrawPictureShape(picShape).resize();
    Dimension dimShape=new Dimension((int)picShape.getAnchor().getWidth(),(int)picShape.getAnchor().getHeight());
    assertEquals(dimPd,dimShape);
    double newWidth=(dimPd.getWidth() * (100d / dimPd.getHeight()));
    Rectangle2D expRect=new Rectangle2D.Double(rbf(50 + 300 - newWidth,picShape),50,rbf(newWidth,picShape),100);
    Rectangle2D target=new Rectangle2D.Double(50,50,300,100);
    new DrawPictureShape(picShape).resize(target,RectAlign.BOTTOM_RIGHT);
    Rectangle2D actRect=picShape.getAnchor();
    assertEquals(expRect.getX(),actRect.getX(),.0001);
    assertEquals(expRect.getY(),actRect.getY(),.0001);
    assertEquals(expRect.getWidth(),actRect.getWidth(),.0001);
    assertEquals(expRect.getHeight(),actRect.getHeight(),.0001);
    ss.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.sl.draw.geom.TestPresetGeometries </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead(){
  Map<String,CustomGeometry> shapes=PresetGeometries.getInstance();
  assertEquals(187,shapes.size());
  for (  String name : shapes.keySet()) {
    CustomGeometry geom=shapes.get(name);
    Context ctx=new Context(geom,new Rectangle2D.Double(0,0,100,100),new IAdjustableShape(){
      public Guide getAdjustValue(      String presetName){
        return null;
      }
    }
);
    for (    Path p : geom) {
      GeneralPath path=p.getPath(ctx);
      assertNotNull(path);
    }
  }
  assertTrue(shapes == PresetGeometries.getInstance());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.TestWorkbookFactory </h4><pre class="type-2 type-10 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the overloaded stream methods which take passwords work properly
 */
@Test public void testCreateWithPasswordFromStream() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls),null);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx),null);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls_prot[0]),xls_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls_prot[0],wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx_prot[0]),xlsx_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xls_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateReadOnly() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls),null,true);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx),null,true);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the overloaded file methods which take passwords work properly
 */
@Test public void testCreateWithPasswordFromFile() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls),null);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx),null);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx),"wrong");
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls_prot[0]),xls_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls_prot[0],wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx_prot[0]),xlsx_prot[1]);
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xls_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
  try {
    wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx_prot[0]),"wrong");
    assertCloseDoesNotModifyFile(xlsx_prot[0],wb);
    fail("Shouldn't be able to open with the wrong password");
  }
 catch (  EncryptedDocumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNative() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(new POIFSFileSystem(HSSFTestDataSamples.openSampleFileStream(xls)));
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(OPCPackage.open(HSSFTestDataSamples.openSampleFileStream(xlsx)));
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creates the appropriate kind of Workbook, but
 * checking the mime magic at the start of the
 * InputStream, then creating what's required.
 */
@Test public void testCreateGeneric() throws Exception {
  Workbook wb;
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xls));
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.openSampleFileStream(xlsx));
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xls));
  assertNotNull(wb);
  assertTrue(wb instanceof HSSFWorkbook);
  assertCloseDoesNotModifyFile(xls,wb);
  wb=WorkbookFactory.create(HSSFTestDataSamples.getSampleFile(xlsx));
  assertNotNull(wb);
  assertTrue(wb instanceof XSSFWorkbook);
  assertCloseDoesNotModifyFile(xlsx,wb);
  final byte[] before=HSSFTestDataSamples.getTestDataFileContent(txt);
  try {
    InputStream stream=HSSFTestDataSamples.openSampleFileStream(txt);
    try {
      wb=WorkbookFactory.create(stream);
    }
  finally {
      stream.close();
    }
    fail();
  }
 catch (  InvalidFormatException e) {
  }
  final byte[] after=HSSFTestDataSamples.getTestDataFileContent(txt);
  assertArrayEquals("Invalid type file was modified after trying to open the file as a spreadsheet",before,after);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.excelant.util.TestExcelAntWorkbookUtilFactory </h4><pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Simple test to determine if the factory properly returns an non-null
 * instance of the ExcelAntWorkbookUtil class.
 */
@Test public void testGetNewWorkbookUtilInstance(){
  ExcelAntWorkbookUtil util=ExcelAntWorkbookUtilFactory.getInstance(mortgageCalculatorWorkbookFile);
  assertNotNull(util);
}

</code></pre>

<br>
<pre class="type-2 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether or not the factory will properly return the same reference
 * to an ExcelAnt WorkbookUtil when two different Strings, that point to
 * the same resource, are passed in. 
 */
@Test public void testVerifyEquivalence(){
  String sameFileName=BuildFileTest.getDataDir() + "/spreadsheet/mortgage-calculation.xls";
  ExcelAntWorkbookUtil util=ExcelAntWorkbookUtilFactory.getInstance(mortgageCalculatorWorkbookFile);
  ExcelAntWorkbookUtil util2=ExcelAntWorkbookUtilFactory.getInstance(sameFileName);
  assertNotNull(util);
  assertNotNull(util2);
  assertEquals(util,util2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.format.TestCellFormat </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccountingFormats() throws IOException {
  char pound='\u00A3';
  char euro='\u20AC';
  String formatDft="_-\"$\"* #,##0_-;\\-\"$\"* #,##0_-;_-\"$\"* \"-\"_-;_-@_-";
  String formatUS="_-[$$-409]* #,##0_ ;_-[$$-409]* -#,##0 ;_-[$$-409]* \"-\"_-;_-@_-";
  String formatUK="_-[$" + pound + "-809]* #,##0_-;\\-[$"+ pound+ "-809]* #,##0_-;_-[$"+ pound+ "-809]* \"-\"??_-;_-@_-";
  String formatFR="_-#,##0* [$" + euro + "-40C]_-;\\-#,##0* [$"+ euro+ "-40C]_-;_-\"-\"??* [$"+ euro+ "-40C] _-;_-@_-";
  CellFormat cfDft=CellFormat.getInstance(formatDft);
  CellFormat cfUS=CellFormat.getInstance(formatUS);
  CellFormat cfUK=CellFormat.getInstance(formatUK);
  CellFormat cfFR=CellFormat.getInstance(formatFR);
  assertEquals(" $   12 ",cfDft.apply(Double.valueOf(12.33)).text);
  assertEquals(" $   12 ",cfUS.apply(Double.valueOf(12.33)).text);
  assertEquals(" " + pound + "   12 ",cfUK.apply(Double.valueOf(12.33)).text);
  assertEquals(" 12   " + euro + " ",cfFR.apply(Double.valueOf(12.33)).text);
  assertEquals(" $   16,789 ",cfDft.apply(Double.valueOf(16789.2)).text);
  assertEquals(" $   16,789 ",cfUS.apply(Double.valueOf(16789.2)).text);
  assertEquals(" " + pound + "   16,789 ",cfUK.apply(Double.valueOf(16789.2)).text);
  assertEquals(" 16,789   " + euro + " ",cfFR.apply(Double.valueOf(16789.2)).text);
  assertEquals("-$   12 ",cfDft.apply(Double.valueOf(-12.33)).text);
  assertEquals(" $   -12 ",cfUS.apply(Double.valueOf(-12.33)).text);
  assertEquals("-" + pound + "   12 ",cfUK.apply(Double.valueOf(-12.33)).text);
  assertEquals("-12   " + euro + " ",cfFR.apply(Double.valueOf(-12.33)).text);
  assertEquals("-$   16,789 ",cfDft.apply(Double.valueOf(-16789.2)).text);
  assertEquals(" $   -16,789 ",cfUS.apply(Double.valueOf(-16789.2)).text);
  assertEquals("-" + pound + "   16,789 ",cfUK.apply(Double.valueOf(-16789.2)).text);
  assertEquals("-16,789   " + euro + " ",cfFR.apply(Double.valueOf(-16789.2)).text);
  assertEquals(" $   - ",cfDft.apply(Double.valueOf(0)).text);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.format.TestCellFormatPart </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberApproxFormat() throws Exception {
  runFormatTests("NumberFormatApproxTests.xlsx",new CellValue(){
    public Object getValue(    Cell cell){
      return cell.getNumericCellValue();
    }
    @Override void equivalent(    String expected,    String actual,    CellFormatPart format){
      double expectedVal=extractNumber(expected);
      double actualVal=extractNumber(actual);
      double delta=expectedVal / 100;
      assertEquals("format \"" + format + "\","+ expected+ " ~= "+ actual,expectedVal,actualVal,delta);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.TestWorkbookEvaluator </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Make sure that the evaluator can directly handle tAttrSum (instead of relying on re-parsing
 * the whole formula which converts tAttrSum to tFuncVar("SUM") )
 */
@Test public void testAttrSum(){
  Ptg[] ptgs={new IntPtg(42),AttrPtg.SUM};
  ValueEval result=evaluateFormula(ptgs);
  assertEquals(42,((NumberEval)result).getNumberValue(),0.0);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Make sure that the evaluator can directly handle tAttrSum (instead of relying on re-parsing
 * the whole formula which converts tAttrSum to tFuncVar("SUM") )
 */
@Test public void testMemFunc(){
  Ptg[] ptgs={new IntPtg(42),AttrPtg.SUM};
  ValueEval result=evaluateFormula(ptgs);
  assertEquals(42,((NumberEval)result).getNumberValue(),0.0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.atp.TestWorkdayFunction </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdaysSpanningAWeekendSubtractingDays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2013,8,27);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval("2013/09/30"),new NumberEval(-1)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  assertEquals(41544.0,numberValue,0);
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdaysWhenStartIsWeekendSubtractingDays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2013,9,4);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval("2013/10/06"),new NumberEval(-1)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  assertEquals(41551.0,numberValue,0);
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdaysWithDaysTruncated(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2009,3,30);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval(STARTING_DATE),new NumberEval(151.99999)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnRetroativeWorkday(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2008,8,23);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval(STARTING_DATE),new NumberEval(-5),new StringEval(RETROATIVE_HOLIDAY)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2009,3,30);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval(STARTING_DATE),new NumberEval(151)};
  Date actDate=DateUtil.getJavaDate(((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue());
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdaysWhenStartIsWeekendAddingDays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2013,9,7);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval("2013/10/06"),new NumberEval(1)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  assertEquals(41554.0,numberValue,0);
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnNetworkdaysWithManyHolidays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2009,4,5);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval(STARTING_DATE),new NumberEval(151),new MockAreaEval(FIRST_HOLIDAY,SECOND_HOLIDAY,THIRD_HOLIDAY)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReturnWorkdaysSpanningAWeekendAddingDays(){
  Calendar expCal=LocaleUtil.getLocaleCalendar(2013,8,30);
  Date expDate=expCal.getTime();
  ValueEval ve[]={new StringEval("2013/09/27"),new NumberEval(1)};
  double numberValue=((NumberEval)WorkdayFunction.instance.evaluate(ve,EC)).getNumberValue();
  assertEquals(41547.0,numberValue,0);
  Date actDate=DateUtil.getJavaDate(numberValue);
  assertEquals(expDate,actDate);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.BaseTestCircularReferences </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * ASF Bugzilla Bug 44413
 * "INDEX() formula cannot contain its own location in the data array range"
 */
@Test public void testIndexFormula() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet("Sheet1");
  int colB=1;
  sheet.createRow(0).createCell(colB).setCellValue(1);
  sheet.createRow(1).createCell(colB).setCellValue(2);
  sheet.createRow(2).createCell(colB).setCellValue(3);
  Row row4=sheet.createRow(3);
  Cell testCell=row4.createCell(0);
  testCell.setCellFormula("INDEX(A1:B4,2,2)");
  CellValue cellValue=evaluateWithCycles(wb,testCell);
  assertTrue(cellValue.getCellType() == Cell.CELL_TYPE_NUMERIC);
  assertEquals(2,cellValue.getNumberValue(),0);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.TestFormulasFromSpreadsheet </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (int colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    if (c == null || c.getCellType() != Cell.CELL_TYPE_FORMULA) {
      continue;
    }
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
assertEquals(msg,ErrorEval.getText(expValue.getErrorCellValue()),ErrorEval.getText(actValue.getErrorValue()));
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.BaseTestFunctionsFromSpreadsheet </h4><pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow() throws Exception {
  HSSFRow r=sheet.getRow(formulasRowIdx);
  HSSFCell evalCell=r.getCell(SS.COLUMN_INDEX_EVALUATION);
  HSSFCell expectedCell=r.getCell(SS.COLUMN_INDEX_EXPECTED_RESULT);
  CellReference cr=new CellReference(sheet.getSheetName(),formulasRowIdx,evalCell.getColumnIndex(),false,false);
  String msg=String.format(Locale.ROOT,"In %s %s {=%s} '%s'",filename,cr.formatAsString(),evalCell.getCellFormula(),testName);
  CellValue actualValue=evaluator.evaluate(evalCell);
  assertNotNull(msg + " - Bad setup data expected value is null",expectedCell);
  assertNotNull(msg + " - actual value was null",actualValue);
  if (expectedCell.getCellType() == HSSFCell.CELL_TYPE_ERROR) {
    int expectedErrorCode=expectedCell.getErrorCellValue();
    assertEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),actualValue.formatAsString());
    assertEquals(msg,expectedErrorCode,actualValue.getErrorValue());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),ErrorEval.getText(actualValue.getErrorValue()));
    return;
  }
  assertNotEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
  assertNotEquals(msg,formatValue(expectedCell),ErrorEval.getText(actualValue.getErrorValue()));
  assertEquals(msg,expectedCell.getCellType(),actualValue.getCellType());
switch (expectedCell.getCellType()) {
case HSSFCell.CELL_TYPE_BOOLEAN:
    assertEquals(msg,expectedCell.getBooleanCellValue(),actualValue.getBooleanValue());
  break;
case HSSFCell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case HSSFCell.CELL_TYPE_NUMERIC:
assertEquals(expectedCell.getNumericCellValue(),actualValue.getNumberValue(),0.0);
break;
case HSSFCell.CELL_TYPE_STRING:
assertEquals(msg,expectedCell.getRichStringCellValue().getString(),actualValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.TestEDate </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEDateDecrease(){
  EDate eDate=new EDate();
  Date startDate=new Date();
  int offset=-2;
  NumberEval result=(NumberEval)eDate.evaluate(new ValueEval[]{new NumberEval(DateUtil.getExcelDate(startDate)),new NumberEval(offset)},null);
  Date resultDate=DateUtil.getJavaDate(result.getNumberValue());
  Calendar instance=LocaleUtil.getLocaleCalendar();
  instance.setTime(startDate);
  instance.add(Calendar.MONTH,offset);
  assertEquals(resultDate,instance.getTime());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEDateIncrease(){
  EDate eDate=new EDate();
  Date startDate=new Date();
  int offset=2;
  NumberEval result=(NumberEval)eDate.evaluate(new ValueEval[]{new NumberEval(DateUtil.getExcelDate(startDate)),new NumberEval(offset)},null);
  Date resultDate=DateUtil.getJavaDate(result.getNumberValue());
  Calendar instance=LocaleUtil.getLocaleCalendar();
  instance.setTime(startDate);
  instance.add(Calendar.MONTH,offset);
  assertEquals(resultDate,instance.getTime());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.TestEOMonth </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void checkOffset(){
  for (int offset=-12; offset <= 12; offset++) {
    Calendar cal=LocaleUtil.getLocaleCalendar();
    Date startDate=cal.getTime();
    cal.add(Calendar.MONTH,offset);
    cal.set(Calendar.DAY_OF_MONTH,cal.getActualMaximum(Calendar.DAY_OF_MONTH));
    cal.clear(Calendar.HOUR);
    cal.set(Calendar.HOUR_OF_DAY,0);
    cal.clear(Calendar.MINUTE);
    cal.clear(Calendar.SECOND);
    cal.clear(Calendar.MILLISECOND);
    Date expDate=cal.getTime();
    ValueEval ve[]={new NumberEval(DateUtil.getExcelDate(startDate)),new NumberEval(offset)};
    NumberEval result=(NumberEval)eOMonth.evaluate(ve,ec);
    Date actDate=DateUtil.getJavaDate(result.getNumberValue());
    assertEquals(expDate,actDate);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.TestText </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTextWithDeciamlFormatSecondArg(){
  ValueEval numArg=new NumberEval(321321.321);
  ValueEval formatArg=new StringEval("#,###.00000");
  ValueEval[] args={numArg,formatArg};
  ValueEval result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  DecimalFormatSymbols dfs=DecimalFormatSymbols.getInstance(LocaleUtil.getUserLocale());
  char groupSeparator=dfs.getGroupingSeparator();
  char decimalSeparator=dfs.getDecimalSeparator();
  ValueEval testResult=new StringEval("321" + groupSeparator + "321"+ decimalSeparator+ "32100");
  assertEquals(testResult.toString(),result.toString());
  numArg=new NumberEval(321.321);
  formatArg=new StringEval("00000.00000");
  args[0]=numArg;
  args[1]=formatArg;
  result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  testResult=new StringEval("00321" + decimalSeparator + "32100");
  assertEquals(testResult.toString(),result.toString());
  formatArg=new StringEval("$#.#");
  args[1]=formatArg;
  result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  testResult=new StringEval("$321" + decimalSeparator + "3");
  assertEquals(testResult.toString(),result.toString());
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTextWithFractionFormatSecondArg(){
  ValueEval numArg=new NumberEval(321.321);
  ValueEval formatArg=new StringEval("# #/#");
  ValueEval[] args={numArg,formatArg};
  ValueEval result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  ValueEval testResult=new StringEval("321 1/3");
  assertEquals(testResult.toString(),result.toString());
  formatArg=new StringEval("# #/##");
  args[1]=formatArg;
  result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  testResult=new StringEval("321 26/81");
  assertEquals(testResult.toString(),result.toString());
  formatArg=new StringEval("#/##");
  args[1]=formatArg;
  result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  testResult=new StringEval("26027/81");
  assertEquals(testResult.toString(),result.toString());
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTextWithDateFormatSecondArg(){
  TimeZone userTZ=LocaleUtil.getUserTimeZone();
  LocaleUtil.setUserTimeZone(TimeZone.getTimeZone("CET"));
  try {
    ValueEval numArg=new NumberEval(321.321);
    ValueEval formatArg=new StringEval("dd:MM:yyyy hh:mm:ss");
    ValueEval[] args={numArg,formatArg};
    ValueEval result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
    ValueEval testResult=new StringEval("16:11:1900 07:42:14");
    assertEquals(testResult.toString(),result.toString());
    formatArg=new StringEval("dd:mm:yyyy hh:mm:ss");
    args[1]=formatArg;
    result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
    testResult=new StringEval("16:11:1900 07:42:14");
    assertEquals(testResult.toString(),result.toString());
    DateFormatSymbols dfs=DateFormatSymbols.getInstance(LocaleUtil.getUserLocale());
    SimpleDateFormat sdf=new SimpleDateFormat("MMMM",dfs);
    sdf.setTimeZone(LocaleUtil.getUserTimeZone());
    String november=sdf.format(LocaleUtil.getLocaleCalendar(2015,10,1).getTime());
    formatArg=new StringEval("MMMM dd, yyyy");
    args[1]=formatArg;
    result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
    testResult=new StringEval(november + " 16, 1900");
    assertEquals(testResult.toString(),result.toString());
    formatArg=new StringEval("mmmm dd, yyyy");
    args[1]=formatArg;
    result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
    testResult=new StringEval(november + " 16, 1900");
    assertEquals(testResult.toString(),result.toString());
  }
  finally {
    LocaleUtil.setUserTimeZone(userTZ);
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTextWithStringFirstArg(){
  ValueEval strArg=new StringEval("abc");
  ValueEval formatArg=new StringEval("abc");
  ValueEval[] args={strArg,formatArg};
  ValueEval result=TextFunction.TEXT.evaluate(args,-1,(short)-1);
  assertEquals(ErrorEval.VALUE_INVALID,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.ptg.TestExternalFunctionFormulas </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("externalFunctionExample.xls");
  Ptg[] ptgs=HSSFFormulaParser.parse("YEARFRAC(B1,C1)",wb);
  assertEquals(4,ptgs.length);
  assertEquals(NameXPtg.class,ptgs[0].getClass());
  wb.getSheetAt(0).getRow(0).createCell(6).setCellFormula("YEARFRAC(C1,B1)");
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestBugzillaIssues </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * =ISNUMBER(SEARCH("AM",A1)) evaluation
 */
@Test public void stackoverflow26437323() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet s=wb.createSheet();
  Row r1=s.createRow(0);
  Row r2=s.createRow(1);
  r1.createCell(0).setCellValue(1.1);
  r1.createCell(1).setCellValue("This is text with AM in it");
  r1.createCell(2).setCellValue("This some other text");
  r1.createCell(3,Cell.CELL_TYPE_BLANK);
  Cell cf=r2.createCell(0,Cell.CELL_TYPE_FORMULA);
  cf.setCellFormula("TRUE()");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISLOGICAL(TRUE())");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISLOGICAL(4)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(A1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(B1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(C1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(D1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(E1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISTEXT(A1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISTEXT(B1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISTEXT(C1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISTEXT(D1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISTEXT(E1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNONTEXT(A1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISNONTEXT(B1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNONTEXT(C1)");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNONTEXT(D1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISNONTEXT(E1)");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("SEARCH(\"am\", A1)");
  cf=evaluateCell(wb,cf);
  assertEquals(FormulaError.VALUE.getCode(),cf.getErrorCellValue());
  cf.setCellFormula("SEARCH(\"am\", B1)");
  cf=evaluateCell(wb,cf);
  assertEquals(19,(int)cf.getNumericCellValue());
  cf.setCellFormula("SEARCH(\"am\", C1)");
  cf=evaluateCell(wb,cf);
  assertEquals(FormulaError.VALUE.getCode(),cf.getErrorCellValue());
  cf.setCellFormula("SEARCH(\"am\", D1)");
  cf=evaluateCell(wb,cf);
  assertEquals(FormulaError.VALUE.getCode(),cf.getErrorCellValue());
  cf.setCellFormula("ISNUMBER(SEARCH(\"am\", A1))");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(SEARCH(\"am\", B1))");
  cf=evaluateCell(wb,cf);
  assertEquals(true,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(SEARCH(\"am\", C1))");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(SEARCH(\"am\", D1))");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  cf.setCellFormula("ISNUMBER(SEARCH(\"am\", E1))");
  cf=evaluateCell(wb,cf);
  assertEquals(false,cf.getBooleanCellValue());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void bug50681_testAutoSize() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  BaseTestSheetAutosizeColumn.fixFonts(wb);
  Sheet sheet=wb.createSheet("Sheet1");
  trackColumnsForAutoSizingIfSXSSF(sheet);
  Row row=sheet.createRow(0);
  Cell cell0=row.createCell(0);
  String longValue="www.hostname.com, www.hostname.com, " + "www.hostname.com, www.hostname.com, www.hostname.com, " + "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com";
  cell0.setCellValue(longValue);
  Font font=wb.getFontAt(cell0.getCellStyle().getFontIndex());
  Assume.assumeTrue("Cannot verify autoSizeColumn() because the necessary Fonts are not installed on this machine: " + font,SheetUtil.canComputeColumnWidth(font));
  assertEquals("Expecting no indentation in this test",0,cell0.getCellStyle().getIndention());
  assertEquals("Expecting no rotation in this test",0,cell0.getCellStyle().getRotation());
  double widthManual=computeCellWidthManually(cell0,font);
  double widthBeforeCell=SheetUtil.getCellWidth(cell0,8,null,false);
  double widthBeforeCol=SheetUtil.getColumnWidth(sheet,0,false);
  String info=widthManual + "/" + widthBeforeCell+ "/"+ widthBeforeCol+ "/"+ SheetUtil.canComputeColumnWidth(font)+ "/"+ computeCellWidthFixed(font,"1")+ "/"+ computeCellWidthFixed(font,"w")+ "/"+ computeCellWidthFixed(font,"1w")+ "/"+ computeCellWidthFixed(font,"0000")+ "/"+ computeCellWidthFixed(font,longValue);
  assertTrue("Expected to have cell width > 0 when computing manually, but had " + info,widthManual > 0);
  assertTrue("Expected to have cell width > 0 BEFORE auto-size, but had " + info,widthBeforeCell > 0);
  assertTrue("Expected to have column width > 0 BEFORE auto-size, but had " + info,widthBeforeCol > 0);
  sheet.autoSizeColumn(0);
  double width=SheetUtil.getColumnWidth(sheet,0,false);
  assertTrue("Expected to have column width > 0 AFTER auto-size, but had " + width,width > 0);
  width=SheetUtil.getCellWidth(cell0,8,null,false);
  assertTrue("Expected to have cell width > 0 AFTER auto-size, but had " + width,width > 0);
  assertEquals(255 * 256,sheet.getColumnWidth(0));
  sheet.setColumnWidth(0,sheet.getColumnWidth(0));
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestCellComment </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void create() throws IOException {
  String cellText="Hello, World";
  String commentText="We can set comments in POI";
  String commentAuthor="Apache Software Foundation";
  int cellRow=3;
  int cellColumn=1;
  Workbook wb1=_testDataProvider.createWorkbook();
  CreationHelper factory=wb1.getCreationHelper();
  Sheet sheet=wb1.createSheet();
  assertNull(sheet.getCellComment(cellRow,cellColumn));
  Cell cell=sheet.createRow(cellRow).createCell(cellColumn);
  cell.setCellValue(factory.createRichTextString(cellText));
  assertNull(cell.getCellComment());
  assertNull(sheet.getCellComment(cellRow,cellColumn));
  Drawing patr=sheet.createDrawingPatriarch();
  ClientAnchor anchor=factory.createClientAnchor();
  anchor.setCol1(2);
  anchor.setCol2(5);
  anchor.setRow1(1);
  anchor.setRow2(2);
  Comment comment=patr.createCellComment(anchor);
  assertFalse(comment.isVisible());
  comment.setVisible(true);
  assertTrue(comment.isVisible());
  RichTextString string1=factory.createRichTextString(commentText);
  comment.setString(string1);
  comment.setAuthor(commentAuthor);
  cell.setCellComment(comment);
  assertNotNull(cell.getCellComment());
  assertNotNull(sheet.getCellComment(cellRow,cellColumn));
  assertEquals(commentAuthor,comment.getAuthor());
  assertEquals(commentText,comment.getString().getString());
  assertEquals(cellRow,comment.getRow());
  assertEquals(cellColumn,comment.getColumn());
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  cell=sheet.getRow(cellRow).getCell(cellColumn);
  comment=cell.getCellComment();
  assertNotNull(comment);
  assertEquals(commentAuthor,comment.getAuthor());
  assertEquals(commentText,comment.getString().getString());
  assertEquals(cellRow,comment.getRow());
  assertEquals(cellColumn,comment.getColumn());
  assertTrue(comment.isVisible());
  comment.setString(factory.createRichTextString("New Comment Text"));
  comment.setVisible(false);
  Workbook wb3=_testDataProvider.writeOutAndReadBack(wb2);
  wb2.close();
  sheet=wb3.getSheetAt(0);
  cell=sheet.getRow(cellRow).getCell(cellColumn);
  comment=cell.getCellComment();
  assertNotNull(comment);
  assertEquals(commentAuthor,comment.getAuthor());
  assertEquals("New Comment Text",comment.getString().getString());
  assertEquals(cellRow,comment.getRow());
  assertEquals(cellColumn,comment.getColumn());
  assertFalse(comment.isVisible());
  wb3.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestHyperlink </h4><pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyHyperlink() throws IOException {
  final Workbook wb=_testDataProvider.createWorkbook();
  final CreationHelper createHelper=wb.getCreationHelper();
  final Sheet sheet=wb.createSheet("Hyperlinks");
  final Row row=sheet.createRow(0);
  final Cell cell1, cell2;
  final Hyperlink link1, link2;
  cell1=row.createCell(0);
  cell2=row.createCell(1);
  cell1.setCellValue("URL Link");
  link1=createHelper.createHyperlink(Hyperlink.LINK_URL);
  link1.setAddress("http://poi.apache.org/");
  cell1.setHyperlink(link1);
  link2=copyHyperlink(link1);
  link2.setAddress("http://apache.org/");
  cell2.setHyperlink(link2);
  assertNotSame(link1,link2);
  assertNotEquals(link1,link2);
  assertEquals("http://poi.apache.org/",link1.getAddress());
  assertEquals("http://apache.org/",link2.getAddress());
  assertEquals(link1,cell1.getHyperlink());
  assertEquals(link2,cell2.getHyperlink());
  @SuppressWarnings("unchecked") final List<Hyperlink> actualHyperlinks=(List<Hyperlink>)sheet.getHyperlinkList();
  assertEquals(2,actualHyperlinks.size());
  assertEquals(link1,actualHyperlinks.get(0));
  assertEquals(link2,actualHyperlinks.get(1));
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheet </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getCellComments() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet("TEST");
  Drawing dg=sheet.createDrawingPatriarch();
  ClientAnchor anchor=workbook.getCreationHelper().createClientAnchor();
  int nRows=5;
  int nCols=6;
  for (int r=0; r < nRows; r++) {
    sheet.createRow(r);
    for (int c=nCols - 1; c >= 0; c--) {
      anchor.setCol1(c);
      anchor.setCol2(c);
      anchor.setRow1(r);
      anchor.setRow2(r);
      Comment comment=dg.createCellComment(anchor);
      Cell cell=sheet.getRow(r).createCell(c);
      comment.setAuthor("Author " + r);
      RichTextString text=workbook.getCreationHelper().createRichTextString("Test comment at row=" + r + ", column="+ c);
      comment.setString(text);
      cell.setCellComment(comment);
    }
  }
  Workbook wb=_testDataProvider.writeOutAndReadBack(workbook);
  Sheet sh=wb.getSheet("TEST");
  Map<CellAddress,? extends Comment> cellComments=sh.getCellComments();
  assertEquals(nRows * nCols,cellComments.size());
  for (  Entry<CellAddress,? extends Comment> e : cellComments.entrySet()) {
    CellAddress ref=e.getKey();
    Comment aComment=e.getValue();
    assertEquals("Author " + ref.getRow(),aComment.getAuthor());
    String text="Test comment at row=" + ref.getRow() + ", column="+ ref.getColumn();
    assertEquals(text,aComment.getString().getString());
  }
  workbook.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createRow() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  assertEquals(0,sheet.getPhysicalNumberOfRows());
  assertNull(sheet.getRow(1));
  Row row1=sheet.createRow(0);
  Row row2=sheet.createRow(1);
  assertEquals(0,row1.getRowNum());
  assertEquals(1,row2.getRowNum());
  Iterator<Row> it=sheet.rowIterator();
  assertTrue(it.hasNext());
  assertSame(row1,it.next());
  assertTrue(it.hasNext());
  assertSame(row2,it.next());
  assertEquals(1,sheet.getLastRowNum());
  Row row101=sheet.createRow(100);
  assertNotNull(row101);
  assertEquals(100,sheet.getLastRowNum());
  assertEquals(3,sheet.getPhysicalNumberOfRows());
  Row row2_ovrewritten=sheet.createRow(1);
  Cell cell=row2_ovrewritten.createCell(0);
  cell.setCellValue(100);
  Iterator<Row> it2=sheet.rowIterator();
  assertTrue(it2.hasNext());
  assertSame(row1,it2.next());
  assertTrue(it2.hasNext());
  Row row2_ovrewritten_ref=it2.next();
  assertSame(row2_ovrewritten,row2_ovrewritten_ref);
  assertEquals(100.0,row2_ovrewritten_ref.getCell(0).getNumericCellValue(),0.0);
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetShiftRows </h4><pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testShiftSharedFormulasBug54206() throws IOException {
  Workbook wb=_testDataProvider.openSampleWorkbook("54206." + _testDataProvider.getStandardFileNameExtension());
  Sheet sheet=wb.getSheetAt(0);
  assertEquals("SUMIF($B$19:$B$82,$B4,G$19:G$82)",sheet.getRow(3).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B4,H$19:H$82)",sheet.getRow(3).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B4,I$19:I$82)",sheet.getRow(3).getCell(8).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,G$19:G$82)",sheet.getRow(14).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,H$19:H$82)",sheet.getRow(14).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$82,$B15,I$19:I$82)",sheet.getRow(14).getCell(8).getCellFormula());
  for (int i=3; i <= 14; i++) {
    for (int j=6; j <= 8; j++) {
      String col=CellReference.convertNumToColString(j);
      String expectedFormula="SUMIF($B$19:$B$82,$B" + (i + 1) + ","+ col+ "$19:"+ col+ "$82)";
      assertEquals(expectedFormula,sheet.getRow(i).getCell(j).getCellFormula());
    }
  }
  assertEquals("SUM(G24:I24)",sheet.getRow(23).getCell(9).getCellFormula());
  assertEquals("SUM(G25:I25)",sheet.getRow(24).getCell(9).getCellFormula());
  assertEquals("SUM(G26:I26)",sheet.getRow(25).getCell(9).getCellFormula());
  sheet.shiftRows(24,sheet.getLastRowNum(),4,true,false);
  assertEquals("SUMIF($B$19:$B$86,$B4,G$19:G$86)",sheet.getRow(3).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B4,H$19:H$86)",sheet.getRow(3).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B4,I$19:I$86)",sheet.getRow(3).getCell(8).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,G$19:G$86)",sheet.getRow(14).getCell(6).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,H$19:H$86)",sheet.getRow(14).getCell(7).getCellFormula());
  assertEquals("SUMIF($B$19:$B$86,$B15,I$19:I$86)",sheet.getRow(14).getCell(8).getCellFormula());
  for (int i=3; i <= 14; i++) {
    for (int j=6; j <= 8; j++) {
      String col=CellReference.convertNumToColString(j);
      String expectedFormula="SUMIF($B$19:$B$86,$B" + (i + 1) + ","+ col+ "$19:"+ col+ "$86)";
      assertEquals(expectedFormula,sheet.getRow(i).getCell(j).getCellFormula());
    }
  }
  assertEquals("SUM(G24:I24)",sheet.getRow(23).getCell(9).getCellFormula());
  assertTrue(sheet.getRow(24) == null || sheet.getRow(24).getCell(9) == null);
  assertTrue(sheet.getRow(25) == null || sheet.getRow(25).getCell(9) == null);
  assertTrue(sheet.getRow(26) == null || sheet.getRow(26).getCell(9) == null);
  assertTrue(sheet.getRow(27) == null || sheet.getRow(27).getCell(9) == null);
  assertEquals("SUM(G29:I29)",sheet.getRow(28).getCell(9).getCellFormula());
  assertEquals("SUM(G30:I30)",sheet.getRow(29).getCell(9).getCellFormula());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestWorkbook </h4><pre class="type-2 type-10 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * POI allows creating sheets with names longer than 31 characters.
 * Excel opens files with long sheet names without error or warning.
 * However, long sheet names are silently truncated to 31 chars.  In order to
 * avoid funny duplicate sheet name errors, POI enforces uniqueness on only the first 31 chars.
 * but for the purpose of uniqueness long sheet names are silently truncated to 31 chars.
 */
@Test public void createSheetWithLongNames() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  String sheetName1="My very long sheet name which is longer than 31 chars";
  String truncatedSheetName1=sheetName1.substring(0,31);
  Sheet sh1=wb1.createSheet(sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  wb1.setSheetName(0,sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  String sheetName2="My very long sheet name which is longer than 31 chars " + "and sheetName2.substring(0, 31) == sheetName1.substring(0, 31)";
  try {
    wb1.createSheet(sheetName2);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String sheetName3="POI allows creating sheets with names longer than 31 characters";
  String truncatedSheetName3=sheetName3.substring(0,31);
  Sheet sh3=wb1.createSheet(sheetName3);
  assertEquals(truncatedSheetName3,sh3.getSheetName());
  assertSame(sh3,wb1.getSheet(truncatedSheetName3));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(2,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex(truncatedSheetName1));
  assertEquals(1,wb2.getSheetIndex(truncatedSheetName3));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestXCell </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testXmlEncoding(){
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sh=wb.createSheet();
  Row row=sh.createRow(0);
  Cell cell=row.createCell(0);
  String sval="\u0000\u0002\u0012<>\t\n\u00a0 &\"POI\'\u2122";
  cell.setCellValue(sval);
  wb=_testDataProvider.writeOutAndReadBack(wb);
  assertEquals("???<>\t\n\u00a0 &\"POI\'\u2122",wb.getSheetAt(0).getRow(0).getCell(0).getStringCellValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.TestDateUtil </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getJavaCalendar_ValidValue(){
  double dateValue=0;
  TimeZone tz=LocaleUtil.getUserTimeZone();
  boolean use1904windowing=false;
  boolean roundSeconds=false;
  Calendar expCal=LocaleUtil.getLocaleCalendar(1900,0,0);
  Calendar actCal[]={DateUtil.getJavaCalendar(dateValue),DateUtil.getJavaCalendar(dateValue,use1904windowing),DateUtil.getJavaCalendar(dateValue,use1904windowing,tz),DateUtil.getJavaCalendar(dateValue,use1904windowing,tz,roundSeconds)};
  assertEquals(expCal,actCal[0]);
  assertEquals(expCal,actCal[1]);
  assertEquals(expCal,actCal[2]);
  assertEquals(expCal,actCal[3]);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getJavaDate_ValidValue(){
  double dateValue=0;
  TimeZone tz=LocaleUtil.getUserTimeZone();
  boolean use1904windowing=false;
  boolean roundSeconds=false;
  Calendar calendar=LocaleUtil.getLocaleCalendar(1900,0,0);
  Date date=calendar.getTime();
  assertEquals(date,DateUtil.getJavaDate(dateValue));
  assertEquals(date,DateUtil.getJavaDate(dateValue,tz));
  assertEquals(date,DateUtil.getJavaDate(dateValue,use1904windowing));
  assertEquals(date,DateUtil.getJavaDate(dateValue,use1904windowing,tz));
  assertEquals(date,DateUtil.getJavaDate(dateValue,use1904windowing,tz,roundSeconds));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.TestFractionFormat </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTruthFile() throws Exception {
  File truthFile=HSSFTestDataSamples.getSampleFile("54686_fraction_formats.txt");
  BufferedReader reader=new BufferedReader(new InputStreamReader(new FileInputStream(truthFile),LocaleUtil.CHARSET_1252));
  Workbook wb=HSSFTestDataSamples.openSampleWorkbook("54686_fraction_formats.xls");
  Sheet sheet=wb.getSheetAt(0);
  DataFormatter formatter=new DataFormatter();
  FormulaEvaluator evaluator=wb.getCreationHelper().createFormulaEvaluator();
  String truthLine=reader.readLine();
  String[] headers=truthLine.split("\t");
  truthLine=reader.readLine();
  for (int i=1; i < sheet.getLastRowNum() && truthLine != null; i++) {
    Row r=sheet.getRow(i);
    String[] truths=truthLine.split("\t");
    for (short j=3; j < 12; j++) {
      Cell cell=r.getCell(j,Row.CREATE_NULL_AS_BLANK);
      String formatted=clean(formatter.formatCellValue(cell,evaluator));
      if (truths.length <= j) {
        continue;
      }
      String truth=clean(truths[j]);
      String testKey=truths[0] + ":" + truths[1]+ ":"+ headers[j];
      assertEquals(testKey,truth,formatted);
    }
    truthLine=reader.readLine();
  }
  wb.close();
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.util.TestCellUtil </h4><pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createCell() throws IOException {
  Workbook wb=new HSSFWorkbook();
  Sheet sh=wb.createSheet();
  Row row=sh.createRow(0);
  CellStyle style=wb.createCellStyle();
  style.setWrapText(true);
  Cell F1=CellUtil.createCell(row,5,"Cell Value",style);
  assertSame(row.getCell(5),F1);
  assertEquals("Cell Value",F1.getStringCellValue());
  assertEquals(style,F1.getCellStyle());
  Cell f1=CellUtil.createCell(row,5,"Overwritten cell value",null);
  assertSame(row.getCell(5),f1);
  assertSame(F1,f1);
  assertEquals("Overwritten cell value",f1.getStringCellValue());
  assertEquals("Overwritten cell value",F1.getStringCellValue());
  assertEquals("cell style should be unchanged with createCell(..., null)",style,f1.getCellStyle());
  assertEquals("cell style should be unchanged with createCell(..., null)",style,F1.getCellStyle());
  f1=CellUtil.createCell(row,5,"Overwritten cell with default style");
  assertSame(F1,f1);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getCell() throws IOException {
  Workbook wb=new HSSFWorkbook();
  Sheet sh=wb.createSheet();
  Row row=sh.createRow(0);
  Cell A1=row.createCell(0);
  Cell a1=CellUtil.getCell(row,0);
  assertNotNull(a1);
  assertSame("An existing cell should not be recreated",A1,a1);
  assertNotNull(CellUtil.getCell(row,1));
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getRow() throws IOException {
  Workbook wb=new HSSFWorkbook();
  Sheet sh=wb.createSheet();
  Row row1=sh.createRow(0);
  Row r1=CellUtil.getRow(0,sh);
  assertNotNull(r1);
  assertSame("An existing row should not be recreated",row1,r1);
  assertNotNull(CellUtil.getRow(1,sh));
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.util.TestNumberComparer </h4><pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoundTripOnComparisonExamples(){
  ComparisonExample[] examples=NumberComparisonExamples.getComparisonExamples();
  boolean success=true;
  for (int i=0; i < examples.length; i++) {
    ComparisonExample ce=examples[i];
    success&=confirmRoundTrip(i,ce.getA());
    success&=confirmRoundTrip(i,ce.getNegA());
    success&=confirmRoundTrip(i,ce.getB());
    success&=confirmRoundTrip(i,ce.getNegB());
  }
  assertTrue("One or more cases failed.  See stderr",success);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAllComparisonExamples(){
  ComparisonExample[] examples=NumberComparisonExamples.getComparisonExamples();
  boolean success=true;
  for (int i=0; i < examples.length; i++) {
    ComparisonExample ce=examples[i];
    success&=confirm(i,ce.getA(),ce.getB(),+ce.getExpectedResult());
    success&=confirm(i,ce.getB(),ce.getA(),-ce.getExpectedResult());
    success&=confirm(i,ce.getNegA(),ce.getNegB(),-ce.getExpectedResult());
    success&=confirm(i,ce.getNegB(),ce.getNegA(),+ce.getExpectedResult());
  }
  assertTrue("One or more cases failed.  See stderr",success);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.util.TestHexDump </h4><pre class="type-2 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDump() throws IOException {
  byte[] testArray=testArray();
  ByteArrayOutputStream streamAct=new ByteArrayOutputStream();
  HexDump.dump(testArray,0,streamAct,0);
  byte bytesAct[]=streamAct.toByteArray();
  byte bytesExp[]=toHexDump(0,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0x10000000L,streamAct,0);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0x10000000L,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0xFF000000L,streamAct,0);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0xFF000000L,0);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  streamAct.reset();
  HexDump.dump(testArray,0xFF000000L,streamAct,0x81);
  bytesAct=streamAct.toByteArray();
  bytesExp=toHexDump(0xFF000000L,0x81);
  assertEquals("array size mismatch",bytesExp.length,bytesAct.length);
  assertArrayEquals("array mismatch",bytesExp,bytesAct);
  try {
    streamAct.reset();
    HexDump.dump(testArray,0x10000000L,streamAct,-1);
    fail("should have caught ArrayIndexOutOfBoundsException on negative index");
  }
 catch (  ArrayIndexOutOfBoundsException ignored_exception) {
  }
  try {
    streamAct.reset();
    HexDump.dump(testArray,0x10000000L,streamAct,testArray.length);
    fail("should have caught ArrayIndexOutOfBoundsException on large index");
  }
 catch (  ArrayIndexOutOfBoundsException ignored_exception) {
  }
  try {
    HexDump.dump(testArray,0x10000000L,null,0);
    fail("should have caught IllegalArgumentException on negative index");
  }
 catch (  IllegalArgumentException ignored_exception) {
  }
  streamAct.reset();
  HexDump.dump(new byte[0],0,streamAct,0);
  assertEquals("No Data" + System.getProperty("line.separator"),streamAct.toString(LocaleUtil.CHARSET_1252.name()));
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDumpToPrintStream() throws IOException {
  byte[] testArray=testArray();
  ByteArrayOutputStream byteOut=new ByteArrayOutputStream();
  PrintStream out=new PrintStream(byteOut,true,LocaleUtil.CHARSET_1252.name());
  ByteArrayInputStream byteIn=new ByteArrayInputStream(testArray);
  byteIn.mark(256);
  String str;
  byteIn.reset();
  byteOut.reset();
  HexDump.dump(byteIn,out,0,256);
  str=new String(byteOut.toByteArray(),LocaleUtil.CHARSET_1252);
  assertTrue("Had: \n" + str,str.contains("0123456789:;<=>?"));
  byteIn.reset();
  byteOut.reset();
  HexDump.dump(byteIn,out,0,1000);
  str=new String(byteOut.toByteArray(),LocaleUtil.CHARSET_1252);
  assertTrue("Had: \n" + str,str.contains("0123456789:;<=>?"));
  byteIn.reset();
  byteOut.reset();
  HexDump.dump(byteIn,out,0,-1);
  str=new String(byteOut.toByteArray(),LocaleUtil.CHARSET_1252);
  assertTrue("Had: \n" + str,str.contains("0123456789:;<=>?"));
  byteIn.reset();
  byteOut.reset();
  HexDump.dump(byteIn,out,1,235);
  str=new String(byteOut.toByteArray(),LocaleUtil.CHARSET_1252);
  assertTrue("Line contents should be moved by one now, but Had: \n" + str,str.contains("123456789:;<=>?@"));
  byteIn.close();
  byteOut.close();
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDumpToString() throws Exception {
  byte[] testArray=testArray();
  String dump=HexDump.dump(testArray,0,0);
  assertTrue("Had: \n" + dump,dump.contains("0123456789:;<=>?"));
  dump=HexDump.dump(testArray,2,1);
  assertTrue("Had: \n" + dump,dump.contains("123456789:;<=>?@"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.TestXSLFBugs </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug51187() throws Exception {
  XMLSlideShow ss1=XSLFTestDataSamples.openSampleDocument("51187.pptx");
  assertEquals(1,ss1.getSlides().size());
  XSLFSlide slide0=ss1.getSlides().get(0);
  assertRelation(slide0,"/ppt/slides/slide1.xml",null);
  assertRelation(slide0,"/ppt/slideLayouts/slideLayout12.xml","rId1");
  assertRelation(slide0,"/ppt/notesSlides/notesSlide1.xml","rId2");
  assertRelation(slide0,"/ppt/slides/slide1.xml","rId3");
  assertRelation(slide0,"/ppt/media/image1.png","rId4");
  XMLSlideShow ss2=XSLFTestDataSamples.writeOutAndReadBack(ss1);
  ss1.close();
  assertEquals(1,ss2.getSlides().size());
  slide0=ss2.getSlides().get(0);
  assertRelation(slide0,"/ppt/slides/slide1.xml",null);
  assertRelation(slide0,"/ppt/slideLayouts/slideLayout12.xml","rId1");
  assertRelation(slide0,"/ppt/notesSlides/notesSlide1.xml","rId2");
  assertRelation(slide0,"/ppt/slides/slide1.xml","rId3");
  assertRelation(slide0,"/ppt/media/image1.png","rId4");
  ss2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When working with >9 images, make sure the sorting ensures
 * that image10.foo isn't between image1.foo and image2.foo
 */
@Test public void test57552() throws Exception {
  XMLSlideShow ss=new XMLSlideShow();
  for (  String s : new String[]{"Slide1","Slide2"}) {
    ss.createSlide().createTextBox().setText(s);
  }
  XSLFSlide slide=ss.getSlides().get(0);
  assertEquals(0,ss.getPictureData().size());
  assertEquals(1,slide.getShapes().size());
  assertEquals(1,slide.getRelations().size());
  assertRelationEquals(XSLFRelation.SLIDE_LAYOUT,slide.getRelations().get(0));
  byte[][] pics=new byte[15][3];
  for (int i=0; i < pics.length; i++) {
    for (int j=0; j < pics[i].length; j++) {
      pics[i][j]=(byte)i;
    }
  }
  for (int i=0; i < 10; i++) {
    XSLFPictureData data=ss.addPicture(pics[i],PictureType.JPEG);
    assertEquals(i,data.getIndex());
    assertEquals(i + 1,ss.getPictureData().size());
    XSLFPictureShape shape=slide.createPicture(data);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
    assertEquals(i + 2,slide.getShapes().size());
  }
  for (int i=0; i < 10; i++) {
    XSLFPictureShape shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  for (int i=10; i < 15; i++) {
    XSLFPictureData data=ss.addPicture(pics[i],PictureType.JPEG);
    assertEquals(i,data.getIndex());
    assertEquals(i + 1,ss.getPictureData().size());
    XSLFPictureShape shape=slide.createPicture(data);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
    assertEquals(i + 2,slide.getShapes().size());
  }
  for (int i=0; i < 15; i++) {
    XSLFPictureShape shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  XSLFPictureData data=ss.addPicture(pics[3],PictureType.JPEG);
  assertEquals(3,data.getIndex());
  assertEquals(15,ss.getPictureData().size());
  XSLFPictureShape shape=slide.createPicture(data);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[3],shape.getPictureData().getData());
  assertEquals(17,slide.getShapes().size());
  XMLSlideShow ss2=XSLFTestDataSamples.writeOutAndReadBack(ss);
  slide=ss2.getSlides().get(0);
  for (int i=0; i < 15; i++) {
    shape=(XSLFPictureShape)slide.getShapes().get(i + 1);
    assertNotNull(shape.getPictureData());
    assertArrayEquals(pics[i],shape.getPictureData().getData());
  }
  shape=(XSLFPictureShape)slide.getShapes().get(16);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[3],shape.getPictureData().getData());
  data=ss2.addPicture(pics[5],PictureType.JPEG);
  assertEquals(5,data.getIndex());
  assertEquals(15,ss2.getPictureData().size());
  shape=slide.createPicture(data);
  assertNotNull(shape.getPictureData());
  assertArrayEquals(pics[5],shape.getPictureData().getData());
  assertEquals(18,slide.getShapes().size());
  ss2.close();
  ss.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFHyperlink </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws IOException, InvalidFormatException {
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide1=ppt.createSlide();
  XSLFSlide slide2=ppt.createSlide();
  int numRel=slide1.getPackagePart().getRelationships().size();
  assertEquals(1,numRel);
  XSLFTextBox sh1=slide1.createTextBox();
  XSLFTextRun r1=sh1.addNewTextParagraph().addNewTextRun();
  r1.setText("Web Page");
  XSLFHyperlink link1=r1.createHyperlink();
  link1.setAddress("http://poi.apache.org/");
  assertEquals("http://poi.apache.org/",link1.getAddress());
  assertEquals(numRel + 1,slide1.getPackagePart().getRelationships().size());
  String id1=link1.getXmlObject().getId();
  assertNotNull(id1);
  PackageRelationship rel1=slide1.getPackagePart().getRelationship(id1);
  assertNotNull(rel1);
  assertEquals(id1,rel1.getId());
  assertEquals(TargetMode.EXTERNAL,rel1.getTargetMode());
  assertEquals(XSLFRelation.HYPERLINK.getRelation(),rel1.getRelationshipType());
  XSLFTextBox sh2=slide1.createTextBox();
  XSLFTextRun r2=sh2.addNewTextParagraph().addNewTextRun();
  r2.setText("Place in this document");
  XSLFHyperlink link2=r2.createHyperlink();
  link2.linkToSlide(slide2);
  assertEquals("/ppt/slides/slide2.xml",link2.getAddress());
  assertEquals(numRel + 2,slide1.getPackagePart().getRelationships().size());
  String id2=link2.getXmlObject().getId();
  assertNotNull(id2);
  PackageRelationship rel2=slide1.getPackagePart().getRelationship(id2);
  assertNotNull(rel2);
  assertEquals(id2,rel2.getId());
  assertEquals(TargetMode.INTERNAL,rel2.getTargetMode());
  assertEquals(XSLFRelation.SLIDE.getRelation(),rel2.getRelationshipType());
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug47291() throws IOException {
  Rectangle2D anchor=new Rectangle2D.Double(100,100,100,100);
  XMLSlideShow ppt1=new XMLSlideShow();
  XSLFSlide slide1=ppt1.createSlide();
  XSLFTextBox tb1=slide1.createTextBox();
  tb1.setAnchor(anchor);
  XSLFTextRun r1=tb1.setText("page1");
  XSLFHyperlink hl1=r1.createHyperlink();
  hl1.linkToEmail("dev@poi.apache.org");
  XSLFTextBox tb2=ppt1.createSlide().createTextBox();
  tb2.setAnchor(anchor);
  XSLFTextRun r2=tb2.setText("page2");
  XSLFHyperlink hl2=r2.createHyperlink();
  hl2.linkToLastSlide();
  XSLFSlide sl3=ppt1.createSlide();
  XSLFTextBox tb3=sl3.createTextBox();
  tb3.setAnchor(anchor);
  tb3.setText("text1 ");
  XSLFTextRun r3=tb3.appendText("lin\u000bk",false);
  tb3.appendText(" text2",false);
  XSLFHyperlink hl3=r3.createHyperlink();
  hl3.linkToSlide(slide1);
  XSLFTextBox tb4=ppt1.createSlide().createTextBox();
  tb4.setAnchor(anchor);
  XSLFTextRun r4=tb4.setText("page4");
  XSLFHyperlink hl4=r4.createHyperlink();
  hl4.linkToUrl("http://poi.apache.org");
  XSLFTextBox tb5=ppt1.createSlide().createTextBox();
  tb5.setAnchor(anchor);
  tb5.setText("page5");
  XSLFHyperlink hl5=tb5.createHyperlink();
  hl5.linkToFirstSlide();
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  List<XSLFSlide> slides=ppt2.getSlides();
  tb1=(XSLFTextBox)slides.get(0).getShapes().get(0);
  hl1=tb1.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl1);
  assertEquals("dev@poi.apache.org",hl1.getLabel());
  assertEquals(Hyperlink.LINK_EMAIL,hl1.getType());
  tb2=(XSLFTextBox)slides.get(1).getShapes().get(0);
  hl2=tb2.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl2);
  assertEquals("lastslide",hl2.getXmlObject().getAction().split("=")[1]);
  assertEquals(Hyperlink.LINK_DOCUMENT,hl2.getType());
  tb3=(XSLFTextBox)slides.get(2).getShapes().get(0);
  hl3=tb3.getTextParagraphs().get(0).getTextRuns().get(3).getHyperlink();
  assertNotNull(hl3);
  assertEquals("/ppt/slides/slide1.xml",hl3.getAddress());
  assertEquals(Hyperlink.LINK_DOCUMENT,hl3.getType());
  tb4=(XSLFTextBox)slides.get(3).getShapes().get(0);
  hl4=tb4.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(hl4);
  assertEquals("http://poi.apache.org",hl4.getLabel());
  assertEquals(Hyperlink.LINK_URL,hl4.getType());
  tb5=(XSLFTextBox)slides.get(4).getShapes().get(0);
  hl5=tb5.getHyperlink();
  assertNotNull(hl5);
  assertEquals("firstslide",hl5.getXmlObject().getAction().split("=")[1]);
  assertEquals(Hyperlink.LINK_DOCUMENT,hl5.getType());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  XSLFSlide slide=ppt.getSlides().get(4);
  List<XSLFShape> shapes=slide.getShapes();
  XSLFTable tbl=(XSLFTable)shapes.get(0);
  XSLFTableCell cell1=tbl.getRows().get(1).getCells().get(0);
  assertEquals("Web Page",cell1.getText());
  XSLFHyperlink link1=cell1.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(link1);
  assertEquals("http://poi.apache.org/",link1.getAddress());
  XSLFTableCell cell2=tbl.getRows().get(2).getCells().get(0);
  assertEquals("Place in this document",cell2.getText());
  XSLFHyperlink link2=cell2.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(link2);
  assertEquals("/ppt/slides/slide2.xml",link2.getAddress());
  XSLFTableCell cell3=tbl.getRows().get(3).getCells().get(0);
  assertEquals("Email",cell3.getText());
  XSLFHyperlink link3=cell3.getTextParagraphs().get(0).getTextRuns().get(0).getHyperlink();
  assertNotNull(link3);
  assertEquals("mailto:dev@poi.apache.org?subject=Hi%20There",link3.getAddress());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFPictureShape </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  XMLSlideShow ppt1=new XMLSlideShow();
  assertEquals(0,ppt1.getPictureData().size());
  byte[] data1=new byte[100];
  for (int i=0; i < 100; i++) {
    data1[i]=(byte)i;
  }
  XSLFPictureData pdata1=ppt1.addPicture(data1,PictureType.JPEG);
  assertEquals(0,pdata1.getIndex());
  assertEquals(1,ppt1.getPictureData().size());
  XSLFSlide slide=ppt1.createSlide();
  XSLFPictureShape shape1=slide.createPicture(pdata1);
  assertNotNull(shape1.getPictureData());
  assertArrayEquals(data1,shape1.getPictureData().getData());
  byte[] data2=new byte[200];
  for (int i=0; i < 200; i++) {
    data2[i]=(byte)i;
  }
  XSLFPictureData pdata2=ppt1.addPicture(data2,PictureType.PNG);
  XSLFPictureShape shape2=slide.createPicture(pdata2);
  assertNotNull(shape2.getPictureData());
  assertEquals(1,pdata2.getIndex());
  assertEquals(2,ppt1.getPictureData().size());
  assertArrayEquals(data2,shape2.getPictureData().getData());
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  List<XSLFPictureData> pics=ppt2.getPictureData();
  assertEquals(2,pics.size());
  assertArrayEquals(data1,pics.get(0).getData());
  assertArrayEquals(data2,pics.get(1).getData());
  List<XSLFShape> shapes=ppt2.getSlides().get(0).getShapes();
  assertArrayEquals(data1,((XSLFPictureShape)shapes.get(0)).getPictureData().getData());
  assertArrayEquals(data2,((XSLFPictureShape)shapes.get(1)).getPictureData().getData());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateMultiplePictures() throws Exception {
  XMLSlideShow ppt1=new XMLSlideShow();
  XSLFSlide slide1=ppt1.createSlide();
  XSLFGroupShape group1=slide1.createGroup();
  int pictureIndex=0;
  for (int i=0; i < 20; i++, pictureIndex++) {
    byte[] data=new byte[]{(byte)pictureIndex};
    XSLFPictureData elementData=ppt1.addPicture(data,PictureType.PNG);
    assertEquals(pictureIndex,elementData.getIndex());
    XSLFPictureShape picture=slide1.createPicture(elementData);
    String fileName="image" + (elementData.getIndex() + 1) + ".png";
    assertEquals(fileName,picture.getPictureData().getFileName());
    assertArrayEquals(data,picture.getPictureData().getData());
  }
  for (int i=0; i < 20; i++, pictureIndex++) {
    byte[] data=new byte[]{(byte)pictureIndex};
    XSLFPictureData elementData=ppt1.addPicture(data,PictureType.PNG);
    XSLFPictureShape picture=group1.createPicture(elementData);
    assertEquals(pictureIndex,elementData.getIndex());
    String fileName="image" + (pictureIndex + 1) + ".png";
    assertEquals(fileName,picture.getPictureData().getFileName());
    assertArrayEquals(data,picture.getPictureData().getData());
  }
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt1);
  ppt1.close();
  Map<String,XSLFPictureData> pics=new HashMap<String,XSLFPictureData>();
  for (  XSLFPictureData p : ppt2.getPictureData()) {
    pics.put(p.getFileName(),p);
  }
  assertEquals(40,pics.size());
  for (int i=0; i < 40; i++) {
    byte[] data1=new byte[]{(byte)i};
    String fileName="image" + (i + 1) + ".png";
    XSLFPictureData data=pics.get(fileName);
    assertNotNull(data);
    assertEquals(fileName,data.getFileName());
    assertArrayEquals(data1,data.getData());
  }
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void bug58663() throws IOException {
  InputStream is=_slTests.openResourceAsStream("shapes.pptx");
  XMLSlideShow ppt=new XMLSlideShow(is);
  is.close();
  XSLFSlide slide=ppt.getSlides().get(0);
  XSLFPictureShape ps=(XSLFPictureShape)slide.getShapes().get(3);
  slide.removeShape(ps);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ppt.write(bos);
  ppt.close();
  XMLSlideShow ppt2=new XMLSlideShow(new ByteArrayInputStream(bos.toByteArray()));
  assertTrue(ppt2.getPictureData().isEmpty());
  ppt2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMerge() throws Exception {
  XMLSlideShow ppt1=new XMLSlideShow();
  byte[] data1=new byte[100];
  XSLFPictureData pdata1=ppt1.addPicture(data1,PictureType.JPEG);
  XSLFSlide slide1=ppt1.createSlide();
  XSLFPictureShape shape1=slide1.createPicture(pdata1);
  CTPicture ctPic1=(CTPicture)shape1.getXmlObject();
  ctPic1.getNvPicPr().getNvPr().addNewCustDataLst().addNewTags().setId("rId99");
  XMLSlideShow ppt2=new XMLSlideShow();
  XSLFSlide slide2=ppt2.createSlide().importContent(slide1);
  XSLFPictureShape shape2=(XSLFPictureShape)slide2.getShapes().get(0);
  assertArrayEquals(data1,shape2.getPictureData().getData());
  CTPicture ctPic2=(CTPicture)shape2.getXmlObject();
  assertFalse(ctPic2.getNvPicPr().getNvPr().isSetCustDataLst());
  ppt1.close();
  ppt2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFShape </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadTextShapes() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  List<XSLFSlide> slides=ppt.getSlides();
  XSLFSlide slide1=slides.get(0);
  List<XSLFShape> shapes1=slide1.getShapes();
  assertEquals(7,shapes1.size());
  assertEquals("TextBox 3",shapes1.get(0).getShapeName());
  XSLFAutoShape sh0=(XSLFAutoShape)shapes1.get(0);
  assertEquals("Learning PPTX",sh0.getText());
  List<XSLFTextParagraph> paragraphs0=sh0.getTextParagraphs();
  assertEquals(1,paragraphs0.size());
  XSLFTextParagraph p0=paragraphs0.get(0);
  assertEquals("Learning PPTX",p0.getText());
  assertEquals(1,p0.getTextRuns().size());
  XSLFTextRun r0=p0.getTextRuns().get(0);
  assertEquals("Learning PPTX",r0.getRawText());
  XSLFSlide slide2=slides.get(1);
  List<XSLFShape> shapes2=slide2.getShapes();
  assertTrue(shapes2.get(0) instanceof XSLFAutoShape);
  assertEquals("PPTX Title",((XSLFAutoShape)shapes2.get(0)).getText());
  XSLFAutoShape sh1=(XSLFAutoShape)shapes2.get(0);
  List<XSLFTextParagraph> paragraphs1=sh1.getTextParagraphs();
  assertEquals(1,paragraphs1.size());
  XSLFTextParagraph p1=paragraphs1.get(0);
  assertEquals("PPTX Title",p1.getText());
  List<XSLFTextRun> r2=paragraphs1.get(0).getTextRuns();
  assertEquals(2,r2.size());
  assertEquals("PPTX ",r2.get(0).getRawText());
  assertEquals("Title",r2.get(1).getRawText());
  assertEquals(STTextUnderlineType.SNG,r2.get(1).getXmlObject().getRPr().getU());
  assertTrue(shapes2.get(1) instanceof XSLFAutoShape);
  assertEquals("Subtitle\nAnd second line",((XSLFAutoShape)shapes2.get(1)).getText());
  XSLFAutoShape sh2=(XSLFAutoShape)shapes2.get(1);
  List<XSLFTextParagraph> paragraphs2=sh2.getTextParagraphs();
  assertEquals(2,paragraphs2.size());
  assertEquals("Subtitle",paragraphs2.get(0).getText());
  assertEquals("And second line",paragraphs2.get(1).getText());
  assertEquals(1,paragraphs2.get(0).getTextRuns().size());
  assertEquals(1,paragraphs2.get(1).getTextRuns().size());
  assertEquals("Subtitle",paragraphs2.get(0).getTextRuns().get(0).getRawText());
  assertTrue(paragraphs2.get(0).getTextRuns().get(0).getXmlObject().getRPr().getB());
  assertEquals("And second line",paragraphs2.get(1).getTextRuns().get(0).getRawText());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFSheet </h4><pre class="type-2 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateShapes() throws IOException {
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide=ppt.createSlide();
  assertTrue(slide.getShapes().isEmpty());
  XSLFSimpleShape shape1=slide.createAutoShape();
  assertEquals(1,slide.getShapes().size());
  assertSame(shape1,slide.getShapes().get(0));
  XSLFTextBox shape2=slide.createTextBox();
  assertEquals(2,slide.getShapes().size());
  assertSame(shape1,slide.getShapes().get(0));
  assertSame(shape2,slide.getShapes().get(1));
  XSLFConnectorShape shape3=slide.createConnector();
  assertEquals(3,slide.getShapes().size());
  assertSame(shape1,slide.getShapes().get(0));
  assertSame(shape2,slide.getShapes().get(1));
  assertSame(shape3,slide.getShapes().get(2));
  XSLFGroupShape shape4=slide.createGroup();
  assertEquals(4,slide.getShapes().size());
  assertSame(shape1,slide.getShapes().get(0));
  assertSame(shape2,slide.getShapes().get(1));
  assertSame(shape3,slide.getShapes().get(2));
  assertSame(shape4,slide.getShapes().get(3));
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt);
  slide=ppt2.getSlides().get(0);
  List<XSLFShape> shapes=slide.getShapes();
  assertEquals(4,shapes.size());
  assertTrue(shapes.get(0) instanceof XSLFAutoShape);
  assertTrue(shapes.get(1) instanceof XSLFTextBox);
  assertTrue(shapes.get(2) instanceof XSLFConnectorShape);
  assertTrue(shapes.get(3) instanceof XSLFGroupShape);
  ppt.close();
  ppt2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFSimpleShape </h4><pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultProperties() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  XSLFSlide slide6=ppt.getSlides().get(5);
  List<XSLFShape> shapes=slide6.getShapes();
  for (  XSLFShape xs : shapes) {
    XSLFSimpleShape s=(XSLFSimpleShape)xs;
    assertEquals("accent1",s.getSpStyle().getFillRef().getSchemeClr().getVal().toString());
    assertEquals(2.0,s.getLineWidth(),0);
    assertEquals(LineCap.FLAT,s.getLineCap());
    assertEquals(new Color(79,129,189),s.getLineColor());
  }
  XSLFSimpleShape s0=(XSLFSimpleShape)shapes.get(0);
  assertNull(s0.getSpPr().getSolidFill());
  assertEquals(new Color(79,129,189),s0.getFillColor());
  XSLFSimpleShape s1=(XSLFSimpleShape)shapes.get(1);
  CTSchemeColor ref1=s1.getSpPr().getSolidFill().getSchemeClr();
  assertEquals(1,ref1.sizeOfLumModArray());
  assertEquals(1,ref1.sizeOfLumOffArray());
  assertEquals(20000,ref1.getLumModArray(0).getVal());
  assertEquals(80000,ref1.getLumOffArray(0).getVal());
  assertEquals("accent1",ref1.getVal().toString());
  assertEquals(new Color(79,129,189),s1.getFillColor());
  XSLFSimpleShape s2=(XSLFSimpleShape)shapes.get(2);
  CTSchemeColor ref2=s2.getSpPr().getSolidFill().getSchemeClr();
  assertEquals(1,ref2.sizeOfLumModArray());
  assertEquals(1,ref2.sizeOfLumOffArray());
  assertEquals(40000,ref2.getLumModArray(0).getVal());
  assertEquals(60000,ref2.getLumOffArray(0).getVal());
  assertEquals("accent1",ref2.getVal().toString());
  assertEquals(new Color(79,129,189),s2.getFillColor());
  XSLFSimpleShape s3=(XSLFSimpleShape)shapes.get(3);
  CTSchemeColor ref3=s3.getSpPr().getSolidFill().getSchemeClr();
  assertEquals(1,ref3.sizeOfLumModArray());
  assertEquals(1,ref3.sizeOfLumOffArray());
  assertEquals(60000,ref3.getLumModArray(0).getVal());
  assertEquals(40000,ref3.getLumOffArray(0).getVal());
  assertEquals("accent1",ref3.getVal().toString());
  assertEquals(new Color(79,129,189),s3.getFillColor());
  XSLFSimpleShape s4=(XSLFSimpleShape)shapes.get(4);
  CTSchemeColor ref4=s4.getSpPr().getSolidFill().getSchemeClr();
  assertEquals(1,ref4.sizeOfLumModArray());
  assertEquals(0,ref4.sizeOfLumOffArray());
  assertEquals(75000,ref4.getLumModArray(0).getVal());
  assertEquals("accent1",ref3.getVal().toString());
  assertEquals(new Color(79,129,189),s4.getFillColor());
  XSLFSimpleShape s5=(XSLFSimpleShape)shapes.get(5);
  CTSchemeColor ref5=s5.getSpPr().getSolidFill().getSchemeClr();
  assertEquals(1,ref5.sizeOfLumModArray());
  assertEquals(0,ref5.sizeOfLumOffArray());
  assertEquals(50000,ref5.getLumModArray(0).getVal());
  assertEquals("accent1",ref5.getVal().toString());
  assertEquals(new Color(79,129,189),s5.getFillColor());
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAnchor() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  List<XSLFSlide> slide=ppt.getSlides();
  XSLFSlide slide2=slide.get(1);
  XSLFSlideLayout layout2=slide2.getSlideLayout();
  List<XSLFShape> shapes2=slide2.getShapes();
  XSLFTextShape sh1=(XSLFTextShape)shapes2.get(0);
  assertEquals(Placeholder.CENTERED_TITLE,sh1.getTextType());
  assertEquals("PPTX Title",sh1.getText());
  assertNull(sh1.getSpPr().getXfrm());
  assertEquals(sh1.getAnchor(),layout2.getTextShapeByType(Placeholder.CENTERED_TITLE).getAnchor());
  XSLFTextShape sh2=(XSLFTextShape)shapes2.get(1);
  assertEquals("Subtitle\nAnd second line",sh2.getText());
  assertEquals(Placeholder.SUBTITLE,sh2.getTextType());
  assertNull(sh2.getSpPr().getXfrm());
  assertEquals(sh2.getAnchor(),layout2.getTextShapeByType(Placeholder.SUBTITLE).getAnchor());
  XSLFSlide slide5=slide.get(4);
  XSLFSlideLayout layout5=slide5.getSlideLayout();
  XSLFTextShape shTitle=slide5.getTextShapeByType(Placeholder.TITLE);
  assertEquals("Hyperlinks",shTitle.getText());
  assertNull(shTitle.getSpPr().getXfrm());
  assertNull(layout5.getTextShapeByType(Placeholder.TITLE).getSpPr().getXfrm());
  assertNotNull(layout5.getSlideMaster().getTextShapeByType(Placeholder.TITLE).getSpPr().getXfrm());
  assertEquals(shTitle.getAnchor(),layout5.getSlideMaster().getTextShapeByType(Placeholder.TITLE).getAnchor());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFSlide </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportContent() throws IOException {
  XMLSlideShow ppt=new XMLSlideShow();
  XMLSlideShow src=XSLFTestDataSamples.openSampleDocument("themes.pptx");
  XSLFSlide slide1=ppt.createSlide().importContent(src.getSlides().get(3));
  List<XSLFShape> shapes1=slide1.getShapes();
  assertEquals(2,shapes1.size());
  XSLFTextShape sh1=(XSLFTextShape)shapes1.get(0);
  assertEquals("Austin Theme",sh1.getText());
  XSLFTextRun r1=sh1.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals("Century Gothic",r1.getFontFamily());
  assertEquals(40.0,r1.getFontSize(),0);
  assertTrue(r1.isBold());
  assertTrue(r1.isItalic());
  assertTrue(sameColor(new Color(148,198,0),r1.getFontColor()));
  assertNull(sh1.getFillColor());
  assertNull(sh1.getLineColor());
  XSLFTextShape sh2=(XSLFTextShape)shapes1.get(1);
  assertEquals("Text in a autoshape is white\n" + "Fill: RGB(148, 198,0)",sh2.getText());
  XSLFTextRun r2=sh2.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals("Century Gothic",r2.getFontFamily());
  assertEquals(18.0,r2.getFontSize(),0);
  assertFalse(r2.isBold());
  assertFalse(r2.isItalic());
  assertTrue(sameColor(Color.white,r2.getFontColor()));
  assertEquals(new Color(148,198,0),sh2.getFillColor());
  assertEquals(new Color(148,198,0),sh2.getLineColor());
  XSLFSlide slide2=ppt.createSlide().importContent(src.getSlides().get(4));
  List<XSLFShape> shapes2=slide2.getShapes();
  assertEquals(2,shapes2.size());
  XSLFTextShape sh3=(XSLFTextShape)shapes2.get(0);
  assertEquals("This slide overrides master background with a texture fill",sh3.getText());
  XSLFTextRun r3=sh3.getTextParagraphs().get(0).getTextRuns().get(0);
  assertEquals("Century Gothic",r3.getFontFamily());
  assertTrue(r3.isBold());
  assertTrue(r3.isItalic());
  assertTrue(sameColor(new Color(148,198,0),r3.getFontColor()));
  assertNull(sh3.getFillColor());
  assertNull(sh3.getLineColor());
  XSLFPictureShape sh4=(XSLFPictureShape)shapes2.get(1);
  XSLFPictureShape srcPic=(XSLFPictureShape)src.getSlides().get(4).getShapes().get(1);
  assertArrayEquals(sh4.getPictureData().getData(),srcPic.getPictureData().getData());
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadShapes() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  List<XSLFSlide> slides=ppt.getSlides();
  XSLFSlide slide1=slides.get(0);
  List<XSLFShape> shapes1=slide1.getShapes();
  assertEquals(7,shapes1.size());
  assertEquals("TextBox 3",shapes1.get(0).getShapeName());
  assertTrue(shapes1.get(0) instanceof XSLFTextBox);
  XSLFAutoShape sh0=(XSLFAutoShape)shapes1.get(0);
  assertEquals("Learning PPTX",sh0.getText());
  assertEquals("Straight Connector 5",shapes1.get(1).getShapeName());
  assertTrue(shapes1.get(1) instanceof XSLFConnectorShape);
  assertEquals("Freeform 6",shapes1.get(2).getShapeName());
  assertTrue(shapes1.get(2) instanceof XSLFFreeformShape);
  XSLFAutoShape sh2=(XSLFAutoShape)shapes1.get(2);
  assertEquals("Cloud",sh2.getText());
  assertEquals("Picture 1",shapes1.get(3).getShapeName());
  assertTrue(shapes1.get(3) instanceof XSLFPictureShape);
  assertEquals("Table 2",shapes1.get(4).getShapeName());
  assertTrue(shapes1.get(4) instanceof XSLFGraphicFrame);
  assertEquals("Straight Arrow Connector 7",shapes1.get(5).getShapeName());
  assertTrue(shapes1.get(5) instanceof XSLFConnectorShape);
  assertEquals("Elbow Connector 9",shapes1.get(6).getShapeName());
  assertTrue(shapes1.get(6) instanceof XSLFConnectorShape);
  XSLFSlide slide2=slides.get(1);
  List<XSLFShape> shapes2=slide2.getShapes();
  assertEquals(2,shapes2.size());
  assertTrue(shapes2.get(0) instanceof XSLFAutoShape);
  assertEquals("PPTX Title",((XSLFAutoShape)shapes2.get(0)).getText());
  assertTrue(shapes2.get(1) instanceof XSLFAutoShape);
  assertEquals("Subtitle\nAnd second line",((XSLFAutoShape)shapes2.get(1)).getText());
  XSLFSlide slide3=slides.get(2);
  List<XSLFShape> shapes3=slide3.getShapes();
  assertEquals(1,shapes3.size());
  assertTrue(shapes3.get(0) instanceof XSLFGroupShape);
  List<XSLFShape> groupShapes=((XSLFGroupShape)shapes3.get(0)).getShapes();
  assertEquals(3,groupShapes.size());
  assertTrue(groupShapes.get(0) instanceof XSLFAutoShape);
  assertEquals("Rectangle 1",groupShapes.get(0).getShapeName());
  assertTrue(groupShapes.get(1) instanceof XSLFAutoShape);
  assertEquals("Oval 2",groupShapes.get(1).getShapeName());
  assertTrue(groupShapes.get(2) instanceof XSLFAutoShape);
  assertEquals("Right Arrow 3",groupShapes.get(2).getShapeName());
  XSLFSlide slide4=slides.get(3);
  List<XSLFShape> shapes4=slide4.getShapes();
  assertEquals(1,shapes4.size());
  assertTrue(shapes4.get(0) instanceof XSLFTable);
  XSLFTable tbl=(XSLFTable)shapes4.get(0);
  assertEquals(3,tbl.getNumberOfColumns());
  assertEquals(6,tbl.getNumberOfRows());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFSlideShow </h4><pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveSlide() throws IOException {
  XMLSlideShow ppt=new XMLSlideShow();
  assertEquals(0,ppt.getSlides().size());
  XSLFSlide slide1=ppt.createSlide();
  XSLFSlide slide2=ppt.createSlide();
  assertEquals(2,ppt.getSlides().size());
  assertSame(slide1,ppt.getSlides().get(0));
  assertSame(slide2,ppt.getSlides().get(1));
  XSLFSlide removedSlide=ppt.removeSlide(0);
  assertSame(slide1,removedSlide);
  assertEquals(1,ppt.getSlides().size());
  assertSame(slide2,ppt.getSlides().get(0));
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt);
  assertEquals(1,ppt2.getSlides().size());
  ppt2.close();
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSlide() throws IOException {
  XMLSlideShow ppt=new XMLSlideShow();
  assertEquals(0,ppt.getSlides().size());
  XSLFSlide slide1=ppt.createSlide();
  assertEquals(1,ppt.getSlides().size());
  assertSame(slide1,ppt.getSlides().get(0));
  List<POIXMLDocumentPart> rels=slide1.getRelations();
  assertEquals(1,rels.size());
  assertEquals(slide1.getSlideMaster().getLayout(SlideLayout.BLANK),rels.get(0));
  XSLFSlide slide2=ppt.createSlide();
  assertEquals(2,ppt.getSlides().size());
  assertSame(slide2,ppt.getSlides().get(1));
  ppt.setSlideOrder(slide2,0);
  assertSame(slide2,ppt.getSlides().get(0));
  assertSame(slide1,ppt.getSlides().get(1));
  XMLSlideShow ppt2=XSLFTestDataSamples.writeOutAndReadBack(ppt);
  assertEquals(2,ppt2.getSlides().size());
  rels=ppt2.getSlides().get(0).getRelations();
  ppt2.close();
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFTable </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("shapes.pptx");
  XSLFSlide slide=ppt.getSlides().get(3);
  List<XSLFShape> shapes=slide.getShapes();
  assertEquals(1,shapes.size());
  assertTrue(shapes.get(0) instanceof XSLFTable);
  XSLFTable tbl=(XSLFTable)shapes.get(0);
  assertEquals(3,tbl.getNumberOfColumns());
  assertEquals(6,tbl.getNumberOfRows());
  assertNotNull(tbl.getCTTable());
  List<XSLFTableRow> rows=tbl.getRows();
  assertEquals(6,rows.size());
  assertEquals(90.0,tbl.getColumnWidth(0),0);
  assertEquals(240.0,tbl.getColumnWidth(1),0);
  assertEquals(150.0,tbl.getColumnWidth(2),0);
  for (  XSLFTableRow row : tbl) {
    assertEquals(29.2,row.getHeight(),0);
  }
  XSLFTableRow row0=rows.get(0);
  List<XSLFTableCell> cells0=row0.getCells();
  assertEquals(3,cells0.size());
  assertEquals("header1",cells0.get(0).getText());
  assertEquals("header2",cells0.get(1).getText());
  assertEquals("header3",cells0.get(2).getText());
  XSLFTableRow row1=rows.get(1);
  List<XSLFTableCell> cells1=row1.getCells();
  assertEquals(3,cells1.size());
  assertEquals("A1",cells1.get(0).getText());
  assertEquals("B1",cells1.get(1).getText());
  assertEquals("C1",cells1.get(2).getText());
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFTextParagraph </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThemeInheritance() throws IOException {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("prProps.pptx");
  List<XSLFShape> shapes=ppt.getSlides().get(0).getShapes();
  XSLFTextShape sh1=(XSLFTextShape)shapes.get(0);
  assertEquals("Apache",sh1.getText());
  assertEquals(TextAlign.CENTER,sh1.getTextParagraphs().get(0).getTextAlign());
  XSLFTextShape sh2=(XSLFTextShape)shapes.get(1);
  assertEquals("Software",sh2.getText());
  assertEquals(TextAlign.CENTER,sh2.getTextParagraphs().get(0).getTextAlign());
  XSLFTextShape sh3=(XSLFTextShape)shapes.get(2);
  assertEquals("Foundation",sh3.getText());
  assertEquals(TextAlign.CENTER,sh3.getTextParagraphs().get(0).getTextAlign());
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test breaking test into lines.
 * This test requires that the Arial font is available and will run only on windows
 */
@Test public void testBreakLines() throws IOException {
  String os=System.getProperty("os.name");
  Assume.assumeTrue("Skipping testBreakLines(), it is executed only on Windows machines",(os != null && os.contains("Windows")));
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide=ppt.createSlide();
  XSLFTextShape sh=slide.createAutoShape();
  XSLFTextParagraph p=sh.addNewTextParagraph();
  XSLFTextRun r=p.addNewTextRun();
  r.setFontFamily("Arial");
  r.setFontSize(12d);
  r.setText("Paragraph formatting allows for more granular control " + "of text within a shape. Properties here apply to all text " + "residing within the corresponding paragraph.");
  sh.setAnchor(new Rectangle2D.Double(50,50,300,200));
  DrawTextParagraphProxy dtp=new DrawTextParagraphProxy(p);
  BufferedImage img=new BufferedImage(1,1,BufferedImage.TYPE_INT_RGB);
  Graphics2D graphics=img.createGraphics();
  List<DrawTextFragment> lines;
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(4,lines.size());
  sh.setAnchor(new Rectangle2D.Double(50,50,100,200));
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(12,lines.size());
  sh.setAnchor(new Rectangle2D.Double(50,50,600,200));
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  sh.setLeftInset(200);
  sh.setRightInset(200);
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(5,lines.size());
  r.setText("Apache POI");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(1,lines.size());
  assertEquals("Apache POI",lines.get(0).getString());
  r.setText("Apache\nPOI");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  r.setText("Apache\nPOI\n");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  XSLFAutoShape sh2=slide.createAutoShape();
  sh2.setAnchor(new Rectangle2D.Double(50,50,300,200));
  XSLFTextParagraph p2=sh2.addNewTextParagraph();
  XSLFTextRun r2=p2.addNewTextRun();
  r2.setFontFamily("serif");
  r2.setFontSize(30d);
  r2.setText("Apache\n");
  XSLFTextRun r3=p2.addNewTextRun();
  r3.setFontFamily("serif");
  r3.setFontSize(10d);
  r3.setText("POI");
  dtp=new DrawTextParagraphProxy(p2);
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  assertTrue(lines.get(0).getHeight() > lines.get(1).getHeight() * 2);
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrappingWidth() throws IOException {
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide=ppt.createSlide();
  XSLFTextShape sh=slide.createAutoShape();
  sh.setLineColor(Color.black);
  XSLFTextParagraph p=sh.addNewTextParagraph();
  p.addNewTextRun().setText("Paragraph formatting allows for more granular control " + "of text within a shape. Properties here apply to all text " + "residing within the corresponding paragraph.");
  Rectangle2D anchor=new Rectangle2D.Double(50,50,300,200);
  sh.setAnchor(anchor);
  DrawTextParagraphProxy dtp=new DrawTextParagraphProxy(p);
  Double leftInset=sh.getLeftInset();
  Double rightInset=sh.getRightInset();
  assertEquals(7.2,leftInset,0);
  assertEquals(7.2,rightInset,0);
  Double leftMargin=p.getLeftMargin();
  assertEquals(0.0,leftMargin,0);
  Double indent=p.getIndent();
  assertNull(indent);
  double expectedWidth;
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin;
  assertEquals(285.6,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(true,null),0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(false,null),0);
  p.setLeftMargin(36d);
  leftMargin=p.getLeftMargin();
  assertEquals(36.0,leftMargin,0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin;
  assertEquals(249.6,expectedWidth,1E-5);
  assertEquals(expectedWidth,dtp.getWrappingWidth(true,null),0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(false,null),0);
  sh.setLeftInset(10);
  sh.setRightInset(10);
  leftInset=sh.getLeftInset();
  rightInset=sh.getRightInset();
  assertEquals(10.0,leftInset,0);
  assertEquals(10.0,rightInset,0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin;
  assertEquals(244.0,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(true,null),0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(false,null),0);
  p.setIndent(36.0);
  indent=p.getIndent();
  assertEquals(36.0,indent,0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin- indent;
  assertEquals(208.0,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(true,null),0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin;
  assertEquals(244.0,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(false,null),0);
  p.setIndent(-72.0);
  indent=p.getIndent();
  assertEquals(-72.0,indent,0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset;
  assertEquals(280.0,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(true,null),0);
  expectedWidth=anchor.getWidth() - leftInset - rightInset- leftMargin;
  assertEquals(244.0,expectedWidth,0);
  assertEquals(expectedWidth,dtp.getWrappingWidth(false,null),0);
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFTextShape </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void metroBlob() throws IOException {
  File f=POIDataSamples.getSlideShowInstance().getFile("bug52297.ppt");
  SlideShow<?,?> ppt=SlideShowFactory.create(f);
  HSLFTextShape sh=(HSLFTextShape)ppt.getSlides().get(1).getShapes().get(3);
  XSLFAutoShape xsh=(XSLFAutoShape)sh.getMetroShape();
  String textExp=" ___ ___ ___ ________ __  _______ ___  ___________  __________ __ _____ ___ ___ ___ _______ ____ ______ ___________  _____________ ___ _______ ______  ____ ______ __ ___________  __________ ___ _________  _____ ________ __________  ___ _______ __________ ";
  String textAct=xsh.getText();
  ppt.close();
  assertEquals(textExp,textAct);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.TestWorkbookProtection </h4><pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("resource") @Test public void testHashPassword() throws Exception {
  XSSFWorkbook wb=new XSSFWorkbook();
  wb.lockRevision();
  wb.setRevisionsPassword("test",HashAlgorithm.sha1);
  wb=writeOutAndReadBack(wb);
  assertTrue(wb.isRevisionLocked());
  assertTrue(wb.validateRevisionsPassword("test"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void workbookAndRevisionPassword() throws Exception {
  XSSFWorkbook workbook;
  String password="test";
  workbook=openSampleWorkbook("workbookProtection-workbook_password_user_range-2010.xlsx");
  assertTrue(workbook.validateWorkbookPassword(password));
  workbook=openSampleWorkbook("workbookProtection-workbook_password-2013.xlsx");
  assertTrue(workbook.validateWorkbookPassword(password));
  workbook=openSampleWorkbook("workbookProtection_not_protected.xlsx");
  workbook.setWorkbookPassword(null,null);
  assertNull(workbook.getCTWorkbook().getWorkbookProtection());
  workbook.setWorkbookPassword(password,null);
  int hashVal=CryptoFunctions.createXorVerifier1(password);
  int actualVal=Integer.parseInt(workbook.getCTWorkbook().getWorkbookProtection().xgetWorkbookPassword().getStringValue(),16);
  assertEquals(hashVal,actualVal);
  assertTrue(workbook.validateWorkbookPassword(password));
  workbook.setWorkbookPassword(null,null);
  assertFalse(workbook.getCTWorkbook().getWorkbookProtection().isSetWorkbookPassword());
  workbook.unLock();
  assertNull(workbook.getCTWorkbook().getWorkbookProtection());
  workbook.setRevisionsPassword(null,null);
  assertNull(workbook.getCTWorkbook().getWorkbookProtection());
  password="T\u0400ST\u0100passwordWhichIsLongerThan15Chars";
  workbook.setRevisionsPassword(password,null);
  hashVal=CryptoFunctions.createXorVerifier1(password);
  actualVal=Integer.parseInt(workbook.getCTWorkbook().getWorkbookProtection().xgetRevisionsPassword().getStringValue(),16);
  assertEquals(hashVal,actualVal);
  assertTrue(workbook.validateRevisionsPassword(password));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("resource") @Test public void testIntegration() throws Exception {
  XSSFWorkbook wb=new XSSFWorkbook();
  wb.createSheet("Testing purpose sheet");
  assertFalse(wb.isRevisionLocked());
  wb.lockRevision();
  wb.setRevisionsPassword("test",null);
  wb=writeOutAndReadBack(wb);
  assertTrue(wb.isRevisionLocked());
  assertTrue(wb.validateRevisionsPassword("test"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.extractor.TestXSSFExportToXML </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXmlExportIgnoresEmptyCells_Bugzilla_55924() throws Exception {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("55924.xlsx");
  boolean found=false;
  for (  POIXMLDocumentPart p : wb.getRelations()) {
    if (!(p instanceof MapInfo)) {
      continue;
    }
    MapInfo mapInfo=(MapInfo)p;
    XSSFMap map=mapInfo.getXSSFMapById(1);
    assertNotNull("XSSFMap is null",map);
    XSSFExportToXml exporter=new XSSFExportToXml(map);
    ByteArrayOutputStream os=new ByteArrayOutputStream();
    exporter.exportToXML(os,true);
    String xmlData=os.toString("UTF-8");
    assertNotNull(xmlData);
    assertFalse(xmlData.equals(""));
    String a=xmlData.split("<A>")[1].split("</A>")[0].trim();
    String euro=a.split("<EUR>")[1].split("</EUR>")[0].trim();
    assertEquals("1",euro);
    parseXML(xmlData);
    found=true;
  }
  assertTrue(found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestCommentsTable </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readWriteMultipleAuthors(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("WithMoreVariousData.xlsx");
  XSSFSheet sheet1=workbook.getSheetAt(0);
  XSSFSheet sheet2=workbook.getSheetAt(1);
  assertTrue(sheet1.hasComments());
  assertFalse(sheet2.hasComments());
  assertEquals("Nick Burch",sheet1.getRow(4).getCell(2).getCellComment().getAuthor());
  assertEquals("Nick Burch",sheet1.getRow(6).getCell(2).getCellComment().getAuthor());
  assertEquals("Torchbox",sheet1.getRow(12).getCell(2).getCellComment().getAuthor());
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet1=workbook.getSheetAt(0);
  assertNotNull(sheet1.getRow(4).getCell(2).getCellComment());
  assertNotNull(sheet1.getRow(6).getCell(2).getCellComment());
  assertNotNull(sheet1.getRow(12).getCell(2).getCellComment());
  assertEquals("Nick Burch",sheet1.getRow(4).getCell(2).getCellComment().getAuthor());
  assertEquals("Nick Burch",sheet1.getRow(6).getCell(2).getCellComment().getAuthor());
  assertEquals("Torchbox",sheet1.getRow(12).getCell(2).getCellComment().getAuthor());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeRead(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("WithVariousData.xlsx");
  XSSFSheet sheet1=workbook.getSheetAt(0);
  XSSFSheet sheet2=workbook.getSheetAt(1);
  assertTrue(sheet1.hasComments());
  assertFalse(sheet2.hasComments());
  Row r5=sheet1.getRow(4);
  Comment cc5=r5.getCell(2).getCellComment();
  cc5.setAuthor("Apache POI");
  cc5.setString(new XSSFRichTextString("Hello!"));
  Row r2s2=sheet2.createRow(2);
  Cell c1r2s2=r2s2.createCell(1);
  assertNull(c1r2s2.getCellComment());
  Drawing dg=sheet2.createDrawingPatriarch();
  Comment cc2=dg.createCellComment(new XSSFClientAnchor());
  cc2.setAuthor("Also POI");
  cc2.setString(new XSSFRichTextString("A new comment"));
  c1r2s2.setCellComment(cc2);
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet1=workbook.getSheetAt(0);
  sheet2=workbook.getSheetAt(1);
  assertNotNull(sheet1.getRow(4).getCell(2).getCellComment());
  assertNotNull(sheet1.getRow(6).getCell(2).getCellComment());
  assertNotNull(sheet2.getRow(2).getCell(1).getCellComment());
  assertEquals("Apache POI",sheet1.getRow(4).getCell(2).getCellComment().getAuthor());
  assertEquals("Nick Burch",sheet1.getRow(6).getCell(2).getCellComment().getAuthor());
  assertEquals("Also POI",sheet2.getRow(2).getCell(1).getCellComment().getAuthor());
  assertEquals("Hello!",sheet1.getRow(4).getCell(2).getCellComment().getString().getString());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug54920() throws IOException {
  final Workbook workbook=new XSSFWorkbook();
  final Sheet sheet=workbook.createSheet("sheet01");
  CreationHelper helper=sheet.getWorkbook().getCreationHelper();
  ClientAnchor anchor=helper.createClientAnchor();
  Cell A1=getCell(sheet,0,0);
  Drawing drawing=sheet.createDrawingPatriarch();
  setComment(sheet,A1,drawing,"for A1",helper,anchor);
  Comment commentA1=A1.getCellComment();
  assertNotNull("Should still find the previous comment in A1, but had null",commentA1);
  assertEquals("should find correct comment in A1, but had null: " + commentA1,"for A1",commentA1.getString().getString());
  Cell B2=getCell(sheet,1,1);
  setComment(sheet,B2,drawing,"for B2",helper,anchor);
  Comment commentB2=B2.getCellComment();
  assertEquals("should find correct comment in B2, but had null: " + commentB2,"for B2",commentB2.getString().getString());
  commentA1=A1.getCellComment();
  assertNotNull("Should still find the previous comment in A1, but had null",commentA1);
  assertEquals("should find correct comment in A1, but had null: " + commentA1,"for A1",commentA1.getString().getString());
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestExternalLinksTable </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void basicReadWriteRead(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("ref-56737.xlsx");
  Name name=wb.getExternalLinksTable().get(0).getDefinedNames().get(1);
  name.setNameName("Testing");
  name.setRefersToFormula("$A$1");
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertEquals(1,wb.getExternalLinksTable().size());
  ExternalLinksTable links=wb.getExternalLinksTable().get(0);
  name=links.getDefinedNames().get(0);
  assertEquals("NR_Global_B2",name.getNameName());
  assertEquals(-1,name.getSheetIndex());
  assertEquals(null,name.getSheetName());
  assertEquals("'Defines'!$B$2",name.getRefersToFormula());
  name=links.getDefinedNames().get(1);
  assertEquals("Testing",name.getNameName());
  assertEquals(1,name.getSheetIndex());
  assertEquals("Defines",name.getSheetName());
  assertEquals("$A$1",name.getRefersToFormula());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestStylesTable </h4><pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLoadExisting(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook(testFile);
  assertNotNull(workbook.getStylesSource());
  StylesTable st=workbook.getStylesSource();
  doTestExisting(st);
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(workbook));
}

</code></pre>

<br>
<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testLoadSaveLoad(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook(testFile);
  assertNotNull(workbook.getStylesSource());
  StylesTable st=workbook.getStylesSource();
  doTestExisting(st);
  st=XSSFTestDataSamples.writeOutAndReadBack(workbook).getStylesSource();
  doTestExisting(st);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void populateNew(){
  XSSFWorkbook wb=new XSSFWorkbook();
  StylesTable st=wb.getStylesSource();
  assertNotNull(st.getCTStylesheet());
  assertEquals(1,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(0,st.getNumDataFormats());
  int nf1=st.putNumberFormat("yyyy-mm-dd");
  int nf2=st.putNumberFormat("yyyy-mm-DD");
  assertEquals(nf1,st.putNumberFormat("yyyy-mm-dd"));
  st.putStyle(new XSSFCellStyle(st));
  st=XSSFTestDataSamples.writeOutAndReadBack(wb).getStylesSource();
  assertNotNull(st.getCTStylesheet());
  assertEquals(2,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(2,st.getNumDataFormats());
  assertEquals("yyyy-mm-dd",st.getNumberFormatAt(nf1));
  assertEquals(nf1,st.putNumberFormat("yyyy-mm-dd"));
  assertEquals(nf2,st.putNumberFormat("yyyy-mm-DD"));
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(wb));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSaveLoad(){
  XSSFWorkbook wb=new XSSFWorkbook();
  StylesTable st=wb.getStylesSource();
  assertNotNull(st.getCTStylesheet());
  assertEquals(1,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(0,st.getNumDataFormats());
  st=XSSFTestDataSamples.writeOutAndReadBack(wb).getStylesSource();
  assertNotNull(st.getCTStylesheet());
  assertEquals(1,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(0,st.getNumDataFormats());
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(wb));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void populateExisting(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook(testFile);
  assertNotNull(workbook.getStylesSource());
  StylesTable st=workbook.getStylesSource();
  assertEquals(11,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(8,st.getNumDataFormats());
  int nf1=st.putNumberFormat("YYYY-mm-dd");
  int nf2=st.putNumberFormat("YYYY-mm-DD");
  assertEquals(nf1,st.putNumberFormat("YYYY-mm-dd"));
  st=XSSFTestDataSamples.writeOutAndReadBack(workbook).getStylesSource();
  assertEquals(11,st._getXfsSize());
  assertEquals(1,st._getStyleXfsSize());
  assertEquals(10,st.getNumDataFormats());
  assertEquals("YYYY-mm-dd",st.getNumberFormatAt(nf1));
  assertEquals(nf1,st.putNumberFormat("YYYY-mm-dd"));
  assertEquals(nf2,st.putNumberFormat("YYYY-mm-DD"));
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(workbook));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void removeNumberFormat() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    final String fmt=customDataFormat;
    final short fmtIdx=(short)wb.getStylesSource().putNumberFormat(fmt);
    Cell cell=wb.createSheet("test").createRow(0).createCell(0);
    cell.setCellValue(5.25);
    CellStyle style=wb.createCellStyle();
    style.setDataFormat(fmtIdx);
    cell.setCellStyle(style);
    assertEquals(fmt,cell.getCellStyle().getDataFormatString());
    assertEquals(fmt,wb.getStylesSource().getNumberFormatAt(fmtIdx));
    wb.getStylesSource().removeNumberFormat(fmt);
    final short defaultFmtIdx=0;
    final String defaultFmt=BuiltinFormats.getBuiltinFormat(0);
    assertEquals(defaultFmtIdx,style.getDataFormat());
    assertEquals(defaultFmt,style.getDataFormatString());
    Map<Short,String> numberFormats=wb.getStylesSource().getNumberFormats();
    assertNotContainsKey(numberFormats,fmtIdx);
    assertNotContainsValue(numberFormats,fmt);
    assertEquals(0,wb.getStylesSource().getNumDataFormats());
    cell=null;
    style=null;
    numberFormats=null;
    wb=XSSFTestDataSamples.writeOutCloseAndReadBack(wb);
    cell=wb.getSheet("test").getRow(0).getCell(0);
    style=cell.getCellStyle();
    assertEquals(defaultFmtIdx,style.getDataFormat());
    assertEquals(defaultFmt,style.getDataFormatString());
    numberFormats=wb.getStylesSource().getNumberFormats();
    assertNotContainsKey(numberFormats,fmtIdx);
    assertNotContainsValue(numberFormats,fmt);
    assertEquals(0,wb.getStylesSource().getNumDataFormats());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestThemesTable </h4><pre class="type-2 type-12 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that, for a file with themes, we can correctly
 * read both the themed and non-themed colours back.
 * Column A = Theme Foreground
 * Column B = Theme Foreground
 * Column C = Explicit Colour Foreground
 * Column E = Explicit Colour Background, Black Foreground
 * Column G = Conditional Formatting Backgrounds
 * Note - Grey Row has an odd way of doing the styling... 
 */
@Test public void themedAndNonThemedColours(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  XSSFSheet sheet=wb.getSheetAt(0);
  XSSFCellStyle style;
  XSSFColor color;
  XSSFCell cell;
  String[] names={"White","Black","Grey","Dark Blue","Blue","Red","Green"};
  String[] explicitFHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0070C0","FFFF0000","FF00B050"};
  String[] explicitBHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0000FF","FFFF0000","FF00FF00"};
  assertEquals(7,names.length);
  for (int rn=1; rn < 8; rn++) {
    int idx=rn - 1;
    XSSFRow row=sheet.getRow(rn);
    assertNotNull("Missing row " + rn,row);
    XSSFCell themeCell=row.getCell(0);
    ThemeElement themeElem=ThemeElement.byId(idx);
    assertCellContents(themeElem.name,themeCell);
    assertCellContents(names[idx],row.getCell(1));
    assertCellContents(names[idx],row.getCell(2));
    assertCellContents(names[idx],row.getCell(4));
    style=themeCell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals(idx,color.getTheme());
    assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    cell=row.getCell(1);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    if (idx != 2) {
      assertEquals(idx,color.getTheme());
      assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    }
 else {
      assertEquals(1,color.getTheme());
      assertEquals(0.50,color.getTint(),0.001);
    }
    cell=row.getCell(2);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitFHexes[idx],color.getARGBHex());
    cell=row.getCell(4);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals("FF000000",color.getARGBHex());
    color=style.getFillForegroundXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitBHexes[idx],color.getARGBHex());
    color=style.getFillBackgroundColorColor();
    assertEquals(false,color.isThemed());
    assertEquals(null,color.getARGBHex());
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThemesTableColors() throws Exception {
  XSSFWorkbook simple=XSSFTestDataSamples.openSampleWorkbook(testFileSimple);
  XSSFWorkbook complex=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  XSSFWorkbook simpleRS=XSSFTestDataSamples.writeOutAndReadBack(simple);
  XSSFWorkbook complexRS=XSSFTestDataSamples.writeOutAndReadBack(complex);
  simple=XSSFTestDataSamples.openSampleWorkbook(testFileSimple);
  complex=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  Map<String,XSSFWorkbook> workbooks=new LinkedHashMap<String,XSSFWorkbook>();
  workbooks.put(testFileSimple,simple);
  workbooks.put("Re-Saved_" + testFileSimple,simpleRS);
  workbooks.put(testFileComplex,complex);
  workbooks.put("Re-Saved_" + testFileComplex,complexRS);
  assertEquals(rgbExpected.length,rgbExpected.length);
  boolean createFiles=false;
  for (  String whatWorkbook : workbooks.keySet()) {
    XSSFWorkbook workbook=workbooks.get(whatWorkbook);
    XSSFSheet sheet=workbook.getSheetAt(0);
    int startRN=0;
    if (whatWorkbook.endsWith(testFileComplex))     startRN++;
    for (int rn=startRN; rn < rgbExpected.length + startRN; rn++) {
      XSSFRow row=sheet.getRow(rn);
      assertNotNull("Missing row " + rn + " in "+ whatWorkbook,row);
      String ref=(new CellReference(rn,0)).formatAsString();
      XSSFCell cell=row.getCell(0);
      assertNotNull("Missing cell " + ref + " in "+ whatWorkbook,cell);
      int expectedThemeIdx=rn - startRN;
      ThemeElement themeElem=ThemeElement.byId(expectedThemeIdx);
      assertEquals("Wrong theme at " + ref + " in "+ whatWorkbook,themeElem.name.toLowerCase(Locale.ROOT),cell.getStringCellValue());
      XSSFFont font=cell.getCellStyle().getFont();
      CTColor ctColor=font.getCTFont().getColorArray(0);
      assertNotNull(ctColor);
      assertEquals(true,ctColor.isSetTheme());
      assertEquals(themeElem.idx,ctColor.getTheme());
      XSSFColor color=font.getXSSFColor();
      assertEquals(false,color.hasTint());
      assertEquals("Wrong theme colour " + themeElem.name + " on "+ whatWorkbook,rgbExpected[expectedThemeIdx],Hex.encodeHexString(color.getRGB()));
      long themeIdx=font.getCTFont().getColorArray(0).getTheme();
      assertEquals("Wrong theme index " + expectedThemeIdx + " on "+ whatWorkbook,expectedThemeIdx,themeIdx);
      if (createFiles) {
        XSSFCellStyle cs=row.getSheet().getWorkbook().createCellStyle();
        cs.setFillForegroundColor(color);
        cs.setFillPattern(CellStyle.SOLID_FOREGROUND);
        row.createCell(1).setCellStyle(cs);
      }
    }
    if (createFiles) {
      FileOutputStream fos=new FileOutputStream("Generated_" + whatWorkbook);
      workbook.write(fos);
      fos.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("resource") public void testAddNew() throws Exception {
  XSSFWorkbook wb=new XSSFWorkbook();
  wb.createSheet();
  assertEquals(null,wb.getTheme());
  StylesTable styles=wb.getStylesSource();
  assertEquals(null,styles.getTheme());
  styles.ensureThemesTable();
  assertNotNull(styles.getTheme());
  assertNotNull(wb.getTheme());
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  styles=wb.getStylesSource();
  assertNotNull(styles.getTheme());
  assertNotNull(wb.getTheme());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFCell </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPreserveSpaces() throws IOException {
  String[] samplesWithSpaces={" POI","POI "," POI ","\nPOI","\n\nPOI \n"};
  for (  String str : samplesWithSpaces) {
    Workbook swb=_testDataProvider.createWorkbook();
    Cell sCell=swb.createSheet().createRow(0).createCell(0);
    sCell.setCellValue(str);
    assertEquals(sCell.getStringCellValue(),str);
    XSSFWorkbook xwb=(XSSFWorkbook)_testDataProvider.writeOutAndReadBack(swb);
    XSSFCell xCell=xwb.getSheetAt(0).getRow(0).getCell(0);
    CTRst is=xCell.getCTCell().getIs();
    XmlCursor c=is.newCursor();
    c.toNextToken();
    String t=c.getAttributeText(new QName("http://www.w3.org/XML/1998/namespace","space"));
    c.dispose();
    assertEquals("expected xml:spaces=\"preserve\" \"" + str + "\"","preserve",t);
    xwb.close();
    swb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFWorkbook </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sheetdataWriter() throws IOException {
  SXSSFWorkbook wb=new SXSSFWorkbook();
  SXSSFSheet sh=wb.createSheet();
  SheetDataWriter wr=sh.getSheetDataWriter();
  assertTrue(wr.getClass() == SheetDataWriter.class);
  File tmp=wr.getTempFile();
  assertTrue(tmp.getName().startsWith("poi-sxssf-sheet"));
  assertTrue(tmp.getName().endsWith(".xml"));
  assertTrue(wb.dispose());
  wb.close();
  wb=new SXSSFWorkbook();
  wb.setCompressTempFiles(true);
  sh=wb.createSheet();
  wr=sh.getSheetDataWriter();
  assertTrue(wr.getClass() == GZIPSheetDataWriter.class);
  tmp=wr.getTempFile();
  assertTrue(tmp.getName().startsWith("poi-sxssf-sheet-xml"));
  assertTrue(tmp.getName().endsWith(".gz"));
  assertTrue(wb.dispose());
  wb.close();
  wb=new SXSSFWorkbook();
  wb.createSheet("S1").createRow(0).createCell(0).setCellValue("value\u0019");
  XSSFWorkbook xssfWorkbook=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  Cell cell=xssfWorkbook.getSheet("S1").getRow(0).getCell(0);
  assertEquals("value?",cell.getStringCellValue());
  assertTrue(wb.dispose());
  wb.close();
  xssfWorkbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gzipSheetdataWriter() throws IOException {
  SXSSFWorkbook wb=new SXSSFWorkbook();
  wb.setCompressTempFiles(true);
  int rowNum=1000;
  int sheetNum=5;
  for (int i=0; i < sheetNum; i++) {
    Sheet sh=wb.createSheet("sheet" + i);
    for (int j=0; j < rowNum; j++) {
      Row row=sh.createRow(j);
      Cell cell1=row.createCell(0);
      cell1.setCellValue(new CellReference(cell1).formatAsString());
      Cell cell2=row.createCell(1);
      cell2.setCellValue(i);
      Cell cell3=row.createCell(2);
      cell3.setCellValue(j);
    }
  }
  XSSFWorkbook xwb=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  for (int i=0; i < sheetNum; i++) {
    Sheet sh=xwb.getSheetAt(i);
    assertEquals("sheet" + i,sh.getSheetName());
    for (int j=0; j < rowNum; j++) {
      Row row=sh.getRow(j);
      assertNotNull("row[" + j + "]",row);
      Cell cell1=row.getCell(0);
      assertEquals(new CellReference(cell1).formatAsString(),cell1.getStringCellValue());
      Cell cell2=row.getCell(1);
      assertEquals(i,(int)cell2.getNumericCellValue());
      Cell cell3=row.getCell(2);
      assertEquals(j,(int)cell3.getNumericCellValue());
    }
  }
  assertTrue(wb.dispose());
  xwb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void useSharedStringsTable() throws Exception {
  SXSSFWorkbook wb=new SXSSFWorkbook(null,10,false,true);
  SharedStringsTable sss=POITestCase.getFieldValue(SXSSFWorkbook.class,wb,SharedStringsTable.class,"_sharedStringSource");
  assertNotNull(sss);
  Row row=wb.createSheet("S1").createRow(0);
  row.createCell(0).setCellValue("A");
  row.createCell(1).setCellValue("B");
  row.createCell(2).setCellValue("A");
  XSSFWorkbook xssfWorkbook=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  sss=POITestCase.getFieldValue(SXSSFWorkbook.class,wb,SharedStringsTable.class,"_sharedStringSource");
  assertEquals(2,sss.getUniqueCount());
  assertTrue(wb.dispose());
  Sheet sheet1=xssfWorkbook.getSheetAt(0);
  assertEquals("S1",sheet1.getSheetName());
  assertEquals(1,sheet1.getPhysicalNumberOfRows());
  row=sheet1.getRow(0);
  assertNotNull(row);
  Cell cell=row.getCell(0);
  assertNotNull(cell);
  assertEquals("A",cell.getStringCellValue());
  cell=row.getCell(1);
  assertNotNull(cell);
  assertEquals("B",cell.getStringCellValue());
  cell=row.getCell(2);
  assertNotNull(cell);
  assertEquals("A",cell.getStringCellValue());
  xssfWorkbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addToExistingWorkbook() throws IOException {
  XSSFWorkbook xssfWb1=new XSSFWorkbook();
  xssfWb1.createSheet("S1");
  Sheet sheet=xssfWb1.createSheet("S2");
  Row row=sheet.createRow(1);
  Cell cell=row.createCell(1);
  cell.setCellValue("value 2_1_1");
  SXSSFWorkbook wb1=new SXSSFWorkbook(xssfWb1);
  XSSFWorkbook xssfWb2=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb1);
  assertTrue(wb1.dispose());
  xssfWb1.close();
  SXSSFWorkbook wb2=new SXSSFWorkbook(xssfWb2);
  Sheet sheet1=wb2.getSheetAt(0);
  Row row1_1=sheet1.createRow(1);
  Cell cell1_1_1=row1_1.createCell(1);
  cell1_1_1.setCellValue("value 1_1_1");
  Sheet sheet2=wb2.getSheetAt(1);
  Row row2_2=sheet2.createRow(2);
  Cell cell2_2_1=row2_2.createCell(1);
  cell2_2_1.setCellValue("value 2_2_1");
  Sheet sheet3=wb2.createSheet("S3");
  Row row3_1=sheet3.createRow(1);
  Cell cell3_1_1=row3_1.createCell(1);
  cell3_1_1.setCellValue("value 3_1_1");
  XSSFWorkbook xssfWb3=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb2);
  wb2.close();
  assertEquals(3,xssfWb3.getNumberOfSheets());
  sheet1=xssfWb3.getSheetAt(0);
  assertEquals("S1",sheet1.getSheetName());
  assertEquals(1,sheet1.getPhysicalNumberOfRows());
  row1_1=sheet1.getRow(1);
  assertNotNull(row1_1);
  cell1_1_1=row1_1.getCell(1);
  assertNotNull(cell1_1_1);
  assertEquals("value 1_1_1",cell1_1_1.getStringCellValue());
  sheet2=xssfWb3.getSheetAt(1);
  assertEquals("S2",sheet2.getSheetName());
  assertEquals(2,sheet2.getPhysicalNumberOfRows());
  Row row2_1=sheet2.getRow(1);
  assertNotNull(row2_1);
  Cell cell2_1_1=row2_1.getCell(1);
  assertNotNull(cell2_1_1);
  assertEquals("value 2_1_1",cell2_1_1.getStringCellValue());
  row2_2=sheet2.getRow(2);
  assertNotNull(row2_2);
  cell2_2_1=row2_2.getCell(1);
  assertNotNull(cell2_2_1);
  assertEquals("value 2_2_1",cell2_2_1.getStringCellValue());
  sheet3=xssfWb3.getSheetAt(2);
  assertEquals("S3",sheet3.getSheetName());
  assertEquals(1,sheet3.getPhysicalNumberOfRows());
  row3_1=sheet3.getRow(1);
  assertNotNull(row3_1);
  cell3_1_1=row3_1.getCell(1);
  assertNotNull(cell3_1_1);
  assertEquals("value 3_1_1",cell3_1_1.getStringCellValue());
  xssfWb2.close();
  xssfWb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void existingWorkbook() throws IOException {
  XSSFWorkbook xssfWb1=new XSSFWorkbook();
  xssfWb1.createSheet("S1");
  SXSSFWorkbook wb1=new SXSSFWorkbook(xssfWb1);
  XSSFWorkbook xssfWb2=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb1);
  assertTrue(wb1.dispose());
  SXSSFWorkbook wb2=new SXSSFWorkbook(xssfWb2);
  assertEquals(1,wb2.getNumberOfSheets());
  Sheet sheet=wb2.getSheetAt(0);
  assertNotNull(sheet);
  assertEquals("S1",sheet.getSheetName());
  assertTrue(wb2.dispose());
  xssfWb2.close();
  xssfWb1.close();
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (short colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    assumeNotNull(c);
    assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
    ignoredFormulaTestCase(c.getCellFormula());
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestMultiSheetFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @return a constant from the local Result class denoting whether there were any evaluation
 * cases, and whether they all succeeded.
 */
@Test public void processFunctionRow(){
  Row r=sheet.getRow(formulasRowIdx);
  Cell expValue=r.getCell(SS.COLUMN_INDEX_EXPECTED_VALUE);
  assertNotNull("Missing expected values cell for function '" + targetFunctionName + ", test"+ targetTestName+ " (row "+ formulasRowIdx+ 1+ ")",expValue);
  Cell c=r.getCell(SS.COLUMN_INDEX_ACTUAL_VALUE);
  assumeNotNull(c);
  assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
  CellValue actValue=evaluator.evaluate(c);
  String msg=String.format(Locale.ROOT,"Function '%s': Test: '%s': Formula: %s @ %d:%d",targetFunctionName,targetTestName,c.getCellFormula(),formulasRowIdx,SS.COLUMN_INDEX_ACTUAL_VALUE);
  assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
    assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
  break;
case Cell.CELL_TYPE_BOOLEAN:
assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestUnfixedBugs </h4><pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test54071Simple(){
  double value1=41224.999988425923;
  double value2=41224.999988368058;
  int wholeDays1=(int)Math.floor(value1);
  int millisecondsInDay1=(int)((value1 - wholeDays1) * DateUtil.DAY_MILLISECONDS + 0.5);
  int wholeDays2=(int)Math.floor(value2);
  int millisecondsInDay2=(int)((value2 - wholeDays2) * DateUtil.DAY_MILLISECONDS + 0.5);
  assertEquals(wholeDays1,wholeDays2);
  assertEquals("The time-values are 5 milliseconds apart",millisecondsInDay1,millisecondsInDay2);
  int startYear=1900;
  int dayAdjust=-1;
  Calendar calendar1=LocaleUtil.getLocaleCalendar(startYear,0,wholeDays1 + dayAdjust);
  calendar1.set(Calendar.MILLISECOND,millisecondsInDay1);
  calendar1.add(Calendar.MILLISECOND,500);
  calendar1.clear(Calendar.MILLISECOND);
  Calendar calendar2=LocaleUtil.getLocaleCalendar(startYear,0,wholeDays2 + dayAdjust);
  calendar2.set(Calendar.MILLISECOND,millisecondsInDay2);
  calendar2.add(Calendar.MILLISECOND,500);
  calendar2.clear(Calendar.MILLISECOND);
  assertEquals(calendar1,calendar2);
  assertEquals(DateUtil.getJavaDate(value1,false),DateUtil.getJavaDate(value2,false));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug57294() throws IOException {
  Workbook wb=SXSSFITestDataProvider.instance.createWorkbook();
  Sheet sheet=wb.createSheet();
  Row row=sheet.createRow(0);
  Cell cell=row.createCell(0);
  RichTextString str=new XSSFRichTextString("Test rich text string");
  str.applyFont(2,4,(short)0);
  assertEquals(3,str.numFormattingRuns());
  cell.setCellValue(str);
  Workbook wbBack=SXSSFITestDataProvider.instance.writeOutAndReadBack(wb);
  wb.close();
  Cell cellBack=wbBack.getSheetAt(0).getRow(0).getCell(0);
  assertNotNull(cellBack);
  RichTextString strBack=cellBack.getRichStringCellValue();
  assertNotNull(strBack);
  assertEquals(3,strBack.numFormattingRuns());
  assertEquals(0,strBack.getIndexOfFormattingRun(0));
  assertEquals(2,strBack.getIndexOfFormattingRun(1));
  assertEquals(4,strBack.getIndexOfFormattingRun(2));
  wbBack.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFBugs </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Named ranges had the right reference, but
 * the wrong sheet name
 */
@Test public void bug45430() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("45430.xlsx");
  assertFalse(wb.isMacroEnabled());
  assertEquals(3,wb.getNumberOfNames());
  assertEquals(0,wb.getNameAt(0).getCTName().getLocalSheetId());
  assertFalse(wb.getNameAt(0).getCTName().isSetLocalSheetId());
  assertEquals("SheetA!$A$1",wb.getNameAt(0).getRefersToFormula());
  assertEquals("SheetA",wb.getNameAt(0).getSheetName());
  assertEquals(0,wb.getNameAt(1).getCTName().getLocalSheetId());
  assertFalse(wb.getNameAt(1).getCTName().isSetLocalSheetId());
  assertEquals("SheetB!$A$1",wb.getNameAt(1).getRefersToFormula());
  assertEquals("SheetB",wb.getNameAt(1).getSheetName());
  assertEquals(0,wb.getNameAt(2).getCTName().getLocalSheetId());
  assertFalse(wb.getNameAt(2).getCTName().isSetLocalSheetId());
  assertEquals("SheetC!$A$1",wb.getNameAt(2).getRefersToFormula());
  assertEquals("SheetC",wb.getNameAt(2).getSheetName());
  XSSFWorkbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertEquals(3,nwb.getNumberOfNames());
  assertEquals("SheetA!$A$1",nwb.getNameAt(0).getRefersToFormula());
  nwb.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug56315() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("56315.xlsx");
  Cell c=wb.getSheetAt(0).getRow(1).getCell(0);
  CellValue cv=wb.getCreationHelper().createFormulaEvaluator().evaluate(c);
  double rounded=cv.getNumberValue();
  assertEquals(0.1,rounded,0.0);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add comments to Sheet 1, when Sheet 2 already has
 * comments (so /xl/comments1.xml is taken)
 */
@Test public void bug51850() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("51850.xlsx");
  XSSFSheet sh1=wb1.getSheetAt(0);
  XSSFSheet sh2=wb1.getSheetAt(1);
  assertNotNull(sh2.getCommentsTable(false));
  assertEquals(1,sh2.getCommentsTable(false).getNumberOfComments());
  assertNull(sh1.getCommentsTable(false));
  CreationHelper factory=wb1.getCreationHelper();
  Drawing drawing=sh1.createDrawingPatriarch();
  ClientAnchor anchor=factory.createClientAnchor();
  anchor.setCol1(0);
  anchor.setCol2(4);
  anchor.setRow1(0);
  anchor.setRow2(1);
  Comment comment1=drawing.createCellComment(anchor);
  comment1.setString(factory.createRichTextString("I like this cell. It's my favourite."));
  comment1.setAuthor("Bob T. Fish");
  anchor=factory.createClientAnchor();
  anchor.setCol1(0);
  anchor.setCol2(4);
  anchor.setRow1(1);
  anchor.setRow2(1);
  Comment comment2=drawing.createCellComment(anchor);
  comment2.setString(factory.createRichTextString("This is much less fun..."));
  comment2.setAuthor("Bob T. Fish");
  Cell c1=sh1.getRow(0).createCell(4);
  c1.setCellValue(2.3);
  c1.setCellComment(comment1);
  Cell c2=sh1.getRow(0).createCell(5);
  c2.setCellValue(2.1);
  c2.setCellComment(comment2);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sh1=wb2.getSheetAt(0);
  sh2=wb2.getSheetAt(1);
  assertNotNull(sh2.getCommentsTable(false));
  assertEquals(1,sh2.getCommentsTable(false).getNumberOfComments());
  assertNotNull(sh1.getCommentsTable(false));
  assertEquals(2,sh1.getCommentsTable(false).getNumberOfComments());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Various ways of removing a cell formula should all zap the calcChain
 * entry.
 */
@Test public void bug49966() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("shared_formulas.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  CalculationChain cc=wb1.getCalculationChain();
  assertEquals("A2",cc.getCTCalcChain().getCArray(0).getR());
  assertEquals("A3",cc.getCTCalcChain().getCArray(1).getR());
  assertEquals("A4",cc.getCTCalcChain().getCArray(2).getR());
  assertEquals("A5",cc.getCTCalcChain().getCArray(3).getR());
  assertEquals("A6",cc.getCTCalcChain().getCArray(4).getR());
  assertEquals("A7",cc.getCTCalcChain().getCArray(5).getR());
  assertEquals("A8",cc.getCTCalcChain().getCArray(6).getR());
  assertEquals(40,cc.getCTCalcChain().sizeOfCArray());
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  sheet.getRow(1).getCell(0).setCellFormula("A1");
  sheet.getRow(2).getCell(0).setCellFormula(null);
  sheet.getRow(3).getCell(0).setCellType(Cell.CELL_TYPE_FORMULA);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  sheet.getRow(4).getCell(0).setCellType(Cell.CELL_TYPE_STRING);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  validateCells(sheet);
  sheet.getRow(5).removeCell(sheet.getRow(5).getCell(0));
  validateCells(sheet);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  sheet.getRow(6).getCell(0).setCellType(Cell.CELL_TYPE_BLANK);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  sheet.getRow(7).getCell(0).setCellValue((String)null);
  XSSFTestDataSamples.writeOutAndReadBack(wb1).close();
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(35,cc.getCTCalcChain().sizeOfCArray());
  cc=wb2.getCalculationChain();
  assertEquals("A2",cc.getCTCalcChain().getCArray(0).getR());
  assertEquals("A4",cc.getCTCalcChain().getCArray(1).getR());
  assertEquals("A9",cc.getCTCalcChain().getCArray(2).getR());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * We should carry vba macros over after save
 * @throws InvalidFormatException 
 */
@Test public void bug45431() throws IOException, InvalidFormatException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("45431.xlsm");
  OPCPackage pkg1=wb1.getPackage();
  assertTrue(wb1.isMacroEnabled());
  PackagePart vba=pkg1.getPart(PackagingURIHelper.createPartName("/xl/vbaProject.bin"));
  assertNotNull(vba);
  PackagePart drw=pkg1.getPart(PackagingURIHelper.createPartName("/xl/drawings/vmlDrawing1.vml"));
  assertNotNull(drw);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  pkg1.close();
  wb1.close();
  OPCPackage pkg2=wb2.getPackage();
  assertTrue(wb2.isMacroEnabled());
  vba=pkg2.getPart(PackagingURIHelper.createPartName("/xl/vbaProject.bin"));
  assertNotNull(vba);
  drw=pkg2.getPart(PackagingURIHelper.createPartName("/xl/drawings/vmlDrawing1.vml"));
  assertNotNull(drw);
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  pkg2.close();
  wb2.close();
  OPCPackage pkg3=wb3.getPackage();
  assertTrue(wb3.isMacroEnabled());
  vba=pkg3.getPart(PackagingURIHelper.createPartName("/xl/vbaProject.bin"));
  assertNotNull(vba);
  drw=pkg3.getPart(PackagingURIHelper.createPartName("/xl/drawings/vmlDrawing1.vml"));
  assertNotNull(drw);
  pkg3.close();
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Regression between 3.10.1 and 3.13 - 
 * org.apache.poi.openxml4j.exceptions.InvalidFormatException: 
 * The part /xl/sharedStrings.xml does not have any content type 
 * ! Rule: Package require content types when retrieving a part from a package. [M.1.14]
 */
@Test public void test58760() throws Exception {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("58760.xlsx");
  assertEquals(1,wb.getNumberOfSheets());
  assertEquals("Sheet1",wb.getSheetName(0));
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertEquals(1,wb.getNumberOfSheets());
  assertEquals("Sheet1",wb.getSheetName(0));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * OOXML-Strict files
 * Not currently working - namespace mis-match from XMLBeans
 */
@Test @Ignore("XMLBeans namespace mis-match on ooxml-strict files") public void test57699() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("sample.strict.xlsx");
  assertEquals(3,wb.getNumberOfSheets());
  XSSFWorkbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertEquals(3,wbBack.getNumberOfSheets());
  wb.close();
  wbBack.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Adding sheets when one has a table, then re-ordering
 */
@Test public void bug50867() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("50867_with_table.xlsx");
  assertEquals(3,wb1.getNumberOfSheets());
  XSSFSheet s1=wb1.getSheetAt(0);
  XSSFSheet s2=wb1.getSheetAt(1);
  XSSFSheet s3=wb1.getSheetAt(2);
  assertEquals(1,s1.getTables().size());
  assertEquals(0,s2.getTables().size());
  assertEquals(0,s3.getTables().size());
  XSSFTable t=s1.getTables().get(0);
  assertEquals("Tabella1",t.getName());
  assertEquals("Tabella1",t.getDisplayName());
  assertEquals("A1:C3",t.getCTTable().getRef());
  XSSFSheet s4=wb1.createSheet("NewSheet");
  wb1.setSheetOrder(s4.getSheetName(),0);
  assertEquals(1,s1.getTables().size());
  assertEquals(0,s2.getTables().size());
  assertEquals(0,s3.getTables().size());
  assertEquals(0,s4.getTables().size());
  s1=wb1.getSheetAt(0);
  s2=wb1.getSheetAt(1);
  s3=wb1.getSheetAt(2);
  s4=wb1.getSheetAt(3);
  assertEquals(0,s1.getTables().size());
  assertEquals(1,s2.getTables().size());
  assertEquals(0,s3.getTables().size());
  assertEquals(0,s4.getTables().size());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  s1=wb2.getSheetAt(0);
  s2=wb2.getSheetAt(1);
  s3=wb2.getSheetAt(2);
  s4=wb2.getSheetAt(3);
  assertEquals(0,s1.getTables().size());
  assertEquals(1,s2.getTables().size());
  assertEquals(0,s3.getTables().size());
  assertEquals(0,s4.getTables().size());
  t=s2.getTables().get(0);
  assertEquals("Tabella1",t.getName());
  assertEquals("Tabella1",t.getDisplayName());
  assertEquals("A1:C3",t.getCTTable().getRef());
  t=s2.createTable();
  t.setName("New 2");
  t.setDisplayName("New 2");
  t=s3.createTable();
  t.setName("New 3");
  t.setDisplayName("New 3");
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  s1=wb3.getSheetAt(0);
  s2=wb3.getSheetAt(1);
  s3=wb3.getSheetAt(2);
  s4=wb3.getSheetAt(3);
  assertEquals(0,s1.getTables().size());
  assertEquals(2,s2.getTables().size());
  assertEquals(1,s3.getTables().size());
  assertEquals(0,s4.getTables().size());
  t=s2.getTables().get(0);
  assertEquals("Tabella1",t.getName());
  assertEquals("Tabella1",t.getDisplayName());
  assertEquals("A1:C3",t.getCTTable().getRef());
  t=s2.getTables().get(1);
  assertEquals("New 2",t.getName());
  assertEquals("New 2",t.getDisplayName());
  t=s3.getTables().get(0);
  assertEquals("New 3",t.getName());
  assertEquals("New 3",t.getDisplayName());
  assertEquals(0,s1.getRelations().size());
  assertEquals(3,s2.getRelations().size());
  assertEquals(1,s3.getRelations().size());
  assertEquals(0,s4.getRelations().size());
  assertEquals(XSSFRelation.PRINTER_SETTINGS.getContentType(),s2.getRelations().get(0).getPackagePart().getContentType());
  assertEquals(XSSFRelation.TABLE.getContentType(),s2.getRelations().get(1).getPackagePart().getContentType());
  assertEquals(XSSFRelation.TABLE.getContentType(),s2.getRelations().get(2).getPackagePart().getContentType());
  assertEquals(XSSFRelation.TABLE.getContentType(),s3.getRelations().get(0).getPackagePart().getContentType());
  assertEquals("/xl/tables/table3.xml",s3.getRelations().get(0).getPackagePart().getPartName().toString());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test58315() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("58315.xlsx");
  Cell cell=wb.getSheetAt(0).getRow(0).getCell(0);
  assertNotNull(cell);
  StringBuilder tmpCellContent=new StringBuilder(cell.getStringCellValue());
  XSSFRichTextString richText=(XSSFRichTextString)cell.getRichStringCellValue();
  for (int i=richText.length() - 1; i >= 0; i--) {
    Font f=richText.getFontAtIndex(i);
    if (f != null && f.getStrikeout()) {
      tmpCellContent.deleteCharAt(i);
    }
  }
  String result=tmpCellContent.toString();
  assertEquals("320 350",result);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A .xlsx file with no Shared Strings table should open fine
 * in read-only mode
 * @throws InvalidFormatException 
 */
@Test public void bug57482() throws IOException, InvalidFormatException {
  for (  PackageAccess access : new PackageAccess[]{PackageAccess.READ_WRITE,PackageAccess.READ}) {
    File file=HSSFTestDataSamples.getSampleFile("57482-OnlyNumeric.xlsx");
    OPCPackage pkg=OPCPackage.open(file,access);
    try {
      XSSFWorkbook wb1=new XSSFWorkbook(pkg);
      assertNotNull(wb1.getSharedStringSource());
      assertEquals(0,wb1.getSharedStringSource().getCount());
      DataFormatter fmt=new DataFormatter();
      XSSFSheet s=wb1.getSheetAt(0);
      assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
      assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
      assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
      s.getRow(0).createCell(3).setCellValue("Testing");
      assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      XSSFWorkbook wb2=null;
      try {
        wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
        if (access == PackageAccess.READ) {
          fail("Shouln't be able to write from read-only mode");
        }
        s=wb2.getSheetAt(0);
        assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
        assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
        assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
        assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      }
 catch (      InvalidOperationException e) {
        if (access == PackageAccess.READ_WRITE) {
          throw e;
        }
      }
 finally {
        if (wb2 != null) {
          wb2.getPackage().revert();
        }
      }
      wb1.getPackage().revert();
    }
  finally {
      pkg.revert();
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * .xlsx supports 64000 cell styles, the style indexes after
 * 32,767 must not be -32,768, then -32,767, -32,766
 */
@Test public void bug57880() throws IOException {
  int numStyles=33000;
  XSSFWorkbook wb=new XSSFWorkbook();
  for (int i=1; i < numStyles; i++) {
    XSSFCellStyle style=wb.createCellStyle();
    assertEquals(i,style.getUIndex());
  }
  assertEquals(numStyles,wb.getNumCellStyles());
  File file=XSSFTestDataSamples.writeOutAndClose(wb,"bug57880");
  wb=null;
  double ratio=ZipSecureFile.getMinInflateRatio();
  ZipSecureFile.setMinInflateRatio(0.00005);
  wb=XSSFTestDataSamples.readBackAndDelete(file);
  ZipSecureFile.setMinInflateRatio(ratio);
  assertEquals(numStyles,wb.getNumCellStyles());
  for (int i=1; i < numStyles; i++) {
    XSSFCellStyle style=wb.getCellStyleAt(i);
    assertNotNull(style);
    assertEquals(i,style.getUIndex());
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Default Column style
 */
@Test public void bug51037() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet s=wb.createSheet();
  CellStyle defaultStyle=wb.getCellStyleAt((short)0);
  assertEquals(0,defaultStyle.getIndex());
  CellStyle blueStyle=wb.createCellStyle();
  blueStyle.setFillForegroundColor(IndexedColors.AQUA.getIndex());
  blueStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);
  assertEquals(1,blueStyle.getIndex());
  CellStyle pinkStyle=wb.createCellStyle();
  pinkStyle.setFillForegroundColor(IndexedColors.PINK.getIndex());
  pinkStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);
  assertEquals(2,pinkStyle.getIndex());
  assertEquals(1,s.getCTWorksheet().sizeOfColsArray());
  CTCols cols=s.getCTWorksheet().getColsArray(0);
  assertEquals(0,cols.sizeOfColArray());
  XSSFRow r1=s.createRow(0);
  XSSFRow r2=s.createRow(1);
  r1.createCell(0);
  r1.createCell(2);
  r2.createCell(0);
  r2.createCell(3);
  assertEquals(1,s.getCTWorksheet().sizeOfColsArray());
  assertEquals(0,cols.sizeOfColArray());
  assertEquals(defaultStyle,s.getColumnStyle(0));
  assertEquals(defaultStyle,s.getColumnStyle(2));
  assertEquals(defaultStyle,s.getColumnStyle(3));
  s.setDefaultColumnStyle(0,pinkStyle);
  s.setDefaultColumnStyle(3,blueStyle);
  assertEquals(pinkStyle,s.getColumnStyle(0));
  assertEquals(defaultStyle,s.getColumnStyle(2));
  assertEquals(blueStyle,s.getColumnStyle(3));
  assertEquals(1,s.getCTWorksheet().sizeOfColsArray());
  assertEquals(2,cols.sizeOfColArray());
  assertEquals(1,cols.getColArray(0).getMin());
  assertEquals(1,cols.getColArray(0).getMax());
  assertEquals(pinkStyle.getIndex(),cols.getColArray(0).getStyle());
  assertEquals(4,cols.getColArray(1).getMin());
  assertEquals(4,cols.getColArray(1).getMax());
  assertEquals(blueStyle.getIndex(),cols.getColArray(1).getStyle());
  XSSFWorkbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  s=wbBack.getSheetAt(0);
  defaultStyle=wbBack.getCellStyleAt(defaultStyle.getIndex());
  blueStyle=wbBack.getCellStyleAt(blueStyle.getIndex());
  pinkStyle=wbBack.getCellStyleAt(pinkStyle.getIndex());
  assertEquals(pinkStyle,s.getColumnStyle(0));
  assertEquals(defaultStyle,s.getColumnStyle(2));
  assertEquals(blueStyle,s.getColumnStyle(3));
  wbBack.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Creating a rich string of "hello world" and applying
 * a font to characters 1-5 means we have two strings,
 * "hello" and " world". As such, we need to apply
 * preserve spaces to the 2nd bit, lest we end up
 * with something like "helloworld" !
 */
@Test public void bug49941() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet s=wb1.createSheet();
  XSSFRow r=s.createRow(0);
  XSSFCell c=r.createCell(0);
  c.setCellValue(new XSSFRichTextString(" with spaces "));
  assertEquals(" with spaces ",c.getRichStringCellValue().toString());
  assertEquals(0,c.getRichStringCellValue().getCTRst().sizeOfRArray());
  assertEquals(true,c.getRichStringCellValue().getCTRst().isSetT());
  assertEquals(1,c.getRichStringCellValue().getCTRst().xgetT().getDomNode().getAttributes().getLength());
  assertEquals("preserve",c.getRichStringCellValue().getCTRst().xgetT().getDomNode().getAttributes().item(0).getNodeValue());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheetAt(0);
  r=s.getRow(0);
  c=r.getCell(0);
  assertEquals(" with spaces ",c.getRichStringCellValue().toString());
  assertEquals(0,c.getRichStringCellValue().getCTRst().sizeOfRArray());
  assertEquals(true,c.getRichStringCellValue().getCTRst().isSetT());
  c.setCellValue(new XSSFRichTextString("hello world"));
  assertEquals("hello world",c.getRichStringCellValue().toString());
  assertEquals(0,c.getRichStringCellValue().getCTRst().xgetT().getDomNode().getAttributes().getLength());
  XSSFFont f=wb2.createFont();
  f.setBold(true);
  c.getRichStringCellValue().applyFont(0,5,f);
  assertEquals("hello world",c.getRichStringCellValue().toString());
  assertEquals(2,c.getRichStringCellValue().getCTRst().sizeOfRArray());
  assertEquals(0,c.getRichStringCellValue().getCTRst().getRArray(0).xgetT().getDomNode().getAttributes().getLength());
  assertEquals(1,c.getRichStringCellValue().getCTRst().getRArray(1).xgetT().getDomNode().getAttributes().getLength());
  assertEquals("preserve",c.getRichStringCellValue().getCTRst().getRArray(1).xgetT().getDomNode().getAttributes().item(0).getNodeValue());
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  s=wb3.getSheetAt(0);
  r=s.getRow(0);
  c=r.getCell(0);
  assertEquals("hello world",c.getRichStringCellValue().toString());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Moving a cell comment from one cell to another
 */
@Test public void bug50795() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("50795.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  XSSFRow row=sheet.getRow(0);
  XSSFCell cellWith=row.getCell(0);
  XSSFCell cellWithoutComment=row.getCell(1);
  assertNotNull(cellWith.getCellComment());
  assertNull(cellWithoutComment.getCellComment());
  String exp="\u0410\u0432\u0442\u043e\u0440:\ncomment";
  XSSFComment comment=cellWith.getCellComment();
  assertEquals(exp,comment.getString().getString());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  row=sheet.getRow(0);
  cellWith=row.getCell(0);
  cellWithoutComment=row.getCell(1);
  assertNotNull(cellWith.getCellComment());
  assertNull(cellWithoutComment.getCellComment());
  comment=cellWith.getCellComment();
  assertEquals(exp,comment.getString().getString());
  cellWithoutComment.setCellComment(comment);
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sheet=wb3.getSheetAt(0);
  row=sheet.getRow(0);
  cellWith=row.getCell(0);
  cellWithoutComment=row.getCell(1);
  assertNull(cellWith.getCellComment());
  assertNotNull(cellWithoutComment.getCellComment());
  comment=cellWithoutComment.getCellComment();
  assertEquals(exp,comment.getString().getString());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug47504() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47504.xlsx");
  assertEquals(1,wb1.getNumberOfSheets());
  XSSFSheet sh=wb1.getSheetAt(0);
  XSSFDrawing drawing=sh.createDrawingPatriarch();
  List<RelationPart> rels=drawing.getRelationParts();
  assertEquals(1,rels.size());
  assertEquals("Sheet1!A1",rels.get(0).getRelationship().getTargetURI().getFragment());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(1,wb2.getNumberOfSheets());
  sh=wb2.getSheetAt(0);
  drawing=sh.createDrawingPatriarch();
  rels=drawing.getRelationParts();
  assertEquals(1,rels.size());
  assertEquals("Sheet1!A1",rels.get(0).getRelationship().getTargetURI().getFragment());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Paragraph with property BuFont but none of the properties
 * BuNone, BuChar, and BuAutoNum, used to trigger a NPE
 * Excel treats this as not-bulleted, so now do we
 */
@Test public void testBug57826() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("57826.xlsx");
  assertTrue("no sheets in workbook",workbook.getNumberOfSheets() >= 1);
  XSSFSheet sheet=workbook.getSheetAt(0);
  XSSFDrawing drawing=sheet.getDrawingPatriarch();
  assertNotNull(drawing);
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(1,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFSimpleShape);
  XSSFSimpleShape shape=(XSSFSimpleShape)shapes.get(0);
  String text=shape.getText();
  assertEquals("test ok",text);
  workbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug56468() throws IOException, InterruptedException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sheet=wb.createSheet();
  XSSFRow row=sheet.createRow(0);
  XSSFCell cell=row.createCell(0);
  cell.setCellValue("Hi");
  sheet.setRepeatingRows(new CellRangeAddress(0,0,0,0));
  long start=System.currentTimeMillis() / 1000;
  while (System.currentTimeMillis() / 1000 == start) {
    Thread.sleep(10);
  }
  ByteArrayOutputStream bos=new ByteArrayOutputStream(8096);
  wb.write(bos);
  byte firstSave[]=bos.toByteArray();
  bos.reset();
  wb.write(bos);
  byte secondSave[]=bos.toByteArray();
  assertArrayEquals("Had: \n" + Arrays.toString(firstSave) + " and \n"+ Arrays.toString(secondSave),firstSave,secondSave);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test51998() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("51998.xlsx");
  Set<String> sheetNames=new HashSet<String>();
  for (int sheetNum=0; sheetNum < wb.getNumberOfSheets(); sheetNum++) {
    sheetNames.add(wb.getSheetName(sheetNum));
  }
  for (  String sheetName : sheetNames) {
    int sheetIndex=wb.getSheetIndex(sheetName);
    wb.removeSheetAt(sheetIndex);
    Sheet newSheet=wb.createSheet();
    int newSheetIndex=wb.getSheetIndex(newSheet);
    wb.setSheetName(newSheetIndex,sheetName);
    wb.setSheetOrder(sheetName,sheetIndex);
  }
  Workbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertNotNull(wbBack);
  wbBack.close();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug55692_npoifs() throws IOException {
  NPOIFSFileSystem fsNP=new NPOIFSFileSystem(POIDataSamples.getPOIFSInstance().openResourceAsStream("protect.xlsx"));
  Workbook wb=WorkbookFactory.create(fsNP);
  assertNotNull(wb);
  assertEquals(3,wb.getNumberOfSheets());
  wb.close();
  fsNP.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bug51470() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("51470.xlsx");
  XSSFSheet sh0=wb.getSheetAt(0);
  XSSFSheet sh1=wb.cloneSheet(0);
  List<RelationPart> rels0=sh0.getRelationParts();
  List<RelationPart> rels1=sh1.getRelationParts();
  assertEquals(1,rels0.size());
  assertEquals(1,rels1.size());
  PackageRelationship pr0=rels0.get(0).getRelationship();
  PackageRelationship pr1=rels1.get(0).getRelationship();
  assertEquals(pr0.getTargetMode(),pr1.getTargetMode());
  assertEquals(pr0.getTargetURI(),pr1.getTargetURI());
  POIXMLDocumentPart doc0=rels0.get(0).getDocumentPart();
  POIXMLDocumentPart doc1=rels1.get(0).getDocumentPart();
  assertEquals(doc0,doc1);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * New lines were being eaten when setting a font on
 * a rich text string
 */
@Test public void bug48877() throws IOException {
  String text="Use \n with word wrap on to create a new line.\n" + "This line finishes with two trailing spaces.  ";
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet();
  Font font1=wb1.createFont();
  font1.setColor((short)20);
  Font font2=wb1.createFont();
  font2.setColor(Font.COLOR_RED);
  Font font3=wb1.getFontAt((short)0);
  XSSFRow row=sheet.createRow(2);
  XSSFCell cell=row.createCell(2);
  XSSFRichTextString richTextString=wb1.getCreationHelper().createRichTextString(text);
  assertEquals(text,richTextString.getString());
  richTextString.applyFont(font3);
  richTextString.applyFont(0,3,font1);
  cell.setCellValue(richTextString);
  CellStyle cs=wb1.createCellStyle();
  cs.setWrapText(true);
  cell.setCellStyle(cs);
  assertEquals(text,cell.getStringCellValue());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  row=sheet.getRow(2);
  cell=row.getCell(2);
  assertEquals(text,cell.getStringCellValue());
  int fontAt=text.indexOf("\n",6);
  cell.getRichStringCellValue().applyFont(10,fontAt + 1,font2);
  assertEquals(text,cell.getStringCellValue());
  assertEquals(4,cell.getRichStringCellValue().numFormattingRuns());
  assertEquals("Use",cell.getRichStringCellValue().getCTRst().getRArray(0).getT());
  String r3=cell.getRichStringCellValue().getCTRst().getRArray(2).getT();
  assertEquals("line.\n",r3.substring(r3.length() - 6));
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  wb2.close();
  sheet=wb3.getSheetAt(0);
  row=sheet.getRow(2);
  cell=row.getCell(2);
  assertEquals(text,cell.getStringCellValue());
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Was giving NullPointerException
 * at org.apache.poi.xssf.usermodel.XSSFWorkbook.onDocumentRead
 * due to a lack of Styles Table
 */
@Test public void bug56278() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("56278.xlsx");
  assertEquals(0,wb.getSheetIndex("Market Rates"));
  Workbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertEquals(0,nwb.getSheetIndex("Market Rates"));
  nwb.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test58731() throws Exception {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("58731.xlsx");
  Sheet sheet=wb.createSheet("Java Books");
  Object[][] bookData={{"Head First Java","Kathy Serria",79},{"Effective Java","Joshua Bloch",36},{"Clean Code","Robert martin",42},{"Thinking in Java","Bruce Eckel",35}};
  int rowCount=0;
  for (  Object[] aBook : bookData) {
    Row row=sheet.createRow(rowCount++);
    int columnCount=0;
    for (    Object field : aBook) {
      Cell cell=row.createCell(columnCount++);
      if (field instanceof String) {
        cell.setCellValue((String)field);
      }
 else       if (field instanceof Integer) {
        cell.setCellValue((Integer)field);
      }
    }
  }
  Workbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb);
  sheet=wb2.getSheet("Java Books");
  assertNotNull(sheet.getRow(0));
  assertNotNull(sheet.getRow(0).getCell(0));
  assertEquals(bookData[0][0],sheet.getRow(0).getCell(0).getStringCellValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFCell </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncodingbeloAscii() throws Exception {
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < Character.MAX_VALUE; i++) {
    sb.append((char)i);
  }
  String strAll=sb.toString();
  int pos=0;
  while (pos < strAll.length()) {
    String str=strAll.substring(pos,Math.min(strAll.length(),pos + SpreadsheetVersion.EXCEL2007.getMaxTextLength()));
    Workbook wb=HSSFITestDataProvider.instance.createWorkbook();
    Cell cell=wb.createSheet().createRow(0).createCell(0);
    Workbook xwb=XSSFITestDataProvider.instance.createWorkbook();
    Cell xCell=xwb.createSheet().createRow(0).createCell(0);
    Workbook swb=SXSSFITestDataProvider.instance.createWorkbook();
    Cell sCell=swb.createSheet().createRow(0).createCell(0);
    cell.setCellValue(str);
    assertEquals(str,cell.getStringCellValue());
    xCell.setCellValue(str);
    assertEquals(str,xCell.getStringCellValue());
    sCell.setCellValue(str);
    assertEquals(str,sCell.getStringCellValue());
    Workbook wbBack=HSSFITestDataProvider.instance.writeOutAndReadBack(wb);
    Workbook xwbBack=XSSFITestDataProvider.instance.writeOutAndReadBack(xwb);
    Workbook swbBack=SXSSFITestDataProvider.instance.writeOutAndReadBack(swb);
    cell=wbBack.getSheetAt(0).createRow(0).createCell(0);
    xCell=xwbBack.getSheetAt(0).createRow(0).createCell(0);
    sCell=swbBack.getSheetAt(0).createRow(0).createCell(0);
    assertEquals(cell.getStringCellValue(),xCell.getStringCellValue());
    assertEquals(cell.getStringCellValue(),sCell.getStringCellValue());
    pos+=SpreadsheetVersion.EXCEL97.getMaxTextLength();
    swbBack.close();
    xwbBack.close();
    wbBack.close();
    swb.close();
    xwb.close();
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test56170() throws IOException {
  final Workbook wb1=XSSFTestDataSamples.openSampleWorkbook("56170.xlsx");
  final XSSFSheet sheet=(XSSFSheet)wb1.getSheetAt(0);
  Workbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  Cell cell;
  Row row=sheet.getRow(0);
  Workbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  cell=row.createCell(0);
  Workbook wb4=XSSFTestDataSamples.writeOutAndReadBack(wb3);
  cell.setCellValue("demo1");
  Workbook wb5=XSSFTestDataSamples.writeOutAndReadBack(wb4);
  cell=row.createCell(1);
  Workbook wb6=XSSFTestDataSamples.writeOutAndReadBack(wb5);
  cell.setCellValue("demo2");
  Workbook wb7=XSSFTestDataSamples.writeOutAndReadBack(wb6);
  cell=row.createCell(2);
  Workbook wb8=XSSFTestDataSamples.writeOutAndReadBack(wb7);
  cell.setCellValue("demo3");
  Workbook wb9=XSSFTestDataSamples.writeOutAndReadBack(wb8);
  row=sheet.getRow(1);
  cell=row.createCell(0);
  cell.setCellValue("demo1");
  cell=row.createCell(1);
  cell.setCellValue("demo2");
  cell=row.createCell(2);
  cell.setCellValue("demo3");
  Workbook wb10=XSSFTestDataSamples.writeOutAndReadBack(wb9);
  XSSFTable table=sheet.getTables().get(0);
  final CellReference startRef=table.getStartCellReference();
  final CellReference endRef=table.getEndCellReference();
  table.getCTTable().setRef(new CellRangeAddress(startRef.getRow(),1,startRef.getCol(),endRef.getCol()).formatAsString());
  Workbook wb11=XSSFTestDataSamples.writeOutAndReadBack(wb10);
  assertNotNull(wb11);
  wb11.close();
  wb10.close();
  wb9.close();
  wb8.close();
  wb7.close();
  wb6.close();
  wb5.close();
  wb4.close();
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFCellStyle </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cloning one XSSFCellStyle onto Another, different XSSFWorkbooks
 */
@Test public void testCloneStyleDiffWB() throws IOException {
  XSSFWorkbook wbOrig=new XSSFWorkbook();
  assertEquals(1,wbOrig.getNumberOfFonts());
  assertEquals(0,wbOrig.getStylesSource().getNumberFormats().size());
  XSSFFont fnt=wbOrig.createFont();
  fnt.setFontName("TestingFont");
  assertEquals(2,wbOrig.getNumberOfFonts());
  assertEquals(0,wbOrig.getStylesSource().getNumberFormats().size());
  XSSFDataFormat fmt=wbOrig.createDataFormat();
  fmt.getFormat("MadeUpOne");
  fmt.getFormat("MadeUpTwo");
  XSSFCellStyle orig=wbOrig.createCellStyle();
  orig.setAlignment(HSSFCellStyle.ALIGN_RIGHT);
  orig.setFont(fnt);
  orig.setDataFormat(fmt.getFormat("Test##"));
  assertTrue(XSSFCellStyle.ALIGN_RIGHT == orig.getAlignment());
  assertTrue(fnt == orig.getFont());
  assertTrue(fmt.getFormat("Test##") == orig.getDataFormat());
  assertEquals(2,wbOrig.getNumberOfFonts());
  assertEquals(3,wbOrig.getStylesSource().getNumberFormats().size());
  XSSFWorkbook wbClone=new XSSFWorkbook();
  assertEquals(1,wbClone.getNumberOfFonts());
  assertEquals(0,wbClone.getStylesSource().getNumberFormats().size());
  assertEquals(1,wbClone.getNumCellStyles());
  XSSFDataFormat fmtClone=wbClone.createDataFormat();
  XSSFCellStyle clone=wbClone.createCellStyle();
  assertEquals(1,wbClone.getNumberOfFonts());
  assertEquals(0,wbClone.getStylesSource().getNumberFormats().size());
  assertFalse(HSSFCellStyle.ALIGN_RIGHT == clone.getAlignment());
  assertNotEquals("TestingFont",clone.getFont().getFontName());
  clone.cloneStyleFrom(orig);
  assertEquals(2,wbClone.getNumberOfFonts());
  assertEquals(2,wbClone.getNumCellStyles());
  assertEquals(1,wbClone.getStylesSource().getNumberFormats().size());
  assertEquals(HSSFCellStyle.ALIGN_RIGHT,clone.getAlignment());
  assertEquals("TestingFont",clone.getFont().getFontName());
  assertEquals(fmtClone.getFormat("Test##"),clone.getDataFormat());
  assertFalse(fmtClone.getFormat("Test##") == fmt.getFormat("Test##"));
  XSSFWorkbook wbReload=XSSFTestDataSamples.writeOutAndReadBack(wbClone);
  assertEquals(2,wbReload.getNumberOfFonts());
  assertEquals(2,wbReload.getNumCellStyles());
  assertEquals(1,wbReload.getStylesSource().getNumberFormats().size());
  XSSFCellStyle reload=wbReload.getCellStyleAt((short)1);
  assertEquals(HSSFCellStyle.ALIGN_RIGHT,reload.getAlignment());
  assertEquals("TestingFont",reload.getFont().getFontName());
  assertEquals(fmtClone.getFormat("Test##"),reload.getDataFormat());
  assertFalse(fmtClone.getFormat("Test##") == fmt.getFormat("Test##"));
  XSSFWorkbook wbOrig2=XSSFTestDataSamples.writeOutAndReadBack(wbOrig);
  assertNotNull(wbOrig2);
  wbOrig2.close();
  XSSFWorkbook wbClone2=XSSFTestDataSamples.writeOutAndReadBack(wbClone);
  assertNotNull(wbClone2);
  wbClone2.close();
  wbReload.close();
  wbClone.close();
  wbOrig.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cloning one XSSFCellStyle onto Another, same XSSFWorkbook
 */
@Test public void testCloneStyleSameWB() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  assertEquals(1,wb.getNumberOfFonts());
  XSSFFont fnt=wb.createFont();
  fnt.setFontName("TestingFont");
  assertEquals(2,wb.getNumberOfFonts());
  XSSFCellStyle orig=wb.createCellStyle();
  orig.setAlignment(HSSFCellStyle.ALIGN_RIGHT);
  orig.setFont(fnt);
  orig.setDataFormat((short)18);
  assertTrue(HSSFCellStyle.ALIGN_RIGHT == orig.getAlignment());
  assertTrue(fnt == orig.getFont());
  assertTrue(18 == orig.getDataFormat());
  XSSFCellStyle clone=wb.createCellStyle();
  assertFalse(HSSFCellStyle.ALIGN_RIGHT == clone.getAlignment());
  assertFalse(fnt == clone.getFont());
  assertFalse(18 == clone.getDataFormat());
  clone.cloneStyleFrom(orig);
  assertTrue(HSSFCellStyle.ALIGN_RIGHT == clone.getAlignment());
  assertTrue(fnt == clone.getFont());
  assertTrue(18 == clone.getDataFormat());
  assertEquals(2,wb.getNumberOfFonts());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertNotNull(wb2);
  wb2.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Avoid ArrayIndexOutOfBoundsException  when getting cell style
 * in a workbook that has an empty xf table.
 */
@Test public void testBug55650() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("52348.xlsx");
  StylesTable st=workbook.getStylesSource();
  assertEquals(0,st._getStyleXfsSize());
  XSSFCellStyle style=workbook.getSheetAt(0).getRow(0).getCell(0).getCellStyle();
  assertNull(style.getStyleXf());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertNotNull(wb2);
  wb2.close();
  workbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetColor() throws IOException {
  Workbook wb=new XSSFWorkbook();
  Sheet sheet=wb.createSheet();
  Row row=sheet.createRow(0);
  DataFormat format=wb.createDataFormat();
  Cell cell=row.createCell(1);
  cell.setCellValue("somevalue");
  CellStyle cellStyle2=wb.createCellStyle();
  cellStyle2.setDataFormat(format.getFormat("###0"));
  cellStyle2.setFillBackgroundColor(IndexedColors.DARK_BLUE.getIndex());
  cellStyle2.setFillForegroundColor(IndexedColors.DARK_BLUE.getIndex());
  cellStyle2.setFillPattern(CellStyle.SOLID_FOREGROUND);
  cellStyle2.setAlignment(CellStyle.ALIGN_RIGHT);
  cellStyle2.setVerticalAlignment(CellStyle.VERTICAL_TOP);
  cell.setCellStyle(cellStyle2);
  Workbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  Cell cellBack=wbBack.getSheetAt(0).getRow(0).getCell(1);
  assertNotNull(cellBack);
  CellStyle styleBack=cellBack.getCellStyle();
  assertEquals(IndexedColors.DARK_BLUE.getIndex(),styleBack.getFillBackgroundColor());
  assertEquals(IndexedColors.DARK_BLUE.getIndex(),styleBack.getFillForegroundColor());
  assertEquals(CellStyle.ALIGN_RIGHT,styleBack.getAlignment());
  assertEquals(CellStyle.VERTICAL_TOP,styleBack.getVerticalAlignment());
  assertEquals(CellStyle.SOLID_FOREGROUND,styleBack.getFillPattern());
  wbBack.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShrinkToFit() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("ShrinkToFit.xlsx");
  Sheet s=wb1.getSheetAt(0);
  Row r=s.getRow(0);
  CellStyle cs=r.getCell(0).getCellStyle();
  assertEquals(true,cs.getShrinkToFit());
  XSSFWorkbook wb2=new XSSFWorkbook();
  s=wb2.createSheet();
  r=s.createRow(0);
  cs=wb2.createCellStyle();
  cs.setShrinkToFit(false);
  r.createCell(0).setCellStyle(cs);
  cs=wb2.createCellStyle();
  cs.setShrinkToFit(true);
  r.createCell(1).setCellStyle(cs);
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  s=wb3.getSheetAt(0);
  r=s.getRow(0);
  assertEquals(false,r.getCell(0).getCellStyle().getShrinkToFit());
  assertEquals(true,r.getCell(1).getCellStyle().getShrinkToFit());
  XSSFWorkbook wb4=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  assertNotNull(wb4);
  wb4.close();
  XSSFWorkbook wb5=XSSFTestDataSamples.writeOutAndReadBack(wb3);
  assertNotNull(wb5);
  wb5.close();
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Avoid ArrayIndexOutOfBoundsException  when creating cell style
 * in a workbook that has an empty xf table.
 */
@Test public void testBug52348() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("52348.xlsx");
  StylesTable st=workbook.getStylesSource();
  assertEquals(0,st._getStyleXfsSize());
  XSSFCellStyle style=workbook.createCellStyle();
  assertNull(style.getStyleXf());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertNotNull(wb2);
  wb2.close();
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFColGrouping </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_1_MINOR
 */
@Test public void testMergingOverlappingCols_OVERLAPS_1_MINOR() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)3,(short)5);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_1_MINOR/cols:" + cols);
  assertEquals(0,cols.getColArray(0).getOutlineLevel());
  assertEquals(3,cols.getColArray(0).getMin());
  assertEquals(3,cols.getColArray(0).getMax());
  assertEquals(true,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(4,cols.getColArray(1).getMin());
  assertEquals(5,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(1,cols.getColArray(2).getOutlineLevel());
  assertEquals(6,cols.getColArray(2).getMin());
  assertEquals(6,cols.getColArray(2).getMax());
  assertEquals(false,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_1_MINOR");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  assertEquals("Unexpected width of column " + 5,sheet.getDefaultColumnWidth() * 256,sheet.getColumnWidth(5));
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that POI doesn't produce "col" elements without "width" attribute. 
 * POI-52186
 */
@Test public void testNoColsWithoutWidthWhenGroupingAndCollapsing() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  sheet.setColumnWidth(4,5000);
  sheet.setColumnWidth(5,5000);
  sheet.groupColumn((short)4,(short)5);
  sheet.setColumnGroupCollapsed(4,true);
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"test52186_2/cols:" + cols);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testNoColsWithoutWidthWhenGroupingAndCollapsing");
  sheet=wb2.getSheet("test");
  for (int i=4; i <= 5; i++) {
    assertEquals("Unexpected width of column " + i,5000,sheet.getColumnWidth(i));
  }
  cols=sheet.getCTWorksheet().getColsArray(0);
  for (  CTCol col : cols.getColArray()) {
    assertTrue("Col width attribute is unset: " + col.toString(),col.isSetWidth());
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_2_MINOR
 */
@Test public void testMergingOverlappingCols_OVERLAPS_2_MINOR() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)1,(short)3);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_2_MINOR/cols:" + cols);
  assertEquals(1,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(false,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(4,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(0,cols.getColArray(2).getOutlineLevel());
  assertEquals(5,cols.getColArray(2).getMin());
  assertEquals(5,cols.getColArray(2).getMax());
  assertEquals(true,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_2_MINOR");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  assertEquals("Unexpected width of column " + 1,sheet.getDefaultColumnWidth() * 256,sheet.getColumnWidth(1));
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_2_WRAPS
 */
@Test public void testMergingOverlappingCols_OVERLAPS_2_WRAPS() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(1 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)2,(short)3);
  sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_2_WRAPS/cols:" + cols);
  assertEquals(0,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(true,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(4,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(0,cols.getColArray(2).getOutlineLevel());
  assertEquals(5,cols.getColArray(2).getMin());
  assertEquals(5,cols.getColArray(2).getMax());
  assertEquals(true,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_2_WRAPS");
  sheet=wb2.getSheet("test");
  for (int i=1; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the cols element is correct in case of NumericRanges.OVERLAPS_1_WRAPS
 */
@Test public void testMergingOverlappingCols_OVERLAPS_1_WRAPS() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("test");
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  CTCol col=cols.addNewCol();
  col.setMin(2 + 1);
  col.setMax(4 + 1);
  col.setWidth(20);
  col.setCustomWidth(true);
  sheet.groupColumn((short)1,(short)5);
  cols=sheet.getCTWorksheet().getColsArray(0);
  logger.log(POILogger.DEBUG,"testMergingOverlappingCols_OVERLAPS_1_WRAPS/cols:" + cols);
  assertEquals(1,cols.getColArray(0).getOutlineLevel());
  assertEquals(2,cols.getColArray(0).getMin());
  assertEquals(2,cols.getColArray(0).getMax());
  assertEquals(false,cols.getColArray(0).getCustomWidth());
  assertEquals(1,cols.getColArray(1).getOutlineLevel());
  assertEquals(3,cols.getColArray(1).getMin());
  assertEquals(5,cols.getColArray(1).getMax());
  assertEquals(true,cols.getColArray(1).getCustomWidth());
  assertEquals(1,cols.getColArray(2).getOutlineLevel());
  assertEquals(6,cols.getColArray(2).getMin());
  assertEquals(6,cols.getColArray(2).getMax());
  assertEquals(false,cols.getColArray(2).getCustomWidth());
  assertEquals(3,cols.sizeOfColArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1,"testMergingOverlappingCols_OVERLAPS_1_WRAPS");
  sheet=wb2.getSheet("test");
  for (int i=2; i <= 4; i++) {
    assertEquals("Unexpected width of column " + i,20 * 256,sheet.getColumnWidth(i));
  }
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDataValidation </h4><pre class="type-2 type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddValidations() throws Exception {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("DataValidations-49244.xlsx");
  Sheet sheet=wb1.getSheetAt(0);
  List<XSSFDataValidation> dataValidations=((XSSFSheet)sheet).getDataValidations();
  assertEquals(52,dataValidations.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  int[] validationTypes=new int[]{ValidationType.INTEGER,ValidationType.DECIMAL,ValidationType.TEXT_LENGTH};
  int[] singleOperandOperatorTypes=new int[]{OperatorType.LESS_THAN,OperatorType.LESS_OR_EQUAL,OperatorType.GREATER_THAN,OperatorType.GREATER_OR_EQUAL,OperatorType.EQUAL,OperatorType.NOT_EQUAL};
  int[] doubleOperandOperatorTypes=new int[]{OperatorType.BETWEEN,OperatorType.NOT_BETWEEN};
  BigDecimal value=new BigDecimal("10"), value2=new BigDecimal("20");
  BigDecimal dvalue=new BigDecimal("10.001"), dvalue2=new BigDecimal("19.999");
  final int lastRow=sheet.getLastRowNum();
  int offset=lastRow + 3;
  int lastKnownNumValidations=dataValidations.size();
  Row row=sheet.createRow(offset++);
  Cell cell=row.createCell(0);
  DataValidationConstraint explicitListValidation=dataValidationHelper.createExplicitListConstraint(new String[]{"MA","MI","CA"});
  CellRangeAddressList cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  DataValidation dataValidation=dataValidationHelper.createValidation(explicitListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  row=sheet.createRow(offset++);
  cell=row.createCell(0);
  cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  Cell firstCell=row.createCell(1);
  firstCell.setCellValue("UT");
  Cell secondCell=row.createCell(2);
  secondCell.setCellValue("MN");
  Cell thirdCell=row.createCell(3);
  thirdCell.setCellValue("IL");
  int rowNum=row.getRowNum() + 1;
  String listFormula=new StringBuilder("$B$").append(rowNum).append(":").append("$D$").append(rowNum).toString();
  DataValidationConstraint formulaListValidation=dataValidationHelper.createFormulaListConstraint(listFormula);
  dataValidation=dataValidationHelper.createValidation(formulaListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  offset++;
  offset++;
  for (int i=0; i < validationTypes.length; i++) {
    int validationType=validationTypes[i];
    offset=offset + 2;
    final Row row0=sheet.createRow(offset++);
    Cell cell_10=row0.createCell(0);
    cell_10.setCellValue(validationType == ValidationType.DECIMAL ? "Decimal " : validationType == ValidationType.INTEGER ? "Integer" : "Text Length");
    offset++;
    for (int j=0; j < singleOperandOperatorTypes.length; j++) {
      int operatorType=singleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      final Row row2=i == 0 && j < 2 ? sheet.createRow(offset++) : null;
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_22=i == 0 && j < 2 ? row2.createCell(2) : null;
      Cell cell_13=row1.createCell(3);
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value.toString(),null);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,null);
      if (i == 0 && j == 0) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else       if (i == 0 && j == 1) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
    }
    for (int j=0; j < doubleOperandOperatorTypes.length; j++) {
      int operatorType=doubleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_13=row1.createCell(3);
      Cell cell_14=row1.createCell(4);
      String value1String=validationType == ValidationType.DECIMAL ? dvalue.toString() : value.toString();
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      String value2String=validationType == ValidationType.DECIMAL ? dvalue2.toString() : value2.toString();
      cell_14.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_14.setCellValue(validationType == ValidationType.DECIMAL ? dvalue2.doubleValue() : value2.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value1String,value2String);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      String formula2=new CellReference(cell_14.getRowIndex(),cell_14.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,formula2);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
      validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
    }
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  Sheet sheetAt=wb2.getSheetAt(0);
  assertEquals(lastKnownNumValidations,((XSSFSheet)sheetAt).getDataValidations().size());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDrawing </h4><pre class="type-2 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNew() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet();
  XSSFDrawing dr1=sheet.createDrawingPatriarch();
  XSSFDrawing dr2=sheet.createDrawingPatriarch();
  assertSame(dr1,dr2);
  List<RelationPart> rels=sheet.getRelationParts();
  assertEquals(1,rels.size());
  RelationPart rp=rels.get(0);
  assertTrue(rp.getDocumentPart() instanceof XSSFDrawing);
  XSSFDrawing drawing=rp.getDocumentPart();
  String drawingId=rp.getRelationship().getId();
  assertTrue(sheet.getCTWorksheet().isSetDrawing());
  assertEquals(drawingId,sheet.getCTWorksheet().getDrawing().getId());
  XSSFConnector c1=drawing.createConnector(new XSSFClientAnchor(0,0,0,0,0,0,2,2));
  c1.setLineWidth(2.5);
  c1.setLineStyle(1);
  XSSFShapeGroup c2=drawing.createGroup(new XSSFClientAnchor(0,0,0,0,0,0,5,5));
  assertNotNull(c2);
  XSSFSimpleShape c3=drawing.createSimpleShape(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
  c3.setText(new XSSFRichTextString("Test String"));
  c3.setFillColor(128,128,128);
  XSSFTextBox c4=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,4,4,5,6));
  XSSFRichTextString rt=new XSSFRichTextString("Test String");
  rt.applyFont(0,5,wb1.createFont());
  rt.applyFont(5,6,wb1.createFont());
  c4.setText(rt);
  c4.setNoFill(true);
  assertEquals(4,drawing.getCTDrawing().sizeOfTwoCellAnchorArray());
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(4,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFConnector);
  assertTrue(shapes.get(1) instanceof XSSFShapeGroup);
  assertTrue(shapes.get(2) instanceof XSSFSimpleShape);
  assertTrue(shapes.get(3) instanceof XSSFSimpleShape);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  dr1=sheet.createDrawingPatriarch();
  CTDrawing ctDrawing=dr1.getCTDrawing();
  assertEquals(0,ctDrawing.sizeOfAbsoluteAnchorArray());
  assertEquals(0,ctDrawing.sizeOfOneCellAnchorArray());
  assertEquals(4,ctDrawing.sizeOfTwoCellAnchorArray());
  shapes=dr1.getShapes();
  assertEquals(4,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFConnector);
  assertTrue(shapes.get(1) instanceof XSSFShapeGroup);
  assertTrue(shapes.get(2) instanceof XSSFSimpleShape);
  assertTrue(shapes.get(3) instanceof XSSFSimpleShape);
  String xml=ctDrawing.toString();
  assertTrue(xml.contains("xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\""));
  assertTrue(xml.contains("xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\""));
  checkRewrite(wb2);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  XSSFSheet sheet=wb.getSheetAt(0);
  List<RelationPart> rels=sheet.getRelationParts();
  assertEquals(1,rels.size());
  RelationPart rp=rels.get(0);
  assertTrue(rp.getDocumentPart() instanceof XSSFDrawing);
  XSSFDrawing drawing=(XSSFDrawing)rp.getDocumentPart();
  assertSame(drawing,sheet.createDrawingPatriarch());
  String drawingId=rp.getRelationship().getId();
  assertTrue(sheet.getCTWorksheet().isSetDrawing());
  assertEquals(drawingId,sheet.getCTWorksheet().getDrawing().getId());
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(6,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFPicture);
  assertTrue(shapes.get(1) instanceof XSSFPicture);
  assertTrue(shapes.get(2) instanceof XSSFPicture);
  assertTrue(shapes.get(3) instanceof XSSFPicture);
  assertTrue(shapes.get(4) instanceof XSSFSimpleShape);
  assertTrue(shapes.get(5) instanceof XSSFPicture);
  for (  XSSFShape sh : shapes)   assertNotNull(sh.getAnchor());
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test addNewTextParagraph using RichTextString
 */
@Test public void testAddNewTextParagraphWithRTS() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet();
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
  XSSFRichTextString rt=new XSSFRichTextString("Test Rich Text String");
  XSSFFont font=wb1.createFont();
  font.setColor(new XSSFColor(new Color(0,255,255)));
  font.setFontName("Arial");
  rt.applyFont(font);
  XSSFFont midfont=wb1.createFont();
  midfont.setColor(new XSSFColor(new Color(0,255,0)));
  rt.applyFont(5,14,midfont);
  XSSFTextParagraph para=shape.addNewTextParagraph(rt);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  drawing=sheet.createDrawingPatriarch();
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(1,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFSimpleShape);
  XSSFSimpleShape sshape=(XSSFSimpleShape)shapes.get(0);
  List<XSSFTextParagraph> paras=sshape.getTextParagraphs();
  assertEquals(2,paras.size());
  List<XSSFTextRun> runs=para.getTextRuns();
  assertEquals(3,runs.size());
  assertEquals("Test ",runs.get(0).getText());
  assertEquals("Arial",runs.get(0).getFontFamily());
  Color clr=runs.get(0).getFontColor();
  assertArrayEquals(new int[]{0,255,255},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  assertEquals("Rich Text",runs.get(1).getText());
  assertEquals(XSSFFont.DEFAULT_FONT_NAME,runs.get(1).getFontFamily());
  clr=runs.get(1).getFontColor();
  assertArrayEquals(new int[]{0,255,0},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  assertEquals(" String",runs.get(2).getText());
  assertEquals("Arial",runs.get(2).getFontFamily());
  clr=runs.get(2).getFontColor();
  assertArrayEquals(new int[]{0,255,255},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  checkRewrite(wb2);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that anchor is not null when reading shapes from existing drawings
 */
@Test public void testReadAnchors() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet();
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  XSSFClientAnchor anchor1=new XSSFClientAnchor(0,0,0,0,2,2,3,4);
  XSSFShape shape1=drawing.createTextbox(anchor1);
  assertNotNull(shape1);
  XSSFClientAnchor anchor2=new XSSFClientAnchor(0,0,0,0,2,2,3,5);
  XSSFShape shape2=drawing.createTextbox(anchor2);
  assertNotNull(shape2);
  int pictureIndex=wb1.addPicture(new byte[]{},XSSFWorkbook.PICTURE_TYPE_PNG);
  XSSFClientAnchor anchor3=new XSSFClientAnchor(0,0,0,0,2,2,3,6);
  XSSFShape shape3=drawing.createPicture(anchor3,pictureIndex);
  assertNotNull(shape3);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  drawing=sheet.createDrawingPatriarch();
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(shapes.get(0).getAnchor(),anchor1);
  assertEquals(shapes.get(1).getAnchor(),anchor2);
  assertEquals(shapes.get(2).getAnchor(),anchor3);
  checkRewrite(wb2);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClone() throws Exception {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  XSSFSheet sheet1=wb.getSheetAt(0);
  XSSFSheet sheet2=wb.cloneSheet(0);
  List<POIXMLDocumentPart> rels1=sheet1.getRelations();
  assertEquals(1,rels1.size());
  assertTrue(rels1.get(0) instanceof XSSFDrawing);
  List<POIXMLDocumentPart> rels2=sheet2.getRelations();
  assertEquals(1,rels2.size());
  assertTrue(rels2.get(0) instanceof XSSFDrawing);
  XSSFDrawing drawing1=(XSSFDrawing)rels1.get(0);
  XSSFDrawing drawing2=(XSSFDrawing)rels2.get(0);
  assertNotSame(drawing1,drawing2);
  List<XSSFShape> shapes1=drawing1.getShapes();
  List<XSSFShape> shapes2=drawing2.getShapes();
  assertEquals(shapes1.size(),shapes2.size());
  for (int i=0; i < shapes1.size(); i++) {
    XSSFShape sh1=shapes1.get(i);
    XSSFShape sh2=shapes2.get(i);
    assertTrue(sh1.getClass() == sh2.getClass());
    assertEquals(sh1.getShapeProperties().toString(),sh2.getShapeProperties().toString());
  }
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test reading text from a textbox in an existing file
 */
@Test public void testReadTextBox() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  XSSFSheet sheet=wb.getSheetAt(0);
  List<RelationPart> rels=sheet.getRelationParts();
  assertEquals(1,rels.size());
  RelationPart rp=rels.get(0);
  assertTrue(rp.getDocumentPart() instanceof XSSFDrawing);
  XSSFDrawing drawing=rp.getDocumentPart();
  assertSame(drawing,sheet.createDrawingPatriarch());
  String drawingId=rp.getRelationship().getId();
  assertTrue(sheet.getCTWorksheet().isSetDrawing());
  assertEquals(drawingId,sheet.getCTWorksheet().getDrawing().getId());
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(6,shapes.size());
  assertTrue(shapes.get(4) instanceof XSSFSimpleShape);
  XSSFSimpleShape textbox=(XSSFSimpleShape)shapes.get(4);
  assertEquals("Sheet with various pictures\n(jpeg, png, wmf, emf and pict)",textbox.getText());
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test reading multiple paragraphs from a textbox in an existing file
 */
@Test public void testReadTextBoxParagraphs() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithTextBox.xlsx");
  XSSFSheet sheet=wb.getSheetAt(0);
  List<RelationPart> rels=sheet.getRelationParts();
  assertEquals(1,rels.size());
  RelationPart rp=rels.get(0);
  assertTrue(rp.getDocumentPart() instanceof XSSFDrawing);
  XSSFDrawing drawing=rp.getDocumentPart();
  assertSame(drawing,sheet.createDrawingPatriarch());
  String drawingId=rp.getRelationship().getId();
  assertTrue(sheet.getCTWorksheet().isSetDrawing());
  assertEquals(drawingId,sheet.getCTWorksheet().getDrawing().getId());
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(1,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFSimpleShape);
  XSSFSimpleShape textbox=(XSSFSimpleShape)shapes.get(0);
  List<XSSFTextParagraph> paras=textbox.getTextParagraphs();
  assertEquals(3,paras.size());
  assertEquals("Line 2",paras.get(1).getText());
  assertEquals("Line 1\nLine 2\nLine 3",textbox.getText());
  assertEquals(TextAlign.LEFT,paras.get(0).getTextAlign());
  assertEquals(TextAlign.CENTER,paras.get(1).getTextAlign());
  assertEquals(TextAlign.RIGHT,paras.get(2).getTextAlign());
  Color clr=paras.get(0).getTextRuns().get(0).getFontColor();
  assertArrayEquals(new int[]{255,0,0},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  clr=paras.get(1).getTextRuns().get(0).getFontColor();
  assertArrayEquals(new int[]{0,255,0},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  clr=paras.get(2).getTextRuns().get(0).getFontColor();
  assertArrayEquals(new int[]{0,0,255},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test setText single paragraph to ensure backwards compatibility
 */
@Test public void testSetTextSingleParagraph() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sheet=wb.createSheet();
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
  XSSFRichTextString rt=new XSSFRichTextString("Test String");
  XSSFFont font=wb.createFont();
  font.setColor(new XSSFColor(new Color(0,255,255)));
  font.setFontName("Arial");
  rt.applyFont(font);
  shape.setText(rt);
  List<XSSFTextParagraph> paras=shape.getTextParagraphs();
  assertEquals(1,paras.size());
  assertEquals("Test String",paras.get(0).getText());
  List<XSSFTextRun> runs=paras.get(0).getTextRuns();
  assertEquals(1,runs.size());
  assertEquals("Arial",runs.get(0).getFontFamily());
  Color clr=runs.get(0).getFontColor();
  assertArrayEquals(new int[]{0,255,255},new int[]{clr.getRed(),clr.getGreen(),clr.getBlue()});
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testXSSFSimpleShapeCausesNPE56514() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("56514.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(4,shapes.size());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  drawing=sheet.createDrawingPatriarch();
  shapes=drawing.getShapes();
  assertEquals(4,shapes.size());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test reading bullet numbering from a textbox in an existing file
 */
@Test public void testReadTextBox2() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithTextBox2.xlsx");
  XSSFSheet sheet=wb.getSheetAt(0);
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  List<XSSFShape> shapes=drawing.getShapes();
  XSSFSimpleShape textbox=(XSSFSimpleShape)shapes.get(0);
  String extracted=textbox.getText();
  StringBuilder sb=new StringBuilder();
  sb.append("1. content1A\n");
  sb.append("\t1. content1B\n");
  sb.append("\t2. content2B\n");
  sb.append("\t3. content3B\n");
  sb.append("2. content2A\n");
  sb.append("\t3. content2BStartAt3\n");
  sb.append("\t\n\t\n\t");
  sb.append("4. content2BStartAt3Incremented\n");
  sb.append("\t\n\t\n\t\n\t");
  assertEquals(sb.toString(),extracted);
  checkRewrite(wb);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test adding and reading back paragraphs as bullet points
 */
@Test public void testAddBulletParagraphs() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet();
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,10,20));
  String paraString1="A normal paragraph";
  String paraString2="First bullet";
  String paraString3="Second bullet (level 1)";
  String paraString4="Third bullet";
  String paraString5="Another normal paragraph";
  String paraString6="First numbered bullet";
  String paraString7="Second bullet (level 1)";
  String paraString8="Third bullet (level 1)";
  String paraString9="Fourth bullet (level 1)";
  String paraString10="Fifth Bullet";
  XSSFTextParagraph para=shape.addNewTextParagraph(paraString1);
  para=shape.addNewTextParagraph(paraString2);
  para.setBullet(true);
  para=shape.addNewTextParagraph(paraString3);
  para.setBullet(true);
  para.setLevel(1);
  para=shape.addNewTextParagraph(paraString4);
  para.setBullet(true);
  para=shape.addNewTextParagraph(paraString5);
  para=shape.addNewTextParagraph(paraString6);
  para.setBullet(ListAutoNumber.ARABIC_PERIOD);
  para=shape.addNewTextParagraph(paraString7);
  para.setBullet(ListAutoNumber.ARABIC_PERIOD,3);
  para.setLevel(1);
  para=shape.addNewTextParagraph(paraString8);
  para.setBullet(ListAutoNumber.ARABIC_PERIOD,3);
  para.setLevel(1);
  para=shape.addNewTextParagraph("");
  para.setBullet(ListAutoNumber.ARABIC_PERIOD,3);
  para.setLevel(1);
  para=shape.addNewTextParagraph(paraString9);
  para.setBullet(ListAutoNumber.ARABIC_PERIOD,3);
  para.setLevel(1);
  para=shape.addNewTextParagraph(paraString10);
  para.setBullet(ListAutoNumber.ARABIC_PERIOD);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  drawing=sheet.createDrawingPatriarch();
  List<XSSFShape> shapes=drawing.getShapes();
  assertEquals(1,shapes.size());
  assertTrue(shapes.get(0) instanceof XSSFSimpleShape);
  XSSFSimpleShape sshape=(XSSFSimpleShape)shapes.get(0);
  List<XSSFTextParagraph> paras=sshape.getTextParagraphs();
  assertEquals(12,paras.size());
  StringBuilder builder=new StringBuilder();
  builder.append(paraString1);
  builder.append("\n");
  builder.append("\u2022 ");
  builder.append(paraString2);
  builder.append("\n");
  builder.append("\t\u2022 ");
  builder.append(paraString3);
  builder.append("\n");
  builder.append("\u2022 ");
  builder.append(paraString4);
  builder.append("\n");
  builder.append(paraString5);
  builder.append("\n");
  builder.append("1. ");
  builder.append(paraString6);
  builder.append("\n");
  builder.append("\t3. ");
  builder.append(paraString7);
  builder.append("\n");
  builder.append("\t4. ");
  builder.append(paraString8);
  builder.append("\n");
  builder.append("\t");
  builder.append("\n");
  builder.append("\t5. ");
  builder.append(paraString9);
  builder.append("\n");
  builder.append("2. ");
  builder.append(paraString10);
  assertEquals(builder.toString(),sshape.getText());
  checkRewrite(wb2);
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaEvaluation </h4><pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Evaluation of cell references with column indexes greater than 255. See bugzilla 50096
 */
@Test public void testEvaluateColumnGreaterThan255() throws IOException {
  XSSFWorkbook wb=(XSSFWorkbook)_testDataProvider.openSampleWorkbook("50096.xlsx");
  XSSFFormulaEvaluator evaluator=wb.getCreationHelper().createFormulaEvaluator();
  for (int i=245; i < 265; i++) {
    XSSFCell cell_noformula=wb.getSheetAt(0).getRow(0).getCell(i);
    XSSFCell cell_formula=wb.getSheetAt(0).getRow(1).getCell(i);
    CellReference ref_noformula=new CellReference(cell_noformula.getRowIndex(),cell_noformula.getColumnIndex());
    CellReference ref_formula=new CellReference(cell_noformula.getRowIndex(),cell_noformula.getColumnIndex());
    String fmla=cell_formula.getCellFormula();
    assertEquals(ref_noformula.formatAsString(),fmla);
    CellValue cv_noformula=evaluator.evaluate(cell_noformula);
    CellValue cv_formula=evaluator.evaluate(cell_formula);
    assertEquals("Wrong evaluation result in " + ref_formula.formatAsString(),cv_noformula.getNumberValue(),cv_formula.getNumberValue(),0);
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaParser </h4><pre class="type-2 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void builtInFormulas(){
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"LOG10");
  assertEquals(1,ptgs.length);
  assertTrue("",(ptgs[0] instanceof RefPtg));
  ptgs=parse(fpb,"LOG10(100)");
  assertEquals(2,ptgs.length);
  assertTrue("",ptgs[0] instanceof IntPtg);
  assertTrue("",ptgs[1] instanceof FuncPtg);
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void formaulReferncesSameWorkbook(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("56737.xlsx");
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"[0]!NR_Global_B2");
  assertEquals(1,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(0,((NameXPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals(null,((NameXPxg)ptgs[0]).getSheetName());
  assertEquals("NR_Global_B2",((NameXPxg)ptgs[0]).getNameName());
  assertEquals("[0]!NR_Global_B2",((NameXPxg)ptgs[0]).toFormulaString());
}

</code></pre>

<br>
<pre class="type-2 type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void basicParsing(){
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"ABC10");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"A500000");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"ABC500000");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  ptgs=parse(fpb,"XFD1048576");
  assertEquals(1,ptgs.length);
  assertTrue("",ptgs[0] instanceof RefPtg);
  try {
    ptgs=parse(fpb,"XFE10");
    fail("expected exception");
  }
 catch (  FormulaParseException e) {
    assertEquals("Specified named range 'XFE10' does not exist in the current workbook.",e.getMessage());
  }
  try {
    ptgs=parse(fpb,"XFD1048577");
    fail("expected exception");
  }
 catch (  FormulaParseException e) {
    assertEquals("Specified named range 'XFD1048577' does not exist in the current workbook.",e.getMessage());
  }
  ptgs=parse(fpb,"ISEVEN(A1)");
  assertEquals(3,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(RefPtg.class,ptgs[1].getClass());
  assertEquals(FuncVarPtg.class,ptgs[2].getClass());
  assertEquals("ISEVEN",ptgs[0].toFormulaString());
  assertEquals("A1",ptgs[1].toFormulaString());
  assertEquals("#external#",ptgs[2].toFormulaString());
  ptgs=parse(fpb,"SUM(A1:B3)");
  assertEquals(2,ptgs.length);
  assertEquals(AreaPtg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("A1:B3",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
  ptgs=parse(fpb,"SUM(Sheet1!A1)");
  assertEquals(2,ptgs.length);
  assertEquals(Ref3DPxg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("Sheet1!A1",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
  ptgs=parse(fpb,"SUM(Sheet1!A1:B3)");
  assertEquals(2,ptgs.length);
  assertEquals(Area3DPxg.class,ptgs[0].getClass());
  assertEquals(AttrPtg.class,ptgs[1].getClass());
  assertEquals("Sheet1!A1:B3",ptgs[0].toFormulaString());
  assertEquals("SUM",ptgs[1].toFormulaString());
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void formulaReferencesOtherSheets(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("56737.xlsx");
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"Uses!A1");
  assertEquals(1,ptgs.length);
  assertEquals(Ref3DPxg.class,ptgs[0].getClass());
  assertEquals(-1,((Ref3DPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals("A1",((Ref3DPxg)ptgs[0]).format2DRefAsString());
  assertEquals("Uses!A1",((Ref3DPxg)ptgs[0]).toFormulaString());
  ptgs=parse(fpb,"'Testing 47100'!A1");
  assertEquals(1,ptgs.length);
  assertEquals(Ref3DPxg.class,ptgs[0].getClass());
  assertEquals(-1,((Ref3DPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals("Testing 47100",((Ref3DPxg)ptgs[0]).getSheetName());
  assertEquals("A1",((Ref3DPxg)ptgs[0]).format2DRefAsString());
  assertEquals("'Testing 47100'!A1",((Ref3DPxg)ptgs[0]).toFormulaString());
  ptgs=parse(fpb,"Defines!NR_To_A1");
  assertEquals(1,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(-1,((NameXPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals("Defines",((NameXPxg)ptgs[0]).getSheetName());
  assertEquals("NR_To_A1",((NameXPxg)ptgs[0]).getNameName());
  assertEquals("Defines!NR_To_A1",((NameXPxg)ptgs[0]).toFormulaString());
  ptgs=parse(fpb,"NR_Global_B2");
  assertEquals(1,ptgs.length);
  assertEquals(NamePtg.class,ptgs[0].getClass());
  assertEquals("NR_Global_B2",((NamePtg)ptgs[0]).toFormulaString(fpb));
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A handful of functions (such as SUM, COUNTA, MIN) support
 * multi-sheet references (eg Sheet1:Sheet3!A1 = Cell A1 from
 * Sheets 1 through Sheet 3) and multi-sheet area references 
 * (eg Sheet1:Sheet3!A1:B2 = Cells A1 through B2 from Sheets
 * 1 through Sheet 3).
 * This test, based on common test files for HSSF and XSSF, checks
 * that we can read and parse these kinds of references 
 * (but not evaluate - that's elsewhere in the test suite)
 */
@Test public void multiSheetReferencesHSSFandXSSF() throws Exception {
  Workbook[] wbs=new Workbook[]{HSSFTestDataSamples.openSampleWorkbook("55906-MultiSheetRefs.xls"),XSSFTestDataSamples.openSampleWorkbook("55906-MultiSheetRefs.xlsx")};
  for (  Workbook wb : wbs) {
    Sheet s1=wb.getSheetAt(0);
    Ptg[] ptgs;
    Cell sumF=s1.getRow(2).getCell(0);
    assertNotNull(sumF);
    assertEquals("SUM(Sheet1:Sheet3!A1)",sumF.getCellFormula());
    Cell avgF=s1.getRow(2).getCell(1);
    assertNotNull(avgF);
    assertEquals("AVERAGE(Sheet1:Sheet3!A1)",avgF.getCellFormula());
    Cell countAF=s1.getRow(2).getCell(2);
    assertNotNull(countAF);
    assertEquals("COUNTA(Sheet1:Sheet3!C1)",countAF.getCellFormula());
    Cell maxF=s1.getRow(4).getCell(1);
    assertNotNull(maxF);
    assertEquals("MAX(Sheet1:Sheet3!A$1)",maxF.getCellFormula());
    Cell sumFA=s1.getRow(2).getCell(7);
    assertNotNull(sumFA);
    assertEquals("SUM(Sheet1:Sheet3!A1:B2)",sumFA.getCellFormula());
    Cell avgFA=s1.getRow(2).getCell(8);
    assertNotNull(avgFA);
    assertEquals("AVERAGE(Sheet1:Sheet3!A1:B2)",avgFA.getCellFormula());
    Cell maxFA=s1.getRow(4).getCell(8);
    assertNotNull(maxFA);
    assertEquals("MAX(Sheet1:Sheet3!A$1:B$2)",maxFA.getCellFormula());
    Cell countFA=s1.getRow(5).getCell(8);
    assertNotNull(countFA);
    assertEquals("COUNT(Sheet1:Sheet3!$A$1:$B$2)",countFA.getCellFormula());
    FormulaParsingWorkbook fpb=null;
    if (wb instanceof HSSFWorkbook)     fpb=HSSFEvaluationWorkbook.create((HSSFWorkbook)wb);
 else     fpb=XSSFEvaluationWorkbook.create((XSSFWorkbook)wb);
    ptgs=parse(fpb,"SUM(Sheet1:Sheet3!A1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A1",toFormulaString(ptgs[0],fpb));
    assertEquals(AttrPtg.class,ptgs[1].getClass());
    assertEquals("SUM",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MAX(Sheet1:Sheet3!A$1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A$1",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MAX",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MIN(Sheet1:Sheet3!$A$1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!$A$1",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MIN",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"SUM(Sheet1:Sheet3!A1:B2)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Area3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Area3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A1:B2",toFormulaString(ptgs[0],fpb));
    assertEquals(AttrPtg.class,ptgs[1].getClass());
    assertEquals("SUM",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MIN(Sheet1:Sheet3!$A$1:$B$2)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Area3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Area3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!$A$1:$B$2",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MIN",toFormulaString(ptgs[1],fpb));
    Cell newF=s1.getRow(0).createCell(10,Cell.CELL_TYPE_FORMULA);
    newF.setCellFormula("SUM(Sheet2:Sheet3!A1)");
    assertEquals("SUM(Sheet2:Sheet3!A1)",newF.getCellFormula());
    newF=s1.getRow(0).createCell(11,Cell.CELL_TYPE_FORMULA);
    newF.setCellFormula("MIN(Sheet1:Sheet2!A1:B2)");
    assertEquals("MIN(Sheet1:Sheet2!A1:B2)",newF.getCellFormula());
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void formulaReferencesOtherWorkbook(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("ref-56737.xlsx");
  XSSFEvaluationWorkbook fpb=XSSFEvaluationWorkbook.create(wb);
  Ptg[] ptgs;
  ptgs=parse(fpb,"[1]Uses!$A$1");
  assertEquals(1,ptgs.length);
  assertEquals(Ref3DPxg.class,ptgs[0].getClass());
  assertEquals(1,((Ref3DPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals("Uses",((Ref3DPxg)ptgs[0]).getSheetName());
  assertEquals("$A$1",((Ref3DPxg)ptgs[0]).format2DRefAsString());
  assertEquals("[1]Uses!$A$1",((Ref3DPxg)ptgs[0]).toFormulaString());
  ptgs=parse(fpb,"[1]Defines!NR_To_A1");
  assertEquals(1,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(1,((NameXPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals("Defines",((NameXPxg)ptgs[0]).getSheetName());
  assertEquals("NR_To_A1",((NameXPxg)ptgs[0]).getNameName());
  assertEquals("[1]Defines!NR_To_A1",((NameXPxg)ptgs[0]).toFormulaString());
  ptgs=parse(fpb,"[1]!NR_Global_B2");
  assertEquals(1,ptgs.length);
  assertEquals(NameXPxg.class,ptgs[0].getClass());
  assertEquals(1,((NameXPxg)ptgs[0]).getExternalWorkbookNumber());
  assertEquals(null,((NameXPxg)ptgs[0]).getSheetName());
  assertEquals("NR_Global_B2",((NameXPxg)ptgs[0]).getNameName());
  assertEquals("[1]!NR_Global_B2",((NameXPxg)ptgs[0]).toFormulaString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFHyperlink </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test52716(){
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("52716.xlsx");
  XSSFSheet sh1=wb1.getSheetAt(0);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  XSSFSheet sh2=wb2.getSheetAt(0);
  assertEquals(sh1.getNumberOfComments(),sh2.getNumberOfComments());
  XSSFHyperlink l1=sh1.getHyperlink(0,1);
  assertEquals(XSSFHyperlink.LINK_DOCUMENT,l1.getType());
  assertEquals("B1",l1.getCellRef());
  assertEquals("Sort on Titel",l1.getTooltip());
  XSSFHyperlink l2=sh2.getHyperlink(0,1);
  assertEquals(l1.getTooltip(),l2.getTooltip());
  assertEquals(XSSFHyperlink.LINK_DOCUMENT,l2.getType());
  assertEquals("B1",l2.getCellRef());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test53282(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("53282.xlsx");
  XSSFHyperlink link=wb.getSheetAt(0).getRow(0).getCell(14).getHyperlink();
  assertEquals("mailto:nobody@nowhere.uk%C2%A0",link.getAddress());
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  link=wb.getSheetAt(0).getRow(0).getCell(14).getHyperlink();
  assertEquals("mailto:nobody@nowhere.uk%C2%A0",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test53734(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("53734.xlsx");
  XSSFHyperlink link=wb.getSheetAt(0).getRow(0).getCell(0).getHyperlink();
  assertEquals("javascript:///",link.getAddress());
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  link=wb.getSheetAt(0).getRow(0).getCell(0).getHyperlink();
  assertEquals("javascript:///",link.getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadSave(){
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("WithMoreVariousData.xlsx");
  CreationHelper createHelper=workbook.getCreationHelper();
  assertEquals(3,workbook.getNumberOfSheets());
  XSSFSheet sheet=workbook.getSheetAt(0);
  assertEquals(4,sheet.getNumHyperlinks());
  doTestHyperlinkContents(sheet);
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertEquals(3,wb2.getNumberOfSheets());
  assertNotNull(wb2.getSheetAt(0));
  assertNotNull(wb2.getSheetAt(1));
  assertNotNull(wb2.getSheetAt(2));
  sheet=wb2.getSheetAt(0);
  assertEquals(4,sheet.getNumHyperlinks());
  doTestHyperlinkContents(sheet);
  Row r17=sheet.createRow(17);
  Cell r17c=r17.createCell(2);
  Hyperlink hyperlink=createHelper.createHyperlink(Hyperlink.LINK_URL);
  hyperlink.setAddress("http://poi.apache.org/spreadsheet/");
  hyperlink.setLabel("POI SS Link");
  r17c.setHyperlink(hyperlink);
  assertEquals(5,sheet.getNumHyperlinks());
  doTestHyperlinkContents(sheet);
  assertEquals(Hyperlink.LINK_URL,sheet.getRow(17).getCell(2).getHyperlink().getType());
  assertEquals("POI SS Link",sheet.getRow(17).getCell(2).getHyperlink().getLabel());
  assertEquals("http://poi.apache.org/spreadsheet/",sheet.getRow(17).getCell(2).getHyperlink().getAddress());
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  assertEquals(3,wb3.getNumberOfSheets());
  assertNotNull(wb3.getSheetAt(0));
  assertNotNull(wb3.getSheetAt(1));
  assertNotNull(wb3.getSheetAt(2));
  sheet=wb3.getSheetAt(0);
  assertEquals(5,sheet.getNumHyperlinks());
  doTestHyperlinkContents(sheet);
  assertEquals(Hyperlink.LINK_URL,sheet.getRow(17).getCell(2).getHyperlink().getType());
  assertEquals("POI SS Link",sheet.getRow(17).getCell(2).getHyperlink().getLabel());
  assertEquals("http://poi.apache.org/spreadsheet/",sheet.getRow(17).getCell(2).getHyperlink().getAddress());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate() throws Exception {
  XSSFWorkbook workbook=new XSSFWorkbook();
  XSSFSheet sheet=workbook.createSheet();
  XSSFRow row=sheet.createRow(0);
  XSSFCreationHelper createHelper=workbook.getCreationHelper();
  String[] urls={"http://apache.org","www.apache.org","/temp","c:/temp","http://apache.org/default.php?s=isTramsformed&submit=Search&la=*&li=*"};
  for (int i=0; i < urls.length; i++) {
    String s=urls[i];
    XSSFHyperlink link=createHelper.createHyperlink(Hyperlink.LINK_URL);
    link.setAddress(s);
    XSSFCell cell=row.createCell(i);
    cell.setHyperlink(link);
  }
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet=workbook.getSheetAt(0);
  PackageRelationshipCollection rels=sheet.getPackagePart().getRelationships();
  assertEquals(urls.length,rels.size());
  for (int i=0; i < rels.size(); i++) {
    PackageRelationship rel=rels.getRelationship(i);
    assertEquals(urls[i],rel.getTargetURI().toString());
  }
  workbook=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  sheet=workbook.getSheetAt(0);
  rels=sheet.getPackagePart().getRelationships();
  assertEquals(urls.length,rels.size());
  for (int i=0; i < rels.size(); i++) {
    PackageRelationship rel=rels.getRelationship(i);
    assertEquals(urls[i],rel.getTargetURI().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFName </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRepeatingRowsAndColums() throws Exception {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sheet1=wb.createSheet("First Sheet");
  sheet1.setRepeatingRows(null);
  sheet1.setRepeatingColumns(null);
  for (int i=0; i < 2; i++) {
    sheet1.setRepeatingRows(CellRangeAddress.valueOf("1:4"));
    sheet1.setRepeatingColumns(CellRangeAddress.valueOf("A:A"));
  }
  assertEquals(1,wb.getNumberOfNames());
  XSSFName nr1=wb.getNameAt(0);
  assertEquals(XSSFName.BUILTIN_PRINT_TITLE,nr1.getNameName());
  assertEquals("'First Sheet'!$A:$A,'First Sheet'!$1:$4",nr1.getRefersToFormula());
  sheet1.setRepeatingColumns(null);
  assertEquals("'First Sheet'!$1:$4",nr1.getRefersToFormula());
  sheet1.setRepeatingColumns(CellRangeAddress.valueOf("A:A"));
  sheet1.setRepeatingRows(null);
  assertEquals("'First Sheet'!$A:$A",nr1.getRefersToFormula());
  sheet1.setRepeatingRows(CellRangeAddress.valueOf("1:4"));
  XSSFWorkbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(1,nwb.getNumberOfNames());
  nr1=nwb.getNameAt(0);
  assertEquals(XSSFName.BUILTIN_PRINT_TITLE,nr1.getNameName());
  assertEquals("'First Sheet'!$A:$A,'First Sheet'!$1:$4",nr1.getRefersToFormula());
  XSSFSheet sheet2=nwb.createSheet("SecondSheet");
  sheet2.setRepeatingRows(CellRangeAddress.valueOf("1:1"));
  sheet2.setRepeatingColumns(CellRangeAddress.valueOf("B:C"));
  assertEquals(2,nwb.getNumberOfNames());
  XSSFName nr2=nwb.getNameAt(1);
  assertEquals(XSSFName.BUILTIN_PRINT_TITLE,nr2.getNameName());
  assertEquals("SecondSheet!$B:$C,SecondSheet!$1:$1",nr2.getRefersToFormula());
  sheet2.setRepeatingRows(null);
  sheet2.setRepeatingColumns(null);
  nwb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFPicture </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * same image refrerred by mulitple sheets
 */
@SuppressWarnings("resource") @Test public void multiRelationShips() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  byte[] pic1Data="test jpeg data".getBytes(LocaleUtil.CHARSET_1252);
  byte[] pic2Data="test png data".getBytes(LocaleUtil.CHARSET_1252);
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertEquals(0,pictures.size());
  int pic1=wb.addPicture(pic1Data,XSSFWorkbook.PICTURE_TYPE_JPEG);
  int pic2=wb.addPicture(pic2Data,XSSFWorkbook.PICTURE_TYPE_PNG);
  XSSFSheet sheet1=wb.createSheet();
  XSSFDrawing drawing1=sheet1.createDrawingPatriarch();
  XSSFPicture shape1=drawing1.createPicture(new XSSFClientAnchor(),pic1);
  XSSFPicture shape2=drawing1.createPicture(new XSSFClientAnchor(),pic2);
  XSSFSheet sheet2=wb.createSheet();
  XSSFDrawing drawing2=sheet2.createDrawingPatriarch();
  XSSFPicture shape3=drawing2.createPicture(new XSSFClientAnchor(),pic2);
  XSSFPicture shape4=drawing2.createPicture(new XSSFClientAnchor(),pic1);
  assertEquals(2,pictures.size());
  wb=XSSFTestDataSamples.writeOutAndReadBack(wb);
  pictures=wb.getAllPictures();
  assertEquals(2,pictures.size());
  sheet1=wb.getSheetAt(0);
  drawing1=sheet1.createDrawingPatriarch();
  XSSFPicture shape11=(XSSFPicture)drawing1.getShapes().get(0);
  assertArrayEquals(shape1.getPictureData().getData(),shape11.getPictureData().getData());
  XSSFPicture shape22=(XSSFPicture)drawing1.getShapes().get(1);
  assertArrayEquals(shape2.getPictureData().getData(),shape22.getPictureData().getData());
  sheet2=wb.getSheetAt(1);
  drawing2=sheet2.createDrawingPatriarch();
  XSSFPicture shape33=(XSSFPicture)drawing2.getShapes().get(0);
  assertArrayEquals(shape3.getPictureData().getData(),shape33.getPictureData().getData());
  XSSFPicture shape44=(XSSFPicture)drawing2.getShapes().get(1);
  assertArrayEquals(shape4.getPictureData().getData(),shape44.getPictureData().getData());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFPictureData </h4><pre class="type-2 type-12 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRead() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithDrawing.xlsx");
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertSame(pictures,wb.getAllPictures());
  assertEquals(5,pictures.size());
  String[] ext={"jpeg","emf","png","emf","wmf"};
  String[] mimetype={"image/jpeg","image/x-emf","image/png","image/x-emf","image/x-wmf"};
  for (int i=0; i < pictures.size(); i++) {
    assertEquals(ext[i],pictures.get(i).suggestFileExtension());
    assertEquals(mimetype[i],pictures.get(i).getMimeType());
  }
  int num=pictures.size();
  byte[] pictureData={0xA,0xB,0XC,0xD,0xE,0xF};
  int idx=wb.addPicture(pictureData,XSSFWorkbook.PICTURE_TYPE_JPEG);
  assertEquals(num + 1,pictures.size());
  assertEquals(pictures.size() - 1,idx);
  XSSFPictureData pict=pictures.get(idx);
  assertEquals("jpeg",pict.suggestFileExtension());
  assertArrayEquals(pictureData,pict.getData());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNew() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sheet=wb.createSheet();
  XSSFDrawing drawing=sheet.createDrawingPatriarch();
  byte[] jpegData="test jpeg data".getBytes(LocaleUtil.CHARSET_1252);
  byte[] wmfData="test wmf data".getBytes(LocaleUtil.CHARSET_1252);
  byte[] pngData="test png data".getBytes(LocaleUtil.CHARSET_1252);
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertEquals(0,pictures.size());
  int jpegIdx=wb.addPicture(jpegData,XSSFWorkbook.PICTURE_TYPE_JPEG);
  assertEquals(1,pictures.size());
  assertEquals("jpeg",pictures.get(jpegIdx).suggestFileExtension());
  assertArrayEquals(jpegData,pictures.get(jpegIdx).getData());
  int wmfIdx=wb.addPicture(wmfData,XSSFWorkbook.PICTURE_TYPE_WMF);
  assertEquals(2,pictures.size());
  assertEquals("wmf",pictures.get(wmfIdx).suggestFileExtension());
  assertArrayEquals(wmfData,pictures.get(wmfIdx).getData());
  int pngIdx=wb.addPicture(pngData,XSSFWorkbook.PICTURE_TYPE_PNG);
  assertEquals(3,pictures.size());
  assertEquals("png",pictures.get(pngIdx).suggestFileExtension());
  assertArrayEquals(pngData,pictures.get(pngIdx).getData());
  XSSFPicture p1=drawing.createPicture(new XSSFClientAnchor(),jpegIdx);
  assertNotNull(p1);
  XSSFPicture p2=drawing.createPicture(new XSSFClientAnchor(),wmfIdx);
  assertNotNull(p2);
  XSSFPicture p3=drawing.createPicture(new XSSFClientAnchor(),pngIdx);
  assertNotNull(p3);
  XSSFWorkbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  List<XSSFPictureData> pictures2=wbBack.getAllPictures();
  assertEquals(3,pictures2.size());
  assertEquals("jpeg",pictures2.get(jpegIdx).suggestFileExtension());
  assertArrayEquals(jpegData,pictures2.get(jpegIdx).getData());
  assertEquals("wmf",pictures2.get(wmfIdx).suggestFileExtension());
  assertArrayEquals(wmfData,pictures2.get(wmfIdx).getData());
  assertEquals("png",pictures2.get(pngIdx).suggestFileExtension());
  assertArrayEquals(pngData,pictures2.get(pngIdx).getData());
  wbBack.close();
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheet </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to trigger OOXML-LITE generating to include org.openxmlformats.schemas.spreadsheetml.x2006.main.CTSheetCalcPr
 */
@Test public void setForceFormulaRecalculation() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("Sheet 1");
  assertFalse(sheet.getForceFormulaRecalculation());
  sheet.setForceFormulaRecalculation(true);
  assertEquals(true,sheet.getForceFormulaRecalculation());
  CTCalcPr calcPr=wb1.getCTWorkbook().addNewCalcPr();
  calcPr.setCalcMode(STCalcMode.MANUAL);
  sheet.setForceFormulaRecalculation(true);
  assertEquals(STCalcMode.AUTO,calcPr.getCalcMode());
  sheet.setForceFormulaRecalculation(false);
  assertEquals(false,sheet.getForceFormulaRecalculation());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheet("Sheet 1");
  assertEquals(false,sheet.getForceFormulaRecalculation());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void existingHeaderFooter() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("45540_classic_Header.xlsx");
  XSSFOddHeader hdr;
  XSSFOddFooter ftr;
  XSSFSheet s1=wb1.getSheetAt(0);
  assertNotNull(s1.getHeader());
  assertNotNull(s1.getFooter());
  hdr=(XSSFOddHeader)s1.getHeader();
  ftr=(XSSFOddFooter)s1.getFooter();
  assertEquals("&Ctestdoc&Rtest phrase",hdr.getText());
  assertEquals(null,ftr.getText());
  assertEquals("",hdr.getLeft());
  assertEquals("testdoc",hdr.getCenter());
  assertEquals("test phrase",hdr.getRight());
  assertEquals("",ftr.getLeft());
  assertEquals("",ftr.getCenter());
  assertEquals("",ftr.getRight());
  XSSFSheet s2=wb1.getSheetAt(1);
  assertNotNull(s2.getHeader());
  assertNotNull(s2.getFooter());
  hdr=(XSSFOddHeader)s2.getHeader();
  ftr=(XSSFOddFooter)s2.getFooter();
  assertEquals(null,hdr.getText());
  assertEquals("&L&F",ftr.getText());
  assertEquals("",hdr.getLeft());
  assertEquals("",hdr.getCenter());
  assertEquals("",hdr.getRight());
  assertEquals("&F",ftr.getLeft());
  assertEquals("",ftr.getCenter());
  assertEquals("",ftr.getRight());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  hdr=(XSSFOddHeader)wb2.getSheetAt(0).getHeader();
  ftr=(XSSFOddFooter)wb2.getSheetAt(0).getFooter();
  assertEquals("",hdr.getLeft());
  assertEquals("testdoc",hdr.getCenter());
  assertEquals("test phrase",hdr.getRight());
  assertEquals("",ftr.getLeft());
  assertEquals("",ftr.getCenter());
  assertEquals("",ftr.getRight());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Setting width of a column included in a column span
 */
@Test public void bug47862() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47862.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  assertEquals(1,cols.sizeOfColArray());
  CTCol col=cols.getColArray(0);
  assertEquals(1,col.getMin());
  assertEquals(5,col.getMax());
  double swidth=15.77734375;
  assertEquals(swidth,col.getWidth(),0.0);
  for (int i=0; i < 5; i++) {
    assertEquals((int)(swidth * 256),sheet.getColumnWidth(i));
  }
  int[] cw=new int[]{10,15,20,25,30};
  for (int i=0; i < 5; i++) {
    sheet.setColumnWidth(i,cw[i] * 256);
  }
  ColumnHelper.sortColumns(cols);
  assertEquals(5,cols.sizeOfColArray());
  for (int i=0; i < 5; i++) {
    assertEquals(cw[i] * 256,sheet.getColumnWidth(i));
    assertEquals(cw[i],cols.getColArray(i).getWidth(),0.0);
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  cols=sheet.getCTWorksheet().getColsArray(0);
  assertEquals(5,cols.sizeOfColArray());
  for (int i=0; i < 5; i++) {
    assertEquals(cw[i] * 256,sheet.getColumnWidth(i));
    assertEquals(cw[i],cols.getColArray(i).getWidth(),0.0);
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void protectSheet_lowlevel_2013() throws IOException {
  String password="test";
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet xs=wb1.createSheet();
  xs.setSheetPassword(password,HashAlgorithm.sha384);
  XSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  assertTrue(wb2.getSheetAt(0).validateSheetPassword(password));
  wb2.close();
  XSSFWorkbook wb3=openSampleWorkbook("workbookProtection-sheet_password-2013.xlsx");
  assertTrue(wb3.getSheetAt(0).validateSheetPassword("pwd"));
  wb3.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * TODO - while this is internally consistent, I'm not
 * completely clear in all cases what it's supposed to
 * be doing... Someone who understands the goals a little
 * better should really review this!
 */
@Test public void setRowGroupCollapsed() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet1=wb1.createSheet();
  sheet1.groupRow(5,14);
  sheet1.groupRow(7,14);
  sheet1.groupRow(16,19);
  assertEquals(14,sheet1.getPhysicalNumberOfRows());
  assertFalse(sheet1.getRow(6).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(6).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(7).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(7).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(9).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(9).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(14).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(14).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(16).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(16).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(18).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(18).getCTRow().isSetHidden());
  sheet1.setRowGroupCollapsed(7,true);
  assertFalse(sheet1.getRow(6).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(6).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(7).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(7).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(9).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(9).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(14).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(14).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(16).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(16).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(18).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(18).getCTRow().isSetHidden());
  sheet1.setRowGroupCollapsed(7,false);
  assertFalse(sheet1.getRow(6).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(6).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(7).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(7).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(9).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(9).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(14).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(14).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(16).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(16).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(18).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(18).getCTRow().isSetHidden());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet1=wb2.getSheetAt(0);
  assertFalse(sheet1.getRow(6).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(6).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(7).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(7).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(9).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(9).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(14).getCTRow().isSetCollapsed());
  assertTrue(sheet1.getRow(14).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(16).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(16).getCTRow().isSetHidden());
  assertFalse(sheet1.getRow(18).getCTRow().isSetCollapsed());
  assertFalse(sheet1.getRow(18).getCTRow().isSetHidden());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * This would be better off as a testable example rather than a simple unit test
 * since Sheet.createComment() was deprecated and removed.
 * https://poi.apache.org/spreadsheet/quick-guide.html#CellComments
 * Feel free to relocated or delete this unit test if it doesn't belong here.
 */
@Test public void testCreateComment() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  ClientAnchor anchor=wb.getCreationHelper().createClientAnchor();
  XSSFSheet sheet=wb.createSheet();
  XSSFComment comment=sheet.createDrawingPatriarch().createCellComment(anchor);
  assertNotNull(comment);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * See bug #50829
 */
@Test public void tables() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("WithTable.xlsx");
  assertEquals(3,wb.getNumberOfSheets());
  XSSFSheet s1=wb.getSheetAt(0);
  assertEquals("a",s1.getRow(0).getCell(0).getRichStringCellValue().toString());
  assertEquals(1.0,s1.getRow(1).getCell(0).getNumericCellValue(),0);
  List<XSSFTable> tables=s1.getTables();
  assertNotNull(tables);
  assertEquals(1,tables.size());
  XSSFTable table=tables.get(0);
  assertEquals("Tabella1",table.getName());
  assertEquals("Tabella1",table.getDisplayName());
  XSSFSheet s2=wb.getSheetAt(1);
  assertEquals(0,s2.getTables().size());
  XSSFSheet s3=wb.getSheetAt(2);
  assertEquals(0,s3.getTables().size());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void protectSheet_lowlevel() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sheet=wb.createSheet();
  CTSheetProtection pr=sheet.getCTWorksheet().getSheetProtection();
  assertNull("CTSheetProtection should be null by default",pr);
  String password="Test";
  sheet.protectSheet(password);
  pr=sheet.getCTWorksheet().getSheetProtection();
  assertNotNull("CTSheetProtection should be not null",pr);
  assertTrue("sheet protection should be on",pr.isSetSheet());
  assertTrue("object protection should be on",pr.isSetObjects());
  assertTrue("scenario protection should be on",pr.isSetScenarios());
  int hashVal=CryptoFunctions.createXorVerifier1(password);
  int actualVal=Integer.parseInt(pr.xgetPassword().getStringValue(),16);
  assertEquals("well known value for top secret hash should match",hashVal,actualVal);
  sheet.protectSheet(null);
  assertNull("protectSheet(null) should unset CTSheetProtection",sheet.getCTWorksheet().getSheetProtection());
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Hiding a column included in a column span
 */
@Test public void bug47804() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47804.xlsx");
  XSSFSheet sheet=wb1.getSheetAt(0);
  CTCols cols=sheet.getCTWorksheet().getColsArray(0);
  assertEquals(2,cols.sizeOfColArray());
  CTCol col;
  col=cols.getColArray(0);
  assertEquals(2,col.getMin());
  assertEquals(4,col.getMax());
  col=cols.getColArray(1);
  assertEquals(7,col.getMin());
  assertEquals(7,col.getMax());
  sheet.setColumnHidden(2,true);
  sheet.setColumnHidden(6,true);
  assertTrue(sheet.isColumnHidden(2));
  assertTrue(sheet.isColumnHidden(6));
  assertFalse(sheet.isColumnHidden(1));
  assertFalse(sheet.isColumnHidden(3));
  assertFalse(sheet.isColumnHidden(4));
  assertFalse(sheet.isColumnHidden(5));
  ColumnHelper.sortColumns(cols);
  assertEquals(4,cols.sizeOfColArray());
  col=cols.getColArray(0);
  assertEquals(2,col.getMin());
  assertEquals(2,col.getMax());
  col=cols.getColArray(1);
  assertEquals(3,col.getMin());
  assertEquals(3,col.getMax());
  col=cols.getColArray(2);
  assertEquals(4,col.getMin());
  assertEquals(4,col.getMax());
  col=cols.getColArray(3);
  assertEquals(7,col.getMin());
  assertEquals(7,col.getMax());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertTrue(sheet.isColumnHidden(2));
  assertTrue(sheet.isColumnHidden(6));
  assertFalse(sheet.isColumnHidden(1));
  assertFalse(sheet.isColumnHidden(3));
  assertFalse(sheet.isColumnHidden(4));
  assertFalse(sheet.isColumnHidden(5));
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug49966() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("49966.xlsx");
  CalculationChain calcChain=wb1.getCalculationChain();
  assertNotNull(wb1.getCalculationChain());
  assertEquals(3,calcChain.getCTCalcChain().sizeOfCArray());
  XSSFSheet sheet=wb1.getSheetAt(0);
  XSSFRow row=sheet.getRow(0);
  sheet.removeRow(row);
  assertEquals("XSSFSheet#removeRow did not clear calcChain entries",0,calcChain.getCTCalcChain().sizeOfCArray());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertNull(wb2.getCalculationChain());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheetMergeRegions </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeRegionsSpeed() throws IOException {
  final XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("57893-many-merges.xlsx");
  try {
    long millis=Long.MAX_VALUE;
    for (int i=0; i < 5; i++) {
      millis=runTest(wb);
      if (millis < 2000) {
        break;
      }
      System.out.println("Retry " + i + " because run-time is too high: "+ millis);
    }
    assertTrue("Should have taken <2000 ms to iterate 50k merged regions but took " + millis,millis < 2000);
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheetShiftRows </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test57171() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("57171_57163_57165.xlsx");
  assertEquals(5,wb.getActiveSheetIndex());
  removeAllSheetsBut(5,wb);
  assertEquals(0,wb.getActiveSheetIndex());
  Workbook wbRead=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(0,wbRead.getActiveSheetIndex());
  wbRead.removeSheetAt(0);
  assertEquals(0,wbRead.getActiveSheetIndex());
  wbRead.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testBug53798a() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("53798.xlsx");
  Sheet testSheet=wb.getSheetAt(0);
  testSheet.shiftRows(3,3,-1);
  for (  Row r : testSheet) {
    r.getRowNum();
  }
  testSheet.shiftRows(6,6,1);
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertNotNull(read);
  Sheet readSheet=read.getSheetAt(0);
  verifyCellContent(readSheet,0,"0.0");
  verifyCellContent(readSheet,1,"1.0");
  verifyCellContent(readSheet,2,"3.0");
  verifyCellContent(readSheet,3,null);
  verifyCellContent(readSheet,4,"4.0");
  verifyCellContent(readSheet,5,"5.0");
  verifyCellContent(readSheet,6,null);
  verifyCellContent(readSheet,7,"6.0");
  verifyCellContent(readSheet,8,"8.0");
  read.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testBug53798() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("53798.xlsx");
  Sheet testSheet=wb.getSheetAt(0);
  testSheet.shiftRows(3,3,-2);
  Row newRow=null;
  Cell newCell=null;
  newRow=testSheet.createRow(3);
  newCell=newRow.createCell(0);
  newCell.setCellValue("new Cell in row " + newRow.getRowNum());
  testSheet.shiftRows(6,7,1);
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertNotNull(read);
  Sheet readSheet=read.getSheetAt(0);
  verifyCellContent(readSheet,0,"0.0");
  verifyCellContent(readSheet,1,"3.0");
  verifyCellContent(readSheet,2,"2.0");
  verifyCellContent(readSheet,3,"new Cell in row 3");
  verifyCellContent(readSheet,4,"4.0");
  verifyCellContent(readSheet,5,"5.0");
  verifyCellContent(readSheet,6,null);
  verifyCellContent(readSheet,7,"6.0");
  verifyCellContent(readSheet,8,"7.0");
  read.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56017() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("56017.xlsx");
  Sheet sheet=wb.getSheetAt(0);
  Comment comment=sheet.getCellComment(0,0);
  assertNotNull(comment);
  assertEquals("Amdocs",comment.getAuthor());
  assertEquals("Amdocs:\ntest\n",comment.getString().getString());
  sheet.shiftRows(0,1,1);
  comment=sheet.getCellComment(0,0);
  assertNull(comment);
  comment=sheet.getCellComment(1,0);
  assertNotNull(comment);
  assertEquals("Amdocs",comment.getAuthor());
  assertEquals("Amdocs:\ntest\n",comment.getString().getString());
  Workbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(wb);
  wb.close();
  assertNotNull(wbBack);
  Sheet sheetBack=wbBack.getSheetAt(0);
  comment=sheetBack.getCellComment(0,0);
  assertNull(comment);
  comment=sheetBack.getCellComment(1,0);
  assertNotNull(comment);
  assertEquals("Amdocs",comment.getAuthor());
  assertEquals("Amdocs:\ntest\n",comment.getString().getString());
  wbBack.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFTable </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCTTableStyleInfo() throws IOException {
  XSSFWorkbook outputWorkbook=new XSSFWorkbook();
  XSSFSheet sheet=outputWorkbook.createSheet();
  XSSFTable outputTable=sheet.createTable();
  outputTable.setDisplayName("Test");
  CTTable outputCTTable=outputTable.getCTTable();
  CTTableStyleInfo outputStyleInfo=outputCTTable.addNewTableStyleInfo();
  outputStyleInfo.setName("TableStyleLight1");
  outputStyleInfo.setShowColumnStripes(false);
  outputStyleInfo.setShowRowStripes(true);
  XSSFWorkbook inputWorkbook=XSSFTestDataSamples.writeOutAndReadBack(outputWorkbook);
  List<XSSFTable> tables=inputWorkbook.getSheetAt(0).getTables();
  assertEquals("Tables number",1,tables.size());
  XSSFTable inputTable=tables.get(0);
  assertEquals("Table display name",outputTable.getDisplayName(),inputTable.getDisplayName());
  CTTableStyleInfo inputStyleInfo=inputTable.getCTTable().getTableStyleInfo();
  assertEquals("Style name",outputStyleInfo.getName(),inputStyleInfo.getName());
  assertEquals("Show column stripes",outputStyleInfo.getShowColumnStripes(),inputStyleInfo.getShowColumnStripes());
  assertEquals("Show row stripes",outputStyleInfo.getShowRowStripes(),inputStyleInfo.getShowRowStripes());
  inputWorkbook.close();
  outputWorkbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFTextParagraph </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXSSFTextParagraph() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
    XSSFRichTextString rt=new XSSFRichTextString("Test String");
    XSSFFont font=wb.createFont();
    Color color=new Color(0,255,255);
    font.setColor(new XSSFColor(color));
    font.setFontName("Arial");
    rt.applyFont(font);
    shape.setText(rt);
    List<XSSFTextParagraph> paras=shape.getTextParagraphs();
    assertEquals(1,paras.size());
    XSSFTextParagraph text=paras.get(0);
    assertEquals("Test String",text.getText());
    assertFalse(text.isBullet());
    assertNotNull(text.getXmlObject());
    assertEquals(shape.getCTShape(),text.getParentShape());
    assertNotNull(text.iterator());
    assertNotNull(text.addLineBreak());
    assertNotNull(text.getTextRuns());
    assertEquals(2,text.getTextRuns().size());
    text.addNewTextRun();
    assertEquals(3,text.getTextRuns().size());
    assertEquals(TextAlign.LEFT,text.getTextAlign());
    text.setTextAlign(null);
    assertEquals(TextAlign.LEFT,text.getTextAlign());
    text.setTextAlign(TextAlign.CENTER);
    assertEquals(TextAlign.CENTER,text.getTextAlign());
    text.setTextAlign(TextAlign.RIGHT);
    assertEquals(TextAlign.RIGHT,text.getTextAlign());
    text.setTextAlign(null);
    assertEquals(TextAlign.LEFT,text.getTextAlign());
    text.setTextFontAlign(TextFontAlign.BASELINE);
    assertEquals(TextFontAlign.BASELINE,text.getTextFontAlign());
    text.setTextFontAlign(TextFontAlign.BOTTOM);
    assertEquals(TextFontAlign.BOTTOM,text.getTextFontAlign());
    text.setTextFontAlign(null);
    assertEquals(TextFontAlign.BASELINE,text.getTextFontAlign());
    text.setTextFontAlign(null);
    assertEquals(TextFontAlign.BASELINE,text.getTextFontAlign());
    assertNull(text.getBulletFont());
    text.setBulletFont("Arial");
    assertEquals("Arial",text.getBulletFont());
    assertNull(text.getBulletCharacter());
    text.setBulletCharacter(".");
    assertEquals(".",text.getBulletCharacter());
    assertNull(text.getBulletFontColor());
    text.setBulletFontColor(color);
    assertEquals(color,text.getBulletFontColor());
    assertEquals(100.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(1.0);
    assertEquals(1.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(1.0);
    assertEquals(1.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(-9.0);
    assertEquals(-9.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(-9.0);
    assertEquals(-9.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(1.0);
    assertEquals(1.0,text.getBulletFontSize(),0.01);
    text.setBulletFontSize(-9.0);
    assertEquals(-9.0,text.getBulletFontSize(),0.01);
    assertEquals(0.0,text.getIndent(),0.01);
    text.setIndent(2.0);
    assertEquals(2.0,text.getIndent(),0.01);
    text.setIndent(-1.0);
    assertEquals(0.0,text.getIndent(),0.01);
    text.setIndent(-1.0);
    assertEquals(0.0,text.getIndent(),0.01);
    assertEquals(0.0,text.getLeftMargin(),0.01);
    text.setLeftMargin(3.0);
    assertEquals(3.0,text.getLeftMargin(),0.01);
    text.setLeftMargin(-1.0);
    assertEquals(0.0,text.getLeftMargin(),0.01);
    text.setLeftMargin(-1.0);
    assertEquals(0.0,text.getLeftMargin(),0.01);
    assertEquals(0.0,text.getRightMargin(),0.01);
    text.setRightMargin(4.5);
    assertEquals(4.5,text.getRightMargin(),0.01);
    text.setRightMargin(-1.0);
    assertEquals(0.0,text.getRightMargin(),0.01);
    text.setRightMargin(-1.0);
    assertEquals(0.0,text.getRightMargin(),0.01);
    assertEquals(0.0,text.getDefaultTabSize(),0.01);
    assertEquals(0.0,text.getTabStop(0),0.01);
    text.addTabStop(3.14);
    assertEquals(3.14,text.getTabStop(0),0.01);
    assertEquals(100.0,text.getLineSpacing(),0.01);
    text.setLineSpacing(3.15);
    assertEquals(3.15,text.getLineSpacing(),0.01);
    text.setLineSpacing(-2.13);
    assertEquals(-2.13,text.getLineSpacing(),0.01);
    assertEquals(0.0,text.getSpaceBefore(),0.01);
    text.setSpaceBefore(3.17);
    assertEquals(3.17,text.getSpaceBefore(),0.01);
    text.setSpaceBefore(-4.7);
    assertEquals(-4.7,text.getSpaceBefore(),0.01);
    assertEquals(0.0,text.getSpaceAfter(),0.01);
    text.setSpaceAfter(6.17);
    assertEquals(6.17,text.getSpaceAfter(),0.01);
    text.setSpaceAfter(-8.17);
    assertEquals(-8.17,text.getSpaceAfter(),0.01);
    assertEquals(0,text.getLevel());
    text.setLevel(1);
    assertEquals(1,text.getLevel());
    text.setLevel(4);
    assertEquals(4,text.getLevel());
    assertTrue(text.isBullet());
    assertFalse(text.isBulletAutoNumber());
    text.setBullet(false);
    text.setBullet(false);
    assertFalse(text.isBullet());
    assertFalse(text.isBulletAutoNumber());
    text.setBullet(true);
    assertTrue(text.isBullet());
    assertFalse(text.isBulletAutoNumber());
    assertEquals(0,text.getBulletAutoNumberStart());
    assertEquals(ListAutoNumber.ARABIC_PLAIN,text.getBulletAutoNumberScheme());
    text.setBullet(false);
    assertFalse(text.isBullet());
    text.setBullet(ListAutoNumber.CIRCLE_NUM_DB_PLAIN);
    assertTrue(text.isBullet());
    assertTrue(text.isBulletAutoNumber());
    assertEquals(0,text.getBulletAutoNumberStart());
    assertEquals(ListAutoNumber.CIRCLE_NUM_DB_PLAIN,text.getBulletAutoNumberScheme());
    text.setBullet(false);
    assertFalse(text.isBullet());
    assertFalse(text.isBulletAutoNumber());
    text.setBullet(ListAutoNumber.CIRCLE_NUM_WD_BLACK_PLAIN,10);
    assertTrue(text.isBullet());
    assertTrue(text.isBulletAutoNumber());
    assertEquals(10,text.getBulletAutoNumberStart());
    assertEquals(ListAutoNumber.CIRCLE_NUM_WD_BLACK_PLAIN,text.getBulletAutoNumberScheme());
    assertNotNull(text.toString());
    new XSSFTextParagraph(text.getXmlObject(),shape.getCTShape());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFTextRun </h4><pre class="type-2 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXSSFTextParagraph() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    XSSFSheet sheet=wb.createSheet();
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    XSSFTextBox shape=drawing.createTextbox(new XSSFClientAnchor(0,0,0,0,2,2,3,4));
    XSSFTextParagraph para=shape.addNewTextParagraph();
    para.addNewTextRun().setText("Line 1");
    List<XSSFTextRun> runs=para.getTextRuns();
    assertEquals(1,runs.size());
    XSSFTextRun run=runs.get(0);
    assertEquals("Line 1",run.getText());
    assertNotNull(run.getParentParagraph());
    assertNotNull(run.getXmlObject());
    assertNotNull(run.getRPr());
    assertEquals(new Color(0,0,0),run.getFontColor());
    Color color=new Color(0,255,255);
    run.setFontColor(color);
    assertEquals(color,run.getFontColor());
    assertEquals(11.0,run.getFontSize(),0.01);
    run.setFontSize(12.32);
    assertEquals(12.32,run.getFontSize(),0.01);
    run.setFontSize(-1.0);
    assertEquals(11.0,run.getFontSize(),0.01);
    run.setFontSize(-1.0);
    assertEquals(11.0,run.getFontSize(),0.01);
    try {
      run.setFontSize(0.9);
      fail("Should fail");
    }
 catch (    IllegalArgumentException e) {
      assertTrue(e.getMessage().contains("0.9"));
    }
    assertEquals(11.0,run.getFontSize(),0.01);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(12.31);
    assertEquals(12.31,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(0.0);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    run.setCharacterSpacing(0.0);
    assertEquals(0.0,run.getCharacterSpacing(),0.01);
    assertEquals("Calibri",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)-1,(byte)1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)-1,false);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily("Arial",(byte)1,(byte)1,true);
    assertEquals("Arial",run.getFontFamily());
    run.setFontFamily(null,(byte)1,(byte)1,false);
    assertEquals("Calibri",run.getFontFamily());
    run.setFontFamily(null,(byte)1,(byte)1,false);
    assertEquals("Calibri",run.getFontFamily());
    run.setFont("Arial");
    assertEquals("Arial",run.getFontFamily());
    assertEquals((byte)0,run.getPitchAndFamily());
    run.setFont(null);
    assertEquals((byte)0,run.getPitchAndFamily());
    assertFalse(run.isStrikethrough());
    run.setStrikethrough(true);
    assertTrue(run.isStrikethrough());
    run.setStrikethrough(false);
    assertFalse(run.isStrikethrough());
    assertFalse(run.isSuperscript());
    run.setSuperscript(true);
    assertTrue(run.isSuperscript());
    run.setSuperscript(false);
    assertFalse(run.isSuperscript());
    assertFalse(run.isSubscript());
    run.setSubscript(true);
    assertTrue(run.isSubscript());
    run.setSubscript(false);
    assertFalse(run.isSubscript());
    assertEquals(TextCap.NONE,run.getTextCap());
    assertFalse(run.isBold());
    run.setBold(true);
    assertTrue(run.isBold());
    run.setBold(false);
    assertFalse(run.isBold());
    assertFalse(run.isItalic());
    run.setItalic(true);
    assertTrue(run.isItalic());
    run.setItalic(false);
    assertFalse(run.isItalic());
    assertFalse(run.isUnderline());
    run.setUnderline(true);
    assertTrue(run.isUnderline());
    run.setUnderline(false);
    assertFalse(run.isUnderline());
    assertNotNull(run.toString());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFWorkbook </h4><pre class="type-2 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56957CloseWorkbook() throws Exception {
  File file=TempFile.createTempFile("TestBug56957_",".xlsx");
  final Date dateExp=LocaleUtil.getLocaleCalendar(2014,10,9).getTime();
  try {
    FileHelper.copyFile(HSSFTestDataSamples.getSampleFile("56957.xlsx"),file);
    assertTrue(file.exists());
    Workbook workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ));
    Date dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ_WRITE));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
    workbook=WorkbookFactory.create(OPCPackage.open(file,PackageAccess.READ_WRITE));
    dateAct=workbook.getSheetAt(0).getRow(0).getCell(0,Row.CREATE_NULL_AS_BLANK).getDateCellValue();
    assertEquals(dateExp,dateAct);
    workbook.close();
    workbook=null;
  }
  finally {
    assertTrue(file.exists());
    assertTrue(file.delete());
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the attached test data was not modified. If this test method
 * fails, the test data is not working properly.
 */
@Test public void bug47668() throws Exception {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("47668.xlsx");
  List<XSSFPictureData> allPictures=workbook.getAllPictures();
  assertEquals(1,allPictures.size());
  PackagePartName imagePartName=PackagingURIHelper.createPartName("/xl/media/image1.jpeg");
  PackagePart imagePart=workbook.getPackage().getPart(imagePartName);
  assertNotNull(imagePart);
  for (  XSSFPictureData pictureData : allPictures) {
    PackagePart picturePart=pictureData.getPackagePart();
    assertSame(imagePart,picturePart);
  }
  XSSFSheet sheet0=workbook.getSheetAt(0);
  XSSFDrawing drawing0=sheet0.createDrawingPatriarch();
  XSSFPictureData pictureData0=(XSSFPictureData)drawing0.getRelations().get(0);
  byte[] data0=pictureData0.getData();
  CRC32 crc0=new CRC32();
  crc0.update(data0);
  XSSFSheet sheet1=workbook.getSheetAt(1);
  XSSFDrawing drawing1=sheet1.createDrawingPatriarch();
  XSSFPictureData pictureData1=(XSSFPictureData)drawing1.getRelations().get(0);
  byte[] data1=pictureData1.getData();
  CRC32 crc1=new CRC32();
  crc1.update(data1);
  assertEquals(crc0.getValue(),crc1.getValue());
  workbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLoadWorkbookWithPivotTable() throws Exception {
  File file=TempFile.createTempFile("ooxml-pivottable",".xlsx");
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    setPivotData(wb);
    FileOutputStream fileOut=new FileOutputStream(file);
    wb.write(fileOut);
    fileOut.close();
  }
  finally {
    wb.close();
  }
  XSSFWorkbook wb2=(XSSFWorkbook)WorkbookFactory.create(file);
  try {
    assertTrue(wb2.getPivotTables().size() == 1);
  }
  finally {
    wb2.close();
  }
  assertTrue(file.delete());
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testAddPivotTableToWorkbookWithLoadedPivotTable() throws Exception {
  File file=TempFile.createTempFile("ooxml-pivottable",".xlsx");
  XSSFWorkbook wb=new XSSFWorkbook();
  try {
    setPivotData(wb);
    FileOutputStream fileOut=new FileOutputStream(file);
    try {
      wb.write(fileOut);
    }
  finally {
      fileOut.close();
    }
  }
  finally {
    wb.close();
  }
  XSSFWorkbook wb2=(XSSFWorkbook)WorkbookFactory.create(file);
  try {
    setPivotData(wb2);
    assertTrue(wb2.getPivotTables().size() == 2);
  }
  finally {
    wb2.close();
  }
  assertTrue(file.delete());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can save, and then re-load a new document
 */
@Test public void saveLoadNew() throws IOException, InvalidFormatException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  CTWorkbookPr pr=wb1.getCTWorkbook().getWorkbookPr();
  assertNotNull(pr);
  assertTrue(pr.isSetDate1904());
  assertFalse("XSSF must use the 1900 date system",pr.getDate1904());
  Sheet sheet1=wb1.createSheet("sheet1");
  Sheet sheet2=wb1.createSheet("sheet2");
  wb1.createSheet("sheet3");
  RichTextString rts=wb1.getCreationHelper().createRichTextString("hello world");
  sheet1.createRow(0).createCell((short)0).setCellValue(1.2);
  sheet1.createRow(1).createCell((short)0).setCellValue(rts);
  sheet2.createRow(0);
  assertEquals(0,wb1.getSheetAt(0).getFirstRowNum());
  assertEquals(1,wb1.getSheetAt(0).getLastRowNum());
  assertEquals(0,wb1.getSheetAt(1).getFirstRowNum());
  assertEquals(0,wb1.getSheetAt(1).getLastRowNum());
  assertEquals(0,wb1.getSheetAt(2).getFirstRowNum());
  assertEquals(0,wb1.getSheetAt(2).getLastRowNum());
  File file=TempFile.createTempFile("poi-",".xlsx");
  OutputStream out=new FileOutputStream(file);
  wb1.write(out);
  out.close();
  OPCPackage pkg=OPCPackage.open(file.toString());
  PackagePart wbRelPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/_rels/workbook.xml.rels"));
  assertNotNull(wbRelPart);
  assertTrue(wbRelPart.isRelationshipPart());
  assertEquals(ContentTypes.RELATIONSHIPS_PART,wbRelPart.getContentType());
  PackagePart wbPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/workbook.xml"));
  assertTrue(wbPart.hasRelationships());
  assertEquals(5,wbPart.getRelationships().size());
  wb1.close();
  @SuppressWarnings("resource") XSSFWorkbook wb2=new XSSFWorkbook(pkg);
  assertEquals(3,wb2.getNumberOfSheets());
  assertNotNull(wb2.getSheetAt(0));
  assertNotNull(wb2.getSheetAt(1));
  assertNotNull(wb2.getSheetAt(2));
  assertNotNull(wb2.getSharedStringSource());
  assertNotNull(wb2.getStylesSource());
  assertEquals(0,wb2.getSheetAt(0).getFirstRowNum());
  assertEquals(1,wb2.getSheetAt(0).getLastRowNum());
  assertEquals(0,wb2.getSheetAt(1).getFirstRowNum());
  assertEquals(0,wb2.getSheetAt(1).getLastRowNum());
  assertEquals(0,wb2.getSheetAt(2).getFirstRowNum());
  assertEquals(0,wb2.getSheetAt(2).getLastRowNum());
  sheet1=wb2.getSheetAt(0);
  assertEquals(1.2,sheet1.getRow(0).getCell(0).getNumericCellValue(),0.0001);
  assertEquals("hello world",sheet1.getRow(1).getCell(0).getRichStringCellValue().getString());
  pkg.close();
}

</code></pre>

<br>
<pre class="type-2 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with the count of the number of styles
 * coming out wrong
 */
@Test public void bug49702() throws IOException {
  XSSFWorkbook wb1=new XSSFWorkbook();
  assertEquals(1,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  try {
    wb1.getCellStyleAt((short)1);
    fail("Shouldn't be able to get style at 1 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  CellStyle cs=wb1.createCellStyle();
  cs.setDataFormat((short)11);
  assertEquals(2,wb1.getNumCellStyles());
  wb1.getCellStyleAt((short)0);
  wb1.getCellStyleAt((short)1);
  try {
    wb1.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook nwb=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(2,nwb.getNumCellStyles());
  nwb.getCellStyleAt((short)0);
  nwb.getCellStyleAt((short)1);
  try {
    nwb.getCellStyleAt((short)2);
    fail("Shouldn't be able to get style at 2 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.openSampleWorkbook("sample.xlsx");
  assertEquals(3,wb2.getNumCellStyles());
  wb2.getCellStyleAt((short)0);
  wb2.getCellStyleAt((short)1);
  wb2.getCellStyleAt((short)2);
  try {
    wb2.getCellStyleAt((short)3);
    fail("Shouldn't be able to get style at 3 that doesn't exist");
  }
 catch (  IndexOutOfBoundsException e) {
  }
  wb2.close();
  wb1.close();
  nwb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test setting of core properties such as Title and Author
 * @throws IOException
 */
@Test public void workbookProperties() throws IOException {
  XSSFWorkbook workbook=new XSSFWorkbook();
  try {
    POIXMLProperties props=workbook.getProperties();
    assertNotNull(props);
    assertEquals("Apache POI",props.getExtendedProperties().getUnderlyingProperties().getApplication());
    PackagePropertiesPart opcProps=props.getCoreProperties().getUnderlyingProperties();
    assertNotNull(opcProps);
    opcProps.setTitleProperty("Testing Bugzilla #47460");
    assertEquals("Apache POI",opcProps.getCreatorProperty().getValue());
    opcProps.setCreatorProperty("poi-dev@poi.apache.org");
    XSSFWorkbook wbBack=XSSFTestDataSamples.writeOutAndReadBack(workbook);
    assertEquals("Apache POI",wbBack.getProperties().getExtendedProperties().getUnderlyingProperties().getApplication());
    opcProps=wbBack.getProperties().getCoreProperties().getUnderlyingProperties();
    assertEquals("Testing Bugzilla #47460",opcProps.getTitleProperty().getValue());
    assertEquals("poi-dev@poi.apache.org",opcProps.getCreatorProperty().getValue());
    wbBack.close();
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void styles() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  StylesTable ss=wb1.getStylesSource();
  assertNotNull(ss);
  StylesTable st=ss;
  assertEquals(8,st.getNumDataFormats());
  assertEquals(2,st.getFonts().size());
  assertEquals(2,st.getFills().size());
  assertEquals(1,st.getBorders().size());
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 8,st.putNumberFormat("testFORMAT"));
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 8,st.putNumberFormat("testFORMAT"));
  assertEquals(StylesTable.FIRST_CUSTOM_STYLE_ID + 9,st.putNumberFormat("testFORMAT2"));
  assertEquals(10,st.getNumDataFormats());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  ss=wb2.getStylesSource();
  assertNotNull(ss);
  assertEquals(10,st.getNumDataFormats());
  assertEquals(2,st.getFonts().size());
  assertEquals(2,st.getFills().size());
  assertEquals(1,st.getBorders().size());
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void bug48495() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("48495.xlsx");
  assertSheetOrder(wb,"Sheet1");
  Sheet sheet=wb.getSheetAt(0);
  sheet.shiftRows(2,sheet.getLastRowNum(),1,true,false);
  Row newRow=sheet.getRow(2);
  if (newRow == null)   newRow=sheet.createRow(2);
  newRow.createCell(0).setCellValue(" Another Header");
  wb.cloneSheet(0);
  assertSheetOrder(wb,"Sheet1","Sheet1 (2)");
  Workbook read=XSSFTestDataSamples.writeOutAndReadBack(wb);
  assertNotNull(read);
  assertSheetOrder(read,"Sheet1","Sheet1 (2)");
  read.close();
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Problems with XSSFWorkbook.removeSheetAt when workbook contains charts
 */
@Test public void bug47813() throws IOException {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("47813.xlsx");
  assertEquals(3,wb1.getNumberOfSheets());
  assertNotNull(wb1.getCalculationChain());
  assertEquals("Numbers",wb1.getSheetName(0));
  assertEquals("Chart",wb1.getSheetName(1));
  assertTrue(wb1.getSheetAt(1) instanceof XSSFChartSheet);
  assertEquals("SomeJunk",wb1.getSheetName(2));
  wb1.removeSheetAt(2);
  assertEquals(2,wb1.getNumberOfSheets());
  assertNull(wb1.getCalculationChain());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertEquals(2,wb2.getNumberOfSheets());
  assertNull(wb2.getCalculationChain());
  assertEquals("Numbers",wb2.getSheetName(0));
  assertEquals("Chart",wb2.getSheetName(1));
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug51158() throws IOException {
  final XSSFWorkbook wb1=new XSSFWorkbook();
  XSSFSheet sheet=wb1.createSheet("Test Sheet");
  XSSFRow row=sheet.createRow(2);
  XSSFCell cell=row.createCell(3);
  cell.setCellValue("test1");
  XSSFComment comment=sheet.createDrawingPatriarch().createCellComment(new XSSFClientAnchor());
  assertNotNull(comment);
  comment.setString("some comment");
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  assertNotNull(wb2);
  sheet=wb2.getSheetAt(0);
  row=sheet.getRow(2);
  assertEquals("test1",row.getCell(3).getStringCellValue());
  assertNull(row.getCell(4));
  cell=row.createCell(4);
  cell.setCellValue("test2");
  XSSFWorkbook wb3=XSSFTestDataSamples.writeOutAndReadBack(wb2);
  assertNotNull(wb3);
  sheet=wb3.getSheetAt(0);
  row=sheet.getRow(2);
  assertEquals("test1",row.getCell(3).getStringCellValue());
  assertEquals("test2",row.getCell(4).getStringCellValue());
  wb3.close();
  wb2.close();
  wb1.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void loadSave() throws IOException {
  XSSFWorkbook workbook=XSSFTestDataSamples.openSampleWorkbook("Formatting.xlsx");
  assertEquals(3,workbook.getNumberOfSheets());
  assertEquals("dd/mm/yyyy",workbook.getSheetAt(0).getRow(1).getCell(0).getRichStringCellValue().getString());
  assertNotNull(workbook.getSharedStringSource());
  assertNotNull(workbook.getStylesSource());
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(workbook);
  assertEquals(3,wb2.getNumberOfSheets());
  assertNotNull(wb2.getSheetAt(0));
  assertNotNull(wb2.getSheetAt(1));
  assertNotNull(wb2.getSheetAt(2));
  assertEquals("dd/mm/yyyy",wb2.getSheetAt(0).getRow(1).getCell(0).getRichStringCellValue().getString());
  assertEquals("yyyy/mm/dd",wb2.getSheetAt(0).getRow(2).getCell(0).getRichStringCellValue().getString());
  assertEquals("yyyy-mm-dd",wb2.getSheetAt(0).getRow(3).getCell(0).getRichStringCellValue().getString());
  assertEquals("yy/mm/dd",wb2.getSheetAt(0).getRow(4).getCell(0).getRichStringCellValue().getString());
  assertNotNull(wb2.getSharedStringSource());
  assertNotNull(wb2.getStylesSource());
  workbook.close();
  wb2.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can save a workbook with macros and reload it.
 */
@Test public void testSetVBAProject() throws Exception {
  File file;
  final byte[] allBytes=new byte[256];
  for (int i=0; i < 256; i++) {
    allBytes[i]=(byte)(i - 128);
  }
  XSSFWorkbook wb1=new XSSFWorkbook();
  wb1.createSheet();
  wb1.setVBAProject(new ByteArrayInputStream(allBytes));
  file=TempFile.createTempFile("poi-",".xlsm");
  OutputStream out=new FileOutputStream(file);
  wb1.write(out);
  out.close();
  wb1.close();
  OPCPackage pkg=OPCPackage.open(file.toString());
  PackagePart wbPart=pkg.getPart(PackagingURIHelper.createPartName("/xl/workbook.xml"));
  assertTrue(wbPart.hasRelationships());
  final PackageRelationshipCollection relationships=wbPart.getRelationships().getRelationships(XSSFRelation.VBA_MACROS.getRelation());
  assertEquals(1,relationships.size());
  assertEquals(XSSFRelation.VBA_MACROS.getDefaultFileName(),relationships.getRelationship(0).getTargetURI().toString());
  PackagePart vbaPart=pkg.getPart(PackagingURIHelper.createPartName(XSSFRelation.VBA_MACROS.getDefaultFileName()));
  assertNotNull(vbaPart);
  assertFalse(vbaPart.isRelationshipPart());
  assertEquals(XSSFRelation.VBA_MACROS.getContentType(),vbaPart.getContentType());
  final byte[] fromFile=IOUtils.toByteArray(vbaPart.getInputStream());
  assertArrayEquals(allBytes,fromFile);
  @SuppressWarnings("resource") XSSFWorkbook wb2=new XSSFWorkbook(pkg);
  assertEquals(1,wb2.getNumberOfSheets());
  assertEquals(XSSFWorkbookType.XLSM,wb2.getWorkbookType());
  pkg.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.TestDocumentProtection </h4><pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void bug56076_write() throws Exception {
  XWPFDocument document=new XWPFDocument();
  document.enforceCommentsProtection("Example",HashAlgorithm.sha512);
  document=XWPFTestDataSamples.writeOutAndReadBack(document);
  boolean isValid=document.validateProtectionPassword("Example");
  assertTrue(isValid);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.TestXWPFBugs </h4><pre class="type-2 type-1 type-3 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word document with aes-256, i.e. aes is always 128 bit (= 128 bit block size),
 * but the key can be 128/192/256 bits
 */
@Test public void bug53475_aes256() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength("AES");
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files for AES 256",maxKeyLen == 2147483647);
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-pass.docx");
  NPOIFSFileSystem filesystem=new NPOIFSFileSystem(file,true);
  EncryptionInfo info=new EncryptionInfo(filesystem);
  assertEquals(16,info.getHeader().getBlockSize());
  assertEquals(256,info.getHeader().getKeySize());
  assertEquals(CipherAlgorithm.aes256,info.getHeader().getCipherAlgorithm());
  assertEquals(HashAlgorithm.sha1,info.getHeader().getHashAlgorithmEx());
  Decryptor d=Decryptor.getInstance(info);
  assertTrue("Unable to process: document is encrypted",d.verifyPassword("pass"));
  InputStream dataStream=d.getDataStream(filesystem);
  OPCPackage opc=OPCPackage.open(dataStream);
  XWPFDocument doc=new XWPFDocument(opc);
  XWPFWordExtractor ex=new XWPFWordExtractor(doc);
  String text=ex.getText();
  assertNotNull(text);
  assertEquals("The is a password protected document.",text.trim());
  ex.close();
  filesystem.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word document that's encrypted with non-standard
 * Encryption options, and no cspname section. See bug 53475
 */
@Test public void bug53475NoCSPName() throws Exception {
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-solrcell.docx");
  NPOIFSFileSystem filesystem=new NPOIFSFileSystem(file,true);
  EncryptionInfo info=new EncryptionInfo(filesystem);
  assertEquals(128,info.getHeader().getKeySize());
  assertEquals(CipherAlgorithm.aes128,info.getHeader().getCipherAlgorithm());
  assertEquals(HashAlgorithm.sha1,info.getHeader().getHashAlgorithmEx());
  Decryptor d=Decryptor.getInstance(info);
  assertTrue("Unable to process: document is encrypted",d.verifyPassword("solrcell"));
  InputStream dataStream=d.getDataStream(filesystem);
  OPCPackage opc=OPCPackage.open(dataStream);
  XWPFDocument doc=new XWPFDocument(opc);
  XWPFWordExtractor ex=new XWPFWordExtractor(doc);
  String text=ex.getText();
  assertNotNull(text);
  assertEquals("This is password protected Word document.",text.trim());
  ex.close();
  filesystem.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestChangeTracking </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test @SuppressWarnings("resource") public void integration() throws Exception {
  XWPFDocument doc=new XWPFDocument();
  XWPFParagraph p1=doc.createParagraph();
  XWPFRun r1=p1.createRun();
  r1.setText("Lorem ipsum dolor sit amet.");
  doc.setTrackRevisions(true);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  doc.write(out);
  ByteArrayInputStream inputStream=new ByteArrayInputStream(out.toByteArray());
  XWPFDocument document=new XWPFDocument(inputStream);
  inputStream.close();
  assertTrue(document.isTrackRevisions());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestXWPFDocument </h4><pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllPictureFormats() throws IOException, InvalidFormatException {
  XWPFDocument doc=new XWPFDocument();
  doc.addPictureData(new byte[10],XWPFDocument.PICTURE_TYPE_EMF);
  doc.addPictureData(new byte[11],XWPFDocument.PICTURE_TYPE_WMF);
  doc.addPictureData(new byte[12],XWPFDocument.PICTURE_TYPE_PICT);
  doc.addPictureData(new byte[13],XWPFDocument.PICTURE_TYPE_JPEG);
  doc.addPictureData(new byte[14],XWPFDocument.PICTURE_TYPE_PNG);
  doc.addPictureData(new byte[15],XWPFDocument.PICTURE_TYPE_DIB);
  doc.addPictureData(new byte[16],XWPFDocument.PICTURE_TYPE_GIF);
  doc.addPictureData(new byte[17],XWPFDocument.PICTURE_TYPE_TIFF);
  doc.addPictureData(new byte[18],XWPFDocument.PICTURE_TYPE_EPS);
  doc.addPictureData(new byte[19],XWPFDocument.PICTURE_TYPE_BMP);
  doc.addPictureData(new byte[20],XWPFDocument.PICTURE_TYPE_WPG);
  assertEquals(11,doc.getAllPictures().size());
  XWPFDocument doc2=XWPFTestDataSamples.writeOutAndReadBack(doc);
  assertEquals(11,doc2.getAllPictures().size());
  doc2.close();
  doc.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSettings() throws IOException {
  XWPFSettings settings=new XWPFSettings();
  assertEquals(100,settings.getZoomPercent());
  settings.setZoomPercent(50);
  assertEquals(50,settings.getZoomPercent());
  XWPFDocument doc=new XWPFDocument();
  assertEquals(100,doc.getZoomPercent());
  doc.setZoomPercent(50);
  assertEquals(50,doc.getZoomPercent());
  doc.setZoomPercent(200);
  assertEquals(200,doc.getZoomPercent());
  XWPFDocument back=XWPFTestDataSamples.writeOutAndReadBack(doc);
  assertEquals(200,back.getZoomPercent());
  back.close();
  doc.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRegisterPackagePictureData() throws IOException, InvalidFormatException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("issue_51265_1.docx");
  OPCPackage opcPckg=doc.getPackage();
  XWPFRelation jpgRelation=XWPFRelation.IMAGE_JPEG;
  PackagePartName partName=PackagingURIHelper.createPartName(jpgRelation.getDefaultFileName().replace('#','2'));
  PackagePart newImagePart=opcPckg.createPart(partName,jpgRelation.getContentType());
  byte[] nature1=XWPFTestDataSamples.getImage("abstract4.jpg");
  OutputStream os=newImagePart.getOutputStream();
  os.write(nature1);
  os.close();
  XWPFHeader xwpfHeader=doc.getHeaderArray(0);
  PackageRelationship relationship=xwpfHeader.getPackagePart().addRelationship(partName,TargetMode.INTERNAL,jpgRelation.getRelation());
  XWPFPictureData newPicData=new XWPFPictureData(newImagePart,relationship);
  assertFalse(xwpfHeader.getAllPictures().contains(newPicData));
  assertFalse(doc.getAllPictures().contains(newPicData));
  assertFalse(doc.getAllPackagePictures().contains(newPicData));
  doc.registerPackagePictureData(newPicData);
  assertFalse(xwpfHeader.getAllPictures().contains(newPicData));
  assertFalse(doc.getAllPictures().contains(newPicData));
  assertTrue(doc.getAllPackagePictures().contains(newPicData));
  doc.getPackage().revert();
  opcPckg.close();
  doc.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testPictureHandlingSimpleFile() throws IOException, InvalidFormatException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("issue_51265_1.docx");
  assertEquals(1,doc.getAllPackagePictures().size());
  byte[] newPic=XWPFTestDataSamples.getImage("abstract4.jpg");
  String id1=doc.addPictureData(newPic,Document.PICTURE_TYPE_JPEG);
  assertEquals(2,doc.getAllPackagePictures().size());
  byte[] newPicCopy=Arrays.copyOf(newPic,newPic.length);
  String id2=doc.addPictureData(newPicCopy,Document.PICTURE_TYPE_JPEG);
  assertEquals(id1,id2);
  doc.getPackage().revert();
  doc.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestXWPFParagraph </h4><pre class="type-2 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchTextFound() throws IOException {
  XWPFDocument xml=XWPFTestDataSamples.openSampleDocument("ThreeColHead.docx");
  List<XWPFParagraph> ps=xml.getParagraphs();
  assertEquals(10,ps.size());
  XWPFParagraph p=ps.get(0);
  TextSegement segment=p.searchText("sample word document",new PositionInParagraph());
  assertNotNull(segment);
  assertEquals("sample word document",p.getText(segment));
  assertTrue(p.removeRun(0));
  xml.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-4 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that we get the right paragraph from the header
 * @throws IOException
 */
@Test @Ignore public void testHeaderParagraph() throws IOException {
  XWPFDocument xml=XWPFTestDataSamples.openSampleDocument("ThreeColHead.docx");
  XWPFHeader hdr=xml.getHeaderFooterPolicy().getDefaultHeader();
  assertNotNull(hdr);
  List<XWPFParagraph> ps=hdr.getParagraphs();
  assertEquals(1,ps.size());
  XWPFParagraph p=ps.get(0);
  assertEquals(5,p.getCTP().sizeOfRArray());
  assertEquals("First header column!\tMid header\tRight header!",p.getText());
  xml.close();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFieldRuns() throws IOException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("FldSimple.docx");
  List<XWPFParagraph> ps=doc.getParagraphs();
  assertEquals(1,ps.size());
  XWPFParagraph p=ps.get(0);
  assertEquals(1,p.getRuns().size());
  assertEquals(1,p.getIRuns().size());
  XWPFRun r=p.getRuns().get(0);
  assertEquals(XWPFFieldRun.class,r.getClass());
  XWPFFieldRun fr=(XWPFFieldRun)r;
  assertEquals(" FILENAME   \\* MERGEFORMAT ",fr.getFieldInstruction());
  assertEquals("FldSimple.docx",fr.text());
  assertEquals("FldSimple.docx",p.getText());
  doc.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
