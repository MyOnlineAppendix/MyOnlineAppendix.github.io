<h3><span class=" glyphicon glyphicon-tag"/>&nbspAssumptionSetter</h3><kbd>Sets implicit assumptions </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestFontRendering </h4><pre class="type-2 type-1 type-17 type-6 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug55902mixedFontWithChineseCharacters() throws Exception {
  String fontFiles[][]={{"build/scratchpad-test-resources/Cabin-Regular.ttf","mapped","Calibri"},{"build/scratchpad-test-resources/mona.ttf","fallback","Cabin"}};
  GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
  Map<String,String> fontMap=new HashMap<String,String>();
  Map<String,String> fallbackMap=new HashMap<String,String>();
  for (  String fontFile[] : fontFiles) {
    File f=new File(fontFile[0]);
    assumeTrue("necessary font file " + f.getName() + " not downloaded.",f.exists());
    Font font=Font.createFont(Font.TRUETYPE_FONT,f);
    ge.registerFont(font);
    Map<String,String> map=("mapped".equals(fontFile[1]) ? fontMap : fallbackMap);
    map.put(fontFile[2],font.getFamily());
  }
  InputStream is=slTests.openResourceAsStream("bug55902-mixedFontChineseCharacters.ppt");
  HSLFSlideShow ss=new HSLFSlideShow(is);
  is.close();
  Dimension pgsize=ss.getPageSize();
  HSLFSlide slide=ss.getSlides().get(0);
  double zoom=1;
  AffineTransform at=new AffineTransform();
  at.setToScale(zoom,zoom);
  BufferedImage imgActual=new BufferedImage((int)Math.ceil(pgsize.width * zoom),(int)Math.ceil(pgsize.height * zoom),BufferedImage.TYPE_3BYTE_BGR);
  Graphics2D graphics=imgActual.createGraphics();
  graphics.setRenderingHint(Drawable.FONT_FALLBACK,fallbackMap);
  graphics.setRenderingHint(Drawable.FONT_MAP,fontMap);
  graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  graphics.setRenderingHint(RenderingHints.KEY_RENDERING,RenderingHints.VALUE_RENDER_QUALITY);
  graphics.setRenderingHint(RenderingHints.KEY_INTERPOLATION,RenderingHints.VALUE_INTERPOLATION_BICUBIC);
  graphics.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS,RenderingHints.VALUE_FRACTIONALMETRICS_ON);
  graphics.setTransform(at);
  graphics.setPaint(Color.white);
  graphics.fill(new Rectangle2D.Float(0,0,pgsize.width,pgsize.height));
  slide.draw(graphics);
  BufferedImage imgExpected=ImageIO.read(slTests.getFile("bug55902-mixedChars.png"));
  DataBufferByte expectedDB=(DataBufferByte)imgExpected.getRaster().getDataBuffer();
  DataBufferByte actualDB=(DataBufferByte)imgActual.getRaster().getDataBuffer();
  byte[] expectedData=expectedDB.getData(0);
  byte[] actualData=actualDB.getData(0);
  if (!Arrays.equals(expectedData,actualData)) {
    ImageIO.write(imgActual,"PNG",TempFile.createTempFile("TestFontRendering",".png"));
  }
  assertArrayEquals("Expected to have matching raster-arrays, but found differences",expectedData,actualData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestAgileEncryptionParameters </h4><pre class="type-2 type-1 type-3 type-17 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAgileEncryptionModes() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength(ca.jceId);
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files",maxKeyLen >= ca.defaultKeySize);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  POIFSFileSystem fsEnc=new POIFSFileSystem();
  EncryptionInfo infoEnc=new EncryptionInfo(EncryptionMode.agile,ca,ha,-1,-1,cm);
  Encryptor enc=infoEnc.getEncryptor();
  enc.confirmPassword("foobaa");
  OutputStream os=enc.getDataStream(fsEnc);
  os.write(testData);
  os.close();
  bos.reset();
  fsEnc.writeFilesystem(bos);
  POIFSFileSystem fsDec=new POIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  EncryptionInfo infoDec=new EncryptionInfo(fsDec);
  Decryptor dec=infoDec.getDecryptor();
  boolean passed=dec.verifyPassword("foobaa");
  assertTrue(passed);
  InputStream is=dec.getDataStream(fsDec);
  byte actualData[]=IOUtils.toByteArray(is);
  is.close();
  assertThat("Failed roundtrip - " + ca + "-"+ ha+ "-"+ cm,testData,equalTo(actualData));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.crypt.TestEncryptor </h4><pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void agileEncryption() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength("AES");
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files for AES 256",maxKeyLen == 2147483647);
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-pass.docx");
  String pass="pass";
  NPOIFSFileSystem nfs=new NPOIFSFileSystem(file);
  EncryptionInfo infoExpected=new EncryptionInfo(nfs);
  Decryptor decExpected=Decryptor.getInstance(infoExpected);
  boolean passed=decExpected.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  InputStream is=decExpected.getDataStream(nfs);
  byte payloadExpected[]=IOUtils.toByteArray(is);
  is.close();
  long decPackLenExpected=decExpected.getLength();
  assertEquals(decPackLenExpected,payloadExpected.length);
  is=nfs.getRoot().createDocumentInputStream(Decryptor.DEFAULT_POIFS_ENTRY);
  is=new BoundedInputStream(is,is.available() - 16);
  byte encPackExpected[]=IOUtils.toByteArray(is);
  is.close();
  nfs.close();
  byte verifierSaltExpected[]=infoExpected.getVerifier().getSalt();
  byte verifierExpected[]=decExpected.getVerifier();
  byte keySalt[]=infoExpected.getHeader().getKeySalt();
  byte keySpec[]=decExpected.getSecretKey().getEncoded();
  byte integritySalt[]=decExpected.getIntegrityHmacKey();
  POIFSFileSystem fs=new POIFSFileSystem();
  EncryptionInfo infoActual=new EncryptionInfo(EncryptionMode.agile,infoExpected.getVerifier().getCipherAlgorithm(),infoExpected.getVerifier().getHashAlgorithm(),infoExpected.getHeader().getKeySize(),infoExpected.getHeader().getBlockSize(),infoExpected.getVerifier().getChainingMode());
  Encryptor e=Encryptor.getInstance(infoActual);
  e.confirmPassword(pass,keySpec,keySalt,verifierExpected,verifierSaltExpected,integritySalt);
  OutputStream os=e.getDataStream(fs);
  IOUtils.copy(new ByteArrayInputStream(payloadExpected),os);
  os.close();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  fs.writeFilesystem(bos);
  nfs=new NPOIFSFileSystem(new ByteArrayInputStream(bos.toByteArray()));
  infoActual=new EncryptionInfo(nfs.getRoot());
  Decryptor decActual=Decryptor.getInstance(infoActual);
  passed=decActual.verifyPassword(pass);
  assertTrue("Unable to process: document is encrypted",passed);
  is=decActual.getDataStream(nfs);
  byte payloadActual[]=IOUtils.toByteArray(is);
  is.close();
  long decPackLenActual=decActual.getLength();
  is=nfs.getRoot().createDocumentInputStream(Decryptor.DEFAULT_POIFS_ENTRY);
  is=new BoundedInputStream(is,is.available() - 16);
  byte encPackActual[]=IOUtils.toByteArray(is);
  is.close();
  nfs.close();
  AgileEncryptionHeader aehExpected=(AgileEncryptionHeader)infoExpected.getHeader();
  AgileEncryptionHeader aehActual=(AgileEncryptionHeader)infoActual.getHeader();
  assertArrayEquals(aehExpected.getEncryptedHmacKey(),aehActual.getEncryptedHmacKey());
  assertEquals(decPackLenExpected,decPackLenActual);
  assertArrayEquals(payloadExpected,payloadActual);
  assertArrayEquals(encPackExpected,encPackActual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestBugzillaIssues </h4><pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void bug50681_testAutoSize() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  BaseTestSheetAutosizeColumn.fixFonts(wb);
  Sheet sheet=wb.createSheet("Sheet1");
  trackColumnsForAutoSizingIfSXSSF(sheet);
  Row row=sheet.createRow(0);
  Cell cell0=row.createCell(0);
  String longValue="www.hostname.com, www.hostname.com, " + "www.hostname.com, www.hostname.com, www.hostname.com, " + "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, "+ "www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com";
  cell0.setCellValue(longValue);
  Font font=wb.getFontAt(cell0.getCellStyle().getFontIndex());
  Assume.assumeTrue("Cannot verify autoSizeColumn() because the necessary Fonts are not installed on this machine: " + font,SheetUtil.canComputeColumnWidth(font));
  assertEquals("Expecting no indentation in this test",0,cell0.getCellStyle().getIndention());
  assertEquals("Expecting no rotation in this test",0,cell0.getCellStyle().getRotation());
  double widthManual=computeCellWidthManually(cell0,font);
  double widthBeforeCell=SheetUtil.getCellWidth(cell0,8,null,false);
  double widthBeforeCol=SheetUtil.getColumnWidth(sheet,0,false);
  String info=widthManual + "/" + widthBeforeCell+ "/"+ widthBeforeCol+ "/"+ SheetUtil.canComputeColumnWidth(font)+ "/"+ computeCellWidthFixed(font,"1")+ "/"+ computeCellWidthFixed(font,"w")+ "/"+ computeCellWidthFixed(font,"1w")+ "/"+ computeCellWidthFixed(font,"0000")+ "/"+ computeCellWidthFixed(font,longValue);
  assertTrue("Expected to have cell width > 0 when computing manually, but had " + info,widthManual > 0);
  assertTrue("Expected to have cell width > 0 BEFORE auto-size, but had " + info,widthBeforeCell > 0);
  assertTrue("Expected to have column width > 0 BEFORE auto-size, but had " + info,widthBeforeCol > 0);
  sheet.autoSizeColumn(0);
  double width=SheetUtil.getColumnWidth(sheet,0,false);
  assertTrue("Expected to have column width > 0 AFTER auto-size, but had " + width,width > 0);
  width=SheetUtil.getCellWidth(cell0,8,null,false);
  assertTrue("Expected to have cell width > 0 AFTER auto-size, but had " + width,width > 0);
  assertEquals(255 * 256,sheet.getColumnWidth(0));
  sheet.setColumnWidth(0,sheet.getColumnWidth(0));
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetShiftRows </h4><pre class="type-1 type-17 type-6 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public final void shiftWithMergedRegions_bug56454() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  for (int i=0; i < 10; i++) {
    Row row=sheet.createRow(i);
    for (int j=0; j < 10; j++) {
      Cell cell=row.createCell(j,Cell.CELL_TYPE_STRING);
      cell.setCellValue(i + "x" + j);
    }
  }
  CellRangeAddress A4_B7=CellRangeAddress.valueOf("A4:B7");
  CellRangeAddress C4_D7=CellRangeAddress.valueOf("C4:D7");
  sheet.addMergedRegion(A4_B7);
  sheet.addMergedRegion(C4_D7);
  assumeTrue(sheet.getLastRowNum() > 8);
  sheet.shiftRows(4,sheet.getLastRowNum(),1);
  List<CellRangeAddress> expectedMergedRegions=new ArrayList<CellRangeAddress>();
  CellRangeAddress A4_B8=CellRangeAddress.valueOf("A4:B8");
  CellRangeAddress C4_D8=CellRangeAddress.valueOf("C4:D8");
  expectedMergedRegions.add(A4_B8);
  expectedMergedRegions.add(C4_D8);
  assertEquals(expectedMergedRegions,sheet.getMergedRegions());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.util.TestCellAddress </h4><pre class="type-1 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareTo(){
  final CellAddress A1=new CellAddress(0,0);
  final CellAddress A2=new CellAddress(1,0);
  final CellAddress B1=new CellAddress(0,1);
  final CellAddress B2=new CellAddress(1,1);
  assertEquals(0,A1.compareTo(A1));
  assertEquals(-1,A1.compareTo(B1));
  assertEquals(-1,A1.compareTo(A2));
  assertEquals(-1,A1.compareTo(B2));
  assertEquals(1,B1.compareTo(A1));
  assertEquals(0,B1.compareTo(B1));
  assertEquals(-1,B1.compareTo(A2));
  assertEquals(-1,B1.compareTo(B2));
  assertEquals(1,A2.compareTo(A1));
  assertEquals(1,A2.compareTo(B1));
  assertEquals(0,A2.compareTo(A2));
  assertEquals(-1,A2.compareTo(B2));
  assertEquals(1,B2.compareTo(A1));
  assertEquals(1,B2.compareTo(B1));
  assertEquals(1,B2.compareTo(A2));
  assertEquals(0,B2.compareTo(B2));
  CellAddress[] sorted={A1,B1,A2,B2};
  CellAddress[] unsorted={B1,B2,A1,A2};
  assumeTrue(!sorted.equals(unsorted));
  Arrays.sort(unsorted);
  assertArrayEquals(sorted,unsorted);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXSLFTextParagraph </h4><pre class="type-2 type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test breaking test into lines.
 * This test requires that the Arial font is available and will run only on windows
 */
@Test public void testBreakLines() throws IOException {
  String os=System.getProperty("os.name");
  Assume.assumeTrue("Skipping testBreakLines(), it is executed only on Windows machines",(os != null && os.contains("Windows")));
  XMLSlideShow ppt=new XMLSlideShow();
  XSLFSlide slide=ppt.createSlide();
  XSLFTextShape sh=slide.createAutoShape();
  XSLFTextParagraph p=sh.addNewTextParagraph();
  XSLFTextRun r=p.addNewTextRun();
  r.setFontFamily("Arial");
  r.setFontSize(12d);
  r.setText("Paragraph formatting allows for more granular control " + "of text within a shape. Properties here apply to all text " + "residing within the corresponding paragraph.");
  sh.setAnchor(new Rectangle2D.Double(50,50,300,200));
  DrawTextParagraphProxy dtp=new DrawTextParagraphProxy(p);
  BufferedImage img=new BufferedImage(1,1,BufferedImage.TYPE_INT_RGB);
  Graphics2D graphics=img.createGraphics();
  List<DrawTextFragment> lines;
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(4,lines.size());
  sh.setAnchor(new Rectangle2D.Double(50,50,100,200));
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(12,lines.size());
  sh.setAnchor(new Rectangle2D.Double(50,50,600,200));
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  sh.setLeftInset(200);
  sh.setRightInset(200);
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(5,lines.size());
  r.setText("Apache POI");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(1,lines.size());
  assertEquals("Apache POI",lines.get(0).getString());
  r.setText("Apache\nPOI");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  r.setText("Apache\nPOI\n");
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  XSLFAutoShape sh2=slide.createAutoShape();
  sh2.setAnchor(new Rectangle2D.Double(50,50,300,200));
  XSLFTextParagraph p2=sh2.addNewTextParagraph();
  XSLFTextRun r2=p2.addNewTextRun();
  r2.setFontFamily("serif");
  r2.setFontSize(30d);
  r2.setText("Apache\n");
  XSLFTextRun r3=p2.addNewTextRun();
  r3.setFontFamily("serif");
  r3.setFontSize(10d);
  r3.setText("POI");
  dtp=new DrawTextParagraphProxy(p2);
  dtp.breakText(graphics);
  lines=dtp.getLines();
  assertEquals(2,lines.size());
  assertEquals("Apache",lines.get(0).getString());
  assertEquals("POI",lines.get(1).getString());
  assertTrue(lines.get(0).getHeight() > lines.get(1).getHeight() * 2);
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestAutoSizeColumnTracker </h4><pre class="type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void trackAndUntrackAllColumns(){
  assumeTrue(tracker.getTrackedColumns().isEmpty());
  tracker.trackAllColumns();
  assertTrue(tracker.getTrackedColumns().isEmpty());
  Row row=sheet.createRow(0);
  for (  int column : columns) {
    row.createCell(column);
  }
  tracker.updateColumnWidths(row);
  assertEquals(columns,tracker.getTrackedColumns());
  tracker.untrackAllColumns();
  assertTrue(tracker.getTrackedColumns().isEmpty());
}

</code></pre>

<br>
<pre class="type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void trackAndUntrackColumn(){
  assumeTrue(tracker.getTrackedColumns().isEmpty());
  tracker.trackColumn(0);
  Set<Integer> expected=new HashSet<Integer>();
  expected.add(0);
  assertEquals(expected,tracker.getTrackedColumns());
  tracker.untrackColumn(0);
  assertTrue(tracker.getTrackedColumns().isEmpty());
}

</code></pre>

<br>
<pre class="type-1 type-3 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void trackAndUntrackColumns(){
  assumeTrue(tracker.getTrackedColumns().isEmpty());
  tracker.trackColumns(columns);
  assertEquals(columns,tracker.getTrackedColumns());
  tracker.untrackColumn(3);
  tracker.untrackColumn(0);
  tracker.untrackColumn(1);
  assertTrue(tracker.getTrackedColumns().isEmpty());
  tracker.trackColumn(0);
  tracker.trackColumns(columns);
  tracker.untrackColumn(4);
  assertEquals(columns,tracker.getTrackedColumns());
  tracker.untrackColumns(columns);
  assertTrue(tracker.getTrackedColumns().isEmpty());
}

</code></pre>

<br>
<pre class="type-1 type-17 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getTrackedColumns(){
  assumeTrue(tracker.getTrackedColumns().isEmpty());
  for (  int column : columns) {
    tracker.trackColumn(column);
  }
  assertEquals(3,tracker.getTrackedColumns().size());
  assertEquals(columns,tracker.getTrackedColumns());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFSheetAutoSizeColumn </h4><pre class="type-10 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_untrackColumnsForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnForAutoSizing(15);
  sheet.trackColumnsForAutoSizing(columns);
  sheet.untrackColumnsForAutoSizing(columns);
  assumeTrue(sheet.getTrackedColumnsForAutoSizing().contains(15));
  sheet.autoSizeColumn(15,useMergedCells);
  try {
    assumeFalse(sheet.getTrackedColumnsForAutoSizing().contains(columns.first()));
    sheet.autoSizeColumn(columns.first(),useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void autoSizeColumn_untrackColumnForAutoSizing(){
  workbook=new SXSSFWorkbook();
  sheet=workbook.createSheet();
  sheet.trackColumnsForAutoSizing(columns);
  sheet.untrackColumnForAutoSizing(columns.first());
  assumeTrue(sheet.getTrackedColumnsForAutoSizing().contains(columns.last()));
  sheet.autoSizeColumn(columns.last(),useMergedCells);
  try {
    assumeFalse(sheet.getTrackedColumnsForAutoSizing().contains(columns.first()));
    sheet.autoSizeColumn(columns.first(),useMergedCells);
    fail("Should not be able to auto-size an untracked column");
  }
 catch (  final IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.streaming.TestSXSSFWorkbook </h4><pre class="type-17 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Skip this test, as SXSSF doesn't update formulas on sheet name
 * changes.
 */
@Override @Test public void setSheetName(){
  Assume.assumeTrue("SXSSF doesn't update formulas on sheet name changes, as most cells probably aren't in memory at the time",false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (short colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    assumeNotNull(c);
    assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
    ignoredFormulaTestCase(c.getCellFormula());
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestMultiSheetFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @return a constant from the local Result class denoting whether there were any evaluation
 * cases, and whether they all succeeded.
 */
@Test public void processFunctionRow(){
  Row r=sheet.getRow(formulasRowIdx);
  Cell expValue=r.getCell(SS.COLUMN_INDEX_EXPECTED_VALUE);
  assertNotNull("Missing expected values cell for function '" + targetFunctionName + ", test"+ targetTestName+ " (row "+ formulasRowIdx+ 1+ ")",expValue);
  Cell c=r.getCell(SS.COLUMN_INDEX_ACTUAL_VALUE);
  assumeNotNull(c);
  assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
  CellValue actValue=evaluator.evaluate(c);
  String msg=String.format(Locale.ROOT,"Function '%s': Test: '%s': Formula: %s @ %d:%d",targetFunctionName,targetTestName,c.getCellFormula(),formulasRowIdx,SS.COLUMN_INDEX_ACTUAL_VALUE);
  assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
    assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
  break;
case Cell.CELL_TYPE_BOOLEAN:
assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFSheet </h4><pre class="type-10 type-1 type-3 type-17 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * bug 58885: checking for overlapping merged regions when
 * adding a merged region is safe, but runs in O(n).
 * the check for merged regions when adding a merged region
 * can be skipped (unsafe) and run in O(1).
 */
@Test public void addMergedRegionUnsafe() throws IOException {
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sh=wb.createSheet();
  CellRangeAddress region1=CellRangeAddress.valueOf("A1:B2");
  CellRangeAddress region2=CellRangeAddress.valueOf("B2:C3");
  CellRangeAddress region3=CellRangeAddress.valueOf("C3:D4");
  CellRangeAddress region4=CellRangeAddress.valueOf("J10:K11");
  assumeTrue(region1.intersects(region2));
  assumeTrue(region2.intersects(region3));
  sh.addMergedRegionUnsafe(region1);
  assertTrue(sh.getMergedRegions().contains(region1));
  sh.addMergedRegionUnsafe(region2);
  assertTrue(sh.getMergedRegions().contains(region2));
  try {
    sh.addMergedRegion(region3);
    fail("Expected IllegalStateException. region3 overlaps already added merged region2.");
  }
 catch (  final IllegalStateException e) {
    assertFalse(sh.getMergedRegions().contains(region3));
  }
  sh.addMergedRegion(region4);
  try {
    sh.validateMergedRegions();
    fail("Expected validation to fail. Sheet contains merged regions A1:B2 and B2:C3, which overlap at B2.");
  }
 catch (  final IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.TestXWPFBugs </h4><pre class="type-2 type-1 type-3 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word document with aes-256, i.e. aes is always 128 bit (= 128 bit block size),
 * but the key can be 128/192/256 bits
 */
@Test public void bug53475_aes256() throws Exception {
  int maxKeyLen=Cipher.getMaxAllowedKeyLength("AES");
  Assume.assumeTrue("Please install JCE Unlimited Strength Jurisdiction Policy files for AES 256",maxKeyLen == 2147483647);
  File file=POIDataSamples.getDocumentInstance().getFile("bug53475-password-is-pass.docx");
  NPOIFSFileSystem filesystem=new NPOIFSFileSystem(file,true);
  EncryptionInfo info=new EncryptionInfo(filesystem);
  assertEquals(16,info.getHeader().getBlockSize());
  assertEquals(256,info.getHeader().getKeySize());
  assertEquals(CipherAlgorithm.aes256,info.getHeader().getCipherAlgorithm());
  assertEquals(HashAlgorithm.sha1,info.getHeader().getHashAlgorithmEx());
  Decryptor d=Decryptor.getInstance(info);
  assertTrue("Unable to process: document is encrypted",d.verifyPassword("pass"));
  InputStream dataStream=d.getDataStream(filesystem);
  OPCPackage opc=OPCPackage.open(dataStream);
  XWPFDocument doc=new XWPFDocument(opc);
  XWPFWordExtractor ex=new XWPFWordExtractor(doc);
  String text=ex.getText();
  assertNotNull(text);
  assertEquals("The is a password protected document.",text.trim());
  ex.close();
  filesystem.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
