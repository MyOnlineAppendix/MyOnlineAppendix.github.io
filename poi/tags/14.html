<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.poi.hpsf.basic.TestWrite </h4><pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back various variant types and checks whether the
 * stuff that has been read back equals the stuff that was written.</p>
 */
@Test public void variantTypes(){
  Throwable t=null;
  final int codepage=CODEPAGE_DEFAULT;
  if (!hasProperDefaultCharset()) {
    System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped.");
    return;
  }
  try {
    check(Variant.VT_EMPTY,null,codepage);
    check(Variant.VT_BOOL,Boolean.TRUE,codepage);
    check(Variant.VT_BOOL,Boolean.FALSE,codepage);
    check(Variant.VT_CF,new byte[]{8,0,0,0,1,0,0,0,1,2,3,4},codepage);
    check(Variant.VT_I4,Integer.valueOf(27),codepage);
    check(Variant.VT_I8,Long.valueOf(28),codepage);
    check(Variant.VT_R8,new Double(29.0),codepage);
    check(Variant.VT_I4,Integer.valueOf(-27),codepage);
    check(Variant.VT_I8,Long.valueOf(-28),codepage);
    check(Variant.VT_R8,new Double(-29.0),codepage);
    check(Variant.VT_FILETIME,new Date(),codepage);
    check(Variant.VT_I4,new Integer(Integer.MAX_VALUE),codepage);
    check(Variant.VT_I4,new Integer(Integer.MIN_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MAX_VALUE),codepage);
    check(Variant.VT_I8,new Long(Long.MIN_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MAX_VALUE),codepage);
    check(Variant.VT_R8,new Double(Double.MIN_VALUE),codepage);
    check(Variant.VT_LPSTR,"",codepage);
    check(Variant.VT_LPSTR,"\u00e4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
    check(Variant.VT_LPWSTR,"",codepage);
    check(Variant.VT_LPWSTR,"\u00e4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6",codepage);
    check(Variant.VT_LPWSTR,"\u00e4\u00f6\u00fc\u00df\u00c4\u00d6\u00dc",codepage);
  }
 catch (  Exception ex) {
    t=ex;
  }
catch (  Error ex) {
    t=ex;
  }
  if (t != null)   fail(org.apache.poi.hpsf.Util.toString(t));
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * <p>Writes and reads back strings using several different codepages and
 * checks whether the stuff that has been read back equals the stuff that
 * was written.</p>
 */
@Test public void codepages(){
  Throwable thr=null;
  final int[] validCodepages=new int[]{CODEPAGE_DEFAULT,CODEPAGE_UTF8,CODEPAGE_UTF16,CODEPAGE_1252};
  for (int i=0; i < validCodepages.length; i++) {
    final int cp=validCodepages[i];
    if (cp == -1 && !hasProperDefaultCharset()) {
      System.err.println(IMPROPER_DEFAULT_CHARSET_MESSAGE + " This testcase is skipped for the default codepage.");
      continue;
    }
    final long t=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(t,"",cp);
      check(t,"\u00e4",cp);
      check(t,"\u00e4\u00f6",cp);
      check(t,"\u00e4\u00f6\u00fc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(t,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      if (cp == CodePageUtil.CP_UTF16 || cp == CodePageUtil.CP_UTF8)       check(t,"\u79D1\u5B78",cp);
    }
 catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr) + " with codepage " + cp);
  }
  final int[] invalidCodepages=new int[]{0,1,2,4711,815};
  for (int i=0; i < invalidCodepages.length; i++) {
    int cp=invalidCodepages[i];
    final long type=cp == CODEPAGE_UTF16 ? Variant.VT_LPWSTR : Variant.VT_LPSTR;
    try {
      check(type,"",cp);
      check(type,"\u00e4",cp);
      check(type,"\u00e4\u00f6",cp);
      check(type,"\u00e4\u00f6\u00fc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc",cp);
      check(type,"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u00df",cp);
      fail("UnsupportedEncodingException for codepage " + cp + " expected.");
    }
 catch (    UnsupportedEncodingException ex) {
    }
catch (    Exception ex) {
      thr=ex;
    }
catch (    Error ex) {
      thr=ex;
    }
    if (thr != null)     fail(org.apache.poi.hpsf.Util.toString(thr));
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>Tests whether writing 8-bit characters to a Unicode property
 * succeeds.</p>
 */
@Test public void unicodeWrite8Bit(){
  final String TITLE="This is a sample title";
  final MutablePropertySet mps=new MutablePropertySet();
  final MutableSection ms=(MutableSection)mps.getSections().get(0);
  ms.setFormatID(SectionIDMap.SUMMARY_INFORMATION_ID);
  final MutableProperty p=new MutableProperty();
  p.setID(PropertyIDMap.PID_TITLE);
  p.setType(Variant.VT_LPSTR);
  p.setValue(TITLE);
  ms.setProperty(p);
  Throwable t=null;
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    mps.write(out);
    out.close();
    byte[] bytes=out.toByteArray();
    PropertySet psr=new PropertySet(bytes);
    assertTrue(psr.isSummaryInformation());
    Section sr=psr.getSections().get(0);
    String title=(String)sr.getProperty(PropertyIDMap.PID_TITLE);
    assertEquals(TITLE,title);
  }
 catch (  WritingNotSupportedException e) {
    t=e;
  }
catch (  IOException e) {
    t=e;
  }
catch (  NoPropertySetStreamException e) {
    t=e;
  }
  if (t != null)   fail(t.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestOleEmbedding </h4><pre class="type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOLEShape() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("ole2-embedding-2003.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  int cnt=0;
  for (  HSLFShape sh : slide.getShapes()) {
    if (sh instanceof OLEShape) {
      cnt++;
      OLEShape ole=(OLEShape)sh;
      HSLFObjectData data=ole.getObjectData();
      if ("Worksheet".equals(ole.getInstanceName())) {
        HSSFWorkbook wb=new HSSFWorkbook(data.getData());
        HSSFSheet sheet=wb.getSheetAt(0);
        assertEquals(1,sheet.getRow(0).getCell(0).getNumericCellValue(),0);
        assertEquals(1,sheet.getRow(1).getCell(0).getNumericCellValue(),0);
        assertEquals(2,sheet.getRow(2).getCell(0).getNumericCellValue(),0);
        assertEquals(3,sheet.getRow(3).getCell(0).getNumericCellValue(),0);
        assertEquals(8,sheet.getRow(5).getCell(0).getNumericCellValue(),0);
        wb.close();
      }
 else       if ("Document".equals(ole.getInstanceName())) {
        HWPFDocument doc=new HWPFDocument(data.getData());
        String txt=doc.getRange().getParagraph(0).text();
        assertEquals("OLE embedding is thoroughly unremarkable.\r",txt);
      }
    }
  }
  assertEquals("Expected 2 OLE shapes",2,cnt);
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestShapes </h4><pre class="type-14 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that we can read TextBox shapes
 * @throws Exception
 */
@Test public void textBoxRead() throws IOException {
  ppt=new HSLFSlideShow(_slTests.openResourceAsStream("with_textbox.ppt"));
  HSLFSlide sl=ppt.getSlides().get(0);
  for (  HSLFShape sh : sl.getShapes()) {
    assertTrue(sh instanceof HSLFTextBox);
    HSLFTextBox txtbox=(HSLFTextBox)sh;
    String text=txtbox.getText();
    assertNotNull(text);
    assertEquals(txtbox.getTextParagraphs().get(0).getTextRuns().size(),1);
    HSLFTextRun rt=txtbox.getTextParagraphs().get(0).getTextRuns().get(0);
    if (text.equals("Hello, World!!!")) {
      assertEquals(32,rt.getFontSize(),0);
      assertTrue(rt.isBold());
      assertTrue(rt.isItalic());
    }
 else     if (text.equals("I am just a poor boy")) {
      assertEquals(44,rt.getFontSize(),0);
      assertTrue(rt.isBold());
    }
 else     if (text.equals("This is Times New Roman")) {
      assertEquals(16,rt.getFontSize(),0);
      assertTrue(rt.isBold());
      assertTrue(rt.isItalic());
      assertTrue(rt.isUnderlined());
    }
 else     if (text.equals("Plain Text")) {
      assertEquals(18,rt.getFontSize(),0);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.model.TestSlideMaster </h4><pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Slide 3 has title layout and follows the TitleMaster. Verify that.
 */
@Test public void testTitleMaster() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  HSLFSlide slide=ppt.getSlides().get(2);
  HSLFMasterSheet masterSheet=slide.getMasterSheet();
  assertTrue(masterSheet instanceof HSLFTitleMaster);
  for (  List<HSLFTextParagraph> txt : slide.getTextParagraphs()) {
    HSLFTextRun rt=txt.get(0).getTextRuns().get(0);
switch (txt.get(0).getRunType()) {
case TextHeaderAtom.CENTER_TITLE_TYPE:
      assertEquals("Arial",rt.getFontFamily());
    assertEquals(32,rt.getFontSize(),0);
  assertEquals(true,rt.isBold());
assertEquals(true,rt.isUnderlined());
break;
case TextHeaderAtom.CENTRE_BODY_TYPE:
assertEquals("Courier New",rt.getFontFamily());
assertEquals(20,rt.getFontSize(),0);
assertEquals(true,rt.isBold());
assertEquals(false,rt.isUnderlined());
break;
}
}
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * If a style attribute is not set ensure it is read from the master
 */
@Test public void testMasterAttributes() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  List<HSLFSlide> slide=ppt.getSlides();
  assertEquals(3,slide.size());
  for (  List<HSLFTextParagraph> tparas : slide.get(0).getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(40,rt.getFontSize(),0);
      assertEquals(true,rt.isUnderlined());
      assertEquals("Arial",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(0,tpara.getIndentLevel());
      assertEquals(32,rt.getFontSize(),0);
      assertEquals("Arial",rt.getFontFamily());
      tpara=tparas.get(1);
      rt=tpara.getTextRuns().get(0);
      assertEquals(1,tpara.getIndentLevel());
      assertEquals(28,rt.getFontSize(),0);
      assertEquals("Arial",rt.getFontFamily());
    }
  }
  ;
  for (  List<HSLFTextParagraph> tparas : slide.get(1).getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(48,rt.getFontSize(),0);
      assertEquals(true,rt.isItalic());
      assertEquals("Georgia",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      HSLFTextRun rt;
      rt=tpara.getTextRuns().get(0);
      assertEquals(0,tpara.getIndentLevel());
      assertEquals(32,rt.getFontSize(),0);
      assertEquals("Courier New",rt.getFontFamily());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Varify we can read attrubutes for different identtation levels.
 * (typical for the "bullted body" placeholder)
 */
@Test public void testIndentation() throws Exception {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("slide_master.ppt"));
  HSLFSlide slide=ppt.getSlides().get(0);
  for (  List<HSLFTextParagraph> tparas : slide.getTextParagraphs()) {
    HSLFTextParagraph tpara=tparas.get(0);
    if (tpara.getRunType() == TextHeaderAtom.TITLE_TYPE) {
      HSLFTextRun rt=tpara.getTextRuns().get(0);
      assertEquals(40,rt.getFontSize(),0);
      assertEquals(true,rt.isUnderlined());
      assertEquals("Arial",rt.getFontFamily());
    }
 else     if (tpara.getRunType() == TextHeaderAtom.BODY_TYPE) {
      int indents[]={32,28,24};
      for (      HSLFTextRun rt : tpara.getTextRuns()) {
        int indent=tpara.getIndentLevel();
        assertEquals(indents[indent],rt.getFontSize(),0);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestBugs </h4><pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug58159() throws IOException {
  HSLFSlideShow ppt=open("bug58159_headers-and-footers.ppt");
  HeadersFooters hf=ppt.getSlideHeadersFooters();
  assertNull(hf.getHeaderText());
  assertEquals("Slide footer",hf.getFooterText());
  hf=ppt.getNotesHeadersFooters();
  assertEquals("Notes header",hf.getHeaderText());
  assertEquals("Notes footer",hf.getFooterText());
  HSLFSlide sl=ppt.getSlides().get(0);
  hf=sl.getHeadersFooters();
  assertNull(hf.getHeaderText());
  assertEquals("Slide footer",hf.getFooterText());
  for (  HSLFShape shape : sl.getShapes()) {
    if (shape instanceof HSLFTextShape) {
      HSLFTextShape ts=(HSLFTextShape)shape;
      Placeholder ph=ts.getPlaceholder();
      if (Placeholder.FOOTER == ph) {
        assertEquals("Slide footer",ts.getText());
      }
    }
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-14 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
/** 
 * Bug 42484: NullPointerException from ShapeGroup.getAnchor()
 */
@Test public void bug42484() throws IOException {
  HSLFSlideShow ppt=open("42485.ppt");
  for (  HSLFShape shape : ppt.getSlides().get(0).getShapes()) {
    if (shape instanceof HSLFGroupShape) {
      HSLFGroupShape group=(HSLFGroupShape)shape;
      assertNotNull(group.getAnchor());
      for (      HSLFShape sh : group.getShapes()) {
        assertNotNull(sh.getAnchor());
      }
    }
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-14 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
/** 
 * Bug 42485: All TextBoxes inside ShapeGroups have null TextRuns
 */
@Test public void bug42485() throws IOException {
  HSLFSlideShow ppt=open("42485.ppt");
  for (  HSLFShape shape : ppt.getSlides().get(0).getShapes()) {
    if (shape instanceof HSLFGroupShape) {
      HSLFGroupShape group=(HSLFGroupShape)shape;
      for (      HSLFShape sh : group.getShapes()) {
        if (sh instanceof HSLFTextBox) {
          HSLFTextBox txt=(HSLFTextBox)sh;
          assertNotNull(txt.getTextParagraphs());
        }
      }
    }
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug57796() throws IOException {
  HSLFSlideShow ppt=open("WithLinks.ppt");
  HSLFSlide slide=ppt.getSlides().get(0);
  HSLFTextShape shape=(HSLFTextShape)slide.getShapes().get(1);
  List<HSLFHyperlink> hlList=HSLFHyperlink.find(shape);
  HSLFHyperlink hlShape=hlList.get(0);
  HSLFTextRun r=shape.getTextParagraphs().get(1).getTextRuns().get(0);
  HSLFHyperlink hlRun=r.getHyperlink();
  assertEquals(hlRun.getId(),hlShape.getId());
  assertEquals(hlRun.getAddress(),hlShape.getAddress());
  assertEquals(hlRun.getLabel(),hlShape.getLabel());
  assertEquals(hlRun.getType(),hlShape.getType());
  assertEquals(hlRun.getStartIndex(),hlShape.getStartIndex());
  assertEquals(hlRun.getEndIndex(),hlShape.getEndIndex());
  OutputStream nullOutput=new OutputStream(){
    public void write(    int b) throws IOException {
    }
  }
;
  final boolean found[]={false};
  DummyGraphics2d dgfx=new DummyGraphics2d(new PrintStream(nullOutput)){
    public void drawString(    AttributedCharacterIterator iterator,    float x,    float y){
      Map<Attribute,Object> attributes=null;
      StringBuffer sb=new StringBuffer();
      for (char c=iterator.first(); c != AttributedCharacterIterator.DONE; c=iterator.next()) {
        sb.append(c);
        attributes=iterator.getAttributes();
      }
      if ("Jakarta HSSF".equals(sb.toString())) {
        String href=(String)attributes.get(DrawTextParagraph.HYPERLINK_HREF);
        String label=(String)attributes.get(DrawTextParagraph.HYPERLINK_LABEL);
        assertEquals("http://jakarta.apache.org/poi/hssf/",href);
        assertEquals("Open Jakarta POI HSSF module test  ",label);
        found[0]=true;
      }
    }
  }
;
  ppt.getSlides().get(1).draw(dgfx);
  assertTrue(found[0]);
  ppt.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Second fix from Bug 42474: Incorrect matching of notes to slides
 */
@Test public void bug42474_2() throws IOException {
  HSLFSlideShow ppt=open("42474-2.ppt");
  Map<Integer,String> notesMap=new HashMap<Integer,String>();
  notesMap.put(Integer.valueOf(4),"For  decades before calculators");
  notesMap.put(Integer.valueOf(5),"Several commercial applications");
  notesMap.put(Integer.valueOf(6),"There are three variations of LNS that are discussed here");
  notesMap.put(Integer.valueOf(7),"Although multiply and square root are easier");
  notesMap.put(Integer.valueOf(8),"The bus Z is split into Z_H and Z_L");
  for (  HSLFSlide slide : ppt.getSlides()) {
    Integer slideNumber=Integer.valueOf(slide.getSlideNumber());
    HSLFNotes notes=slide.getNotes();
    if (notesMap.containsKey(slideNumber)) {
      assertNotNull(notes);
      String text=HSLFTextParagraph.getRawText(notes.getTextParagraphs().get(0));
      String startingPhrase=notesMap.get(slideNumber);
      assertTrue("Notes for slide " + slideNumber + " must start with "+ startingPhrase,text.startsWith(startingPhrase));
    }
  }
  ppt.close();
}

</code></pre>

<br>
<pre class="type-14 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
/** 
 * Bug 42524:  NPE in Shape.getShapeType()
 */
@Test public void bug42524() throws IOException {
  HSLFSlideShow ppt=open("42486.ppt");
  for (  HSLFSlide slide : ppt.getSlides()) {
    for (    HSLFShape shape : slide.getShapes()) {
      assertNotNull(shape.getShapeName());
      if (shape instanceof HSLFGroupShape) {
        HSLFGroupShape group=(HSLFGroupShape)shape;
        for (        HSLFShape comps : group.getShapes()) {
          assertNotNull(comps.getShapeName());
        }
      }
    }
  }
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestPicture </h4><pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void macImages() throws Exception {
  HSLFSlideShowImpl hss=new HSLFSlideShowImpl(_slTests.openResourceAsStream("53446.ppt"));
  List<HSLFPictureData> pictures=hss.getPictureData();
  assertEquals(15,pictures.size());
  int[][] expectedSizes={null,{427,428},{371,370},{288,183},{285,97},{288,168},null,null,{199,259},{432,244},{261,258},null,null,null,null};
  int i=0;
  for (  HSLFPictureData pd : pictures) {
    int[] dimensions=expectedSizes[i++];
    BufferedImage image=ImageIO.read(new ByteArrayInputStream(pd.getData()));
switch (pd.getType()) {
case WMF:
case EMF:
      break;
default :
    assertNotNull(image);
  assertEquals(dimensions[0],image.getWidth());
assertEquals(dimensions[1],image.getHeight());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextRun </h4><pre class="type-2 type-12 type-14 type-1 type-3 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test48916() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("SampleShow.ppt"));
  List<HSLFSlide> slides=ppt.getSlides();
  for (  HSLFSlide slide : slides) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (!(sh instanceof HSLFTextShape))       continue;
      HSLFTextShape tx=(HSLFTextShape)sh;
      List<HSLFTextParagraph> paras=tx.getTextParagraphs();
      Record[] runChildren=paras.get(0).getRecords();
      Record[] txboxChildren=tx.getEscherTextboxWrapper().getChildRecords();
      assertEquals(runChildren.length,txboxChildren.length);
      for (int i=0; i < txboxChildren.length; i++) {
        assertSame(txboxChildren[i],runChildren[i]);
      }
      for (      HSLFTextParagraph p : paras) {
        for (        HSLFTextRun rt : p.getTextRuns()) {
          rt.setBold(true);
          rt.setFontColor(Color.RED);
        }
      }
    }
  }
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ppt.write(out);
  ppt=new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
  for (  HSLFSlide slide : ppt.getSlides()) {
    for (    HSLFShape sh : slide.getShapes()) {
      if (sh instanceof HSLFTextShape) {
        HSLFTextShape tx=(HSLFTextShape)sh;
        List<HSLFTextParagraph> run=tx.getTextParagraphs();
        HSLFTextRun rt=run.get(0).getTextRuns().get(0);
        assertTrue(rt.isBold());
        assertTrue(sameColor(Color.RED,rt.getFontColor()));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hslf.usermodel.TestTextShape </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify we can get text from TextShape in the following cases:
 * - placeholders
 * - normal TextBox object
 * - text in auto-shapes
 */
@Test public void read() throws IOException {
  HSLFSlideShow ppt=new HSLFSlideShow(_slTests.openResourceAsStream("text_shapes.ppt"));
  List<String> lst1=new ArrayList<String>();
  HSLFSlide slide=ppt.getSlides().get(0);
  for (  HSLFShape shape : slide.getShapes()) {
    assertTrue("Expected TextShape but found " + shape.getClass().getName(),shape instanceof HSLFTextShape);
    HSLFTextShape tx=(HSLFTextShape)shape;
    List<HSLFTextParagraph> paras=tx.getTextParagraphs();
    assertNotNull(paras);
    int runType=paras.get(0).getRunType();
    ShapeType type=shape.getShapeType();
    String rawText=HSLFTextParagraph.getRawText(paras);
switch (type) {
case TEXT_BOX:
      assertEquals("Text in a TextBox",rawText);
    break;
case RECT:
  if (runType == TextHeaderAtom.OTHER_TYPE)   assertEquals("Rectangle",rawText);
 else   if (runType == TextHeaderAtom.TITLE_TYPE)   assertEquals("Title Placeholder",rawText);
break;
case OCTAGON:
assertEquals("Octagon",rawText);
break;
case ELLIPSE:
assertEquals("Ellipse",rawText);
break;
case ROUND_RECT:
assertEquals("RoundRectangle",rawText);
break;
default :
fail("Unexpected shape: " + shape.getShapeName());
}
lst1.add(rawText);
}
List<String> lst2=new ArrayList<String>();
for (List<HSLFTextParagraph> paras : slide.getTextParagraphs()) {
lst2.add(HSLFTextParagraph.getRawText(paras));
}
assertTrue(lst1.containsAll(lst2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.eventusermodel.TestFormatTrackingHSSFListener </h4><pre class="type-12 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that all number and formula records can be
 * turned into strings without problems.
 * For now, we're just looking to get text back, no
 * exceptions thrown, but in future we might also
 * want to check the exact strings!
 */
@Test public void testTurnToString() throws Exception {
  String[] files=new String[]{"45365.xls","45365-2.xls","MissingBits.xls"};
  for (int k=0; k < files.length; k++) {
    processFile(files[k]);
    assertTrue(listener.getNumberOfCustomFormats() > 5);
    assertTrue(listener.getNumberOfExtendedFormats() > 5);
    for (    Record r : mockListen._records) {
      CellValueRecordInterface cvr=null;
      if (r instanceof NumberRecord) {
        cvr=(CellValueRecordInterface)r;
      }
      if (r instanceof FormulaRecord) {
        cvr=(CellValueRecordInterface)r;
      }
      if (cvr != null) {
        String s=listener.formatNumberDateCell(cvr);
        assertNotNull(s);
        assertTrue(s.length() > 0);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRVA </h4><pre class="type-2 type-14 type-10 type-3 type-16 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void confirmCell(){
  Ptg[] excelPtgs=FormulaExtractor.getPtgs(formulaCell);
  Ptg[] poiPtgs=HSSFFormulaParser.parse(formula,workbook);
  int nExcelTokens=excelPtgs.length;
  int nPoiTokens=poiPtgs.length;
  if (nExcelTokens != nPoiTokens) {
    if (nExcelTokens == nPoiTokens + 1 && excelPtgs[0].getClass() == AttrPtg.class) {
      Ptg[] temp=new Ptg[nExcelTokens];
      temp[0]=excelPtgs[0];
      System.arraycopy(poiPtgs,0,temp,1,nPoiTokens);
      poiPtgs=temp;
    }
 else {
      fail("Expected " + nExcelTokens + " tokens but got "+ nPoiTokens);
    }
  }
  boolean hasMismatch=false;
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < nExcelTokens; i++) {
    Ptg poiPtg=poiPtgs[i];
    Ptg excelPtg=excelPtgs[i];
    if (excelPtg.getClass() != poiPtg.getClass()) {
      hasMismatch=true;
      sb.append("  mismatch token type[" + i + "] "+ getShortClassName(excelPtg)+ " "+ excelPtg.getRVAType()+ " - "+ getShortClassName(poiPtg)+ " "+ poiPtg.getRVAType());
      sb.append(NEW_LINE);
      continue;
    }
    if (poiPtg.isBaseToken()) {
      continue;
    }
    sb.append("  token[" + i + "] "+ excelPtg.toString()+ " "+ excelPtg.getRVAType());
    if (excelPtg.getPtgClass() != poiPtg.getPtgClass()) {
      hasMismatch=true;
      sb.append(" - was " + poiPtg.getRVAType());
    }
    sb.append(NEW_LINE);
  }
  assertFalse(hasMismatch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestRowBlocksReader </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbnormalPivotTableRecords_bug46280(){
  int SXVIEW_SID=ViewDefinitionRecord.sid;
  Record[] inRecs={new RowRecord(0),new NumberRecord(),new UnknownRecord(SXVIEW_SID,"dummydata (SXVIEW: View Definition)".getBytes(LocaleUtil.CHARSET_1252)),new WindowTwoRecord()};
  RecordStream rs=new RecordStream(Arrays.asList(inRecs),0);
  RowBlocksReader rbr=new RowBlocksReader(rs);
  if (rs.peekNextClass() == WindowTwoRecord.class) {
    fail("Identified bug 46280b");
  }
  RecordStream rbStream=rbr.getPlainRecordStream();
  assertEquals(inRecs[0],rbStream.getNext());
  assertEquals(inRecs[1],rbStream.getNext());
  assertFalse(rbStream.hasNext());
  assertTrue(rs.hasNext());
  assertEquals(inRecs[2],rs.getNext());
  assertEquals(inRecs[3],rs.getNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.model.TestSheet </h4><pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure page break functionality works (in memory)
 */
@Test public void testRowPageBreaks(){
  short colFrom=0;
  short colTo=255;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(0,colFrom,colTo);
  sheet.setRowBreak(0,colFrom,colTo);
  assertTrue("no row break at 0",sheet.isRowBroken(0));
  assertEquals("1 row break available",1,sheet.getNumRowBreaks());
  sheet.setRowBreak(10,colFrom,colTo);
  sheet.setRowBreak(11,colFrom,colTo);
  assertTrue("no row break at 10",sheet.isRowBroken(10));
  assertTrue("no row break at 11",sheet.isRowBroken(11));
  assertEquals("3 row break available",3,sheet.getNumRowBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is11=false;
  int[] rowBreaks=sheet.getRowBreaks();
  for (int i=0; i < rowBreaks.length; i++) {
    int main=rowBreaks[i];
    if (main != 0 && main != 10 && main != 11)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 10)     is10=true;
    if (main == 11)     is11=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is10 && is11);
  sheet.removeRowBreak(11);
  assertFalse("row should be removed",sheet.isRowBroken(11));
  sheet.removeRowBreak(0);
  assertFalse("row should be removed",sheet.isRowBroken(0));
  sheet.removeRowBreak(10);
  assertFalse("row should be removed",sheet.isRowBroken(10));
  assertEquals("no more breaks",0,sheet.getNumRowBreaks());
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure column pag breaks works properly (in-memory)
 */
@Test public void testColPageBreaks(){
  short rowFrom=0;
  short rowTo=(short)65535;
  InternalSheet worksheet=InternalSheet.createSheet();
  PageSettingsBlock sheet=worksheet.getPageSettings();
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)0,rowFrom,rowTo);
  assertTrue("no col break at 0",sheet.isColumnBroken(0));
  assertEquals("1 col break available",1,sheet.getNumColumnBreaks());
  sheet.setColumnBreak((short)1,rowFrom,rowTo);
  sheet.setColumnBreak((short)10,rowFrom,rowTo);
  sheet.setColumnBreak((short)15,rowFrom,rowTo);
  assertTrue("no col break at 1",sheet.isColumnBroken(1));
  assertTrue("no col break at 10",sheet.isColumnBroken(10));
  assertTrue("no col break at 15",sheet.isColumnBroken(15));
  assertEquals("4 col break available",4,sheet.getNumColumnBreaks());
  boolean is10=false;
  boolean is0=false;
  boolean is1=false;
  boolean is15=false;
  int[] colBreaks=sheet.getColumnBreaks();
  for (int i=0; i < colBreaks.length; i++) {
    int main=colBreaks[i];
    if (main != 0 && main != 1 && main != 10 && main != 15)     fail("Invalid page break");
    if (main == 0)     is0=true;
    if (main == 1)     is1=true;
    if (main == 10)     is10=true;
    if (main == 15)     is15=true;
  }
  assertTrue("one of the breaks didnt make it",is0 && is1 && is10&& is15);
  sheet.removeColumnBreak(15);
  assertFalse("column break should not be there",sheet.isColumnBroken(15));
  sheet.removeColumnBreak(0);
  assertFalse("column break should not be there",sheet.isColumnBroken(0));
  sheet.removeColumnBreak(1);
  assertFalse("column break should not be there",sheet.isColumnBroken(1));
  sheet.removeColumnBreak(10);
  assertFalse("column break should not be there",sheet.isColumnBroken(10));
  assertEquals("no more breaks",0,sheet.getNumColumnBreaks());
}

</code></pre>

<br>
<pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * In 3.1, setting margins between creating first row and first cell caused an exception.
 */
@Test public void testSetMargins_bug45717() throws Exception {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Vorschauliste");
  HSSFRow row=sheet.createRow(0);
  sheet.setMargin(HSSFSheet.LeftMargin,0.3);
  try {
    row.createCell(0);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot create value records before row records exist")) {
      fail("Identified bug 45717");
    }
    throw e;
  }
 finally {
    workbook.close();
  }
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMisplacedMergedCellsRecords_bug45699() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("ex45698-22488.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  HSSFRow row=sheet.getRow(3);
  HSSFCell cell=row.getCell(4);
  if (cell == null) {
    fail("Identified bug 45699");
  }
  assertEquals("Informations",cell.getRichStringCellValue().getString());
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.TestSSTRecord </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test simple addString
 */
@Test public void testSimpleAddString(){
  SSTRecord record=new SSTRecord();
  UnicodeString s1=new UnicodeString("Hello world");
  UnicodeString s2=new UnicodeString("Hello world\u2122");
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(1,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(0,record.addString(s1));
  assertEquals(s1,record.getString(0));
  assertEquals(1,record.countStrings());
  assertEquals(2,record.getNumStrings());
  assertEquals(1,record.getNumUniqueStrings());
  assertEquals(1,record.addString(s2));
  assertEquals(s2,record.getString(1));
  assertEquals(2,record.countStrings());
  assertEquals(3,record.getNumStrings());
  assertEquals(2,record.getNumUniqueStrings());
  Iterator<UnicodeString> iter=record.getStrings();
  while (iter.hasNext()) {
    UnicodeString ucs=iter.next();
    if (ucs.equals(s1)) {
      assertEquals((byte)0,ucs.getOptionFlags());
    }
 else     if (ucs.equals(s2)) {
      assertEquals((byte)1,ucs.getOptionFlags());
    }
 else {
      fail("cannot match string: " + ucs.getString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.record.aggregates.TestRowRecordsAggregate </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This problem was noted as the overt symptom of bug 46280.  The logic for skipping {@link UnknownRecord}s in the constructor {@link RowRecordsAggregate} did not allow for the
 * possibility of tailing {@link ContinueRecord}s.<br/>
 * The functionality change being tested here is actually not critical to the overall fix
 * for bug 46280, since the fix involved making sure the that offending <i>PivotTable</i>
 * records do not get into {@link RowRecordsAggregate}.<br/>
 * This fix in {@link RowRecordsAggregate} was implemented anyway since any {@link UnknownRecord} has the potential of being 'continued'.
 */
@Test public void testUnknownContinue_bug46280(){
  Record[] inRecs={new RowRecord(0),new NumberRecord(),new UnknownRecord(0x5555,"dummydata".getBytes(LocaleUtil.CHARSET_1252)),new ContinueRecord("moredummydata".getBytes(LocaleUtil.CHARSET_1252))};
  RecordStream rs=new RecordStream(Arrays.asList(inRecs),0);
  RowRecordsAggregate rra;
  try {
    rra=new RowRecordsAggregate(rs,SharedValueManager.createEmpty());
  }
 catch (  RuntimeException e) {
    if (e.getMessage().startsWith("Unexpected record type")) {
      fail("Identified bug 46280a");
    }
    throw e;
  }
  RecordCollector rv=new RecordCollector();
  rra.visitContainedRecords(rv);
  Record[] outRecs=rv.getRecords();
  assertEquals(5,outRecs.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestBugs </h4><pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 42618: RecordFormatException reading a file containing
 * =CHOOSE(2,A2,A3,A4)
 */
@Test public void bug42618() throws Exception {
  HSSFWorkbook wb1=openSample("SimpleWithChoose.xls");
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet s=wb2.getSheetAt(0);
  HSSFRow r1=s.getRow(0);
  HSSFCell c1=r1.getCell(1);
  assertEquals("=CHOOSE(2,A2,A3,A4)",c1.getRichStringCellValue().toString());
  HSSFRow r2=s.getRow(1);
  HSSFCell c2=r2.getCell(1);
  assertEquals(25,(int)c2.getNumericCellValue());
  try {
    assertEquals("CHOOSE(2,A2,A3,A4)",c2.getCellFormula());
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("Too few arguments") && e.getMessage().indexOf("ConcatPtg") > 0) {
      fail("identified bug 44306");
    }
  }
  wb2.close();
}

</code></pre>

<br>
<pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug56450() throws Exception {
  HSSFWorkbook wb=openSample("56450.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  int comments=0;
  for (  Row r : sheet) {
    for (    Cell c : r) {
      if (c.getCellComment() != null) {
        assertNotNull(c.getCellComment().getString().getString());
        comments++;
      }
    }
  }
  assertEquals(0,comments);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * From the mailing list - ensure we can handle a formula
 * containing a zip code, eg ="70164"
 */
@Test public void bugZipCodeFormulas() throws Exception {
  HSSFWorkbook wb1=new HSSFWorkbook();
  HSSFSheet s=wb1.createSheet();
  s.createRow(0);
  HSSFCell c1=s.getRow(0).createCell(0);
  HSSFCell c2=s.getRow(0).createCell(1);
  HSSFCell c3=s.getRow(0).createCell(2);
  c1.setCellFormula("70164");
  c2.setCellFormula("\"70164\"");
  c3.setCellFormula("\"90210\"");
  assertEquals("70164",c1.getCellFormula());
  assertEquals("\"70164\"",c2.getCellFormula());
  confirmCachedValue(0.0,c1);
  confirmCachedValue(0.0,c2);
  confirmCachedValue(0.0,c3);
  c3.setCellValue(new HSSFRichTextString("test"));
  confirmCachedValue("test",c3);
  try {
    c3.getNumericCellValue();
    fail("exception should have been thrown");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cannot get a numeric value from a text formula cell",e.getMessage());
  }
  HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator(wb1);
  eval.evaluateFormulaCell(c1);
  eval.evaluateFormulaCell(c2);
  eval.evaluateFormulaCell(c3);
  confirmCachedValue(70164.0,c1);
  confirmCachedValue("70164",c2);
  confirmCachedValue("90210",c3);
  HSSFWorkbook wb2=writeOutAndReadBack(wb1);
  wb1.close();
  HSSFSheet ns=wb2.getSheetAt(0);
  HSSFCell nc1=ns.getRow(0).getCell(0);
  HSSFCell nc2=ns.getRow(0).getCell(1);
  HSSFCell nc3=ns.getRow(0).getCell(2);
  confirmCachedValue(70164.0,nc1);
  confirmCachedValue("70164",nc2);
  confirmCachedValue("90210",nc3);
  @SuppressWarnings("deprecation") CellValueRecordInterface[] cvrs=ns.getSheet().getValueRecords();
  for (int i=0; i < cvrs.length; i++) {
    CellValueRecordInterface cvr=cvrs[i];
    if (cvr instanceof FormulaRecordAggregate) {
      FormulaRecordAggregate fr=(FormulaRecordAggregate)cvr;
      if (i == 0) {
        assertEquals(70164.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNull(fr.getStringRecord());
      }
 else       if (i == 1) {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("70164",fr.getStringRecord().getString());
      }
 else {
        assertEquals(0.0,fr.getFormulaRecord().getValue(),0.0001);
        assertNotNull(fr.getStringRecord());
        assertEquals("90210",fr.getStringRecord().getString());
      }
    }
  }
  assertEquals(3,cvrs.length);
  wb2.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Bug 29942: Importing Excel files that have been created by Open Office on Linux
 */
@Test public void bug29942() throws Exception {
  HSSFWorkbook wb=openSample("29942.xls");
  HSSFSheet sheet=wb.getSheetAt(0);
  int count=0;
  for (int i=sheet.getFirstRowNum(); i <= sheet.getLastRowNum(); i++) {
    HSSFRow row=sheet.getRow(i);
    if (row != null) {
      HSSFCell cell=row.getCell(0);
      assertEquals(Cell.CELL_TYPE_STRING,cell.getCellType());
      count++;
    }
  }
  assertEquals(85,count);
  writeOutAndReadBack(wb).close();
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestDataValidation </h4><pre class="type-2 type-14 type-10 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddToExistingSheet() throws Exception {
  HSSFWorkbook wb=HSSFTestDataSamples.openSampleWorkbook("dvEmpty.xls");
  int dvRow=0;
  Sheet sheet=wb.getSheetAt(0);
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint dc=dataValidationHelper.createIntegerConstraint(OperatorType.EQUAL,"42",null);
  DataValidation dv=dataValidationHelper.createValidation(dc,new CellRangeAddressList(dvRow,dvRow,0,0));
  dv.setEmptyCellAllowed(false);
  dv.setErrorStyle(ErrorStyle.STOP);
  dv.setShowPromptBox(true);
  dv.createErrorBox("Xxx","Yyy");
  dv.setSuppressDropDownArrow(true);
  sheet.addValidationData(dv);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  wb.write(baos);
  byte[] wbData=baos.toByteArray();
  byte[] dvHeaderRecStart={(byte)0xB2,0x01,0x12,0x00};
  int dvHeaderOffset=findIndex(wbData,dvHeaderRecStart);
  assertTrue(dvHeaderOffset > 0);
  int nextRecIndex=dvHeaderOffset + 22;
  int nextSid=((wbData[nextRecIndex + 0] << 0) & 0x00FF) + ((wbData[nextRecIndex + 1] << 8) & 0xFF00);
  if (nextSid == 0x0867) {
    fail("Identified bug 45519");
  }
  assertEquals(DVRecord.sid,nextSid);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestEscherGraphics </h4><pre class="type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetFont(){
  Font f=graphics.getFont();
  if (f.toString().indexOf("dialog") == -1 && f.toString().indexOf("Dialog") == -1) {
    assertEquals("java.awt.Font[family=Arial,name=Arial,style=plain,size=10]",f.toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestFormulaEvaluatorBugs </h4><pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEvaluateInCellWithErrorCode_bug44950() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(1);
  HSSFCell cell=row.createCell(0);
  cell.setCellFormula("na()");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  try {
    fe.evaluateInCell(cell);
  }
 catch (  NumberFormatException e) {
    if (e.getMessage().equals("You cannot get an error value from a non-error cell")) {
      fail("Identified bug 44950 b");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testSlowEvaluate45376() throws Exception {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  for (int i=1; i < 10; i++) {
    HSSFCell cell=row.createCell(i);
    char prevCol=(char)('A' + i - 1);
    String prevCell=prevCol + "1";
    String formula="IF(DATE(YEAR(" + prevCell + "),MONTH("+ prevCell+ ")+1,1)<=$D$3,"+ "DATE(YEAR("+ prevCell+ "),MONTH("+ prevCell+ ")+1,1),NA())";
    cell.setCellFormula(formula);
  }
  Calendar cal=LocaleUtil.getLocaleCalendar(2000,0,1,0,0,0);
  row.createCell(0).setCellValue(cal);
  HSSFCell cell=row.getCell(8);
  EvalListener evalListener=new EvalListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cell));
  int evalCount=evalListener.getCountCacheMisses();
  if (evalCount > 10) {
    fail("Identifed bug 45376 - Formula evaluator should cache values");
  }
  assertEquals(8,evalCount);
  assertEquals(8,evalListener.getCountCacheHits());
  assertEquals(ErrorEval.NA,ve);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFFormulaEvaluator </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for bug due to attempt to convert a cached formula error result to a boolean
 */
@Test @Override public void testUpdateCachedFormulaResultFromErrorToNumber_bug46479() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  HSSFCell cellB1=row.createCell(1);
  cellB1.setCellFormula("A1+1");
  HSSFFormulaEvaluator fe=new HSSFFormulaEvaluator(wb);
  cellA1.setCellErrorValue((byte)HSSFErrorConstants.ERROR_NAME);
  fe.evaluateFormulaCell(cellB1);
  cellA1.setCellValue(2.5);
  fe.notifyUpdateCell(cellA1);
  try {
    fe.evaluateInCell(cellB1);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot get a numeric value from a error formula cell")) {
      fail("Identified bug 46479a");
    }
  }
  assertEquals(3.5,cellB1.getNumericCellValue(),0.0);
  wb.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The HSSFFormula evaluator performance benefits greatly from caching of intermediate cell values
 */
@Test public void testShortCircuitIfEvaluation() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Sheet1");
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  cellA1.setCellFormula("if(B1,C1,D1+E1+F1)");
  for (int i=1; i < 6; i++) {
    row.createCell(i).setCellFormula(String.valueOf(i));
  }
  EvalCountListener evalListener=new EvalCountListener();
  WorkbookEvaluator evaluator=WorkbookEvaluatorTestHelper.createEvaluator(wb,evalListener);
  ValueEval ve=evaluator.evaluate(HSSFEvaluationTestHelper.wrapCell(cellA1));
  int evalCount=evalListener.getEvalCount();
  if (evalCount == 6) {
    fail("Identifed bug 48195 - Formula evaluator should short-circuit IF() calculations.");
  }
  assertEquals(3,evalCount);
  assertEquals(2.0,((NumberEval)ve).getNumberValue(),0D);
  wb.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When evaluating defined names, POI has to decide whether it is capable.  Currently
 * (May2009) POI only supports simple cell and area refs.<br/>
 * The sample spreadsheet (bugzilla attachment 23508) had a name flagged as 'complex'
 * which contained a simple area ref.  It is not clear what the 'complex' flag is used
 * for but POI should look elsewhere to decide whether it can evaluate the name.
 */
@Test public void testDefinedNameWithComplexFlag_bug47048() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet sheet=wb.createSheet("Input");
  HSSFName definedName=wb.createName();
  definedName.setNameName("Is_Multicar_Vehicle");
  definedName.setRefersToFormula("Input!$B$17:$G$17");
  HSSFRow row17=sheet.createRow(16);
  row17.createCell(0).setCellValue(25.0);
  row17.createCell(1).setCellValue(1.33);
  row17.createCell(2).setCellValue(4.0);
  HSSFRow row=sheet.createRow(0);
  HSSFCell cellA1=row.createCell(0);
  cellA1.setCellFormula("SUM(Is_Multicar_Vehicle)");
  NameRecord nameRec=TestHSSFName.getNameRecord(definedName);
  nameRec.setOptionFlag((short)0x10);
  HSSFFormulaEvaluator hsf=new HSSFFormulaEvaluator(wb);
  CellValue value;
  try {
    value=hsf.evaluate(cellA1);
    assertEquals(Cell.CELL_TYPE_NUMERIC,value.getCellType());
    assertEquals(5.33,value.getNumberValue(),0.0);
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Don't now how to evalate name 'Is_Multicar_Vehicle'")) {
      fail("Identified bug 47048a");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFRow </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastAndFirstColumns_bug46654() throws IOException {
  int ROW_IX=10;
  int COL_IX=3;
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Sheet1");
  RowRecord rowRec=new RowRecord(ROW_IX);
  rowRec.setFirstCol((short)2);
  rowRec.setLastCol((short)5);
  BlankRecord br=new BlankRecord();
  br.setRow(ROW_IX);
  br.setColumn((short)COL_IX);
  sheet.getSheet().addValueRecord(ROW_IX,br);
  HSSFRow row=new HSSFRow(workbook,sheet,rowRec);
  HSSFCell cell=row.createCellFromRecord(br);
  if (row.getFirstCellNum() == 2 && row.getLastCellNum() == 5) {
    fail("Identified bug 46654a");
  }
  assertEquals(COL_IX,row.getFirstCellNum());
  assertEquals(COL_IX + 1,row.getLastCellNum());
  row.removeCell(cell);
  assertEquals(-1,row.getFirstCellNum());
  assertEquals(-1,row.getLastCellNum());
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheet </h4><pre class="type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * {@link PasswordRecord} belongs with the rest of the Worksheet Protection Block
 * (which should be before {@link DimensionsRecord}).
 */
@Test public void protectSheetRecordOrder_bug47363a() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet();
  s.protectSheet("secret");
  RecordCollector rc=new RecordCollector();
  s.getSheet().visitContainedRecords(rc,0);
  Record[] recs=rc.getRecords();
  int nRecs=recs.length;
  if (recs[nRecs - 2] instanceof PasswordRecord && recs[nRecs - 5] instanceof DimensionsRecord) {
    fail("Identified bug 47363a - PASSWORD after DIMENSION");
  }
  confirmRecordClass(recs,nRecs - 4,DimensionsRecord.class);
  confirmRecordClass(recs,nRecs - 9,ProtectRecord.class);
  confirmRecordClass(recs,nRecs - 8,ObjectProtectRecord.class);
  confirmRecordClass(recs,nRecs - 7,ScenarioProtectRecord.class);
  confirmRecordClass(recs,nRecs - 6,PasswordRecord.class);
  wb.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * There should be no problem with adding data validations after sheet protection
 */
@Test public void dvProtectionOrder_bug47363b() throws IOException {
  HSSFWorkbook workbook=new HSSFWorkbook();
  HSSFSheet sheet=workbook.createSheet("Sheet1");
  sheet.protectSheet("secret");
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  DataValidationConstraint dvc=dataValidationHelper.createIntegerConstraint(DataValidationConstraint.OperatorType.BETWEEN,"10","100");
  CellRangeAddressList numericCellAddressList=new CellRangeAddressList(0,0,1,1);
  DataValidation dv=dataValidationHelper.createValidation(dvc,numericCellAddressList);
  try {
    sheet.addValidationData(dv);
  }
 catch (  IllegalStateException e) {
    String expMsg="Unexpected (org.apache.poi.hssf.record.PasswordRecord) while looking for DV Table insert pos";
    if (expMsg.equals(e.getMessage())) {
      fail("Identified bug 47363b");
    }
    workbook.close();
    throw e;
  }
  RecordCollector rc;
  rc=new RecordCollector();
  sheet.getSheet().visitContainedRecords(rc,0);
  int nRecsWithProtection=rc.getRecords().length;
  sheet.protectSheet(null);
  rc=new RecordCollector();
  sheet.getSheet().visitContainedRecords(rc,0);
  int nRecsWithoutProtection=rc.getRecords().length;
  assertEquals(4,nRecsWithProtection - nRecsWithoutProtection);
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFSheetUpdateArrayFormulas </h4><pre class="type-2 type-14 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Makes sure the internal state of HSSFSheet is consistent after removing array formulas
 */
@Test public void testAddRemoveArrayFormulas_recordUpdates() throws IOException {
  HSSFWorkbook wb=new HSSFWorkbook();
  HSSFSheet s=wb.createSheet("Sheet1");
  CellRange<HSSFCell> cr=s.setArrayFormula("123",CellRangeAddress.valueOf("B5:C6"));
  Record[] recs;
  int ix;
  recs=RecordInspector.getRecords(s,0);
  ix=findRecordOfType(recs,ArrayRecord.class,0);
  confirmRecordClass(recs,ix - 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 1,FormulaRecord.class);
  confirmRecordClass(recs,ix + 2,FormulaRecord.class);
  confirmRecordClass(recs,ix + 3,FormulaRecord.class);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,ix + 1) < 0);
  s.removeArrayFormula(cr.getTopLeftCell());
  recs=RecordInspector.getRecords(s,0);
  assertTrue(findRecordOfType(recs,ArrayRecord.class,0) < 0);
  assertTrue(findRecordOfType(recs,FormulaRecord.class,0) < 0);
  RowRecordsAggregate rra=s.getSheet().getRowsAggregate();
  SharedValueManager svm=TestSharedValueManager.extractFromRRA(rra);
  if (svm.getArrayRecord(4,1) != null) {
    fail("Array record was not cleaned up properly.");
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.hssf.usermodel.TestHSSFWorkbook </h4><pre class="type-12 type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test49423() throws Exception {
  HSSFWorkbook workbook=HSSFTestDataSamples.openSampleWorkbook("49423.xls");
  boolean found=false;
  int numSheets=workbook.getNumberOfSheets();
  for (int i=0; i < numSheets; i++) {
    HSSFSheet sheet=workbook.getSheetAt(i);
    List<HSSFShape> shapes=sheet.getDrawingPatriarch().getChildren();
    for (    HSSFShape shape : shapes) {
      HSSFAnchor anchor=shape.getAnchor();
      if (anchor instanceof HSSFClientAnchor) {
        HSSFClientAnchor clientAnchor=(HSSFClientAnchor)anchor;
        assertNotNull(clientAnchor);
        found=true;
      }
 else       if (anchor instanceof HSSFChildAnchor) {
        HSSFChildAnchor childAnchor=(HSSFChildAnchor)anchor;
        assertNotNull(childAnchor);
        found=true;
      }
    }
  }
  assertTrue("Should find some images via Client or Child anchors, but did not find any at all",found);
  workbook.close();
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to make sure that NameRecord.getSheetNumber() is interpreted as a
 * 1-based sheet tab index (not a 1-based extern sheet index)
 */
@Test public void findBuiltInNameRecord() throws IOException {
  HSSFWorkbook wb1=HSSFTestDataSamples.openSampleWorkbook("testRRaC.xls");
  NameRecord nr;
  assertEquals(3,wb1.getWorkbook().getNumNames());
  nr=wb1.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!$A$1:$IV$1",HSSFFormulaParser.toFormulaString(wb1,nr.getNameDefinition()));
  try {
    wb1.getSheetAt(3).setRepeatingRows(CellRangeAddress.valueOf("9:12"));
    wb1.getSheetAt(3).setRepeatingColumns(CellRangeAddress.valueOf("E:F"));
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Builtin (7) already exists for sheet (4)")) {
      fail("Identified bug 45720b");
    }
    wb1.close();
    throw e;
  }
  HSSFWorkbook wb2=HSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(3,wb2.getWorkbook().getNumNames());
  nr=wb2.getWorkbook().getNameRecord(2);
  assertEquals("Sheet2!E:F,Sheet2!$A$9:$IV$12",HSSFFormulaParser.toFormulaString(wb2,nr.getNameDefinition()));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestPackage </h4><pre class="type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getPartSize() throws IOException, InvalidFormatException {
  String filepath=OpenXML4JTestDataSamples.getSampleFileName("sample.docx");
  OPCPackage pkg=OPCPackage.open(filepath,PackageAccess.READ);
  try {
    int checked=0;
    for (    PackagePart part : pkg.getParts()) {
      if (part.getPartName().getName().equals("/word/document.xml")) {
        checked++;
        assertEquals(ZipPackagePart.class,part.getClass());
        assertEquals(6031l,part.getSize());
      }
      if (part.getPartName().getName().equals("/word/fontTable.xml")) {
        checked++;
        assertEquals(ZipPackagePart.class,part.getClass());
        assertEquals(1312l,part.getSize());
      }
      if (part.getPartName().getName().equals("/docProps/core.xml")) {
        checked++;
        assertEquals(PackagePropertiesPart.class,part.getClass());
        assertEquals(-1,part.getSize());
      }
    }
    assertEquals(3,checked);
  }
  finally {
    pkg.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.openxml4j.opc.TestZipPackage </h4><pre class="type-2 type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56479() throws Exception {
  InputStream is=OpenXML4JTestDataSamples.openSampleStream("dcterms_bug_56479.zip");
  OPCPackage p=OPCPackage.open(is);
  boolean foundCoreProps=false, foundDocument=false, foundTheme1=false;
  for (  PackagePart part : p.getParts()) {
    if (part.getPartName().toString().equals("/docProps/core.xml")) {
      assertEquals(ContentTypes.CORE_PROPERTIES_PART,part.getContentType());
      foundCoreProps=true;
    }
    if (part.getPartName().toString().equals("/word/document.xml")) {
      assertEquals(XWPFRelation.DOCUMENT.getContentType(),part.getContentType());
      foundDocument=true;
    }
    if (part.getPartName().toString().equals("/word/theme/theme1.xml")) {
      assertEquals(XWPFRelation.THEME.getContentType(),part.getContentType());
      foundTheme1=true;
    }
  }
  assertTrue("Core not found in " + p.getParts(),foundCoreProps);
  assertFalse("Document should not be found in " + p.getParts(),foundDocument);
  assertFalse("Theme1 should not found in " + p.getParts(),foundTheme1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.poifs.storage.TestBlockListImpl </h4><pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove() throws IOException {
  BlockListImpl list=create();
  RawDataBlock[] blocks=new RawDataBlock[5];
  byte[] data=new byte[512 * 5];
  for (int j=0; j < 5; j++) {
    Arrays.fill(data,j * 512,(j * 512) + 512,(byte)j);
  }
  ByteArrayInputStream stream=new ByteArrayInputStream(data);
  for (int j=0; j < 5; j++) {
    blocks[j]=new RawDataBlock(stream);
  }
  list.setBlocks(blocks);
  for (int j=-2; j < 10; j++) {
    if ((j < 0) || (j >= 5)) {
      try {
        list.remove(j);
        fail("removing item " + j + " should have failed");
      }
 catch (      IOException ignored) {
      }
    }
  }
  for (int j=0; j < 5; j++) {
    byte[] output=list.remove(j).getData();
    for (int k=0; k < 512; k++) {
      assertEquals("testing block " + j + ", index "+ k,data[(j * 512) + k],output[k]);
    }
  }
  for (int j=0; j < 5; j++) {
    try {
      list.remove(j);
      fail("removing item " + j + " should not have succeeded");
    }
 catch (    IOException ignored) {
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchBlocks() throws IOException {
  BlockListImpl list=create();
  List<RawDataBlock> raw_blocks=new ArrayList<RawDataBlock>();
  byte[] data=new byte[512];
  int offset=0;
  LittleEndian.putInt(data,offset,-3);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,2);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,6);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-1);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,8);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,0);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,10);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,-4);
  offset+=LittleEndianConsts.INT_SIZE;
  LittleEndian.putInt(data,offset,1000);
  offset+=LittleEndianConsts.INT_SIZE;
  int index=13;
  for (; offset < 508; offset+=LittleEndianConsts.INT_SIZE) {
    LittleEndian.putInt(data,offset,index++);
  }
  LittleEndian.putInt(data,offset,-2);
  raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(data)));
  for (int j=raw_blocks.size(); j < 128; j++) {
    raw_blocks.add(new RawDataBlock(new ByteArrayInputStream(new byte[0])));
  }
  list.setBlocks(raw_blocks.toArray(new RawDataBlock[raw_blocks.size()]));
  int[] blocks={0};
  BlockAllocationTableReader table=new BlockAllocationTableReader(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS,1,blocks,0,-2,list);
  int[] start_blocks={-2,1,2,3,5,7,9,11,12};
  int[] expected_length={0,1,-1,-1,-1,-1,-1,-1,116};
  for (int j=0; j < start_blocks.length; j++) {
    try {
      ListManagedBlock[] dataBlocks=list.fetchBlocks(start_blocks[j],-1);
      if (expected_length[j] == -1) {
        fail("document " + j + " should have failed");
      }
 else {
        assertEquals(expected_length[j],dataBlocks.length);
      }
    }
 catch (    IOException e) {
      if (expected_length[j] == -1) {
      }
 else {
        throw e;
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.TestWorkbookEvaluator </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Functions like IF, INDIRECT, INDEX, OFFSET etc can return AreaEvals which
 * should be dereferenced by the evaluator
 * @throws IOException 
 */
@Test public void testResultOutsideRange() throws IOException {
  Workbook wb=new HSSFWorkbook();
  try {
    Cell cell=wb.createSheet("Sheet1").createRow(0).createCell(0);
    cell.setCellFormula("D2:D5");
    FormulaEvaluator fe=wb.getCreationHelper().createFormulaEvaluator();
    CellValue cv;
    try {
      cv=fe.evaluate(cell);
    }
 catch (    IllegalArgumentException e) {
      if ("Specified row index (0) is outside the allowed range (1..4)".equals(e.getMessage())) {
        fail("Identified bug in result dereferencing");
      }
      throw new RuntimeException(e);
    }
    assertEquals(Cell.CELL_TYPE_ERROR,cv.getCellType());
    assertEquals(ErrorEval.VALUE_INVALID.getErrorCode(),cv.getErrorValue());
    fe.clearAllCachedResultValues();
    cell.setCellFormula("OFFSET(A1,0,0)");
    cv=fe.evaluate(cell);
    assertEquals(Cell.CELL_TYPE_ERROR,cv.getCellType());
    assertEquals(ErrorEval.CIRCULAR_REF_ERROR.getErrorCode(),cv.getErrorValue());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.eval.TestFormulasFromSpreadsheet </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (int colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    if (c == null || c.getCellType() != Cell.CELL_TYPE_FORMULA) {
      continue;
    }
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
assertEquals(msg,ErrorEval.getText(expValue.getErrorCellValue()),ErrorEval.getText(actValue.getErrorValue()));
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.function.TestReadMissingBuiltInFuncs </h4><pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDBCS(){
  String formula="";
  try {
    formula=getCellFormula(4);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("too much stuff")) {
      fail("DBCS() not registered");
    }
    throw e;
  }
catch (  NegativeArraySizeException e) {
    fail("found err- DBCS() registered with -1 args");
  }
  if ("JIS(\"abc\")".equals(formula)) {
    fail("func ix 215 registered as JIS() instead of DBCS()");
  }
  assertEquals("DBCS(\"abc\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsnontext(){
  String formula;
  try {
    formula=getCellFormula(5);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("too much stuff")) {
      fail("ISNONTEXT() registered with wrong index");
    }
    throw e;
  }
  assertEquals("ISNONTEXT(\"abc\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDdb(){
  String formula=getCellFormula(1);
  if ("externalflag(1,1,1,1,1)".equals(formula)) {
    fail("DDB() not registered");
  }
  assertEquals("DDB(1,1,1,1,1)",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAtan(){
  String formula=getCellFormula(2);
  if ("ARCTAN(1)".equals(formula)) {
    fail("func ix 18 registered as ARCTAN() instead of ATAN()");
  }
  assertEquals("ATAN(1)",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatedif(){
  String formula;
  try {
    formula=getCellFormula(0);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().startsWith("Too few arguments")) {
      if (e.getMessage().indexOf("AttrPtg") > 0) {
        fail("tAttrVolatile not supported in FormulaParser.toFormulaString");
      }
      fail("NOW() registered with 1 arg instead of 0");
    }
    if (e.getMessage().startsWith("too much stuff")) {
      fail("DATEDIF() not registered");
    }
    throw e;
  }
  assertEquals("DATEDIF(NOW(),NOW(),\"d\")",formula);
}

</code></pre>

<br>
<pre class="type-14 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsdollar(){
  String formula=getCellFormula(3);
  if ("YEN(1)".equals(formula)) {
    fail("func ix 204 registered as YEN() instead of USDOLLAR()");
  }
  assertEquals("USDOLLAR(1)",formula);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.formula.functions.BaseTestFunctionsFromSpreadsheet </h4><pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow() throws Exception {
  HSSFRow r=sheet.getRow(formulasRowIdx);
  HSSFCell evalCell=r.getCell(SS.COLUMN_INDEX_EVALUATION);
  HSSFCell expectedCell=r.getCell(SS.COLUMN_INDEX_EXPECTED_RESULT);
  CellReference cr=new CellReference(sheet.getSheetName(),formulasRowIdx,evalCell.getColumnIndex(),false,false);
  String msg=String.format(Locale.ROOT,"In %s %s {=%s} '%s'",filename,cr.formatAsString(),evalCell.getCellFormula(),testName);
  CellValue actualValue=evaluator.evaluate(evalCell);
  assertNotNull(msg + " - Bad setup data expected value is null",expectedCell);
  assertNotNull(msg + " - actual value was null",actualValue);
  if (expectedCell.getCellType() == HSSFCell.CELL_TYPE_ERROR) {
    int expectedErrorCode=expectedCell.getErrorCellValue();
    assertEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),actualValue.formatAsString());
    assertEquals(msg,expectedErrorCode,actualValue.getErrorValue());
    assertEquals(msg,ErrorEval.getText(expectedErrorCode),ErrorEval.getText(actualValue.getErrorValue()));
    return;
  }
  assertNotEquals(msg,HSSFCell.CELL_TYPE_ERROR,actualValue.getCellType());
  assertNotEquals(msg,formatValue(expectedCell),ErrorEval.getText(actualValue.getErrorValue()));
  assertEquals(msg,expectedCell.getCellType(),actualValue.getCellType());
switch (expectedCell.getCellType()) {
case HSSFCell.CELL_TYPE_BOOLEAN:
    assertEquals(msg,expectedCell.getBooleanCellValue(),actualValue.getBooleanValue());
  break;
case HSSFCell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case HSSFCell.CELL_TYPE_NUMERIC:
assertEquals(expectedCell.getNumericCellValue(),actualValue.getNumberValue(),0.0);
break;
case HSSFCell.CELL_TYPE_STRING:
assertEquals(msg,expectedCell.getRichStringCellValue().getString(),actualValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestBugzillaIssues </h4><pre class="type-12 type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bug58260() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  int maxStyles=(wb instanceof HSSFWorkbook) ? 4009 : 64000;
  for (int i=0; i < maxStyles; i++) {
    CellStyle style=null;
    try {
      style=wb.createCellStyle();
    }
 catch (    IllegalStateException e) {
      fail("Failed for row " + i);
    }
    style.setAlignment(CellStyle.ALIGN_RIGHT);
    if ((wb instanceof HSSFWorkbook)) {
      assertEquals(i + 21,style.getIndex());
    }
 else {
      assertEquals(i + 1,style.getIndex() & 0xffff);
    }
  }
  try {
    wb.createCellStyle();
    fail("Should fail after " + maxStyles + " styles, but did not fail");
  }
 catch (  IllegalStateException e) {
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestCellComment </h4><pre class="type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getClientAnchor() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  Row row=sheet.createRow(10);
  Cell cell=row.createCell(5);
  CreationHelper factory=wb.getCreationHelper();
  Drawing drawing=sheet.createDrawingPatriarch();
  double r_mul, c_mul;
  if (sheet instanceof HSSFSheet) {
    double rowheight=Units.toEMU(row.getHeightInPoints()) / EMU_PER_PIXEL;
    r_mul=256.0 / rowheight;
    double colwidth=sheet.getColumnWidthInPixels(2);
    c_mul=1024.0 / colwidth;
  }
 else {
    r_mul=c_mul=EMU_PER_PIXEL;
  }
  int dx1=(int)Math.round(10 * c_mul);
  int dy1=(int)Math.round(10 * r_mul);
  int dx2=(int)Math.round(3 * c_mul);
  int dy2=(int)Math.round(4 * r_mul);
  int col1=cell.getColumnIndex() + 1;
  int row1=row.getRowNum();
  int col2=cell.getColumnIndex() + 2;
  int row2=row.getRowNum() + 1;
  ClientAnchor anchor=drawing.createAnchor(dx1,dy1,dx2,dy2,col1,row1,col2,row2);
  Comment comment=drawing.createCellComment(anchor);
  comment.setVisible(true);
  cell.setCellComment(comment);
  anchor=comment.getClientAnchor();
  assertEquals(dx1,anchor.getDx1());
  assertEquals(dy1,anchor.getDy1());
  assertEquals(dx2,anchor.getDx2());
  assertEquals(dy2,anchor.getDy2());
  assertEquals(col1,anchor.getCol1());
  assertEquals(row1,anchor.getRow1());
  assertEquals(col2,anchor.getCol2());
  assertEquals(row2,anchor.getRow2());
  anchor=factory.createClientAnchor();
  comment=drawing.createCellComment(anchor);
  cell.setCellComment(comment);
  anchor=comment.getClientAnchor();
  if (sheet instanceof HSSFSheet) {
    assertEquals(0,anchor.getCol1());
    assertEquals(0,anchor.getDx1());
    assertEquals(0,anchor.getRow1());
    assertEquals(0,anchor.getDy1());
    assertEquals(0,anchor.getCol2());
    assertEquals(0,anchor.getDx2());
    assertEquals(0,anchor.getRow2());
    assertEquals(0,anchor.getDy2());
  }
 else {
    assertEquals(1,anchor.getCol1());
    assertEquals(15 * EMU_PER_PIXEL,anchor.getDx1());
    assertEquals(0,anchor.getRow1());
    assertEquals(2 * EMU_PER_PIXEL,anchor.getDy1());
    assertEquals(3,anchor.getCol2());
    assertEquals(15 * EMU_PER_PIXEL,anchor.getDx2());
    assertEquals(3,anchor.getRow2());
    assertEquals(16 * EMU_PER_PIXEL,anchor.getDy2());
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestConditionalFormatting </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClone() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet();
  String formula="7";
  SheetConditionalFormatting sheetCF=sheet.getSheetConditionalFormatting();
  ConditionalFormattingRule rule1=sheetCF.createConditionalFormattingRule(formula);
  FontFormatting fontFmt=rule1.createFontFormatting();
  fontFmt.setFontStyle(true,false);
  PatternFormatting patternFmt=rule1.createPatternFormatting();
  patternFmt.setFillBackgroundColor(IndexedColors.YELLOW.index);
  ConditionalFormattingRule rule2=sheetCF.createConditionalFormattingRule(ComparisonOperator.BETWEEN,"1","2");
  ConditionalFormattingRule[] cfRules={rule1,rule2};
  short col=1;
  CellRangeAddress[] regions={new CellRangeAddress(0,65535,col,col)};
  sheetCF.addConditionalFormatting(regions,cfRules);
  try {
    wb.cloneSheet(0);
    assertEquals(2,wb.getNumberOfSheets());
  }
 catch (  RuntimeException e) {
    if (e.getMessage().indexOf("needs to define a clone method") > 0) {
      fail("Indentified bug 45682");
    }
    throw e;
  }
 finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestFormulaEvaluator </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for bug due to attempt to convert a cached formula error result to a boolean
 */
@Test public void testUpdateCachedFormulaResultFromErrorToNumber_bug46479() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet("Sheet1");
  Row row=sheet.createRow(0);
  Cell cellA1=row.createCell(0);
  Cell cellB1=row.createCell(1);
  cellB1.setCellFormula("A1+1");
  FormulaEvaluator fe=wb.getCreationHelper().createFormulaEvaluator();
  cellA1.setCellErrorValue((byte)ErrorConstants.ERROR_NAME);
  fe.evaluateFormulaCell(cellB1);
  cellA1.setCellValue(2.5);
  fe.notifyUpdateCell(cellA1);
  try {
    fe.evaluateInCell(cellB1);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals("Cannot get a numeric value from a error formula cell")) {
      fail("Identified bug 46479a");
    }
  }
  assertEquals(3.5,cellB1.getNumericCellValue(),0.0);
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheet </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the setAsActiveCell and getActiveCell function pairs work together
 */
@Test public void setActiveCell() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet();
  CellAddress B42=new CellAddress("B42");
  if (sheet.getActiveCell() != null && !sheet.getActiveCell().equals(CellAddress.A1)) {
    fail("If not set, active cell should default to null or A1");
  }
  sheet.setActiveCell(B42);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  assertEquals(B42,sheet.getActiveCell());
  wb1.close();
  wb2.close();
}

</code></pre>

<br>
<pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cloneSheet() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  CreationHelper factory=workbook.getCreationHelper();
  Sheet sheet=workbook.createSheet("Test Clone");
  Row row=sheet.createRow(0);
  Cell cell=row.createCell(0);
  Cell cell2=row.createCell(1);
  cell.setCellValue(factory.createRichTextString("clone_test"));
  cell2.setCellFormula("SIN(1)");
  Sheet clonedSheet=workbook.cloneSheet(0);
  Row clonedRow=clonedSheet.getRow(0);
  assertEquals(clonedRow.getCell(0).getRichStringCellValue().getString(),"clone_test");
  cell.setCellValue(factory.createRichTextString("Difference Check"));
  cell2.setCellFormula("cos(2)");
  if ("Difference Check".equals(clonedRow.getCell(0).getRichStringCellValue().getString())) {
    fail("string cell not properly cloned");
  }
  if ("COS(2)".equals(clonedRow.getCell(1).getCellFormula())) {
    fail("formula cell not properly cloned");
  }
  assertEquals(clonedRow.getCell(0).getRichStringCellValue().getString(),"clone_test");
  assertEquals(clonedRow.getCell(1).getCellFormula(),"SIN(1)");
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestSheetShiftRows </h4><pre class="type-14 type-10 type-1 type-3 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Unified test for:
 * bug 46742: XSSFSheet.shiftRows should shift hyperlinks
 * bug 52903: HSSFSheet.shiftRows should shift hyperlinks
 * @throws IOException
 */
@Test public void testBug46742_52903_shiftHyperlinks() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet=wb.createSheet("test");
  Row row=sheet.createRow(0);
  CreationHelper helper=wb.getCreationHelper();
  CellStyle hlinkStyle=wb.createCellStyle();
  Font hlinkFont=wb.createFont();
  hlinkFont.setUnderline(Font.U_SINGLE);
  hlinkFont.setColor(IndexedColors.BLUE.getIndex());
  hlinkStyle.setFont(hlinkFont);
  Cell cell=row.createCell(0);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_DOCUMENT,"test!E1");
  cell=row.createCell(1);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_URL,"http://poi.apache.org/");
  Row overwrittenRow=sheet.createRow(3);
  cell=overwrittenRow.createCell(2);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_EMAIL,"mailto:poi@apache.org");
  Row unaffectedRow=sheet.createRow(20);
  cell=unaffectedRow.createCell(3);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_FILE,"54524.xlsx");
  cell=wb.createSheet("other").createRow(0).createCell(0);
  cell.setCellStyle(hlinkStyle);
  createHyperlink(helper,cell,Hyperlink.LINK_URL,"http://apache.org/");
  int startRow=0;
  int endRow=0;
  int n=3;
  sheet.shiftRows(startRow,endRow,n);
  Workbook read=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  Sheet sh=read.getSheet("test");
  Row shiftedRow=sh.getRow(3);
  verifyHyperlink(shiftedRow.getCell(0),Hyperlink.LINK_DOCUMENT,"test!E1");
  verifyHyperlink(shiftedRow.getCell(1),Hyperlink.LINK_URL,"http://poi.apache.org/");
  assertNull("Document hyperlink should be moved, not copied",sh.getHyperlink(0,0));
  assertNull("URL hyperlink should be moved, not copied",sh.getHyperlink(0,1));
  assertEquals(3,sh.getHyperlinkList().size());
  CellAddress unexpectedLinkAddress=new CellAddress("C4");
  for (  Hyperlink link : sh.getHyperlinkList()) {
    final CellAddress linkAddress=new CellAddress(link.getFirstRow(),link.getFirstColumn());
    if (linkAddress.equals(unexpectedLinkAddress)) {
      fail("Row 4, including the hyperlink at C4, should have " + "been deleted when Row 1 was shifted on top of it.");
    }
  }
  Cell unaffectedCell=sh.getRow(20).getCell(3);
  assertTrue(cellHasHyperlink(unaffectedCell));
  verifyHyperlink(unaffectedCell,Hyperlink.LINK_FILE,"54524.xlsx");
  unaffectedCell=read.getSheet("other").getRow(0).getCell(0);
  assertTrue(cellHasHyperlink(unaffectedCell));
  verifyHyperlink(unaffectedCell,Hyperlink.LINK_URL,"http://apache.org/");
  read.close();
}

</code></pre>

<br>
<pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShiftWithComments() throws IOException {
  Workbook wb1=_testDataProvider.openSampleWorkbook("comments." + _testDataProvider.getStandardFileNameExtension());
  Sheet sheet=wb1.getSheet("Sheet1");
  assertEquals(3,sheet.getLastRowNum());
  assertNotNull(sheet.getCellComment(0,0));
  assertNull(sheet.getCellComment(1,0));
  assertNotNull(sheet.getCellComment(2,0));
  assertNotNull(sheet.getCellComment(3,0));
  String comment1=sheet.getCellComment(0,0).getString().getString();
  assertEquals(comment1,"comment top row1 (index0)\n");
  String comment3=sheet.getCellComment(2,0).getString().getString();
  assertEquals(comment3,"comment top row3 (index2)\n");
  String comment4=sheet.getCellComment(3,0).getString().getString();
  assertEquals(comment4,"comment top row4 (index3)\n");
  sheet.shiftRows(1,sheet.getLastRowNum(),1,true,true);
  assertEquals(4,sheet.getLastRowNum());
  assertNotNull(sheet.getCellComment(0,0));
  assertNull(sheet.getCellComment(1,0));
  assertNull(sheet.getCellComment(2,0));
  assertNotNull(sheet.getCellComment(3,0));
  assertNotNull(sheet.getCellComment(4,0));
  String comment1_shifted=sheet.getCellComment(0,0).getString().getString();
  assertEquals(comment1,comment1_shifted);
  String comment3_shifted=sheet.getCellComment(3,0).getString().getString();
  assertEquals(comment3,comment3_shifted);
  String comment4_shifted=sheet.getCellComment(4,0).getString().getString();
  assertEquals(comment4,comment4_shifted);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheet("Sheet1");
  assertEquals(4,sheet.getLastRowNum());
  assertNotNull(sheet.getCellComment(0,0));
  assertNull(sheet.getCellComment(1,0));
  assertNull(sheet.getCellComment(2,0));
  assertNotNull(sheet.getCellComment(3,0));
  assertNotNull(sheet.getCellComment(4,0));
  comment1_shifted=sheet.getCellComment(0,0).getString().getString();
  assertEquals(comment1,comment1_shifted);
  comment3_shifted=sheet.getCellComment(3,0).getString().getString();
  assertEquals(comment3,comment3_shifted);
  comment4_shifted=sheet.getCellComment(4,0).getString().getString();
  assertEquals(comment4,comment4_shifted);
  sheet.shiftRows(2,sheet.getLastRowNum(),-2,true,true);
  if (!(wb2 instanceof HSSFWorkbook)) {
    assertEquals(2,sheet.getLastRowNum());
    assertNull("Had: " + (sheet.getCellComment(0,0) == null ? "null" : sheet.getCellComment(0,0).getString()),sheet.getCellComment(0,0));
    assertNotNull(sheet.getCellComment(1,0));
    assertNotNull(sheet.getCellComment(2,0));
  }
  comment1=sheet.getCellComment(1,0).getString().getString();
  assertEquals(comment1,"comment top row3 (index2)\n");
  String comment2=sheet.getCellComment(2,0).getString().getString();
  assertEquals(comment2,"comment top row4 (index3)\n");
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestWorkbook </h4><pre class="type-14 type-10 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSheet() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  assertEquals(0,wb.getNumberOfSheets());
  assertNull(wb.getSheet("Sheet1"));
  try {
    wb.getSheetAt(0);
    fail("should have thrown exceptiuon due to invalid sheet index");
  }
 catch (  IllegalArgumentException e) {
    assertFalse(e.getMessage().contains("-1"));
  }
  Sheet sheet0=wb.createSheet();
  Sheet sheet1=wb.createSheet();
  assertEquals("Sheet0",sheet0.getSheetName());
  assertEquals("Sheet1",sheet1.getSheetName());
  assertEquals(2,wb.getNumberOfSheets());
  Sheet originalSheet=wb.createSheet("Sheet3");
  Sheet fetchedSheet=wb.getSheet("sheet3");
  if (fetchedSheet == null) {
    fail("Identified bug 44892");
  }
  assertEquals("Sheet3",fetchedSheet.getSheetName());
  assertEquals(3,wb.getNumberOfSheets());
  assertSame(originalSheet,fetchedSheet);
  try {
    wb.createSheet("sHeeT3");
    fail("should have thrown exceptiuon due to duplicate sheet name");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String[] invalidNames={"","Sheet/","Sheet\\","Sheet?","Sheet*","Sheet[","Sheet]","'Sheet'","My:Sheet"};
  for (  String sheetName : invalidNames) {
    try {
      wb.createSheet(sheetName);
      fail("should have thrown exception due to invalid sheet name: " + sheetName);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  assertEquals(3,wb.getNumberOfSheets());
  wb.setSheetName(2,"I changed!");
  try {
    wb.setSheetName(1,"[I'm invalid]");
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.createSheet(null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.setSheetName(2,null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(0,wb.getSheetIndex("sheet0"));
  assertEquals(1,wb.getSheetIndex("sheet1"));
  assertEquals(2,wb.getSheetIndex("I changed!"));
  assertSame(sheet0,wb.getSheet("sheet0"));
  assertSame(sheet1,wb.getSheet("sheet1"));
  assertSame(originalSheet,wb.getSheet("I changed!"));
  assertNull(wb.getSheet("unknown"));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(3,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex("sheet0"));
  assertEquals(1,wb2.getSheetIndex("sheet1"));
  assertEquals(2,wb2.getSheetIndex("I changed!"));
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.ss.usermodel.TestDataFormatter </h4><pre class="type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can handle elapsed time,
 * eg formatting 1 day 4 hours as 28 hours
 */
@Test public void testElapsedTime(){
  DataFormatter dfUS=new DataFormatter(Locale.US);
  double hour=1.0 / 24.0;
  assertEquals("01:00",dfUS.formatRawCellContents(1 * hour,-1,"hh:mm"));
  assertEquals("05:00",dfUS.formatRawCellContents(5 * hour,-1,"hh:mm"));
  assertEquals("20:00",dfUS.formatRawCellContents(20 * hour,-1,"hh:mm"));
  assertEquals("23:00",dfUS.formatRawCellContents(23 * hour,-1,"hh:mm"));
  assertEquals("00:00",dfUS.formatRawCellContents(24 * hour,-1,"hh:mm"));
  assertEquals("02:00",dfUS.formatRawCellContents(26 * hour,-1,"hh:mm"));
  assertEquals("20:00",dfUS.formatRawCellContents(44 * hour,-1,"hh:mm"));
  assertEquals("02:00",dfUS.formatRawCellContents(50 * hour,-1,"hh:mm"));
  assertEquals("01:00",dfUS.formatRawCellContents(1 * hour,-1,"[hh]:mm"));
  assertEquals("05:00",dfUS.formatRawCellContents(5 * hour,-1,"[hh]:mm"));
  assertEquals("20:00",dfUS.formatRawCellContents(20 * hour,-1,"[hh]:mm"));
  assertEquals("23:00",dfUS.formatRawCellContents(23 * hour,-1,"[hh]:mm"));
  assertEquals("24:00",dfUS.formatRawCellContents(24 * hour,-1,"[hh]:mm"));
  assertEquals("26:00",dfUS.formatRawCellContents(26 * hour,-1,"[hh]:mm"));
  assertEquals("44:00",dfUS.formatRawCellContents(44 * hour,-1,"[hh]:mm"));
  assertEquals("50:00",dfUS.formatRawCellContents(50 * hour,-1,"[hh]:mm"));
  assertEquals("01",dfUS.formatRawCellContents(1 * hour,-1,"[hh]"));
  assertEquals("05",dfUS.formatRawCellContents(5 * hour,-1,"[hh]"));
  assertEquals("20",dfUS.formatRawCellContents(20 * hour,-1,"[hh]"));
  assertEquals("23",dfUS.formatRawCellContents(23 * hour,-1,"[hh]"));
  assertEquals("24",dfUS.formatRawCellContents(24 * hour,-1,"[hh]"));
  assertEquals("26",dfUS.formatRawCellContents(26 * hour,-1,"[hh]"));
  assertEquals("44",dfUS.formatRawCellContents(44 * hour,-1,"[hh]"));
  assertEquals("50",dfUS.formatRawCellContents(50 * hour,-1,"[hh]"));
  double minute=1.0 / 24.0 / 60.0;
  assertEquals("01:00",dfUS.formatRawCellContents(1 * minute,-1,"[mm]:ss"));
  assertEquals("05:00",dfUS.formatRawCellContents(5 * minute,-1,"[mm]:ss"));
  assertEquals("20:00",dfUS.formatRawCellContents(20 * minute,-1,"[mm]:ss"));
  assertEquals("23:00",dfUS.formatRawCellContents(23 * minute,-1,"[mm]:ss"));
  assertEquals("24:00",dfUS.formatRawCellContents(24 * minute,-1,"[mm]:ss"));
  assertEquals("26:00",dfUS.formatRawCellContents(26 * minute,-1,"[mm]:ss"));
  assertEquals("44:00",dfUS.formatRawCellContents(44 * minute,-1,"[mm]:ss"));
  assertEquals("50:00",dfUS.formatRawCellContents(50 * minute,-1,"[mm]:ss"));
  assertEquals("59:00",dfUS.formatRawCellContents(59 * minute,-1,"[mm]:ss"));
  assertEquals("60:00",dfUS.formatRawCellContents(60 * minute,-1,"[mm]:ss"));
  assertEquals("61:00",dfUS.formatRawCellContents(61 * minute,-1,"[mm]:ss"));
  assertEquals("119:00",dfUS.formatRawCellContents(119 * minute,-1,"[mm]:ss"));
  assertEquals("120:00",dfUS.formatRawCellContents(120 * minute,-1,"[mm]:ss"));
  assertEquals("121:00",dfUS.formatRawCellContents(121 * minute,-1,"[mm]:ss"));
  assertEquals("01",dfUS.formatRawCellContents(1 * minute,-1,"[mm]"));
  assertEquals("05",dfUS.formatRawCellContents(5 * minute,-1,"[mm]"));
  assertEquals("20",dfUS.formatRawCellContents(20 * minute,-1,"[mm]"));
  assertEquals("23",dfUS.formatRawCellContents(23 * minute,-1,"[mm]"));
  assertEquals("24",dfUS.formatRawCellContents(24 * minute,-1,"[mm]"));
  assertEquals("26",dfUS.formatRawCellContents(26 * minute,-1,"[mm]"));
  assertEquals("44",dfUS.formatRawCellContents(44 * minute,-1,"[mm]"));
  assertEquals("50",dfUS.formatRawCellContents(50 * minute,-1,"[mm]"));
  assertEquals("59",dfUS.formatRawCellContents(59 * minute,-1,"[mm]"));
  assertEquals("60",dfUS.formatRawCellContents(60 * minute,-1,"[mm]"));
  assertEquals("61",dfUS.formatRawCellContents(61 * minute,-1,"[mm]"));
  assertEquals("119",dfUS.formatRawCellContents(119 * minute,-1,"[mm]"));
  assertEquals("120",dfUS.formatRawCellContents(120 * minute,-1,"[mm]"));
  assertEquals("121",dfUS.formatRawCellContents(121 * minute,-1,"[mm]"));
  double second=1.0 / 24.0 / 60.0/ 60.0;
  assertEquals("86400",dfUS.formatRawCellContents(86400 * second,-1,"[ss]"));
  assertEquals("01",dfUS.formatRawCellContents(1 * second,-1,"[ss]"));
  assertEquals("05",dfUS.formatRawCellContents(5 * second,-1,"[ss]"));
  assertEquals("20",dfUS.formatRawCellContents(20 * second,-1,"[ss]"));
  assertEquals("23",dfUS.formatRawCellContents(23 * second,-1,"[ss]"));
  assertEquals("24",dfUS.formatRawCellContents(24 * second,-1,"[ss]"));
  assertEquals("26",dfUS.formatRawCellContents(26 * second,-1,"[ss]"));
  assertEquals("44",dfUS.formatRawCellContents(44 * second,-1,"[ss]"));
  assertEquals("50",dfUS.formatRawCellContents(50 * second,-1,"[ss]"));
  assertEquals("59",dfUS.formatRawCellContents(59 * second,-1,"[ss]"));
  assertEquals("60",dfUS.formatRawCellContents(60 * second,-1,"[ss]"));
  assertEquals("61",dfUS.formatRawCellContents(61 * second,-1,"[ss]"));
  assertEquals("119",dfUS.formatRawCellContents(119 * second,-1,"[ss]"));
  assertEquals("120",dfUS.formatRawCellContents(120 * second,-1,"[ss]"));
  assertEquals("121",dfUS.formatRawCellContents(121 * second,-1,"[ss]"));
  boolean jdk_1_5=System.getProperty("java.vm.version").startsWith("1.5");
  if (!jdk_1_5) {
    assertEquals("27:18:08",dfUS.formatRawCellContents(1.1376,-1,"[h]:mm:ss"));
    assertEquals("28:48:00",dfUS.formatRawCellContents(1.2,-1,"[h]:mm:ss"));
    assertEquals("29:31:12",dfUS.formatRawCellContents(1.23,-1,"[h]:mm:ss"));
    assertEquals("31:26:24",dfUS.formatRawCellContents(1.31,-1,"[h]:mm:ss"));
    assertEquals("27:18:08",dfUS.formatRawCellContents(1.1376,-1,"[hh]:mm:ss"));
    assertEquals("28:48:00",dfUS.formatRawCellContents(1.2,-1,"[hh]:mm:ss"));
    assertEquals("29:31:12",dfUS.formatRawCellContents(1.23,-1,"[hh]:mm:ss"));
    assertEquals("31:26:24",dfUS.formatRawCellContents(1.31,-1,"[hh]:mm:ss"));
    assertEquals("57:07.2",dfUS.formatRawCellContents(.123,-1,"mm:ss.0;@"));
    assertEquals("57:41.8",dfUS.formatRawCellContents(.1234,-1,"mm:ss.0;@"));
    assertEquals("57:41.76",dfUS.formatRawCellContents(.1234,-1,"mm:ss.00;@"));
    assertEquals("57:41.760",dfUS.formatRawCellContents(.1234,-1,"mm:ss.000;@"));
    assertEquals("24:00.0",dfUS.formatRawCellContents(123456.6,-1,"mm:ss.0"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.TestXSLFBugs </h4><pre class="type-14 type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Slide relations with anchors in them
 */
@Test public void tika705() throws Exception {
  XMLSlideShow ss=XSLFTestDataSamples.openSampleDocument("with_japanese.pptx");
  assertEquals(1,ss.getSlides().size());
  XSLFSlide slide=ss.getSlides().get(0);
  Collection<RelationPart> rels=slide.getRelationParts();
  assertEquals(5,rels.size());
  int layouts=0;
  int hyperlinks=0;
  for (  RelationPart p : rels) {
    if (p.getRelationship().getRelationshipType().equals(XSLFRelation.HYPERLINK.getRelation())) {
      hyperlinks++;
    }
 else     if (p.getDocumentPart() instanceof XSLFSlideLayout) {
      layouts++;
    }
  }
  assertEquals(1,layouts);
  assertEquals(4,hyperlinks);
  for (  RelationPart p : rels) {
    if (p.getRelationship().getRelationshipType().equals(XSLFRelation.HYPERLINK.getRelation())) {
      URI target=p.getRelationship().getTargetURI();
      if (target.getFragment().equals("_ftn1") || target.getFragment().equals("_ftnref1")) {
      }
 else {
        fail("Invalid target " + target.getFragment() + " on "+ target);
      }
    }
  }
  ss.close();
}

</code></pre>

<br>
<pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When the picture is not embedded but inserted only as a "link to file", 
 * there is no data available and XSLFPictureShape.getPictureData()
 * gives a NPE, see bug #56812
 */
@Test public void bug56812() throws Exception {
  XMLSlideShow ppt=XSLFTestDataSamples.openSampleDocument("56812.pptx");
  int internalPictures=0;
  int externalPictures=0;
  for (  XSLFSlide slide : ppt.getSlides()) {
    for (    XSLFShape shape : slide.getShapes()) {
      assertNotNull(shape);
      if (shape instanceof XSLFPictureShape) {
        XSLFPictureShape picture=(XSLFPictureShape)shape;
        if (picture.isExternalLinkedPicture()) {
          externalPictures++;
          assertNotNull(picture.getPictureLink());
        }
 else {
          internalPictures++;
          XSLFPictureData data=picture.getPictureData();
          assertNotNull(data);
          assertNotNull(data.getFileName());
        }
      }
    }
  }
  assertEquals(2,internalPictures);
  assertEquals(1,externalPictures);
  ppt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xslf.usermodel.TestXMLSlideShow </h4><pre class="type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComments() throws Exception {
  XMLSlideShow xml=new XMLSlideShow(pack);
  assertEquals(null,xml.getCommentAuthors());
  for (  XSLFSlide slide : xml.getSlides()) {
    assertEquals(null,slide.getComments());
  }
  XMLSlideShow xmlComments=new XMLSlideShow(slTests.openResourceAsStream("45545_Comment.pptx"));
  assertNotNull(xmlComments.getCommentAuthors());
  assertEquals(1,xmlComments.getCommentAuthors().getCTCommentAuthorsList().sizeOfCmAuthorArray());
  assertEquals("XPVMWARE01",xmlComments.getCommentAuthors().getAuthorById(0).getName());
  int i=-1;
  for (  XSLFSlide slide : xmlComments.getSlides()) {
    i++;
    if (i == 0) {
      assertNotNull(slide.getComments());
      assertEquals(1,slide.getComments().getNumberOfComments());
      assertEquals("testdoc",slide.getComments().getCommentAt(0).getText());
      assertEquals(0,slide.getComments().getCommentAt(0).getAuthorId());
    }
 else     if (i == 1) {
      assertNotNull(slide.getComments());
      assertEquals(1,slide.getComments().getNumberOfComments());
      assertEquals("test phrase",slide.getComments().getCommentAt(0).getText());
      assertEquals(0,slide.getComments().getCommentAt(0).getAuthorId());
    }
 else {
      assertEquals(null,slide.getComments());
    }
  }
  xmlComments.close();
  xml.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.model.TestThemesTable </h4><pre class="type-2 type-12 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that, for a file with themes, we can correctly
 * read both the themed and non-themed colours back.
 * Column A = Theme Foreground
 * Column B = Theme Foreground
 * Column C = Explicit Colour Foreground
 * Column E = Explicit Colour Background, Black Foreground
 * Column G = Conditional Formatting Backgrounds
 * Note - Grey Row has an odd way of doing the styling... 
 */
@Test public void themedAndNonThemedColours(){
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
  XSSFSheet sheet=wb.getSheetAt(0);
  XSSFCellStyle style;
  XSSFColor color;
  XSSFCell cell;
  String[] names={"White","Black","Grey","Dark Blue","Blue","Red","Green"};
  String[] explicitFHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0070C0","FFFF0000","FF00B050"};
  String[] explicitBHexes={"FFFFFFFF","FF000000","FFC0C0C0","FF002060","FF0000FF","FFFF0000","FF00FF00"};
  assertEquals(7,names.length);
  for (int rn=1; rn < 8; rn++) {
    int idx=rn - 1;
    XSSFRow row=sheet.getRow(rn);
    assertNotNull("Missing row " + rn,row);
    XSSFCell themeCell=row.getCell(0);
    ThemeElement themeElem=ThemeElement.byId(idx);
    assertCellContents(themeElem.name,themeCell);
    assertCellContents(names[idx],row.getCell(1));
    assertCellContents(names[idx],row.getCell(2));
    assertCellContents(names[idx],row.getCell(4));
    style=themeCell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals(idx,color.getTheme());
    assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    cell=row.getCell(1);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    if (idx != 2) {
      assertEquals(idx,color.getTheme());
      assertEquals(rgbExpected[idx],Hex.encodeHexString(color.getRGB()));
    }
 else {
      assertEquals(1,color.getTheme());
      assertEquals(0.50,color.getTint(),0.001);
    }
    cell=row.getCell(2);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitFHexes[idx],color.getARGBHex());
    cell=row.getCell(4);
    style=cell.getCellStyle();
    color=style.getFont().getXSSFColor();
    assertEquals(true,color.isThemed());
    assertEquals("FF000000",color.getARGBHex());
    color=style.getFillForegroundXSSFColor();
    assertEquals(false,color.isThemed());
    assertEquals(explicitBHexes[idx],color.getARGBHex());
    color=style.getFillBackgroundColorColor();
    assertEquals(false,color.isThemed());
    assertEquals(null,color.getARGBHex());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-12 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void processFunctionRow(){
  Row formulasRow=sheet.getRow(formulasRowIdx);
  Row expectedValuesRow=sheet.getRow(expectedValuesRowIdx);
  short endcolnum=formulasRow.getLastCellNum();
  for (short colnum=SS.COLUMN_INDEX_FIRST_TEST_VALUE; colnum < endcolnum; colnum++) {
    Cell c=formulasRow.getCell(colnum);
    assumeNotNull(c);
    assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
    ignoredFormulaTestCase(c.getCellFormula());
    CellValue actValue=evaluator.evaluate(c);
    Cell expValue=(expectedValuesRow == null) ? null : expectedValuesRow.getCell(colnum);
    String msg=String.format(Locale.ROOT,"Function '%s': Formula: %s @ %d:%d",targetFunctionName,c.getCellFormula(),formulasRow.getRowNum(),colnum);
    assertNotNull(msg + " - Bad setup data expected value is null",expValue);
    assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
      assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
    break;
case Cell.CELL_TYPE_BOOLEAN:
  assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestMultiSheetFormulaEvaluatorOnXSSF </h4><pre class="type-2 type-14 type-10 type-1 type-17 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @return a constant from the local Result class denoting whether there were any evaluation
 * cases, and whether they all succeeded.
 */
@Test public void processFunctionRow(){
  Row r=sheet.getRow(formulasRowIdx);
  Cell expValue=r.getCell(SS.COLUMN_INDEX_EXPECTED_VALUE);
  assertNotNull("Missing expected values cell for function '" + targetFunctionName + ", test"+ targetTestName+ " (row "+ formulasRowIdx+ 1+ ")",expValue);
  Cell c=r.getCell(SS.COLUMN_INDEX_ACTUAL_VALUE);
  assumeNotNull(c);
  assumeTrue(c.getCellType() == Cell.CELL_TYPE_FORMULA);
  CellValue actValue=evaluator.evaluate(c);
  String msg=String.format(Locale.ROOT,"Function '%s': Test: '%s': Formula: %s @ %d:%d",targetFunctionName,targetTestName,c.getCellFormula(),formulasRowIdx,SS.COLUMN_INDEX_ACTUAL_VALUE);
  assertNotNull(msg + " - actual value was null",actValue);
switch (expValue.getCellType()) {
case Cell.CELL_TYPE_BLANK:
    assertEquals(msg,Cell.CELL_TYPE_BLANK,actValue.getCellType());
  break;
case Cell.CELL_TYPE_BOOLEAN:
assertEquals(msg,Cell.CELL_TYPE_BOOLEAN,actValue.getCellType());
assertEquals(msg,expValue.getBooleanCellValue(),actValue.getBooleanValue());
break;
case Cell.CELL_TYPE_ERROR:
assertEquals(msg,Cell.CELL_TYPE_ERROR,actValue.getCellType());
break;
case Cell.CELL_TYPE_FORMULA:
fail("Cannot expect formula as result of formula evaluation: " + msg);
case Cell.CELL_TYPE_NUMERIC:
assertEquals(msg,Cell.CELL_TYPE_NUMERIC,actValue.getCellType());
TestMathX.assertEquals(msg,expValue.getNumericCellValue(),actValue.getNumberValue(),TestMathX.POS_ZERO,TestMathX.DIFF_TOLERANCE_FACTOR);
break;
case Cell.CELL_TYPE_STRING:
assertEquals(msg,Cell.CELL_TYPE_STRING,actValue.getCellType());
assertEquals(msg,expValue.getRichStringCellValue().getString(),actValue.getStringValue());
break;
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestUnfixedBugs </h4><pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test54071() throws Exception {
  Workbook workbook=XSSFTestDataSamples.openSampleWorkbook("54071.xlsx");
  Sheet sheet=workbook.getSheetAt(0);
  int rows=sheet.getPhysicalNumberOfRows();
  System.out.println(">> file rows is:" + (rows - 1) + " <<");
  Row title=sheet.getRow(0);
  Date prev=null;
  for (int row=1; row < rows; row++) {
    Row rowObj=sheet.getRow(row);
    for (int col=0; col < 1; col++) {
      String titleName=title.getCell(col).toString();
      Cell cell=rowObj.getCell(col);
      if (titleName.startsWith("time")) {
        System.out.println("==Time:" + cell.getDateCellValue());
        if (prev != null) {
          assertEquals(prev,cell.getDateCellValue());
        }
        prev=cell.getDateCellValue();
      }
    }
  }
  workbook.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFBugs </h4><pre class="type-14 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test56467() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("picture.xlsx");
  try {
    Sheet orig=wb.getSheetAt(0);
    assertNotNull(orig);
    Sheet sheet=wb.cloneSheet(0);
    Drawing drawing=sheet.createDrawingPatriarch();
    for (    XSSFShape shape : ((XSSFDrawing)drawing).getShapes()) {
      if (shape instanceof XSSFPicture) {
        XSSFPictureData pictureData=((XSSFPicture)shape).getPictureData();
        assertNotNull(pictureData);
      }
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<pre class="type-2 type-14 type-10 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A .xlsx file with no Shared Strings table should open fine
 * in read-only mode
 * @throws InvalidFormatException 
 */
@Test public void bug57482() throws IOException, InvalidFormatException {
  for (  PackageAccess access : new PackageAccess[]{PackageAccess.READ_WRITE,PackageAccess.READ}) {
    File file=HSSFTestDataSamples.getSampleFile("57482-OnlyNumeric.xlsx");
    OPCPackage pkg=OPCPackage.open(file,access);
    try {
      XSSFWorkbook wb1=new XSSFWorkbook(pkg);
      assertNotNull(wb1.getSharedStringSource());
      assertEquals(0,wb1.getSharedStringSource().getCount());
      DataFormatter fmt=new DataFormatter();
      XSSFSheet s=wb1.getSheetAt(0);
      assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
      assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
      assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
      s.getRow(0).createCell(3).setCellValue("Testing");
      assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      XSSFWorkbook wb2=null;
      try {
        wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
        if (access == PackageAccess.READ) {
          fail("Shouln't be able to write from read-only mode");
        }
        s=wb2.getSheetAt(0);
        assertEquals("1",fmt.formatCellValue(s.getRow(0).getCell(0)));
        assertEquals("11",fmt.formatCellValue(s.getRow(0).getCell(1)));
        assertEquals("5",fmt.formatCellValue(s.getRow(4).getCell(0)));
        assertEquals("Testing",fmt.formatCellValue(s.getRow(0).getCell(3)));
      }
 catch (      InvalidOperationException e) {
        if (access == PackageAccess.READ_WRITE) {
          throw e;
        }
      }
 finally {
        if (wb2 != null) {
          wb2.getPackage().revert();
        }
      }
      wb1.getPackage().revert();
    }
  finally {
      pkg.revert();
    }
  }
}

</code></pre>

<br>
<pre class="type-14 type-1 type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test50755_workday_formula_example() throws IOException {
  Workbook wb=XSSFTestDataSamples.openSampleWorkbook("50755_workday_formula_example.xlsx");
  Sheet sheet=wb.getSheet("Sheet1");
  for (  Row aRow : sheet) {
    Cell cell=aRow.getCell(1);
    if (cell.getCellType() == Cell.CELL_TYPE_FORMULA) {
      String formula=cell.getCellFormula();
      assertNotNull(formula);
      assertTrue(formula.contains("WORKDAY"));
    }
 else {
      assertNotNull(cell.toString());
    }
  }
  wb.close();
}

</code></pre>

<br>
<pre class="type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Problem with evaluation formulas due to
 * NameXPtgs.
 * Blows up on:
 * IF(B6= (ROUNDUP(B6,0) + ROUNDDOWN(B6,0))/2, MROUND(B6,2),ROUND(B6,0))
 * TODO: delete this test case when MROUND and VAR are implemented
 */
@Test public void bug48539() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("48539.xlsx");
  try {
    assertEquals(3,wb.getNumberOfSheets());
    assertEquals(0,wb.getNumberOfNames());
    XSSFFormulaEvaluator eval=new XSSFFormulaEvaluator(wb);
    for (int i=0; i < wb.getNumberOfSheets(); i++) {
      Sheet s=wb.getSheetAt(i);
      for (      Row r : s) {
        for (        Cell c : r) {
          if (c.getCellType() == Cell.CELL_TYPE_FORMULA) {
            CellValue cv=eval.evaluate(c);
            if (cv.getCellType() == Cell.CELL_TYPE_NUMERIC) {
              String formula=c.getCellFormula();
              double cachedFormulaResult=c.getNumericCellValue();
              double evaluatedFormulaResult=cv.getNumberValue();
              assertEquals(formula,cachedFormulaResult,evaluatedFormulaResult,1E-7);
            }
          }
        }
      }
    }
    XSSFFormulaEvaluator.evaluateAllFormulaCells(wb);
  }
  finally {
    wb.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFCell </h4><pre class="type-14 type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingRAttributeBug54288() throws Exception {
  XSSFWorkbook wb=(XSSFWorkbook)_testDataProvider.openSampleWorkbook("54288.xlsx");
  XSSFWorkbook wbRef=(XSSFWorkbook)_testDataProvider.openSampleWorkbook("54288-ref.xlsx");
  XSSFSheet sheet=wb.getSheetAt(0);
  XSSFSheet sheetRef=wbRef.getSheetAt(0);
  assertEquals(sheetRef.getPhysicalNumberOfRows(),sheet.getPhysicalNumberOfRows());
  DataFormatter formater=new DataFormatter();
  for (  Row r : sheetRef) {
    XSSFRow rowRef=(XSSFRow)r;
    XSSFRow row=sheet.getRow(rowRef.getRowNum());
    assertEquals("number of cells in row[" + row.getRowNum() + "]",rowRef.getPhysicalNumberOfCells(),row.getPhysicalNumberOfCells());
    for (    Cell c : rowRef) {
      XSSFCell cellRef=(XSSFCell)c;
      XSSFCell cell=row.getCell(cellRef.getColumnIndex());
      assertEquals(cellRef.getColumnIndex(),cell.getColumnIndex());
      assertEquals(cellRef.getReference(),cell.getReference());
      if (!cell.getCTCell().isSetR()) {
        assertTrue("R must e set in cellRef",cellRef.getCTCell().isSetR());
        String valRef=formater.formatCellValue(cellRef);
        String val=formater.formatCellValue(cell);
        assertEquals(valRef,val);
      }
    }
  }
  wbRef.close();
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFDataValidation </h4><pre class="type-2 type-12 type-14 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddValidations() throws Exception {
  XSSFWorkbook wb1=XSSFTestDataSamples.openSampleWorkbook("DataValidations-49244.xlsx");
  Sheet sheet=wb1.getSheetAt(0);
  List<XSSFDataValidation> dataValidations=((XSSFSheet)sheet).getDataValidations();
  assertEquals(52,dataValidations.size());
  DataValidationHelper dataValidationHelper=sheet.getDataValidationHelper();
  int[] validationTypes=new int[]{ValidationType.INTEGER,ValidationType.DECIMAL,ValidationType.TEXT_LENGTH};
  int[] singleOperandOperatorTypes=new int[]{OperatorType.LESS_THAN,OperatorType.LESS_OR_EQUAL,OperatorType.GREATER_THAN,OperatorType.GREATER_OR_EQUAL,OperatorType.EQUAL,OperatorType.NOT_EQUAL};
  int[] doubleOperandOperatorTypes=new int[]{OperatorType.BETWEEN,OperatorType.NOT_BETWEEN};
  BigDecimal value=new BigDecimal("10"), value2=new BigDecimal("20");
  BigDecimal dvalue=new BigDecimal("10.001"), dvalue2=new BigDecimal("19.999");
  final int lastRow=sheet.getLastRowNum();
  int offset=lastRow + 3;
  int lastKnownNumValidations=dataValidations.size();
  Row row=sheet.createRow(offset++);
  Cell cell=row.createCell(0);
  DataValidationConstraint explicitListValidation=dataValidationHelper.createExplicitListConstraint(new String[]{"MA","MI","CA"});
  CellRangeAddressList cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  DataValidation dataValidation=dataValidationHelper.createValidation(explicitListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  row=sheet.createRow(offset++);
  cell=row.createCell(0);
  cellRangeAddressList=new CellRangeAddressList();
  cellRangeAddressList.addCellRangeAddress(cell.getRowIndex(),cell.getColumnIndex(),cell.getRowIndex(),cell.getColumnIndex());
  Cell firstCell=row.createCell(1);
  firstCell.setCellValue("UT");
  Cell secondCell=row.createCell(2);
  secondCell.setCellValue("MN");
  Cell thirdCell=row.createCell(3);
  thirdCell.setCellValue("IL");
  int rowNum=row.getRowNum() + 1;
  String listFormula=new StringBuilder("$B$").append(rowNum).append(":").append("$D$").append(rowNum).toString();
  DataValidationConstraint formulaListValidation=dataValidationHelper.createFormulaListConstraint(listFormula);
  dataValidation=dataValidationHelper.createValidation(formulaListValidation,cellRangeAddressList);
  setOtherValidationParameters(dataValidation);
  sheet.addValidationData(dataValidation);
  lastKnownNumValidations++;
  offset++;
  offset++;
  for (int i=0; i < validationTypes.length; i++) {
    int validationType=validationTypes[i];
    offset=offset + 2;
    final Row row0=sheet.createRow(offset++);
    Cell cell_10=row0.createCell(0);
    cell_10.setCellValue(validationType == ValidationType.DECIMAL ? "Decimal " : validationType == ValidationType.INTEGER ? "Integer" : "Text Length");
    offset++;
    for (int j=0; j < singleOperandOperatorTypes.length; j++) {
      int operatorType=singleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      final Row row2=i == 0 && j < 2 ? sheet.createRow(offset++) : null;
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_22=i == 0 && j < 2 ? row2.createCell(2) : null;
      Cell cell_13=row1.createCell(3);
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value.toString(),null);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,null);
      if (i == 0 && j == 0) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else       if (i == 0 && j == 1) {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_22.getRowIndex(),cell_22.getRowIndex(),cell_22.getColumnIndex(),cell_22.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
 else {
        cellRangeAddressList=new CellRangeAddressList();
        cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
        validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
        setOtherValidationParameters(validation);
        sheet.addValidationData(validation);
        assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      }
    }
    for (int j=0; j < doubleOperandOperatorTypes.length; j++) {
      int operatorType=doubleOperandOperatorTypes[j];
      final Row row1=sheet.createRow(offset++);
      cell_10=row1.createCell(0);
      cell_10.setCellValue(XSSFDataValidation.operatorTypeMappings.get(operatorType).toString());
      Cell cell_11=row1.createCell(1);
      Cell cell_21=row1.createCell(2);
      Cell cell_13=row1.createCell(3);
      Cell cell_14=row1.createCell(4);
      String value1String=validationType == ValidationType.DECIMAL ? dvalue.toString() : value.toString();
      cell_13.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_13.setCellValue(validationType == ValidationType.DECIMAL ? dvalue.doubleValue() : value.intValue());
      String value2String=validationType == ValidationType.DECIMAL ? dvalue2.toString() : value2.toString();
      cell_14.setCellType(Cell.CELL_TYPE_NUMERIC);
      cell_14.setCellValue(validationType == ValidationType.DECIMAL ? dvalue2.doubleValue() : value2.intValue());
      DataValidationConstraint constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,value1String,value2String);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_11.getRowIndex(),cell_11.getRowIndex(),cell_11.getColumnIndex(),cell_11.getColumnIndex()));
      DataValidation validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
      String formula1=new CellReference(cell_13.getRowIndex(),cell_13.getColumnIndex()).formatAsString();
      String formula2=new CellReference(cell_14.getRowIndex(),cell_14.getColumnIndex()).formatAsString();
      constraint=dataValidationHelper.createNumericConstraint(validationType,operatorType,formula1,formula2);
      cellRangeAddressList=new CellRangeAddressList();
      cellRangeAddressList.addCellRangeAddress(new CellRangeAddress(cell_21.getRowIndex(),cell_21.getRowIndex(),cell_21.getColumnIndex(),cell_21.getColumnIndex()));
      validation=dataValidationHelper.createValidation(constraint,cellRangeAddressList);
      setOtherValidationParameters(validation);
      sheet.addValidationData(validation);
      assertEquals(++lastKnownNumValidations,((XSSFSheet)sheet).getDataValidations().size());
    }
  }
  XSSFWorkbook wb2=XSSFTestDataSamples.writeOutAndReadBack(wb1);
  wb1.close();
  Sheet sheetAt=wb2.getSheetAt(0);
  assertEquals(lastKnownNumValidations,((XSSFSheet)sheetAt).getDataValidations().size());
  wb2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFFormulaParser </h4><pre class="type-2 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A handful of functions (such as SUM, COUNTA, MIN) support
 * multi-sheet references (eg Sheet1:Sheet3!A1 = Cell A1 from
 * Sheets 1 through Sheet 3) and multi-sheet area references 
 * (eg Sheet1:Sheet3!A1:B2 = Cells A1 through B2 from Sheets
 * 1 through Sheet 3).
 * This test, based on common test files for HSSF and XSSF, checks
 * that we can read and parse these kinds of references 
 * (but not evaluate - that's elsewhere in the test suite)
 */
@Test public void multiSheetReferencesHSSFandXSSF() throws Exception {
  Workbook[] wbs=new Workbook[]{HSSFTestDataSamples.openSampleWorkbook("55906-MultiSheetRefs.xls"),XSSFTestDataSamples.openSampleWorkbook("55906-MultiSheetRefs.xlsx")};
  for (  Workbook wb : wbs) {
    Sheet s1=wb.getSheetAt(0);
    Ptg[] ptgs;
    Cell sumF=s1.getRow(2).getCell(0);
    assertNotNull(sumF);
    assertEquals("SUM(Sheet1:Sheet3!A1)",sumF.getCellFormula());
    Cell avgF=s1.getRow(2).getCell(1);
    assertNotNull(avgF);
    assertEquals("AVERAGE(Sheet1:Sheet3!A1)",avgF.getCellFormula());
    Cell countAF=s1.getRow(2).getCell(2);
    assertNotNull(countAF);
    assertEquals("COUNTA(Sheet1:Sheet3!C1)",countAF.getCellFormula());
    Cell maxF=s1.getRow(4).getCell(1);
    assertNotNull(maxF);
    assertEquals("MAX(Sheet1:Sheet3!A$1)",maxF.getCellFormula());
    Cell sumFA=s1.getRow(2).getCell(7);
    assertNotNull(sumFA);
    assertEquals("SUM(Sheet1:Sheet3!A1:B2)",sumFA.getCellFormula());
    Cell avgFA=s1.getRow(2).getCell(8);
    assertNotNull(avgFA);
    assertEquals("AVERAGE(Sheet1:Sheet3!A1:B2)",avgFA.getCellFormula());
    Cell maxFA=s1.getRow(4).getCell(8);
    assertNotNull(maxFA);
    assertEquals("MAX(Sheet1:Sheet3!A$1:B$2)",maxFA.getCellFormula());
    Cell countFA=s1.getRow(5).getCell(8);
    assertNotNull(countFA);
    assertEquals("COUNT(Sheet1:Sheet3!$A$1:$B$2)",countFA.getCellFormula());
    FormulaParsingWorkbook fpb=null;
    if (wb instanceof HSSFWorkbook)     fpb=HSSFEvaluationWorkbook.create((HSSFWorkbook)wb);
 else     fpb=XSSFEvaluationWorkbook.create((XSSFWorkbook)wb);
    ptgs=parse(fpb,"SUM(Sheet1:Sheet3!A1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A1",toFormulaString(ptgs[0],fpb));
    assertEquals(AttrPtg.class,ptgs[1].getClass());
    assertEquals("SUM",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MAX(Sheet1:Sheet3!A$1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A$1",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MAX",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MIN(Sheet1:Sheet3!$A$1)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Ref3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Ref3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!$A$1",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MIN",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"SUM(Sheet1:Sheet3!A1:B2)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Area3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Area3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!A1:B2",toFormulaString(ptgs[0],fpb));
    assertEquals(AttrPtg.class,ptgs[1].getClass());
    assertEquals("SUM",toFormulaString(ptgs[1],fpb));
    ptgs=parse(fpb,"MIN(Sheet1:Sheet3!$A$1:$B$2)");
    assertEquals(2,ptgs.length);
    if (wb instanceof HSSFWorkbook) {
      assertEquals(Area3DPtg.class,ptgs[0].getClass());
    }
 else {
      assertEquals(Area3DPxg.class,ptgs[0].getClass());
    }
    assertEquals("Sheet1:Sheet3!$A$1:$B$2",toFormulaString(ptgs[0],fpb));
    assertEquals(FuncVarPtg.class,ptgs[1].getClass());
    assertEquals("MIN",toFormulaString(ptgs[1],fpb));
    Cell newF=s1.getRow(0).createCell(10,Cell.CELL_TYPE_FORMULA);
    newF.setCellFormula("SUM(Sheet2:Sheet3!A1)");
    assertEquals("SUM(Sheet2:Sheet3!A1)",newF.getCellFormula());
    newF=s1.getRow(0).createCell(11,Cell.CELL_TYPE_FORMULA);
    newF.setCellFormula("MIN(Sheet1:Sheet2!A1:B2)");
    assertEquals("MIN(Sheet1:Sheet2!A1:B2)",newF.getCellFormula());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFPictureData </h4><pre class="type-12 type-14 type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bug 53568:  XSSFPicture.getPictureData() can return null.
 */
@Test public void test53568() throws IOException {
  XSSFWorkbook wb=XSSFTestDataSamples.openSampleWorkbook("53568.xlsx");
  List<XSSFPictureData> pictures=wb.getAllPictures();
  assertNotNull(pictures);
  assertEquals(4,pictures.size());
  XSSFSheet sheet1=wb.getSheetAt(0);
  List<XSSFShape> shapes1=sheet1.createDrawingPatriarch().getShapes();
  assertNotNull(shapes1);
  assertEquals(5,shapes1.size());
  for (int i=0; i < wb.getNumberOfSheets(); i++) {
    XSSFSheet sheet=wb.getSheetAt(i);
    XSSFDrawing drawing=sheet.createDrawingPatriarch();
    for (    XSSFShape shape : drawing.getShapes()) {
      if (shape instanceof XSSFPicture) {
        XSSFPicture pic=(XSSFPicture)shape;
        XSSFPictureData picData=pic.getPictureData();
        assertNotNull(picData);
      }
    }
  }
  wb.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.poi.xwpf.usermodel.TestXWPFBugs </h4><pre class="type-14 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void bug57312_NullPointException() throws IOException {
  XWPFDocument doc=XWPFTestDataSamples.openSampleDocument("57312.docx");
  assertNotNull(doc);
  for (  IBodyElement bodyElement : doc.getBodyElements()) {
    BodyElementType elementType=bodyElement.getElementType();
    if (elementType == BodyElementType.PARAGRAPH) {
      XWPFParagraph paragraph=(XWPFParagraph)bodyElement;
      for (      IRunElement iRunElem : paragraph.getIRuns()) {
        if (iRunElem instanceof XWPFRun) {
          XWPFRun runElement=(XWPFRun)iRunElem;
          UnderlinePatterns underline=runElement.getUnderline();
          assertNotNull(underline);
        }
      }
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
