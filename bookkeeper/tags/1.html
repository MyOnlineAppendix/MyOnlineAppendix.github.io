<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.bookkeeper.benchmark.TestBenchmark </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testBookie() throws Exception {
  BookieSocketAddress bookie=getBookie(0);
  BenchBookie.main(new String[]{"--host",bookie.getSocketAddress().getHostName(),"--port",String.valueOf(bookie.getPort()),"--zookeeper",zkUtil.getZooKeeperConnectString()});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testThroughputLatency() throws Exception {
  String latencyFile=System.getProperty("test.latency.file","latencyDump.dat");
  BenchThroughputLatency.main(new String[]{"--zookeeper",zkUtil.getZooKeeperConnectString(),"--time","10","--skipwarmup","--throttle","1","--sendlimit","10000","--latencyFile",latencyFile});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.BookieInitializationTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check disk full. Expected to throw NoWritableLedgerDirException
 * during bookie initialisation.
 */
@Test(timeout=30000) public void testWithDiskFull() throws Exception {
  File tmpDir=createTempDir("DiskCheck","test");
  long usableSpace=tmpDir.getUsableSpace();
  long totalSpace=tmpDir.getTotalSpace();
  final ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(zkUtil.getZooKeeperConnectString()).setZkTimeout(5000).setJournalDirName(tmpDir.getPath()).setLedgerDirNames(new String[]{tmpDir.getPath()});
  conf.setDiskUsageThreshold((1f - ((float)usableSpace / (float)totalSpace)) - 0.05f);
  conf.setDiskUsageWarnThreshold((1f - ((float)usableSpace / (float)totalSpace)) - 0.25f);
  try {
    new Bookie(conf);
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check disk error for file. Expected to throw DiskErrorException.
 */
@Test(timeout=30000) public void testWithDiskError() throws Exception {
  File parent=createTempDir("DiskCheck","test");
  File child=File.createTempFile("DiskCheck","test",parent);
  final ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(zkUtil.getZooKeeperConnectString()).setZkTimeout(5000).setJournalDirName(child.getPath()).setLedgerDirNames(new String[]{child.getPath()});
  try {
    LedgerDirsManager ldm=new LedgerDirsManager(conf,conf.getLedgerDirs());
    ldm.init();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.BookieJournalTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test partial index (truncate master key) with pre-v3 journals
 */
@Test(timeout=60000) public void testPartialFileInfoPreV3Journal1() throws Exception {
  testPartialFileInfoPreV3Journal(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test partial index with pre-v3 journals
 */
@Test(timeout=60000) public void testPartialFileInfoPreV3Journal2() throws Exception {
  testPartialFileInfoPreV3Journal(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test partial index (truncate master key) with post-v3 journals
 */
@Test(timeout=60000) public void testPartialFileInfoPostV3Journal1() throws Exception {
  testPartialFileInfoPostV3Journal(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test partial index with post-v3 journals
 */
@Test(timeout=60000) public void testPartialFileInfoPostV3Journal2() throws Exception {
  testPartialFileInfoPostV3Journal(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that a journal can load if only the magic word and
 * version are there.
 */
@Test(timeout=60000) public void testHeaderOnlyJournal() throws Exception {
  File journalDir=createTempDir("bookie","journal");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(journalDir));
  File ledgerDir=createTempDir("bookie","ledger");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(ledgerDir));
  writeV2Journal(Bookie.getCurrentDirectory(journalDir),0);
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(null).setJournalDirName(journalDir.getPath()).setLedgerDirNames(new String[]{ledgerDir.getPath()});
  Bookie b=new Bookie(conf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can start with an empty journal.
 * This can happen if the bookie crashes between creating the
 * journal and writing the magic word. It could also happen before
 * the magic word existed, if the bookie started but nothing was
 * ever written.
 */
@Test(timeout=60000) public void testEmptyJournal() throws Exception {
  File journalDir=createTempDir("bookie","journal");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(journalDir));
  File ledgerDir=createTempDir("bookie","ledger");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(ledgerDir));
  writePreV2Journal(Bookie.getCurrentDirectory(journalDir),0);
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(null).setJournalDirName(journalDir.getPath()).setLedgerDirNames(new String[]{ledgerDir.getPath()});
  Bookie b=new Bookie(conf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that if a journal has junk at the end, it does not load.
 * If the journal is corrupt like this, admin intervention is needed
 */
@Test(timeout=60000) public void testJunkEndedJournal() throws Exception {
  File journalDir=createTempDir("bookie","journal");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(journalDir));
  File ledgerDir=createTempDir("bookie","ledger");
  Bookie.checkDirectoryStructure(Bookie.getCurrentDirectory(ledgerDir));
  JournalChannel jc=writeV2Journal(Bookie.getCurrentDirectory(journalDir),0);
  jc.getBufferedChannel().write(ByteBuffer.wrap("JunkJunkJunk".getBytes()));
  jc.getBufferedChannel().flush(true);
  writeIndexFileForLedger(ledgerDir,1,"testPasswd".getBytes());
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(null).setJournalDirName(journalDir.getPath()).setLedgerDirNames(new String[]{ledgerDir.getPath()});
  Bookie b=null;
  try {
    b=new Bookie(conf);
  }
 catch (  Throwable t) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.BookieShutdownTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test whether Bookie can be shutdown when the call comes inside bookie thread.
 * @throws Exception
 */
@Test(timeout=60000) public void testBookieShutdownFromBookieThread() throws Exception {
  ServerConfiguration conf=bsConfs.get(0);
  killBookie(0);
  final CountDownLatch latch=new CountDownLatch(1);
  final CountDownLatch shutdownComplete=new CountDownLatch(1);
  Bookie bookie=new Bookie(conf){
    @Override public void run(){
      try {
        latch.await();
      }
 catch (      InterruptedException e) {
      }
      triggerBookieShutdown(ExitCode.BOOKIE_EXCEPTION);
    }
    @Override synchronized int shutdown(    int exitCode){
      super.shutdown(exitCode);
      shutdownComplete.countDown();
      return exitCode;
    }
  }
;
  bookie.start();
  Thread.sleep(1000);
  latch.countDown();
  shutdownComplete.await(5000,TimeUnit.MILLISECONDS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.CompactionTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that compaction should execute silently when there is no entry logs
 * to compact. {@see https://issues.apache.org/jira/browse/BOOKKEEPER-700}
 */
@Test(timeout=60000) public void testWhenNoLogsToCompact() throws Exception {
  tearDown();
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration();
  File tmpDir=createTempDir("bkTest",".dir");
  File curDir=Bookie.getCurrentDirectory(tmpDir);
  Bookie.checkDirectoryStructure(curDir);
  conf.setLedgerDirNames(new String[]{tmpDir.toString()});
  LedgerDirsManager dirs=new LedgerDirsManager(conf,conf.getLedgerDirs());
  final Set<Long> ledgers=Collections.newSetFromMap(new ConcurrentHashMap<Long,Boolean>());
  LedgerManager manager=getLedgerManager(ledgers);
  CheckpointSource checkpointSource=new CheckpointSource(){
    @Override public Checkpoint newCheckpoint(){
      return null;
    }
    @Override public void checkpointComplete(    Checkpoint checkpoint,    boolean compact) throws IOException {
    }
  }
;
  InterleavedLedgerStorage storage=new InterleavedLedgerStorage(conf,manager,dirs,checkpointSource);
  double threshold=0.1;
  storage.gcThread.doCompactEntryLogs(threshold);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.CookieTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test delete cookie.
 */
@Test(timeout=60000) public void testDeleteFromZooKeeper() throws Exception {
  String[] ledgerDirs=new String[]{newDirectory(),newDirectory(),newDirectory()};
  String journalDir=newDirectory();
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(zkUtil.getZooKeeperConnectString()).setJournalDirName(journalDir).setLedgerDirNames(ledgerDirs).setBookiePort(bookiePort);
  Bookie b=new Bookie(conf);
  b.start();
  b.shutdown();
  Versioned<Cookie> zkCookie=Cookie.readFromZooKeeper(zkc,conf);
  Cookie cookie=zkCookie.getValue();
  cookie.deleteFromZooKeeper(zkc,conf,zkCookie.getVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.IndexPersistenceMgrTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testEvictFileInfoWhenUnderlyingFileExists() throws Exception {
  evictFileInfoTest(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testEvictFileInfoWhenUnderlyingFileDoesntExist() throws Exception {
  evictFileInfoTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.UpdateCookieCmdTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * updatecookie to hostname
 */
@Test public void testDuplicateUpdateCookieIpAddress() throws Exception {
  String[] argv=new String[]{"updatecookie","-b","ip"};
  final ServerConfiguration conf=bsConfs.get(0);
  conf.setUseHostNameAsBookieID(true);
  updateCookie(argv,-1,conf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * updatecookie to hostname
 */
@Test public void testUpdateCookieIpAddressToHostname() throws Exception {
  updateCookie("-bookieId","hostname",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * updatecookie to ipaddress
 */
@Test public void testUpdateCookieHostnameToIpAddress() throws Exception {
  updateCookie("-bookieId","hostname",true);
  updateCookie("-b","ip",false);
  ServerConfiguration conf=bsConfs.get(0);
  BookieServer restartBookie=startBookie(conf);
  restartBookie.shutdown();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * updatecookie to invalid bookie id
 */
@Test public void testUpdateCookieWithInvalidOption() throws Exception {
  String[] argv=new String[]{"updatecookie","-b","invalidBookieID"};
  final ServerConfiguration conf=bsConfs.get(0);
  updateCookie(argv,-1,conf);
  argv=new String[]{"updatecookie","-b"};
  updateCookie(argv,-1,conf);
  argv=new String[]{"updatecookie"};
  updateCookie(argv,-1,conf);
  argv=new String[]{"updatecookie","-b","hostname"};
  conf.setUseHostNameAsBookieID(false);
  updateCookie(argv,-1,conf);
  argv=new String[]{"updatecookie","-b","ip"};
  conf.setUseHostNameAsBookieID(true);
  updateCookie(argv,-1,conf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.bookie.UpgradeTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testUpgradeV2toCurrent() throws Exception {
  File journalDir=newV2JournalDirectory();
  tmpDirs.add(journalDir);
  File ledgerDir=newV2LedgerDirectory();
  tmpDirs.add(ledgerDir);
  testUpgradeProceedure(zkUtil.getZooKeeperConnectString(),journalDir.getPath(),ledgerDir.getPath());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testUpgradeV1toCurrent() throws Exception {
  File journalDir=newV1JournalDirectory();
  tmpDirs.add(journalDir);
  File ledgerDir=newV1LedgerDirectory();
  tmpDirs.add(ledgerDir);
  testUpgradeProceedure(zkUtil.getZooKeeperConnectString(),journalDir.getPath(),ledgerDir.getPath());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testUpgradeCurrent() throws Exception {
  File journalDir=newV2JournalDirectory();
  tmpDirs.add(journalDir);
  File ledgerDir=newV2LedgerDirectory();
  tmpDirs.add(ledgerDir);
  testUpgradeProceedure(zkUtil.getZooKeeperConnectString(),journalDir.getPath(),ledgerDir.getPath());
  ServerConfiguration conf=TestBKConfiguration.newServerConfiguration().setZkServers(zkUtil.getZooKeeperConnectString()).setJournalDirName(journalDir.getPath()).setLedgerDirNames(new String[]{ledgerDir.getPath()}).setBookiePort(bookiePort);
  FileSystemUpgrade.upgrade(conf);
  Bookie b=new Bookie(conf);
  b.start();
  b.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.BookKeeperClientZKSessionExpiry </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSessionLossWhileWriting() throws Exception {
  Thread expiryThread=new Thread(){
    @Override public void run(){
      try {
        while (true) {
          Thread.sleep(5000);
          long sessionId=bkc.getZkHandle().getSessionId();
          byte[] sessionPasswd=bkc.getZkHandle().getSessionPasswd();
          try {
            ZooKeeperWatcherBase watcher=new ZooKeeperWatcherBase(10000);
            ZooKeeper zk=new ZooKeeper(zkUtil.getZooKeeperConnectString(),10000,watcher,sessionId,sessionPasswd);
            zk.close();
          }
 catch (          Exception e) {
            LOG.info("Error killing session",e);
          }
        }
      }
 catch (      InterruptedException ie) {
        return;
      }
    }
  }
;
  expiryThread.start();
  for (int i=0; i < 3; i++) {
    LedgerHandle lh=bkc.createLedger(3,3,2,BookKeeper.DigestType.MAC,"foobar".getBytes());
    for (int j=0; j < 100; j++) {
      lh.asyncAddEntry("foobar".getBytes(),new AddCallbackFuture(j),null);
    }
    startNewBookie();
    killBookie(0);
    lh.addEntry("lastEntry".getBytes());
    lh.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.BookKeeperTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConstructionZkDelay() throws Exception {
  ClientConfiguration conf=new ClientConfiguration().setZkServers(zkUtil.getZooKeeperConnectString()).setZkTimeout(20000);
  CountDownLatch l=new CountDownLatch(1);
  zkUtil.sleepServer(5,l);
  l.await();
  BookKeeper bkc=new BookKeeper(conf);
  bkc.createLedger(digestType,"testPasswd".getBytes()).close();
  bkc.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.BookieRecoveryTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This tests the synchronous bookie recovery functionality by writing
 * entries into 3 bookies, killing one bookie, starting up a few new
 * bookies, and then recovering the ledger entries from the killed bookie
 * onto random available bookie servers. We'll verify that the entries
 * stored on the killed bookie are properly copied over and restored onto
 * the other bookies.
 * @throws Exception
 */
@Test(timeout=60000) public void testSyncBookieRecoveryToRandomBookies() throws Exception {
  int numLedgers=3;
  List<LedgerHandle> lhs=createLedgers(numLedgers);
  int numMsgs=10;
  writeEntriestoLedgers(numMsgs,0,lhs);
  LOG.info("Finished writing all ledger entries so shutdown one of the bookies.");
  int initialPort=bsConfs.get(0).getBookiePort();
  bs.get(0).shutdown();
  bs.remove(0);
  for (int i=0; i < 3; i++) {
    startNewBookie();
  }
  writeEntriestoLedgers(numMsgs,10,lhs);
  BookieSocketAddress bookieSrc=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),initialPort);
  BookieSocketAddress bookieDest=null;
  LOG.info("Now recover the data on the killed bookie (" + bookieSrc + ") and replicate it to a random available one");
  bkAdmin.recoverBookieData(bookieSrc,bookieDest);
  verifyRecoveredLedgers(lhs,0,2 * numMsgs - 1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This tests the synchronous bookie recovery functionality by writing
 * entries into 3 bookies, killing one bookie, starting up a new one to
 * replace it, and then recovering the ledger entries from the killed bookie
 * onto the new one. We'll verify that the entries stored on the killed
 * bookie are properly copied over and restored onto the new one.
 * @throws Exception
 */
@Test(timeout=60000) public void testSyncBookieRecoveryToSpecificBookie() throws Exception {
  int numLedgers=3;
  List<LedgerHandle> lhs=createLedgers(numLedgers);
  int numMsgs=10;
  writeEntriestoLedgers(numMsgs,0,lhs);
  LOG.info("Finished writing all ledger entries so shutdown one of the bookies.");
  int initialPort=bsConfs.get(0).getBookiePort();
  bs.get(0).shutdown();
  bs.remove(0);
  int newBookiePort=startNewBookie();
  writeEntriestoLedgers(numMsgs,10,lhs);
  BookieSocketAddress bookieSrc=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),initialPort);
  BookieSocketAddress bookieDest=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),newBookiePort);
  LOG.info("Now recover the data on the killed bookie (" + bookieSrc + ") and replicate it to the new one ("+ bookieDest+ ")");
  bkAdmin.recoverBookieData(bookieSrc,bookieDest);
  verifyRecoveredLedgers(lhs,0,2 * numMsgs - 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.BookieWriteLedgerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify write when few bookie failures in last ensemble and forcing
 * ensemble reformation
 */
@Test(timeout=60000) public void testWithMultipleBookieFailuresInLastEnsemble() throws Exception {
  lh=bkc.createLedger(5,4,digestType,ledgerPassword);
  LOG.info("Ledger ID: " + lh.getId());
  for (int i=0; i < numEntriesToWrite; i++) {
    ByteBuffer entry=ByteBuffer.allocate(4);
    entry.putInt(rng.nextInt(maxInt));
    entry.position(0);
    entries1.add(entry.array());
    lh.addEntry(entry.array());
  }
  startNewBookie();
  startNewBookie();
  startNewBookie();
  ArrayList<BookieSocketAddress> ensemble=lh.getLedgerMetadata().getEnsembles().entrySet().iterator().next().getValue();
  killBookie(ensemble.get(0));
  killBookie(ensemble.get(1));
  killBookie(ensemble.get(2));
  int i=numEntriesToWrite;
  numEntriesToWrite=numEntriesToWrite + 50;
  for (; i < numEntriesToWrite; i++) {
    ByteBuffer entry=ByteBuffer.allocate(4);
    entry.putInt(rng.nextInt(maxInt));
    entry.position(0);
    entries1.add(entry.array());
    lh.addEntry(entry.array());
  }
  readEntries(lh,entries1);
  lh.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify the functionality of Advanced Ledger which returns
 * LedgerHandleAdv. LedgerHandleAdv takes entryId for addEntry, and let
 * user manage entryId allocation.
 * @throws Exception
 */
@Test(timeout=60000) public void testLedgerCreateAdv() throws Exception {
  lh=bkc.createLedgerAdv(5,3,2,digestType,ledgerPassword);
  for (int i=0; i < numEntriesToWrite; i++) {
    ByteBuffer entry=ByteBuffer.allocate(4);
    entry.putInt(rng.nextInt(maxInt));
    entry.position(0);
    entries1.add(entry.array());
    lh.addEntry(i,entry.array());
  }
  startNewBookie();
  ArrayList<BookieSocketAddress> ensemble=lh.getLedgerMetadata().getEnsembles().entrySet().iterator().next().getValue();
  killBookie(ensemble.get(0));
  int i=numEntriesToWrite;
  numEntriesToWrite=numEntriesToWrite + 50;
  for (; i < numEntriesToWrite; i++) {
    ByteBuffer entry=ByteBuffer.allocate(4);
    entry.putInt(rng.nextInt(maxInt));
    entry.position(0);
    entries1.add(entry.array());
    lh.addEntry(i,entry.array());
  }
  readEntries(lh,entries1);
  lh.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.LedgerCloseTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testLedgerCloseDuringUnrecoverableErrors() throws Exception {
  int numEntries=3;
  LedgerHandle lh=bkc.createLedger(3,3,3,digestType,"".getBytes());
  verifyMetadataConsistency(numEntries,lh);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.LedgerRecoveryTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testLedgerRecoveryWithSlowBookie() throws Exception {
  for (int i=0; i < 3; i++) {
    LOG.info("TestLedgerRecoveryWithAckQuorum @ slow bookie {}",i);
    ledgerRecoveryWithSlowBookie(3,3,2,1,i);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testLedgerRecovery() throws Exception {
  testInternal(100);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testEmptyLedgerRecoveryOne() throws Exception {
  testInternal(1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testEmptyLedgerRecovery() throws Exception {
  testInternal(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.TestBookieWatcher </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testBookieWatcherDieWhenSessionExpired() throws Exception {
  final int timeout=2000;
  final CountDownLatch connectLatch=new CountDownLatch(1);
  ZooKeeper zk=new ZooKeeper(zkUtil.getZooKeeperConnectString(),timeout,new Watcher(){
    @Override public void process(    WatchedEvent watchedEvent){
      if (EventType.None == watchedEvent.getType() && KeeperState.SyncConnected == watchedEvent.getState()) {
        connectLatch.countDown();
      }
    }
  }
);
  connectLatch.await();
  try {
    runBookieWatcherWhenSessionExpired(zk,timeout,false);
  }
  finally {
    zk.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testBookieWatcherSurviveWhenSessionExpired() throws Exception {
  final int timeout=2000;
  ZooKeeper zk=ZooKeeperClient.newBuilder().connectString(zkUtil.getZooKeeperConnectString()).sessionTimeoutMs(timeout).build();
  try {
    runBookieWatcherWhenSessionExpired(zk,timeout,true);
  }
  finally {
    zk.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.TestLedgerFragmentReplication </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that splitIntoSubFragment should be able to split the original
 * passed fragment into sub fragments at correct boundaries
 */
@Test(timeout=30000) public void testSplitIntoSubFragmentsWithDifferentFragmentBoundaries() throws Exception {
  LedgerMetadata metadata=new LedgerMetadata(3,3,3,TEST_DIGEST_TYPE,TEST_PSSWD){
    @Override ArrayList<BookieSocketAddress> getEnsemble(    long entryId){
      return null;
    }
    @Override public boolean isClosed(){
      return true;
    }
  }
;
  LedgerHandle lh=new LedgerHandle(bkc,0,metadata,TEST_DIGEST_TYPE,TEST_PSSWD);
  testSplitIntoSubFragments(10,21,-1,1,lh);
  testSplitIntoSubFragments(10,21,20,1,lh);
  testSplitIntoSubFragments(0,0,10,1,lh);
  testSplitIntoSubFragments(0,1,1,2,lh);
  testSplitIntoSubFragments(20,24,2,3,lh);
  testSplitIntoSubFragments(21,32,3,4,lh);
  testSplitIntoSubFragments(22,103,11,8,lh);
  testSplitIntoSubFragments(49,51,1,3,lh);
  testSplitIntoSubFragments(11,101,3,31,lh);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that ReplicateLedgerFragment should return false if replication
 * fails
 */
@Test(timeout=60000) public void testReplicateLFShouldReturnFalseIfTheReplicationFails() throws Exception {
  byte[] data="TestLedgerFragmentReplication".getBytes();
  LedgerHandle lh=bkc.createLedger(2,1,TEST_DIGEST_TYPE,TEST_PSSWD);
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  BookieSocketAddress replicaToKill=lh.getLedgerMetadata().getEnsembles().get(0L).get(0);
  killBookie(replicaToKill);
  LOG.info("Killed Bookie =" + replicaToKill);
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  replicaToKill=lh.getLedgerMetadata().getEnsembles().get(0L).get(0);
  killBookie(replicaToKill);
  LOG.info("Killed Bookie =" + replicaToKill);
  Set<LedgerFragment> fragments=getFragmentsToReplicate(lh);
  BookKeeperAdmin admin=new BookKeeperAdmin(baseClientConf);
  int startNewBookie=startNewBookie();
  BookieSocketAddress additionalBK=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),startNewBookie);
  for (  LedgerFragment lf : fragments) {
    try {
      admin.replicateLedgerFragment(lh,lf,additionalBK);
    }
 catch (    BKException.BKLedgerRecoveryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that replicate method should replicate the failed bookie fragments
 * to target bookie passed.
 */
@Test(timeout=60000) public void testReplicateLFShouldCopyFailedBookieFragmentsToTargetBookie() throws Exception {
  byte[] data="TestLedgerFragmentReplication".getBytes();
  LedgerHandle lh=bkc.createLedger(3,3,TEST_DIGEST_TYPE,TEST_PSSWD);
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  BookieSocketAddress replicaToKill=lh.getLedgerMetadata().getEnsembles().get(0L).get(0);
  LOG.info("Killing Bookie",replicaToKill);
  killBookie(replicaToKill);
  int startNewBookie=startNewBookie();
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  BookieSocketAddress newBkAddr=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),startNewBookie);
  LOG.info("New Bookie addr :" + newBkAddr);
  Set<LedgerFragment> result=getFragmentsToReplicate(lh);
  BookKeeperAdmin admin=new BookKeeperAdmin(baseClientConf);
  lh.close();
  for (  LedgerFragment lf : result) {
    admin.replicateLedgerFragment(lh,lf,newBkAddr);
  }
  SortedMap<Long,ArrayList<BookieSocketAddress>> allBookiesBeforeReplication=lh.getLedgerMetadata().getEnsembles();
  Set<Entry<Long,ArrayList<BookieSocketAddress>>> entrySet=allBookiesBeforeReplication.entrySet();
  for (  Entry<Long,ArrayList<BookieSocketAddress>> entry : entrySet) {
    ArrayList<BookieSocketAddress> bookies=entry.getValue();
    for (    BookieSocketAddress bookie : bookies) {
      if (newBkAddr.equals(bookie)) {
        continue;
      }
      killBookie(bookie);
    }
  }
  verifyRecoveredLedgers(lh,0,9);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.TestRackawareEnsemblePlacementPolicy </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for BOOKKEEPER-633
 */
@Test(timeout=60000) public void testRemoveBookieFromCluster(){
  BookieSocketAddress addr1=new BookieSocketAddress("127.0.0.1",3181);
  BookieSocketAddress addr2=new BookieSocketAddress("127.0.0.2",3181);
  BookieSocketAddress addr3=new BookieSocketAddress("127.0.0.3",3181);
  BookieSocketAddress addr4=new BookieSocketAddress("127.0.0.4",3181);
  StaticDNSResolver.addNodeToRack(addr1.getSocketAddress().getAddress().getHostAddress(),NetworkTopology.DEFAULT_RACK);
  StaticDNSResolver.addNodeToRack(addr2.getSocketAddress().getAddress().getHostAddress(),"/r2");
  StaticDNSResolver.addNodeToRack(addr3.getSocketAddress().getAddress().getHostAddress(),"/r2");
  StaticDNSResolver.addNodeToRack(addr4.getSocketAddress().getAddress().getHostAddress(),"/r3");
  Set<BookieSocketAddress> addrs=new HashSet<BookieSocketAddress>();
  addrs.add(addr1);
  addrs.add(addr2);
  addrs.add(addr3);
  addrs.add(addr4);
  repp.onClusterChanged(addrs,new HashSet<BookieSocketAddress>());
  addrs.remove(addr1);
  repp.onClusterChanged(addrs,new HashSet<BookieSocketAddress>());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.client.TestSpeculativeRead </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test basic speculative functionality.
 * - Create 2 clients with read timeout disabled, one with spec
 * read enabled, the other not.
 * - create ledger
 * - sleep second bookie in ensemble
 * - read first entry, both should find on first bookie.
 * - read second bookie, spec client should find on bookie three,
 * non spec client should hang.
 */
@Test(timeout=60000) public void testSpeculativeRead() throws Exception {
  long id=getLedgerToRead(3,2);
  BookKeeper bknospec=createClient(0);
  BookKeeper bkspec=createClient(2000);
  LedgerHandle lnospec=bknospec.openLedger(id,digestType,passwd);
  LedgerHandle lspec=bkspec.openLedger(id,digestType,passwd);
  CountDownLatch sleepLatch=new CountDownLatch(1);
  BookieSocketAddress second=lnospec.getLedgerMetadata().getEnsembles().get(0L).get(1);
  sleepBookie(second,sleepLatch);
  try {
    LatchCallback nospeccb=new LatchCallback();
    LatchCallback speccb=new LatchCallback();
    lnospec.asyncReadEntries(0,0,nospeccb,null);
    lspec.asyncReadEntries(0,0,speccb,null);
    nospeccb.expectSuccess(2000);
    speccb.expectSuccess(2000);
    nospeccb=new LatchCallback();
    speccb=new LatchCallback();
    lnospec.asyncReadEntries(1,1,nospeccb,null);
    lspec.asyncReadEntries(1,1,speccb,null);
    speccb.expectSuccess(4000);
    nospeccb.expectTimeout(4000);
  }
  finally {
    sleepLatch.countDown();
    lspec.close();
    lnospec.close();
    bkspec.close();
    bknospec.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that if after a speculative read is kicked off, the original read completes
 * nothing bad happens.
 */
@Test(timeout=60000) public void testSpeculativeReadFirstReadCompleteIsOk() throws Exception {
  long id=getLedgerToRead(2,2);
  int timeout=1000;
  BookKeeper bkspec=createClient(timeout);
  LedgerHandle l=bkspec.openLedger(id,digestType,passwd);
  CountDownLatch sleepLatch0=new CountDownLatch(1);
  CountDownLatch sleepLatch1=new CountDownLatch(1);
  sleepBookie(l.getLedgerMetadata().getEnsembles().get(0L).get(0),sleepLatch0);
  sleepBookie(l.getLedgerMetadata().getEnsembles().get(0L).get(1),sleepLatch1);
  try {
    LatchCallback latch0=new LatchCallback();
    l.asyncReadEntries(0,0,latch0,null);
    latch0.expectTimeout(timeout);
    sleepLatch0.countDown();
    latch0.expectSuccess(timeout / 2);
    sleepLatch1.countDown();
    LatchCallback latch1=new LatchCallback();
    l.asyncReadEntries(1,1,latch1,null);
    latch1.expectSuccess(timeout / 2);
  }
  finally {
    sleepLatch0.countDown();
    sleepLatch1.countDown();
    l.close();
    bkspec.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.proto.TestPerChannelBookieClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test race scenario found in {@link https://issues.apache.org/jira/browse/BOOKKEEPER-5}where multiple clients try to connect a channel simultaneously. If not synchronised
 * correctly, this causes the netty channel to get orphaned.
 */
@Test(timeout=60000) public void testConnectRace() throws Exception {
  GenericCallback<PerChannelBookieClient> nullop=new GenericCallback<PerChannelBookieClient>(){
    @Override public void operationComplete(    int rc,    PerChannelBookieClient pcbc){
    }
  }
;
  ClientSocketChannelFactory channelFactory=new NioClientSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool());
  OrderedSafeExecutor executor=getOrderedSafeExecutor();
  BookieSocketAddress addr=getBookie(0);
  for (int i=0; i < 100; i++) {
    PerChannelBookieClient client=new PerChannelBookieClient(executor,channelFactory,addr);
    for (int j=i; j < 10; j++) {
      client.connectIfNeededAndDoOp(nullop);
    }
    client.close();
  }
  channelFactory.releaseExternalResources();
  executor.shutdown();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that a race does not exist between connection completion
 * and client closure. If a race does exist, this test will simply
 * hang at releaseExternalResources() as it is uninterruptible.
 * This specific race was found in{@link https://issues.apache.org/jira/browse/BOOKKEEPER-485}.
 */
@Test(timeout=60000) public void testConnectCloseRace() throws Exception {
  ClientSocketChannelFactory channelFactory=new NioClientSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool());
  OrderedSafeExecutor executor=getOrderedSafeExecutor();
  BookieSocketAddress addr=getBookie(0);
  for (int i=0; i < 1000; i++) {
    PerChannelBookieClient client=new PerChannelBookieClient(executor,channelFactory,addr);
    client.connectIfNeededAndDoOp(new GenericCallback<PerChannelBookieClient>(){
      @Override public void operationComplete(      int rc,      PerChannelBookieClient client){
      }
    }
);
    client.close();
  }
  channelFactory.releaseExternalResources();
  executor.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.replication.AuditorLedgerCheckerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test once published under replicated ledger should exists even after
 * restarting respective bookie
 */
@Test(timeout=60000) public void testRestartBookie() throws Exception {
  LedgerHandle lh1=createAndAddEntriesToLedger();
  LedgerHandle lh2=createAndAddEntriesToLedger();
  LOG.debug("Created following ledgers : {}, {}",lh1,lh2);
  int bkShutdownIndex=bs.size() - 1;
  ServerConfiguration bookieConf1=bsConfs.get(bkShutdownIndex);
  String shutdownBookie=shutdownBookie(bkShutdownIndex);
  bs.add(startBookie(bookieConf1));
  waitForLedgerMissingReplicas(lh1.getId(),10,shutdownBookie);
  waitForLedgerMissingReplicas(lh2.getId(),10,shutdownBookie);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.replication.TestLedgerUnderreplicationManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test verifies failures of bookies which are resembling each other.
 * BK servers named like
 * 1.cluster.com, 2.cluster.com, 11.cluster.com, 12.cluster.com
 * *
 * BKserver IP:HOST like
 * localhost:3181, localhost:318, localhost:31812
 * *
 */
@Test(timeout=60000) public void testMarkSimilarMissingReplica() throws Exception {
  List<String> missingReplica=new ArrayList<String>();
  missingReplica.add("localhost:3181");
  missingReplica.add("localhost:318");
  missingReplica.add("localhost:31812");
  missingReplica.add("1.cluster.com");
  missingReplica.add("2.cluster.com");
  missingReplica.add("11.cluster.com");
  missingReplica.add("12.cluster.com");
  verifyMarkLedgerUnderreplicated(missingReplica);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test multiple bookie failures for a ledger and marked as underreplicated
 * one after another.
 */
@Test(timeout=60000) public void testManyFailuresInAnEnsemble() throws Exception {
  List<String> missingReplica=new ArrayList<String>();
  missingReplica.add("localhost:3181");
  missingReplica.add("localhost:3182");
  verifyMarkLedgerUnderreplicated(missingReplica);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that multiple LedgerUnderreplicationManagers should be able to take
 * lock and release for same ledger
 */
@Test(timeout=30000) public void testMultipleManagersShouldBeAbleToTakeAndReleaseLock() throws Exception {
  String missingReplica1="localhost:3181";
  final LedgerUnderreplicationManager m1=lmf1.newLedgerUnderreplicationManager();
  final LedgerUnderreplicationManager m2=lmf2.newLedgerUnderreplicationManager();
  Long ledgerA=0xfeadeefdacL;
  m1.markLedgerUnderreplicated(ledgerA,missingReplica1);
  final int iterationCount=100;
  final CountDownLatch latch1=new CountDownLatch(iterationCount);
  final CountDownLatch latch2=new CountDownLatch(iterationCount);
  Thread thread1=new Thread(){
    @Override public void run(){
      takeLedgerAndRelease(m1,latch1,iterationCount);
    }
  }
;
  Thread thread2=new Thread(){
    @Override public void run(){
      takeLedgerAndRelease(m2,latch2,iterationCount);
    }
  }
;
  thread1.start();
  thread2.start();
  while (!latch1.await(50,TimeUnit.MILLISECONDS) && !latch2.await(50,TimeUnit.MILLISECONDS)) {
    Thread.sleep(50);
  }
  m1.close();
  m2.close();
  latch1.await();
  latch2.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.replication.TestReplicationWorker </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testMultipleLedgerReplicationWithReplicationWorker() throws Exception {
  LedgerHandle lh1=bkc.createLedger(3,3,BookKeeper.DigestType.CRC32,TESTPASSWD);
  for (int i=0; i < 10; i++) {
    lh1.addEntry(data);
  }
  BookieSocketAddress replicaToKillFromFirstLedger=LedgerHandleAdapter.getLedgerMetadata(lh1).getEnsembles().get(0L).get(0);
  LOG.info("Killing Bookie",replicaToKillFromFirstLedger);
  LedgerHandle lh2=bkc.createLedger(3,3,BookKeeper.DigestType.CRC32,TESTPASSWD);
  for (int i=0; i < 10; i++) {
    lh2.addEntry(data);
  }
  BookieSocketAddress replicaToKillFromSecondLedger=LedgerHandleAdapter.getLedgerMetadata(lh2).getEnsembles().get(0L).get(0);
  LOG.info("Killing Bookie",replicaToKillFromSecondLedger);
  killBookie(replicaToKillFromFirstLedger);
  lh1.close();
  killBookie(replicaToKillFromFirstLedger);
  lh2.close();
  int startNewBookie=startNewBookie();
  BookieSocketAddress newBkAddr=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),startNewBookie);
  LOG.info("New Bookie addr :" + newBkAddr);
  ReplicationWorker rw=new ReplicationWorker(zkc,baseConf,newBkAddr);
  rw.start();
  try {
    underReplicationManager.markLedgerUnderreplicated(lh1.getId(),replicaToKillFromFirstLedger.toString());
    underReplicationManager.markLedgerUnderreplicated(lh2.getId(),replicaToKillFromSecondLedger.toString());
    while (ReplicationTestUtil.isLedgerInUnderReplication(zkc,lh1.getId(),basePath)) {
      Thread.sleep(100);
    }
    while (ReplicationTestUtil.isLedgerInUnderReplication(zkc,lh2.getId(),basePath)) {
      Thread.sleep(100);
    }
    killAllBookies(lh1,newBkAddr);
    verifyRecoveredLedgers(lh1,0,9);
    verifyRecoveredLedgers(lh2,0,9);
  }
  finally {
    rw.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that replication worker should replicate the failed bookie
 * fragments to target bookie given to the worker.
 */
@Test(timeout=30000) public void testRWShouldReplicateFragmentsToTargetBookie() throws Exception {
  LedgerHandle lh=bkc.createLedger(3,3,BookKeeper.DigestType.CRC32,TESTPASSWD);
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  BookieSocketAddress replicaToKill=LedgerHandleAdapter.getLedgerMetadata(lh).getEnsembles().get(0L).get(0);
  LOG.info("Killing Bookie",replicaToKill);
  killBookie(replicaToKill);
  int startNewBookie=startNewBookie();
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  BookieSocketAddress newBkAddr=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),startNewBookie);
  LOG.info("New Bookie addr :" + newBkAddr);
  ReplicationWorker rw=new ReplicationWorker(zkc,baseConf,newBkAddr);
  rw.start();
  try {
    underReplicationManager.markLedgerUnderreplicated(lh.getId(),replicaToKill.toString());
    while (ReplicationTestUtil.isLedgerInUnderReplication(zkc,lh.getId(),basePath)) {
      Thread.sleep(100);
    }
    killAllBookies(lh,newBkAddr);
    verifyRecoveredLedgers(lh,0,9);
  }
  finally {
    rw.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that Replication worker should clean the leadger under replication
 * node of the ledger already deleted
 */
@Test(timeout=3000) public void testRWShouldCleanTheLedgerFromUnderReplicationIfLedgerAlreadyDeleted() throws Exception {
  LedgerHandle lh=bkc.createLedger(2,2,BookKeeper.DigestType.CRC32,TESTPASSWD);
  for (int i=0; i < 10; i++) {
    lh.addEntry(data);
  }
  lh.close();
  BookieSocketAddress replicaToKill=LedgerHandleAdapter.getLedgerMetadata(lh).getEnsembles().get(0L).get(0);
  LOG.info("Killing Bookie",replicaToKill);
  killBookie(replicaToKill);
  int startNewBookie=startNewBookie();
  BookieSocketAddress newBkAddr=new BookieSocketAddress(InetAddress.getLocalHost().getHostAddress(),startNewBookie);
  LOG.info("New Bookie addr :" + newBkAddr);
  ReplicationWorker rw=new ReplicationWorker(zkc,baseConf,newBkAddr);
  rw.start();
  try {
    bkc.deleteLedger(lh.getId());
    underReplicationManager.markLedgerUnderreplicated(lh.getId(),replicaToKill.toString());
    while (ReplicationTestUtil.isLedgerInUnderReplication(zkc,lh.getId(),basePath)) {
      Thread.sleep(100);
    }
  }
  finally {
    rw.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.BookieFailureTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests writes and reads when a bookie fails.
 * @throws {@link IOException}
 */
@Test(timeout=60000) public void testAsyncBK1() throws IOException {
  LOG.info("#### BK1 ####");
  auxTestReadWriteAsyncSingleClient(bs.get(0));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testAsyncBK2() throws IOException {
  LOG.info("#### BK2 ####");
  auxTestReadWriteAsyncSingleClient(bs.get(1));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testAsyncBK3() throws IOException {
  LOG.info("#### BK3 ####");
  auxTestReadWriteAsyncSingleClient(bs.get(2));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testAsyncBK4() throws IOException {
  LOG.info("#### BK4 ####");
  auxTestReadWriteAsyncSingleClient(bs.get(3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.BookieJournalRollingTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This test writes enough ledger entries to roll over the journals
 * without sync up
 * @throws Exception
 */
@Test(timeout=60000) public void testJournalRollingWithoutSyncup() throws Exception {
  if (LOG.isDebugEnabled()) {
    LOG.debug("Testing Journal Rolling without sync up");
  }
  ServerConfiguration newConf=TestBKConfiguration.newServerConfiguration();
  newConf.setFlushInterval(999999999);
  restartBookies(newConf);
  LedgerHandle[] lhs=writeLedgerEntries(4,1024,1024);
  long[] ledgerIds=new long[lhs.length];
  for (int i=0; i < lhs.length; i++) {
    ledgerIds[i]=lhs[i].getId();
    lhs[i].close();
  }
  restartBookies(newConf);
  validLedgerEntries(ledgerIds,1024,1024);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This test writes enough ledger entries to roll over the journals
 * without sync up
 * @throws Exception
 */
@Test(timeout=60000) public void testReplayDeletedLedgerJournalEntries() throws Exception {
  if (LOG.isDebugEnabled()) {
    LOG.debug("Testing replaying journal entries whose ledger has been removed.");
  }
  LedgerHandle[] lhs=writeLedgerEntries(1,1024,10);
  Thread.sleep(3 * baseConf.getFlushInterval());
  ServerConfiguration newConf=TestBKConfiguration.newServerConfiguration();
  newConf.setFlushInterval(999999999);
  restartBookies(newConf);
  writeLedgerEntries(lhs,1024,10);
  for (  LedgerHandle lh : lhs) {
    bkc.deleteLedger(lh.getId());
  }
  Thread.sleep(2 * newConf.getGcWaitTime());
  restartBookies(newConf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.BookieReadWriteTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadWriteAsyncSingleClient200() throws IOException {
  testReadWriteAsyncSingleClient(200);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.CloseTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCloseByOthers() throws Exception {
  int numLedgers=1;
  int numMsgs=10;
  LedgerHandle lh=bkc.createLedger(digestType,"".getBytes());
  String tmp="BookKeeper is cool!";
  for (int i=0; i < numMsgs; i++) {
    lh.addEntry(tmp.getBytes());
  }
  LedgerHandle lh2=bkc.openLedger(lh.getId(),digestType,"".getBytes());
  lh2.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testClose() throws Exception {
  int numLedgers=4;
  int numMsgs=100;
  LedgerHandle[] lh=new LedgerHandle[numLedgers];
  for (int i=0; i < numLedgers; i++) {
    lh[i]=bkc.createLedger(digestType,"".getBytes());
  }
  String tmp="BookKeeper is cool!";
  for (int i=0; i < numMsgs; i++) {
    for (int j=0; j < numLedgers; j++) {
      lh[j].addEntry(tmp.getBytes());
    }
  }
  for (int i=0; i < numLedgers; i++) {
    lh[i].close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.ConcurrentLedgerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testConcurrentWrite() throws IOException, InterruptedException, BookieException {
  int size=1024;
  int totalwrites=128;
  if (System.getProperty("totalwrites") != null) {
    totalwrites=Integer.parseInt(System.getProperty("totalwrites"));
  }
  LOG.info("Running up to " + iterations + " iterations");
  LOG.info("Total writes = " + totalwrites);
  int ledgers;
  for (ledgers=1; ledgers <= iterations; ledgers+=iterationStep) {
    long duration=doWrites(ledgers,size,totalwrites);
    LOG.info(totalwrites + " on " + ledgers+ " took "+ duration+ " ms");
  }
  LOG.info("ledgers " + ledgers);
  for (ledgers=1; ledgers <= iterations; ledgers+=iterationStep) {
    long duration=doReads(ledgers,size,totalwrites);
    LOG.info(ledgers + " read " + duration+ " ms");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.LedgerCreateDeleteTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCreateDeleteLedgers() throws Exception {
  int numLedgers=3;
  ArrayList<Long> ledgers=new ArrayList<Long>();
  for (int i=0; i < numLedgers; i++) {
    LedgerHandle lh=bkc.createLedger(1,1,DigestType.CRC32,"bk is cool".getBytes());
    for (int j=0; j < 5; j++) {
      lh.addEntry("just test".getBytes());
    }
    ledgers.add(lh.getId());
    lh.close();
  }
  for (  long ledgerId : ledgers) {
    bkc.deleteLedger(ledgerId);
  }
  ledgers.clear();
  Thread.sleep(baseConf.getGcWaitTime() * 2);
  for (int i=0; i < numLedgers; i++) {
    LedgerHandle lh=bkc.createLedger(1,1,DigestType.CRC32,"bk is cool".getBytes());
    for (int j=0; j < 5; j++) {
      lh.addEntry("just test".getBytes());
    }
    ledgers.add(lh.getId());
    lh.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.test.MultipleThreadReadTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void test10Ledgers20ThreadsRead() throws IOException {
  multiLedgerMultiThreadRead(10,20);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void test10Ledgers200ThreadsRead() throws IOException {
  multiLedgerMultiThreadRead(10,200);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void test1Ledger20ThreadsRead() throws IOException {
  multiLedgerMultiThreadRead(1,20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.bookkeeper.util.TestDiskChecker </h4><pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check disk error for file
 */
@Test(timeout=30000,expected=DiskErrorException.class) public void testCheckDiskErrorForFile() throws Exception {
  File parent=createTempDir("DiskCheck","test");
  File child=File.createTempFile("DiskCheck","test",parent);
  diskChecker.checkDir(child);
}

</code></pre>

<br>
<pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=DiskWarnThresholdException.class) public void testDiskWarnThresholdException() throws IOException {
  File file=createTempDir("DiskCheck","test");
  long usableSpace=file.getUsableSpace();
  long totalSpace=file.getTotalSpace();
  float diskSpaceThreshold=(1f - ((float)usableSpace / (float)totalSpace));
  float diskWarnThreshold=(1f - ((float)usableSpace / (float)totalSpace)) * 0.5f;
  diskChecker.setDiskSpaceThreshold(diskSpaceThreshold,diskWarnThreshold);
  diskChecker.checkDiskFull(file);
}

</code></pre>

<br>
<pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check the disk full
 */
@Test(expected=DiskOutOfSpaceException.class) public void testCheckDiskFull() throws IOException {
  File file=createTempDir("DiskCheck","test");
  long usableSpace=file.getUsableSpace();
  long totalSpace=file.getTotalSpace();
  float threshold=(1f - ((float)usableSpace / (float)totalSpace)) * 0.5f;
  diskChecker.setDiskSpaceThreshold(threshold,threshold);
  diskChecker.checkDiskFull(file);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check disk error for valid dir.
 */
@Test(timeout=60000) public void testCheckDiskErrorForDir() throws Exception {
  File parent=createTempDir("DiskCheck","test");
  File child=File.createTempFile("DiskCheck","test",parent);
  child.delete();
  child.mkdir();
  diskChecker.checkDir(child);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.client.TestSubAfterCloseSub </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * {@link https://issues.apache.org/jira/browse/BOOKKEEPER-507}
 */
@Test(timeout=15000) public void testSubAfterCloseSubForMultiplexClient() throws Exception {
  runSubAfterCloseSubTest(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that if we close a subscription and open again immediately, we don't
 * get a TOPIC_BUSY. This race existed because the simple client simply closed
 * the connection when closing a subscription, and another client could try to
 * attach to the subscription before the channel disconnected event occurs.{@link https://issues.apache.org/jira/browse/BOOKKEEPER-513}
 */
@Test(timeout=15000) public void testSimpleClientDoesntGetTopicBusy() throws Exception {
  for (int i=0; i < 10; i++) {
    HedwigClient client1=new HedwigClient(new TestClientConfiguration(false));
    Subscriber subscriber1=client1.getSubscriber();
    HedwigClient client2=new HedwigClient(new TestClientConfiguration(false));
    Subscriber subscriber2=client2.getSubscriber();
    final ByteString topic=ByteString.copyFromUtf8("TestSimpleClientTopicBusy");
    final ByteString subid=ByteString.copyFromUtf8("mysub");
    SubscriptionOptions opts1=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
    subscriber1.subscribe(topic,subid,opts1);
    subscriber1.closeSubscription(topic,subid);
    SubscriptionOptions opts2=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.ATTACH).build();
    subscriber2.subscribe(topic,subid,opts2);
    subscriber2.closeSubscription(topic,subid);
    client1.close();
    client2.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.client.netty.TestMultiplexing </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testStopDelivery() throws Exception {
  ByteString topic1=ByteString.copyFromUtf8("testStopDelivery-1");
  ByteString topic2=ByteString.copyFromUtf8("testStopDelivery-2");
  ByteString subid1=ByteString.copyFromUtf8("mysubid-1");
  ByteString subid2=ByteString.copyFromUtf8("mysubid-2");
  final int X=20;
  TestMessageHandler csHandler11=new TestMessageHandler(1,X,true,X);
  TestMessageHandler csHandler12=new TestMessageHandler(1,X,false,0);
  TestMessageHandler csHandler21=new TestMessageHandler(1,X,false,0);
  TestMessageHandler csHandler22=new TestMessageHandler(1,X,true,X);
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  subscriber.subscribe(topic1,subid1,opts);
  subscriber.subscribe(topic1,subid2,opts);
  subscriber.subscribe(topic2,subid1,opts);
  subscriber.subscribe(topic2,subid2,opts);
  subscriber.startDelivery(topic1,subid1,csHandler11);
  subscriber.startDelivery(topic1,subid2,csHandler12);
  subscriber.startDelivery(topic2,subid1,csHandler21);
  subscriber.startDelivery(topic2,subid2,csHandler22);
  for (int i=1; i <= X; i++) {
    publisher.publish(topic1,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
    publisher.publish(topic2,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
  }
  csHandler11.checkFirstRun();
  csHandler12.checkFirstRun();
  csHandler21.checkFirstRun();
  csHandler22.checkFirstRun();
  subscriber.stopDelivery(topic1,subid2);
  subscriber.stopDelivery(topic2,subid1);
  for (int i=X + 1; i <= 2 * X; i++) {
    publisher.publish(topic1,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
    publisher.publish(topic2,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
  }
  csHandler11.checkSecondRun();
  csHandler22.checkSecondRun();
  csHandler12.checkSecondRun();
  csHandler21.checkSecondRun();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCloseSubscription() throws Exception {
  ByteString topic1=ByteString.copyFromUtf8("testCloseSubscription-1");
  ByteString topic2=ByteString.copyFromUtf8("testCloseSubscription-2");
  ByteString subid1=ByteString.copyFromUtf8("mysubid-1");
  ByteString subid2=ByteString.copyFromUtf8("mysubid-2");
  final int X=20;
  TestMessageHandler csHandler11=new TestMessageHandler(1,X,true,X);
  TestMessageHandler csHandler12=new TestMessageHandler(1,X,false,0);
  TestMessageHandler csHandler21=new TestMessageHandler(1,X,false,0);
  TestMessageHandler csHandler22=new TestMessageHandler(1,X,true,X);
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  subscriber.subscribe(topic1,subid1,opts);
  subscriber.subscribe(topic1,subid2,opts);
  subscriber.subscribe(topic2,subid1,opts);
  subscriber.subscribe(topic2,subid2,opts);
  subscriber.startDelivery(topic1,subid1,csHandler11);
  subscriber.startDelivery(topic1,subid2,csHandler12);
  subscriber.startDelivery(topic2,subid1,csHandler21);
  subscriber.startDelivery(topic2,subid2,csHandler22);
  for (int i=1; i <= X; i++) {
    publisher.publish(topic1,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
    publisher.publish(topic2,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
  }
  csHandler11.checkFirstRun();
  csHandler12.checkFirstRun();
  csHandler21.checkFirstRun();
  csHandler22.checkFirstRun();
  subscriber.closeSubscription(topic1,subid2);
  subscriber.closeSubscription(topic2,subid1);
  for (int i=X + 1; i <= 2 * X; i++) {
    publisher.publish(topic1,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
    publisher.publish(topic2,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
  }
  csHandler11.checkSecondRun();
  csHandler22.checkSecondRun();
  csHandler12.checkSecondRun();
  csHandler21.checkSecondRun();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testThrottle() throws Exception {
  ByteString topic1=ByteString.copyFromUtf8("testThrottle-1");
  ByteString topic2=ByteString.copyFromUtf8("testThrottle-2");
  ByteString subid1=ByteString.copyFromUtf8("mysubid-1");
  ByteString subid2=ByteString.copyFromUtf8("mysubid-2");
  final int X=DEFAULT_MSG_WINDOW_SIZE;
  ThrottleMessageHandler csHandler11=new ThrottleMessageHandler(1,3 * X,false,X);
  ThrottleMessageHandler csHandler12=new ThrottleMessageHandler(1,3 * X,true,X);
  ThrottleMessageHandler csHandler21=new ThrottleMessageHandler(1,3 * X,true,X);
  ThrottleMessageHandler csHandler22=new ThrottleMessageHandler(1,3 * X,false,X);
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  subscriber.subscribe(topic1,subid1,opts);
  subscriber.subscribe(topic1,subid2,opts);
  subscriber.subscribe(topic2,subid1,opts);
  subscriber.subscribe(topic2,subid2,opts);
  subscriber.startDelivery(topic1,subid1,csHandler11);
  subscriber.startDelivery(topic1,subid2,csHandler12);
  subscriber.startDelivery(topic2,subid1,csHandler21);
  subscriber.startDelivery(topic2,subid2,csHandler22);
  for (int i=1; i <= 3 * X; i++) {
    publisher.publish(topic1,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
    publisher.publish(topic2,Message.newBuilder().setBody(ByteString.copyFromUtf8(String.valueOf(i))).build());
  }
  csHandler11.checkThrottle();
  csHandler12.checkThrottle();
  csHandler21.checkThrottle();
  csHandler22.checkThrottle();
  for (int i=1; i <= X; i++) {
    MessageSeqId seqId=MessageSeqId.newBuilder().setLocalComponent(i).build();
    subscriber.consume(topic1,subid2,seqId);
    subscriber.consume(topic2,subid1,seqId);
  }
  csHandler11.checkAfterThrottle();
  csHandler22.checkAfterThrottle();
  csHandler12.checkAfterThrottle();
  csHandler21.checkAfterThrottle();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.jms.selector.activemq.SelectorParserTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseWithParensAround() throws JMSException, ParseException {
  String[] values={"x = 1 and y = 2","(x = 1) and (y = 2)","((x = 1) and (y = 2))"};
  TextMessageImpl message=new TextMessageImpl(null,"test");
  message.setIntProperty("x",1);
  message.setIntProperty("y",2);
  for (  String value : values) {
    Node ast=SelectorParser.parseMessageSelector(value);
    assert Boolean.TRUE.equals(SelectorParser.evaluateSelector(ast,message));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.jms.selector.activemq.SelectorTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringQuoteParsing() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"quote = '''In God We Trust'''",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDivide() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"rank / version = 61",true);
  assertSelector(message,"rank / 3 > 100.0",false);
  assertSelector(message,"rank / 3 > 100",false);
  assertSelector(message,"version / 2 = 1",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIn() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"name in ('James', 'Bob', 'Gromit')",true);
  assertSelector(message,"name in ('Bob', 'James', 'Gromit')",true);
  assertSelector(message,"name in ('Gromit', 'Bob', 'James')",true);
  assertSelector(message,"name in ('Gromit', 'Bob', 'Cheddar')",false);
  assertSelector(message,"name not in ('Gromit', 'Bob', 'Cheddar')",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBooleanSelector() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"(trueProp OR falseProp) AND trueProp",true);
  assertSelector(message,"(trueProp OR falseProp) AND falseProp",false);
  assertSelector(message,"trueProp",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrSelectors() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"name = 'James' or rank < 200",true);
  assertSelector(message,"name = 'James' or rank > 200",true);
  assertSelector(message,"name = 'Foo' or rank < 200",true);
  assertSelector(message,"name = 'Foo' or rank > 200",false);
  assertSelector(message,"unknown = 'Foo' or anotherUnknown < 200",null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAndSelectors() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"name = 'James' and rank < 200",true);
  assertSelector(message,"name = 'James' and rank > 200",false);
  assertSelector(message,"name = 'Foo' and rank < 200",false);
  assertSelector(message,"unknown = 'Foo' and anotherUnknown < 200",null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPropertyTypes() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"byteProp = 123",true);
  assertSelector(message,"byteProp = 10",false);
  assertSelector(message,"byteProp2 = 33",true);
  assertSelector(message,"byteProp2 = 10",false);
  assertSelector(message,"shortProp = 123",true);
  assertSelector(message,"shortProp = 10",false);
  assertSelector(message,"shortProp = 123",true);
  assertSelector(message,"shortProp = 10",false);
  assertSelector(message,"intProp = 123",true);
  assertSelector(message,"intProp = 10",false);
  assertSelector(message,"longProp = 123",true);
  assertSelector(message,"longProp = 10",false);
  assertSelector(message,"floatProp = 123",true);
  assertSelector(message,"floatProp = 10",false);
  assertSelector(message,"doubleProp = 123",true);
  assertSelector(message,"doubleProp = 10",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPlus() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"rank + 2 = 125",true);
  assertSelector(message,"(rank + 2) = 125",true);
  assertSelector(message,"125 = (rank + 2)",true);
  assertSelector(message,"rank + version = 125",true);
  assertSelector(message,"rank + 2 < 124",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMatsHenricsonUseCases() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"SessionserverId=1870414179",null);
  message.setLongProperty("SessionserverId",1870414179);
  assertSelector(message,"SessionserverId=1870414179",true);
  message.setLongProperty("SessionserverId",1234);
  assertSelector(message,"SessionserverId=1870414179",false);
  assertSelector(message,"Command NOT IN ('MirrorLobbyRequest', 'MirrorLobbyReply')",null);
  message.setStringProperty("Command","Cheese");
  assertSelector(message,"Command NOT IN ('MirrorLobbyRequest', 'MirrorLobbyReply')",true);
  message.setStringProperty("Command","MirrorLobbyRequest");
  assertSelector(message,"Command NOT IN ('MirrorLobbyRequest', 'MirrorLobbyReply')",false);
  message.setStringProperty("Command","MirrorLobbyReply");
  assertSelector(message,"Command NOT IN ('MirrorLobbyRequest', 'MirrorLobbyReply')",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinus() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"rank - 2 = 121",true);
  assertSelector(message,"rank - version = 121",true);
  assertSelector(message,"rank - 2 > 122",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBetween() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"rank between 100 and 150",true);
  assertSelector(message,"rank between 10 and 120",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatComparisons() throws Exception {
  MessageImpl message=createMessage();
  double x;
  x=1.0;
  x=-1.1;
  x=1.0E1;
  x=1.1E1;
  x=-1.1E1;
  assertSelector(message,"-1.1 < 1.0",true);
  assertSelector(message,"1.0E1 < 1.1E1",true);
  assertSelector(message,"-1.1E1 < 1.0E1",true);
  x=1.;
  x=1.E1;
  assertSelector(message,"1. < 1.1",true);
  assertSelector(message,"-1.1 < 1.",true);
  assertSelector(message,"1.E1 < 1.1E1",true);
  assertSelector(message,"-1.1E1 < 1.E1",true);
  x=.5;
  x=-.5;
  x=.5E1;
  assertSelector(message,".1 < .5",true);
  assertSelector(message,"-.5 < .1",true);
  assertSelector(message,".1E1 < .5E1",true);
  assertSelector(message,"-.5E1 < .1E1",true);
  x=4E10;
  x=-4E10;
  x=5E+10;
  x=5E-10;
  assertSelector(message,"4E10 < 5E10",true);
  assertSelector(message,"5E8 < 5E10",true);
  assertSelector(message,"-4E10 < 2E10",true);
  assertSelector(message,"-5E8 < 2E2",true);
  assertSelector(message,"4E+10 < 5E+10",true);
  assertSelector(message,"4E-10 < 5E-10",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIsNull() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"dummy is null",true);
  assertSelector(message,"dummy is not null",false);
  assertSelector(message,"name is not null",true);
  assertSelector(message,"name is null",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLike() throws Exception {
  MessageImpl message=createMessage();
  message.setStringProperty("modelClassId","com.whatever.something.foo.bar");
  message.setStringProperty("modelInstanceId","170");
  message.setStringProperty("modelRequestError","abc");
  message.setStringProperty("modelCorrelatedClientId","whatever");
  assertSelector(message,"modelClassId LIKE 'com.whatever.something.%' AND modelInstanceId = '170'" + " AND (modelRequestError IS NULL OR modelCorrelatedClientId = 'whatever')",true);
  message.setStringProperty("modelCorrelatedClientId","shouldFailNow");
  assertSelector(message,"modelClassId LIKE 'com.whatever.something.%' AND modelInstanceId = '170'" + " AND (modelRequestError IS NULL OR modelCorrelatedClientId = 'whatever')",false);
  message=createMessage();
  message.setStringProperty("modelClassId","com.whatever.something.foo.bar");
  message.setStringProperty("modelInstanceId","170");
  message.setStringProperty("modelCorrelatedClientId","shouldNotMatch");
  assertSelector(message,"modelClassId LIKE 'com.whatever.something.%' AND modelInstanceId = '170'" + " AND (modelRequestError IS NULL OR modelCorrelatedClientId = 'whatever')",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLikeComparisons() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"quote LIKE '''In G_d We Trust'''",true);
  assertSelector(message,"quote LIKE '''In Gd_ We Trust'''",false);
  assertSelector(message,"quote NOT LIKE '''In G_d We Trust'''",false);
  assertSelector(message,"quote NOT LIKE '''In Gd_ We Trust'''",true);
  assertSelector(message,"foo LIKE '%oo'",true);
  assertSelector(message,"foo LIKE '%ar'",false);
  assertSelector(message,"foo NOT LIKE '%oo'",false);
  assertSelector(message,"foo NOT LIKE '%ar'",true);
  assertSelector(message,"foo LIKE '!_%' ESCAPE '!'",true);
  assertSelector(message,"quote LIKE '!_%' ESCAPE '!'",false);
  assertSelector(message,"foo NOT LIKE '!_%' ESCAPE '!'",false);
  assertSelector(message,"quote NOT LIKE '!_%' ESCAPE '!'",true);
  assertSelector(message,"punctuation LIKE '!#$&()*+,-./:;<=>?@[\\]^`{|}~'",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiply() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"rank * 2 = 246",true);
  assertSelector(message,"rank * version = 246",true);
  assertSelector(message,"rank * 2 < 130",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidSelector() throws Exception {
  MessageImpl message=createMessage();
  assertInvalidSelector(message,"3+5");
  assertInvalidSelector(message,"True AND 3+5");
  assertInvalidSelector(message,"=TEST 'test'");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJMSPropertySelectors() throws Exception {
  MessageImpl message=createMessage();
  message.setJMSType("selector-test");
  message.setJMSMessageID("id:test:1:1:1:1");
  assertSelector(message,"JMSType = 'selector-test'",true);
  assertSelector(message,"JMSType = 'crap'",false);
  assertSelector(message,"JMSMessageID = 'id:test:1:1:1:1'",true);
  assertSelector(message,"JMSMessageID = 'id:not-test:1:1:1:1'",false);
  message=createMessage();
  message.setJMSType("1001");
  assertSelector(message,"JMSType='1001'",true);
  assertSelector(message,"JMSType='1001' OR JMSType='1002'",true);
  assertSelector(message,"JMSType = 'crap'",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBasicSelectors() throws Exception {
  MessageImpl message=createMessage();
  assertSelector(message,"name = 'James'",true);
  assertSelector(message,"rank > 100",true);
  assertSelector(message,"rank >= 123",true);
  assertSelector(message,"rank >= 124",false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.TestBackwardCompat </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compatability between version 4.1.0 and the current version.
 * Server side throttling does't work when current client connects to old version
 * server.
 */
@Test(timeout=60000) public void testServerSideThrottleCompat410() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestServerSideThrottleCompat410");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  BookKeeperCluster410 bkc410=new BookKeeperCluster410(3);
  bkc410.start();
  int port=PortManager.nextFreePort();
  int sslPort=PortManager.nextFreePort();
  Server410 s410=new Server410(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s410.start();
  ClientCurrent ccur=new ClientCurrent(false,"localhost:" + port + ":"+ sslPort);
  ccur.throttleX41(topic,subid,10);
  ccur.close();
  s410.stop();
  bkc410.stop();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compatability of message bound between version 4.0.0 and
 * current version.
 * 1) message bound doesn't take effects on 4.0.0 server.
 * 2) message bound take effects on both 4.1.0 and current server
 */
@Test(timeout=60000) public void testMessageBoundCompat() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("testMessageBoundCompat");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  int port=PortManager.nextFreePort();
  int sslPort=PortManager.nextFreePort();
  BookKeeperCluster400 bkc400=new BookKeeperCluster400(3);
  bkc400.start();
  Server400 s400=new Server400(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s400.start();
  org.apache.hedwig.protocol.PubSubProtocol.SubscriptionOptions options5cur=org.apache.hedwig.protocol.PubSubProtocol.SubscriptionOptions.newBuilder().setCreateOrAttach(org.apache.hedwig.protocol.PubSubProtocol.SubscribeRequest.CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(5).build();
  ClientCurrent ccur=new ClientCurrent("localhost:" + port + ":"+ sslPort);
  ccur.subscribe(topic,subid,options5cur);
  ccur.closeSubscription(topic,subid);
  ccur.sendXExpectLastY(topic,subid,50,50);
  s400.stop();
  bkc400.stop();
  BookKeeperCluster410 bkc410=new BookKeeperCluster410(3);
  bkc410.start();
  Server410 s410=new Server410(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s410.start();
  ccur.subscribe(topic,subid,options5cur);
  ccur.closeSubscription(topic,subid);
  ccur.sendXExpectLastY(topic,subid,50,5);
  s410.stop();
  bkc410.stop();
  BookKeeperCluster420 bkc420=new BookKeeperCluster420(3);
  bkc420.start();
  Server420 s420=new Server420(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s420.start();
  ccur.subscribe(topic,subid,options5cur);
  ccur.closeSubscription(topic,subid);
  ccur.sendXExpectLastY(topic,subid,50,5);
  s420.stop();
  bkc420.stop();
  ccur.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compatability between version 4.1.0 and the current version.
 * A current server could read subscription data recorded by 4.1.0 server.
 */
@Test(timeout=60000) public void testSubscriptionDataCompat410() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestCompat410");
  ByteString sub410=ByteString.copyFromUtf8("sub410");
  ByteString subcur=ByteString.copyFromUtf8("subcur");
  BookKeeperCluster410 bkc410=new BookKeeperCluster410(3);
  bkc410.start();
  int port=PortManager.nextFreePort();
  int sslPort=PortManager.nextFreePort();
  Server410 s410=new Server410(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s410.start();
  Client410 c410=new Client410("localhost:" + port + ":"+ sslPort);
  c410.subscribe(topic,sub410);
  c410.closeSubscription(topic,sub410);
  Thread.sleep(1000);
  ClientCurrent ccur=new ClientCurrent("localhost:" + port + ":"+ sslPort);
  ccur.subscribe(topic,subcur);
  ccur.closeSubscription(topic,subcur);
  c410.publishInts(topic,0,10);
  s410.stop();
  Server420 s420=new Server420(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s420.start();
  c410.subscribe(topic,sub410);
  c410.receiveInts(topic,sub410,0,10);
  ccur.subscribe(topic,subcur);
  ccur.receiveInts(topic,subcur,0,10);
  ccur.publishInts(topic,10,10);
  c410.receiveInts(topic,sub410,10,10);
  ccur.receiveInts(topic,subcur,10,10);
  s420.stop();
  c410.close();
  ccur.close();
  bkc410.stop();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compatability between version 4.1.0 and the current version.
 * A 4.1.0 client could not update message bound, while current could do it.
 */
@Test(timeout=60000) public void testUpdateMessageBoundCompat410() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestUpdateMessageBoundCompat410");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  BookKeeperCluster420 bkc420=new BookKeeperCluster420(3);
  bkc420.start();
  int port=PortManager.nextFreePort();
  int sslPort=PortManager.nextFreePort();
  Server420 s420=new Server420(zkUtil.getZooKeeperConnectString(),port,sslPort);
  s420.start();
  org.apache.hedwig.protocol.PubSubProtocol.SubscriptionOptions options5cur=org.apache.hedwig.protocol.PubSubProtocol.SubscriptionOptions.newBuilder().setCreateOrAttach(org.apache.hedwig.protocol.PubSubProtocol.SubscribeRequest.CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(5).build();
  org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscriptionOptions options5v410=org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscriptionOptions.newBuilder().setCreateOrAttach(org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscribeRequest.CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(5).build();
  org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscriptionOptions options20v410=org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscriptionOptions.newBuilder().setCreateOrAttach(org.apache.hw_v4_1_0.hedwig.protocol.PubSubProtocol.SubscribeRequest.CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(20).build();
  Client410 c410=new Client410("localhost:" + port + ":"+ sslPort);
  c410.subscribe(topic,subid,options20v410);
  c410.closeSubscription(topic,subid);
  Thread.sleep(1000);
  c410.sendXExpectLastY(topic,subid,50,20);
  c410.subscribe(topic,subid,options5v410);
  c410.closeSubscription(topic,subid);
  Thread.sleep(1000);
  c410.sendXExpectLastY(topic,subid,50,20);
  ClientCurrent ccur=new ClientCurrent("localhost:" + port + ":"+ sslPort);
  ccur.subscribe(topic,subid,options5cur);
  ccur.closeSubscription(topic,subid);
  Thread.sleep(1000);
  c410.sendXExpectLastY(topic,subid,50,5);
  s420.stop();
  c410.close();
  ccur.close();
  bkc420.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.TestPubSubServerStartup </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Start-up zookeeper + pubsubserver reading from a config URL. Then stop
 * and cleanup.
 * Loop over that.
 * If the pubsub server does not wait for its zookeeper client to be
 * connected, the pubsub server will fail at startup.
 */
@Test(timeout=60000) public void testPubSubServerInstantiationWithConfig() throws Exception {
  for (int i=0; i < 10; i++) {
    logger.info("iteration " + i);
    instantiateAndDestroyPubSubServer();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.delivery.TestThrottlingDelivery </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testServerSideThrottle() throws Exception {
  int messageWindowSize=DEFAULT_MESSAGE_WINDOW_SIZE;
  ThrottleDeliveryClientConfiguration conf=new ThrottleDeliveryClientConfiguration();
  HedwigClient client=new HedwigClient(conf);
  Publisher pub=client.getPublisher();
  Subscriber sub=client.getSubscriber();
  ByteString topic=ByteString.copyFromUtf8("testServerSideThrottle");
  ByteString subid=ByteString.copyFromUtf8("serverThrottleSub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  sub.subscribe(topic,subid,opts);
  sub.closeSubscription(topic,subid);
  throttleX(pub,sub,topic,subid,DEFAULT_MESSAGE_WINDOW_SIZE);
  messageWindowSize=DEFAULT_MESSAGE_WINDOW_SIZE / 2;
  SubscriptionOptions.Builder optionsBuilder=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).setMessageWindowSize(messageWindowSize);
  topic=ByteString.copyFromUtf8("testServerSideThrottleWithLowerValue");
  sub.subscribe(topic,subid,optionsBuilder.build());
  sub.closeSubscription(topic,subid);
  throttleX(pub,sub,topic,subid,messageWindowSize);
  messageWindowSize=DEFAULT_MESSAGE_WINDOW_SIZE + 5;
  optionsBuilder=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).setMessageWindowSize(messageWindowSize);
  topic=ByteString.copyFromUtf8("testServerSideThrottleWithHigherValue");
  sub.subscribe(topic,subid,optionsBuilder.build());
  sub.closeSubscription(topic,subid);
  throttleX(pub,sub,topic,subid,messageWindowSize);
  client.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testThrottleWithServerSideFilter() throws Exception {
  int messageWindowSize=DEFAULT_MESSAGE_WINDOW_SIZE;
  ThrottleDeliveryClientConfiguration conf=new ThrottleDeliveryClientConfiguration();
  HedwigClient client=new HedwigClient(conf);
  Publisher pub=client.getPublisher();
  Subscriber sub=client.getSubscriber();
  ByteString topic=ByteString.copyFromUtf8("testThrottleWithServerSideFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  sub.subscribe(topic,subid,opts);
  sub.closeSubscription(topic,subid);
  throttleWithFilter(pub,sub,topic,subid,messageWindowSize / 2);
  throttleWithFilter(pub,sub,topic,subid,messageWindowSize);
  throttleWithFilter(pub,sub,topic,subid,messageWindowSize + messageWindowSize / 2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.filter.TestMessageFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testChangeSubscriptionPreferencesForClientFilter() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestChangeSubscriptionPreferencesForClientFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,2);
  receiveNumModM(topic,subid,null,new ModMessageFilter(),0,50,2,false);
  receiveNumModM(topic,subid,null,new ModMessageFilter(),0,25,4,false);
  receiveNumModM(topic,subid,null,new ModMessageFilter(),0,33,3,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testChangeServerSideMessageFilter() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestChangeMessageFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,3);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,50,2,false);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,25,4,false);
  receiveNumModM(topic,subid,HeaderMessageFilter.class.getName(),null,0,33,3,true);
  publishNums(topic,200,100,7);
  receiveNumModM(topic,subid,HeaderMessageFilter.class.getName(),null,200,14,7,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testClientSideMessageFilter() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestClientMessageFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,2);
  receiveNumModM(topic,subid,null,new ModMessageFilter(),0,50,2,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testChangeSubscriptionPreferences() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestChangeSubscriptionPreferences");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,2);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,50,2,false);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,25,4,false);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,33,3,true);
  publishNums(topic,100,100,5);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,100,20,5,true);
  publishNums(topic,200,100,7);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,200,14,7,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testChangeClientSideMessageFilter() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestChangeClientSideMessageFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,3);
  receiveNumModM(topic,subid,null,new ModMessageFilter(),0,50,2,false);
  receiveNumModM(topic,subid,null,new HeaderMessageFilter(),0,33,3,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testServerSideMessageFilter() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("TestMessageFilter");
  ByteString subid=ByteString.copyFromUtf8("mysub");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  subscriber.subscribe(topic,subid,opts);
  subscriber.closeSubscription(topic,subid);
  publishNums(topic,0,100,2);
  receiveNumModM(topic,subid,ModMessageFilter.class.getName(),null,0,50,2,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.integration.TestHedwigHub </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testPublishWithBookKeeperError() throws Exception {
  int batchSize=10;
  publishBatch(batchSize,true,false,0);
  bktb.stopAllBookieServers();
  publishBatch(batchSize,false,false,1);
  bktb.startAllBookieServers();
  publishBatch(batchSize,true,false,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testServerFailoverPublishOnly() throws Exception {
  int batchSize=10;
  publishBatch(batchSize,true,false,0);
  shutDownLastServer();
  publishBatch(batchSize,true,false,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testServerRedirect() throws Exception {
  int batchSize=10;
  publishBatch(batchSize,true,false,0);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testServerFailover() throws Exception {
  int batchSize=10;
  subscribeToTopics(batchSize);
  publishBatch(batchSize,true,true,0);
  shutDownLastServer();
  publishBatch(batchSize,true,true,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000) public void testSubscribeAndConsume() throws Exception {
  int batchSize=10;
  subscribeToTopics(batchSize);
  publishBatch(batchSize,true,true,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.netty.TestPubSubServer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSecondServer() throws Exception {
  PubSubServer server1=new PubSubServer(new StandAloneServerConfiguration(){
    @Override public int getServerPort(){
      return super.getServerPort() + 1;
    }
  }
,new ClientConfiguration(),new LoggingExceptionHandler());
  server1.start();
  server1.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.persistence.MessageBoundedPersistenceTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testMultipleSubscribers() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("multiSubTopic");
  Client client=new HedwigClient(new HubClientConfiguration());
  Publisher pub=client.getPublisher();
  Subscriber sub=client.getSubscriber();
  SubscriptionOptions options5=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).setMessageBound(5).build();
  SubscriptionOptions options20=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).setMessageBound(20).build();
  SubscriptionOptions optionsUnbounded=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  ByteString subid5=ByteString.copyFromUtf8("bound5SubId");
  ByteString subid20=ByteString.copyFromUtf8("bound20SubId");
  ByteString subidUnbounded=ByteString.copyFromUtf8("noboundSubId");
  sub.subscribe(topic,subid5,options5);
  sub.closeSubscription(topic,subid5);
  sendXExpectLastY(pub,sub,topic,subid5,1000,5);
  sub.subscribe(topic,subid20,options20);
  sub.closeSubscription(topic,subid20);
  sendXExpectLastY(pub,sub,topic,subid20,1000,20);
  sub.subscribe(topic,subidUnbounded,optionsUnbounded);
  sub.closeSubscription(topic,subidUnbounded);
  sendXExpectLastY(pub,sub,topic,subidUnbounded,10000,10000);
  sub.unsubscribe(topic,subidUnbounded);
  sendXExpectLastY(pub,sub,topic,subid20,1000,20);
  sub.unsubscribe(topic,subid20);
  sendXExpectLastY(pub,sub,topic,subid5,1000,5);
  sub.unsubscribe(topic,subid5);
  client.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testUpdateMessageBound() throws Exception {
  ByteString topic=ByteString.copyFromUtf8("UpdateMessageBound");
  Client client=new HedwigClient(new HubClientConfiguration());
  Publisher pub=client.getPublisher();
  Subscriber sub=client.getSubscriber();
  SubscriptionOptions options5=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(5).build();
  SubscriptionOptions options20=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(20).build();
  SubscriptionOptions options10=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).setMessageBound(10).build();
  ByteString subid=ByteString.copyFromUtf8("updateSubId");
  sub.subscribe(topic,subid,options5);
  sub.closeSubscription(topic,subid);
  sendXExpectLastY(pub,sub,topic,subid,50,5);
  sub.subscribe(topic,subid,options20);
  sub.closeSubscription(topic,subid);
  sendXExpectLastY(pub,sub,topic,subid,50,20);
  sub.subscribe(topic,subid,options10);
  sub.closeSubscription(topic,subid);
  sendXExpectLastY(pub,sub,topic,subid,50,10);
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  sub.subscribe(topic,subid,opts);
  sub.closeSubscription(topic,subid);
  sendXExpectLastY(pub,sub,topic,subid,50,10);
  client.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testBasicBounding() throws Exception {
  Client client=new HedwigClient(new MessageBoundClientConfiguration(5));
  Publisher pub=client.getPublisher();
  Subscriber sub=client.getSubscriber();
  ByteString topic=ByteString.copyFromUtf8("basicBoundingTopic");
  ByteString subid=ByteString.copyFromUtf8("basicBoundingSubId");
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE).build();
  sub.subscribe(topic,subid,opts);
  sub.closeSubscription(topic,subid);
  sendXExpectLastY(pub,sub,topic,subid,1000,5);
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.persistence.TestBookKeeperPersistenceManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testFailedToDeleteLedger1() throws Exception {
  failedToDeleteLedgersTest(1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testFailedToDeleteLedger2() throws Exception {
  failedToDeleteLedgersTest(2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testInconsistentSubscriptionStateAndLedgerRanges2() throws Exception {
  inconsistentSubscriptionStateAndLedgerRanges(2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testInconsistentSubscriptionStateAndLedgerRanges1() throws Exception {
  inconsistentSubscriptionStateAndLedgerRanges(1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testScanMessagesOnUnclosedLedgerAfterDeleteLedger() throws Exception {
  scanMessagesAfterDeleteLedgerTest(1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testScanMessagesOnClosedLedgerAfterDeleteLedger() throws Exception {
  scanMessagesAfterDeleteLedgerTest(2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.server.topics.TestConcurrentTopicAcquisition </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testTopicAcquistion() throws Exception {
  logger.info("Start concurrent topic acquistion test.");
  logger.info("Tear down one bookie server.");
  bktb.tearDownOneBookieServer();
  final AtomicBoolean inRedirectLoop=new AtomicBoolean(false);
  numDone.set(0);
  SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
  for (int i=0; i < numSubscribers; i++) {
    ByteString subId=ByteString.copyFromUtf8("sub-" + i);
    if (logger.isDebugEnabled()) {
      logger.debug("subscriber " + subId.toStringUtf8() + " subscribes topic "+ topic.toStringUtf8());
    }
    subscriber.asyncSubscribe(topic,subId,opts,new Callback<Void>(){
      private void tick(){
        if (numDone.incrementAndGet() == numSubscribers) {
          ConcurrencyUtils.put(queue,true);
        }
      }
      @Override public void operationFinished(      Object ctx,      Void resultOfOperation){
        tick();
      }
      @Override public void operationFailed(      Object ctx,      PubSubException exception){
        if (exception instanceof PubSubException.ServiceDownException) {
          String msg=exception.getMessage();
          if (msg.indexOf("ServerRedirectLoopException") > 0) {
            inRedirectLoop.set(true);
          }
          if (logger.isDebugEnabled()) {
            logger.debug("Operation failed : ",exception);
          }
        }
        tick();
      }
    }
,null);
  }
  queue.take();
  numDone.set(0);
  Thread sub=new Thread(new Runnable(){
    @Override public void run(){
      logger.info("sub thread started");
      try {
        for (int i=0; i < numSubscribers; i++) {
          ByteString subscriberId=ByteString.copyFromUtf8("sub-" + i);
          subscribers.put(subscriberId);
        }
        ByteString subId;
        SubscriptionOptions opts=SubscriptionOptions.newBuilder().setCreateOrAttach(CreateOrAttach.CREATE_OR_ATTACH).build();
        while (true) {
          subId=subscribers.take();
          if (logger.isDebugEnabled()) {
            logger.debug("subscriber " + subId.toStringUtf8() + " subscribes topic "+ topic.toStringUtf8());
          }
          subscriber.asyncSubscribe(topic,subId,opts,new SubCallback(subId),null);
        }
      }
 catch (      InterruptedException ie) {
        logger.warn("Interrupted : ",ie);
      }
    }
  }
);
  sub.start();
  Thread.sleep(2000);
  logger.info("start new bookie server");
  bktb.startUpNewBookieServer();
  queue.take();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hedwig.zookeeper.TestZkUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCreateFullPathOptimistic() throws Exception {
  testPath("/a/b/c",CreateMode.EPHEMERAL);
  testPath("/b/c/d",CreateMode.PERSISTENT);
  testPath("/b/c/d/e",CreateMode.PERSISTENT);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
