<h3 style="margin:0px">Class: org.apache.ambari.server.api.query.QueryImplTest (21 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 type-13 type-10 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJoinedResourceProperties() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("versions/*",null);
  instance.addProperty("versions/operating_systems/*",null);
  instance.addProperty("versions/operating_systems/repositories/*",null);
  instance.execute();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("versions/operating_systems/repositories/Repositories/repo_id");
  propertyIds.add("versions/operating_systems/OperatingSystems/os_type");
  Map<Resource,Set<Map<String,Object>>> resourcePropertiesMap=instance.getJoinedResourceProperties(propertyIds,null,null);
  Set<Map<String,Object>> propertyMaps=null;
  for (  Map.Entry<Resource,Set<Map<String,Object>>> resourceSetEntry : resourcePropertiesMap.entrySet()) {
    Assert.assertEquals(Resource.Type.Stack,resourceSetEntry.getKey().getType());
    propertyMaps=resourceSetEntry.getValue();
  }
  if (propertyMaps == null) {
    fail("No property maps found!");
  }
  Assert.assertEquals(6,propertyMaps.size());
  for (  Map<String,Object> map : propertyMaps) {
    Assert.assertEquals(2,map.size());
    Assert.assertTrue(map.containsKey("versions/operating_systems/OperatingSystems/os_type"));
    Assert.assertTrue(map.containsKey("versions/operating_systems/repositories/Repositories/repo_id"));
  }
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Cluster_instance_noSpecifiedProps() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  setChildren.add(new SubResourceDefinition(Resource.Type.Host));
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> clusterNode=tree.getChild("Cluster:1");
  Assert.assertEquals("Cluster:1",clusterNode.getName());
  Assert.assertEquals(Resource.Type.Cluster,clusterNode.getObject().getType());
  Assert.assertEquals(1,clusterNode.getChildren().size());
  TreeNode<Resource> hostNode=clusterNode.getChild("hosts");
  Assert.assertEquals(4,hostNode.getChildren().size());
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__collection_nonNullInternalPredicate_nonNullUserPredicate() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("Hosts/host_name").equals("host:2").toPredicate();
  instance.setUserPredicate(predicate);
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("host:2",hostNode.getObject().getPropertyValue("Hosts/host_name"));
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExecute_RendererRequiresPropertyProviderInput() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  ResourceDefinition mockResourceDefinition=mockSupport.createMock(ResourceDefinition.class);
  SubResourceDefinition mockSubResourceDefinition=mockSupport.createMock(SubResourceDefinition.class);
  ClusterController mockClusterController=mockSupport.createMock(ClusterController.class);
  Renderer mockRenderer=mockSupport.createMock(Renderer.class);
  QueryResponse mockQueryResponse=mockSupport.createMock(QueryResponse.class);
  QueryResponse mockSubQueryResponse=mockSupport.createMock(QueryResponse.class);
  Resource mockResource=mockSupport.createMock(Resource.class);
  Schema mockSchema=mockSupport.createMock(Schema.class);
  expect(mockResourceDefinition.getType()).andReturn(Resource.Type.Host).atLeastOnce();
  expect(mockResourceDefinition.getSubResourceDefinitions()).andReturn(Collections.singleton(mockSubResourceDefinition)).atLeastOnce();
  expect(mockSubResourceDefinition.getType()).andReturn(Resource.Type.Configuration).atLeastOnce();
  expect(mockSubResourceDefinition.isCollection()).andReturn(false).atLeastOnce();
  expect(mockSchema.getKeyPropertyId(isA(Resource.Type.class))).andReturn("test-value").anyTimes();
  expect(mockSchema.getKeyTypes()).andReturn(Collections.<Resource.Type>emptySet()).anyTimes();
  mockRenderer.init(isA(SchemaFactory.class));
  expect(mockRenderer.requiresPropertyProviderInput()).andReturn(true).times(2);
  expect(mockRenderer.finalizeProperties(isA(TreeNode.class),eq(true))).andReturn(new TreeNodeImpl<Set<String>>(null,Collections.<String>emptySet(),"test-node"));
  expect(mockRenderer.finalizeResult(isA(Result.class))).andReturn(null);
  expect(mockClusterController.getSchema(Resource.Type.Host)).andReturn(mockSchema).anyTimes();
  expect(mockClusterController.getSchema(Resource.Type.Configuration)).andReturn(mockSchema).anyTimes();
  expect(mockClusterController.getResources(eq(Resource.Type.Host),isA(Request.class),(Predicate)eq(null))).andReturn(mockQueryResponse).atLeastOnce();
  expect(mockClusterController.getResources(eq(Resource.Type.Configuration),isA(Request.class),(Predicate)eq(null))).andReturn(mockSubQueryResponse).atLeastOnce();
  expect(mockClusterController.getIterable(eq(Resource.Type.Host),isA(QueryResponse.class),isA(Request.class),(Predicate)eq(null),(PageRequest)eq(null),(SortRequest)eq(null))).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockClusterController.getIterable(eq(Resource.Type.Configuration),isA(QueryResponse.class),isA(Request.class),(Predicate)eq(null),(PageRequest)eq(null),(SortRequest)eq(null))).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockClusterController.populateResources(eq(Resource.Type.Host),eq(Collections.singleton(mockResource)),isA(Request.class),(Predicate)eq(null))).andReturn(Collections.<Resource>emptySet()).times(1);
  expect(mockClusterController.populateResources(eq(Resource.Type.Configuration),eq(Collections.singleton(mockResource)),isA(Request.class),(Predicate)eq(null))).andReturn(Collections.<Resource>emptySet()).times(1);
  expect(mockQueryResponse.getResources()).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockSubQueryResponse.getResources()).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockResource.getType()).andReturn(Resource.Type.Host).atLeastOnce();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mockSupport.replayAll();
  QueryImpl instance=new QueryImpl(mapIds,mockResourceDefinition,mockClusterController);
  instance.setRenderer(mockRenderer);
  instance.ensureSubResources();
  instance.addProperty("*",null);
  instance.execute();
  mockSupport.verifyAll();
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Stack_instance_noSpecifiedProps() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> stackNode=tree.getChild("Stack:1");
  Assert.assertEquals("Stack:1",stackNode.getName());
  Assert.assertEquals(Resource.Type.Stack,stackNode.getObject().getType());
  Assert.assertEquals(1,stackNode.getChildren().size());
  TreeNode<Resource> versionsNode=stackNode.getChild("versions");
  Assert.assertEquals(3,versionsNode.getChildren().size());
}

</code></pre>

<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsCollection__False(){
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  mapIds.put(Resource.Type.Service,"service");
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Service).anyTimes();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(Collections.<SubResourceDefinition>emptySet()).anyTimes();
  replay(resourceDefinition);
  ResourceInstance instance=new TestQuery(mapIds,resourceDefinition);
  assertFalse(instance.isCollectionResource());
  verify(resourceDefinition);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__collection_nullInternalPredicate_nonNullUserPredicate() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("Hosts/host_name").equals("host:2").toPredicate();
  instance.setUserPredicate(predicate);
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("host:2",hostNode.getObject().getPropertyValue("Hosts/host_name"));
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExecute_RendererDoesNotRequirePropertyProviderInput() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  ResourceDefinition mockResourceDefinition=mockSupport.createMock(ResourceDefinition.class);
  SubResourceDefinition mockSubResourceDefinition=mockSupport.createMock(SubResourceDefinition.class);
  ClusterController mockClusterController=mockSupport.createMock(ClusterController.class);
  Renderer mockRenderer=mockSupport.createMock(Renderer.class);
  QueryResponse mockQueryResponse=mockSupport.createMock(QueryResponse.class);
  QueryResponse mockSubQueryResponse=mockSupport.createMock(QueryResponse.class);
  Resource mockResource=mockSupport.createMock(Resource.class);
  Schema mockSchema=mockSupport.createMock(Schema.class);
  expect(mockResourceDefinition.getType()).andReturn(Resource.Type.Host).atLeastOnce();
  expect(mockResourceDefinition.getSubResourceDefinitions()).andReturn(Collections.singleton(mockSubResourceDefinition)).atLeastOnce();
  expect(mockSubResourceDefinition.getType()).andReturn(Resource.Type.Configuration).atLeastOnce();
  expect(mockSubResourceDefinition.isCollection()).andReturn(false).atLeastOnce();
  expect(mockSchema.getKeyPropertyId(isA(Resource.Type.class))).andReturn("test-value").anyTimes();
  expect(mockSchema.getKeyTypes()).andReturn(Collections.<Resource.Type>emptySet()).anyTimes();
  mockRenderer.init(isA(SchemaFactory.class));
  expect(mockRenderer.requiresPropertyProviderInput()).andReturn(false).times(2);
  expect(mockRenderer.finalizeProperties(isA(TreeNode.class),eq(true))).andReturn(new TreeNodeImpl<Set<String>>(null,Collections.<String>emptySet(),"test-node"));
  expect(mockRenderer.finalizeResult(isA(Result.class))).andReturn(null);
  expect(mockClusterController.getSchema(Resource.Type.Host)).andReturn(mockSchema).anyTimes();
  expect(mockClusterController.getSchema(Resource.Type.Configuration)).andReturn(mockSchema).anyTimes();
  expect(mockClusterController.getResources(eq(Resource.Type.Host),isA(Request.class),(Predicate)eq(null))).andReturn(mockQueryResponse).atLeastOnce();
  expect(mockClusterController.getResources(eq(Resource.Type.Configuration),isA(Request.class),(Predicate)eq(null))).andReturn(mockSubQueryResponse).atLeastOnce();
  expect(mockClusterController.getIterable(eq(Resource.Type.Host),isA(QueryResponse.class),isA(Request.class),(Predicate)eq(null),(PageRequest)eq(null),(SortRequest)eq(null))).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockClusterController.getIterable(eq(Resource.Type.Configuration),isA(QueryResponse.class),isA(Request.class),(Predicate)eq(null),(PageRequest)eq(null),(SortRequest)eq(null))).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockQueryResponse.getResources()).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockSubQueryResponse.getResources()).andReturn(Collections.singleton(mockResource)).atLeastOnce();
  expect(mockResource.getType()).andReturn(Resource.Type.Host).atLeastOnce();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mockSupport.replayAll();
  QueryImpl instance=new QueryImpl(mapIds,mockResourceDefinition,mockClusterController);
  instance.setRenderer(mockRenderer);
  instance.ensureSubResources();
  instance.addProperty("*",null);
  instance.execute();
  mockSupport.verifyAll();
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecute_NoSuchResourceException() throws Exception {
  ResourceDefinition resourceDefinition=new ClusterResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"c1");
  ClusterController clusterController=createNiceMock(ClusterController.class);
  QueryResponse queryResponse=createNiceMock(QueryResponse.class);
  Schema schema=createNiceMock(Schema.class);
  Renderer renderer=createNiceMock(Renderer.class);
  expect(clusterController.getSchema(Resource.Type.Cluster)).andReturn(schema).anyTimes();
  expect(clusterController.getResources(eq(Resource.Type.Cluster),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class))).andReturn(queryResponse);
  expect(queryResponse.getResources()).andReturn(Collections.<Resource>emptySet()).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  TreeNode<Set<String>> treeNode=new TreeNodeImpl<Set<String>>(null,Collections.EMPTY_SET,null);
  expect(renderer.finalizeProperties(anyObject(TreeNode.class),anyBoolean())).andReturn(treeNode).anyTimes();
  replay(clusterController,queryResponse,schema,renderer);
  QueryImpl query=new TestQuery(mapIds,resourceDefinition,clusterController);
  query.setRenderer(renderer);
  try {
    query.execute();
    fail("Expected NoSuchResourceException!");
  }
 catch (  NoSuchResourceException e) {
  }
  verify(clusterController,queryResponse,schema,renderer);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute_subResourcePredicate() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("versions/operating_systems/OperatingSystems/os_type").equals("centos5").toPredicate();
  instance.setUserPredicate(predicate);
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> stackNode=tree.getChild("Stack:1");
  Assert.assertEquals("Stack:1",stackNode.getName());
  Assert.assertEquals(Resource.Type.Stack,stackNode.getObject().getType());
  Assert.assertEquals(1,stackNode.getChildren().size());
  TreeNode<Resource> versionsNode=stackNode.getChild("versions");
  Assert.assertEquals(3,versionsNode.getChildren().size());
  TreeNode<Resource> versionNode=versionsNode.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",versionNode.getName());
  Assert.assertEquals(Resource.Type.StackVersion,versionNode.getObject().getType());
  Assert.assertEquals(1,versionNode.getChildren().size());
  TreeNode<Resource> opSystemsNode=versionNode.getChild("operating_systems");
  Assert.assertEquals(1,opSystemsNode.getChildren().size());
  TreeNode<Resource> opSystemNode=opSystemsNode.getChild("OperatingSystem:1");
  Assert.assertEquals("OperatingSystem:1",opSystemNode.getName());
  Resource osResource=opSystemNode.getObject();
  Assert.assertEquals(Resource.Type.OperatingSystem,opSystemNode.getObject().getType());
  Assert.assertEquals("centos5",osResource.getPropertyValue("OperatingSystems/os_type"));
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Stack_instance_specifiedSubResources() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("versions/*",null);
  instance.addProperty("versions/operating_systems/*",null);
  instance.addProperty("versions/operating_systems/repositories/*",null);
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> stackNode=tree.getChild("Stack:1");
  Assert.assertEquals("Stack:1",stackNode.getName());
  Assert.assertEquals(Resource.Type.Stack,stackNode.getObject().getType());
  Assert.assertEquals(1,stackNode.getChildren().size());
  TreeNode<Resource> versionsNode=stackNode.getChild("versions");
  Assert.assertEquals(3,versionsNode.getChildren().size());
  TreeNode<Resource> versionNode=versionsNode.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",versionNode.getName());
  Assert.assertEquals(Resource.Type.StackVersion,versionNode.getObject().getType());
  Assert.assertEquals(6,versionNode.getChildren().size());
  TreeNode<Resource> opSystemsNode=versionNode.getChild("operating_systems");
  Assert.assertEquals(3,opSystemsNode.getChildren().size());
  TreeNode<Resource> opSystemNode=opSystemsNode.getChild("OperatingSystem:1");
  Assert.assertEquals("OperatingSystem:1",opSystemNode.getName());
  Assert.assertEquals(Resource.Type.OperatingSystem,opSystemNode.getObject().getType());
  Assert.assertEquals(1,opSystemNode.getChildren().size());
  TreeNode<Resource> repositoriesNode=opSystemNode.getChild("repositories");
  Assert.assertEquals(2,repositoriesNode.getChildren().size());
  TreeNode<Resource> repositoryNode=repositoriesNode.getChild("Repository:1");
  Assert.assertEquals("Repository:1",repositoryNode.getName());
  Resource repositoryResource=repositoryNode.getObject();
  Assert.assertEquals(Resource.Type.Repository,repositoryResource.getType());
  Assert.assertEquals("repo1",repositoryResource.getPropertyValue("Repositories/repo_id"));
  Assert.assertEquals("centos5",repositoryResource.getPropertyValue("Repositories/os_type"));
  Assert.assertEquals("1.2.1",repositoryResource.getPropertyValue("Repositories/stack_version"));
  Assert.assertEquals("HDP",repositoryResource.getPropertyValue("Repositories/stack_name"));
  TreeNode<Resource> artifactsNode=versionNode.getChild("artifacts");
  Assert.assertEquals(1,artifactsNode.getChildren().size());
  TreeNode<Resource> artifactNode=artifactsNode.getChild("StackArtifact:1");
  Assert.assertEquals("StackArtifact:1",artifactNode.getName());
  Assert.assertEquals(Resource.Type.StackArtifact,artifactNode.getObject().getType());
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__collection_nullInternalPredicate_nullUserPredicate() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  setChildren.add(new SubResourceDefinition(Resource.Type.Host));
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> clusterNode=tree.getChild("Cluster:1");
  Assert.assertEquals("Cluster:1",clusterNode.getName());
  Assert.assertEquals(Resource.Type.Cluster,clusterNode.getObject().getType());
  Assert.assertEquals(0,clusterNode.getChildren().size());
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Host_collection_noSpecifiedProps() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  hostNode=tree.getChild("Host:3");
  Assert.assertEquals("Host:3",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  hostNode=tree.getChild("Host:4");
  Assert.assertEquals("Host:4",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
}

</code></pre>

<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsCollection__True(){
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  mapIds.put(Resource.Type.Service,null);
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Service).anyTimes();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(Collections.<SubResourceDefinition>emptySet()).anyTimes();
  replay(resourceDefinition);
  ResourceInstance instance=new TestQuery(mapIds,resourceDefinition);
  assertTrue(instance.isCollectionResource());
  verify(resourceDefinition);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExecute_SubResourcePropertyPredicate() throws Exception {
  ResourceDefinition resourceDefinition=new ClusterResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"c1");
  mapIds.put(Resource.Type.Host,"h1");
  ClusterController clusterController=createNiceMock(ClusterController.class);
  QueryResponse clusterResponse=createNiceMock(QueryResponse.class);
  QueryResponse hostResponse=createNiceMock(QueryResponse.class);
  Schema clusterSchema=createNiceMock("ClusterSchema",Schema.class);
  Schema hostSchema=createNiceMock("HostSchema",Schema.class);
  Renderer renderer=createNiceMock(Renderer.class);
  Resource clusterResource=createMock("ClusterResource",Resource.class);
  Resource hostResource=createMock("HostResource",Resource.class);
  Set<Resource> clusterResources=Collections.singleton(clusterResource);
  Set<Resource> hostResources=Collections.singleton(hostResource);
  Iterable<Resource> iterable=createNiceMock(Iterable.class);
  Iterator<Resource> iterator=createNiceMock(Iterator.class);
  expect(clusterController.getSchema(Resource.Type.Cluster)).andReturn(clusterSchema).anyTimes();
  expect(clusterController.getSchema(Resource.Type.Host)).andReturn(hostSchema).anyTimes();
  expect(clusterController.getResources(eq(Resource.Type.Cluster),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class))).andReturn(clusterResponse);
  expect(clusterController.getResources(eq(Resource.Type.Host),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class))).andReturn(hostResponse);
  expect(iterable.iterator()).andReturn(iterator).anyTimes();
  expect(iterator.hasNext()).andReturn(false).anyTimes();
  expect(clusterResponse.getResources()).andReturn(clusterResources).anyTimes();
  expect(hostResponse.getResources()).andReturn(hostResources).anyTimes();
  expect(clusterResource.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(hostResource.getType()).andReturn(Resource.Type.Host).anyTimes();
  expect(clusterSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  expect(clusterSchema.getKeyTypes()).andReturn(Collections.singleton(Resource.Type.Cluster)).anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn(null).anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("Hosts/host_name").anyTimes();
  expect(hostSchema.getKeyTypes()).andReturn(Collections.singleton(Resource.Type.Host)).anyTimes();
  expect(clusterResource.getPropertyValue("Clusters/cluster_name")).andReturn("c1").anyTimes();
  TreeNode<Set<String>> treeNode=new TreeNodeImpl<Set<String>>(null,Collections.EMPTY_SET,null);
  expect(renderer.finalizeProperties(anyObject(TreeNode.class),anyBoolean())).andReturn(treeNode).anyTimes();
  expect(clusterController.getIterable(eq(Resource.Type.Cluster),anyObject(QueryResponse.class),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class),anyObject(PageRequest.class),anyObject(SortRequest.class))).andReturn(iterable).anyTimes();
  replay(clusterController,clusterResponse,clusterSchema,renderer,hostSchema,clusterResource,hostResource,hostResponse,iterable,iterator);
  QueryImpl query=new TestQuery(mapIds,resourceDefinition,clusterController);
  query.setUserPredicate(new PredicateBuilder().property("hosts/Hosts/host_name").equals("h1").and().property("metrics/boottime").equals("value").toPredicate());
  query.setRenderer(renderer);
  query.execute();
  verify(clusterController,clusterResponse,clusterSchema,renderer,hostSchema,clusterResource,hostResource,hostResponse,iterable,iterator);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute_collection_NoSuchResourceException() throws Exception {
  ResourceDefinition resourceDefinition=new ClusterResourceDefinition();
  ClusterController clusterController=createNiceMock(ClusterController.class);
  QueryResponse queryResponse=createNiceMock(QueryResponse.class);
  Schema schema=createNiceMock(Schema.class);
  Renderer renderer=createNiceMock(Renderer.class);
  Iterable<Resource> iterable=createNiceMock(Iterable.class);
  Iterator<Resource> iterator=createNiceMock(Iterator.class);
  expect(clusterController.getSchema(Resource.Type.Cluster)).andReturn(schema).anyTimes();
  expect(clusterController.getResources(eq(Resource.Type.Cluster),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class))).andReturn(queryResponse);
  expect(clusterController.getIterable(eq(Resource.Type.Cluster),anyObject(QueryResponse.class),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class),anyObject(PageRequest.class),anyObject(SortRequest.class))).andReturn(iterable).anyTimes();
  expect(iterable.iterator()).andReturn(iterator).anyTimes();
  expect(iterator.hasNext()).andReturn(false).anyTimes();
  expect(queryResponse.getResources()).andReturn(Collections.<Resource>emptySet()).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  TreeNode<Set<String>> treeNode=new TreeNodeImpl<Set<String>>(null,Collections.<String>emptySet(),null);
  expect(renderer.finalizeProperties(anyObject(TreeNode.class),anyBoolean())).andReturn(treeNode).anyTimes();
  Capture<Result> resultCapture=new Capture<Result>();
  expect(renderer.finalizeResult(capture(resultCapture))).andReturn(null);
  replay(clusterController,queryResponse,schema,renderer,iterable,iterator);
  QueryImpl query=new TestQuery(new HashMap<Resource.Type,String>(),resourceDefinition,clusterController);
  query.setRenderer(renderer);
  query.execute();
  TreeNode<Resource> tree=resultCapture.getValue().getResultTree();
  Assert.assertEquals(0,tree.getChildren().size());
  verify(clusterController,queryResponse,schema,renderer,iterable,iterator);
}

</code></pre>

<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty__allCategoryProperties() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addLocalProperty("c1");
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:3");
  Assert.assertEquals("Host:3",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:4");
  Assert.assertEquals("Host:4",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute_StackVersionPageSubResourcePredicate() throws NoSuchParentResourceException, UnsupportedPropertyException, NoSuchResourceException, SystemException {
  ResourceDefinition resourceDefinition=new StackVersionResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("operating_systems/*",null);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("operating_systems/OperatingSystems/os_type").equals("centos5").toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.Beginning,1,0,null,null));
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> stackVersionNode=tree.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",stackVersionNode.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode.getObject().getType());
  Assert.assertEquals("1.2.1",stackVersionNode.getObject().getPropertyValue("Versions/stack_version"));
  QueryImpl instance2=new TestQuery(mapIds,resourceDefinition);
  instance2.addProperty("operating_systems/*",null);
  instance2.setUserPredicate(predicate);
  instance2.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,1,1,null,null));
  Result result2=instance2.execute();
  TreeNode<Resource> tree2=result2.getResultTree();
  Assert.assertEquals(1,tree2.getChildren().size());
  TreeNode<Resource> stackVersionNode2=tree2.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",stackVersionNode2.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode2.getObject().getType());
  Assert.assertEquals("1.2.2",stackVersionNode2.getObject().getPropertyValue("Versions/stack_version"));
  QueryImpl instance3=new TestQuery(mapIds,resourceDefinition);
  instance3.addProperty("operating_systems/*",null);
  instance3.setUserPredicate(predicate);
  instance3.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,2,1,null,null));
  Result result3=instance3.execute();
  TreeNode<Resource> tree3=result3.getResultTree();
  Assert.assertEquals(2,tree3.getChildren().size());
  TreeNode<Resource> stackVersionNode3=tree3.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",stackVersionNode3.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode3.getObject().getType());
  Assert.assertEquals("1.2.2",stackVersionNode3.getObject().getPropertyValue("Versions/stack_version"));
  stackVersionNode3=tree3.getChild("StackVersion:2");
  Assert.assertEquals("StackVersion:2",stackVersionNode3.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode3.getObject().getType());
  Assert.assertEquals("2.0.1",stackVersionNode3.getObject().getPropertyValue("Versions/stack_version"));
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Host_collection_AlertsSummary() throws Exception {
  ResourceDefinition resourceDefinition=new HostResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  final AtomicInteger pageCallCount=new AtomicInteger(0);
  ClusterControllerImpl clusterControllerImpl=new ClusterControllerImpl(new ClusterControllerImplTest.TestProviderModule()){
    public PageResponse getPage(    Resource.Type type,    QueryResponse queryResponse,    Request request,    Predicate predicate,    PageRequest pageRequest,    SortRequest sortRequest) throws UnsupportedPropertyException, SystemException, NoSuchResourceException, NoSuchParentResourceException {
      pageCallCount.incrementAndGet();
      return super.getPage(type,queryResponse,request,predicate,pageRequest,sortRequest);
    }
  }
;
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition,clusterControllerImpl);
  pageCallCount.set(0);
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  Assert.assertEquals(1,pageCallCount.get());
  pageCallCount.set(0);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("alerts_summary/CRITICAL").greaterThan(0).toPredicate();
  instance.setUserPredicate(predicate);
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(2,tree.getChildren().size());
  Assert.assertEquals(2,pageCallCount.get());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals("host:0",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","CRITICAL")));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals("host:2",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","CRITICAL")));
  pageCallCount.set(0);
  pb=new PredicateBuilder();
  predicate=pb.property("alerts_summary/WARNING").greaterThan(0).toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.Beginning,1,0,null,null));
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  Assert.assertEquals(2,pageCallCount.get());
  hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals("host:1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","WARNING")));
  pageCallCount.set(0);
  pb=new PredicateBuilder();
  predicate=pb.property("alerts_summary/WARNING").greaterThan(0).or().property("host_components/HostRoles/component_name").equals("DATANODE").toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(null);
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(0,tree.getChildren().size());
  Assert.assertEquals(6,pageCallCount.get());
}

</code></pre>

<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty__localProperty() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addLocalProperty("c1/p1");
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:3");
  Assert.assertEquals("Host:3",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:4");
  Assert.assertEquals("Host:4",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute_StackVersionPageResourcePredicate() throws NoSuchParentResourceException, UnsupportedPropertyException, NoSuchResourceException, SystemException {
  ResourceDefinition resourceDefinition=new StackVersionResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("Versions/stack_version").equals("1.2.1").or().property("Versions/stack_version").equals("1.2.2").toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.Beginning,1,0,null,null));
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> stackVersionNode=tree.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",stackVersionNode.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode.getObject().getType());
  Assert.assertEquals("1.2.1",stackVersionNode.getObject().getPropertyValue("Versions/stack_version"));
  instance.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,1,1,null,null));
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  stackVersionNode=tree.getChild("StackVersion:1");
  Assert.assertEquals("StackVersion:1",stackVersionNode.getName());
  Assert.assertEquals(Resource.Type.StackVersion,stackVersionNode.getObject().getType());
  Assert.assertEquals("1.2.2",stackVersionNode.getObject().getPropertyValue("Versions/stack_version"));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
