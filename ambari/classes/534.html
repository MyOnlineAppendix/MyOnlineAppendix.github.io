<h3 style="margin:0px">Class: org.apache.ambari.server.view.ViewRegistryTest (36 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(22)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(8)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadViewArchives() throws Exception {
  testReadViewArchives(false,false,false);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadViewArchives_badArchive() throws Exception {
  testReadViewArchives(true,false,false);
}

</code></pre>

<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCheckViewVersions(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  ViewConfig config=createNiceMock(ViewConfig.class);
  expect(viewEntity.getConfiguration()).andReturn(config).anyTimes();
  expect(config.getMinAmbariVersion()).andReturn(null);
  expect(config.getMaxAmbariVersion()).andReturn(null);
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("1.5");
  expect(config.getMinAmbariVersion()).andReturn("2.5");
  expect(config.getMinAmbariVersion()).andReturn(null);
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn(null);
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("*");
  expect(config.getMinAmbariVersion()).andReturn("*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("2.*");
  expect(config.getMinAmbariVersion()).andReturn("1.*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("2.1.*");
  expect(config.getMinAmbariVersion()).andReturn("1.5.*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("1.9.9.*");
  expect(config.getMinAmbariVersion()).andReturn("2.0.0.1.*");
  replay(viewEntity,config);
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  verify(viewEntity,config);
}

</code></pre>

<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadViewArchives_exception() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views").anyTimes();
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views").anyTimes();
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  expect(viewDir.listFiles()).andReturn(new File[]{viewArchive}).anyTimes();
  expect(viewArchive.isDirectory()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.mkdir()).andReturn(true);
  expect(archiveDir.toURI()).andReturn(new URI("file:./"));
  expect(metaInfDir.mkdir()).andReturn(true);
  expect(viewJarFile.getNextJarEntry()).andReturn(jarEntry);
  expect(viewJarFile.getNextJarEntry()).andReturn(null);
  expect(jarEntry.getName()).andReturn("view.xml");
  expect(jarEntry.isDirectory()).andReturn(false);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(10);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(-1);
  fos.write(anyObject(byte[].class),eq(0),eq(10));
  fos.flush();
  fos.close();
  viewJarFile.closeEntry();
  viewJarFile.close();
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(true);
  expect(classesDir.exists()).andReturn(true);
  expect(classesDir.toURI()).andReturn(new URI("file:./"));
  expect(libDir.exists()).andReturn(true);
  expect(libDir.listFiles()).andReturn(new File[]{fileEntry});
  expect(fileEntry.toURI()).andReturn(new URI("file:./"));
  expect(viewDAO.findByName("MY_VIEW{1.0.0}")).andThrow(new IllegalArgumentException("Expected exception."));
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  ViewRegistry registry=getRegistry(viewDAO,viewInstanceDAO,userDAO,memberDAO,privilegeDAO,resourceDAO,resourceTypeDAO,securityHelper,handlerList,null,archiveUtility,ambariMetaInfo);
  registry.readViewArchives();
  ViewEntity view=null;
  long timeout=System.currentTimeMillis() + 10000L;
  while ((view == null || !view.getStatus().equals(ViewDefinition.ViewStatus.ERROR)) && System.currentTimeMillis() < timeout) {
    view=registry.getDefinition("MY_VIEW","1.0.0");
  }
  Assert.assertNotNull(view);
  Assert.assertEquals(ViewDefinition.ViewStatus.ERROR,view.getStatus());
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUninstallViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Configuration ambariConfig=new Configuration(new Properties());
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ResourceEntity resource=new ResourceEntity();
  resource.setId(3L);
  viewInstanceEntity.setResource(resource);
  PrivilegeEntity privilege1=createNiceMock(PrivilegeEntity.class);
  PrivilegeEntity privilege2=createNiceMock(PrivilegeEntity.class);
  List<PrivilegeEntity> privileges=Arrays.asList(privilege1,privilege2);
  PrincipalEntity principalEntity=createNiceMock(PrincipalEntity.class);
  expect(privilege1.getPrincipal()).andReturn(principalEntity);
  expect(privilege2.getPrincipal()).andReturn(principalEntity);
  principalEntity.removePrivilege(privilege1);
  principalEntity.removePrivilege(privilege2);
  expect(privilegeDAO.findByResourceId(3L)).andReturn(privileges);
  privilegeDAO.remove(privilege1);
  privilegeDAO.remove(privilege2);
  viewInstanceDAO.remove(viewInstanceEntity);
  handlerList.removeViewInstance(viewInstanceEntity);
  replay(viewInstanceDAO,privilegeDAO,handlerList,privilege1,privilege2,principalEntity);
  registry.addDefinition(viewEntity);
  registry.addInstanceDefinition(viewEntity,viewInstanceEntity);
  registry.uninstallViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(0,viewInstanceDefinitions.size());
  verify(viewInstanceDAO,privilegeDAO,handlerList,privilege1,privilege2,principalEntity);
}

</code></pre>

<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  viewDefinition.setConfiguration(config);
  registry.setupViewDefinition(viewDefinition,getClass().getClassLoader());
  Set<SubResourceDefinition> subResourceDefinitions=registry.getSubResourceDefinitions(viewDefinition.getCommonName(),viewDefinition.getVersion());
  Assert.assertEquals(3,subResourceDefinitions.size());
  Set<String> names=new HashSet<String>();
  for (  SubResourceDefinition definition : subResourceDefinitions) {
    names.add(definition.getType().name());
  }
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/resources"));
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/resource"));
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/subresource"));
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForAdmin(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  replay(configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Assert.assertTrue(registry.includeDefinition(viewEntity));
  verify(configuration);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstallViewInstance_unknownView() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  viewInstanceEntity.setViewName("BOGUS_VIEW");
  replay(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected an IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddGetDefinitions() throws Exception {
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  registry.addDefinition(viewDefinition);
  Assert.assertEquals(viewDefinition,registry.getDefinition("MY_VIEW","1.0.0"));
  Collection<ViewEntity> viewDefinitions=registry.getDefinitions();
  Assert.assertEquals(1,viewDefinitions.size());
  Assert.assertEquals(viewDefinition,viewDefinitions.iterator().next());
}

</code></pre>

<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener_allVersions() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW",null);
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  registry.unregisterListener(listener,"MY_VIEW",null);
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForUserHasAccess(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  ViewInstanceEntity instanceEntity=createNiceMock(ViewInstanceEntity.class);
  ResourceEntity resourceEntity=createNiceMock(ResourceEntity.class);
  ResourceTypeEntity resourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  Collection<ViewInstanceEntity> instances=new ArrayList<ViewInstanceEntity>();
  instances.add(instanceEntity);
  expect(viewEntity.getInstances()).andReturn(instances);
  expect(instanceEntity.getResource()).andReturn(resourceEntity);
  expect(resourceEntity.getId()).andReturn(54L).anyTimes();
  expect(resourceEntity.getResourceType()).andReturn(resourceTypeEntity).anyTimes();
  expect(resourceTypeEntity.getId()).andReturn(ResourceType.VIEW.getId()).anyTimes();
  expect(resourceTypeEntity.getName()).andReturn(ResourceType.VIEW.name()).anyTimes();
  replay(viewEntity,instanceEntity,resourceEntity,resourceTypeEntity,configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createViewUser(resourceEntity.getId()));
  Assert.assertTrue(registry.includeDefinition(viewEntity));
  verify(viewEntity,instanceEntity,resourceEntity,resourceTypeEntity,configuration);
}

</code></pre>

<pre class="type-4 type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertTrue(viewInstanceDefinitions.isEmpty());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateViewInstance_invalid() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewConfig invalidConfig=ViewConfigTest.getConfig(XML_INVALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,invalidConfig.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  try {
    registry.updateViewInstance(updateInstance);
    Assert.fail("expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_UPDATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  try {
    registry.updateViewInstance(updateInstance);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,validator,result);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void resetGlobalMocks(){
  ViewRegistry.initInstance(getRegistry(viewDAO,viewInstanceDAO,userDAO,memberDAO,privilegeDAO,resourceDAO,resourceTypeDAO,securityHelper,handlerList,null,null,ambariMetaInfo,clusters));
  reset(viewDAO,resourceDAO,viewInstanceDAO,userDAO,memberDAO,privilegeDAO,resourceTypeDAO,securityHelper,configuration,handlerList,ambariMetaInfo,clusters);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadViewArchives_viewAutoInstanceCreation() throws Exception {
  testReadViewArchives(false,false,true);
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateViewInstance_validatorPass() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_UPDATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(true).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  registry.updateViewInstance(updateInstance);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,validator,result);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddInstanceDefinition() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=ViewEntityTest.getViewEntity();
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs().get(0);
  ViewInstanceEntity viewInstanceEntity=new ViewInstanceEntity(viewEntity,instanceConfig);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName(viewEntity.getName());
  viewEntity.setResourceType(resourceTypeEntity);
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setId(20L);
  resourceEntity.setResourceType(resourceTypeEntity);
  viewInstanceEntity.setResource(resourceEntity);
  registry.addDefinition(viewEntity);
  registry.addInstanceDefinition(viewEntity,viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstallViewInstance_invalid() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_INVALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  replay(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnAmbariEventServiceCreation_missingClusterService() throws Exception {
  Set<String> serviceNames=new HashSet<String>();
  serviceNames.add("STORM");
  serviceNames.add("HIVE");
  testOnAmbariEventServiceCreation(AUTO_VIEW_XML,serviceNames,false);
}

</code></pre>

<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForUserNoInstances(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  expect(viewEntity.getInstances()).andReturn(Collections.<ViewInstanceEntity>emptyList()).anyTimes();
  replay(viewEntity,configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createViewUser(1L));
  Assert.assertFalse(registry.includeDefinition(viewEntity));
  verify(viewEntity,configuration);
}

</code></pre>

<pre class="type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddGetInstanceDefinitions() throws Exception {
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=ViewInstanceEntityTest.getViewInstanceEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  registry.addDefinition(viewDefinition);
  registry.addInstanceDefinition(viewDefinition,viewInstanceDefinition);
  Assert.assertEquals(viewInstanceDefinition,registry.getInstanceDefinition("MY_VIEW","1.0.0","INSTANCE1"));
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewDefinition);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  Assert.assertEquals(viewInstanceDefinition,viewInstanceDefinitions.iterator().next());
}

</code></pre>

<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW","1.0.0");
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  registry.unregisterListener(listener,"MY_VIEW","1.0.0");
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadViewArchives_removeUndeployed() throws Exception {
  testReadViewArchives(false,true,false);
}

</code></pre>

<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Assert.assertTrue(viewInstanceEntity.isVisible());
  updateInstance.setLabel("new label");
  updateInstance.setDescription("new description");
  updateInstance.setVisible(false);
  registry.updateViewInstance(updateInstance);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals("new label",instanceEntity.getLabel());
  Assert.assertEquals("new description",instanceEntity.getDescription());
  Assert.assertFalse(instanceEntity.isVisible());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnAmbariEventServiceCreation_widcardStackVersion() throws Exception {
  Set<String> serviceNames=new HashSet<String>();
  serviceNames.add("HDFS");
  serviceNames.add("HIVE");
  testOnAmbariEventServiceCreation(AUTO_VIEW_WILD_STACK_XML,serviceNames,true);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnAmbariEventServiceCreation() throws Exception {
  Set<String> serviceNames=new HashSet<String>();
  serviceNames.add("HDFS");
  serviceNames.add("HIVE");
  testOnAmbariEventServiceCreation(AUTO_VIEW_XML,serviceNames,true);
}

</code></pre>

<pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExtractViewArchive() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  InputStream is=createMock(InputStream.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ViewExtractor viewExtractor=createMock(ViewExtractor.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",viewArchive);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",viewArchive);
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views");
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views");
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  Capture<ViewEntity> viewEntityCapture=new Capture<ViewEntity>();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work")).andReturn(true);
  }
 else {
    expect(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work")).andReturn(true);
  }
  expect(viewExtractor.extractViewArchive(capture(viewEntityCapture),eq(viewArchive),eq(archiveDir))).andReturn(null);
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  TestViewModule module=new TestViewModule(viewExtractor,archiveUtility,configuration);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(ViewRegistry.extractViewArchive("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",module,true));
  }
 else {
    Assert.assertTrue(ViewRegistry.extractViewArchive("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",module,true));
  }
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
}

</code></pre>

<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDefinition() throws Exception {
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName(viewDefinition.getName());
  viewDefinition.setResourceType(resourceTypeEntity);
  registry.addDefinition(viewDefinition);
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYING);
  Assert.assertNull(registry.getDefinition(resourceTypeEntity));
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYED);
  Assert.assertEquals(viewDefinition,registry.getDefinition(resourceTypeEntity));
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInstallViewInstance_validatorPass() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  handlerList.addViewInstance(viewInstanceEntity);
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(true).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetViewInstanceProperties() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  Map<String,String> instanceProperties=new HashMap<String,String>();
  instanceProperties.put("p1","newV1");
  instanceProperties.put("p2","newV2");
  registry.setViewInstanceProperties(viewInstanceEntity,instanceProperties,viewEntity.getConfiguration(),viewEntity.getClassLoader());
  Assert.assertEquals("newV1",viewInstanceEntity.getProperty("p1").getValue());
  Assert.assertEquals("bmV3VjI=",viewInstanceEntity.getProperty("p2").getValue());
}

</code></pre>

<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInstallViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  handlerList.addViewInstance(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,resourceTypeDAO,securityHelper,handlerList);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  Assert.assertEquals("MY_VIEW{1.0.0}",viewInstanceEntity.getResource().getResourceType().getName());
  verify(viewDAO,viewInstanceDAO,resourceTypeDAO,securityHelper,handlerList);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnAmbariEventServiceCreation_mismatchStackVersion() throws Exception {
  Set<String> serviceNames=new HashSet<String>();
  serviceNames.add("HDFS");
  serviceNames.add("HIVE");
  testOnAmbariEventServiceCreation(AUTO_VIEW_BAD_STACK_XML,serviceNames,false);
}

</code></pre>

<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRemoveInstanceData() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  viewInstanceEntity.putInstanceData("foo","value");
  ViewInstanceDataEntity dataEntity=viewInstanceEntity.getInstanceData("foo");
  viewInstanceDAO.removeData(dataEntity);
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.removeInstanceData(viewInstanceEntity,"foo");
  Assert.assertNull(viewInstanceEntity.getInstanceData("foo"));
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourceProviders() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  viewDefinition.setConfiguration(config);
  registry.setupViewDefinition(viewDefinition,getClass().getClassLoader());
  Map<Resource.Type,ResourceProvider> providerMap=registry.getResourceProviders();
  Assert.assertEquals(3,providerMap.size());
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/resource")));
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/subresource")));
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/resources")));
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void clearAuthentication(){
  SecurityContextHolder.getContext().setAuthentication(null);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
