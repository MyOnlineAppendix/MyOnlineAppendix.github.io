<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.ambari.msi.ClusterProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ClusterProvider provider=new ClusterProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ClusterProvider provider=new ClusterProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ComponentProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ComponentProvider provider=new ComponentProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ComponentProvider provider=new ComponentProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.HostComponentProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostComponentProvider provider=new HostComponentProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostComponentProvider provider=new HostComponentProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.HostProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.RequestProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  RequestProvider provider=new RequestProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  RequestProvider provider=new RequestProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ServiceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ServiceProvider provider=new ServiceProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ServiceProvider provider=new ServiceProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.TaskProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  TaskProvider provider=new TaskProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  TaskProvider provider=new TaskProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatHandler </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test @SuppressWarnings("unchecked") public void testIgnoreCustomActionReport() throws AmbariException, InvalidStateTransitionException {
  CommandReport cr1=new CommandReport();
  cr1.setActionId(StageUtils.getActionId(requestId,stageId));
  cr1.setTaskId(1);
  cr1.setClusterName(DummyCluster);
  cr1.setServiceName(HDFS);
  cr1.setRole(NAMENODE);
  cr1.setStatus(HostRoleStatus.FAILED.toString());
  cr1.setRoleCommand("CUSTOM_COMMAND");
  cr1.setStdErr("none");
  cr1.setStdOut("dummy output");
  cr1.setExitCode(0);
  CommandReport cr2=new CommandReport();
  cr2.setActionId(StageUtils.getActionId(requestId,stageId));
  cr2.setTaskId(2);
  cr2.setClusterName(DummyCluster);
  cr2.setServiceName(HDFS);
  cr2.setRole(NAMENODE);
  cr2.setStatus(HostRoleStatus.FAILED.toString());
  cr2.setRoleCommand("ACTIONEXECUTE");
  cr2.setStdErr("none");
  cr2.setStdOut("dummy output");
  cr2.setExitCode(0);
  ArrayList<CommandReport> reports=new ArrayList<CommandReport>();
  reports.add(cr1);
  reports.add(cr2);
  HeartBeat hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(0);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(reports);
  ActionQueue aq=new ActionQueue();
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  try {
    handler.handleHeartBeat(hb);
  }
 catch (  Exception e) {
    fail();
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidOSRegistration() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS("MegaOperatingSystem");
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non matching os type");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIncompatibleAgentRegistration() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion("0.0.0");
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non compatible agent version");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegistrationWithBadVersion() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion("");
  reg.setPrefix(Configuration.PREFIX_DIR);
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non compatible agent version");
  }
 catch (  AmbariException e) {
    log.debug("Error:" + e.getMessage());
    Assert.assertTrue(e.getMessage().contains("Cannot register host with non compatible agent version"));
  }
  reg.setAgentVersion(null);
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non compatible agent version");
  }
 catch (  AmbariException e) {
    log.debug("Error:" + e.getMessage());
    Assert.assertTrue(e.getMessage().contains("Cannot register host with non compatible agent version"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatMonitor </h4><pre class="type-12 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeatStateCommandsEnqueueing() throws AmbariException, InterruptedException, InvalidStateTransitionException {
  StackId stackId=new StackId("HDP-0.1");
  Clusters clusters=injector.getInstance(Clusters.class);
  clusters.addHost(hostname1);
  setOsFamily(clusters.getHost(hostname1),"redhat","5.9");
  clusters.getHost(hostname1).persist();
  clusters.addCluster(clusterName,stackId);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Set<String> hostNames=new HashSet<String>(){
{
      add(hostname1);
    }
  }
;
  clusters.mapHostsToCluster(hostNames,clusterName);
  Service hdfs=cluster.addService(serviceName);
  hdfs.persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.SECONDARY_NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  ActionQueue aqMock=mock(ActionQueue.class);
  ArgumentCaptor<AgentCommand> commandCaptor=ArgumentCaptor.forClass(AgentCommand.class);
  ActionManager am=mock(ActionManager.class);
  HeartbeatMonitor hm=new HeartbeatMonitor(clusters,aqMock,am,heartbeatMonitorWakeupIntervalMS,injector);
  HeartBeatHandler handler=new HeartBeatHandler(clusters,aqMock,am,injector);
  Register reg=new Register();
  reg.setHostname(hostname1);
  reg.setResponseId(12);
  reg.setTimestamp(System.currentTimeMillis() - 15);
  reg.setAgentVersion(ambariMetaInfo.getServerVersion());
  HostInfo hi=new HostInfo();
  hi.setOS("Centos5");
  reg.setHardwareProfile(hi);
  handler.handleRegistration(reg);
  HeartBeat hb=new HeartBeat();
  hb.setHostname(hostname1);
  hb.setNodeStatus(new HostStatus(HostStatus.Status.HEALTHY,"cool"));
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(13);
  handler.handleHeartBeat(hb);
  LOG.info("YYY");
  clusters.getHost(hostname1).setLastHeartbeatTime(System.currentTimeMillis() - 15);
  hm.start();
  Thread.sleep(3 * heartbeatMonitorWakeupIntervalMS);
  hm.shutdown();
  int tryNumber=0;
  while (hm.isAlive()) {
    hm.join(2 * heartbeatMonitorWakeupIntervalMS);
    tryNumber++;
    if (tryNumber >= 5) {
      fail("HeartbeatMonitor should be already stopped");
    }
  }
  verify(aqMock,atLeast(2)).enqueue(eq(hostname1),commandCaptor.capture());
  List<AgentCommand> cmds=commandCaptor.getAllValues();
  assertTrue("HeartbeatMonitor should generate StatusCommands for host1",cmds.size() >= 2);
  for (  AgentCommand command : cmds) {
    assertEquals("HDFS",((StatusCommand)command).getServiceName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.AmbariErrorHandlerTest </h4><pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorWithJetty() throws Exception {
  Server server=new Server(0);
  Configuration configuration=new Configuration();
  ServletContextHandler root=new ServletContextHandler(server,"/",ServletContextHandler.SECURITY | ServletContextHandler.SESSIONS);
  root.addServlet(HelloServlet.class,"/hello");
  root.addServlet(DefaultServlet.class,"/");
  root.setErrorHandler(new AmbariErrorHandler(gson,configuration));
  server.start();
  Connector connector=server.getConnectors()[0];
  int localPort=((ServerConnector)connector).getLocalPort();
  Client client=new Client();
  WebResource resource=client.resource("http://localhost:" + localPort + "/");
  ClientResponse successResponse=resource.path("hello").get(ClientResponse.class);
  assertEquals(HttpServletResponse.SC_OK,successResponse.getStatus());
  ClientResponse failResponse=resource.path("fail").get(ClientResponse.class);
  assertEquals(HttpServletResponse.SC_NOT_FOUND,failResponse.getStatus());
  try {
    String response=failResponse.getEntity(String.class);
    System.out.println(response);
    Map map;
    map=gson.fromJson(response,Map.class);
    System.out.println(map);
    assertNotNull("Incorrect response status",map.get("status"));
    assertNotNull("Incorrect response message",map.get("message"));
  }
 catch (  JsonSyntaxException e1) {
    fail("Incorrect response");
  }
  server.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.CreateHandlerTest </h4><pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.CREATED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Resource requestResource=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2,requestResource);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2,requestResource);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(request.getBody()).andReturn(body);
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.CREATED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.DeleteHandlerTest </h4><pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Resource requestResource=createMock(Resource.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,requestResource,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,requestResource,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.UpdateHandlerTest </h4><pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Resource requestResource=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,requestResource,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,requestResource,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.predicate.QueryLexerTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTokens_invalidLogicalOp(){
  try {
    new QueryLexer().tokens("foo=1<5=2");
    fail("Expected InvalidQueryException due to invalid logical op");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTokens_invalidLogicalOp2(){
  try {
    new QueryLexer().tokens("foo=1&&5=2");
    fail("Expected InvalidQueryException due to invalid logical op");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTokens_invalidRelationalOp(){
  try {
    new QueryLexer().tokens("foo=1&bar|5");
    fail("Expected InvalidQueryException due to invalid relational op");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.predicate.QueryParserTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_mismatchedBrackets(){
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"1"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.BRACKET_OPEN,"("));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"<="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"b"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"2"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"|"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,">"));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"c"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"3"));
  try {
    new QueryParser().parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Expected InvalidQueryException due to missing closing bracket");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_FilterOp_exception() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".matches("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"foo"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  try {
    Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Filter operator is missing a required right operand.");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_InOp__exception() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".in("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"foo"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  try {
    parser.parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Expected InvalidQueryException due to missing right operand");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_isEmptyOp__exception2() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".isEmpty("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"category1"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"one,two,3"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  try {
    parser.parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Expected InvalidQueryException due to existence of right operand");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_outOfOrderTokens(){
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"1"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  try {
    new QueryParser().parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Expected InvalidQueryException due to invalid last token");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_isEmptyOp__exception() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".isEmpty("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"category1"));
  QueryParser parser=new QueryParser();
  try {
    parser.parse(listTokens.toArray(new Token[listTokens.size()]));
    fail("Expected InvalidQueryException due to missing closing bracket");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.QueryImplTest </h4><pre class="type-4 type-13 type-10 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJoinedResourceProperties() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("versions/*",null);
  instance.addProperty("versions/operating_systems/*",null);
  instance.addProperty("versions/operating_systems/repositories/*",null);
  instance.execute();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("versions/operating_systems/repositories/Repositories/repo_id");
  propertyIds.add("versions/operating_systems/OperatingSystems/os_type");
  Map<Resource,Set<Map<String,Object>>> resourcePropertiesMap=instance.getJoinedResourceProperties(propertyIds,null,null);
  Set<Map<String,Object>> propertyMaps=null;
  for (  Map.Entry<Resource,Set<Map<String,Object>>> resourceSetEntry : resourcePropertiesMap.entrySet()) {
    Assert.assertEquals(Resource.Type.Stack,resourceSetEntry.getKey().getType());
    propertyMaps=resourceSetEntry.getValue();
  }
  if (propertyMaps == null) {
    fail("No property maps found!");
  }
  Assert.assertEquals(6,propertyMaps.size());
  for (  Map<String,Object> map : propertyMaps) {
    Assert.assertEquals(2,map.size());
    Assert.assertTrue(map.containsKey("versions/operating_systems/OperatingSystems/os_type"));
    Assert.assertTrue(map.containsKey("versions/operating_systems/repositories/Repositories/repo_id"));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecute_NoSuchResourceException() throws Exception {
  ResourceDefinition resourceDefinition=new ClusterResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"c1");
  ClusterController clusterController=createNiceMock(ClusterController.class);
  QueryResponse queryResponse=createNiceMock(QueryResponse.class);
  Schema schema=createNiceMock(Schema.class);
  Renderer renderer=createNiceMock(Renderer.class);
  expect(clusterController.getSchema(Resource.Type.Cluster)).andReturn(schema).anyTimes();
  expect(clusterController.getResources(eq(Resource.Type.Cluster),anyObject(org.apache.ambari.server.controller.spi.Request.class),anyObject(Predicate.class))).andReturn(queryResponse);
  expect(queryResponse.getResources()).andReturn(Collections.<Resource>emptySet()).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  TreeNode<Set<String>> treeNode=new TreeNodeImpl<Set<String>>(null,Collections.EMPTY_SET,null);
  expect(renderer.finalizeProperties(anyObject(TreeNode.class),anyBoolean())).andReturn(treeNode).anyTimes();
  replay(clusterController,queryResponse,schema,renderer);
  QueryImpl query=new TestQuery(mapIds,resourceDefinition,clusterController);
  query.setRenderer(renderer);
  try {
    query.execute();
    fail("Expected NoSuchResourceException!");
  }
 catch (  NoSuchResourceException e) {
  }
  verify(clusterController,queryResponse,schema,renderer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.BaseResourceDefinitionTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRenderer(){
  ResourceDefinition resource=getResourceDefinition();
  assertTrue(resource.getRenderer(null) instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("default") instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("minimal") instanceof MinimalRenderer);
  try {
    resource.getRenderer("foo");
    fail("Should have thrown an exception due to invalid renderer type");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ClusterResourceDefinitionTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRenderer(){
  ResourceDefinition resource=new ClusterResourceDefinition();
  assertTrue(resource.getRenderer(null) instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("default") instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("minimal") instanceof MinimalRenderer);
  assertTrue(resource.getRenderer("blueprint") instanceof ClusterBlueprintRenderer);
  try {
    resource.getRenderer("foo");
    fail("Should have thrown an exception due to invalid renderer type");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.AmbariMetaInfoTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepos() throws Exception {
  Map<String,List<RepositoryInfo>> repos=metaInfo.getRepository(STACK_NAME_HDP,STACK_VERSION_HDP);
  Set<String> centos5Cnt=new HashSet<String>();
  Set<String> centos6Cnt=new HashSet<String>();
  Set<String> redhat6cnt=new HashSet<String>();
  Set<String> redhat5cnt=new HashSet<String>();
  for (  List<RepositoryInfo> vals : repos.values()) {
    for (    RepositoryInfo repo : vals) {
      LOG.debug("Dumping repo info : " + repo.toString());
      if (repo.getOsType().equals("centos5")) {
        centos5Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("centos6")) {
        centos6Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat6")) {
        redhat6cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat5")) {
        redhat5cnt.add(repo.getRepoId());
      }
 else {
        fail("Found invalid os " + repo.getOsType());
      }
      if (repo.getRepoId().equals("epel")) {
        assertFalse(repo.getMirrorsList().isEmpty());
        assertNull(repo.getBaseUrl());
      }
 else {
        assertNull(repo.getMirrorsList());
        assertFalse(repo.getBaseUrl().isEmpty());
      }
    }
  }
  assertEquals(3,centos5Cnt.size());
  assertEquals(3,redhat6cnt.size());
  assertEquals(3,redhat5cnt.size());
  assertEquals(3,centos6Cnt.size());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHBase134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HBASE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(3,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("HBASE_MASTER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_SERVER")) {
          Assert.assertEquals("cluster",dependency.getScope());
          AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
          Assert.assertEquals(true,autoDeploy.isEnabled());
          Assert.assertEquals("HBASE/HBASE_MASTER",autoDeploy.getCoLocate());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HBASE_REGIONSERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1+",component.getCardinality());
    }
    if (name.equals("HBASE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSqoop134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","SQOOP");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("SQOOP",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(2,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("0+",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWebHCat134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","WEBHCAT");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("WEBHCAT_SERVER",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(4,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_SERVER")) {
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertEquals(true,autoDeploy.isEnabled());
      Assert.assertEquals("WEBHCAT/WEBHCAT_SERVER",autoDeploy.getCoLocate());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("1",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOozie134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","OOZIE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(2,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("OOZIE_SERVER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("OOZIE_CLIENT")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLatestRepo() throws Exception {
  StackManager sm=metaInfo.getStackManager();
  int maxWait=45000;
  int waitTime=0;
  while (waitTime < maxWait && !sm.haveAllRepoUrlsBeenResolved()) {
    Thread.sleep(5);
    waitTime+=5;
  }
  if (waitTime >= maxWait) {
    fail("Latest Repo tasks did not complete");
  }
  for (  RepositoryInfo ri : metaInfo.getRepositories("HDP","2.1.1","centos6")) {
    Assert.assertEquals("Expected the base url to be set properly","http://s3.amazonaws.com/dev.hortonworks.com/HDP/centos6/2.x/BUILDS/2.1.1.0-118",ri.getLatestBaseUrl());
    Assert.assertEquals("Expected the default URL to be the same as in the xml file","http://public-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0",ri.getDefaultBaseUrl());
  }
  for (  RepositoryInfo ri : metaInfo.getRepositories("HDP","2.1.1","suse11")) {
    Assert.assertEquals("Expected hdp.json to be stripped from the url","http://s3.amazonaws.com/dev.hortonworks.com/HDP/suse11/2.x/BUILDS/2.1.1.0-118",ri.getLatestBaseUrl());
  }
  for (  RepositoryInfo ri : metaInfo.getRepositories("HDP","2.1.1","sles11")) {
    Assert.assertEquals("http://s3.amazonaws.com/dev.hortonworks.com/HDP/suse11/2.x/BUILDS/2.1.1.0-118",ri.getLatestBaseUrl());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.ViewExternalSubResourceServiceTest </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddResourceService() throws Exception {
  Resource.Type type=new Resource.Type("resource");
  ViewInstanceEntity definition=ViewInstanceEntityTest.getViewInstanceEntity();
  ViewExternalSubResourceService service=new ViewExternalSubResourceService(type,definition);
  Object fooService=new Object();
  service.addResourceService("foo",fooService);
  Assert.assertEquals(fooService,service.getResource("foo"));
  try {
    service.getResource("bar");
    Assert.fail("Expected IllegalArgumentException for unknown service name.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.parsers.JsonRequestBodyParserTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse_QueryPost() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostJson).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  boolean contains3=false;
  for (  NamedPropertySet ps : setProperties) {
    Map<String,Object> mapProps=ps.getProperties();
    assertEquals(1,mapProps.size());
    Set<Map<String,Object>> set=(Set<Map<String,Object>>)mapProps.get("services");
    for (    Map<String,Object> map : set) {
      String serviceName=(String)map.get("ServiceInfo/service_name");
      if (serviceName.equals("unitTestService1")) {
        assertEquals(1,map.size());
        contains1=true;
      }
 else       if (serviceName.equals("unitTestService2")) {
        assertEquals("prop1Value",map.get("ServiceInfo/property1"));
        assertEquals(2,map.size());
        contains2=true;
      }
 else       if (serviceName.equals("unitTestService3")) {
        assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
        assertEquals(2,map.size());
        contains3=true;
      }
 else {
        fail("Unexpected service name");
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  assertTrue(contains3);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
  assertEquals("java.util.LinkedHashSet",body.getNamedPropertySets().iterator().next().getProperties().get("services").getClass().getName());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse___QueryPost_QueryInBody() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostJsonWithQuery).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals("foo=bar",body.getQueryString());
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  boolean contains3=false;
  for (  NamedPropertySet ps : setProperties) {
    assertEquals("",ps.getName());
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      Set<Map<String,Object>> set=(Set<Map<String,Object>>)entry.getValue();
      for (      Map<String,Object> map : set) {
        String serviceName=(String)map.get("ServiceInfo/service_name");
        if (serviceName.equals("unitTestService1")) {
          assertEquals(1,map.size());
          contains1=true;
        }
 else         if (serviceName.equals("unitTestService2")) {
          assertEquals("prop1Value",map.get("ServiceInfo/property1"));
          assertEquals(2,map.size());
          contains2=true;
        }
 else         if (serviceName.equals("unitTestService3")) {
          assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
          assertEquals(2,map.size());
          contains3=true;
        }
 else {
          fail("Unexpected service name");
        }
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  assertTrue(contains3);
  String b=body.getBody();
  assertEquals(queryPostJsonWithQuery,b);
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParse_malformedBody(){
  RequestBodyParser parser=new JsonRequestBodyParser();
  try {
    parser.parse(malformedJson);
    fail("Expected exception due to malformed body");
  }
 catch (  BodyParseException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse___QueryPost_multipleSubResTypes() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostMultipleSubResourcesJson).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  for (  NamedPropertySet ps : setProperties) {
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      Set<Map<String,Object>> set=(Set<Map<String,Object>>)entry.getValue();
      for (      Map<String,Object> map : set) {
        String serviceName=(String)map.get("ServiceInfo/service_name");
        if (serviceName.equals("unitTestService1")) {
          assertEquals("foo",entry.getKey());
          assertEquals(1,map.size());
          contains1=true;
        }
 else         if (serviceName.equals("unitTestService2")) {
          assertEquals("bar",entry.getKey());
          assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
          assertEquals(2,map.size());
          contains2=true;
        }
 else {
          fail("Unexpected service name");
        }
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorBlueprintProcessorTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdviseConfigurationWhenConfigurationRecommendFails() throws StackAdvisorException, ConfigurationTopologyException {
  Map<String,AdvisedConfiguration> advisedConfigurations=new HashMap<String,AdvisedConfiguration>();
  expect(clusterTopology.getBlueprint()).andReturn(blueprint).anyTimes();
  expect(clusterTopology.getHostGroupInfo()).andReturn(createHostGroupInfo()).anyTimes();
  expect(clusterTopology.getAdvisedConfigurations()).andReturn(advisedConfigurations).anyTimes();
  expect(clusterTopology.getConfiguration()).andReturn(configuration).anyTimes();
  expect(clusterTopology.isClusterKerberosEnabled()).andReturn(false).anyTimes();
  expect(blueprint.getStack()).andReturn(stack).anyTimes();
  expect(stack.getVersion()).andReturn("2.3").anyTimes();
  expect(stack.getName()).andReturn("HDP").anyTimes();
  expect(blueprint.getHostGroups()).andReturn(createHostGroupMap()).anyTimes();
  expect(hostGroup.getComponentNames()).andReturn(Arrays.asList("comp1","comp2")).anyTimes();
  expect(blueprint.getServices()).andReturn(Arrays.asList("HDFS","YARN","HIVE")).anyTimes();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andThrow(new StackAdvisorException("ex"));
  expect(configuration.getFullProperties()).andReturn(createProps());
  replay(clusterTopology,blueprint,stack,hostGroup,configuration,stackAdvisorHelper);
  try {
    underTest.adviseConfiguration(clusterTopology);
    fail("Invalid state");
  }
 catch (  ConfigurationTopologyException e) {
    assertEquals(StackAdvisorBlueprintProcessor.RECOMMENDATION_FAILED,e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdviseConfigurationWhenConfigurationRecommendHasInvalidResponse() throws StackAdvisorException, ConfigurationTopologyException {
  Map<String,AdvisedConfiguration> advisedConfigurations=new HashMap<String,AdvisedConfiguration>();
  expect(clusterTopology.getBlueprint()).andReturn(blueprint).anyTimes();
  expect(clusterTopology.getHostGroupInfo()).andReturn(createHostGroupInfo()).anyTimes();
  expect(clusterTopology.getAdvisedConfigurations()).andReturn(advisedConfigurations).anyTimes();
  expect(clusterTopology.getConfiguration()).andReturn(configuration).anyTimes();
  expect(clusterTopology.isClusterKerberosEnabled()).andReturn(false).anyTimes();
  expect(blueprint.getStack()).andReturn(stack).anyTimes();
  expect(stack.getVersion()).andReturn("2.3").anyTimes();
  expect(stack.getName()).andReturn("HDP").anyTimes();
  expect(blueprint.getServices()).andReturn(Arrays.asList("HDFS","YARN","HIVE")).anyTimes();
  expect(blueprint.getHostGroups()).andReturn(createHostGroupMap()).anyTimes();
  expect(hostGroup.getComponentNames()).andReturn(Arrays.asList("comp1","comp2")).anyTimes();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(new RecommendationResponse());
  expect(configuration.getFullProperties()).andReturn(createProps());
  replay(clusterTopology,blueprint,stack,hostGroup,configuration,stackAdvisorHelper);
  try {
    underTest.adviseConfiguration(clusterTopology);
    fail("Invalid state");
  }
 catch (  ConfigurationTopologyException e) {
    assertEquals(StackAdvisorBlueprintProcessor.INVALID_RESPONSE,e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorRunnerTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRunScript_processExitCodeZero_returnTrue() throws Exception {
  String script="echo";
  StackAdvisorCommandType saCommandType=StackAdvisorCommandType.RECOMMEND_COMPONENT_LAYOUT;
  File actionDirectory=temp.newFolder("actionDir");
  ProcessBuilder processBuilder=createNiceMock(ProcessBuilder.class);
  Process process=createNiceMock(Process.class);
  StackAdvisorRunner saRunner=new StackAdvisorRunner();
  stub(PowerMock.method(StackAdvisorRunner.class,"prepareShellCommand")).toReturn(processBuilder);
  expect(processBuilder.start()).andReturn(process);
  expect(process.waitFor()).andReturn(0);
  replay(processBuilder,process);
  try {
    saRunner.runScript(script,saCommandType,actionDirectory);
  }
 catch (  StackAdvisorException ex) {
    fail("Should not fail with StackAdvisorException");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariCustomCommandExecutionHelperTest </h4><pre class="type-10 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that trying to run a service check when there are no available hosts
 * will throw an exception.
 */
@Test(expected=AmbariException.class) public void testNoCandidateHostThrowsException() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  long clusterId=clusters.getCluster("c1").getClusterId();
  clusters.getHost("c6402").setMaintenanceState(clusterId,MaintenanceState.ON);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("ZOOKEEPER");
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put("context","Service Check ZooKeeper");
      put("operation_level/level","SERVICE");
      put("operation_level/service_name","ZOOKEEPER");
      put("operation_level/cluster_name","c1");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","ZOOKEEPER_QUORUM_SERVICE_CHECK",null,Arrays.asList(new RequestResourceFilter("ZOOKEEPER","ZOOKEEPER_CLIENT",Collections.singletonList("c6402"))),new RequestOperationLevel(Resource.Type.Service,"c1","ZOOKEEPER",null,null),new HashMap<String,String>(){
{
    }
  }
,false);
  controller.createAction(actionRequest,requestProperties);
  Assert.fail("Expected an exception since there are no hosts which can run the ZK service check");
}

</code></pre>

<br>
<pre class="type-10 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that client-only services like TEZ are not run on hosts which are in
 * MM. The client-only service is a special path since a component is
 * typically not specified in the request.
 */
@Test(expected=AmbariException.class) public void testServiceCheckMaintenanceModeWithMissingComponentName() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  long clusterId=clusters.getCluster("c1").getClusterId();
  clusters.getHost("c6402").setMaintenanceState(clusterId,MaintenanceState.ON);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("ZOOKEEPER");
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put("context","Service Check ZooKeeper");
      put("operation_level/level",null);
      put("operation_level/service_name","ZOOKEEPER");
      put("operation_level/cluster_name","c1");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","ZOOKEEPER_QUORUM_SERVICE_CHECK",null,Arrays.asList(new RequestResourceFilter("ZOOKEEPER",null,Collections.singletonList("c6402"))),new RequestOperationLevel(Resource.Type.Service,"c1","ZOOKEEPER",null,null),new HashMap<String,String>(){
{
    }
  }
,false);
  controller.createAction(actionRequest,requestProperties);
  Assert.fail("Expected an exception since there are no hosts which can run the ZK service check");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerImplTest </h4><pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_HostNotFoundException_hostProvidedInURL() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host1",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getClustersForHost("host1")).andThrow(new HostNotFoundException("host1"));
  replay(maintHelper,injector,clusters,cluster,stack,ambariMetaInfo);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  try {
    controller.getHostComponents(setRequests);
    fail("expected exception");
  }
 catch (  AmbariException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(injector,clusters,cluster,stack,ambariMetaInfo);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVerifyRepositories() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  RepositoryInfo dummyRepoInfo=new RepositoryInfo();
  dummyRepoInfo.setRepoName("repo_name");
  expect(ambariMetaInfo.getRepository("stackName","stackVersion","redhat6","repoId")).andReturn(dummyRepoInfo);
  Configuration configuration=createNiceMock(Configuration.class);
  String[] suffices={"/repodata/repomd.xml"};
  expect(configuration.getRepoValidationSuffixes("redhat6")).andReturn(suffices);
  replay(injector,clusters,ambariMetaInfo,configuration);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Class<?> c=controller.getClass();
  Field f=c.getDeclaredField("configs");
  f.setAccessible(true);
  f.set(controller,configuration);
  Set<RepositoryRequest> requests=new HashSet<RepositoryRequest>();
  RepositoryRequest request=new RepositoryRequest("stackName","stackVersion","redhat6","repoId");
  request.setBaseUrl("file:///some/repo");
  requests.add(request);
  try {
    controller.verifyRepositories(requests);
    Assert.fail("IllegalArgumentException is expected");
  }
 catch (  IllegalArgumentException e) {
    Assert.assertEquals("Could not access base url . file:///some/repo/repodata/repomd.xml . ",e.getMessage());
  }
  verify(injector,clusters,ambariMetaInfo,configuration);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that when the cluster security type updated from KERBEROS to NONE, KerberosHandler.toggleKerberos
 * IS invoked
 */
@Test public void testUpdateClustersToggleKerberos_Fail() throws Exception {
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Injector injector=createStrictMock(Injector.class);
  Cluster cluster=createMock(Cluster.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  ClusterRequest clusterRequest=createNiceMock(ClusterRequest.class);
  Set<ClusterRequest> setRequests=Collections.singleton(clusterRequest);
  KerberosHelper kerberosHelper=createStrictMock(KerberosHelper.class);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(kerberosHelper);
  expect(clusterRequest.getClusterId()).andReturn(1L).times(6);
  expect(clusterRequest.getSecurityType()).andReturn(SecurityType.NONE).anyTimes();
  expect(clusters.getClusterById(1L)).andReturn(cluster).times(2);
  expect(cluster.getResourceId()).andReturn(1L).times(3);
  expect(cluster.getClusterName()).andReturn("cluster").times(1);
  expect(cluster.getSecurityType()).andReturn(SecurityType.KERBEROS).anyTimes();
  expect(cluster.getCurrentClusterVersion()).andReturn(null).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(null).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(null).anyTimes();
  cluster.setCurrentStackVersion(anyObject(StackId.class));
  expectLastCall().once();
  cluster.setClusterName(anyObject(String.class));
  expectLastCall().once();
  cluster.addSessionAttributes(anyObject(Map.class));
  expectLastCall().once();
  expect(kerberosHelper.shouldExecuteCustomOperations(SecurityType.NONE,null)).andReturn(false).once();
  expect(kerberosHelper.getManageIdentitiesDirective(anyObject(Map.class))).andReturn(null).once();
  expect(kerberosHelper.toggleKerberos(anyObject(Cluster.class),anyObject(SecurityType.class),anyObject(RequestStageContainer.class),anyBoolean())).andThrow(new IllegalArgumentException("bad args!")).once();
  replay(actionManager,cluster,clusters,injector,clusterRequest,sessionManager,kerberosHelper);
  AmbariManagementController controller=new AmbariManagementControllerImpl(actionManager,clusters,injector);
  try {
    controller.updateClusters(setRequests,null);
    Assert.fail("IllegalArgumentException not thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(actionManager,cluster,clusters,injector,clusterRequest,sessionManager,kerberosHelper);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_ClusterNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host2",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andThrow(new ClusterNotFoundException("cluster1"));
  replay(maintHelper,injector,clusters,stack,ambariMetaInfo);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  try {
    controller.getHostComponents(setRequests);
    fail("expected exception");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(injector,clusters,stack,ambariMetaInfo);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that RollbackException is thrown outside the updateClusters method
 * when a unique constraint violation occurs.
 */
@Test public void testUpdateClusters__RollbackException() throws Exception {
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Injector injector=createStrictMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  ClusterRequest clusterRequest=createNiceMock(ClusterRequest.class);
  Set<ClusterRequest> setRequests=Collections.singleton(clusterRequest);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusterRequest.getClusterName()).andReturn("clusterNew").times(3);
  expect(clusterRequest.getClusterId()).andReturn(1L).times(6);
  expect(clusters.getClusterById(1L)).andReturn(cluster).times(2);
  expect(cluster.getClusterName()).andReturn("clusterOld").times(1);
  cluster.setClusterName("clusterNew");
  expectLastCall().andThrow(new RollbackException());
  replay(actionManager,cluster,clusters,injector,clusterRequest,sessionManager);
  AmbariManagementController controller=new AmbariManagementControllerImpl(actionManager,clusters,injector);
  try {
    controller.updateClusters(setRequests,null);
    fail("Expected RollbackException");
  }
 catch (  RollbackException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(actionManager,cluster,clusters,injector,clusterRequest,sessionManager);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___ServiceComponentHostNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster));
  expect(cluster.getDesiredStackVersion()).andReturn(stack);
  expect(stack.getStackName()).andReturn("stackName");
  expect(stack.getStackVersion()).andReturn("stackVersion");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1").anyTimes();
  expect(component.getServiceComponentHosts()).andReturn(null);
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,component);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  try {
    controller.getHostComponents(setRequests);
    fail("expected ServiceComponentHostNotFoundException");
  }
 catch (  ServiceComponentHostNotFoundException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,component);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Ensure that ClusterNotFoundException is propagated in case where there is a single request.
 */
@Test public void testGetClusters___ClusterNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  ClusterRequest request1=new ClusterRequest(null,"cluster1","1",Collections.<String>emptySet());
  Set<ClusterRequest> setRequests=new HashSet<ClusterRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andThrow(new ClusterNotFoundException("cluster1"));
  replay(injector,clusters);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  try {
    controller.getClusters(setRequests);
    fail("expected ClusterNotFoundException");
  }
 catch (  ClusterNotFoundException e) {
  }
  verify(injector,clusters);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHosts() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-0.2",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,"centos5");
  setupClusterWithHosts("c2","HDP-0.2",new ArrayList<String>(){
{
      add("h3");
    }
  }
,"centos5");
  clusters.addHost("h4");
  setOsFamily(clusters.getHost("h4"),"redhat","5.9");
  clusters.getHost("h4").persist();
  Map<String,String> attrs=new HashMap<String,String>();
  attrs.put("a1","b1");
  clusters.getHost("h3").setHostAttributes(attrs);
  attrs.put("a2","b2");
  clusters.getHost("h4").setHostAttributes(attrs);
  HostRequest r=new HostRequest(null,null,null);
  Set<HostResponse> resps=HostResourceProviderTest.getHosts(controller,Collections.singleton(r));
  Assert.assertEquals(4,resps.size());
  Set<String> foundHosts=new HashSet<String>();
  for (  HostResponse resp : resps) {
    foundHosts.add(resp.getHostname());
    if (resp.getHostname().equals("h1")) {
      Assert.assertEquals("c1",resp.getClusterName());
      Assert.assertEquals(2,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h2")) {
      Assert.assertEquals("c1",resp.getClusterName());
      Assert.assertEquals(2,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h3")) {
      Assert.assertEquals("c2",resp.getClusterName());
      Assert.assertEquals(3,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h4")) {
      Assert.assertEquals("",resp.getClusterName());
      Assert.assertEquals(4,resp.getHostAttributes().size());
    }
 else {
      fail("Found invalid host");
    }
  }
  Assert.assertEquals(4,foundHosts.size());
  r=new HostRequest("h1",null,null);
  resps=HostResourceProviderTest.getHosts(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  HostResponse resp=resps.iterator().next();
  Assert.assertEquals("h1",resp.getHostname());
  Assert.assertEquals("c1",resp.getClusterName());
  Assert.assertEquals(2,resp.getHostAttributes().size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testUpdateClusterVersionBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  String serviceName="MAPREDUCE";
  String host1="h1";
  String host2="h2";
  String componentName="JOBTRACKER";
  StackId currentStackId=new StackId("HDP-0.1");
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createCluster(clusterName);
  Cluster c=clusters.getCluster(clusterName);
  c.setDesiredStackVersion(currentStackId);
  createService(clusterName,serviceName,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName,null);
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName,host1,null);
  createServiceComponentHost(clusterName,null,componentName,host2,null);
  c.getService(serviceName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setStackVersion(currentStackId);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setStackVersion(currentStackId);
  ClusterRequest r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.0.1",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("must be greater than current version"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDPLocal-1.2.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade not possible between different stacks"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(serviceName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(componentName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  StackId expectedStackId=new StackId("HDP-0.2");
  Assert.assertTrue(expectedStackId.equals(c.getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getDesiredStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getStackVersion()));
  ServiceComponent sc=c.getService(serviceName).getServiceComponent(componentName);
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host2).getState());
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("A prior upgrade request with id"));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  c.setCurrentStackVersion(expectedStackId);
  r=new ClusterRequest(c.getClusterId(),clusterName,"",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,null,null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testServiceUpdateInvalidRequest() throws AmbariException, AuthorizationException {
  String clusterName1="foo1";
  createCluster(clusterName1);
  String clusterName2="foo2";
  createCluster(clusterName2);
  String serviceName1="HDFS";
  createService(clusterName1,serviceName1,null);
  String serviceName2="HBASE";
  String serviceName3="HBASE";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  try {
    createService(clusterName2,serviceName3,null);
    fail("Expected fail for invalid service for stack 0.1");
  }
 catch (  Exception e) {
  }
  clusters.getCluster(clusterName1).setDesiredStackVersion(new StackId("HDP-0.2"));
  clusters.getCluster(clusterName2).setDesiredStackVersion(new StackId("HDP-0.2"));
  createService(clusterName1,serviceName2,null);
  createService(clusterName2,serviceName3,null);
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest req1, req2;
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName1,serviceName1,State.INSTALLED.toString());
    req2=new ServiceRequest(clusterName2,serviceName2,State.INSTALLED.toString());
    reqs.add(req1);
    reqs.add(req2);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for multi cluster update");
  }
 catch (  Exception e) {
  }
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName1,serviceName1,State.INSTALLED.toString());
    req2=new ServiceRequest(clusterName1,serviceName1,State.INSTALLED.toString());
    reqs.add(req1);
    reqs.add(req2);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for dups services");
  }
 catch (  Exception e) {
  }
  clusters.getCluster(clusterName1).getService(serviceName2).setDesiredState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName1,serviceName1,State.INSTALLED.toString());
    req2=new ServiceRequest(clusterName1,serviceName2,State.STARTED.toString());
    reqs.add(req1);
    reqs.add(req2);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for different states");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceNotFoundException is propagated in case where there is a single request.
 */
@Test public void testGetServices___ServiceNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ServiceRequest request1=new ServiceRequest("cluster1","service1",null);
  Set<ServiceRequest> setRequests=new HashSet<ServiceRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createStrictMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andThrow(new ServiceNotFoundException("custer1","service1"));
  replay(maintHelper,injector,clusters,cluster);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  try {
    ServiceResourceProviderTest.getServices(controller,setRequests);
    fail("expected ServiceNotFoundException");
  }
 catch (  ServiceNotFoundException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(injector,clusters,cluster);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecretReferences() throws AmbariException, AuthorizationException {
  final String host1="h1";
  final String host2="h2";
  Long clusterId=1L;
  String clusterName="foo1";
  Cluster cl=setupClusterWithHosts(clusterName,"HDP-2.0.5",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  ClusterRequest crReq;
  ConfigurationRequest cr;
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("test.password","first");
      put("test.password.empty","");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:1:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","brandNewPassword");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:666:test.password");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
  }
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version4",new HashMap<String,String>(){
{
      put("foo","bar");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version5",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:4:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
    assertEquals("Error when parsing secret reference. Cluster: foo1 ConfigType: hdfs-site ConfigVersion: 4 does not contain property 'test.password'",e.getMessage());
  }
  cl.getAllConfigs();
  assertEquals(cl.getAllConfigs().size(),4);
  Config v1=cl.getConfigByVersion("hdfs-site",1l);
  Config v2=cl.getConfigByVersion("hdfs-site",2l);
  Config v3=cl.getConfigByVersion("hdfs-site",3l);
  Config v4=cl.getConfigByVersion("hdfs-site",4l);
  assertEquals(v1.getProperties().get("test.password"),"first");
  assertEquals(v2.getProperties().get("test.password"),"first");
  assertEquals(v3.getProperties().get("test.password"),"brandNewPassword");
  assertFalse(v4.getProperties().containsKey("test.password"));
  final ConfigurationRequest configRequest=new ConfigurationRequest(clusterName,"hdfs-site",null,null,null);
  configRequest.setIncludeProperties(true);
  Set<ConfigurationResponse> requestedConfigs=controller.getConfigurations(new HashSet<ConfigurationRequest>(){
{
      add(configRequest);
    }
  }
);
  for (  ConfigurationResponse resp : requestedConfigs) {
    String secretName="SECRET:hdfs-site:" + resp.getVersion().toString() + ":test.password";
    if (resp.getConfigs().containsKey("test.password")) {
      assertEquals(resp.getConfigs().get("test.password"),secretName);
    }
    if (resp.getConfigs().containsKey("test.password.empty")) {
      assertEquals(resp.getConfigs().get("test.password.empty"),"");
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateClusterWithHostMapping() throws AmbariException, AuthorizationException {
  Set<String> hostNames=new HashSet<String>();
  hostNames.add("h1");
  hostNames.add("h2");
  ClusterRequest r=new ClusterRequest(null,"c1","HDP-0.1",hostNames);
  try {
    controller.createCluster(r);
    fail("Expected create cluster to fail for invalid hosts");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster("c1");
    fail("Expected to fail for non created cluster");
  }
 catch (  ClusterNotFoundException e) {
  }
  clusters.addHost("h1");
  clusters.addHost("h2");
  setOsFamily(clusters.getHost("h1"),"redhat","6.3");
  setOsFamily(clusters.getHost("h2"),"redhat","6.3");
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  controller.createCluster(r);
  Assert.assertNotNull(clusters.getCluster("c1"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateClusterWithInvalidRequest(){
  ClusterRequest r=new ClusterRequest(null,null,null,null);
  r.toString();
  try {
    controller.createCluster(r);
    fail("Expected create cluster for invalid request");
  }
 catch (  Exception e) {
  }
  r.setClusterId(1L);
  try {
    controller.createCluster(r);
    fail("Expected create cluster for invalid request");
  }
 catch (  Exception e) {
  }
  r.setClusterId(null);
  r.setClusterName("foo");
  try {
    controller.createCluster(r);
    fail("Expected create cluster for invalid request - no stack version");
  }
 catch (  Exception e) {
  }
  r.setStackVersion("HDP-1.2.0");
  r.setProvisioningState(State.INSTALLING.name());
  try {
    controller.createCluster(r);
    controller.updateClusters(Collections.singleton(r),null);
    fail("Expected create cluster for invalid request - invalid provisioning state");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentHostSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INIT);
    fail("ServiceComponentHost creation should fail for invalid host" + " as host not mapped to cluster");
  }
 catch (  Exception e) {
  }
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INSTALLING);
    fail("ServiceComponentHost creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1);
    fail("ServiceComponentHost creation should have failed earlier");
  }
 catch (  Exception e) {
  }
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
    fail("ServiceComponentHost creation should fail as duplicate");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName2,null,null);
  Set<ServiceComponentHostResponse> response=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,response.size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHost() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  String host3="h3";
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,ServiceComponentHost> hostComponents=cluster.getService(serviceName).getServiceComponent(componentName1).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  hostComponents=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  Set<HostRequest> requests=new HashSet<HostRequest>();
  requests.clear();
  requests.add(new HostRequest(host1,clusterName,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    fail("Expect failure deleting hosts when components exist and have not been deleted.");
  }
 catch (  Exception e) {
  }
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"DISABLED"));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,"DISABLED"));
  updateHostComponents(schRequests,new HashMap<String,String>(),false);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host1,null));
  controller.deleteHostComponents(schRequests);
  Assert.assertEquals(0,cluster.getServiceComponentHosts(host1).size());
  requests.clear();
  requests.add(new HostRequest(host1,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
  }
 catch (  Exception e) {
    fail("Did not expect an error deleting the host from the cluster. Error: " + e.getMessage());
  }
  Assert.assertFalse(clusters.getHostsForCluster(clusterName).containsKey(host1));
  Assert.assertFalse(clusters.getClustersForHost(host1).contains(cluster));
  requests.clear();
  requests.add(new HostRequest(host2,clusterName,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
  }
 catch (  Exception e) {
    fail("Did not expect an error deleting the host from the cluster. Error: " + e.getMessage());
  }
  Assert.assertFalse(clusters.getHostsForCluster(clusterName).containsKey(host2));
  Assert.assertFalse(clusters.getClustersForHost(host2).contains(cluster));
  requests.clear();
  requests.add(new HostRequest(host1,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    Assert.fail("Expected a HostNotFoundException trying to remove a host that was already deleted.");
  }
 catch (  HostNotFoundException e) {
  }
  try {
    clusters.getHost(host1);
    Assert.fail("Expected a HostNotFoundException.");
  }
 catch (  HostNotFoundException e) {
  }
  requests.clear();
  requests.add(new HostRequest(host3,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    Assert.fail("Expected a HostNotFoundException trying to remove a host that was never added.");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteComponentsOnHost() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,ServiceComponentHost> hostComponents=cluster.getService(serviceName).getServiceComponent(componentName1).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  hostComponents=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  ServiceComponentHost sch=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1);
  Assert.assertNotNull(sch);
  sch.handleEvent(new ServiceComponentHostStartEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStartedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  try {
    controller.deleteHostComponents(schRequests);
    fail("Expected exception while deleting all host components.");
  }
 catch (  AmbariException e) {
  }
  Assert.assertEquals(3,cluster.getServiceComponentHosts(host1).size());
  sch.handleEvent(new ServiceComponentHostStopEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStoppedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"DISABLED"));
  updateHostComponents(schRequests,new HashMap<String,String>(),false);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  controller.deleteHostComponents(schRequests);
  Assert.assertEquals(0,cluster.getServiceComponentHosts(host1).size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrlController() throws Exception {
  String badUrl="http://hortonworks.com";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  RepositoryRequest request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(badUrl);
  Set<RepositoryRequest> requests=new HashSet<RepositoryRequest>();
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.fail("Expected a bad URL to throw an exception");
  }
 catch (  Exception e) {
    assertNotNull(e);
    Assert.assertTrue(e.getMessage().contains(badUrl));
  }
  request.setVerifyBaseUrl(false);
  controller.updateRepositories(requests);
  Assert.assertEquals(request.getBaseUrl(),repo.getBaseUrl());
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("https://hortonworks.com");
  requests.add(request);
  controller.updateRepositories(requests);
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("pro://hortonworks.com");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("http://rrr1.cccc");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(repo.getDefaultBaseUrl());
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(repo.getBaseUrl(),repo.getDefaultBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  String baseUrl=repo.getDefaultBaseUrl();
  if (!baseUrl.endsWith("/")) {
    baseUrl+="/";
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("ubuntu12")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  baseUrl=baseUrl.substring(0,baseUrl.length() - 1);
  Assert.assertTrue(!baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"/repodata/repomd.xml");
  Assert.assertTrue(!baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("suse11")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/foo/bar.xml,/repodata/repomd.xml");
  Assert.assertTrue(configuration.getRepoValidationSuffixes("ubuntu12").length > 1);
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceWithInvalidInfo() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  try {
    createService(clusterName,serviceName,State.INSTALLING);
    fail("Service creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName);
    fail("Service creation should have failed");
  }
 catch (  Exception e) {
  }
  try {
    createService(clusterName,serviceName,State.INSTALLED);
    fail("Service creation should fail for invalid initial state");
  }
 catch (  Exception e) {
  }
  createService(clusterName,serviceName,null);
  String serviceName2="MAPREDUCE";
  createService(clusterName,serviceName2,State.INIT);
  ServiceRequest r=new ServiceRequest(clusterName,null,null);
  Set<ServiceResponse> response=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(2,response.size());
  for (  ServiceResponse svc : response) {
    Assert.assertTrue(svc.getServiceName().equals(serviceName) || svc.getServiceName().equals(serviceName2));
    Assert.assertEquals("HDP-0.1",svc.getDesiredStackVersion());
    Assert.assertEquals(State.INIT.toString(),svc.getDesiredState());
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateHostWithInvalidRequests() throws AmbariException {
  Set<HostRequest> set1=new HashSet<HostRequest>();
  try {
    set1.clear();
    HostRequest rInvalid=new HostRequest("h1",null,null);
    set1.add(rInvalid);
    HostResourceProviderTest.createHosts(controller,set1);
    fail("Expected failure for invalid host");
  }
 catch (  Exception e) {
  }
  clusters.addHost("h1");
  String clusterName="c1";
  try {
    set1.clear();
    HostRequest rInvalid=new HostRequest("h1",clusterName,null);
    set1.add(rInvalid);
    HostResourceProviderTest.createHosts(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  Exception e) {
  }
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  try {
    set1.clear();
    HostRequest rInvalid1=new HostRequest("h1",clusterName,null);
    HostRequest rInvalid2=new HostRequest("h1",clusterName,null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    HostResourceProviderTest.createHosts(controller,set1);
    fail("Expected failure for dup requests");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostsWithDecommissioned() throws Exception {
  final String host1="h1";
  final String host2="h2";
  String clusterName="foo1";
  setupClusterWithHosts(clusterName,"HDP-2.0.7",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Service s1=clusters.getCluster(clusterName).getService(serviceName);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host1).setComponentAdminState(HostComponentAdminState.DECOMMISSIONED);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host2).setComponentAdminState(HostComponentAdminState.INSERVICE);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("DECOMMISSIONED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSERVICE");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSTALLED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,null);
  r.setAdminState("DECOMMISSIONED");
  try {
    updateHostComponents(Collections.singleton(r),new HashMap<String,String>(),false);
    Assert.fail("Must throw exception when decommission attribute is updated.");
  }
 catch (  IllegalArgumentException ex) {
    Assert.assertTrue(ex.getMessage().contains("Property adminState cannot be modified through update"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest(null,null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo",null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo","bar",null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,ClusterNotFoundException.class));
  }
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  clusters.addCluster("bar",new StackId("HDP-0.1"));
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","bar",null);
    set1.add(valid1);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid service");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("bar","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(0,clusters.getCluster("foo").getServices().size());
  set1.clear();
  ServiceRequest valid=new ServiceRequest("foo","HDFS",null);
  set1.add(valid);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for existing service");
  }
 catch (  Exception e) {
  }
  Assert.assertEquals(1,clusters.getCluster("foo").getServices().size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyConfigs() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  ClusterRequest cr=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),null,null);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",null,null)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  Config config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  Map<String,String> map=new HashMap<String,String>();
  map.clear();
  map.put("c","d");
  Map<String,Map<String,String>> attributesMap=new HashMap<String,Map<String,String>>();
  attributesMap.put("final",new HashMap<String,String>());
  attributesMap.get("final").put("c","true");
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v3",map,attributesMap)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertTrue(config.getProperties().containsKey("c"));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertEquals("v2",config.getTag());
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
)));
  try {
    controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
    Assert.fail("Expect failure when creating a config that exists");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentHostsWithFilters() throws AmbariException, AuthorizationException {
  Cluster c1=setupClusterWithHosts("c1","HDP-0.2",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos5");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s1,"NAMENODE");
  ServiceComponent sc3=serviceComponentFactory.createNew(s3,"HBASE_REGIONSERVER");
  s1.addServiceComponent(sc1);
  s1.addServiceComponent(sc2);
  s3.addServiceComponent(sc3);
  sc1.setDesiredState(State.UNINSTALLED);
  sc3.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc1,"h1");
  ServiceComponentHost sch2=serviceComponentHostFactory.createNew(sc1,"h2");
  ServiceComponentHost sch3=serviceComponentHostFactory.createNew(sc1,"h3");
  ServiceComponentHost sch4=serviceComponentHostFactory.createNew(sc2,"h1");
  ServiceComponentHost sch5=serviceComponentHostFactory.createNew(sc2,"h2");
  ServiceComponentHost sch6=serviceComponentHostFactory.createNew(sc3,"h3");
  sc1.addServiceComponentHost(sch1);
  sc1.addServiceComponentHost(sch2);
  sc1.addServiceComponentHost(sch3);
  sc2.addServiceComponentHost(sch4);
  sc2.addServiceComponentHost(sch5);
  sc3.addServiceComponentHost(sch6);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.UNINSTALLED);
  sch1.persist();
  sch2.persist();
  sch3.persist();
  sch4.persist();
  sch5.persist();
  sch6.persist();
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(null,null,null,null,null);
  try {
    controller.getHostComponents(Collections.singleton(r));
    fail("Expected failure for invalid cluster");
  }
 catch (  Exception e) {
  }
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(6,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s1.getName(),null,null,null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,sc3.getName(),null,null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,State.UNINSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s1.getName(),null,null,State.INIT.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,sc3.getName(),null,State.INSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",State.INIT.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),null,"h1",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h3",State.INSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h3",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  ServiceComponentHostRequest r1, r2, r3;
  r1=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h3",null);
  r2=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h2",null);
  r3=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",null);
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resps=controller.getHostComponents(reqs);
  Assert.assertEquals(4,resps.size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentHostWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest(null,null,null,null,null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid requests");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo",null,null,null,null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid requests");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS",null,null,null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid requests");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE",null,null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid requests");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  clusters.addCluster("foo",new StackId("HDP-0.2"));
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster foo=clusters.getCluster("foo");
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  StackId stackId=new StackId("HDP-0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  foo.setDesiredStackVersion(stackId);
  foo.setCurrentStackVersion(stackId);
  foo.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  foo.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  stackId=new StackId("HDP-0.2");
  c1.setDesiredStackVersion(stackId);
  c1.setCurrentStackVersion(stackId);
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  stackId=new StackId("HDP-0.2");
  c2.setDesiredStackVersion(stackId);
  c2.setCurrentStackVersion(stackId);
  c2.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  c2.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid service");
  }
 catch (  IllegalArgumentException e) {
  }
  Service s1=serviceFactory.createNew(foo,"HDFS");
  foo.addService(s1);
  s1.persist();
  Service s2=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s2);
  s2.persist();
  Service s3=serviceFactory.createNew(c2,"HDFS");
  c2.addService(s3);
  s3.persist();
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid service");
  }
 catch (  AmbariException e) {
  }
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"NAMENODE");
  s1.addServiceComponent(sc1);
  sc1.persist();
  ServiceComponent sc2=serviceComponentFactory.createNew(s2,"NAMENODE");
  s2.addServiceComponent(sc2);
  sc2.persist();
  ServiceComponent sc3=serviceComponentFactory.createNew(s3,"NAMENODE");
  s3.addServiceComponent(sc3);
  sc3.persist();
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid host");
  }
 catch (  AmbariException e) {
  }
  clusters.addHost("h1");
  Host h1=clusters.getHost("h1");
  h1.setIPv4("ipv41");
  h1.setIPv6("ipv61");
  setOsFamily(h1,"redhat","6.3");
  h1.persist();
  clusters.addHost("h2");
  Host h2=clusters.getHost("h2");
  h2.setIPv4("ipv42");
  h2.setIPv6("ipv62");
  setOsFamily(h2,"redhat","6.3");
  h2.persist();
  clusters.addHost("h3");
  Host h3=clusters.getHost("h3");
  h3.setIPv4("ipv43");
  h3.setIPv6("ipv63");
  setOsFamily(h3,"redhat","6.3");
  h3.persist();
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    set1.add(rInvalid);
    controller.createHostComponents(set1);
    fail("Expected failure for invalid host cluster mapping");
  }
 catch (  AmbariException e) {
  }
  Set<String> hostnames=new HashSet<String>();
  hostnames.add("h1");
  hostnames.add("h2");
  hostnames.add("h3");
  clusters.mapHostsToCluster(hostnames,"foo");
  clusters.mapHostsToCluster(hostnames,"c1");
  clusters.mapHostsToCluster(hostnames,"c2");
  set1.clear();
  ServiceComponentHostRequest valid=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
  set1.add(valid);
  controller.createHostComponents(set1);
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid1=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h2",null);
    ServiceComponentHostRequest rInvalid2=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h2",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    controller.createHostComponents(set1);
    fail("Expected failure for dup requests");
  }
 catch (  DuplicateResourceException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid1=new ServiceComponentHostRequest("c1","HDFS","NAMENODE","h2",null);
    ServiceComponentHostRequest rInvalid2=new ServiceComponentHostRequest("c2","HDFS","NAMENODE","h3",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    controller.createHostComponents(set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    set1.clear();
    ServiceComponentHostRequest rInvalid1=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h1",null);
    ServiceComponentHostRequest rInvalid2=new ServiceComponentHostRequest("foo","HDFS","NAMENODE","h2",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    controller.createHostComponents(set1);
    fail("Expected failure for already existing");
  }
 catch (  DuplicateResourceException e) {
  }
  Assert.assertEquals(1,foo.getServiceComponentHosts("h1").size());
  Assert.assertEquals(0,foo.getServiceComponentHosts("h2").size());
  Assert.assertEquals(0,foo.getServiceComponentHosts("h3").size());
  set1.clear();
  ServiceComponentHostRequest valid1=new ServiceComponentHostRequest("c1","HDFS","NAMENODE","h1",null);
  set1.add(valid1);
  controller.createHostComponents(set1);
  set1.clear();
  ServiceComponentHostRequest valid2=new ServiceComponentHostRequest("c2","HDFS","NAMENODE","h1",null);
  set1.add(valid2);
  controller.createHostComponents(set1);
  Assert.assertEquals(1,foo.getServiceComponentHosts("h1").size());
  Assert.assertEquals(1,c1.getServiceComponentHosts("h1").size());
  Assert.assertEquals(1,c2.getServiceComponentHosts("h1").size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallAndStartService() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Map<String,Config> configs=new HashMap<String,Config>();
  Map<String,String> properties=new HashMap<String,String>();
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  properties.put("a","a1");
  properties.put("b","b1");
  Config c1=new ConfigImpl(cluster,"hdfs-site",properties,propertiesAttributes,injector);
  properties.put("c","c1");
  properties.put("d","d1");
  Config c2=new ConfigImpl(cluster,"core-site",properties,propertiesAttributes,injector);
  Config c3=new ConfigImpl(cluster,"foo-site",properties,propertiesAttributes,injector);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  c1.setTag("v1");
  c2.setTag("v1");
  c3.setTag("v1");
  cluster.addConfig(c1);
  cluster.addConfig(c2);
  cluster.addConfig(c3);
  c1.persist();
  c2.persist();
  c3.persist();
  configs.put(c1.getType(),c1);
  configs.put(c2.getType(),c2);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertEquals(5,taskStatuses.size());
  boolean foundH1NN=false;
  boolean foundH1DN=false;
  boolean foundH2DN=false;
  boolean foundH1CLT=false;
  boolean foundH2CLT=false;
  for (  ShortTaskStatus taskStatus : taskStatuses) {
    LOG.debug("Task dump :" + taskStatus.toString());
    Assert.assertEquals(RoleCommand.INSTALL.toString(),taskStatus.getCommand());
    Assert.assertEquals(HostRoleStatus.PENDING.toString(),taskStatus.getStatus());
    if (taskStatus.getHostName().equals("h1")) {
      if (Role.NAMENODE.toString().equals(taskStatus.getRole())) {
        foundH1NN=true;
      }
 else       if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH1DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH1CLT=true;
      }
 else {
        fail("Found invalid role for host h1");
      }
    }
 else     if (taskStatus.getHostName().equals("h2")) {
      if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH2DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH2CLT=true;
      }
 else {
        fail("Found invalid role for host h2");
      }
    }
 else {
      fail("Found invalid host in task list");
    }
  }
  Assert.assertTrue(foundH1DN && foundH1NN && foundH2DN&& foundH1CLT&& foundH2CLT);
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
  for (  Stage stage : stages) {
    LOG.info("Stage Details for Install Service" + ", stageId=" + stage.getStageId() + ", actionId="+ stage.getActionId());
    for (    String host : stage.getHosts()) {
      for (      ExecutionCommandWrapper ecw : stage.getExecutionCommands(host)) {
        Assert.assertFalse(ecw.getExecutionCommand().getHostLevelParams().get("repo_info").isEmpty());
      }
    }
  }
  org.apache.ambari.server.controller.spi.Request request=PropertyHelper.getReadRequest(TaskResourceProvider.TASK_CLUSTER_NAME_PROPERTY_ID,TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID,TaskResourceProvider.TASK_STAGE_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).toPredicate();
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(5,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).and().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals(1L).toPredicate();
  entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(1,entities.size());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    if (sc.getName().equals("HDFS_CLIENT")) {
      Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    }
 else {
      Assert.assertEquals(State.STARTED,sc.getDesiredState());
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(2,stages.size());
  StringBuilder sb=new StringBuilder();
  clusters.debugDump(sb);
  LOG.info("Cluster Dump: " + sb.toString());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        sch.setState(State.INSTALLED);
      }
 else {
        sch.setState(State.INSTALL_FAILED);
      }
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="NAMENODE";
  try {
    createServiceComponent(clusterName,serviceName,componentName,State.INSTALLING);
    fail("ServiceComponent creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName);
    fail("ServiceComponent creation should have failed");
  }
 catch (  Exception e) {
  }
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName));
  ServiceComponentRequest r=new ServiceComponentRequest(clusterName,serviceName,null,null);
  Set<ServiceComponentResponse> response=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,response.size());
  ServiceComponentResponse sc=response.iterator().next();
  Assert.assertEquals(State.INIT.toString(),sc.getDesiredState());
  Assert.assertEquals(componentName,sc.getComponentName());
  Assert.assertEquals(clusterName,sc.getClusterName());
  Assert.assertEquals(serviceName,sc.getServiceName());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.STARTED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.UNKNOWN);
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  ServiceComponentRequest req1, req2, req3;
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INIT.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.STARTED.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.STARTED);
  sch2.setState(State.INIT);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INIT);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  req3=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  RequestStatusResponse trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertEquals(State.INSTALLED,s1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch4.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch5.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getState());
  Assert.assertEquals(State.INIT,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INIT,sch5.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  Assert.assertTrue(!stages.isEmpty());
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateClusterSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Set<ClusterResponse> r=controller.getClusters(Collections.singleton(new ClusterRequest(null,clusterName,null,null)));
  Assert.assertEquals(1,r.size());
  ClusterResponse c=r.iterator().next();
  Assert.assertEquals(clusterName,c.getClusterName());
  try {
    createCluster(clusterName);
    fail("Duplicate cluster creation should fail");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentsWithFilters() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  Service s4=serviceFactory.createNew(c2,"HIVE");
  Service s5=serviceFactory.createNew(c2,"ZOOKEEPER");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  c2.addService(s4);
  c2.addService(s5);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s4.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  s4.persist();
  s5.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s1,"NAMENODE");
  ServiceComponent sc3=serviceComponentFactory.createNew(s3,"HBASE_REGIONSERVER");
  ServiceComponent sc4=serviceComponentFactory.createNew(s4,"HIVE_SERVER");
  ServiceComponent sc5=serviceComponentFactory.createNew(s4,"HIVE_CLIENT");
  ServiceComponent sc6=serviceComponentFactory.createNew(s4,"MYSQL_SERVER");
  ServiceComponent sc7=serviceComponentFactory.createNew(s5,"ZOOKEEPER_SERVER");
  ServiceComponent sc8=serviceComponentFactory.createNew(s5,"ZOOKEEPER_CLIENT");
  s1.addServiceComponent(sc1);
  s1.addServiceComponent(sc2);
  s3.addServiceComponent(sc3);
  s4.addServiceComponent(sc4);
  s4.addServiceComponent(sc5);
  s4.addServiceComponent(sc6);
  s5.addServiceComponent(sc7);
  s5.addServiceComponent(sc8);
  sc1.setDesiredState(State.UNINSTALLED);
  sc3.setDesiredState(State.UNINSTALLED);
  sc5.setDesiredState(State.UNINSTALLED);
  sc6.setDesiredState(State.UNINSTALLED);
  sc7.setDesiredState(State.UNINSTALLED);
  sc8.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  sc4.persist();
  sc5.persist();
  sc6.persist();
  sc7.persist();
  sc8.persist();
  ServiceComponentRequest r=new ServiceComponentRequest(null,null,null,null);
  try {
    ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
    fail("Expected failure for invalid cluster");
  }
 catch (  Exception e) {
  }
  r=new ServiceComponentRequest(c1.getClusterName(),null,null,null);
  Set<ServiceComponentResponse> resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(3,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),null,null,State.UNINSTALLED.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(4,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),s5.getName(),null,null);
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),s4.getName(),null,State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc4.getName(),resps.iterator().next().getComponentName());
  r=new ServiceComponentRequest(c2.getClusterName(),null,sc5.getName(),State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc5.getName(),resps.iterator().next().getComponentName());
  r=new ServiceComponentRequest(c2.getClusterName(),s4.getName(),sc5.getName(),State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc5.getName(),resps.iterator().next().getComponentName());
  ServiceComponentRequest r1, r2, r3;
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  r1=new ServiceComponentRequest(c2.getClusterName(),null,null,State.UNINSTALLED.toString());
  r2=new ServiceComponentRequest(c1.getClusterName(),null,null,null);
  r3=new ServiceComponentRequest(c1.getClusterName(),null,null,State.INIT.toString());
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resps=ComponentResourceProviderTest.getComponents(controller,reqs);
  Assert.assertEquals(7,resps.size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesMultiple() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
  ServiceRequest valid2=new ServiceRequest("foo","MAPREDUCE",null);
  set1.add(valid1);
  set1.add(valid2);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    valid1=new ServiceRequest("foo","PIG",null);
    valid2=new ServiceRequest("foo","MAPREDUCE",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid services");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,DuplicateResourceException.class));
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(2,clusters.getCluster("foo").getServices().size());
  Assert.assertNotNull(clusters.getCluster("foo").getService("HDFS"));
  Assert.assertNotNull(clusters.getCluster("foo").getService("MAPREDUCE"));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostUpdateRecursive() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.INIT);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALL_FAILED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  ServiceComponentHostRequest req1, req2, req3, req4, req5;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  try {
    reqs.clear();
    req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
    req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
    req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
    req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
    req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.STARTED.toString());
    reqs.add(req1);
    reqs.add(req2);
    reqs.add(req3);
    reqs.add(req4);
    reqs.add(req5);
    updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  }
 catch (  Exception e) {
    fail("Failure for invalid states");
  }
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,null,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req3=new ServiceComponentHostRequest(clusterName,null,componentName2,host1,State.INSTALLED.toString());
  req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
  req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  reqs.add(req4);
  reqs.add(req5);
  RequestStatusResponse trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNotNull(trackAction);
  long requestId=trackAction.getRequestId();
  Assert.assertFalse(actionDB.getAllStages(requestId).isEmpty());
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceComponentRequest> set1=new HashSet<ServiceComponentRequest>();
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest(null,null,null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1",null,null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","s1",null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","s1","sc1",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  clusters.addCluster("c2",new StackId("HDP-0.1"));
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid service");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  Cluster c1=clusters.getCluster("c1");
  StackId stackId=new StackId("HDP-0.1");
  c1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  set1.clear();
  ServiceComponentRequest valid1=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
  ServiceComponentRequest valid2=new ServiceComponentRequest("c1","MAPREDUCE","JOBTRACKER",null);
  ServiceComponentRequest valid3=new ServiceComponentRequest("c1","MAPREDUCE","TASKTRACKER",null);
  set1.add(valid1);
  set1.add(valid2);
  set1.add(valid3);
  ComponentResourceProviderTest.createComponents(controller,set1);
  try {
    set1.clear();
    ServiceComponentRequest rInvalid1=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    ServiceComponentRequest rInvalid2=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for dups in requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid1=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    ServiceComponentRequest rInvalid2=new ServiceComponentRequest("c2","HDFS","HDFS_CLIENT",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for already existing component");
  }
 catch (  Exception e) {
  }
  Assert.assertEquals(1,s1.getServiceComponents().size());
  Assert.assertNotNull(s1.getServiceComponent("NAMENODE"));
  Assert.assertEquals(2,s2.getServiceComponents().size());
  Assert.assertNotNull(s2.getServiceComponent("JOBTRACKER"));
  Assert.assertNotNull(s2.getServiceComponent("TASKTRACKER"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.2"));
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String serviceName2="HBASE";
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HBASE_MASTER";
  String componentName4="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName2,componentName3,host1,State.INIT.toString());
  ServiceComponentHostRequest r6=new ServiceComponentHostRequest(clusterName,serviceName1,componentName4,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  set1.add(r6);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  Service s2=c1.getService(serviceName2);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s2.getServiceComponent(componentName3);
  ServiceComponent sc4=s1.getServiceComponent(componentName4);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  ServiceComponentHost sch6=sc4.getServiceComponentHost(host2);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sc4.setDesiredState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch6.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  sch6.setState(State.INSTALLED);
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest req1, req2;
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.STARTED);
  sch2.setDesiredState(State.STARTED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.STARTED);
  sch5.setDesiredState(State.STARTED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,s1.getDesiredState());
  Assert.assertEquals(State.STARTED,s2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc1.getDesiredState());
  Assert.assertEquals(State.STARTED,sc2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getDesiredState());
  Assert.assertEquals(State.STARTED,sch2.getDesiredState());
  Assert.assertEquals(State.STARTED,sch3.getDesiredState());
  Assert.assertEquals(State.STARTED,sch4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch5.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch6.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getState());
  Assert.assertEquals(State.INSTALLED,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INSTALLED,sch5.getState());
  Assert.assertEquals(State.INSTALLED,sch6.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  Assert.assertTrue(!stages.isEmpty());
  Assert.assertEquals(3,stages.size());
  Stage stage1=null, stage2=null, stage3=null;
  for (  Stage s : stages) {
    if (s.getStageId() == 0) {
      stage1=s;
    }
    if (s.getStageId() == 1) {
      stage2=s;
    }
    if (s.getStageId() == 2) {
      stage3=s;
    }
  }
  Assert.assertEquals(2,stage1.getExecutionCommands(host1).size());
  Assert.assertEquals(1,stage1.getExecutionCommands(host2).size());
  Assert.assertEquals(1,stage2.getExecutionCommands(host1).size());
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"NAMENODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"DATANODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host2,"NAMENODE"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host1,"HBASE_MASTER"));
  Assert.assertNull(stage1.getExecutionCommandWrapper(host2,"DATANODE"));
  Assert.assertNotNull(stage3.getExecutionCommandWrapper(host1,"HBASE_SERVICE_CHECK"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host2,"HDFS_SERVICE_CHECK"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage s : stages) {
    for (    List<ExecutionCommandWrapper> list : s.getExecutionCommands().values()) {
      for (      ExecutionCommandWrapper ecw : list) {
        if (ecw.getExecutionCommand().getRole().contains("SERVICE_CHECK")) {
          Map<String,String> hostParams=StageUtils.getGson().fromJson(s.getHostParamsStage(),type);
          Assert.assertNotNull(hostParams);
          Assert.assertTrue(hostParams.size() > 0);
          Assert.assertTrue(hostParams.containsKey("stack_version"));
          Assert.assertEquals(hostParams.get("stack_version"),c1.getDesiredStackVersion().getStackVersion());
        }
      }
    }
  }
  sch1.setState(State.STARTED);
  sch2.setState(State.STARTED);
  sch3.setState(State.STARTED);
  sch4.setState(State.STARTED);
  sch5.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("HDP-0.2"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(State.INIT,s.getDesiredState());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest r;
  try {
    r=new ServiceRequest(clusterName,serviceName,State.INSTALLING.toString());
    reqs.clear();
    reqs.add(r);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected fail for invalid state transition");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  reqs.clear();
  reqs.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateHostSimple() throws AmbariException {
  Map<String,String> hostAttributes=null;
  HostRequest r1=new HostRequest("h1",null,hostAttributes);
  r1.toString();
  Set<HostRequest> requests=new HashSet<HostRequest>();
  requests.add(r1);
  try {
    HostResourceProviderTest.createHosts(controller,requests);
    fail("Create host should fail for non-bootstrapped host");
  }
 catch (  Exception e) {
  }
  clusters.addHost("h1");
  clusters.addHost("h2");
  setOsFamily(clusters.getHost("h1"),"redhat","5.9");
  setOsFamily(clusters.getHost("h2"),"redhat","5.9");
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  requests.add(new HostRequest("h2","foo",new HashMap<String,String>()));
  try {
    HostResourceProviderTest.createHosts(controller,requests);
    fail("Create host should fail for invalid clusters");
  }
 catch (  Exception e) {
  }
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  Cluster c=clusters.getCluster("foo");
  StackId stackId=new StackId("HDP-0.1");
  c.setDesiredStackVersion(stackId);
  c.setCurrentStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostResourceProviderTest.createHosts(controller,requests);
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  Assert.assertEquals(0,clusters.getClustersForHost("h1").size());
  Assert.assertEquals(1,clusters.getClustersForHost("h2").size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHostComponentInVariousStates() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-1.3.1"));
  String serviceName="HDFS";
  String mapred="MAPREDUCE";
  createService(clusterName,serviceName,null);
  createService(clusterName,mapred,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="JOBTRACKER";
  String componentName5="TASKTRACKER";
  String componentName6="MAPREDUCE_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponent(clusterName,mapred,componentName4,State.INIT);
  createServiceComponent(clusterName,mapred,componentName5,State.INIT);
  createServiceComponent(clusterName,mapred,componentName6,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName4,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName5,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName6,host1,null);
  installService(clusterName,serviceName,false,false);
  installService(clusterName,mapred,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Service s2=cluster.getService(mapred);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  sc1.getServiceComponentHosts().values().iterator().next().setState(State.STARTED);
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  try {
    controller.deleteHostComponents(schRequests);
    Assert.fail("Expect failure while deleting.");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Host Component cannot be removed"));
  }
  sc1.getServiceComponentHosts().values().iterator().next().setDesiredState(State.STARTED);
  sc1.getServiceComponentHosts().values().iterator().next().setState(State.UNKNOWN);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  sc2.getServiceComponentHosts().values().iterator().next().setState(State.INIT);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  sc3.getServiceComponentHosts().values().iterator().next().setState(State.INSTALL_FAILED);
  ServiceComponent sc4=s2.getServiceComponent(componentName4);
  sc4.getServiceComponentHosts().values().iterator().next().setDesiredState(State.INSTALLED);
  sc4.getServiceComponentHosts().values().iterator().next().setState(State.DISABLED);
  ServiceComponent sc5=s2.getServiceComponent(componentName5);
  sc5.getServiceComponentHosts().values().iterator().next().setState(State.INSTALLED);
  ServiceComponent sc6=s2.getServiceComponent(componentName6);
  sc6.getServiceComponentHosts().values().iterator().next().setState(State.INIT);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName4,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName5,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName6,host1,null));
  controller.deleteHostComponents(schRequests);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicesWithFilters() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  c1.setDesiredStackVersion(new StackId("HDP-0.2"));
  c2.setDesiredStackVersion(new StackId("HDP-0.2"));
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  Service s4=serviceFactory.createNew(c2,"HIVE");
  Service s5=serviceFactory.createNew(c2,"ZOOKEEPER");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  c2.addService(s4);
  c2.addService(s5);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s4.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  s4.persist();
  s5.persist();
  ServiceRequest r=new ServiceRequest(null,null,null);
  Set<ServiceResponse> resp;
  try {
    ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
    fail("Expected failure for invalid request");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(c1.getClusterName(),null,null);
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(3,resp.size());
  r=new ServiceRequest(c1.getClusterName(),s2.getName(),null);
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  Assert.assertEquals(s2.getName(),resp.iterator().next().getServiceName());
  try {
    r=new ServiceRequest(c2.getClusterName(),s1.getName(),null);
    ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
    fail("Expected failure for invalid service");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(c1.getClusterName(),null,"INSTALLED");
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(2,resp.size());
  r=new ServiceRequest(c2.getClusterName(),null,"INIT");
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  ServiceRequest r1, r2, r3;
  r1=new ServiceRequest(c1.getClusterName(),null,"INSTALLED");
  r2=new ServiceRequest(c2.getClusterName(),null,"INIT");
  r3=new ServiceRequest(c2.getClusterName(),null,"INIT");
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resp=ServiceResourceProviderTest.getServices(controller,reqs);
  Assert.assertEquals(3,resp.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.BackgroundCustomCommandExecutionTest </h4><pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testRebalanceHdfsCustomCommand(){
  try {
    createClusterFixture();
    Map<String,String> requestProperties=new HashMap<String,String>(){
{
        put(REQUEST_CONTEXT_PROPERTY,"Refresh YARN Capacity Scheduler");
        put("command","REBALANCEHDFS");
        put("namenode","{\"threshold\":13}");
      }
    }
;
    ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","REBALANCEHDFS",new HashMap<String,String>(),false);
    actionRequest.getResourceFilters().add(new RequestResourceFilter("HDFS","NAMENODE",Collections.singletonList("c6401")));
    controller.createAction(actionRequest,requestProperties);
    Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
    Request request=requestCapture.getValue();
    Assert.assertNotNull(request);
    Assert.assertNotNull(request.getStages());
    Assert.assertEquals(1,request.getStages().size());
    Stage stage=request.getStages().iterator().next();
    System.out.println(stage);
    Assert.assertEquals(1,stage.getHosts().size());
    List<ExecutionCommandWrapper> commands=stage.getExecutionCommands("c6401");
    Assert.assertEquals(1,commands.size());
    ExecutionCommand command=commands.get(0).getExecutionCommand();
    Assert.assertEquals(AgentCommandType.BACKGROUND_EXECUTION_COMMAND,command.getCommandType());
    Assert.assertEquals("{\"threshold\":13}",command.getCommandParams().get("namenode"));
  }
 catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.KerberosHelperTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecuteCustomOperationsInvalidOperation() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  final Cluster cluster=createNiceMock(Cluster.class);
  try {
    kerberosHelper.executeCustomOperations(cluster,Collections.singletonMap("invalid_operation","false"),null,true);
  }
 catch (  Throwable t) {
    Assert.fail("Exception should not have been thrown");
  }
}

</code></pre>

<br>
<pre class="type-10 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AmbariException.class) public void testRegenerateKeytabsInvalidValue() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  final Cluster cluster=createNiceMock(Cluster.class);
  kerberosHelper.executeCustomOperations(cluster,Collections.singletonMap("regenerate_keytabs","false"),null,true);
  Assert.fail("AmbariException should have failed");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerClusterProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerClusterProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerClusterProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerClusterProvider(clusterDefinition);
  try {
    provider.updateResources(PropertyHelper.getUpdateRequest(new HashMap<String,Object>(),null),null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerComponentProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerComponentProvider(clusterDefinition);
  try {
    provider.updateResources(PropertyHelper.getUpdateRequest(new HashMap<String,Object>(),null),null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerComponentProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerComponentProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerHostComponentProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostComponentProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostComponentProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostComponentProvider(clusterDefinition);
  try {
    provider.updateResources(PropertyHelper.getUpdateRequest(new HashMap<String,Object>(),null),null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerHostProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  try {
    provider.updateResources(PropertyHelper.getUpdateRequest(new HashMap<String,Object>(),null),null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerServiceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  try {
    provider.createResources(PropertyHelper.getReadRequest());
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  try {
    provider.deleteResources(null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  try {
    provider.updateResources(PropertyHelper.getUpdateRequest(new HashMap<String,Object>(),null),null);
    Assert.fail("Expected UnsupportedOperationException.");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ArtifactResourceProviderTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources_collection() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  TreeMap<String,String> foreignKeys=new TreeMap<String,String>();
  foreignKeys.put("cluster","500");
  List<ArtifactEntity> entities=new ArrayList<ArtifactEntity>();
  entities.add(entity);
  entities.add(entity2);
  Map<String,Object> artifact_data=Collections.<String,Object>singletonMap("foo","bar");
  Map<String,Object> artifact_data2=Collections.<String,Object>singletonMap("foo2","bar2");
  Map<String,String> responseForeignKeys=new HashMap<String,String>();
  responseForeignKeys.put("cluster","500");
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("test-cluster")).andReturn(cluster).anyTimes();
  expect(clusters.getClusterById(500L)).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(500L).anyTimes();
  expect(cluster.getClusterName()).andReturn("test-cluster").anyTimes();
  expect(request.getPropertyIds()).andReturn(propertyIds).anyTimes();
  expect(dao.findByForeignKeys(eq(foreignKeys))).andReturn(entities).anyTimes();
  expect(entity.getArtifactName()).andReturn("test-artifact").anyTimes();
  expect(entity.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity.getArtifactData()).andReturn(artifact_data).anyTimes();
  expect(entity2.getArtifactName()).andReturn("test-artifact2").anyTimes();
  expect(entity2.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity2.getArtifactData()).andReturn(artifact_data2).anyTimes();
  replay(dao,em,controller,request,clusters,cluster,entity,entity2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property("Artifacts/cluster_name").equals("test-cluster").end().toPredicate();
  Set<Resource> response=resourceProvider.getResources(request,predicate);
  assertEquals(2,response.size());
  boolean artifact1Returned=false;
  boolean artifact2Returned=false;
  for (  Resource resource : response) {
    if (resource.getPropertyValue("Artifacts/artifact_name").equals("test-artifact")) {
      artifact1Returned=true;
      assertEquals("bar",resource.getPropertyValue("artifact_data/foo"));
      assertEquals("test-cluster",resource.getPropertyValue("Artifacts/cluster_name"));
    }
 else     if (resource.getPropertyValue("Artifacts/artifact_name").equals("test-artifact2")) {
      artifact2Returned=true;
      assertEquals("bar2",resource.getPropertyValue("artifact_data/foo2"));
      assertEquals("test-cluster",resource.getPropertyValue("Artifacts/cluster_name"));
    }
 else {
      fail("unexpected artifact name");
    }
  }
  assertTrue(artifact1Returned);
  assertTrue(artifact2Returned);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResources() throws Exception {
  Capture<ArtifactEntity> deleteEntityCapture=new Capture<ArtifactEntity>();
  Capture<ArtifactEntity> deleteEntityCapture2=new Capture<ArtifactEntity>();
  TreeMap<String,String> foreignKeys=new TreeMap<String,String>();
  foreignKeys.put("cluster","500");
  List<ArtifactEntity> entities=new ArrayList<ArtifactEntity>();
  entities.add(entity);
  entities.add(entity2);
  Map<String,Object> artifact_data=Collections.<String,Object>singletonMap("foo","bar");
  Map<String,Object> artifact_data2=Collections.<String,Object>singletonMap("foo2","bar2");
  Map<String,String> responseForeignKeys=new HashMap<String,String>();
  responseForeignKeys.put("cluster","500");
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("test-cluster")).andReturn(cluster).anyTimes();
  expect(clusters.getClusterById(500L)).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(500L).anyTimes();
  expect(cluster.getClusterName()).andReturn("test-cluster").anyTimes();
  expect(entity.getArtifactName()).andReturn("test-artifact").anyTimes();
  expect(entity.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity.getArtifactData()).andReturn(artifact_data).anyTimes();
  expect(entity2.getArtifactName()).andReturn("test-artifact2").anyTimes();
  expect(entity2.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity2.getArtifactData()).andReturn(artifact_data2).anyTimes();
  expect(dao.findByForeignKeys(eq(foreignKeys))).andReturn(entities).once();
  expect(dao.findByNameAndForeignKeys(eq("test-artifact"),eq(foreignKeys))).andReturn(entity).once();
  dao.remove(capture(deleteEntityCapture));
  expect(dao.findByNameAndForeignKeys(eq("test-artifact2"),eq(foreignKeys))).andReturn(entity2).once();
  dao.remove(capture(deleteEntityCapture2));
  replay(dao,em,controller,request,clusters,cluster,entity,entity2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property("Artifacts/cluster_name").equals("test-cluster").end().toPredicate();
  RequestStatus response=resourceProvider.deleteResources(predicate);
  ArtifactEntity deleteEntity=deleteEntityCapture.getValue();
  ArtifactEntity deleteEntity2=deleteEntityCapture2.getValue();
  if (deleteEntity.getArtifactName().equals("test-artifact")) {
    assertEquals("test-artifact2",deleteEntity2.getArtifactName());
  }
 else   if (deleteEntity.getArtifactName().equals("test-artifact2")) {
    assertEquals("test-artifact",deleteEntity2.getArtifactName());
  }
 else {
    fail("Unexpected artifact name: " + deleteEntity.getArtifactName());
  }
  assertEquals(foreignKeys,deleteEntity.getForeignKeys());
  assertEquals(foreignKeys,deleteEntity2.getForeignKeys());
  assertEquals(RequestStatus.Status.Complete,response.getStatus());
  verify(dao,em,controller,request,clusters,cluster,entity,entity2);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateResources() throws Exception {
  Map<String,String> requestInfoProps=new HashMap<String,String>();
  requestInfoProps.put(Request.REQUEST_INFO_BODY_PROPERTY,bodyJson);
  Capture<ArtifactEntity> updateEntityCapture=new Capture<ArtifactEntity>();
  Capture<ArtifactEntity> updateEntityCapture2=new Capture<ArtifactEntity>();
  Set<String> propertyIds=new HashSet<String>();
  TreeMap<String,String> foreignKeys=new TreeMap<String,String>();
  foreignKeys.put("cluster","500");
  List<ArtifactEntity> entities=new ArrayList<ArtifactEntity>();
  entities.add(entity);
  entities.add(entity2);
  Map<String,Object> artifact_data=Collections.<String,Object>singletonMap("foo","bar");
  Map<String,Object> artifact_data2=Collections.<String,Object>singletonMap("foo2","bar2");
  Map<String,String> responseForeignKeys=new HashMap<String,String>();
  responseForeignKeys.put("cluster","500");
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("Artifacts/artifact_name","test-artifact");
  properties.put("Artifacts/cluster_name","test-cluster");
  properties.put("artifact_data/foo","bar");
  properties.put("artifact_data/child/childKey","childValue");
  properties.put("artifact_data/child/child2/child2Key","child2Value");
  properties.put("artifact_data/child/child2/child3/child4/child4Key","child4Value");
  Set<Map<String,Object>> requestProperties=Collections.singleton(properties);
  Collection collectionProperties=new HashSet();
  properties.put("artifact_data/collection",collectionProperties);
  expect(request.getProperties()).andReturn(requestProperties).anyTimes();
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProps).anyTimes();
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("test-cluster")).andReturn(cluster).anyTimes();
  expect(clusters.getClusterById(500L)).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(500L).anyTimes();
  expect(cluster.getClusterName()).andReturn("test-cluster").anyTimes();
  expect(request.getPropertyIds()).andReturn(propertyIds).anyTimes();
  expect(dao.findByForeignKeys(eq(foreignKeys))).andReturn(entities).anyTimes();
  expect(entity.getArtifactName()).andReturn("test-artifact").anyTimes();
  expect(entity.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity.getArtifactData()).andReturn(artifact_data).anyTimes();
  expect(entity2.getArtifactName()).andReturn("test-artifact2").anyTimes();
  expect(entity2.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity2.getArtifactData()).andReturn(artifact_data2).anyTimes();
  expect(dao.merge(capture(updateEntityCapture))).andReturn(entity).once();
  expect(dao.merge(capture(updateEntityCapture2))).andReturn(entity2).once();
  replay(dao,em,controller,request,clusters,cluster,entity,entity2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property("Artifacts/cluster_name").equals("test-cluster").end().toPredicate();
  RequestStatus response=resourceProvider.updateResources(request,predicate);
  ArtifactEntity updateEntity=updateEntityCapture.getValue();
  ArtifactEntity updateEntity2=updateEntityCapture2.getValue();
  Gson serializer=new Gson();
  ArtifactEntity expected=new ArtifactEntity();
  expected.setArtifactData((Map<String,Object>)serializer.<Map<String,Object>>fromJson(bodyJson,Map.class).get("artifact_data"));
  assertEquals(expected.getArtifactData(),updateEntity.getArtifactData());
  assertEquals(expected.getArtifactData(),updateEntity2.getArtifactData());
  if (updateEntity.getArtifactName().equals("test-artifact")) {
    assertEquals("test-artifact2",updateEntity2.getArtifactName());
  }
 else   if (updateEntity.getArtifactName().equals("test-artifact2")) {
    assertEquals("test-artifact",updateEntity2.getArtifactName());
  }
 else {
    fail("Unexpected artifact name: " + updateEntity.getArtifactName());
  }
  assertEquals(foreignKeys,updateEntity.getForeignKeys());
  assertEquals(foreignKeys,updateEntity2.getForeignKeys());
  assertEquals(RequestStatus.Status.Complete,response.getStatus());
  verify(dao,em,controller,request,clusters,cluster,entity,entity2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintConfigurationProcessorTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__MultipleMatchingHostGroupsError() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","localhost");
  typeProps.put("yarn.timeline-service.address","localhost");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  group1Components.add("APP_TIMELINE_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  group2Components.add("APP_TIMELINE_SERVER");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("APP_TIMELINE_SERVER")).andReturn(new Cardinality("0-1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  try {
    updater.doUpdateForClusterCreate();
    fail("IllegalArgumentException should have been thrown");
  }
 catch (  IllegalArgumentException illegalArgumentException) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabledAndActiveNodeSet() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="serverThree";
  final String expectedHostNameTwo="serverFour";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hadoopEnvProperties.put("dfs_ha_initial_namenode_active",expectedHostName);
  hadoopEnvProperties.put("dfs_ha_initial_namenode_standby",expectedHostNameTwo);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add(expectedHostNameTwo);
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String expectedPropertyValue=hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne);
  if (!expectedPropertyValue.equals(expectedHostName + ":" + expectedPortNum) && !expectedPropertyValue.equals(expectedHostNameTwo + ":" + expectedPortNum)) {
    fail("HTTPS address HA property not properly exported");
  }
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("Active Namenode hostname was not set correctly",expectedHostName,hadoopEnvProperties.get("dfs_ha_initial_namenode_active"));
  assertEquals("Standby Namenode hostname was not set correctly",expectedHostNameTwo,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabledSpecifyingHostNamesDirectly() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  configProperties.put("hdfs-site",hdfsSiteProperties);
  configProperties.put("hadoop-env",hadoopEnvProperties);
  configProperties.put("core-site",coreSiteProperties);
  configProperties.put("hbase-site",hbaseSiteProperties);
  configProperties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  coreSiteProperties.put("fs.defaultFS","hdfs://" + expectedNameService);
  hbaseSiteProperties.put("hbase.rootdir","hdfs://" + expectedNameService + "/hbase/test/root/dir");
  accumuloSiteProperties.put("instance.volumes","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes");
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  String activeHost=hadoopEnvProperties.get("dfs_ha_initial_namenode_active");
  if (activeHost.equals(expectedHostName)) {
    assertEquals("Standby Namenode hostname was not set correctly",expectedHostNameTwo,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  }
 else   if (activeHost.equals(expectedHostNameTwo)) {
    assertEquals("Standby Namenode hostname was not set correctly",expectedHostName,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  }
 else {
    fail("Active Namenode hostname was not set correctly: " + activeHost);
  }
  assertEquals("fs.defaultFS should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService,coreSiteProperties.get("fs.defaultFS"));
  assertEquals("hbase.rootdir should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/hbase/test/root/dir",hbaseSiteProperties.get("hbase.rootdir"));
  assertEquals("instance.volumes should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes",accumuloSiteProperties.get("instance.volumes"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabled() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  properties.put("core-site",coreSiteProperties);
  properties.put("hbase-site",hbaseSiteProperties);
  properties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.https-address","localhost:8081");
  hdfsSiteProperties.put("dfs.namenode.rpc-address","localhost:8082");
  coreSiteProperties.put("fs.defaultFS","hdfs://" + expectedNameService);
  hbaseSiteProperties.put("hbase.rootdir","hdfs://" + expectedNameService + "/hbase/test/root/dir");
  accumuloSiteProperties.put("instance.volumes","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  String initialActiveHost=hadoopEnvProperties.get("dfs_ha_initial_namenode_active");
  String expectedStandbyHost=null;
  if (initialActiveHost.equals(expectedHostName)) {
    expectedStandbyHost=expectedHostNameTwo;
  }
 else   if (initialActiveHost.equals(expectedHostNameTwo)) {
    expectedStandbyHost=expectedHostName;
  }
 else {
    fail("Active Namenode hostname was not set correctly");
  }
  assertEquals("Standby Namenode hostname was not set correctly",expectedStandbyHost,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  assertEquals("fs.defaultFS should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService,coreSiteProperties.get("fs.defaultFS"));
  assertEquals("hbase.rootdir should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/hbase/test/root/dir",hbaseSiteProperties.get("hbase.rootdir"));
  assertEquals("instance.volumes should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes",accumuloSiteProperties.get("instance.volumes"));
  assertFalse("dfs.namenode.http-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.http-address"));
  assertFalse("dfs.namenode.https-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.https-address"));
  assertFalse("dfs.namenode.rpc-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.rpc-address"));
  assertEquals("Incorrect number of updated config types returned, set = " + updatedConfigTypes,3,updatedConfigTypes.size());
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("cluster-env"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hdfs-site"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hadoop-env"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__MissingComponent() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","localhost");
  typeProps.put("yarn.timeline-service.address","localhost");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("APP_TIMELINE_SERVER")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  try {
    updater.doUpdateForClusterCreate();
    fail("IllegalArgumentException should have been thrown");
  }
 catch (  IllegalArgumentException illegalArgumentException) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintResourceProviderTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_wrongConfigurationStructure_withoutConfigsList() throws ResourceAlreadyExistsException, SystemException, UnsupportedPropertyException, NoSuchParentResourceException {
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  String configurationData="{\"configurations\":{\"config-type1\": \"properties\", \"config-type2\": \"properties\"}}";
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,configurationData);
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  replay(dao,metaInfo,request);
  try {
    provider.createResources(request);
    fail("Exception expected");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(BlueprintResourceProvider.CONFIGURATION_LIST_CHECK_ERROR_MESSAGE,e.getMessage());
  }
  verify(dao,metaInfo,request);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources_TopologyValidationFails() throws Exception {
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  blueprint.validateTopology();
  expectLastCall().andThrow(new InvalidTopologyException("test"));
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  replay(dao,entity,metaInfo,blueprintFactory,blueprint,request);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),createMock(AmbariManagementController.class));
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  try {
    provider.createResources(request);
    fail("Expected exception due to topology validation error");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(dao,entity,blueprintFactory,metaInfo,request);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testCreateResources_ReqestBodyIsEmpty() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,null);
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  replay(request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  try {
    provider.createResources(request);
    fail("Exception expected");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(BlueprintResourceProvider.REQUEST_BODY_EMPTY_ERROR_MESSAGE,e.getMessage());
  }
  verify(request,managementController);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_wrongConfigurationsStructure_withWrongConfigMapSize() throws ResourceAlreadyExistsException, SystemException, UnsupportedPropertyException, NoSuchParentResourceException {
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  String configurationData="{\"configurations\":[{\"config-type1\":{\"properties\" :{\"property\":\"property-value\"}}," + "\"config-type2\" : {\"properties_attributes\" : {\"property\" : \"property-value\"}, \"properties\" : {\"property\" : \"property-value\"}}}" + "]}";
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,configurationData);
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  replay(dao,metaInfo,request);
  try {
    provider.createResources(request);
    fail("Exception expected");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(BlueprintResourceProvider.CONFIGURATION_MAP_SIZE_CHECK_ERROR_MESSAGE,e.getMessage());
  }
  verify(dao,metaInfo,request);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResource_BlueprintFactoryThrowsException() throws Exception {
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  setProperties.iterator().next().remove(BlueprintResourceProvider.HOST_GROUP_PROPERTY_ID);
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andThrow(new IllegalArgumentException("Blueprint name must be provided"));
  expect(securityFactory.createSecurityConfigurationFromRequest(null,true)).andReturn(null).anyTimes();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  replay(dao,entity,metaInfo,blueprintFactory,securityFactory,blueprint,request);
  try {
    provider.createResources(request);
    fail("Exception expected");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(dao,entity,blueprintFactory,metaInfo,request);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_wrongConfigurationStructure_withoutConfigMaps() throws ResourceAlreadyExistsException, SystemException, UnsupportedPropertyException, NoSuchParentResourceException {
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  String configurationData="{\"configurations\":[\"config-type1\", \"config-type2\"]}";
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,configurationData);
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  replay(dao,metaInfo,request);
  try {
    provider.createResources(request);
    fail("Exception expected");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(BlueprintResourceProvider.CONFIGURATION_MAP_CHECK_ERROR_MESSAGE,e.getMessage());
  }
  verify(dao,metaInfo,request);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClientConfigResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID).equals("c1").toPredicate();
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  SystemException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("HDFS_CLIENT").toPredicate();
  try {
    provider.deleteResources(predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  SystemException e) {
  }
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID,"c1");
  properties.put(ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID,"HDFS_CLIENT");
  properties.put(ClientConfigResourceProvider.COMPONENT_SERVICE_NAME_PROPERTY_ID,"HDFS");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  try {
    provider.createResources(request);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  SystemException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterControllerImplTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResourcesWithUnsupportedPropertyPredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  Request request=PropertyHelper.getUpdateRequest(propertyMap,null);
  Predicate predicate=new PredicateBuilder().property(UNSUPPORTED_PROPERTY).equals(1).toPredicate();
  try {
    controller.updateResources(Resource.Type.Host,request,predicate);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetResourcesWithUnsupportedPropertyRequest() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(PropertyHelper.getPropertyId("c1","p1"));
  propertyIds.add(PropertyHelper.getPropertyId("c1","p2"));
  propertyIds.add(PropertyHelper.getPropertyId("c1","p3"));
  propertyIds.add(UNSUPPORTED_PROPERTY);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property("c1/p2").equals(1).toPredicate();
  try {
    controller.getResourceIterable(Resource.Type.Host,request,predicate);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResourcesWithUnsupportedProperty() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(UNSUPPORTED_PROPERTY,2);
  properties.add(propertyMap);
  Request request=PropertyHelper.getCreateRequest(properties,null);
  try {
    controller.createResources(Resource.Type.Host,request);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResourcesWithUnsupportedProperty() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Predicate predicate=new PredicateBuilder().property(UNSUPPORTED_PROPERTY).equals(1).toPredicate();
  try {
    controller.deleteResources(Resource.Type.Host,predicate);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResourcesWithUnsupportedPropertyRequest() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(UNSUPPORTED_PROPERTY,2);
  Request request=PropertyHelper.getUpdateRequest(propertyMap,null);
  Predicate predicate=new PredicateBuilder().property("c1/p2").equals(1).toPredicate();
  try {
    controller.updateResources(Resource.Type.Host,request,predicate);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetResourcesWithUnsupportedPropertyPredicate() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(PropertyHelper.getPropertyId("c1","p1"));
  propertyIds.add(PropertyHelper.getPropertyId("c1","p2"));
  propertyIds.add(PropertyHelper.getPropertyId("c1","p3"));
  propertyIds.add(PropertyHelper.getPropertyId("c2","p4"));
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(UNSUPPORTED_PROPERTY).equals(1).toPredicate();
  try {
    controller.getResourceIterable(Resource.Type.Host,request,predicate);
    Assert.fail("Expected an UnsupportedPropertyException for the unsupported properties.");
  }
 catch (  UnsupportedPropertyException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ComponentResourceProviderTest </h4><pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceComponentNotFoundException is propagated in case where there is a single request.
 */
@Test public void testGetComponents_ServiceComponentNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=EasyMock.newCapture();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponentRequest request1=new ServiceComponentRequest("cluster1","service1","component1",null);
  Set<ServiceComponentRequest> setRequests=new HashSet<ServiceComponentRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andThrow(new ServiceComponentNotFoundException("cluster1","service1","component1"));
  replay(maintHelper,injector,clusters,cluster,service);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  try {
    getComponentResourceProvider(controller).getComponents(setRequests);
    fail("expected ServiceComponentNotFoundException");
  }
 catch (  ServiceComponentNotFoundException e) {
  }
  assertSame(controller,controllerCapture.getValue());
  verify(injector,clusters,cluster,service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigurationResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  Resource.Type type=Resource.Type.Configuration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  Predicate predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("Configuration100").toPredicate();
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  Resource.Type type=Resource.Type.Configuration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Predicate predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("Configuration100").toPredicate();
  try {
    provider.deleteResources(predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.CredentialResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources_FailMissingPrincipal() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  CredentialResourceProvider credentialResourceProvider=new CredentialResourceProvider(managementController);
  injector.injectMembers(credentialResourceProvider);
  Set<Map<String,Object>> setProperties=getCredentialTestProperties("c1","alias1",null,"password1",CredentialStoreType.TEMPORARY);
  expect(request.getProperties()).andReturn(setProperties);
  ResourceProviderFactory factory=createMock(ResourceProviderFactory.class);
  expect(factory.getCredentialResourceProvider(anyObject(AmbariManagementController.class))).andReturn(credentialResourceProvider);
  replay(request,factory,managementController);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  AbstractControllerResourceProvider.init(factory);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Credential,PropertyHelper.getPropertyIds(Resource.Type.Credential),PropertyHelper.getKeyPropertyIds(Resource.Type.Credential),managementController);
  try {
    provider.createResources(request);
    Assert.fail("Expected exception due to missing alias");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(request,factory,managementController);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources_FailMissingAlias() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  CredentialResourceProvider credentialResourceProvider=new CredentialResourceProvider(managementController);
  injector.injectMembers(credentialResourceProvider);
  Set<Map<String,Object>> setProperties=getCredentialTestProperties("c1",null,"username1","password1",CredentialStoreType.TEMPORARY);
  expect(request.getProperties()).andReturn(setProperties);
  ResourceProviderFactory factory=createMock(ResourceProviderFactory.class);
  expect(factory.getCredentialResourceProvider(anyObject(AmbariManagementController.class))).andReturn(credentialResourceProvider);
  replay(request,factory,managementController);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  AbstractControllerResourceProvider.init(factory);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Credential,PropertyHelper.getPropertyIds(Resource.Type.Credential),PropertyHelper.getKeyPropertyIds(Resource.Type.Credential),managementController);
  try {
    provider.createResources(request);
    Assert.fail("Expected exception due to missing alias");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(request,factory,managementController);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_NotInitialized() throws Exception {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      bind(CredentialStoreService.class).to(CredentialStoreServiceImpl.class);
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(SecurePasswordHelper.class).toInstance(new SecurePasswordHelper());
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  CredentialResourceProvider credentialResourceProvider=new CredentialResourceProvider(managementController);
  injector.injectMembers(credentialResourceProvider);
  expect(request.getProperties()).andReturn(getCredentialTestProperties("c1","alias1","username1","password1",CredentialStoreType.TEMPORARY)).once();
  expect(request.getProperties()).andReturn(getCredentialTestProperties("c1","alias1","username1","password1",CredentialStoreType.PERSISTED)).once();
  expect(request.getPropertyIds()).andReturn(null).anyTimes();
  ResourceProviderFactory factory=createMock(ResourceProviderFactory.class);
  expect(factory.getCredentialResourceProvider(anyObject(AmbariManagementController.class))).andReturn(credentialResourceProvider);
  replay(request,factory,managementController);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  AbstractControllerResourceProvider.init(factory);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Credential,PropertyHelper.getPropertyIds(Resource.Type.Credential),PropertyHelper.getKeyPropertyIds(Resource.Type.Credential),managementController);
  provider.createResources(request);
  try {
    provider.createResources(request);
    Assert.fail("Expected IllegalArgumentException thrown");
  }
 catch (  IllegalArgumentException e) {
    Assert.assertEquals("Credentials cannot be stored in Ambari's persistent secure credential " + "store since secure persistent storage has not yet be configured.  Use ambari-server " + "setup-security to enable this feature.",e.getLocalizedMessage());
  }
  verify(request,factory,managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ExportBlueprintRequestTest </h4><pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExport_noConfigs() throws Exception {
  Resource clusterResource=new ResourceImpl(Resource.Type.Cluster);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_ID_PROPERTY_ID,CLUSTER_ID);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"TEST-1.0");
  TreeNode<Resource> clusterNode=new TreeNodeImpl<Resource>(null,clusterResource,"cluster");
  Resource configResource=new ResourceImpl(Resource.Type.Configuration);
  clusterNode.addChild(configResource,"configurations");
  Resource hostsResource=new ResourceImpl(Resource.Type.Host);
  Resource host1Resource=new ResourceImpl(Resource.Type.Host);
  Resource host2Resource=new ResourceImpl(Resource.Type.Host);
  Resource host3Resource=new ResourceImpl(Resource.Type.Host);
  TreeNode<Resource> hostsNode=clusterNode.addChild(hostsResource,"hosts");
  TreeNode<Resource> host1Node=hostsNode.addChild(host1Resource,"host_1");
  TreeNode<Resource> host2Node=hostsNode.addChild(host2Resource,"host_2");
  TreeNode<Resource> host3Node=hostsNode.addChild(host3Resource,"host_3");
  host1Resource.setProperty("Hosts/host_name","host1");
  host2Resource.setProperty("Hosts/host_name","host2");
  host3Resource.setProperty("Hosts/host_name","host3");
  List<String> host1ComponentsList=Arrays.asList("NAMENODE","HDFS_CLIENT","ZOOKEEPER_SERVER","SECONDARY_NAMENODE");
  List<String> host2ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  List<String> host3ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  processHostGroupComponents(host1Node,host1ComponentsList);
  processHostGroupComponents(host2Node,host2ComponentsList);
  processHostGroupComponents(host3Node,host3ComponentsList);
  ExportBlueprintRequest exportBlueprintRequest=new ExportBlueprintRequest(clusterNode);
  assertEquals(CLUSTER_NAME,exportBlueprintRequest.getClusterName());
  Blueprint bp=exportBlueprintRequest.getBlueprint();
  assertEquals("exported-blueprint",bp.getName());
  Map<String,HostGroup> hostGroups=bp.getHostGroups();
  assertEquals(2,hostGroups.size());
  String hg1Name=null;
  String hg2Name=null;
  for (  HostGroup group : hostGroups.values()) {
    Collection<String> components=group.getComponentNames();
    if (components.containsAll(host1ComponentsList)) {
      assertEquals(host1ComponentsList.size(),components.size());
      assertEquals("1",group.getCardinality());
      hg1Name=group.getName();
    }
 else     if (components.containsAll(host2ComponentsList)) {
      assertEquals(host2ComponentsList.size(),components.size());
      assertEquals("2",group.getCardinality());
      hg2Name=group.getName();
    }
 else {
      fail("Host group contained invalid components");
    }
  }
  assertNotNull(hg1Name);
  assertNotNull(hg2Name);
  HostGroupInfo host1Info=exportBlueprintRequest.getHostGroupInfo().get(hg1Name);
  assertEquals(1,host1Info.getHostNames().size());
  assertEquals("host1",host1Info.getHostNames().iterator().next());
  HostGroupInfo host2Info=exportBlueprintRequest.getHostGroupInfo().get(hg2Name);
  assertEquals(2,host2Info.getHostNames().size());
  assertTrue(host2Info.getHostNames().contains("host2") && host2Info.getHostNames().contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostKerberosIdentityResourceProviderTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  KerberosPrincipalDescriptor principalDescriptor1=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor1.getValue()).andReturn("principal1@EXAMPLE.COM");
  expect(principalDescriptor1.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor1.getLocalUsername()).andReturn("principal1");
  KerberosKeytabDescriptor keytabDescriptor1=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor1.getOwnerAccess()).andReturn("rw").times(1);
  expect(keytabDescriptor1.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor1.getFile()).andReturn("/etc/security/keytabs/principal1.headless.keytab").times(1);
  expect(keytabDescriptor1.getOwnerName()).andReturn("principal1").times(1);
  expect(keytabDescriptor1.getGroupName()).andReturn("principal1").times(1);
  KerberosIdentityDescriptor identity1=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity1.getPrincipalDescriptor()).andReturn(principalDescriptor1).times(1);
  expect(identity1.getKeytabDescriptor()).andReturn(keytabDescriptor1).times(1);
  expect(identity1.getName()).andReturn("identity1").times(1);
  KerberosPrincipalDescriptor principalDescriptor2=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor2.getValue()).andReturn("principal2/Host100@EXAMPLE.COM");
  expect(principalDescriptor2.getType()).andReturn(KerberosPrincipalType.SERVICE).times(1);
  expect(principalDescriptor2.getLocalUsername()).andReturn("principal2");
  KerberosIdentityDescriptor identity2=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity2.getPrincipalDescriptor()).andReturn(principalDescriptor2).times(1);
  expect(identity2.getKeytabDescriptor()).andReturn(null).times(1);
  expect(identity2.getName()).andReturn("identity2").times(1);
  KerberosIdentityDescriptor identity3=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity3.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosIdentityDescriptor identity4=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity4.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosPrincipalDescriptor principalDescriptor5=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor5.getValue()).andReturn("principal5@EXAMPLE.COM");
  expect(principalDescriptor5.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor5.getLocalUsername()).andReturn("principal5");
  KerberosKeytabDescriptor keytabDescriptor5=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor5.getOwnerAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getFile()).andReturn("/etc/security/keytabs/principal5.headless.keytab").times(1);
  expect(keytabDescriptor5.getOwnerName()).andReturn("principal5").times(1);
  expect(keytabDescriptor5.getGroupName()).andReturn("hadoop").times(1);
  KerberosIdentityDescriptor identity5=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity5.getPrincipalDescriptor()).andReturn(principalDescriptor5).times(1);
  expect(identity5.getKeytabDescriptor()).andReturn(keytabDescriptor5).times(1);
  expect(identity5.getName()).andReturn("identity5").times(1);
  KerberosPrincipalDAO kerberosPrincipalDAO=createStrictMock(KerberosPrincipalDAO.class);
  expect(kerberosPrincipalDAO.exists("principal1@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal2/Host100@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal5@EXAMPLE.COM")).andReturn(false).times(1);
  KerberosPrincipalHostDAO kerberosPrincipalHostDAO=createStrictMock(KerberosPrincipalHostDAO.class);
  expect(kerberosPrincipalHostDAO.exists("principal1@EXAMPLE.COM",100L)).andReturn(true).times(1);
  expect(kerberosPrincipalHostDAO.exists("principal2/Host100@EXAMPLE.COM",100L)).andReturn(false).times(1);
  HostEntity host100=createStrictMock(HostEntity.class);
  expect(host100.getHostId()).andReturn(100L).times(1);
  HostDAO hostDAO=createStrictMock(HostDAO.class);
  expect(hostDAO.findByName("Host100")).andReturn(host100).times(1);
  Collection<KerberosIdentityDescriptor> identities=new ArrayList<KerberosIdentityDescriptor>();
  identities.add(identity1);
  identities.add(identity2);
  identities.add(identity3);
  identities.add(identity4);
  identities.add(identity5);
  Map<String,Collection<KerberosIdentityDescriptor>> activeIdentities=new HashMap<String,Collection<KerberosIdentityDescriptor>>();
  activeIdentities.put("Host100",identities);
  KerberosHelper kerberosHelper=createStrictMock(KerberosHelper.class);
  expect(kerberosHelper.getActiveIdentities("Cluster100","Host100",null,null,true)).andReturn(activeIdentities).times(1);
  replayAll();
  ResourceProvider provider=new HostKerberosIdentityResourceProvider(managementController);
  Field field;
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosHelper");
  field.setAccessible(true);
  field.set(provider,kerberosHelper);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalHostDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalHostDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("hostDAO");
  field.setAccessible(true);
  field.set(provider,hostDAO);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID).equals("Host100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("Host100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID));
    String principal=(String)resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
    if ("principal1@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal1.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("rw",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("640",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("true",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal2/Host100@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.SERVICE,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("false",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal5@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal5.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("hadoop",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("440",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("unknown",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else {
      Assert.fail("Unexpected principal: " + principal);
    }
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Ensure that HostNotFoundException is propagated in case where there is a single request.
 */
@Test public void testGetHosts___HostNotFoundException_HostNotAssociatedWithCluster() throws Exception {
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  Host host=createNiceMock(Host.class);
  HostRequest request1=new HostRequest("host1","cluster1",Collections.<String,String>emptyMap());
  Set<HostRequest> setRequests=Collections.singleton(request1);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getHost("host1")).andReturn(host);
  expect(host.getHostName()).andReturn("host1").anyTimes();
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.<Cluster>emptySet());
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  try {
    getHosts(managementController,setRequests);
    fail("expected HostNotFoundException");
  }
 catch (  HostNotFoundException e) {
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Ensure that HostNotFoundException is propagated in case where there is a single request.
 */
@Test public void testGetHosts___HostNotFoundException() throws Exception {
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostRequest request1=new HostRequest("host1","cluster1",Collections.<String,String>emptyMap());
  Set<HostRequest> setRequests=Collections.singleton(request1);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getHost("host1")).andThrow(new HostNotFoundException("host1"));
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  try {
    getHosts(managementController,setRequests);
    fail("expected HostNotFoundException");
  }
 catch (  HostNotFoundException e) {
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.InstanceResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  IvoryService service=createMock(IvoryService.class);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  Map<String,Object> properties=new HashMap<String,Object>();
  replay(service);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,Collections.<String,String>emptyMap());
  InstanceResourceProvider provider=new InstanceResourceProvider(service,PropertyHelper.getPropertyIds(Resource.Type.DRInstance),PropertyHelper.getKeyPropertyIds(Resource.Type.DRInstance));
  try {
    provider.createResources(request);
    Assert.fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.LdapSyncEventResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  LdapSyncEventResourceProvider provider=new TestLdapSyncEventResourceProvider(amc);
  Request request=createNiceMock(Request.class);
  try {
    provider.updateResources(request,null);
    Assert.fail("expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.PermissionResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  PermissionResourceProvider provider=new PermissionResourceProvider();
  Request request=createNiceMock(Request.class);
  try {
    provider.updateResources(request,null);
    Assert.fail("expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  PermissionResourceProvider provider=new PermissionResourceProvider();
  Request request=createNiceMock(Request.class);
  try {
    provider.createResources(request);
    Assert.fail("expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  PermissionResourceProvider provider=new PermissionResourceProvider();
  try {
    provider.deleteResources(null);
    Assert.fail("expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RepositoryVersionResourceProviderTest </h4><pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateRepositoryVersion() throws Exception {
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  StackEntity stackEntity=stackDAO.find("HDP","1.1");
  Assert.assertNotNull(stackEntity);
  final RepositoryVersionResourceProvider provider=(RepositoryVersionResourceProvider)injector.getInstance(ResourceProviderFactory.class).getRepositoryVersionResourceProvider();
  final RepositoryVersionEntity entity=new RepositoryVersionEntity();
  entity.setDisplayName("name");
  entity.setStack(stackEntity);
  entity.setVersion("1.1");
  entity.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1-17");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.1.1");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.343432.2");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.343432.2-234234324");
  provider.validateRepositoryVersion(entity);
  entity.setOperatingSystems(jsonStringRedhat7);
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  entity.setOperatingSystems("");
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  StackEntity bigtop=new StackEntity();
  stackEntity.setStackName("BIGTOP");
  entity.setStack(bigtop);
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  final RepositoryVersionDAO repositoryVersionDAO=injector.getInstance(RepositoryVersionDAO.class);
  entity.setDisplayName("name");
  entity.setStack(stackEntity);
  entity.setVersion("1.1");
  entity.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  repositoryVersionDAO.create(entity);
  final RepositoryVersionEntity entity2=new RepositoryVersionEntity();
  entity2.setId(2l);
  entity2.setDisplayName("name2");
  entity2.setStack(stackEntity);
  entity2.setVersion("1.2");
  entity2.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  try {
    provider.validateRepositoryVersion(entity2);
    Assert.fail("Should throw exception: Base url http://example.com/repo1 is already defined for another repository version");
  }
 catch (  Exception ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestOperationLevelTest </h4><pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExternalLevelName() throws Exception {
  String external=RequestOperationLevel.getExternalLevelName(hostComponent);
  assertEquals(external,host_component);
  try {
    RequestOperationLevel.getExternalLevelName("Wrong_param");
    fail("Should throw exception");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInternalLevelName() throws Exception {
  String internal=RequestOperationLevel.getInternalLevelName(host_component);
  assertEquals(internal,hostComponent);
  internal=RequestOperationLevel.getInternalLevelName(host_component.toLowerCase());
  assertEquals(internal,hostComponent);
  try {
    RequestOperationLevel.getInternalLevelName("Wrong_param");
    fail("Should throw exception");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_ConstructionFromRequestProperties() throws Exception {
  String c1="c1";
  String host_component="HOST_COMPONENT";
  String service_id="HDFS";
  String hostcomponent_id="Namenode";
  String host_id="host1";
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.COMMAND_ID,"RESTART");
  requestInfoProperties.put(RequestOperationLevel.OPERATION_LEVEL_ID,host_component);
  requestInfoProperties.put(RequestOperationLevel.OPERATION_CLUSTER_ID,c1);
  requestInfoProperties.put(RequestOperationLevel.OPERATION_SERVICE_ID,service_id);
  requestInfoProperties.put(RequestOperationLevel.OPERATION_HOSTCOMPONENT_ID,hostcomponent_id);
  requestInfoProperties.put(RequestOperationLevel.OPERATION_HOST_NAME,host_id);
  RequestOperationLevel opLevel=new RequestOperationLevel(requestInfoProperties);
  assertEquals(opLevel.getLevel().toString(),"HostComponent");
  assertEquals(opLevel.getClusterName(),c1);
  assertEquals(opLevel.getServiceName(),service_id);
  assertEquals(opLevel.getHostComponentName(),hostcomponent_id);
  assertEquals(opLevel.getHostName(),host_id);
  requestInfoProperties.put(RequestOperationLevel.OPERATION_LEVEL_ID,"wrong_value");
  try {
    new RequestOperationLevel(requestInfoProperties);
    Assert.fail("Should throw an exception");
  }
 catch (  IllegalArgumentException e) {
  }
  requestInfoProperties.put(RequestOperationLevel.OPERATION_LEVEL_ID,host_component);
  requestInfoProperties.remove(RequestOperationLevel.OPERATION_CLUSTER_ID);
  try {
    new RequestOperationLevel(requestInfoProperties);
    Assert.fail("Should throw an exception");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestResourceProviderTest </h4><pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources_CancelRequest() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  HostRoleCommand hostRoleCommand=createNiceMock(HostRoleCommand.class);
  Stage stage=createNiceMock(Stage.class);
  Clusters clusters=createNiceMock(Clusters.class);
  List<HostRoleCommand> hostRoleCommands=new LinkedList<HostRoleCommand>();
  hostRoleCommands.add(hostRoleCommand);
  Collection<Stage> stages=new HashSet<Stage>();
  stages.add(stage);
  org.apache.ambari.server.actionmanager.Request requestMock=createNiceMock(org.apache.ambari.server.actionmanager.Request.class);
  expect(requestMock.getCommands()).andReturn(hostRoleCommands).anyTimes();
  expect(requestMock.getStages()).andReturn(stages).anyTimes();
  expect(stage.getOrderedHostRoleCommands()).andReturn(hostRoleCommands).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(actionManager.getRequests(capture(requestIdsCapture))).andReturn(Collections.singletonList(requestMock)).anyTimes();
  expect(hostRoleCommand.getStatus()).andReturn(HostRoleStatus.IN_PROGRESS).anyTimes();
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,actionManager,hostRoleCommand,clusters,requestMock,response,stage);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an java.lang.IllegalArgumentException: Abort reason can not be empty.");
  }
 catch (  IllegalArgumentException e) {
  }
  properties.put(RequestResourceProvider.REQUEST_ABORT_REASON_PROPERTY_ID,"Some reason");
  request=PropertyHelper.getUpdateRequest(properties,null);
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an java.lang.IllegalArgumentException: null is wrong value.");
  }
 catch (  IllegalArgumentException e) {
  }
  properties.put(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID,"COMPLETED");
  request=PropertyHelper.getUpdateRequest(properties,null);
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an java.lang.IllegalArgumentException: COMPLETED is wrong value. " + "The only allowed value for updating request status is ABORTED");
  }
 catch (  IllegalArgumentException e) {
  }
  properties.put(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID,"ABORTED");
  for (  HostRoleStatus status : HostRoleStatus.values()) {
    reset(hostRoleCommand);
    expect(hostRoleCommand.getStatus()).andReturn(status).anyTimes();
    replay(hostRoleCommand);
    request=PropertyHelper.getUpdateRequest(properties,null);
    if (status == HostRoleStatus.IN_PROGRESS || status == HostRoleStatus.PENDING || status == HostRoleStatus.HOLDING || status == HostRoleStatus.HOLDING_FAILED || status == HostRoleStatus.HOLDING_TIMEDOUT || status == HostRoleStatus.COMPLETED || status == HostRoleStatus.ABORTED || status == HostRoleStatus.FAILED || status == HostRoleStatus.TIMEDOUT || status == HostRoleStatus.QUEUED || status == HostRoleStatus.SKIPPED_FAILED) {
      provider.updateResources(request,predicate);
    }
 else {
      try {
        provider.updateResources(request,predicate);
        Assert.fail("Expected an java.lang.IllegalArgumentException");
      }
 catch (      IllegalArgumentException e) {
      }
    }
  }
  verify(managementController,response,stage);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestResourceProvider.REQUEST_ID_PROPERTY_ID,"Request100");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  try {
    provider.createResources(request);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("Request100").toPredicate();
  try {
    provider.deleteResources(predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ServiceResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResourcesBadComponentState() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent sc=createNiceMock(ServiceComponent.class);
  Map<String,ServiceComponent> scMap=new HashMap<String,ServiceComponent>();
  scMap.put("Component100",sc);
  State componentState=State.STARTED;
  String serviceName="Service100";
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getService(serviceName)).andReturn(service).anyTimes();
  expect(service.getDesiredState()).andReturn(State.INSTALLED).anyTimes();
  expect(service.getName()).andReturn(serviceName).anyTimes();
  expect(service.getServiceComponents()).andReturn(scMap);
  expect(sc.getDesiredState()).andReturn(componentState).anyTimes();
  expect(sc.getName()).andReturn("Component100").anyTimes();
  expect(sc.canBeRemoved()).andReturn(componentState.isRemovableState()).anyTimes();
  replay(managementController,clusters,cluster,service,sc);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals(serviceName).toPredicate();
  try {
    provider.deleteResources(predicate);
    Assert.fail("Expected exception deleting a service in a non-removable state.");
  }
 catch (  SystemException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StageResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  StageResourceProvider provider=new StageResourceProvider(managementController);
  Request request=createNiceMock(Request.class);
  try {
    provider.createResources(request);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  StageResourceProvider provider=new StageResourceProvider(managementController);
  Predicate predicate=createNiceMock(Predicate.class);
  try {
    provider.deleteResources(predicate);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TaskResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateResources() throws Exception {
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals("Task100").toPredicate();
  try {
    provider.updateResources(request,predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteResources() throws Exception {
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals("Task100").toPredicate();
  try {
    provider.deleteResources(predicate);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources() throws Exception {
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  replay(managementController,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID,100);
  properties.put(TaskResourceProvider.TASK_ID_PROPERTY_ID,100);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  try {
    provider.createResources(request);
    Assert.fail("Expected an UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
  verify(managementController,response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.URLStreamProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testProcessURL_securityNotSetup() throws Exception {
  URLStreamProvider urlStreamProvider=createMockBuilder(URLStreamProvider.class).withConstructor(Integer.TYPE,Integer.TYPE,String.class,String.class,String.class).withArgs(1000,1000,null,null,null).addMockedMethod("getAppCookieManager").addMockedMethod("getConnection",String.class).createMock();
  Map<String,List<String>> headerMap=new HashMap<String,List<String>>();
  headerMap.put("Header1",Collections.singletonList("value"));
  headerMap.put("Cookie",Collections.singletonList("FOO=bar"));
  replay(urlStreamProvider);
  try {
    urlStreamProvider.processURL("https://spec","GET",(String)null,headerMap);
    Assert.fail("Expected IllegalStateException");
  }
 catch (  IllegalStateException e) {
  }
  verify(urlStreamProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderTest </h4><pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeToBase() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  try {
    upgradeResourceProvider.createResources(request);
    Assert.fail("Expected an exception going downgrade with no upgrade pack");
  }
 catch (  Exception e) {
  }
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.1.1.0");
  Map<String,String> requestInfoProperties=new HashMap<>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertEquals(1,status.getAssociatedResources().size());
  Resource r=status.getAssociatedResources().iterator().next();
  String id=r.getPropertyValue("Upgrade/request_id").toString();
  UpgradeEntity entity=upgradeDao.findUpgrade(Long.parseLong(id));
  assertNotNull(entity);
  assertEquals("2.1.1",entity.getFromVersion());
  assertEquals("2.2.0.0",entity.getToVersion());
  assertEquals(Direction.DOWNGRADE,entity.getDirection());
  StageDAO dao=injector.getInstance(StageDAO.class);
  List<StageEntity> stages=dao.findByRequestId(entity.getRequestId());
  Gson gson=new Gson();
  for (  StageEntity se : stages) {
    Map<String,String> map=gson.fromJson(se.getCommandParamsStage(),Map.class);
    assertTrue(map.containsKey("upgrade_direction"));
    assertEquals("downgrade",map.get("upgrade_direction"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ViewInstanceResourceProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources_viewNotLoaded() throws Exception {
  ViewInstanceResourceProvider provider=new ViewInstanceResourceProvider();
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(ViewInstanceResourceProvider.VIEW_NAME_PROPERTY_ID,"V1");
  propertyMap.put(ViewInstanceResourceProvider.VIEW_VERSION_PROPERTY_ID,"1.0.0");
  propertyMap.put(ViewInstanceResourceProvider.INSTANCE_NAME_PROPERTY_ID,"I1");
  properties.add(propertyMap);
  ViewEntity viewEntity=new ViewEntity();
  viewEntity.setName("V1{1.0.0}");
  viewEntity.setStatus(ViewDefinition.ViewStatus.DEPLOYING);
  ViewInstanceEntity viewInstanceEntity=new ViewInstanceEntity();
  viewInstanceEntity.setViewName("V1{1.0.0}");
  viewInstanceEntity.setName("I1");
  viewInstanceEntity.setViewEntity(viewEntity);
  expect(singleton.getDefinition("V1","1.0.0")).andReturn(viewEntity).anyTimes();
  expect(singleton.getDefinition("V1",null)).andReturn(viewEntity);
  expect(singleton.checkAdmin()).andReturn(true);
  replay(singleton);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  try {
    provider.createResources(PropertyHelper.getCreateRequest(properties,null));
    fail("Expected IllegalStateException.");
  }
 catch (  IllegalStateException e) {
  }
  verify(singleton);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateResources_existingInstance() throws Exception {
  ViewInstanceResourceProvider provider=new ViewInstanceResourceProvider();
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(ViewInstanceResourceProvider.VIEW_NAME_PROPERTY_ID,"V1");
  propertyMap.put(ViewInstanceResourceProvider.VIEW_VERSION_PROPERTY_ID,"1.0.0");
  propertyMap.put(ViewInstanceResourceProvider.INSTANCE_NAME_PROPERTY_ID,"I1");
  properties.add(propertyMap);
  ViewInstanceEntity viewInstanceEntity=new ViewInstanceEntity();
  viewInstanceEntity.setViewName("V1{1.0.0}");
  viewInstanceEntity.setName("I1");
  ViewEntity viewEntity=new ViewEntity();
  viewEntity.setStatus(ViewDefinition.ViewStatus.DEPLOYED);
  viewEntity.setName("V1{1.0.0}");
  viewInstanceEntity.setViewEntity(viewEntity);
  expect(singleton.instanceExists(viewInstanceEntity)).andReturn(true);
  expect(singleton.getDefinition("V1","1.0.0")).andReturn(viewEntity).anyTimes();
  expect(singleton.getDefinition("V1",null)).andReturn(viewEntity);
  expect(singleton.checkAdmin()).andReturn(true);
  replay(singleton);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  try {
    provider.createResources(PropertyHelper.getCreateRequest(properties,null));
    fail("Expected ResourceAlreadyExistsException.");
  }
 catch (  ResourceAlreadyExistsException e) {
  }
  verify(singleton);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.GreaterEqualsPredicateTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullValue(){
  try {
    new GreaterEqualsPredicate<Integer>("category/foo",null);
    Assert.fail("Expected IllegalArgumentException for null value.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.GreaterPredicateTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullValue(){
  try {
    new GreaterPredicate<Integer>("category/foo",null);
    Assert.fail("Expected IllegalArgumentException for null value.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.LessEqualsPredicateTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullValue(){
  try {
    new LessEqualsPredicate<Integer>("category/foo",null);
    Assert.fail("Expected IllegalArgumentException for null value.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.LessPredicateTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullValue(){
  try {
    new LessPredicate<Integer>("category/foo",null);
    Assert.fail("Expected IllegalArgumentException for null value.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.spi.ResourceTest </h4><pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResource(){
  for (  Resource.InternalType internalType : Resource.InternalType.values()) {
    Resource.Type type=null;
    try {
      type=Resource.Type.valueOf(internalType.name());
    }
 catch (    IllegalArgumentException e) {
      Assert.fail("Resource.Type should be defined for internal type " + internalType.name() + ".");
    }
    Assert.assertEquals(type.name(),internalType.name());
    Assert.assertEquals(type.ordinal(),internalType.ordinal());
  }
  Resource.Type newType=new Resource.Type("newType");
  Resource.Type newType2=new Resource.Type("newType2");
  Assert.assertFalse(newType.equals(newType2));
  Assert.assertFalse(newType2.equals(newType));
  Assert.assertEquals("newType",newType.name());
  Assert.assertFalse(newType.isInternalType());
  try {
    newType.getInternalType();
    Assert.fail("Can't get internal type for a extended resource.");
  }
 catch (  UnsupportedOperationException e) {
  }
  Resource.Type t1=Resource.Type.valueOf("newType");
  Resource.Type t2=Resource.Type.valueOf("newType2");
  Assert.assertTrue(newType.equals(t1));
  Assert.assertTrue(t1.equals(newType));
  Assert.assertTrue(newType2.equals(t2));
  Assert.assertTrue(t2.equals(newType2));
  Assert.assertFalse(t1.equals(newType2));
  Assert.assertFalse(t2.equals(newType));
  try {
    Resource.Type.valueOf("badType");
    Assert.fail("Expected IllegalArgumentException.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.DatabaseCheckerTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCheckDBVersion_Valid() throws Exception {
  MetainfoDAO metainfoDAO=createMock(MetainfoDAO.class);
  MetainfoEntity metainfoEntity=new MetainfoEntity();
  String serverVersion=ambariMetaInfo.getServerVersion();
  metainfoEntity.setMetainfoName(Configuration.SERVER_VERSION_KEY);
  metainfoEntity.setMetainfoValue(serverVersion);
  expect(metainfoDAO.findByKey(Configuration.SERVER_VERSION_KEY)).andReturn(metainfoEntity);
  replay(metainfoDAO);
  DatabaseChecker.metainfoDAO=metainfoDAO;
  DatabaseChecker.ambariMetaInfo=ambariMetaInfo;
  try {
    DatabaseChecker.checkDBVersion();
  }
 catch (  AmbariException ae) {
    fail("DB versions check failed.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PredicateBuilderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnbalancedBlocks(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb1=new PredicateBuilder();
  try {
    pb1.begin().property(p1).equals("foo").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().or().property(p4).equals("dog").toPredicate();
    Assert.fail("Expected IllegalStateException.");
  }
 catch (  IllegalStateException e) {
  }
  PredicateBuilder pb2=new PredicateBuilder();
  try {
    pb2.begin().property(p1).equals("foo").and().property(p2).equals("bar").or().property(p3).equals("cat").end().end().or().property(p4).equals("dog").toPredicate();
    Assert.fail("Expected IllegalStateException.");
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDone(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property(p1).equals("foo").toPredicate();
  try {
    pb.property(p1).equals("foo").toPredicate();
    Assert.fail("Expected IllegalStateException.");
  }
 catch (  IllegalStateException e) {
  }
  Assert.assertSame(predicate,pb.toPredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PropertyHelperTest </h4><pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDuplicatePointInTimeMetrics(){
  TreeSet<String> set=new TreeSet<String>();
  for (  Resource.Type type : Resource.Type.values()) {
    Map<String,Map<String,PropertyInfo>> gids=PropertyHelper.getMetricPropertyIds(type);
    Map<String,Map<String,PropertyInfo>> jids=PropertyHelper.getJMXPropertyIds(type);
    if (gids != null && jids != null) {
      gids=normalizeMetricNames(gids);
      jids=normalizeMetricNames(jids);
      for (      Map.Entry<String,Map<String,PropertyInfo>> gComponentEntry : gids.entrySet()) {
        String gComponent=gComponentEntry.getKey();
        Set<Map.Entry<String,PropertyInfo>> gComponentEntries=gComponentEntry.getValue().entrySet();
        for (        Map.Entry<String,PropertyInfo> gMetricEntry : gComponentEntries) {
          Map<String,PropertyInfo> jMetrics=jids.get(gComponent);
          if (jMetrics != null) {
            String gMetric=gMetricEntry.getKey();
            PropertyInfo jProperty=jMetrics.get(gMetric);
            if (jProperty != null) {
              PropertyInfo gProperty=gMetricEntry.getValue();
              if (gProperty.isPointInTime()) {
                String s=type + " : " + gComponent+ " : "+ gMetric+ " : "+ gProperty.getPropertyId();
                set.add(s);
              }
            }
          }
        }
      }
    }
  }
  if (set.size() > 0) {
    System.out.println("The following point in time metrics are defined for both JMX and Ganglia.");
    System.out.println("The preference is to get point in time metrics from JMX only if possible.");
    System.out.println("If the metric can be obtained from JMX then set \"pointInTime\" : false for ");
    System.out.println("the metric in the Ganglia properties definition, otherwise remove the metric ");
    System.out.println("from the JMX properties definition.\n");
    for (    String s : set) {
      System.out.println(s);
    }
    Assert.fail("Found duplicate point in time metrics.");
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testJMXTemporal(){
  TreeSet<String> set=new TreeSet<String>();
  for (  Resource.Type type : Resource.Type.values()) {
    Map<String,Map<String,PropertyInfo>> jids=PropertyHelper.getJMXPropertyIds(type);
    if (jids != null) {
      for (      Map.Entry<String,Map<String,PropertyInfo>> jComponentEntry : jids.entrySet()) {
        String jComponent=jComponentEntry.getKey();
        Set<Map.Entry<String,PropertyInfo>> jComponentEntries=jComponentEntry.getValue().entrySet();
        for (        Map.Entry<String,PropertyInfo> jMetricEntry : jComponentEntries) {
          String jMetric=jMetricEntry.getKey();
          PropertyInfo jProperty=jMetricEntry.getValue();
          if (jProperty.isTemporal()) {
            String s=type + " : " + jComponent+ " : "+ jMetric+ " : "+ jProperty.getPropertyId();
            set.add(s);
          }
        }
      }
    }
  }
  if (set.size() > 0) {
    System.out.println("The following metrics are marked as temporal JMX.");
    System.out.println("JMX can provide point in time metrics only.\n");
    for (    String s : set) {
      System.out.println(s);
    }
    Assert.fail("Found temporal JMX metrics.");
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTemporalOnlyMetrics(){
  TreeSet<String> set=new TreeSet<String>();
  for (  Resource.Type type : Resource.Type.values()) {
    Map<String,Map<String,PropertyInfo>> gids=PropertyHelper.getMetricPropertyIds(type);
    Map<String,Map<String,PropertyInfo>> jids=PropertyHelper.getJMXPropertyIds(type);
    if (gids != null && jids != null) {
      gids=normalizeMetricNames(gids);
      jids=normalizeMetricNames(jids);
      for (      Map.Entry<String,Map<String,PropertyInfo>> gComponentEntry : gids.entrySet()) {
        String gComponent=gComponentEntry.getKey();
        Set<Map.Entry<String,PropertyInfo>> gComponentEntries=gComponentEntry.getValue().entrySet();
        for (        Map.Entry<String,PropertyInfo> gMetricEntry : gComponentEntries) {
          Map<String,PropertyInfo> jMetrics=jids.get(gComponent);
          if (jMetrics != null) {
            String gMetric=gMetricEntry.getKey();
            PropertyInfo gProperty=gMetricEntry.getValue();
            if (!gProperty.isPointInTime()) {
              PropertyInfo jProperty=jMetrics.get(gMetric);
              if (jProperty == null || !jProperty.isPointInTime()) {
                String s=type + " : " + gComponent+ " : "+ gMetric+ " : "+ gProperty.getPropertyId();
                set.add(s);
              }
            }
          }
        }
      }
    }
  }
  if (set.size() > 0) {
    System.out.println("The following metrics are marked as temporal only for Ganglia ");
    System.out.println("but are not defined for JMX.");
    System.out.println("The preference is to get point in time metrics from JMX if possible.");
    System.out.println("If the metric can be obtained from JMX then add it to the JMX properties");
    System.out.println("definition, otherwise set set \"pointInTime\" : true for the metric in ");
    System.out.println("the Ganglia properties definition.\n");
    for (    String s : set) {
      System.out.println(s);
    }
    Assert.fail("Found temporal only metrics.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.JdbcPropertyTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testJdbcProperty() throws Exception {
  properties.setProperty(Configuration.SERVER_JDBC_PROPERTIES_PREFIX + "shutdown","true");
  injector=Guice.createInjector(new ControllerModule(properties));
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    injector.getInstance(Clusters.class);
    Assert.fail("Expected in-memory to fail because property 'shutdown' specified.");
  }
 catch (  Throwable t) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RepositoryVersionDAOTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate(){
  UUID uuid=UUID.randomUUID();
  RepositoryVersionEntity first=createSingleRecord();
  Assert.assertNotNull(first);
  StackEntity stackEntity=stackDAO.find(first.getStackName(),first.getStackVersion());
  Assert.assertNotNull(stackEntity);
  RepositoryVersionEntity dupVersion=new RepositoryVersionEntity();
  dupVersion.setDisplayName("display name " + uuid.toString());
  dupVersion.setOperatingSystems("repositories");
  dupVersion.setStack(stackEntity);
  dupVersion.setVersion(first.getVersion());
  boolean exceptionThrown=false;
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("already exists"));
  }
  Assert.assertTrue(exceptionThrown);
  exceptionThrown=false;
  dupVersion.setVersion("2.3-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("needs to belong to stack"));
  }
  Assert.assertTrue(exceptionThrown);
  dupVersion.setVersion(stackEntity.getStackVersion() + "-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    Assert.fail("Did not expect a failure creating the Repository Version");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ServiceConfigDAOTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceConfigs() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  List<ServiceConfigEntity> serviceConfigEntities=serviceConfigDAO.getServiceConfigs(clusterDAO.findByName("c1").getClusterId());
  Assert.assertNotNull(serviceConfigEntities);
  Assert.assertEquals(3,serviceConfigEntities.size());
  for (  ServiceConfigEntity sce : serviceConfigEntities) {
    if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 1)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(1111L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 2)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(2222L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("YARN".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(3333L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(1),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else {
      Assert.fail();
    }
    Assert.assertEquals("admin",sce.getUser());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.HostEntityTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponentStateEntities() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentStateEntity stateEntity=new HostComponentStateEntity();
  hostEntity.setHostComponentStateEntities(new HashSet<HostComponentStateEntity>());
  Collection<HostComponentStateEntity> stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.isEmpty());
  try {
    stateEntities.add(stateEntity);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponentDesiredStateEntities() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentDesiredStateEntity stateEntity=new HostComponentDesiredStateEntity();
  hostEntity.setHostComponentDesiredStateEntities(new HashSet<HostComponentDesiredStateEntity>());
  Collection<HostComponentDesiredStateEntity> stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.isEmpty());
  try {
    stateEntities.add(stateEntity);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.LdapSyncSpecEntityTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIllegalConstruction() throws Exception {
  try {
    new LdapSyncSpecEntity(LdapSyncSpecEntity.PrincipalType.USERS,LdapSyncSpecEntity.SyncType.SPECIFIC,Collections.<String>emptyList());
    Assert.fail("expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  List<String> names=new LinkedList<String>();
  names.add("joe");
  names.add("fred");
  try {
    new LdapSyncSpecEntity(LdapSyncSpecEntity.PrincipalType.USERS,LdapSyncSpecEntity.SyncType.ALL,names);
    Assert.fail("expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    new LdapSyncSpecEntity(LdapSyncSpecEntity.PrincipalType.USERS,LdapSyncSpecEntity.SyncType.EXISTING,names);
    Assert.fail("expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewInstanceEntityTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidate_fail() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml_invalid_instance);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  try {
    viewInstanceEntity.validate(viewEntity,Validator.ValidationContext.PRE_CREATE);
    Assert.fail("Expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateWithValidator_fail() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml_invalid_instance);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewEntityTest.TestValidator validator=new ViewEntityTest.TestValidator();
  validator.result=new ValidationResultImpl(false,"detail");
  viewEntity.setValidator(validator);
  try {
    viewInstanceEntity.validate(viewEntity,Validator.ValidationContext.PRE_CREATE);
    Assert.fail("Expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariAuthorizationProviderDisableUserTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisabledUserViaLdapProvider(){
  try {
    ldapPopulator.getGrantedAuthorities(null,"disabledUser");
    Assert.fail("Disabled user passes authentication");
  }
 catch (  DisabledException e) {
    Assert.assertEquals("User is disabled",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisabledUserViaDaoProvider(){
  try {
    daoProvider.authenticate(new UsernamePasswordAuthenticationToken("disabledUser","pwd"));
    Assert.fail("Disabled user passes authentication");
  }
 catch (  DisabledException e) {
    Assert.assertEquals("User is disabled",e.getMessage());
  }
  Authentication auth=daoProvider.authenticate(new UsernamePasswordAuthenticationToken("activeUser","pwd"));
  Assert.assertNotNull(auth);
  Assert.assertTrue(auth.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLdapAuthenticationProviderTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGoodManagerCredentials() throws Exception {
  AmbariLdapAuthoritiesPopulator authoritiesPopulator=createMock(AmbariLdapAuthoritiesPopulator.class);
  AmbariLdapAuthenticationProvider provider=createMockBuilder(AmbariLdapAuthenticationProvider.class).addMockedMethod("loadLdapAuthenticationProvider").addMockedMethod("isLdapEnabled").withConstructor(configuration,authoritiesPopulator).createMock();
  org.springframework.security.core.AuthenticationException exception=createNiceMock(org.springframework.security.core.AuthenticationException.class);
  expect(exception.getCause()).andReturn(exception).atLeastOnce();
  expect(provider.isLdapEnabled()).andReturn(true);
  expect(provider.loadLdapAuthenticationProvider()).andThrow(exception);
  Logger log=createNiceMock(Logger.class);
  provider.LOG=log;
  log.warn(find("LDAP manager credentials"),(Throwable)anyObject());
  expectLastCall().andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      fail("Should not print warning when LDAP manager credentials are not wrong");
      return null;
    }
  }
).anyTimes();
  replayAll();
  Authentication authentication=new UsernamePasswordAuthenticationToken("notFound","wrong");
  try {
    provider.authenticate(authentication);
    fail("Should throw exception");
  }
 catch (  org.springframework.security.core.AuthenticationException e) {
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBadManagerCredentials() throws Exception {
  AmbariLdapAuthoritiesPopulator authoritiesPopulator=createMock(AmbariLdapAuthoritiesPopulator.class);
  AmbariLdapAuthenticationProvider provider=createMockBuilder(AmbariLdapAuthenticationProvider.class).addMockedMethod("loadLdapAuthenticationProvider").addMockedMethod("isLdapEnabled").withConstructor(configuration,authoritiesPopulator).createMock();
  org.springframework.ldap.AuthenticationException cause=createNiceMock(org.springframework.ldap.AuthenticationException.class);
  org.springframework.security.core.AuthenticationException exception=createNiceMock(org.springframework.security.core.AuthenticationException.class);
  expect(exception.getCause()).andReturn(cause).atLeastOnce();
  expect(provider.isLdapEnabled()).andReturn(true);
  expect(provider.loadLdapAuthenticationProvider()).andThrow(exception);
  Logger log=createNiceMock(Logger.class);
  provider.LOG=log;
  log.warn(find("LDAP manager credentials"),(Throwable)anyObject());
  expectLastCall().atLeastOnce();
  replayAll();
  Authentication authentication=new UsernamePasswordAuthenticationToken("notFound","wrong");
  try {
    provider.authenticate(authentication);
    fail("Should throw exception");
  }
 catch (  org.springframework.security.core.AuthenticationException e) {
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.TestUsers </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllMembers() throws Exception {
  final String groupName="engineering";
  users.createGroup(groupName);
  users.createUser("user1","user1");
  users.createUser("user2","user2");
  users.createUser("user3","user3");
  users.addMemberToGroup(groupName,"user1");
  users.addMemberToGroup(groupName,"user2");
  assertEquals(2,users.getAllMembers(groupName).size());
  try {
    users.getAllMembers("non existing");
    Assert.fail("It shouldn't be possible to call getAllMembers() on non-existing group");
  }
 catch (  Exception ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetUserActive() throws Exception {
  users.createUser("user","user");
  users.setUserActive("user",false);
  Assert.assertEquals(false,users.getAnyUser("user").isActive());
  users.setUserActive("user",true);
  Assert.assertEquals(true,users.getAnyUser("user").isActive());
  try {
    users.setUserActive("fake user",true);
    Assert.fail("It shouldn't be possible to call setUserActive() on non-existing user");
  }
 catch (  Exception ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByNonAdmin() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user2",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  users.createUser("user2","user2");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  try {
    users.modifyPassword("user","user2","user_new_password");
    Assert.fail("Exception should be thrown here as user2 can't change password of user");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetUserLdap() throws Exception {
  users.createUser("user","user");
  users.createUser("user_ldap","user_ldap",true,false,true);
  users.setUserLdap("user");
  Assert.assertEquals(true,users.getAnyUser("user").isLdapUser());
  try {
    users.setUserLdap("fake user");
    Assert.fail("It shouldn't be possible to call setUserLdap() on non-existing user");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGroupLdap() throws Exception {
  users.createGroup("group");
  users.setGroupLdap("group");
  Assert.assertNotNull(users.getGroup("group"));
  Assert.assertTrue(users.getGroup("group").isLdapGroup());
  try {
    users.setGroupLdap("fake group");
    Assert.fail("It shouldn't be possible to call setGroupLdap() on non-existing group");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByHimselfPasswordNotOk() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  try {
    users.modifyPassword("user","admin","user_new_password");
    Assert.fail("Exception should be thrown here as password is incorrect");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialProviderTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialization() throws Exception {
  CredentialProvider cr;
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  try {
    new CredentialProvider(null,null,true,null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr=new CredentialProvider("blahblah!",msFile,false,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  msFile.delete();
  mksFile.delete();
  createMasterKey();
  cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCredentialStore() throws Exception {
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  createMasterKey();
  CredentialProvider cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  try {
    cr.addAliasToCredentialStore("","xyz");
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  try {
    cr.addAliasToCredentialStore("xyz",null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr.addAliasToCredentialStore("myalias","mypassword");
  Assert.assertEquals("mypassword",new String(cr.getPasswordForAlias("myalias")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialStoreServiceImplTest </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsCredentialPersisted() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  PrincipalKeyCredential credential3=new PrincipalKeyCredential("username3","password3");
  PrincipalKeyCredential credential4=new PrincipalKeyCredential("username4","password4");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test3",credential3,CredentialStoreType.TEMPORARY);
  credentialStoreService.setCredential(CLUSTER_NAME,"test4",credential4,CredentialStoreType.TEMPORARY);
  Assert.assertEquals(CredentialStoreType.PERSISTED,credentialStoreService.getCredentialStoreType(CLUSTER_NAME,"test1"));
  Assert.assertEquals(CredentialStoreType.PERSISTED,credentialStoreService.getCredentialStoreType(CLUSTER_NAME,"test2"));
  Assert.assertEquals(CredentialStoreType.TEMPORARY,credentialStoreService.getCredentialStoreType(CLUSTER_NAME,"test3"));
  Assert.assertEquals(CredentialStoreType.TEMPORARY,credentialStoreService.getCredentialStoreType(CLUSTER_NAME,"test4"));
  try {
    credentialStoreService.getCredentialStoreType(CLUSTER_NAME,"test5");
    Assert.fail("Expected AmbariException to be thrown");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFailNotInitialized() throws Exception {
  Configuration configuration=new Configuration(new Properties());
  CredentialStoreService uninitializedCredentialStoreService=new CredentialStoreServiceImpl(configuration,new SecurePasswordHelper());
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  uninitializedCredentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.TEMPORARY);
  try {
    uninitializedCredentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
    Assert.fail("AmbariException should have been thrown");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosOperationHandlerTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileExceptions() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  try {
    handler.createKeytabFile(null,"some password",0,file);
    Assert.fail("KerberosOperationException not thrown with null principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.createKeytabFile(principal1,null,null,file);
    Assert.fail("KerberosOperationException not thrown with null password");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.createKeytabFile(principal1,"some password",0,null);
    Assert.fail("KerberosOperationException not thrown with null file");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.MITKerberosOperationHandlerTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicePrincipal_Exceptions() throws Exception {
  MITKerberosOperationHandler handler=new MITKerberosOperationHandler();
  handler.open(new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD),DEFAULT_REALM,KERBEROS_ENV_MAP);
  try {
    handler.createPrincipal(DEFAULT_ADMIN_PRINCIPAL,null,false);
    Assert.fail("KerberosOperationException not thrown for null password");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.createPrincipal(DEFAULT_ADMIN_PRINCIPAL,"",false);
    Assert.fail("KerberosOperationException not thrown for empty password");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.createPrincipal(null,DEFAULT_ADMIN_PASSWORD,false);
    Assert.fail("KerberosOperationException not thrown for null principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.createPrincipal("",DEFAULT_ADMIN_PASSWORD,false);
    Assert.fail("KerberosOperationException not thrown for empty principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPrincipalPasswordExceptions() throws Exception {
  MITKerberosOperationHandler handler=injector.getInstance(MITKerberosOperationHandler.class);
  handler.open(new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD),DEFAULT_REALM,KERBEROS_ENV_MAP);
  try {
    handler.setPrincipalPassword(DEFAULT_ADMIN_PRINCIPAL,null);
    Assert.fail("KerberosOperationException not thrown for null password");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.setPrincipalPassword(DEFAULT_ADMIN_PRINCIPAL,"");
    Assert.fail("KerberosOperationException not thrown for empty password");
    handler.createPrincipal("","1234",false);
    Assert.fail("AmbariException not thrown for empty principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.setPrincipalPassword(null,DEFAULT_ADMIN_PASSWORD);
    Assert.fail("KerberosOperationException not thrown for null principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
  try {
    handler.setPrincipalPassword("",DEFAULT_ADMIN_PASSWORD);
    Assert.fail("KerberosOperationException not thrown for empty principal");
  }
 catch (  Throwable t) {
    Assert.assertEquals(KerberosOperationException.class,t.getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerMiscTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCycleDetection() throws Exception {
  MetainfoDAO metaInfoDao=createNiceMock(MetainfoDAO.class);
  StackDAO stackDao=createNiceMock(StackDAO.class);
  ActionMetadata actionMetadata=createNiceMock(ActionMetadata.class);
  OsFamily osFamily=createNiceMock(OsFamily.class);
  StackEntity stackEntity=createNiceMock(StackEntity.class);
  expect(stackDao.find(EasyMock.anyObject(String.class),EasyMock.anyObject(String.class))).andReturn(stackEntity).atLeastOnce();
  replay(actionMetadata,stackDao,metaInfoDao,osFamily);
  try {
    String stacksCycle1=ClassLoader.getSystemClassLoader().getResource("stacks_with_cycle").getPath();
    StackManager stackManager=new StackManager(new File(stacksCycle1),null,osFamily,metaInfoDao,actionMetadata,stackDao);
    fail("Expected exception due to cyclic stack");
  }
 catch (  AmbariException e) {
    assertEquals("Cycle detected while parsing stack definition",e.getMessage());
  }
  try {
    String stacksCycle2=ClassLoader.getSystemClassLoader().getResource("stacks_with_cycle2").getPath();
    StackManager stackManager=new StackManager(new File(stacksCycle2),null,osFamily,metaInfoDao,actionMetadata,stackDao);
    fail("Expected exception due to cyclic stack");
  }
 catch (  AmbariException e) {
    assertEquals("Cycle detected while parsing stack definition",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigMergeHelperTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConflicts() throws Exception {
  Cluster clusterMock=createNiceMock(Cluster.class);
  expect(clustersMock.getCluster(anyString())).andReturn(clusterMock);
  expect(clusterMock.getCurrentStackVersion()).andReturn(currentStackId);
  expect(clusterMock.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("HDFS",createNiceMock(Service.class));
      put("ZK",createNiceMock(Service.class));
    }
  }
);
  Set<PropertyInfo> currentHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> currentZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","different.key","different-value-1"));
    }
  }
;
  Set<PropertyInfo> currentStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","modified.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"HDFS")).andReturn(currentHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"ZK")).andReturn(currentZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(currentStackId.getStackName(),currentStackId.getStackVersion())).andReturn(currentStackProperties);
  Set<PropertyInfo> newHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
      add(createPropertyInfo("new-hdfs-config.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> newZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","equal.key","different-value-2"));
      add(createPropertyInfo("zk-env.xml","new.key","new-value-2"));
    }
  }
;
  Set<PropertyInfo> newStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","another.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"HDFS")).andReturn(newHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"ZK")).andReturn(newZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(newStackId.getStackName(),newStackId.getStackVersion())).andReturn(newStackProperties);
  Map<String,String> desiredHdfsEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredHdfsEnvProperties));
  Map<String,String> desiredZkEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredZkEnvProperties));
  Map<String,String> desiredHadoopEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hadoop-env.xml")).andReturn(createConfigMock(desiredHadoopEnvProperties));
  replay(clusterMock,clustersMock,ambariMetaInfoMock);
  ConfigMergeHelper configMergeHelper=injector.getInstance(ConfigMergeHelper.class);
  Map<String,Map<String,ThreeWayValue>> conflicts=configMergeHelper.getConflicts("clustername",newStackId);
  assertNotNull(conflicts);
  assertEquals(2,conflicts.size());
  for (  String key : conflicts.keySet()) {
    if (key.equals("hdfs-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else     if (key.equals("hadoop-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("modified.value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("another.value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else {
      fail("Unexpected key");
    }
  }
  assertEquals(2,conflicts.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceComponentTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponentHosts() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  try {
    serviceComponentHostFactory.createNew(sc,"h1");
    fail("Expected error for invalid host");
  }
 catch (  Exception e) {
  }
  addHostToCluster("h1",service.getCluster().getClusterName());
  addHostToCluster("h2",service.getCluster().getClusterName());
  addHostToCluster("h3",service.getCluster().getClusterName());
  HostEntity hostEntity1=hostDAO.findByName("h1");
  assertNotNull(hostEntity1);
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc,"h1");
  ServiceComponentHost sch2=serviceComponentHostFactory.createNew(sc,"h2");
  ServiceComponentHost failSch=serviceComponentHostFactory.createNew(sc,"h2");
  Map<String,ServiceComponentHost> compHosts=new HashMap<String,ServiceComponentHost>();
  compHosts.put("h1",sch1);
  compHosts.put("h2",sch2);
  compHosts.put("h3",failSch);
  try {
    sc.addServiceComponentHosts(compHosts);
    fail("Expected error for dups");
  }
 catch (  Exception e) {
  }
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  compHosts.remove("h3");
  sc.addServiceComponentHosts(compHosts);
  Assert.assertEquals(2,sc.getServiceComponentHosts().size());
  sch1.persist();
  sch2.persist();
  ServiceComponentHost schCheck=sc.getServiceComponentHost("h2");
  Assert.assertNotNull(schCheck);
  Assert.assertEquals("h2",schCheck.getHostName());
  ServiceComponentHost sch3=serviceComponentHostFactory.createNew(sc,"h3");
  sc.addServiceComponentHost(sch3);
  sch3.persist();
  Assert.assertNotNull(sc.getServiceComponentHost("h3"));
  sch1.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  sch1.setState(State.STARTING);
  sch1.setStackVersion(new StackId("HDP-1.2.0"));
  sch1.setDesiredState(State.STARTED);
  HostComponentDesiredStateDAO desiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentStateDAO liveStateDAO=injector.getInstance(HostComponentStateDAO.class);
  HostComponentDesiredStateEntityPK dPK=new HostComponentDesiredStateEntityPK();
  dPK.setClusterId(cluster.getClusterId());
  dPK.setComponentName(componentName);
  dPK.setHostId(hostEntity1.getHostId());
  dPK.setServiceName(serviceName);
  HostComponentDesiredStateEntity desiredStateEntity=desiredStateDAO.findByPK(dPK);
  HostComponentStateEntity stateEntity=liveStateDAO.findByIndex(cluster.getClusterId(),serviceName,componentName,hostEntity1.getHostId());
  ServiceComponentHost sch=serviceComponentHostFactory.createExisting(sc,stateEntity,desiredStateEntity);
  Assert.assertNotNull(sch);
  Assert.assertEquals(State.STARTING,sch.getState());
  Assert.assertEquals(State.STARTED,sch.getDesiredState());
  Assert.assertEquals("HDP-1.2.0",sch.getStackVersion().getStackId());
  Assert.assertEquals("HDP-1.2.0",sch.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceTest </h4><pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityState() throws Exception {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ClusterServiceDAO dao=injector.getInstance(ClusterServiceDAO.class);
  ClusterServiceEntity entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(SecurityState.UNSECURED,entity.getServiceDesiredStateEntity().getSecurityState());
  Assert.assertEquals(SecurityState.UNSECURED,service.getSecurityState());
  service.setSecurityState(SecurityState.SECURED_KERBEROS);
  Assert.assertEquals(SecurityState.SECURED_KERBEROS,service.getSecurityState());
  entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(SecurityState.SECURED_KERBEROS,entity.getServiceDesiredStateEntity().getSecurityState());
  for (  SecurityState state : SecurityState.ENDPOINT_STATES) {
    service.setSecurityState(state);
    Assert.assertEquals(state,service.getSecurityState());
  }
  for (  SecurityState state : SecurityState.TRANSITIONAL_STATES) {
    try {
      service.setSecurityState(state);
      Assert.fail(String.format("SecurityState %s is not a valid desired service state",state.toString()));
    }
 catch (    AmbariException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponents() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  Assert.assertTrue(s.getServiceComponents().isEmpty());
  ServiceComponent sc1=serviceComponentFactory.createNew(s,"NAMENODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s,"DATANODE1");
  ServiceComponent sc3=serviceComponentFactory.createNew(s,"DATANODE2");
  Map<String,ServiceComponent> comps=new HashMap<String,ServiceComponent>();
  comps.put(sc1.getName(),sc1);
  comps.put(sc2.getName(),sc2);
  s.addServiceComponents(comps);
  Assert.assertEquals(2,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc1.getName()));
  Assert.assertNotNull(s.getServiceComponent(sc2.getName()));
  try {
    s.getServiceComponent(sc3.getName());
    fail("Expected error when looking for invalid component");
  }
 catch (  Exception e) {
  }
  s.addServiceComponent(sc3);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  ServiceComponent sc4=s.addServiceComponent("HDFS_CLIENT");
  Assert.assertNotNull(s.getServiceComponent(sc4.getName()));
  Assert.assertEquals(State.INIT,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
  Assert.assertTrue(sc4.isClientComponent());
  sc4.persist();
  Assert.assertEquals(4,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc3.getName()));
  Assert.assertEquals(sc3.getName(),s.getServiceComponent(sc3.getName()).getName());
  Assert.assertEquals(s.getName(),s.getServiceComponent(sc3.getName()).getServiceName());
  Assert.assertEquals(cluster.getClusterName(),s.getServiceComponent(sc3.getName()).getClusterName());
  sc4.setDesiredState(State.INSTALLING);
  Assert.assertEquals(State.INSTALLING,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterImplTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHost() throws Exception {
  String clusterName="TEST_DELETE_HOST";
  String hostName1="HOSTNAME1", hostName2="HOSTNAME2";
  String hostToDelete=hostName2;
  clusters.addCluster(clusterName,new StackId("HDP-2.1.1"));
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.addHost(hostName1);
  clusters.addHost(hostName2);
  Host host1=clusters.getHost(hostName1);
  host1.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host1.persist();
  Host host2=clusters.getHost(hostName2);
  host2.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host2.persist();
  clusters.mapHostsToCluster(Sets.newHashSet(hostName1,hostName2),clusterName);
  clusters.deleteHost(hostToDelete);
  assertTrue(clusters.getClustersForHost(hostToDelete).isEmpty());
  assertFalse(clusters.getHostsForCluster(clusterName).containsKey(hostToDelete));
  assertFalse(cluster.getHosts().contains(hostToDelete));
  try {
    clusters.getHost(hostToDelete);
    fail("getHost(hostName) should throw Exception when invoked for deleted host !");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddHost() throws Exception {
  createDefaultCluster();
  clusters.addHost("h3");
  try {
    clusters.addHost("h3");
    fail("Duplicate add should fail");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransitionClusterVersionTransactionFail() throws Exception {
  createDefaultCluster();
  StackId stackId=new StackId("HDP","0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,"0.2","admin",RepositoryVersionState.INSTALLING);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.INSTALLED);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.UPGRADED);
  try {
    ClusterVersionDAOMock.failOnCurrentVersionState=true;
    c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.CURRENT);
    Assert.fail();
  }
 catch (  AmbariException e) {
  }
 finally {
    ClusterVersionDAOMock.failOnCurrentVersionState=false;
  }
  assertNotNull(c1.getCurrentClusterVersion());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostEvent() throws Exception, InvalidStateTransitionException {
  createDefaultCluster();
  HostInfo hostInfo=new HostInfo();
  hostInfo.setHostName("h1");
  hostInfo.setInterfaces("fip_4");
  hostInfo.setArchitecture("os_arch");
  hostInfo.setOS("os_type");
  hostInfo.setMemoryTotal(10);
  hostInfo.setMemorySize(100);
  hostInfo.setProcessorCount(10);
  List<DiskInfo> mounts=new ArrayList<DiskInfo>();
  mounts.add(new DiskInfo("/dev/sda","/mnt/disk1","5000000","4000000","10%","size","fstype"));
  hostInfo.setMounts(mounts);
  AgentEnv agentEnv=new AgentEnv();
  Directory dir1=new Directory();
  dir1.setName("/etc/hadoop");
  dir1.setType("not_exist");
  Directory dir2=new Directory();
  dir2.setName("/var/log/hadoop");
  dir2.setType("not_exist");
  agentEnv.setStackFoldersAndFiles(new Directory[]{dir1,dir2});
  AgentVersion agentVersion=new AgentVersion("0.0.x");
  long currentTime=1001;
  clusters.getHost("h1").handleEvent(new HostRegistrationRequestEvent("h1",agentVersion,currentTime,hostInfo,agentEnv));
  Assert.assertEquals(HostState.WAITING_FOR_HOST_STATUS_UPDATES,clusters.getHost("h1").getState());
  clusters.getHost("h1").setState(HostState.HEARTBEAT_LOST);
  try {
    clusters.getHost("h1").handleEvent(new HostHealthyHeartbeatEvent("h1",currentTime,null,null));
    fail("Exception should be thrown on invalid event");
  }
 catch (  InvalidStateTransitionException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicClusterSetup() throws Exception {
  StackId stackVersion=new StackId("HDP-1.2.0");
  createDefaultCluster();
  String clusterName="c2";
  try {
    clusters.getCluster(clusterName);
    fail("Exception expected for invalid cluster");
  }
 catch (  Exception e) {
  }
  clusters.addCluster(clusterName,stackVersion);
  Cluster c2=clusters.getCluster(clusterName);
  Assert.assertNotNull(c2);
  Assert.assertEquals(clusterName,c2.getClusterName());
  c2.setClusterName("foo2");
  Assert.assertEquals("foo2",c2.getClusterName());
  Assert.assertNotNull(c2.getDesiredStackVersion());
  Assert.assertEquals("HDP-1.2.0",c2.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDesiredConfigs() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  Config config3=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addConfig(config3);
  try {
    c1.addDesiredConfig(null,Collections.singleton(config1));
    fail("Cannot set a null user with config");
  }
 catch (  Exception e) {
  }
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  c1.addDesiredConfig("_test3",Collections.singleton(config3));
  Map<String,DesiredConfig> desiredConfigs=c1.getDesiredConfigs();
  Assert.assertFalse("Expect desired config not contain 'mapred-site'",desiredConfigs.containsKey("mapred-site"));
  Assert.assertTrue("Expect desired config contain " + config1.getType(),desiredConfigs.containsKey("global"));
  Assert.assertTrue("Expect desired config contain " + config3.getType(),desiredConfigs.containsKey("core-site"));
  Assert.assertEquals("Expect desired config for global should be " + config1.getTag(),config1.getTag(),desiredConfigs.get(config1.getType()).getTag());
  Assert.assertEquals("_test1",desiredConfigs.get(config1.getType()).getUser());
  Assert.assertEquals("_test3",desiredConfigs.get(config3.getType()).getUser());
  DesiredConfig dc=desiredConfigs.get(config1.getType());
  Assert.assertTrue("Expect no host-level overrides",(null == dc.getHostOverrides() || dc.getHostOverrides().size() == 0));
  c1.addDesiredConfig("_test2",Collections.singleton(config2));
  Assert.assertEquals("_test2",c1.getDesiredConfigs().get(config2.getType()).getUser());
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  Host host=clusters.getHost("h1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test2",config2);
  desiredConfigs=c1.getDesiredConfigs();
  dc=desiredConfigs.get(config1.getType());
  Assert.assertNotNull("Expect host-level overrides",dc.getHostOverrides());
  Assert.assertEquals("Expect one host-level override",1,dc.getHostOverrides().size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServices() throws Exception {
  createDefaultCluster();
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  Service s3=serviceFactory.createNew(c1,"MAPREDUCE");
  try {
    c1.addService(s3);
    fail("Expected error on adding dup service");
  }
 catch (  Exception e) {
  }
  Service s=c1.getService("HDFS");
  Assert.assertNotNull(s);
  Assert.assertEquals("HDFS",s.getName());
  Assert.assertEquals(c1.getClusterId(),s.getClusterId());
  try {
    c1.getService("HBASE");
    fail("Expected error for unknown service");
  }
 catch (  Exception e) {
  }
  Map<String,Service> services=c1.getServices();
  Assert.assertEquals(2,services.size());
  Assert.assertTrue(services.containsKey("HDFS"));
  Assert.assertTrue(services.containsKey("MAPREDUCE"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClustersTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterHostMapping() throws AmbariException {
  String c1="c1";
  String c2="c2";
  String h1="h1";
  String h2="h2";
  String h3="h3";
  String h4="h4";
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid cluster/host");
  }
 catch (  Exception e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(c1,stackId);
  clusters.addCluster(c2,stackId);
  Cluster cluster1=clusters.getCluster(c1);
  Cluster cluster2=clusters.getCluster(c2);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  cluster1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster1.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  cluster2.setDesiredStackVersion(stackId);
  cluster2.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster2.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid host");
  }
 catch (  Exception e) {
  }
  clusters.addHost(h1);
  clusters.addHost(h2);
  clusters.addHost(h3);
  Assert.assertNotNull(clusters.getHost(h1));
  setOsFamily(clusters.getHost(h1),"redhat","6.4");
  setOsFamily(clusters.getHost(h2),"redhat","5.9");
  setOsFamily(clusters.getHost(h3),"redhat","6.4");
  clusters.getHost(h1).persist();
  clusters.getHost(h2).persist();
  clusters.getHost(h3).persist();
  try {
    clusters.getClustersForHost(h4);
    fail("Expected exception for invalid host");
  }
 catch (  HostNotFoundException e) {
  }
  Set<Cluster> c=clusters.getClustersForHost(h3);
  Assert.assertEquals(0,c.size());
  clusters.mapHostToCluster(h1,c1);
  clusters.mapHostToCluster(h2,c1);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for duplicate");
  }
 catch (  DuplicateResourceException e) {
  }
  Cluster c3=(Cluster)clusters.getClustersForHost(h1).toArray()[0];
  Cluster c4=(Cluster)clusters.getClustersForHost(h2).toArray()[0];
  Assert.assertEquals(c3,c4);
  Set<String> hostnames=new HashSet<String>();
  hostnames.add(h1);
  hostnames.add(h2);
  clusters.mapHostsToCluster(hostnames,c2);
  c=clusters.getClustersForHost(h1);
  Assert.assertEquals(2,c.size());
  c=clusters.getClustersForHost(h2);
  Assert.assertEquals(2,c.size());
  Map<String,Host> hostsForC1=clusters.getHostsForCluster(c1);
  Assert.assertEquals(2,hostsForC1.size());
  Assert.assertTrue(hostsForC1.containsKey(h1));
  Assert.assertTrue(hostsForC1.containsKey(h2));
  Assert.assertNotNull(hostsForC1.get(h1));
  Assert.assertNotNull(hostsForC1.get(h2));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetHost() throws AmbariException {
  String h1="h1";
  String h2="h2";
  String h3="h3";
  clusters.addHost(h1);
  try {
    clusters.addHost(h1);
    fail("Expected exception on duplicate host entry");
  }
 catch (  Exception e) {
  }
  clusters.addHost(h2);
  clusters.addHost(h3);
  List<Host> hosts=clusters.getHosts();
  Assert.assertEquals(3,hosts.size());
  Assert.assertNotNull(clusters.getHost(h1));
  Assert.assertNotNull(clusters.getHost(h2));
  Assert.assertNotNull(clusters.getHost(h3));
  Host h=clusters.getHost(h2);
  Assert.assertNotNull(h);
  try {
    clusters.getHost("foo");
    fail("Expected error for unknown host");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetCluster() throws AmbariException {
  StackId stackId=new StackId("HDP-2.1.1");
  String c1="foo";
  String c2="foo";
  clusters.addCluster(c1,stackId);
  try {
    clusters.addCluster(c1,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.addCluster(c2,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  c2="foo2";
  clusters.addCluster(c2,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  Assert.assertEquals(c1,clusters.getCluster(c1).getClusterName());
  Assert.assertEquals(c2,clusters.getCluster(c2).getClusterName());
  Map<String,Cluster> verifyClusters=clusters.getClusters();
  Assert.assertTrue(verifyClusters.containsKey(c1));
  Assert.assertTrue(verifyClusters.containsKey(c2));
  Assert.assertNotNull(verifyClusters.get(c1));
  Assert.assertNotNull(verifyClusters.get(c2));
  Cluster c=clusters.getCluster(c1);
  c.setClusterName("foobar");
  long cId=c.getClusterId();
  Cluster changed=clusters.getCluster("foobar");
  Assert.assertNotNull(changed);
  Assert.assertEquals(cId,changed.getClusterId());
  Assert.assertEquals("foobar",clusters.getClusterById(cId).getClusterName());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetInvalidCluster() throws AmbariException {
  try {
    clusters.getCluster("foo");
    fail("Exception should be thrown on invalid get");
  }
 catch (  ClusterNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetCurrentStackVersion() throws AmbariException {
  String c1="foo3";
  try {
    clusters.setCurrentStackVersion("",null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.setCurrentStackVersion(c1,null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  try {
    clusters.setCurrentStackVersion(c1,stackId);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Cluster not found"));
  }
  clusters.addCluster(c1,stackId);
  clusters.setCurrentStackVersion(c1,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  ClusterStateEntity entity=injector.getInstance(ClusterStateDAO.class).findByPK(clusters.getCluster(c1).getClusterId());
  Assert.assertNotNull(entity);
  Assert.assertTrue(entity.getCurrentStack().getStackName().equals(stackId.getStackName()) && entity.getCurrentStack().getStackVersion().equals(stackId.getStackVersion()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackName().equals(stackId.getStackName()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackVersion().equals(stackId.getStackVersion()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.host.HostTest </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostHeartbeatFlow() throws Exception {
  clusters.addHost("foo");
  Host host=clusters.getHost("foo");
  registerHost(host);
  ensureHostUpdatesReceived(host);
  long counter=0;
  sendHealthyHeartbeat(host,++counter);
  verifyHostState(host,HostState.HEALTHY);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  sendHealthyHeartbeat(host,++counter);
  verifyHostState(host,HostState.HEALTHY);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.HEALTHY,host.getHealthStatus().getHealthStatus());
  sendUnhealthyHeartbeat(host,++counter);
  verifyHostState(host,HostState.UNHEALTHY);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.UNHEALTHY,host.getHealthStatus().getHealthStatus());
  sendUnhealthyHeartbeat(host,++counter);
  verifyHostState(host,HostState.UNHEALTHY);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.UNHEALTHY,host.getHealthStatus().getHealthStatus());
  sendHealthyHeartbeat(host,++counter);
  verifyHostState(host,HostState.HEALTHY);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.HEALTHY,host.getHealthStatus().getHealthStatus());
  timeoutHost(host);
  verifyHostState(host,HostState.HEARTBEAT_LOST);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.UNKNOWN,host.getHealthStatus().getHealthStatus());
  timeoutHost(host);
  verifyHostState(host,HostState.HEARTBEAT_LOST);
  Assert.assertEquals(counter,host.getLastHeartbeatTime());
  Assert.assertEquals(HealthStatus.UNKNOWN,host.getHealthStatus().getHealthStatus());
  try {
    sendUnhealthyHeartbeat(host,++counter);
    fail("Invalid event should have triggered an exception");
  }
 catch (  Exception e) {
  }
  verifyHostState(host,HostState.HEARTBEAT_LOST);
  try {
    sendHealthyHeartbeat(host,++counter);
    fail("Invalid event should have triggered an exception");
  }
 catch (  Exception e) {
  }
  verifyHostState(host,HostState.HEARTBEAT_LOST);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostDesiredConfig() throws Exception {
  AmbariMetaInfo metaInfo=injector.getInstance(AmbariMetaInfo.class);
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster("c1",stackId);
  Cluster c1=clusters.getCluster("c1");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Assert.assertEquals("c1",c1.getClusterName());
  Assert.assertEquals(1,c1.getClusterId());
  clusters.addHost("h1");
  Host host=clusters.getHost("h1");
  host.setIPv4("ipv4");
  host.setIPv6("ipv6");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  c1.setDesiredStackVersion(stackId);
  clusters.mapHostToCluster("h1","c1");
  ConfigFactory configFactory=injector.getInstance(ConfigFactory.class);
  Config config=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  try {
    host.addDesiredConfig(c1.getClusterId(),true,null,config);
    Assert.fail("Expect failure when user is not specified.");
  }
 catch (  Exception e) {
  }
  config.setTag("v1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test",config);
  Map<String,DesiredConfig> map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertTrue("Expect desired config to contain global",map.containsKey("global"));
  Assert.assertEquals("Expect global user to be '_test'","_test",map.get("global").getUser());
  config=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("c","d");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("v2");
  host.addDesiredConfig(c1.getClusterId(),true,"_test1",config);
  map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertTrue("Expect desired config to contain global",map.containsKey("global"));
  Assert.assertEquals("Expect version to be 'v2'","v2",map.get("global").getTag());
  Assert.assertEquals("Expect user to be '_test1'","_test1",map.get("global").getUser());
  host.addDesiredConfig(c1.getClusterId(),false,"_test2",config);
  map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertEquals("Expect no mapping configs",0,map.size());
}

</code></pre>

<br>
<pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHostRegistrationFlow() throws Exception {
  clusters.addHost("foo");
  Host host=clusters.getHost("foo");
  registerHost(host);
  verifyHostState(host,HostState.WAITING_FOR_HOST_STATUS_UPDATES);
  boolean exceptionThrown=false;
  try {
    registerHost(host);
  }
 catch (  Exception e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Expected invalid transition exception to be thrown");
  }
  ensureHostUpdatesReceived(host);
  verifyHostState(host,HostState.HEALTHY);
  exceptionThrown=false;
  try {
    ensureHostUpdatesReceived(host);
  }
 catch (  Exception e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Expected invalid transition exception to be thrown");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosConfigurationDescriptorTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJSONDeserializeMultiple(){
  List<Map<String,Object>> jsonData=new Gson().fromJson(JSON_MULTIPLE_VALUE,new TypeToken<List<Map<String,Object>>>(){
  }
.getType());
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Object> item : jsonData) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Assert.assertEquals(2,configurations.size());
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
      Assert.assertEquals("value3",properties.get("property3"));
      Assert.assertEquals("value1",configuration.getProperty("property1"));
      Assert.assertEquals("value2",configuration.getProperty("property2"));
      Assert.assertEquals("value3",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDeserializeMultiple(){
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Map<String,Object>> item : MAP_MULTIPLE_VALUES) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("black",properties.get("property1"));
      Assert.assertEquals("white",properties.get("property2"));
      Assert.assertEquals("black",configuration.getProperty("property1"));
      Assert.assertEquals("white",configuration.getProperty("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("red",properties.get("property1"));
      Assert.assertEquals("yellow",properties.get("property2"));
      Assert.assertEquals("green",properties.get("property3"));
      Assert.assertEquals("red",configuration.getProperty("property1"));
      Assert.assertEquals("yellow",configuration.getProperty("property2"));
      Assert.assertEquals("green",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosDescriptorTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalid(){
  try {
    KERBEROS_SERVICE_DESCRIPTOR_FACTORY.createInstances(JSON_VALUE + "erroneous text");
    Assert.fail("Should have thrown AmbariException.");
  }
 catch (  AmbariException e) {
  }
catch (  Throwable t) {
    Assert.fail("Should have thrown AmbariException.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosServiceDescriptorTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalid(){
  try {
    KERBEROS_SERVICE_DESCRIPTOR_FACTORY.createInstances(JSON_VALUE_SERVICES + "erroneous text");
    Assert.fail("Should have thrown AmbariException.");
  }
 catch (  AmbariException e) {
  }
catch (  Throwable t) {
    Assert.fail("Should have thrown AmbariException.");
  }
  try {
    KERBEROS_SERVICE_DESCRIPTOR_FACTORY.createInstances(JSON_VALUE);
    Assert.fail("Should have thrown AmbariException.");
  }
 catch (  AmbariException e) {
  }
catch (  Throwable t) {
    Assert.fail("Should have thrown AmbariException.");
  }
  URL url=getClass().getClassLoader().getResource("service_level_kerberos_invalid.json");
  File file=(url == null) ? null : new File(url.getFile());
  try {
    KERBEROS_SERVICE_DESCRIPTOR_FACTORY.createInstances(file);
    Assert.fail("Should have thrown AmbariException.");
  }
 catch (  AmbariException e) {
  }
catch (  Throwable t) {
    Assert.fail("Should have thrown AmbariException.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.VariableReplacementHelperTest </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplaceVariables() throws AmbariException {
  Map<String,Map<String,String>> configurations=new HashMap<String,Map<String,String>>(){
{
      put("",new HashMap<String,String>(){
{
          put("global_variable","Hello World");
          put("variable-name","dash");
          put("variable_name","underscore");
          put("variable.name","dot");
        }
      }
);
      put("config_type",new HashMap<String,String>(){
{
          put("variable-name","config_type_dash");
          put("variable_name","config_type_underscore");
          put("variable.name","config_type_dot");
        }
      }
);
      put("config.type",new HashMap<String,String>(){
{
          put("variable-name","config.type_dash");
          put("variable_name","config.type_underscore");
          put("variable.name","config.type_dot");
        }
      }
);
      put("config-type",new HashMap<String,String>(){
{
          put("variable.name","Replacement1");
          put("variable.name1","${config-type2/variable.name}");
          put("variable.name2","");
        }
      }
);
      put("config-type2",new HashMap<String,String>(){
{
          put("variable.name","Replacement2");
          put("self_reference","${config-type2/self_reference}");
          put("${config-type/variable.name}_reference","Replacement in the key");
        }
      }
);
    }
  }
;
  Assert.assertEquals("concrete",helper.replaceVariables("concrete",configurations));
  Assert.assertEquals("Hello World",helper.replaceVariables("${global_variable}",configurations));
  Assert.assertEquals("Replacement1",helper.replaceVariables("${config-type/variable.name}",configurations));
  Assert.assertEquals("Replacement1|Replacement2",helper.replaceVariables("${config-type/variable.name}|${config-type2/variable.name}",configurations));
  Assert.assertEquals("Replacement1|Replacement2|${config-type3/variable.name}",helper.replaceVariables("${config-type/variable.name}|${config-type2/variable.name}|${config-type3/variable.name}",configurations));
  Assert.assertEquals("Replacement2|Replacement2",helper.replaceVariables("${config-type/variable.name1}|${config-type2/variable.name}",configurations));
  Assert.assertEquals("Replacement1_reference",helper.replaceVariables("${config-type/variable.name}_reference",configurations));
  Assert.assertEquals("dash",helper.replaceVariables("${variable-name}",configurations));
  Assert.assertEquals("underscore",helper.replaceVariables("${variable_name}",configurations));
  Assert.assertEquals("config_type_dot",helper.replaceVariables("${config_type/variable.name}",configurations));
  Assert.assertEquals("config_type_dash",helper.replaceVariables("${config_type/variable-name}",configurations));
  Assert.assertEquals("config_type_underscore",helper.replaceVariables("${config_type/variable_name}",configurations));
  Assert.assertEquals("config.type_dot",helper.replaceVariables("${config.type/variable.name}",configurations));
  Assert.assertEquals("config.type_dash",helper.replaceVariables("${config.type/variable-name}",configurations));
  Assert.assertEquals("config.type_underscore",helper.replaceVariables("${config.type/variable_name}",configurations));
  Assert.assertEquals("dot",helper.replaceVariables("${variable.name}",configurations));
  Assert.assertEquals("",helper.replaceVariables("${config-type/variable.name2}",configurations));
  try {
    Assert.assertEquals("${config-type2/self_reference}",helper.replaceVariables("${config-type2/self_reference}",configurations));
    Assert.fail(String.format("%s expected to be thrown",AmbariException.class.getName()));
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.BlueprintImplTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateConfigurations__basic_negative() throws Exception {
  Stack stack=createNiceMock(Stack.class);
  HostGroup group1=createNiceMock(HostGroup.class);
  HostGroup group2=createNiceMock(HostGroup.class);
  Collection<HostGroup> hostGroups=new HashSet<HostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("c1");
  group1Components.add("c2");
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("c1");
  group2Components.add("c3");
  Collection<Stack.ConfigProperty> requiredHDFSProperties=new HashSet<Stack.ConfigProperty>();
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","foo",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","bar",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","some_password",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("category1","prop1",null));
  Collection<Stack.ConfigProperty> requiredService2Properties=new HashSet<Stack.ConfigProperty>();
  requiredService2Properties.add(new Stack.ConfigProperty("category2","prop2",null));
  expect(stack.getServiceForComponent("c1")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c2")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c3")).andReturn("SERVICE2").atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("HDFS")).andReturn(requiredHDFSProperties).atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("SERVICE2")).andReturn(requiredService2Properties).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","foo")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","bar")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","some_password")).andReturn(true).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","category1","prop1")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("SERVICE2","category2","prop2")).andReturn(false).atLeastOnce();
  expect(group1.getConfiguration()).andReturn(EMPTY_CONFIGURATION).atLeastOnce();
  expect(group1.getName()).andReturn("group1").anyTimes();
  expect(group1.getComponentNames()).andReturn(group1Components).atLeastOnce();
  expect(group2.getConfiguration()).andReturn(EMPTY_CONFIGURATION).atLeastOnce();
  expect(group2.getName()).andReturn("group2").anyTimes();
  expect(group2.getComponentNames()).andReturn(group2Components).atLeastOnce();
  replay(stack,group1,group2);
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsProps=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsProps);
  hdfsProps.put("foo","val");
  hdfsProps.put("bar","val");
  Map<String,String> category1Props=new HashMap<String,String>();
  properties.put("category1",category1Props);
  category1Props.put("prop1","val");
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  Configuration configuration=new Configuration(properties,attributes,EMPTY_CONFIGURATION);
  Blueprint blueprint=new BlueprintImpl("test",hostGroups,stack,configuration,null);
  try {
    blueprint.validateRequiredProperties();
    fail("Expected exception to be thrown for missing config property");
  }
 catch (  InvalidTopologyException e) {
    System.out.println("****" + e.getMessage() + "***");
  }
  verify(stack,group1,group2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateConfigurations__secretReference(){
  Stack stack=createNiceMock(Stack.class);
  HostGroup group1=createNiceMock(HostGroup.class);
  HostGroup group2=createNiceMock(HostGroup.class);
  Collection<HostGroup> hostGroups=new HashSet<HostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Set<String> group1Components=new HashSet<String>();
  group1Components.add("c1");
  group1Components.add("c2");
  Set<String> group2Components=new HashSet<String>();
  group2Components.add("c1");
  group2Components.add("c3");
  Map<String,Map<String,String>> group2Props=new HashMap<String,Map<String,String>>();
  Map<String,String> group2Category2Props=new HashMap<String,String>();
  group2Props.put("category2",group2Category2Props);
  group2Category2Props.put("prop2","val");
  Collection<Stack.ConfigProperty> requiredHDFSProperties=new HashSet<Stack.ConfigProperty>();
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","foo",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","bar",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","some_password",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("category1","prop1",null));
  Collection<Stack.ConfigProperty> requiredService2Properties=new HashSet<Stack.ConfigProperty>();
  requiredService2Properties.add(new Stack.ConfigProperty("category2","prop2",null));
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsProps=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsProps);
  hdfsProps.put("foo","val");
  hdfsProps.put("bar","val");
  hdfsProps.put("secret","SECRET:hdfs-site:1:test");
  Map<String,String> category1Props=new HashMap<String,String>();
  properties.put("category1",category1Props);
  category1Props.put("prop1","val");
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  Configuration configuration=new Configuration(properties,attributes,EMPTY_CONFIGURATION);
  replay(stack,group1,group2);
  Blueprint blueprint=new BlueprintImpl("test",hostGroups,stack,configuration,null);
  try {
    blueprint.validateRequiredProperties();
    fail("Expected exception to be thrown for using secret reference");
  }
 catch (  InvalidTopologyException e) {
    System.out.println("****" + e.getMessage() + "***");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog150Test </h4><pre class="type-13 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMissingLog4jConfigs() throws Exception {
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  ClusterServiceEntity clusterServiceEntityMR=upgradeCatalogHelper.addService(injector,clusterEntity,"HDFS",desiredStackEntity);
  Long clusterId=clusterEntity.getClusterId();
  ClusterConfigEntity configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNull(configEntity);
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      Assert.fail();
    }
  }
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  upgradeCatalog150.addMissingLog4jConfigs();
  configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNotNull(configEntity);
  clusterEntity=clusterDAO.findById(1L);
  boolean failFlag=true;
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      failFlag=false;
    }
  }
  Assert.assertFalse(failFlag);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.SetUtilsTest </h4><pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  try {
    SetUtils.split(null,0);
    Assert.fail("Expected IllegalArgumentException.");
  }
 catch (  IllegalArgumentException e) {
  }
  int size=10;
  List<Set<Integer>> subsets=SetUtils.split(null,size);
  Assert.assertEquals(0,subsets.size());
  subsets=SetUtils.split(Collections.EMPTY_SET,size);
  Assert.assertEquals(0,subsets.size());
  subsets=SetUtils.split(Collections.singleton(0),size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(1,subsets.get(0).size());
  Set<Integer> set=new LinkedHashSet<Integer>(5);
  for (int i=0; i < 5; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(5,subsets.get(0).size());
  set=new LinkedHashSet<Integer>(10);
  for (int i=0; i < 10; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  set=new LinkedHashSet<Integer>(11);
  for (int i=0; i < 11; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(2,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(1,subsets.get(1).size());
  set=new LinkedHashSet<Integer>(20);
  for (int i=0; i < 20; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(2,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(10,subsets.get(1).size());
  set=new LinkedHashSet<Integer>(27);
  for (int i=0; i < 27; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(3,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(10,subsets.get(1).size());
  Assert.assertEquals(7,subsets.get(2).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewRegistryTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstallViewInstance_unknownView() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  viewInstanceEntity.setViewName("BOGUS_VIEW");
  replay(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected an IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertTrue(viewInstanceDefinitions.isEmpty());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUpdateViewInstance_invalid() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewConfig invalidConfig=ViewConfigTest.getConfig(XML_INVALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,invalidConfig.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  try {
    registry.updateViewInstance(updateInstance);
    Assert.fail("expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_UPDATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  try {
    registry.updateViewInstance(updateInstance);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,validator,result);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstallViewInstance_invalid() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_INVALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  replay(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected an IllegalStateException");
  }
 catch (  ValidationException e) {
  }
  verify(viewDAO,viewInstanceDAO,securityHelper,resourceTypeDAO);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.persistence.DataStoreImplTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testStore_create_largeEntity() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  EntityTransaction transaction=createMock(EntityTransaction.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  expect(entityManager.getTransaction()).andReturn(transaction).anyTimes();
  entityManager.close();
  transaction.begin();
  expect(transaction.isActive()).andReturn(true);
  transaction.rollback();
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  try {
    dataStore.store(new TestLargeEntity(99));
    Assert.fail("Expected PersistenceException.");
  }
 catch (  PersistenceException e) {
  }
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testStore_create_longStringValue() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  EntityTransaction transaction=createMock(EntityTransaction.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  expect(entityManager.getTransaction()).andReturn(transaction).anyTimes();
  Capture<Class> entityClassCapture2=new Capture<Class>();
  expect(entityManager.find(capture(entityClassCapture2),eq(99))).andReturn(null);
  entityManager.close();
  transaction.begin();
  expect(transaction.isActive()).andReturn(true);
  transaction.rollback();
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < 5000; ++i) {
    sb.append("A");
  }
  String longString=sb.toString();
  try {
    dataStore.store(new TestEntity(99,longString,new TestSubEntity("bar")));
    Assert.fail("Expected PersistenceException.");
  }
 catch (  PersistenceException e) {
  }
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testStore_update_longStringValue() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  EntityTransaction transaction=createMock(EntityTransaction.class);
  DynamicEntity dynamicEntity=createMock(DynamicEntity.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  expect(entityManager.getTransaction()).andReturn(transaction).anyTimes();
  Capture<Class> entityClassCapture2=new Capture<Class>();
  expect(entityManager.find(capture(entityClassCapture2),eq(99))).andReturn(dynamicEntity);
  entityManager.close();
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < 5000; ++i) {
    sb.append("A");
  }
  String longString=sb.toString();
  expect(dynamicEntity.set("DS_id",99)).andReturn(dynamicEntity).times(0,1);
  transaction.begin();
  expect(transaction.isActive()).andReturn(true).anyTimes();
  transaction.rollback();
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager,dynamicEntity);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  try {
    dataStore.store(new TestEntity(99,longString,new TestSubEntity("bar")));
    Assert.fail();
  }
 catch (  PersistenceException e) {
  }
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,transaction,schemaManager,dynamicEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.sink.timeline.cache.HandleConnectExceptionTest </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void handleTest(){
  try {
    sink.emitMetrics(new TimelineMetrics());
    Assert.fail();
  }
 catch (  UnableToConnectException e) {
    Assert.assertEquals(COLLECTOR_URL,e.getConnectUrl());
  }
catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryServer </h4><pre class="type-10 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test(timeout=60000) public void testLaunch() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("ambari",new String[]{"ambari"});
  mockStatic(UserGroupInformation.class);
  expect(UserGroupInformation.getCurrentUser()).andReturn(ugi).anyTimes();
  expect(UserGroupInformation.isSecurityEnabled()).andReturn(false).anyTimes();
  ExitUtil.disableSystemExit();
  try {
    historyServer=ApplicationHistoryServer.launchAppHistoryServer(new String[0]);
  }
 catch (  ExitUtil.ExitException e) {
    assertEquals(0,e.status);
    ExitUtil.resetFirstExitException();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestFileSystemApplicationHistoryStore </h4><pre class="type-10 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteAfterApplicationFinish() throws IOException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestMemoryApplicationHistoryStore </h4><pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationAttemptHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numAppAttempts=5;
  writeApplicationStartData(appId);
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    writeApplicationAttemptStartData(appAttemptId);
    writeApplicationAttemptFinishData(appAttemptId);
  }
  Assert.assertEquals(numAppAttempts,store.getApplicationAttempts(appId).size());
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    ApplicationAttemptHistoryData data=store.getApplicationAttempt(appAttemptId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appAttemptId.toString(),data.getHost());
    Assert.assertEquals(appAttemptId.toString(),data.getDiagnosticsInfo());
  }
  writeApplicationFinishData(appId);
  appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numApps=5;
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    writeApplicationStartData(appId);
    writeApplicationFinishData(appId);
  }
  Assert.assertEquals(numApps,store.getAllApplications().size());
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    ApplicationHistoryData data=store.getApplication(appId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appId.toString(),data.getApplicationName());
    Assert.assertEquals(appId.toString(),data.getDiagnosticsInfo());
  }
  appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationStartData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteContainerHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  writeApplicationAttemptStartData(appAttemptId);
  int numContainers=5;
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  Assert.assertEquals(numContainers,store.getContainers(appAttemptId).size());
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    ContainerHistoryData data=store.getContainer(containerId);
    Assert.assertNotNull(data);
    Assert.assertEquals(Priority.newInstance(containerId.getId()),data.getPriority());
    Assert.assertEquals(containerId.toString(),data.getDiagnosticsInfo());
  }
  ContainerHistoryData masterContainer=store.getAMContainer(appAttemptId);
  Assert.assertNotNull(masterContainer);
  Assert.assertEquals(ContainerId.newInstance(appAttemptId,1),masterContainer.getContainerId());
  writeApplicationAttemptFinishData(appAttemptId);
  containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.PhoenixHBaseAccessorTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetMetricRecordsPhoenixIOExceptionDoNotRetryException() throws SQLException, IOException {
  Configuration hbaseConf=new Configuration();
  hbaseConf.setStrings(ZOOKEEPER_QUORUM,"quorum");
  Configuration metricsConf=new Configuration();
  ConnectionProvider connectionProvider=new ConnectionProvider(){
    @Override public Connection getConnection() throws SQLException {
      return null;
    }
  }
;
  PhoenixHBaseAccessor accessor=new PhoenixHBaseAccessor(hbaseConf,metricsConf,connectionProvider);
  List<String> metricNames=new LinkedList<>();
  List<String> hostnames=new LinkedList<>();
  Map<String,List<Function>> metricFunctions=new HashMap<>();
  PowerMock.mockStatic(PhoenixTransactSQL.class);
  PreparedStatement preparedStatementMock=EasyMock.createNiceMock(PreparedStatement.class);
  Condition condition=new DefaultCondition(metricNames,hostnames,"appid","instanceid",null,null,Precision.SECONDS,10,true);
  EasyMock.expect(PhoenixTransactSQL.prepareGetLatestMetricSqlStmt(null,condition)).andReturn(preparedStatementMock).once();
  PhoenixTransactSQL.setSortMergeJoinEnabled(true);
  EasyMock.expectLastCall();
  ResultSet rsMock=EasyMock.createNiceMock(ResultSet.class);
  PhoenixIOException pioe1=EasyMock.createNiceMock(PhoenixIOException.class);
  PhoenixIOException pioe2=EasyMock.createNiceMock(PhoenixIOException.class);
  DoNotRetryIOException dnrioe=EasyMock.createNiceMock(DoNotRetryIOException.class);
  EasyMock.expect(preparedStatementMock.executeQuery()).andThrow(pioe1);
  EasyMock.expect(pioe1.getCause()).andReturn(pioe2).atLeastOnce();
  EasyMock.expect(pioe2.getCause()).andReturn(dnrioe).atLeastOnce();
  StackTraceElement stackTrace[]=new StackTraceElement[]{new StackTraceElement("HashJoinRegionScanner","method","file",1)};
  EasyMock.expect(dnrioe.getStackTrace()).andReturn(stackTrace).atLeastOnce();
  PowerMock.replayAll();
  EasyMock.replay(preparedStatementMock,rsMock,pioe1,pioe2,dnrioe);
  try {
    TimelineMetrics tml=accessor.getMetricRecords(condition,metricFunctions);
    fail();
  }
 catch (  Exception e) {
  }
  PowerMock.verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITClusterAggregator </h4><pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterAggregateMetricNormalization() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  TimelineMetric metric1=new TimelineMetric();
  metric1.setMetricName("yarn.ClusterMetrics.NumActiveNMs");
  metric1.setAppId("resourcemanager");
  metric1.setHostName("h1");
  metric1.setStartTime(1431372311811l);
  metric1.setMetricValues(new TreeMap<Long,Double>(){
{
      put(1431372311811l,1.0);
      put(1431372321811l,1.0);
      put(1431372331811l,1.0);
      put(1431372341811l,1.0);
      put(1431372351811l,1.0);
      put(1431372361811l,1.0);
      put(1431372371810l,1.0);
    }
  }
);
  TimelineMetric metric2=new TimelineMetric();
  metric2.setMetricName("yarn.ClusterMetrics.NumActiveNMs");
  metric2.setAppId("resourcemanager");
  metric2.setHostName("h1");
  metric2.setStartTime(1431372381810l);
  metric2.setMetricValues(new TreeMap<Long,Double>(){
{
      put(1431372381810l,1.0);
      put(1431372391811l,1.0);
      put(1431372401811l,1.0);
      put(1431372411811l,1.0);
      put(1431372421811l,1.0);
      put(1431372431811l,1.0);
      put(1431372441810l,1.0);
    }
  }
);
  TimelineMetrics metrics=new TimelineMetrics();
  metrics.setMetrics(Collections.singletonList(metric1));
  insertMetricRecords(conn,metrics,1431372371810l);
  metrics.setMetrics(Collections.singletonList(metric2));
  insertMetricRecords(conn,metrics,1431372441810l);
  long startTime=1431372055000l;
  long endTime=1431372655000l;
  agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("yarn.ClusterMetrics.NumActiveNMs".equals(currentMetric.getMetricName())) {
      assertEquals(1,currentHostAggregate.getNumberOfHosts());
      assertEquals(1.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(1.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  Assert.assertEquals(5,recordCount);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateClusterIgnoringInstance() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000 * 2;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local1","i1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local2","i1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local1","i2","disk_free",3));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local2","i2","disk_free",4));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local1","i1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local2","i1","disk_free",3));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local1","i2","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local2","i2","disk_free",4));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime - 1000,endTime + 1000);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      System.out.println("OUTPUT: " + currentMetric + " - "+ currentHostAggregate);
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(5.0,Math.floor(currentHostAggregate.getSum()));
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  Assert.assertEquals(5,recordCount);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateDifferentMetricsOnClusterProperly() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_used",1));
  ctime+=2 * minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_used",1));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(3.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else     if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(1,currentHostAggregate.getNumberOfHosts());
      assertEquals(1.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(1.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateClusterProperly() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=2 * minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(3.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITMetricAggregator </h4><pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateMinuteProperly() throws Exception {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareTimelineMetrics(startTime,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  long endTime=startTime + 1000 * 60 * 4;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_MINUTE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  int count=0;
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else     if ("mem_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  assertEquals("Two aggregated entries expected",2,count);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregationUsingGroupByQuery() throws Exception {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,getConfigurationForTest(true));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareTimelineMetrics(startTime,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  long endTime=startTime + 1000 * 60 * 4;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_MINUTE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  int count=0;
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else     if ("mem_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  assertEquals("Two aggregated entries expected",2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.webapp.TestAHSWebServices </h4><pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidUri2() throws JSONException, Exception {
  WebResource r=resource();
  String responseStr="";
  try {
    responseStr=r.accept(MediaType.APPLICATION_JSON).get(String.class);
    fail("should have thrown exception on invalid uri");
  }
 catch (  UniformInterfaceException ue) {
    ClientResponse response=ue.getResponse();
    assertEquals(Status.NOT_FOUND,response.getClientResponseStatus());
    WebServicesTestUtils.checkStringMatch("error string exists and shouldn't","",responseStr);
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidAccept() throws JSONException, Exception {
  WebResource r=resource();
  String responseStr="";
  try {
    responseStr=r.path("ws").path("v1").path("applicationhistory").accept(MediaType.TEXT_PLAIN).get(String.class);
    fail("should have thrown exception on invalid uri");
  }
 catch (  UniformInterfaceException ue) {
    ClientResponse response=ue.getResponse();
    assertEquals(Status.INTERNAL_SERVER_ERROR,response.getClientResponseStatus());
    WebServicesTestUtils.checkStringMatch("error string exists and shouldn't","",responseStr);
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidUri() throws JSONException, Exception {
  WebResource r=resource();
  String responseStr="";
  try {
    responseStr=r.path("ws").path("v1").path("applicationhistory").path("bogus").accept(MediaType.APPLICATION_JSON).get(String.class);
    fail("should have thrown exception on invalid uri");
  }
 catch (  UniformInterfaceException ue) {
    ClientResponse response=ue.getResponse();
    assertEquals(Status.NOT_FOUND,response.getClientResponseStatus());
    WebServicesTestUtils.checkStringMatch("error string exists and shouldn't","",responseStr);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
