<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.ambari.funtest.server.tests.DeleteServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Set up a test cluster with a service, a host and a few components.
 * Attempt to delete the service. Verify the state of the DB.
 * @throws Exception
 */
@Test public void testDeleteService() throws Exception {
  String clusterName="c1";
  String serviceName="HDFS";
  ConnectionParams params=new ConnectionParams();
  params.setServerName("localhost");
  params.setServerApiPort(serverPort);
  params.setServerAgentPort(serverAgentPort);
  params.setUserName("admin");
  params.setPassword("admin");
  ClusterUtils clusterUtils=injector.getInstance(ClusterUtils.class);
  clusterUtils.createSampleCluster(params);
  JsonElement jsonResponse=RestApiUtils.executeRequest(new GetServiceWebRequest(params,clusterName,serviceName));
  assertTrue(!jsonResponse.isJsonNull());
  JsonObject jsonServiceInfoObj=jsonResponse.getAsJsonObject().get("ServiceInfo").getAsJsonObject();
  String cluster_name=jsonServiceInfoObj.get("cluster_name").getAsString();
  assertEquals(cluster_name,clusterName);
  String service_name=jsonServiceInfoObj.get("service_name").getAsString();
  assertEquals(service_name,serviceName);
  jsonResponse=RestApiUtils.executeRequest(new StopServiceWebRequest(params,clusterName,serviceName));
  ClusterServiceDAO clusterServiceDAO=injector.getInstance(ClusterServiceDAO.class);
  List<ClusterServiceEntity> clusterServiceEntities=clusterServiceDAO.findAll();
  assertEquals(clusterServiceEntities.size(),1);
  assertEquals(clusterServiceEntities.get(0).getServiceName(),serviceName);
  ClusterServiceEntity clusterServiceEntity=clusterServiceEntities.get(0);
  long clusterId=clusterServiceEntity.getClusterId();
  ServiceDesiredStateDAO serviceDesiredStateDAO=injector.getInstance(ServiceDesiredStateDAO.class);
  List<ServiceDesiredStateEntity> serviceDesiredStateEntities=serviceDesiredStateDAO.findAll();
  assertEquals(serviceDesiredStateEntities.size(),1);
  ServiceDesiredStateEntity serviceDesiredStateEntity=serviceDesiredStateEntities.get(0);
  assertEquals(serviceDesiredStateEntity.getServiceName(),serviceName);
  assertEquals(serviceDesiredStateEntity.getDesiredState(),State.INSTALLED);
  ServiceComponentDesiredStateDAO serviceComponentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  List<ServiceComponentDesiredStateEntity> serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  assertEquals(serviceComponentDesiredStateEntities.size(),3);
  for (  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity : serviceComponentDesiredStateEntities) {
    assertEquals(serviceComponentDesiredStateEntity.getDesiredState(),State.INSTALLED);
  }
  HostComponentStateDAO hostComponentStateDAO=injector.getInstance(HostComponentStateDAO.class);
  List<HostComponentStateEntity> hostComponentStateEntities=hostComponentStateDAO.findAll();
  assertEquals(hostComponentStateEntities.size(),3);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  List<HostComponentDesiredStateEntity> hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  assertEquals(hostComponentDesiredStateEntities.size(),3);
  jsonResponse=RestApiUtils.executeRequest(new DeleteServiceWebRequest(params,clusterName,serviceName));
  WebResponse webResponse=new GetServiceWebRequest(params,clusterName,serviceName).getResponse();
  assertEquals(webResponse.getStatusCode(),HttpStatus.SC_NOT_FOUND);
  clusterServiceEntity=clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName);
  assertTrue(clusterServiceEntity == null);
  ServiceDesiredStateEntityPK serviceDesiredStateEntityPK=injector.getInstance(ServiceDesiredStateEntityPK.class);
  serviceDesiredStateEntityPK.setClusterId(clusterId);
  serviceDesiredStateEntityPK.setServiceName(serviceName);
  serviceDesiredStateEntity=serviceDesiredStateDAO.findByPK(serviceDesiredStateEntityPK);
  assertTrue(serviceDesiredStateEntity == null);
  ServiceComponentDesiredStateEntityPK serviceComponentDesiredStateEntityPK=injector.getInstance(ServiceComponentDesiredStateEntityPK.class);
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByPK(serviceComponentDesiredStateEntityPK);
  assertTrue(serviceComponentDesiredStateEntity == null);
  hostComponentStateEntities=hostComponentStateDAO.findByService(serviceName);
  assertEquals(hostComponentStateEntities.size(),0);
  hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  assertEquals(hostComponentDesiredStateEntities.size(),0);
  jsonResponse=RestApiUtils.executeRequest(new DeleteClusterWebRequest(params,clusterName));
  LOG.info(jsonResponse);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.funtest.server.tests.RoleBasedAccessControlBasicTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Creates an anonymous user and uses the user to add a cluster configuration.
 * @throws Exception
 */
@Test public void testAddClusterConfigAsAnonUser() throws Exception {
  ConnectionParams adminConnectionParams=createAdminConnectionParams();
  String anonUserName="nothing";
  String anonUserPwd="nothing";
  ClusterUtils.createUser(adminConnectionParams,clusterName,anonUserName,anonUserPwd,AmbariUserRole.NONE);
  String configType="test-hadoop-env";
  String configTag="version1";
  ClusterConfigParams configParams=new ClusterConfigParams();
  configParams.setClusterName(clusterName);
  configParams.setConfigType(configType);
  configParams.setConfigTag(configTag);
  configParams.setProperties(new HashMap<String,String>(){
{
      put("fs.default.name","localhost:9995");
    }
  }
);
  ConnectionParams anonUserParams=createConnectionParams(anonUserName,anonUserPwd);
  WebRequest webRequest=new CreateConfigurationWebRequest(anonUserParams,configParams);
  WebResponse webResponse=webRequest.getResponse();
  assertEquals(HttpStatus.SC_FORBIDDEN,webResponse.getStatusCode());
  JsonElement jsonResponse=RestApiUtils.executeRequest(new DeleteUserWebRequest(adminConnectionParams,"nothing"));
  LOG.info(jsonResponse);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Creates a user with cluster administrator privilege and adds a cluster configuration.
 * @throws Exception
 */
@Test public void testAddClusterConfigAsClusterAdmin() throws Exception {
  ConnectionParams adminConnectionParams=createAdminConnectionParams();
  String clusterAdminName="clusterAdmin";
  String clusterAdminPwd="clusterAdmin";
  ClusterUtils.createUserClusterAdministrator(adminConnectionParams,clusterName,clusterAdminName,clusterAdminPwd);
  String configType="test-hadoop-env";
  String configTag="version1";
  ClusterConfigParams configParams=new ClusterConfigParams();
  configParams.setClusterName(clusterName);
  configParams.setConfigType(configType);
  configParams.setConfigTag(configTag);
  configParams.setProperties(new HashMap<String,String>(){
{
      put("fs.default.name","localhost:9995");
    }
  }
);
  ConnectionParams userConnectionParams=createConnectionParams(clusterAdminName,clusterAdminPwd);
  WebRequest webRequest=new CreateConfigurationWebRequest(userConnectionParams,configParams);
  WebResponse webResponse=webRequest.getResponse();
  assertEquals(HttpStatus.SC_CREATED,webResponse.getStatusCode());
  RestApiUtils.executeRequest(new DeleteUserWebRequest(adminConnectionParams,clusterAdminName));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Creates an anonymous user (user with no role). Attempts to get the list of clusters
 * @throws Exception
 */
@Test public void testGetClustersAsAnonUser() throws Exception {
  JsonElement jsonResponse;
  ConnectionParams adminConnectionParams=createAdminConnectionParams();
  String anonUserName="nothing";
  String anonUserPwd="nothing";
  ClusterUtils.createUser(adminConnectionParams,clusterName,anonUserName,anonUserPwd,AmbariUserRole.NONE);
  ConnectionParams anonUserParams=createConnectionParams(anonUserName,anonUserPwd);
  jsonResponse=RestApiUtils.executeRequest(new GetAllClustersWebRequest(anonUserParams));
  assertFalse(jsonResponse.isJsonNull());
  jsonResponse=RestApiUtils.executeRequest(new DeleteUserWebRequest(adminConnectionParams,anonUserName));
  LOG.info(jsonResponse);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ClusterProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ClusterProvider provider=new ClusterProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("myCluster").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource next=resources.iterator().next();
  Assert.assertEquals("myCluster",next.getPropertyValue(ClusterProvider.CLUSTER_NAME_PROPERTY_ID));
  Assert.assertEquals("HDP-1.2.9",next.getPropertyValue(ClusterProvider.CLUSTER_VERSION_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("non-existent Cluster").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.HostProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesHostIP() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("NAMENODE_MASTER.acme.com").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  String ip=(String)resource.getPropertyValue(HostProvider.HOST_IP_PROPERTY_ID);
  Assert.assertEquals("127.0.0.1",ip);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckStateFromCategory() throws Exception {
  TestStateProvider stateProvider=new TestStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("slave3.acme.com").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest("Hosts"),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("HEALTHY",resource.getPropertyValue(HostProvider.HOST_STATE_PROPERTY_ID));
  stateProvider.setState(StateProvider.State.Unknown);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("UNHEALTHY",resource.getPropertyValue(HostProvider.HOST_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckState() throws Exception {
  TestStateProvider stateProvider=new TestStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("slave3.acme.com").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("HEALTHY",resource.getPropertyValue(HostProvider.HOST_STATE_PROPERTY_ID));
  stateProvider.setState(StateProvider.State.Unknown);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("UNHEALTHY",resource.getPropertyValue(HostProvider.HOST_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ServiceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckState() throws Exception {
  TestStateProvider stateProvider=new TestStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ServiceProvider provider=new ServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("STARTED",resource.getPropertyValue(ServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INSTALLED",resource.getPropertyValue(ServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckStateFromCategory() throws Exception {
  TestStateProvider stateProvider=new TestStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ServiceProvider provider=new ServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest("ServiceInfo"),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("STARTED",resource.getPropertyValue(ServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INSTALLED",resource.getPropertyValue(ServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.SQLPropertyProviderTest </h4><pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_multi() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcQueueTime_avg_time");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcQueueTime_avg_time");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),new TestHostInfoProvider(),CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,20L,1L));
  Set<String> propertyIds=new LinkedHashSet<String>();
  propertyIds.add(PROPERTY_ID_1);
  propertyIds.add(PROPERTY_ID_2);
  Request request=PropertyHelper.getReadRequest(propertyIds,temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  Assert.assertEquals(3L,resource.getPropertyValue(PROPERTY_ID_2));
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPopulateResources_pointInTime() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),new TestHostInfoProvider(),CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_2),temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertEquals(3L,resource.getPropertyValue(PROPERTY_ID_2));
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),new TestHostInfoProvider(),CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,20L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_temporalStartTimeOnly() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  TestHostInfoProvider hostProvider=new TestHostInfoProvider();
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),hostProvider,CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,-1L,-1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.ExecutionCommandWrapperTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetExecutionCommand() throws JSONException, AmbariException {
  Map<String,Map<String,String>> confs=new HashMap<String,Map<String,String>>();
  Map<String,String> configurationsGlobal=new HashMap<String,String>();
  configurationsGlobal.put(GLOBAL_NAME1,GLOBAL_VAL1);
  confs.put(GLOBAL_CONFIG,configurationsGlobal);
  Map<String,Map<String,String>> confTags=new HashMap<String,Map<String,String>>();
  Map<String,String> confTagServiceSite=new HashMap<String,String>();
  confTagServiceSite.put("tag",CLUSTER_VERSION_TAG);
  confTagServiceSite.put("service_override_tag",SERVICE_VERSION_TAG);
  confTagServiceSite.put("host_override_tag",HOST_VERSION_TAG);
  confTags.put(SERVICE_SITE_CONFIG,confTagServiceSite);
  Map<String,String> confTagGlobal=Collections.singletonMap("tag",CLUSTER_VERSION_TAG);
  confTags.put(GLOBAL_CONFIG,confTagGlobal);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setClusterName(CLUSTER1);
  executionCommand.setTaskId(1);
  executionCommand.setRequestAndStage(1,1);
  executionCommand.setHostname(HOST1);
  executionCommand.setRole("NAMENODE");
  executionCommand.setRoleParams(Collections.<String,String>emptyMap());
  executionCommand.setRoleCommand(RoleCommand.START);
  executionCommand.setConfigurations(confs);
  executionCommand.setConfigurationTags(confTags);
  executionCommand.setServiceName("HDFS");
  executionCommand.setCommandType(AgentCommandType.EXECUTION_COMMAND);
  executionCommand.setCommandParams(Collections.<String,String>emptyMap());
  String json=StageUtils.getGson().toJson(executionCommand,ExecutionCommand.class);
  ExecutionCommandWrapper execCommWrap=new ExecutionCommandWrapper(json);
  ExecutionCommand processedExecutionCommand=execCommWrap.getExecutionCommand();
  Map<String,String> serviceSiteConfig=processedExecutionCommand.getConfigurations().get(SERVICE_SITE_CONFIG);
  Assert.assertEquals(SERVICE_SITE_VAL1_S,serviceSiteConfig.get(SERVICE_SITE_NAME1));
  Assert.assertEquals(SERVICE_SITE_VAL2_H,serviceSiteConfig.get(SERVICE_SITE_NAME2));
  Assert.assertEquals(SERVICE_SITE_VAL3,serviceSiteConfig.get(SERVICE_SITE_NAME3));
  Assert.assertEquals(SERVICE_SITE_VAL4,serviceSiteConfig.get(SERVICE_SITE_NAME4));
  Assert.assertEquals(SERVICE_SITE_VAL5_S,serviceSiteConfig.get(SERVICE_SITE_NAME5));
  Assert.assertEquals(SERVICE_SITE_VAL6_H,serviceSiteConfig.get(SERVICE_SITE_NAME6));
  Map<String,String> globalConfig=processedExecutionCommand.getConfigurations().get(GLOBAL_CONFIG);
  Assert.assertEquals(GLOBAL_VAL1,globalConfig.get(GLOBAL_NAME1));
  Assert.assertEquals(GLOBAL_CLUSTER_VAL2,globalConfig.get(GLOBAL_NAME2));
  Set<String> serviceSiteKeys=new HashSet<String>();
  serviceSiteKeys.addAll(SERVICE_SITE_CLUSTER.keySet());
  serviceSiteKeys.addAll(SERVICE_SITE_SERVICE.keySet());
  serviceSiteKeys.addAll(SERVICE_SITE_HOST.keySet());
  Assert.assertEquals(serviceSiteKeys.size(),serviceSiteConfig.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.StageTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddServerActionCommand_userName() throws Exception {
  final Stage stage=stageFactory.createNew(1,"/tmp","cluster1",978,"context",CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  stage.addServerActionCommand(ConfigureAction.class.getName(),"user1",Role.AMBARI_SERVER_ACTION,RoleCommand.EXECUTE,"cluster1",new ServiceComponentHostServerActionEvent(StageUtils.getHostName(),System.currentTimeMillis()),Collections.<String,String>emptyMap(),null,null,1200,false,false);
  List<ExecutionCommandWrapper> executionCommands=stage.getExecutionCommands(null);
  assertEquals(1,executionCommands.size());
  String actionUserName=executionCommands.get(0).getExecutionCommand().getRoleParams().get(ServerAction.ACTION_USER_NAME);
  assertEquals("user1",actionUserName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionDBAccessorImpl </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHostRoleScheduled() throws InterruptedException, AmbariException {
  populateActionDB(db,hostName,requestId,stageId);
  Stage stage=db.getStage(StageUtils.getActionId(requestId,stageId));
  assertEquals(HostRoleStatus.PENDING,stage.getHostRoleStatus(hostName,Role.HBASE_MASTER.toString()));
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  stage.setHostRoleStatus(hostName,Role.HBASE_MASTER.toString(),HostRoleStatus.QUEUED);
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(HostRoleStatus.QUEUED,stage.getHostRoleStatus(hostName,Role.HBASE_MASTER.toString()));
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  db.hostRoleScheduled(stage,hostName,Role.HBASE_MASTER.toString());
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(HostRoleStatus.QUEUED,entities.get(0).getStatus());
  Thread thread=new Thread(){
    @Override public void run(){
      Stage stage1=db.getStage("23-31");
      stage1.setHostRoleStatus(hostName,Role.HBASE_MASTER.toString(),HostRoleStatus.COMPLETED);
      db.hostRoleScheduled(stage1,hostName,Role.HBASE_MASTER.toString());
      injector.getInstance(EntityManager.class).clear();
    }
  }
;
  thread.start();
  thread.join();
  injector.getInstance(EntityManager.class).clear();
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals("Concurrent update failed",HostRoleStatus.COMPLETED,entities.get(0).getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServerActionScheduled() throws InterruptedException, AmbariException {
  populateActionDBWithServerAction(db,null,requestId,stageId);
  final String roleName=Role.AMBARI_SERVER_ACTION.toString();
  Stage stage=db.getStage(StageUtils.getActionId(requestId,stageId));
  assertEquals(HostRoleStatus.PENDING,stage.getHostRoleStatus(null,roleName));
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findByHostRole(null,requestId,stageId,roleName);
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  stage.setHostRoleStatus(null,roleName,HostRoleStatus.QUEUED);
  entities=hostRoleCommandDAO.findByHostRole(null,requestId,stageId,roleName);
  assertEquals(HostRoleStatus.QUEUED,stage.getHostRoleStatus(null,roleName));
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  db.hostRoleScheduled(stage,null,roleName);
  entities=hostRoleCommandDAO.findByHostRole(null,requestId,stageId,roleName);
  assertEquals(HostRoleStatus.QUEUED,entities.get(0).getStatus());
  Thread thread=new Thread(){
    @Override public void run(){
      Stage stage1=db.getStage("23-31");
      stage1.setHostRoleStatus(null,roleName,HostRoleStatus.COMPLETED);
      db.hostRoleScheduled(stage1,null,roleName);
      injector.getInstance(EntityManager.class).clear();
    }
  }
;
  thread.start();
  thread.join();
  injector.getInstance(EntityManager.class).clear();
  entities=hostRoleCommandDAO.findByHostRole(null,requestId,stageId,roleName);
  assertEquals("Concurrent update failed",HostRoleStatus.COMPLETED,entities.get(0).getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCustomActionScheduled() throws InterruptedException, AmbariException {
  populateActionDBWithCustomAction(db,hostName,requestId,stageId);
  Stage stage=db.getStage(StageUtils.getActionId(requestId,stageId));
  assertEquals(HostRoleStatus.PENDING,stage.getHostRoleStatus(hostName,actionName));
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,actionName);
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  stage.setHostRoleStatus(hostName,actionName,HostRoleStatus.QUEUED);
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,actionName);
  assertEquals(HostRoleStatus.QUEUED,stage.getHostRoleStatus(hostName,actionName));
  assertEquals(HostRoleStatus.PENDING,entities.get(0).getStatus());
  db.hostRoleScheduled(stage,hostName,actionName);
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,actionName);
  assertEquals(HostRoleStatus.QUEUED,entities.get(0).getStatus());
  Thread thread=new Thread(){
    @Override public void run(){
      Stage stage1=db.getStage("23-31");
      stage1.setHostRoleStatus(hostName,actionName,HostRoleStatus.COMPLETED);
      db.hostRoleScheduled(stage1,hostName,actionName);
      injector.getInstance(EntityManager.class).clear();
    }
  }
;
  thread.start();
  thread.join();
  injector.getInstance(EntityManager.class).clear();
  entities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,actionName);
  assertEquals("Concurrent update failed",HostRoleStatus.COMPLETED,entities.get(0).getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRequestsByStatusWithParams() throws AmbariException {
  List<Long> ids=new ArrayList<Long>();
  for (long l=1; l <= 10; l++) {
    ids.add(l);
  }
  for (  Long id : ids) {
    populateActionDB(db,hostName,id,stageId);
  }
  List<Long> expected=null;
  List<Long> actual=null;
  actual=db.getRequestsByStatus(null,BaseRequest.DEFAULT_PAGE_SIZE,false);
  expected=reverse(new ArrayList<Long>(ids));
  assertEquals("Request IDs not matches",expected,actual);
  actual=db.getRequestsByStatus(null,4,false);
  expected=reverse(new ArrayList<Long>(ids.subList(ids.size() - 4,ids.size())));
  assertEquals("Request IDs not matches",expected,actual);
  actual=db.getRequestsByStatus(null,7,true);
  expected=new ArrayList<Long>(ids.subList(0,7));
  assertEquals("Request IDs not matches",expected,actual);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostRole() throws Exception {
  populateActionDB(db,hostName,requestId,stageId);
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 50000; i++) {
    sb.append("1234567890");
  }
  String largeString=sb.toString();
  CommandReport commandReport=new CommandReport();
  commandReport.setStatus(HostRoleStatus.COMPLETED.toString());
  commandReport.setStdOut(largeString);
  commandReport.setStdErr(largeString);
  commandReport.setStructuredOut(largeString);
  commandReport.setExitCode(123);
  db.updateHostRoleState(hostName,requestId,stageId,Role.HBASE_MASTER.toString(),commandReport);
  List<HostRoleCommandEntity> commandEntities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(1,commandEntities.size());
  HostRoleCommandEntity commandEntity=commandEntities.get(0);
  HostRoleCommand command=db.getTask(commandEntity.getTaskId());
  assertNotNull(command);
  assertEquals(largeString,command.getStdout());
  assertEquals(largeString,command.getStructuredOut());
  assertTrue(command.getEndTime() != -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionScheduler </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verifies that ActionScheduler allows to execute background tasks in parallel
 */
@Test public void testBackgroundStagesExecutionEnable() throws Exception {
  ActionQueue aq=new ActionQueue();
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  String hostname1="ahost.ambari.apache.org";
  String hostname2="bhost.ambari.apache.org";
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname1,sch);
  hosts.put(hostname2,sch);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  List<Stage> stages=new ArrayList<Stage>();
  Stage backgroundStage=null;
  stages.add(backgroundStage=getStageWithSingleTask(hostname1,"cluster1",Role.NAMENODE,RoleCommand.CUSTOM_COMMAND,"REBALANCEHDFS",Service.Type.HDFS,1,1,1));
  Assert.assertEquals(AgentCommandType.BACKGROUND_EXECUTION_COMMAND,backgroundStage.getExecutionCommands(hostname1).get(0).getExecutionCommand().getCommandType());
  stages.add(getStageWithSingleTask(hostname1,"cluster1",Role.GANGLIA_MONITOR,RoleCommand.START,Service.Type.GANGLIA,2,2,2));
  stages.add(getStageWithSingleTask(hostname2,"cluster1",Role.DATANODE,RoleCommand.START,Service.Type.HDFS,3,3,3));
  ActionDBAccessor db=mock(ActionDBAccessor.class);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  when(db.getCommandsInProgressCount()).thenReturn(stages.size());
  when(db.getStagesInProgress()).thenReturn(stages);
  Properties properties=new Properties();
  properties.put(Configuration.PARALLEL_STAGE_EXECUTION_KEY,"true");
  Configuration conf=new Configuration(properties);
  ActionScheduler scheduler=new ActionScheduler(100,50,db,aq,fsm,3,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.doWork();
  Assert.assertEquals(HostRoleStatus.QUEUED,stages.get(0).getHostRoleStatus(hostname1,"NAMENODE"));
  Assert.assertEquals(HostRoleStatus.QUEUED,stages.get(2).getHostRoleStatus(hostname2,"DATANODE"));
  Assert.assertEquals(HostRoleStatus.QUEUED,stages.get(1).getHostRoleStatus(hostname1,"GANGLIA_MONITOR"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test sends verifies that ActionScheduler returns up-to-date cluster host info and caching works correctly.
 */
@Test public void testClusterHostInfoCache() throws Exception {
  Type type=new TypeToken<Map<String,Set<String>>>(){
  }
.getType();
  Map<String,Set<String>> clusterHostInfo1=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO,type);
  Map<String,Set<String>> clusterHostInfo2=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO_UPDATED,type);
  int stageId=1;
  int requestId1=1;
  int requestId2=2;
  ActionQueue aq=new ActionQueue();
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  Host host=mock(Host.class);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname,sch);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  when(fsm.getHost(anyString())).thenReturn(host);
  when(host.getState()).thenReturn(HostState.HEALTHY);
  when(host.getHostName()).thenReturn(hostname);
  ActionDBAccessor db=mock(ActionDBAccessorImpl.class);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  Stage s1=StageUtils.getATestStage(requestId1,stageId,hostname,CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  Stage s2=StageUtils.getATestStage(requestId2,stageId,hostname,CLUSTER_HOST_INFO_UPDATED,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  when(db.getCommandsInProgressCount()).thenReturn(1);
  when(db.getStagesInProgress()).thenReturn(Collections.singletonList(s1));
  ActionScheduler scheduler=new ActionScheduler(100,100,db,aq,fsm,10000,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.setTaskTimeoutAdjustment(false);
  List<AgentCommand> ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals(String.valueOf(requestId1) + "-" + stageId,((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo1,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  when(db.getCommandsInProgressCount()).thenReturn(1);
  when(db.getStagesInProgress()).thenReturn(Collections.singletonList(s2));
  ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals(String.valueOf(requestId2) + "-" + stageId,((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo2,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSuccessFactors(){
  Stage s=StageUtils.getATestStage(1,1,CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  assertEquals(new Float(0.5),new Float(s.getSuccessFactor(Role.DATANODE)));
  assertEquals(new Float(0.5),new Float(s.getSuccessFactor(Role.TASKTRACKER)));
  assertEquals(new Float(0.5),new Float(s.getSuccessFactor(Role.GANGLIA_MONITOR)));
  assertEquals(new Float(0.5),new Float(s.getSuccessFactor(Role.HBASE_REGIONSERVER)));
  assertEquals(new Float(1.0),new Float(s.getSuccessFactor(Role.NAMENODE)));
  assertEquals(new Float(1.0),new Float(s.getSuccessFactor(Role.GANGLIA_SERVER)));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test sends a new action to the action scheduler and verifies that the action
 * shows up in the action queue.
 */
@Test public void testActionSchedule() throws Exception {
  Type type=new TypeToken<Map<String,Set<String>>>(){
  }
.getType();
  Map<String,List<String>> clusterHostInfo=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO,type);
  ActionQueue aq=new ActionQueue();
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(fsm.getClusterById(anyLong())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(oneClusterMock.getClusterId()).thenReturn(Long.valueOf(1L));
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  Host host=mock(Host.class);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname,sch);
  HostEntity hostEntity=new HostEntity();
  hostEntity.setHostName(hostname);
  hostDAO.merge(hostEntity);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  when(fsm.getHost(anyString())).thenReturn(host);
  when(host.getState()).thenReturn(HostState.HEALTHY);
  when(host.getHostName()).thenReturn(hostname);
  ActionDBAccessor db=mock(ActionDBAccessorImpl.class);
  List<Stage> stages=new ArrayList<Stage>();
  Stage s=StageUtils.getATestStage(1,977,hostname,CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  stages.add(s);
  when(db.getCommandsInProgressCount()).thenReturn(stages.size());
  when(db.getStagesInProgress()).thenReturn(stages);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  ActionScheduler scheduler=new ActionScheduler(100,5,db,aq,fsm,10000,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.setTaskTimeoutAdjustment(false);
  List<AgentCommand> ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals("1-977",((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals("1-977",((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  s.setHostRoleStatus(hostname,"NAMENODE",HostRoleStatus.COMPLETED);
  ac=aq.dequeueAll(hostname);
  ac=waitForQueueSize(hostname,aq,0,scheduler);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestStage </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTaskTimeout(){
  Stage s=StageUtils.getATestStage(1,1,"h1",CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  s.addHostRoleExecutionCommand("h1",Role.DATANODE,RoleCommand.INSTALL,null,"c1","HDFS",false,false);
  s.addHostRoleExecutionCommand("h1",Role.HBASE_MASTER,RoleCommand.INSTALL,null,"c1","HBASE",false,false);
  for (  ExecutionCommandWrapper wrapper : s.getExecutionCommands("h1")) {
    Map<String,String> commandParams=new TreeMap<String,String>();
    commandParams.put(ExecutionCommand.KeyNames.COMMAND_TIMEOUT,"600");
    wrapper.getExecutionCommand().setCommandParams(commandParams);
  }
  assertEquals(3 * 600000,s.getStageTimeout());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.AgentResourceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deserializeClasses(){
  String DirectoryJSON="[{name:'/var/lib', type:'directory'},{name:'b', type:'directory'}]";
  String PackageDetailJSON="[{name:'abc', version:'2.3', repoName:'HDP'},{name:'abc', version:'3.3', repoName:'HDP-epel'}]";
  String ExistingUserJSON="[{name:'hdfs', homeDir:'/var/lib/hadoop', status:''}, " + "{name:'ambari_qa', homeDir:'/var/home/ambari_qa',status:'None'}]";
  String JavaProcJSON="[{user:'root', pid:'355', hadoop:'True', command:'cmd'}, " + "{user:'hdfs', pid:'325', hadoop:'False', command:'cmd = 2'}]";
  String AlternativeJSON="[{name:'/etc/alternatives/hdfs-conf', target:'/etc/hadoop/conf.dist'}, " + "{name:'abc', target:'def'}]";
  String AgentEnvJSON="{\"alternatives\": " + AlternativeJSON + ", \"existingUsers\": "+ ExistingUserJSON+ ", \"umask\": \"18\", \"installedPackages\": "+ PackageDetailJSON+ ", \"stackFoldersAndFiles\": "+ DirectoryJSON+ ", \"firewallRunning\": \"true\", \"firewallName\": \"iptables\", \"transparentHugePage\": \"never\"}";
  AgentEnv.Directory[] dirs=getJsonFormString(DirectoryJSON,AgentEnv.Directory[].class);
  Assert.assertEquals("/var/lib",dirs[0].getName());
  Assert.assertEquals("directory",dirs[1].getType());
  AgentEnv.PackageDetail[] pkgs=getJsonFormString(PackageDetailJSON,AgentEnv.PackageDetail[].class);
  Assert.assertEquals("abc",pkgs[0].getName());
  Assert.assertEquals("HDP",pkgs[0].getRepoName());
  Assert.assertEquals("3.3",pkgs[1].getVersion());
  AgentEnv.ExistingUser[] users=getJsonFormString(ExistingUserJSON,AgentEnv.ExistingUser[].class);
  Assert.assertEquals("hdfs",users[0].getUserName());
  Assert.assertEquals("/var/lib/hadoop",users[0].getUserHomeDir());
  Assert.assertEquals("None",users[1].getUserStatus());
  AgentEnv.JavaProc[] procs=getJsonFormString(JavaProcJSON,AgentEnv.JavaProc[].class);
  Assert.assertEquals("root",procs[0].getUser());
  Assert.assertEquals(355,procs[0].getPid());
  Assert.assertEquals("cmd = 2",procs[1].getCommand());
  Assert.assertEquals(false,procs[1].isHadoop());
  AgentEnv.Alternative[] alternatives=getJsonFormString(AlternativeJSON,AgentEnv.Alternative[].class);
  Assert.assertEquals("/etc/alternatives/hdfs-conf",alternatives[0].getName());
  Assert.assertEquals("/etc/hadoop/conf.dist",alternatives[0].getTarget());
  Assert.assertEquals("abc",alternatives[1].getName());
  Assert.assertEquals("def",alternatives[1].getTarget());
  AgentEnv agentEnv=getJsonFormString(AgentEnvJSON,AgentEnv.class);
  Assert.assertTrue(18 == agentEnv.getUmask());
  Assert.assertEquals("never",agentEnv.getTransparentHugePage());
  Assert.assertTrue(Boolean.TRUE == agentEnv.getFirewallRunning());
  Assert.assertEquals("iptables",agentEnv.getFirewallName());
  Assert.assertEquals("/etc/alternatives/hdfs-conf",agentEnv.getAlternatives()[0].getName());
  Assert.assertEquals("/etc/hadoop/conf.dist",agentEnv.getAlternatives()[0].getTarget());
  Assert.assertEquals("abc",agentEnv.getAlternatives()[1].getName());
  Assert.assertEquals("def",agentEnv.getAlternatives()[1].getTarget());
  Assert.assertEquals("abc",agentEnv.getInstalledPackages()[0].getName());
  Assert.assertEquals("HDP",agentEnv.getInstalledPackages()[0].getRepoName());
  Assert.assertEquals("3.3",agentEnv.getInstalledPackages()[1].getVersion());
  Assert.assertEquals("hdfs",agentEnv.getExistingUsers()[0].getUserName());
  Assert.assertEquals("/var/lib/hadoop",agentEnv.getExistingUsers()[0].getUserHomeDir());
  Assert.assertEquals("None",agentEnv.getExistingUsers()[1].getUserStatus());
  Assert.assertEquals("/var/lib",agentEnv.getStackFoldersAndFiles()[0].getName());
  Assert.assertEquals("directory",agentEnv.getStackFoldersAndFiles()[1].getType());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void agentHeartBeatWithEnv() throws UniformInterfaceException, JSONException {
  HeartBeatResponse response;
  ClientConfig clientConfig=new DefaultClientConfig();
  clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
  client=Client.create(clientConfig);
  WebResource webResource=client.resource(String.format("http://localhost:%d/heartbeat/dummyhost",getTestPort()));
  response=webResource.type(MediaType.APPLICATION_JSON).post(HeartBeatResponse.class,createDummyHeartBeatWithAgentEnv());
  LOG.info("Returned from Server: " + " response=" + response);
  Assert.assertEquals(response.getResponseId(),0L);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void agentComponents(){
  ComponentsResponse response;
  ClientConfig clientConfig=new DefaultClientConfig();
  clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
  client=Client.create(clientConfig);
  WebResource webResource=client.resource(String.format("http://localhost:%d/components/dummycluster",getTestPort()));
  response=webResource.get(ComponentsResponse.class);
  Assert.assertEquals(response.getClusterName(),"dummycluster");
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void agentHeartBeat() throws UniformInterfaceException, JSONException {
  HeartBeatResponse response;
  ClientConfig clientConfig=new DefaultClientConfig();
  clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
  client=Client.create(clientConfig);
  WebResource webResource=client.resource(String.format("http://localhost:%d/heartbeat/dummyhost",getTestPort()));
  response=webResource.type(MediaType.APPLICATION_JSON).post(HeartBeatResponse.class,createDummyHeartBeat());
  LOG.info("Returned from Server: " + " response=" + response);
  Assert.assertEquals(response.getResponseId(),0L);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void agentRegistration() throws UniformInterfaceException, JSONException {
  RegistrationResponse response;
  ClientConfig clientConfig=new DefaultClientConfig();
  clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
  client=Client.create(clientConfig);
  WebResource webResource=client.resource(String.format("http://localhost:%d/register/dummyhost",getTestPort()));
  response=webResource.type(MediaType.APPLICATION_JSON).post(RegistrationResponse.class,createDummyJSONRegister());
  LOG.info("Returned from Server responce=" + response);
  Assert.assertEquals(response.getResponseStatus(),RegistrationStatus.OK);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatHandler </h4><pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectKeytabApplicableHost() throws Exception {
  List<Map<String,String>> kcp;
  Map<String,String> properties;
  kcp=testInjectKeytabSetKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertEquals("hdfs",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertEquals("r",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertEquals("hadoop",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertEquals("",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertEquals(Base64.encodeBase64String("hello".getBytes()),kcp.get(0).get(KerberosServerAction.KEYTAB_CONTENT_BASE64));
  kcp=testInjectKeytabRemoveKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosServerAction.KEYTAB_CONTENT_BASE64));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test @SuppressWarnings("unchecked") public void testStatusHeartbeatWithAnnotation() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.addServiceComponent(SECONDARY_NAMENODE).persist();
  ActionQueue aq=new ActionQueue();
  HeartBeat hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(0);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(new ArrayList<CommandReport>());
  ArrayList<ComponentStatus> componentStatuses=new ArrayList<ComponentStatus>();
  hb.setComponentStatus(componentStatuses);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
    }
  }
).anyTimes();
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  HeartBeatResponse resp=handler.handleHeartBeat(hb);
  Assert.assertFalse(resp.hasMappedComponents());
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  serviceComponentHost1.setState(State.INIT);
  hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(1);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(new ArrayList<CommandReport>());
  hb.setComponentStatus(componentStatuses);
  resp=handler.handleHeartBeat(hb);
  Assert.assertTrue(resp.hasMappedComponents());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.alerts.AgentHeartbeatAlertRunnableTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHealthyHostAlert(){
  assertEquals(0,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  AgentHeartbeatAlertRunnable runnable=new AgentHeartbeatAlertRunnable();
  m_injector.injectMembers(runnable);
  runnable.run();
  assertEquals(1,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  List<AlertEvent> events=m_listener.getAlertEventInstances(AlertReceivedEvent.class);
  assertEquals(1,events.size());
  AlertReceivedEvent event=(AlertReceivedEvent)events.get(0);
  Alert alert=event.getAlert();
  assertEquals("AMBARI",alert.getService());
  assertEquals("AMBARI_SERVER",alert.getComponent());
  assertEquals(AlertState.OK,alert.getState());
  assertEquals(DEFINITION_NAME,alert.getName());
  verify(m_definition,m_host,m_cluster,m_clusters,m_definitionDao);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnhealthyAlert(){
  EasyMock.reset(m_host);
  expect(m_host.getState()).andReturn(HostState.HEARTBEAT_LOST).atLeastOnce();
  replay(m_host);
  assertEquals(0,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  AgentHeartbeatAlertRunnable runnable=new AgentHeartbeatAlertRunnable();
  m_injector.injectMembers(runnable);
  runnable.run();
  assertEquals(1,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  List<AlertEvent> events=m_listener.getAlertEventInstances(AlertReceivedEvent.class);
  assertEquals(1,events.size());
  AlertReceivedEvent event=(AlertReceivedEvent)events.get(0);
  Alert alert=event.getAlert();
  assertEquals("AMBARI",alert.getService());
  assertEquals("AMBARI_SERVER",alert.getComponent());
  assertEquals(AlertState.CRITICAL,alert.getState());
  assertEquals(DEFINITION_NAME,alert.getName());
  verify(m_definition,m_host,m_cluster,m_clusters,m_definitionDao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.alerts.StaleAlertRunnableTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that the event is triggerd with a status of OK.
 */
@Test public void testAllAlertsAreCurrent(){
  AlertDefinitionEntity definition1=new AlertDefinitionEntity();
  definition1.setClusterId(CLUSTER_ID);
  definition1.setDefinitionName("foo-definition");
  definition1.setServiceName("HDFS");
  definition1.setComponentName("NAMENODE");
  definition1.setEnabled(true);
  definition1.setScheduleInterval(1);
  AlertCurrentEntity current1=createNiceMock(AlertCurrentEntity.class);
  AlertHistoryEntity history1=createNiceMock(AlertHistoryEntity.class);
  expect(current1.getAlertHistory()).andReturn(history1).atLeastOnce();
  expect(history1.getAlertDefinition()).andReturn(definition1).atLeastOnce();
  expect(current1.getMaintenanceState()).andReturn(MaintenanceState.OFF).atLeastOnce();
  expect(current1.getLatestTimestamp()).andReturn(System.currentTimeMillis()).atLeastOnce();
  replay(current1,history1);
  m_currentAlerts.add(current1);
  assertEquals(0,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  StaleAlertRunnable runnable=new StaleAlertRunnable();
  m_injector.injectMembers(runnable);
  runnable.run();
  assertEquals(1,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  List<AlertEvent> events=m_listener.getAlertEventInstances(AlertReceivedEvent.class);
  assertEquals(1,events.size());
  AlertReceivedEvent event=(AlertReceivedEvent)events.get(0);
  Alert alert=event.getAlert();
  assertEquals("AMBARI",alert.getService());
  assertEquals("AMBARI_SERVER",alert.getComponent());
  assertEquals(AlertState.OK,alert.getState());
  assertEquals(DEFINITION_NAME,alert.getName());
  verify(m_cluster,m_clusters,m_definitionDao);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that a stale alert in maintenance mode doesn't trigger the event.
 */
@Test public void testStaleAlertInMaintenaceMode(){
  AlertDefinitionEntity definition1=new AlertDefinitionEntity();
  definition1.setClusterId(CLUSTER_ID);
  definition1.setDefinitionName("foo-definition");
  definition1.setServiceName("HDFS");
  definition1.setComponentName("NAMENODE");
  definition1.setEnabled(true);
  definition1.setScheduleInterval(1);
  AlertCurrentEntity current1=createNiceMock(AlertCurrentEntity.class);
  AlertHistoryEntity history1=createNiceMock(AlertHistoryEntity.class);
  AlertCurrentEntity current2=createNiceMock(AlertCurrentEntity.class);
  AlertHistoryEntity history2=createNiceMock(AlertHistoryEntity.class);
  expect(current1.getAlertHistory()).andReturn(history1).atLeastOnce();
  expect(history1.getAlertDefinition()).andReturn(definition1).atLeastOnce();
  expect(current2.getAlertHistory()).andReturn(history2).atLeastOnce();
  expect(history2.getAlertDefinition()).andReturn(definition1).atLeastOnce();
  expect(current1.getMaintenanceState()).andReturn(MaintenanceState.ON).atLeastOnce();
  expect(current1.getLatestTimestamp()).andReturn(1L).atLeastOnce();
  expect(current2.getMaintenanceState()).andReturn(MaintenanceState.OFF).atLeastOnce();
  expect(current2.getLatestTimestamp()).andReturn(System.currentTimeMillis()).atLeastOnce();
  replay(current1,history1,current2,history2);
  m_currentAlerts.add(current1);
  m_currentAlerts.add(current2);
  assertEquals(0,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  StaleAlertRunnable runnable=new StaleAlertRunnable();
  m_injector.injectMembers(runnable);
  runnable.run();
  assertEquals(1,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  List<AlertEvent> events=m_listener.getAlertEventInstances(AlertReceivedEvent.class);
  assertEquals(1,events.size());
  AlertReceivedEvent event=(AlertReceivedEvent)events.get(0);
  Alert alert=event.getAlert();
  assertEquals("AMBARI",alert.getService());
  assertEquals("AMBARI_SERVER",alert.getComponent());
  assertEquals(AlertState.OK,alert.getState());
  assertEquals(DEFINITION_NAME,alert.getName());
  verify(m_cluster,m_clusters,m_definitionDao);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that a stale alert triggers the event with a status of CRITICAL.
 */
@Test public void testStaleAlert(){
  AlertDefinitionEntity definition1=new AlertDefinitionEntity();
  definition1.setClusterId(CLUSTER_ID);
  definition1.setDefinitionName("foo-definition");
  definition1.setServiceName("HDFS");
  definition1.setComponentName("NAMENODE");
  definition1.setEnabled(true);
  definition1.setScheduleInterval(1);
  AlertCurrentEntity current1=createNiceMock(AlertCurrentEntity.class);
  AlertHistoryEntity history1=createNiceMock(AlertHistoryEntity.class);
  expect(current1.getAlertHistory()).andReturn(history1).atLeastOnce();
  expect(history1.getAlertDefinition()).andReturn(definition1).atLeastOnce();
  expect(current1.getMaintenanceState()).andReturn(MaintenanceState.OFF).atLeastOnce();
  expect(current1.getLatestTimestamp()).andReturn(1L).atLeastOnce();
  replay(current1,history1);
  m_currentAlerts.add(current1);
  assertEquals(0,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  StaleAlertRunnable runnable=new StaleAlertRunnable();
  m_injector.injectMembers(runnable);
  runnable.run();
  assertEquals(1,m_listener.getAlertEventReceivedCount(AlertReceivedEvent.class));
  List<AlertEvent> events=m_listener.getAlertEventInstances(AlertReceivedEvent.class);
  assertEquals(1,events.size());
  AlertReceivedEvent event=(AlertReceivedEvent)events.get(0);
  Alert alert=event.getAlert();
  assertEquals("AMBARI",alert.getService());
  assertEquals("AMBARI_SERVER",alert.getComponent());
  assertEquals(AlertState.CRITICAL,alert.getState());
  assertEquals(DEFINITION_NAME,alert.getName());
  verify(m_cluster,m_clusters,m_definitionDao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.predicate.QueryParserTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_InOp__simple() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".in("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"foo"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"one,two,3"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  EqualsPredicate ep1=new EqualsPredicate("foo","one");
  EqualsPredicate ep2=new EqualsPredicate("foo","two");
  EqualsPredicate ep3=new EqualsPredicate("foo","3");
  OrPredicate orPredicate=new OrPredicate(ep1,ep2,ep3);
  assertEquals(orPredicate,p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_NotOp() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"1"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_UNARY_OPERATOR,"!"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"b"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"2"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  EqualsPredicate aPred=new EqualsPredicate<String>("a","1");
  EqualsPredicate bPred=new EqualsPredicate<String>("b","2");
  NotPredicate notPred=new NotPredicate(bPred);
  AndPredicate andPred=new AndPredicate(aPred,notPred);
  assertEquals(andPred,p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_NotOp__simple() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.LOGICAL_UNARY_OPERATOR,"!"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"b"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  assertEquals(new NotPredicate(new EqualsPredicate<String>("a","b")),p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_isEmptyOp__simple() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".isEmpty("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"category1"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  assertEquals(new CategoryIsEmptyPredicate("category1"),p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_FilterOp() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR_FUNC,".matches("));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"foo"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,".*"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  FilterPredicate fp=new FilterPredicate("foo",".*");
  assertEquals(fp,p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse() throws InvalidQueryException {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"foo"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"bar"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.BRACKET_OPEN,"("));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"<"));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"1"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.BRACKET_OPEN,"("));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"<="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"b"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"2"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"|"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,">"));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"c"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"3"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,">="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"d"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"100"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"|"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"!="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"e"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"5"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"&"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_UNARY_OPERATOR,"!"));
  listTokens.add(new Token(Token.TYPE.BRACKET_OPEN,"("));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"f"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"6"));
  listTokens.add(new Token(Token.TYPE.LOGICAL_OPERATOR,"|"));
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"g"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"7"));
  listTokens.add(new Token(Token.TYPE.BRACKET_CLOSE,")"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  EqualsPredicate<String> fooPred=new EqualsPredicate<String>("foo","bar");
  LessPredicate<String> aPred=new LessPredicate<String>("a","1");
  LessEqualsPredicate<String> bPred=new LessEqualsPredicate<String>("b","2");
  GreaterEqualsPredicate<String> cPred=new GreaterEqualsPredicate<String>("c","3");
  GreaterEqualsPredicate<String> dPred=new GreaterEqualsPredicate<String>("d","100");
  NotPredicate ePred=new NotPredicate(new EqualsPredicate<String>("e","5"));
  EqualsPredicate fPred=new EqualsPredicate<String>("f","6");
  EqualsPredicate gPRed=new EqualsPredicate<String>("g","7");
  OrPredicate bORcPred=new OrPredicate(bPred,cPred);
  AndPredicate aANDbORcPred=new AndPredicate(aPred,bORcPred);
  AndPredicate aANDbORcANDdPred=new AndPredicate(aANDbORcPred,dPred);
  AndPredicate fooANDaANDbORcANDdPred=new AndPredicate(fooPred,aANDbORcANDdPred);
  OrPredicate fORgPred=new OrPredicate(fPred,gPRed);
  NotPredicate NOTfORgPred=new NotPredicate(fORgPred);
  AndPredicate eANDNOTfORgPred=new AndPredicate(ePred,NOTfORgPred);
  OrPredicate rootPredicate=new OrPredicate(fooANDaANDbORcANDdPred,eANDNOTfORgPred);
  assertEquals(rootPredicate,p);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_simple() throws Exception {
  List<Token> listTokens=new ArrayList<Token>();
  listTokens.add(new Token(Token.TYPE.RELATIONAL_OPERATOR,"="));
  listTokens.add(new Token(Token.TYPE.PROPERTY_OPERAND,"a"));
  listTokens.add(new Token(Token.TYPE.VALUE_OPERAND,"b"));
  QueryParser parser=new QueryParser();
  Predicate p=parser.parse(listTokens.toArray(new Token[listTokens.size()]));
  assertEquals(new EqualsPredicate<String>("a","b"),p);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.QueryImplTest </h4><pre class="type-4 type-13 type-10 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJoinedResourceProperties() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("versions/*",null);
  instance.addProperty("versions/operating_systems/*",null);
  instance.addProperty("versions/operating_systems/repositories/*",null);
  instance.execute();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("versions/operating_systems/repositories/Repositories/repo_id");
  propertyIds.add("versions/operating_systems/OperatingSystems/os_type");
  Map<Resource,Set<Map<String,Object>>> resourcePropertiesMap=instance.getJoinedResourceProperties(propertyIds,null,null);
  Set<Map<String,Object>> propertyMaps=null;
  for (  Map.Entry<Resource,Set<Map<String,Object>>> resourceSetEntry : resourcePropertiesMap.entrySet()) {
    Assert.assertEquals(Resource.Type.Stack,resourceSetEntry.getKey().getType());
    propertyMaps=resourceSetEntry.getValue();
  }
  if (propertyMaps == null) {
    fail("No property maps found!");
  }
  Assert.assertEquals(6,propertyMaps.size());
  for (  Map<String,Object> map : propertyMaps) {
    Assert.assertEquals(2,map.size());
    Assert.assertTrue(map.containsKey("versions/operating_systems/OperatingSystems/os_type"));
    Assert.assertTrue(map.containsKey("versions/operating_systems/repositories/Repositories/repo_id"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExecute__Host_collection_AlertsSummary() throws Exception {
  ResourceDefinition resourceDefinition=new HostResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  final AtomicInteger pageCallCount=new AtomicInteger(0);
  ClusterControllerImpl clusterControllerImpl=new ClusterControllerImpl(new ClusterControllerImplTest.TestProviderModule()){
    public PageResponse getPage(    Resource.Type type,    QueryResponse queryResponse,    Request request,    Predicate predicate,    PageRequest pageRequest,    SortRequest sortRequest) throws UnsupportedPropertyException, SystemException, NoSuchResourceException, NoSuchParentResourceException {
      pageCallCount.incrementAndGet();
      return super.getPage(type,queryResponse,request,predicate,pageRequest,sortRequest);
    }
  }
;
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition,clusterControllerImpl);
  pageCallCount.set(0);
  Result result=instance.execute();
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  Assert.assertEquals(1,pageCallCount.get());
  pageCallCount.set(0);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("alerts_summary/CRITICAL").greaterThan(0).toPredicate();
  instance.setUserPredicate(predicate);
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(2,tree.getChildren().size());
  Assert.assertEquals(2,pageCallCount.get());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals("host:0",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","CRITICAL")));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals("host:2",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","CRITICAL")));
  pageCallCount.set(0);
  pb=new PredicateBuilder();
  predicate=pb.property("alerts_summary/WARNING").greaterThan(0).toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(new PageRequestImpl(PageRequest.StartingPoint.Beginning,1,0,null,null));
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(1,tree.getChildren().size());
  Assert.assertEquals(2,pageCallCount.get());
  hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals("host:1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertEquals("1",hostNode.getObject().getPropertyValue(PropertyHelper.getPropertyId("alerts_summary","WARNING")));
  pageCallCount.set(0);
  pb=new PredicateBuilder();
  predicate=pb.property("alerts_summary/WARNING").greaterThan(0).or().property("host_components/HostRoles/component_name").equals("DATANODE").toPredicate();
  instance.setUserPredicate(predicate);
  instance.setPageRequest(null);
  result=instance.execute();
  tree=result.getResultTree();
  Assert.assertEquals(0,tree.getChildren().size());
  Assert.assertEquals(6,pageCallCount.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.ClusterBlueprintRendererTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResultWithAttributes() throws Exception {
  ServiceInfo hdfsService=new ServiceInfo();
  hdfsService.setName("HDFS");
  ServiceInfo mrService=new ServiceInfo();
  mrService.setName("MAPREDUCE");
  Result result=new ResultImpl(true);
  Map<String,Object> testDesiredConfigMap=new HashMap<String,Object>();
  DesiredConfig testDesiredConfig=new DesiredConfig();
  testDesiredConfig.setTag("test-tag-one");
  testDesiredConfigMap.put("test-type-one",testDesiredConfig);
  createClusterResultTree(result.getResultTree(),testDesiredConfigMap);
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Collection<Map<String,Object>> host_groups=(Collection<Map<String,Object>>)properties.get("").get("host_groups");
  assertEquals(2,host_groups.size());
  for (  Map<String,Object> hostGroupProperties : host_groups) {
    String host_group_name=(String)hostGroupProperties.get("name");
    if (host_group_name.equals("host_group_1")) {
      assertEquals("1",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(5,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("JOBTRACKER","TASKTRACKER","NAMENODE","DATANODE","AMBARI_SERVER"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
 else     if (host_group_name.equals("host_group_2")) {
      assertEquals("2",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(2,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("TASKTRACKER","DATANODE"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
  }
  List<Map<String,Map<String,Map<String,?>>>> configurationsResult=(List<Map<String,Map<String,Map<String,?>>>>)blueprintResource.getPropertyValue("configurations");
  assertEquals("Incorrect number of config maps added",1,configurationsResult.size());
  Map<String,Map<String,?>> configMap=configurationsResult.iterator().next().get("test-type-one");
  assertNotNull("Expected config map was not included",configMap);
  assertEquals("Incorrect number of maps added under expected type",2,configMap.size());
  assertTrue("Expected properties map was not found",configMap.containsKey("properties"));
  assertTrue("Expected properties_attributes map was not found",configMap.containsKey("properties_attributes"));
  Map<String,?> propertiesResult=configMap.get("properties");
  assertEquals("Incorrect number of config properties found",1,propertiesResult.size());
  Map<String,?> attributesResult=configMap.get("properties_attributes");
  assertEquals("Incorrect number of config attributes found",1,attributesResult.size());
  assertEquals("Incorrect property value included","valueOne",propertiesResult.get("propertyOne"));
  assertNotNull("Expected attribute not found in exported Blueprint",attributesResult.get("final"));
  assertTrue("Attribute type map was not included",attributesResult.get("final") instanceof Map);
  Map<String,?> finalMap=(Map<String,?>)attributesResult.get("final");
  assertEquals("Attribute value is not correct","true",finalMap.get("propertyOne"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult() throws Exception {
  Result result=new ResultImpl(true);
  createClusterResultTree(result.getResultTree());
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Collection<Map<String,Object>> host_groups=(Collection<Map<String,Object>>)properties.get("").get("host_groups");
  assertEquals(2,host_groups.size());
  for (  Map<String,Object> hostGroupProperties : host_groups) {
    String host_group_name=(String)hostGroupProperties.get("name");
    if (host_group_name.equals("host_group_1")) {
      assertEquals("1",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(5,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("JOBTRACKER","TASKTRACKER","NAMENODE","DATANODE","AMBARI_SERVER"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
 else     if (host_group_name.equals("host_group_2")) {
      assertEquals("2",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(2,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("TASKTRACKER","DATANODE"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult_kerberos() throws Exception {
  setupMocksForKerberosEnabledCluster();
  Result result=new ResultImpl(true);
  createClusterResultTree(result.getResultTree());
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Map<String,Object> securityProperties=(Map<String,Object>)properties.get("Blueprints").get("security");
  assertEquals("KERBEROS",securityProperties.get("type"));
  assertNotNull(((Map<String,Object>)securityProperties.get("kerberos_descriptor")).get("properties"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.FeedResourceDefinitionTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  FeedResourceDefinition definition=new FeedResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=definition.getSubResourceDefinitions();
  Assert.assertEquals(1,subResourceDefinitions.size());
  SubResourceDefinition subResourceDefinition=subResourceDefinitions.iterator().next();
  Assert.assertEquals(Resource.Type.DRInstance,subResourceDefinition.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.JobResourceDefinitionTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  JobResourceDefinition definition=new JobResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=definition.getSubResourceDefinitions();
  Assert.assertEquals(1,subResourceDefinitions.size());
  SubResourceDefinition subResourceDefinition=subResourceDefinitions.iterator().next();
  Assert.assertEquals(Resource.Type.TaskAttempt,subResourceDefinition.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.RepositoryVersionResourceDefinitionTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  final RepositoryVersionResourceDefinition resourceDefinition=new RepositoryVersionResourceDefinition();
  final Set<SubResourceDefinition> subResourceDefinitions=resourceDefinition.getSubResourceDefinitions();
  final Iterator<SubResourceDefinition> iterator=subResourceDefinitions.iterator();
  Assert.assertEquals(Resource.Type.OperatingSystem,iterator.next().getType());
  Assert.assertEquals(1,subResourceDefinitions.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.WorkflowResourceDefinitionTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  WorkflowResourceDefinition definition=new WorkflowResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=definition.getSubResourceDefinitions();
  Assert.assertEquals(1,subResourceDefinitions.size());
  SubResourceDefinition subResourceDefinition=subResourceDefinitions.iterator().next();
  Assert.assertEquals(Resource.Type.Job,subResourceDefinition.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.AmbariMetaInfoTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedBaseUrl() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  Capture<MetainfoEntity> c=new Capture<MetainfoEntity>();
  metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  reset(entity);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(metainfoDAO.merge(EasyMock.capture(c))).andReturn(entity).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,prevBaseUrl);
  assertEquals(prevBaseUrl,c.getValue().getMetainfoValue());
  assertTrue(repoInfo.isBaseUrlFromSaved());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
      assertEquals(ri.getBaseUrl(),ri.getLatestBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHive134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HIVE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("HIVE_METASTORE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_SERVER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(1,dependencyList.size());
      DependencyInfo dependency=dependencyList.get(0);
      Assert.assertEquals("ZOOKEEPER/ZOOKEEPER_SERVER",dependency.getName());
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("MYSQL_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaInfoFileFilter() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  File stackRoot=new File("src/test/resources/stacks");
  File version=new File("src/test/resources/version");
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot=new File(ClassLoader.getSystemClassLoader().getResource("stacks").getPath());
    version=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"version");
  }
  File stackRootTmp=new File(buildDir + "/ambari-metaInfo");
  stackRootTmp.mkdir();
  FileUtils.copyDirectory(stackRoot,stackRootTmp);
  AmbariMetaInfo ambariMetaInfo=createAmbariMetaInfo(stackRootTmp,version);
  File f1, f2, f3;
  f1=new File(stackRootTmp.getAbsolutePath() + "/001.svn");
  f1.createNewFile();
  f2=new File(stackRootTmp.getAbsolutePath() + "/abcd.svn/001.svn");
  f2.mkdirs();
  f2.createNewFile();
  f3=new File(stackRootTmp.getAbsolutePath() + "/.svn");
  if (!f3.exists()) {
    f3.createNewFile();
  }
  ambariMetaInfo.init();
  getServices();
  getComponentsByService();
  Assert.assertNotNull(ambariMetaInfo.getStack("abcd.svn","001.svn"));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBadStack() throws Exception {
  File stackRoot=new File("src/test/resources/bad-stacks");
  File version=new File("src/test/resources/version");
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot=new File(ClassLoader.getSystemClassLoader().getResource("bad-stacks").getPath());
    version=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"version");
  }
  LOG.info("Stacks file " + stackRoot.getAbsolutePath());
  TestAmbariMetaInfo ambariMetaInfo=createAmbariMetaInfo(stackRoot,version);
  Assert.assertEquals(1,ambariMetaInfo.getStackManager().getStacks().size());
  Assert.assertEquals(false,ambariMetaInfo.getStackManager().getStack("HDP","0.1").isValid());
  Assert.assertEquals(2,ambariMetaInfo.getStackManager().getStack("HDP","0.1").getErrors().size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSqoop134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","SQOOP");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("SQOOP",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(2,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("0+",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPig134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","PIG");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("PIG",component.getName());
  Assert.assertEquals(0,component.getDependencies().size());
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("0+",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWebHCat134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","WEBHCAT");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("WEBHCAT_SERVER",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(4,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_SERVER")) {
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertEquals(true,autoDeploy.isEnabled());
      Assert.assertEquals("WEBHCAT/WEBHCAT_SERVER",autoDeploy.getCoLocate());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("1",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHue134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HUE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("HUE_SERVER",component.getName());
  Assert.assertEquals(0,component.getDependencies().size());
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("1",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChildCustomCommandScriptInheritance() throws Exception {
  ComponentInfo component=metaInfo.getComponent(STACK_NAME_HDP,"2.0.7","HDFS","NAMENODE");
  CustomCommandDefinition ccd=findCustomCommand("DECOMMISSION",component);
  Assert.assertEquals("scripts/namenode_dec.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_parent_command.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("REBALANCEHDFS",component);
  Assert.assertEquals("scripts/namenode.py",ccd.getCommandScript().getScript());
  Assert.assertTrue(ccd.isBackground());
  Assert.assertEquals(3,component.getCustomCommands().size());
  component=metaInfo.getComponent(STACK_NAME_HDP,"2.0.8","HDFS","NAMENODE");
  Assert.assertEquals(4,component.getCustomCommands().size());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_parent_command.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("DECOMMISSION",component);
  Assert.assertEquals("scripts/namenode_dec_overr.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_CHILD_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_child_command.py",ccd.getCommandScript().getScript());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceCustomCommandScriptInheritance() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"2.0.7","HDFS");
  CustomCommandDefinition ccd=findCustomCommand("RESTART",service);
  Assert.assertEquals("scripts/restart_parent.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_SRV_COMMAND",service);
  Assert.assertEquals("scripts/yet_another_parent_srv_command.py",ccd.getCommandScript().getScript());
  Assert.assertEquals(2,service.getCustomCommands().size());
  service=metaInfo.getService(STACK_NAME_HDP,"2.0.8","HDFS");
  Assert.assertEquals(3,service.getCustomCommands().size());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_SRV_COMMAND",service);
  Assert.assertEquals("scripts/yet_another_parent_srv_command.py",ccd.getCommandScript().getScript());
  service=metaInfo.getService(STACK_NAME_HDP,"2.0.8","HDFS");
  ccd=findCustomCommand("RESTART",service);
  Assert.assertEquals("scripts/restart_child.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_CHILD_SRV_COMMAND",service);
  Assert.assertEquals("scripts/yet_another_child_srv_command.py",ccd.getCommandScript().getScript());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetComponentDependencies() throws AmbariException {
  List<DependencyInfo> dependencies=metaInfo.getComponentDependencies("HDP","1.3.4","HBASE","HBASE_MASTER");
  assertEquals(2,dependencies.size());
  DependencyInfo dependency=dependencies.get(0);
  assertEquals("HDFS/HDFS_CLIENT",dependency.getName());
  assertEquals("HDFS_CLIENT",dependency.getComponentName());
  assertEquals("HDFS",dependency.getServiceName());
  assertEquals("host",dependency.getScope());
  dependency=dependencies.get(1);
  assertEquals("ZOOKEEPER/ZOOKEEPER_SERVER",dependency.getName());
  assertEquals("ZOOKEEPER_SERVER",dependency.getComponentName());
  assertEquals("ZOOKEEPER",dependency.getServiceName());
  assertEquals("cluster",dependency.getScope());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(ri.getBaseUrl(),ri.getDefaultBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedUtilsBaseUrl() throws Exception {
  String stackVersion="0.2";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP-Utils/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/0.2/redhat6/HDP-UTILS-1.1.0.15:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,stackVersion,"redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_UTILS_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetUpdatedBaseUrl() throws Exception {
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.updateRepoBaseURL("HDP","2.1.1","redhat6","HDP-2.1.1",newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1");
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getDefaultBaseUrl().equals(ri.getBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1",prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertsJson() throws Exception {
  ServiceInfo svc=metaInfo.getService(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.6","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNull(svc.getAlertsFile());
  Set<AlertDefinition> set=metaInfo.getAlertDefinitions(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(set);
  Assert.assertTrue(set.size() > 0);
  AlertDefinition nameNodeProcess=null;
  AlertDefinition nameNodeCpu=null;
  AlertDefinition datanodeStorage=null;
  AlertDefinition ignoreHost=null;
  Iterator<AlertDefinition> iterator=set.iterator();
  while (iterator.hasNext()) {
    AlertDefinition definition=iterator.next();
    if (definition.getName().equals("namenode_process")) {
      nameNodeProcess=definition;
    }
    if (definition.getName().equals("namenode_cpu")) {
      nameNodeCpu=definition;
    }
    if (definition.getName().equals("datanode_storage")) {
      datanodeStorage=definition;
    }
    if (definition.getName().equals("hdfs_ignore_host_test")) {
      ignoreHost=definition;
    }
  }
  assertNotNull(nameNodeProcess);
  assertNotNull(nameNodeCpu);
  assertNotNull(ignoreHost);
  assertEquals("NameNode Host CPU Utilization",nameNodeCpu.getLabel());
  assertFalse(nameNodeProcess.isHostIgnored());
  assertEquals("A description of namenode_process",nameNodeProcess.getDescription());
  Source source=nameNodeProcess.getSource();
  assertNotNull(source);
  assertNotNull(((PortSource)source).getPort());
  Reporting reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNull(reporting.getCritical().getValue());
  assertNull(reporting.getWarning());
  assertFalse(nameNodeCpu.isHostIgnored());
  assertEquals("A description of namenode_cpu",nameNodeCpu.getDescription());
  source=nameNodeCpu.getSource();
  assertNotNull(source);
  reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNotNull(reporting.getCritical().getValue());
  assertNotNull(reporting.getWarning());
  assertNotNull(reporting.getWarning().getText());
  assertNotNull(reporting.getWarning().getValue());
  assertNotNull(datanodeStorage);
  assertEquals("A description of datanode_storage",datanodeStorage.getDescription());
  assertFalse(datanodeStorage.isHostIgnored());
  MetricSource metricSource=(MetricSource)datanodeStorage.getSource();
  assertNotNull(metricSource.getUri());
  assertNotNull(metricSource.getUri().getHttpsProperty());
  assertNotNull(metricSource.getUri().getHttpsPropertyValue());
  assertNotNull(metricSource.getUri().getHttpsUri());
  assertNotNull(metricSource.getUri().getHttpUri());
  assertEquals(12345,metricSource.getUri().getDefaultPort());
  assertTrue(ignoreHost.isHostIgnored());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.BaseRequestTest </h4><pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_noBody_ErrorStateResult() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(true).anyTimes();
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testProcess_QueryInURI() throws Exception {
  HttpHeaders headers=createNiceMock(HttpHeaders.class);
  String path=URLEncoder.encode("http://localhost.com:8080/api/v1/clusters/c1","UTF-8");
  String query=URLEncoder.encode("foo=foo-value&bar=bar-value","UTF-8");
  URI uri=new URI(path + "?" + query);
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  Predicate predicate=createNiceMock(Predicate.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(headers,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn(null);
  expect(compiler.compile("foo=foo-value&bar=bar-value")).andReturn(predicate);
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  Result processResult=request.process();
  verify(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  assertSame(processResult,result);
  assertSame(predicate,request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetResource(){
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  Request request=getTestRequest(null,null,null,null,null,null,resource);
  assertSame(resource,request.getResource());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_WithBody_InvalidQuery() throws Exception {
  UriInfo uriInfo=createMock(UriInfo.class);
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  RequestBody body=createNiceMock(RequestBody.class);
  Exception exception=new InvalidQueryException("test");
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,null,null,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn("blahblahblah");
  expect(compiler.compile("blahblahblah")).andThrow(exception);
  replay(compiler,uriInfo,queryParams,resource,resourceDefinition,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,queryParams,resource,resourceDefinition,body);
  assertEquals(400,processResult.getStatus().getStatusCode());
  assertTrue(processResult.getStatus().isErrorState());
  assertEquals("Unable to compile query predicate: test",processResult.getStatus().getMessage());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testProcess_withDirectives() throws Exception {
  HttpHeaders headers=createNiceMock(HttpHeaders.class);
  String path=URLEncoder.encode("http://localhost.com:8080/api/v1/clusters/c1","UTF-8");
  String query=URLEncoder.encode("foo=foo-value&bar=bar-value","UTF-8");
  URI uri=new URI(path + "?" + query);
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  Predicate predicate=createNiceMock(Predicate.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Set<String> directives=new HashSet<String>();
  directives.add("my_directive");
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(headers,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getUpdateDirectives()).andReturn(directives).anyTimes();
  expect(resourceDefinition.getCreateDirectives()).andReturn(directives).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn(null);
  if (request.getRequestType().equals(Request.Type.POST) || request.getRequestType().equals(Request.Type.PUT)) {
    expect(compiler.compile("foo=foo-value&bar=bar-value",directives)).andReturn(predicate);
  }
 else {
    expect(compiler.compile("foo=foo-value&bar=bar-value")).andReturn(predicate);
  }
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  Result processResult=request.process();
  verify(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  assertSame(processResult,result);
  assertSame(predicate,request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testProcess_QueryInBody() throws Exception {
  HttpHeaders headers=createNiceMock(HttpHeaders.class);
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  Predicate predicate=createNiceMock(Predicate.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(headers,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn("foo=bar");
  expect(compiler.compile("foo=bar")).andReturn(predicate);
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  Result processResult=request.process();
  verify(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  assertSame(processResult,result);
  assertSame(predicate,request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testParseRenderer_formatSpecified() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn("default");
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer("default")).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(renderer,request.getRenderer());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testProcess_QueryInBodyAndURI() throws Exception {
  HttpHeaders headers=createNiceMock(HttpHeaders.class);
  String uriString="http://localhost.com:8080/api/v1/clusters/c1?bar=value";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  Predicate predicate=createNiceMock(Predicate.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(headers,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn("foo=bar");
  expect(compiler.compile("foo=bar")).andReturn(predicate);
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  Result processResult=request.process();
  verify(headers,compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,predicate,body);
  assertSame(processResult,result);
  assertSame(predicate,request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testParseRenderer_minimalResponse() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new MinimalRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn("true");
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer("minimal")).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(renderer,request.getRenderer());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFields() throws Exception {
  String fields="prop,category/prop1,category2/category3/prop2[1,2,3],prop3[4,5,6],category4[7,8,9],sub-resource/*[10,11,12],finalProp";
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> mapQueryParams=createMock(MultivaluedMap.class);
  expect(uriInfo.getQueryParameters()).andReturn(mapQueryParams);
  expect(mapQueryParams.getFirst("fields")).andReturn(fields);
  replay(uriInfo,mapQueryParams);
  Request request=getTestRequest(null,null,uriInfo,null,null,null,null);
  Map<String,TemporalInfo> mapFields=request.getFields();
  assertEquals(7,mapFields.size());
  String prop="prop";
  assertTrue(mapFields.containsKey(prop));
  assertNull(mapFields.get(prop));
  String prop1=PropertyHelper.getPropertyId("category","prop1");
  assertTrue(mapFields.containsKey(prop1));
  assertNull(mapFields.get(prop1));
  String prop2=PropertyHelper.getPropertyId("category2/category3","prop2");
  assertTrue(mapFields.containsKey(prop2));
  assertEquals(new TemporalInfoImpl(1,2,3),mapFields.get(prop2));
  String prop3="prop3";
  assertTrue(mapFields.containsKey(prop3));
  assertEquals(new TemporalInfoImpl(4,5,6),mapFields.get(prop3));
  String category4="category4";
  assertTrue(mapFields.containsKey(category4));
  assertEquals(new TemporalInfoImpl(7,8,9),mapFields.get(category4));
  String subResource=PropertyHelper.getPropertyId("sub-resource","*");
  assertTrue(mapFields.containsKey(subResource));
  assertEquals(new TemporalInfoImpl(10,11,12),mapFields.get(subResource));
  String finalProp="finalProp";
  assertTrue(mapFields.containsKey(finalProp));
  assertNull(mapFields.get(finalProp));
  verify(uriInfo,mapQueryParams);
}

</code></pre>

<br>
<pre class="type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetHttpHeaders(){
  HttpHeaders headers=createNiceMock(HttpHeaders.class);
  MultivaluedMap<String,String> mapHeaders=new MultivaluedMapImpl();
  Request request=getTestRequest(headers,null,null,null,null,null,null);
  expect(headers.getRequestHeaders()).andReturn(mapHeaders);
  replay(headers);
  assertSame(mapHeaders,request.getHttpHeaders());
  verify(headers);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_WithBody() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition);
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  expect(body.getQueryString()).andReturn(null);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetBody(){
  RequestBody body=createNiceMock(RequestBody.class);
  Request request=getTestRequest(null,body,null,null,null,null,null);
  assertSame(body,request.getBody());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_noBody() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition);
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.PersistKeyValueImplTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStore() throws Exception {
  PersistKeyValueImpl impl=injector.getInstance(PersistKeyValueImpl.class);
  Map<String,String> map=impl.getAllKeyValues();
  assertEquals(0,map.size());
  impl.put("key1","value1");
  impl.put("key2","value2");
  map=impl.getAllKeyValues();
  assertEquals(2,map.size());
  assertEquals("value1",impl.getValue("key1"));
  assertEquals("value2",impl.getValue("key2"));
  assertEquals(map.get("key1"),impl.getValue("key1"));
  impl.put("key1","value1-2");
  assertEquals("value1-2",impl.getValue("key1"));
  assertEquals(2,map.size());
  StringBuilder largeValueBuilder=new StringBuilder();
  for (int i=0; i < 320; i++) {
    largeValueBuilder.append("0123456789");
  }
  String largeValue=largeValueBuilder.toString();
  impl.put("key3",largeValue);
  assertEquals(largeValue,impl.getValue("key3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.PersistServiceTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPersist() throws UniformInterfaceException, JSONException, IOException {
  ClientConfig clientConfig=new DefaultClientConfig();
  clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
  client=Client.create(clientConfig);
  WebResource webResource=client.resource(String.format("http://localhost:%d/persist",getTestPort()));
  webResource.post("{\"xyx\" : \"t\"}");
  LOG.info("Done posting to the server");
  String output=webResource.get(String.class);
  LOG.info("All key values " + output);
  Map<String,String> jsonOutput=StageUtils.fromJson(output,Map.class);
  String value=jsonOutput.get("xyx");
  Assert.assertEquals("t",value);
  webResource=client.resource(String.format("http://localhost:%d/persist/xyx",getTestPort()));
  output=webResource.get(String.class);
  Assert.assertEquals("t",output);
  LOG.info("Value for xyx " + output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.ViewSubResourceServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResultSerializer_Json() throws Exception {
  UriInfo uriInfo=createMock(UriInfo.class);
  Resource resource=createMock(Resource.class);
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  TreeNode<Resource> child=tree.addChild(resource,"resource1");
  child.setProperty("href","this is an href");
  HashMap<String,Object> mapRootProps=new HashMap<String,Object>();
  mapRootProps.put("prop1","value1");
  mapRootProps.put("prop2","value2");
  HashMap<String,Object> mapCategoryProps=new HashMap<String,Object>();
  mapCategoryProps.put("catProp1","catValue1");
  mapCategoryProps.put("catProp2","catValue2");
  Map<String,Map<String,Object>> propertyMap=new HashMap<String,Map<String,Object>>();
  propertyMap.put(null,mapRootProps);
  propertyMap.put("category",mapCategoryProps);
  expect(resource.getPropertiesMap()).andReturn(propertyMap).anyTimes();
  expect(resource.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(uriInfo,resource);
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  Resource.Type type=new Resource.Type("subResource");
  ViewSubResourceService service=new ViewSubResourceService(type,viewInstanceEntity);
  ResultSerializer serializer=service.getResultSerializer(MediaType.APPLICATION_JSON_TYPE);
  Object o=serializer.serialize(result);
  assertTrue(o instanceof Map);
  Map map=(Map)o;
  assertEquals(4,map.size());
  assertEquals("value1",map.get("prop1"));
  assertEquals("value2",map.get("prop2"));
  assertEquals("this is an href",map.get("href"));
  Object o2=map.get("category");
  assertNotNull(o2);
  assertTrue(o2 instanceof Map);
  Map subMap=(Map)o2;
  assertEquals(2,subMap.size());
  assertEquals("catValue1",subMap.get("catProp1"));
  assertEquals("catValue2",subMap.get("catProp2"));
  verify(uriInfo,resource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.parsers.JsonRequestBodyParserTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse_MultiBody() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  Set<RequestBody> bodySet=parser.parse(multiBody);
  assertEquals(2,bodySet.size());
  for (  RequestBody body : bodySet) {
    Set<NamedPropertySet> setProps=body.getNamedPropertySets();
    assertEquals(1,setProps.size());
    Map<String,Object> mapProps=setProps.iterator().next().getProperties();
    assertEquals(4,mapProps.size());
    assertEquals("global",mapProps.get("Hosts/desired_config/type"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestBlobProperties() throws Exception {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(bodyWithRequestBlobProperties).iterator().next();
  Set<NamedPropertySet> setProps=body.getNamedPropertySets();
  assertEquals(1,setProps.size());
  String requestBlob=null;
  for (  NamedPropertySet ps : setProps) {
    assertEquals("",ps.getName());
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      if (entry.getKey().equals(JsonRequestBodyParser.REQUEST_BLOB_TITLE)) {
        requestBlob=(String)entry.getValue();
      }
    }
  }
  Assert.assertNotNull(requestBlob);
  body=parser.parse(requestBlob).iterator().next();
  Map<String,Object> mapExpected=new HashMap<String,Object>();
  mapExpected.put(PropertyHelper.getPropertyId("Services","service_name"),"HDFS");
  mapExpected.put(PropertyHelper.getPropertyId("Services","display_name"),"HDFS");
  mapExpected.put(PropertyHelper.getPropertyId("ServiceInfo","cluster_name"),"tbmetrictest");
  mapExpected.put(PropertyHelper.getPropertyId("Services","description"),"Apache Hadoop Distributed File System");
  mapExpected.put(PropertyHelper.getPropertyId("ServiceInfo","state"),"STARTED");
  mapExpected.put(PropertyHelper.getPropertyId("OuterCategory","propName"),"100");
  mapExpected.put(PropertyHelper.getPropertyId("OuterCategory/nested1/nested2","innerPropName"),"innerPropValue");
  mapExpected.put(PropertyHelper.getPropertyId(null,"topLevelProp"),"value");
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(mapExpected,setProps2.iterator().next().getProperties());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.serializers.CsvSerializerTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializeResources_NoColumnInfo() throws Exception {
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  List<TreeMap<String,Object>> data=new ArrayList<TreeMap<String,Object>>(){
{
      add(new TreeMap<String,Object>(){
{
          put("property1","value1a");
          put("property2","value2a");
          put("property3","value3a");
          put("property4","value4a");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1'b");
          put("property2","value2'b");
          put("property3","value3'b");
          put("property4","value4'b");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1,c");
          put("property2","value2,c");
          put("property3","value3,c");
          put("property4","value4,c");
        }
      }
);
    }
  }
;
  tree.setName("items");
  tree.setProperty("isCollection","true");
  addChildResource(tree,"resource",0,data.get(0));
  addChildResource(tree,"resource",1,data.get(1));
  addChildResource(tree,"resource",2,data.get(2));
  replayAll();
  Object o=new CsvSerializer().serialize(result).toString().replace("\r","");
  verifyAll();
  assertNotNull(o);
  StringReader reader=new StringReader(o.toString());
  CSVParser csvParser=new CSVParser(reader,CSVFormat.DEFAULT);
  List<CSVRecord> records=csvParser.getRecords();
  assertNotNull(records);
  assertEquals(3,records.size());
  int i=0;
  for (  CSVRecord record : records) {
    TreeMap<String,Object> actualData=data.get(i++);
    assertEquals(actualData.size(),record.size());
    for (    String item : record) {
      assertTrue(actualData.containsValue(item));
    }
  }
  csvParser.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorHelperTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("unchecked") public void testValidate_returnsCommandResult() throws StackAdvisorException, IOException {
  Configuration configuration=mock(Configuration.class);
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorHelper helper=spy(new StackAdvisorHelper(configuration,saRunner,metaInfo));
  StackAdvisorCommand<ValidationResponse> command=mock(StackAdvisorCommand.class);
  ValidationResponse expected=mock(ValidationResponse.class);
  StackAdvisorRequestType requestType=StackAdvisorRequestType.HOST_GROUPS;
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").ofType(requestType).build();
  when(command.invoke(request)).thenReturn(expected);
  doReturn(command).when(helper).createValidationCommand(requestType);
  ValidationResponse response=helper.validate(request);
  assertEquals(expected,response);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRecommend_returnsCommandResult() throws StackAdvisorException, IOException {
  Configuration configuration=mock(Configuration.class);
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorHelper helper=spy(new StackAdvisorHelper(configuration,saRunner,metaInfo));
  StackAdvisorCommand<RecommendationResponse> command=mock(StackAdvisorCommand.class);
  RecommendationResponse expected=mock(RecommendationResponse.class);
  StackAdvisorRequestType requestType=StackAdvisorRequestType.HOST_GROUPS;
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").ofType(requestType).build();
  when(command.invoke(request)).thenReturn(expected);
  doReturn(command).when(helper).createRecommendationCommand(requestType);
  RecommendationResponse response=helper.recommend(request);
  assertEquals(expected,response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorRequestTypeTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromString_returnsHostGroupType() throws StackAdvisorException {
  String text="host_groups";
  StackAdvisorRequestType type=StackAdvisorRequestType.fromString(text);
  assertEquals(type,StackAdvisorRequestType.HOST_GROUPS);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromString_returnsConfigurationsType() throws StackAdvisorException {
  String text="configurations";
  StackAdvisorRequestType type=StackAdvisorRequestType.fromString(text);
  assertEquals(type,StackAdvisorRequestType.CONFIGURATIONS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.ConfigurationRecommendationCommandTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessHostGroups() throws Exception {
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  File file=mock(File.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  ConfigurationRecommendationCommand command=new ConfigurationRecommendationCommand(file,"script",1,saRunner,metaInfo);
  StackAdvisorRequest request=mock(StackAdvisorRequest.class);
  Map<String,Set<String>> componentHostGroupMap=new HashMap<String,Set<String>>();
  Set<String> components1=new HashSet<String>();
  components1.add("component1");
  components1.add("component4");
  components1.add("component5");
  componentHostGroupMap.put("group1",components1);
  Set<String> components2=new HashSet<String>();
  components2.add("component2");
  components2.add("component3");
  componentHostGroupMap.put("group2",components2);
  doReturn(componentHostGroupMap).when(request).getHostComponents();
  Set<RecommendationResponse.HostGroup> hostGroups=command.processHostGroups(request);
  assertNotNull(hostGroups);
  assertEquals(2,hostGroups.size());
  Map<String,RecommendationResponse.HostGroup> hostGroupMap=new HashMap<String,RecommendationResponse.HostGroup>();
  for (  RecommendationResponse.HostGroup hostGroup : hostGroups) {
    hostGroupMap.put(hostGroup.getName(),hostGroup);
  }
  RecommendationResponse.HostGroup hostGroup1=hostGroupMap.get("group1");
  assertNotNull(hostGroup1);
  Set<Map<String,String>> host1Components=hostGroup1.getComponents();
  assertNotNull(host1Components);
  assertEquals(3,host1Components.size());
  Set<String> componentNames1=new HashSet<String>();
  for (  Map<String,String> host1Component : host1Components) {
    assertNotNull(host1Component);
    assertEquals(1,host1Component.size());
    String componentName=host1Component.get("name");
    assertNotNull(componentName);
    componentNames1.add(componentName);
  }
  assertEquals(3,componentNames1.size());
  assertTrue(componentNames1.contains("component1"));
  assertTrue(componentNames1.contains("component4"));
  assertTrue(componentNames1.contains("component5"));
  RecommendationResponse.HostGroup hostGroup2=hostGroupMap.get("group2");
  assertNotNull(hostGroup2);
  Set<Map<String,String>> host2Components=hostGroup2.getComponents();
  assertNotNull(host2Components);
  assertEquals(2,host2Components.size());
  Set<String> componentNames2=new HashSet<String>();
  for (  Map<String,String> host2Component : host2Components) {
    assertNotNull(host2Component);
    assertEquals(1,host2Component.size());
    String componentName=host2Component.get("name");
    assertNotNull(componentName);
    componentNames2.add(componentName);
  }
  assertEquals(2,componentNames2.size());
  assertTrue(componentNames2.contains("component2"));
  assertTrue(componentNames2.contains("component3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.StackAdvisorCommandTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInvoke_success() throws StackAdvisorException {
  String expected="success";
  final String testResourceString=String.format("{\"type\": \"%s\"}",expected);
  final File recommendationsDir=temp.newFolder("recommendationDir");
  String stackAdvisorScript="echo";
  final int requestId=2;
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  doReturn(Collections.emptyList()).when(metaInfo).getStackParentVersions(anyString(),anyString());
  final StackAdvisorCommand<TestResource> command=spy(new TestStackAdvisorCommand(recommendationsDir,stackAdvisorScript,requestId,saRunner,metaInfo));
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").build();
  String hostsJSON="{\"hosts\" : \"localhost\"";
  String servicesJSON="{\"services\" : \"HDFS\"";
  StackAdvisorData data=new StackAdvisorData(hostsJSON,servicesJSON);
  doReturn(hostsJSON).when(command).getHostsInformation(request);
  doReturn(servicesJSON).when(command).getServicesInformation(request);
  doReturn(data).when(command).adjust(any(StackAdvisorData.class),any(StackAdvisorRequest.class));
  doAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation) throws Throwable {
      String resultFilePath=String.format("%s/%s",requestId,command.getResultFileName());
      File resultFile=new File(recommendationsDir,resultFilePath);
      resultFile.getParentFile().mkdirs();
      FileUtils.writeStringToFile(resultFile,testResourceString);
      return null;
    }
  }
).when(saRunner).runScript(any(String.class),any(StackAdvisorCommandType.class),any(File.class));
  TestResource result=command.invoke(request);
  assertEquals(expected,result.getType());
  assertEquals(requestId,result.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariCustomCommandExecutionHelperTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testRefreshQueueCustomCommand() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put(REQUEST_CONTEXT_PROPERTY,"Refresh YARN Capacity Scheduler");
      put("command","REFRESHQUEUES");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","REFRESHQUEUES",new HashMap<String,String>(){
{
      put("forceRefreshConfigTags","capacity-scheduler");
    }
  }
,false);
  actionRequest.getResourceFilters().add(new RequestResourceFilter("YARN","RESOURCEMANAGER",Collections.singletonList("c6401")));
  controller.createAction(actionRequest,requestProperties);
  Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
  Request request=requestCapture.getValue();
  Assert.assertNotNull(request);
  Assert.assertNotNull(request.getStages());
  Assert.assertEquals(1,request.getStages().size());
  Stage stage=request.getStages().iterator().next();
  Assert.assertEquals(1,stage.getHosts().size());
  List<ExecutionCommandWrapper> commands=stage.getExecutionCommands("c6401");
  Assert.assertEquals(1,commands.size());
  ExecutionCommand command=commands.get(0).getExecutionCommand();
  Assert.assertNotNull(command.getForceRefreshConfigTags());
  Assert.assertEquals(1,command.getForceRefreshConfigTags().size());
  Assert.assertEquals("capacity-scheduler",command.getForceRefreshConfigTags().iterator().next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariHandlerListTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddViewInstance() throws Exception {
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  final WebAppContext handler=createNiceMock(WebAppContext.class);
  Server server=createNiceMock(Server.class);
  expect(handler.getServer()).andReturn(server);
  handler.setServer(null);
  Capture<FilterHolder> securityHeaderFilterCapture=new Capture<FilterHolder>();
  Capture<FilterHolder> persistFilterCapture=new Capture<FilterHolder>();
  Capture<FilterHolder> securityFilterCapture=new Capture<FilterHolder>();
  handler.addFilter(capture(securityHeaderFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.addFilter(capture(persistFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.addFilter(capture(securityFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.setAllowNullPathInfo(true);
  replay(handler,server);
  AmbariHandlerList handlerList=getAmbariHandlerList(handler);
  handlerList.addViewInstance(viewInstanceEntity);
  ArrayList<Handler> handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertTrue(handlers.contains(handler));
  Assert.assertEquals(ambariViewsSecurityHeaderFilter,securityHeaderFilterCapture.getValue().getFilter());
  Assert.assertEquals(persistFilter,persistFilterCapture.getValue().getFilter());
  Assert.assertEquals(springSecurityFilter,securityFilterCapture.getValue().getFilter());
  verify(handler,server);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveViewInstance() throws Exception {
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  final WebAppContext handler=createNiceMock(WebAppContext.class);
  Server server=createNiceMock(Server.class);
  expect(handler.getServer()).andReturn(server);
  handler.setServer(null);
  replay(handler,server);
  AmbariHandlerList handlerList=getAmbariHandlerList(handler);
  handlerList.addViewInstance(viewInstanceEntity);
  ArrayList<Handler> handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertTrue(handlers.contains(handler));
  handlerList.removeViewInstance(viewInstanceEntity);
  handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertFalse(handlers.contains(handler));
  verify(handler,server);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerImplTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetClientHostForRunningAction_returnsHelathyHost() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  Map<String,ServiceComponentHost> hostMap=createNiceMock(Map.class);
  Set<String> hostsSet=createNiceMock(Set.class);
  expect(hostMap.isEmpty()).andReturn(false);
  expect(hostMap.keySet()).andReturn(hostsSet);
  expect(component.getServiceComponentHosts()).andReturn(hostMap).times(2);
  replay(cluster,service,component,injector,actionManager,hostMap,hostsSet);
  AmbariManagementControllerImpl controller=createMockBuilder(AmbariManagementControllerImpl.class).addMockedMethod("filterHostsForAction").addMockedMethod("getHealthyHost").withConstructor(actionManager,clusters,injector).createMock();
  expect(controller.getHealthyHost(hostsSet)).andReturn("healthy_host");
  controller.filterHostsForAction(hostsSet,service,cluster,Resource.Type.Cluster);
  expectLastCall().once();
  replay(controller);
  String host=controller.getClientHostForRunningAction(cluster,service,component);
  assertEquals("healthy_host",host);
  verify(controller,cluster,service,component,injector,hostMap);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHosts() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-0.2",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,"centos5");
  setupClusterWithHosts("c2","HDP-0.2",new ArrayList<String>(){
{
      add("h3");
    }
  }
,"centos5");
  clusters.addHost("h4");
  setOsFamily(clusters.getHost("h4"),"redhat","5.9");
  clusters.getHost("h4").persist();
  Map<String,String> attrs=new HashMap<String,String>();
  attrs.put("a1","b1");
  clusters.getHost("h3").setHostAttributes(attrs);
  attrs.put("a2","b2");
  clusters.getHost("h4").setHostAttributes(attrs);
  HostRequest r=new HostRequest(null,null,null);
  Set<HostResponse> resps=HostResourceProviderTest.getHosts(controller,Collections.singleton(r));
  Assert.assertEquals(4,resps.size());
  Set<String> foundHosts=new HashSet<String>();
  for (  HostResponse resp : resps) {
    foundHosts.add(resp.getHostname());
    if (resp.getHostname().equals("h1")) {
      Assert.assertEquals("c1",resp.getClusterName());
      Assert.assertEquals(2,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h2")) {
      Assert.assertEquals("c1",resp.getClusterName());
      Assert.assertEquals(2,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h3")) {
      Assert.assertEquals("c2",resp.getClusterName());
      Assert.assertEquals(3,resp.getHostAttributes().size());
    }
 else     if (resp.getHostname().equals("h4")) {
      Assert.assertEquals("",resp.getClusterName());
      Assert.assertEquals(4,resp.getHostAttributes().size());
    }
 else {
      fail("Found invalid host");
    }
  }
  Assert.assertEquals(4,foundHosts.size());
  r=new HostRequest("h1",null,null);
  resps=HostResourceProviderTest.getHosts(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  HostResponse resp=resps.iterator().next();
  Assert.assertEquals("h1",resp.getHostname());
  Assert.assertEquals("c1",resp.getClusterName());
  Assert.assertEquals(2,resp.getHostAttributes().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("HDP-0.1"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  ServiceRequest req=new ServiceRequest(clusterName,serviceName,null);
  Set<ServiceResponse> r=ServiceResourceProviderTest.getServices(controller,Collections.singleton(req));
  Assert.assertEquals(1,r.size());
  ServiceResponse resp=r.iterator().next();
  Assert.assertEquals(serviceName,resp.getServiceName());
  Assert.assertEquals(clusterName,resp.getClusterName());
  Assert.assertEquals(State.INIT.toString(),resp.getDesiredState());
  Assert.assertEquals("HDP-0.1",resp.getDesiredStackVersion());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testUpdateClusterVersionBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  String serviceName="MAPREDUCE";
  String host1="h1";
  String host2="h2";
  String componentName="JOBTRACKER";
  StackId currentStackId=new StackId("HDP-0.1");
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createCluster(clusterName);
  Cluster c=clusters.getCluster(clusterName);
  c.setDesiredStackVersion(currentStackId);
  createService(clusterName,serviceName,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName,null);
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName,host1,null);
  createServiceComponentHost(clusterName,null,componentName,host2,null);
  c.getService(serviceName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setStackVersion(currentStackId);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setStackVersion(currentStackId);
  ClusterRequest r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.0.1",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("must be greater than current version"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDPLocal-1.2.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade not possible between different stacks"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(serviceName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(componentName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  StackId expectedStackId=new StackId("HDP-0.2");
  Assert.assertTrue(expectedStackId.equals(c.getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getDesiredStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getStackVersion()));
  ServiceComponent sc=c.getService(serviceName).getServiceComponent(componentName);
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host2).getState());
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("A prior upgrade request with id"));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  c.setCurrentStackVersion(expectedStackId);
  r=new ClusterRequest(c.getClusterId(),clusterName,"",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,null,null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceComponentCustomCommands() throws Exception {
  StackServiceComponentRequest namenodeRequest=new StackServiceComponentRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME,COMPONENT_NAME);
  Set<StackServiceComponentResponse> responses=controller.getStackComponents(Collections.singleton(namenodeRequest));
  Assert.assertEquals(1,responses.size());
  StackServiceComponentResponse response=responses.iterator().next();
  assertNotNull(response.getCustomCommands());
  assertEquals(2,response.getCustomCommands().size());
  assertEquals("DECOMMISSION",response.getCustomCommands().get(0));
  assertEquals("REBALANCEHDFS",response.getCustomCommands().get(1));
  StackServiceComponentRequest journalNodeRequest=new StackServiceComponentRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME,"JOURNALNODE");
  responses=controller.getStackComponents(Collections.singleton(journalNodeRequest));
  Assert.assertEquals(1,responses.size());
  response=responses.iterator().next();
  assertNotNull(response.getCustomCommands());
  assertEquals(0,response.getCustomCommands().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackVersions() throws Exception {
  StackVersionRequest request=new StackVersionRequest(STACK_NAME,null);
  Set<StackVersionResponse> responses=controller.getStackVersions(Collections.singleton(request));
  Assert.assertEquals(STACK_VERSIONS_CNT,responses.size());
  StackVersionRequest requestWithParams=new StackVersionRequest(STACK_NAME,STACK_VERSION);
  Set<StackVersionResponse> responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackVersionResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getStackVersion(),STACK_VERSION);
  }
  StackVersionRequest invalidRequest=new StackVersionRequest(STACK_NAME,NON_EXT_VALUE);
  try {
    controller.getStackVersions(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
  requestWithParams=new StackVersionRequest(STACK_NAME,"2.1.1");
  responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  StackVersionResponse resp=responsesWithParams.iterator().next();
  assertNotNull(resp.getUpgradePacks());
  assertEquals(8,resp.getUpgradePacks().size());
  assertTrue(resp.getUpgradePacks().contains("upgrade_test"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStacks() throws Exception {
  StackRequest request=new StackRequest(null);
  Set<StackResponse> responses=controller.getStacks(Collections.singleton(request));
  Assert.assertEquals(STACKS_CNT,responses.size());
  StackRequest requestWithParams=new StackRequest(STACK_NAME);
  Set<StackResponse> responsesWithParams=controller.getStacks(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getStackName(),STACK_NAME);
  }
  StackRequest invalidRequest=new StackRequest(NON_EXT_VALUE);
  try {
    controller.getStacks(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConfigAttributesStaleConfigFilter() throws AmbariException, AuthorizationException {
  final String host1="h1";
  final String host2="h2";
  Long clusterId=1L;
  String clusterName="foo1";
  setupClusterWithHosts(clusterName,"HDP-2.0.5",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> hdfsConfigs=new HashMap<String,String>();
  hdfsConfigs.put("a","b");
  Map<String,Map<String,String>> hdfsConfigAttributes=new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
;
  ConfigurationRequest cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",hdfsConfigs,hdfsConfigAttributes);
  ClusterRequest crReq1=new ClusterRequest(clusterId,clusterName,null,null);
  crReq1.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq1),null);
  startService(clusterName,serviceName,false,false);
  HashMap<String,Map<String,String>> actualConfig=new HashMap<String,Map<String,String>>(){
{
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  HashMap<String,Map<String,String>> actualConfigOld=new HashMap<String,Map<String,String>>(){
{
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version0");
        }
      }
);
    }
  }
;
  Service s1=clusters.getCluster(clusterName).getService(serviceName);
  s1.getServiceComponent(componentName1).getServiceComponentHost(host1).updateActualConfigs(actualConfig);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host1).updateActualConfigs(actualConfig);
  s1.getServiceComponent(componentName3).getServiceComponentHost(host1).updateActualConfigs(actualConfigOld);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host2).updateActualConfigs(actualConfigOld);
  s1.getServiceComponent(componentName3).getServiceComponentHost(host2).updateActualConfigs(actualConfig);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setStaleConfig("true");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setStaleConfig("false");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(3,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,host1,null);
  r.setStaleConfig("false");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,host2,null);
  r.setStaleConfig("true");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDeleteClusterCreateHost() throws Exception {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"../version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  String STACK_ID="HDP-2.0.1";
  Long CLUSTER_ID=1L;
  String CLUSTER_NAME="c1";
  String HOST1="h1";
  String HOST2="h2";
  try {
    Clusters clusters=injector.getInstance(Clusters.class);
    clusters.addHost(HOST1);
    Host host=clusters.getHost(HOST1);
    setOsFamily(host,"redhat","6.3");
    host.persist();
    clusters.addHost(HOST2);
    host=clusters.getHost(HOST2);
    setOsFamily(host,"redhat","6.3");
    host.persist();
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    ClusterRequest cr=new ClusterRequest(null,CLUSTER_NAME,STACK_ID,null);
    amc.createCluster(cr);
    ConfigurationRequest configRequest=new ConfigurationRequest(CLUSTER_NAME,"global","version1",new HashMap<String,String>(){
{
        put("a","b");
      }
    }
,null);
    cr.setDesiredConfig(Collections.singletonList(configRequest));
    cr.setClusterId(CLUSTER_ID);
    amc.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
    Set<HostRequest> hrs=new HashSet<HostRequest>();
    hrs.add(new HostRequest(HOST1,CLUSTER_NAME,null));
    HostResourceProviderTest.createHosts(amc,hrs);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"HDFS",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"MAPREDUCE2",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"YARN",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"MAPREDUCE2","HISTORYSERVER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","RESOURCEMANAGER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","NODEMANAGER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"DATANODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"SECONDARY_NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"HISTORYSERVER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"RESOURCEMANAGER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NODEMANAGER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"HDFS_CLIENT",HOST1,null));
    amc.createHostComponents(componentHostRequests);
    RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
    ExecuteActionRequest ar=new ExecuteActionRequest(CLUSTER_NAME,Role.HDFS_SERVICE_CHECK.name(),null,false);
    ar.getResourceFilters().add(resourceFilter);
    amc.createAction(ar,null);
    amc.deleteCluster(cr);
    assertNotNull(clusters.getHost(HOST1));
    assertNotNull(clusters.getHost(HOST2));
    HostDAO dao=injector.getInstance(HostDAO.class);
    assertNotNull(dao.findByName(HOST1));
    assertNotNull(dao.findByName(HOST2));
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTasksByRequestId() throws AmbariException {
  final long requestId1=1;
  final long requestId2=2;
  final long requestId3=3;
  final String clusterName="c1";
  final String hostName1="h1";
  final String context="Test invocation";
  StackId stackID=new StackId("HDP-0.1");
  clusters.addCluster(clusterName,stackID);
  Cluster c=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackID,stackID.getStackVersion());
  c.createClusterVersion(stackID,stackID.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  clusters.addHost(hostName1);
  setOsFamily(clusters.getHost("h1"),"redhat","5.9");
  clusters.getHost(hostName1).persist();
  clusters.mapHostsToCluster(new HashSet<String>(){
{
      add(hostName1);
    }
  }
,clusterName);
  List<Stage> stages=new ArrayList<Stage>();
  stages.add(stageFactory.createNew(requestId1,"/a1",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(0).setStageId(1);
  stages.get(0).addHostRoleExecutionCommand(hostName1,Role.HBASE_MASTER,RoleCommand.START,new ServiceComponentHostStartEvent(Role.HBASE_MASTER.toString(),hostName1,System.currentTimeMillis()),clusterName,"HBASE",false,false);
  stages.add(stageFactory.createNew(requestId1,"/a2",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(1).setStageId(2);
  stages.get(1).addHostRoleExecutionCommand(hostName1,Role.HBASE_CLIENT,RoleCommand.START,new ServiceComponentHostStartEvent(Role.HBASE_CLIENT.toString(),hostName1,System.currentTimeMillis()),clusterName,"HBASE",false,false);
  stages.add(stageFactory.createNew(requestId1,"/a3",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(2).setStageId(3);
  stages.get(2).addHostRoleExecutionCommand(hostName1,Role.HBASE_CLIENT,RoleCommand.START,new ServiceComponentHostStartEvent(Role.HBASE_CLIENT.toString(),hostName1,System.currentTimeMillis()),clusterName,"HBASE",false,false);
  Request request=new Request(stages,clusters);
  actionDB.persistActions(request);
  stages.clear();
  stages.add(stageFactory.createNew(requestId2,"/a4",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(0).setStageId(4);
  stages.get(0).addHostRoleExecutionCommand(hostName1,Role.HBASE_CLIENT,RoleCommand.START,new ServiceComponentHostStartEvent(Role.HBASE_CLIENT.toString(),hostName1,System.currentTimeMillis()),clusterName,"HBASE",false,false);
  stages.add(stageFactory.createNew(requestId2,"/a5",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(1).setStageId(5);
  stages.get(1).addHostRoleExecutionCommand(hostName1,Role.HBASE_CLIENT,RoleCommand.START,new ServiceComponentHostStartEvent(Role.HBASE_CLIENT.toString(),hostName1,System.currentTimeMillis()),clusterName,"HBASE",false,false);
  request=new Request(stages,clusters);
  actionDB.persistActions(request);
  ServiceComponentHostServerActionEvent serviceComponentHostServerActionEvent=new ServiceComponentHostServerActionEvent(Role.AMBARI_SERVER_ACTION.toString(),null,System.currentTimeMillis());
  stages.clear();
  stages.add(stageFactory.createNew(requestId3,"/a6",clusterName,1L,context,CLUSTER_HOST_INFO,"",""));
  stages.get(0).setStageId(6);
  stages.get(0).addServerActionCommand("some.action.class.name",null,Role.AMBARI_SERVER_ACTION,RoleCommand.EXECUTE,clusterName,serviceComponentHostServerActionEvent,null,null,null,null,false,false);
  assertEquals("_internal_ambari",stages.get(0).getOrderedHostRoleCommands().get(0).getHostName());
  request=new Request(stages,clusters);
  actionDB.persistActions(request);
  org.apache.ambari.server.controller.spi.Request spiRequest=PropertyHelper.getReadRequest(TaskResourceProvider.TASK_CLUSTER_NAME_PROPERTY_ID,TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID,TaskResourceProvider.TASK_STAGE_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(requestId1).toPredicate();
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findAll(spiRequest,predicate);
  Assert.assertEquals(3,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(requestId1).and().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals(2L).toPredicate();
  entities=hostRoleCommandDAO.findAll(spiRequest,predicate);
  Assert.assertEquals(1,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(requestId2).toPredicate();
  entities=hostRoleCommandDAO.findAll(spiRequest,predicate);
  Assert.assertEquals(2,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(requestId1).and().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals(2L).or().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(requestId2).toPredicate();
  entities=hostRoleCommandDAO.findAll(spiRequest,predicate);
  Assert.assertEquals(3,entities.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecretReferences() throws AmbariException, AuthorizationException {
  final String host1="h1";
  final String host2="h2";
  Long clusterId=1L;
  String clusterName="foo1";
  Cluster cl=setupClusterWithHosts(clusterName,"HDP-2.0.5",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  ClusterRequest crReq;
  ConfigurationRequest cr;
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("test.password","first");
      put("test.password.empty","");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:1:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","brandNewPassword");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:666:test.password");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
  }
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version4",new HashMap<String,String>(){
{
      put("foo","bar");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version5",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:4:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
    assertEquals("Error when parsing secret reference. Cluster: foo1 ConfigType: hdfs-site ConfigVersion: 4 does not contain property 'test.password'",e.getMessage());
  }
  cl.getAllConfigs();
  assertEquals(cl.getAllConfigs().size(),4);
  Config v1=cl.getConfigByVersion("hdfs-site",1l);
  Config v2=cl.getConfigByVersion("hdfs-site",2l);
  Config v3=cl.getConfigByVersion("hdfs-site",3l);
  Config v4=cl.getConfigByVersion("hdfs-site",4l);
  assertEquals(v1.getProperties().get("test.password"),"first");
  assertEquals(v2.getProperties().get("test.password"),"first");
  assertEquals(v3.getProperties().get("test.password"),"brandNewPassword");
  assertFalse(v4.getProperties().containsKey("test.password"));
  final ConfigurationRequest configRequest=new ConfigurationRequest(clusterName,"hdfs-site",null,null,null);
  configRequest.setIncludeProperties(true);
  Set<ConfigurationResponse> requestedConfigs=controller.getConfigurations(new HashSet<ConfigurationRequest>(){
{
      add(configRequest);
    }
  }
);
  for (  ConfigurationResponse resp : requestedConfigs) {
    String secretName="SECRET:hdfs-site:" + resp.getVersion().toString() + ":test.password";
    if (resp.getConfigs().containsKey("test.password")) {
      assertEquals(resp.getConfigs().get("test.password"),secretName);
    }
    if (resp.getConfigs().containsKey("test.password.empty")) {
      assertEquals(resp.getConfigs().get("test.password.empty"),"");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentHosts() throws AmbariException, AuthorizationException {
  Cluster c1=setupClusterWithHosts("c1","HDP-0.1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,"centos5");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s1);
  s1.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  s1.addServiceComponent(sc1);
  sc1.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc1,"h1");
  sc1.addServiceComponentHost(sch1);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  sch1.setStackVersion(new StackId("HDP-0.1"));
  sch1.persist();
  sch1.updateActualConfigs(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  ServiceComponentHostResponse resp=resps.iterator().next();
  Assert.assertEquals(c1.getClusterName(),resp.getClusterName());
  Assert.assertEquals(sc1.getName(),resp.getComponentName());
  Assert.assertEquals(s1.getName(),resp.getServiceName());
  Assert.assertEquals(sch1.getHostName(),resp.getHostname());
  Assert.assertEquals(sch1.getDesiredState().toString(),resp.getDesiredState());
  Assert.assertEquals(sch1.getState().toString(),resp.getLiveState());
  Assert.assertEquals(sch1.getStackVersion().getStackId(),resp.getStackVersion());
  Assert.assertNotNull(resp.getActualConfigs());
  Assert.assertEquals(1,resp.getActualConfigs().size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentHostSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INIT);
    fail("ServiceComponentHost creation should fail for invalid host" + " as host not mapped to cluster");
  }
 catch (  Exception e) {
  }
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INSTALLING);
    fail("ServiceComponentHost creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1);
    fail("ServiceComponentHost creation should have failed earlier");
  }
 catch (  Exception e) {
  }
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
    fail("ServiceComponentHost creation should fail as duplicate");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName2,null,null);
  Set<ServiceComponentHostResponse> response=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,response.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServices2() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceResponse response=createNiceMock(ServiceResponse.class);
  ServiceRequest request1=new ServiceRequest("cluster1","service1",null);
  Set<ServiceRequest> setRequests=new HashSet<ServiceRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createStrictMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.convertToResponse()).andReturn(response);
  replay(maintHelper,injector,clusters,cluster,service,response);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Set<ServiceResponse> setResponses=ServiceResourceProviderTest.getServices(controller,setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(injector,clusters,cluster,service,response);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteComponentsOnHost() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,ServiceComponentHost> hostComponents=cluster.getService(serviceName).getServiceComponent(componentName1).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  hostComponents=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  ServiceComponentHost sch=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1);
  Assert.assertNotNull(sch);
  sch.handleEvent(new ServiceComponentHostStartEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStartedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  try {
    controller.deleteHostComponents(schRequests);
    fail("Expected exception while deleting all host components.");
  }
 catch (  AmbariException e) {
  }
  Assert.assertEquals(3,cluster.getServiceComponentHosts(host1).size());
  sch.handleEvent(new ServiceComponentHostStopEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStoppedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"DISABLED"));
  updateHostComponents(schRequests,new HashMap<String,String>(),false);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  controller.deleteHostComponents(schRequests);
  Assert.assertEquals(0,cluster.getServiceComponentHosts(host1).size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientServiceSmokeTests() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="PIG";
  createService(clusterName,serviceName,null);
  String componentName1="PIG";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,null,componentName1,host2,null);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertEquals(2,taskStatuses.size());
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
  Assert.assertEquals("Called from a test",stages.get(0).getRequestContext());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("PIG");
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertNotNull(trackAction);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INSTALLED,sch.getState());
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  for (  Stage s : stages) {
    LOG.info("Stage dump : " + s.toString());
  }
  Assert.assertEquals(1,stages.size());
  taskStatuses=trackAction.getTasks();
  Assert.assertEquals(1,taskStatuses.size());
  Assert.assertEquals(Role.PIG_SERVICE_CHECK.toString(),taskStatuses.get(0).getRole());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrlController() throws Exception {
  String badUrl="http://hortonworks.com";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  RepositoryRequest request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(badUrl);
  Set<RepositoryRequest> requests=new HashSet<RepositoryRequest>();
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.fail("Expected a bad URL to throw an exception");
  }
 catch (  Exception e) {
    assertNotNull(e);
    Assert.assertTrue(e.getMessage().contains(badUrl));
  }
  request.setVerifyBaseUrl(false);
  controller.updateRepositories(requests);
  Assert.assertEquals(request.getBaseUrl(),repo.getBaseUrl());
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("https://hortonworks.com");
  requests.add(request);
  controller.updateRepositories(requests);
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("pro://hortonworks.com");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("http://rrr1.cccc");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(repo.getDefaultBaseUrl());
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(repo.getBaseUrl(),repo.getDefaultBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  String baseUrl=repo.getDefaultBaseUrl();
  if (!baseUrl.endsWith("/")) {
    baseUrl+="/";
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("ubuntu12")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  baseUrl=baseUrl.substring(0,baseUrl.length() - 1);
  Assert.assertTrue(!baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"/repodata/repomd.xml");
  Assert.assertTrue(!baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("suse11")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/foo/bar.xml,/repodata/repomd.xml");
  Assert.assertTrue(configuration.getRepoValidationSuffixes("ubuntu12").length > 1);
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassiveSkipServices() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  String componentName1_1="NAMENODE";
  String componentName1_2="DATANODE";
  String componentName1_3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1_1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName1_2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName1_3,State.INIT);
  String componentName2_1="JOBTRACKER";
  String componentName2_2="TASKTRACKER";
  createServiceComponent(clusterName,serviceName2,componentName2_1,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName2_2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1_1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName1_2,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName1_2,host2,null);
  createServiceComponentHost(clusterName,serviceName2,componentName2_1,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName2_2,host2,null);
  MaintenanceStateHelper maintenanceStateHelper=MaintenanceStateHelperTest.getMaintenanceStateHelperInstance(clusters);
  installService(clusterName,serviceName1,false,false,maintenanceStateHelper,null);
  installService(clusterName,serviceName2,false,false,maintenanceStateHelper,null);
  startService(clusterName,serviceName1,false,false,maintenanceStateHelper);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("context","Called from a test");
  Cluster cluster=clusters.getCluster(clusterName);
  for (  Service service : cluster.getServices().values()) {
    Assert.assertEquals(State.STARTED,service.getDesiredState());
  }
  Service service2=cluster.getService(serviceName2);
  service2.setMaintenanceState(MaintenanceState.ON);
  Set<ServiceRequest> srs=new HashSet<ServiceRequest>();
  srs.add(new ServiceRequest(clusterName,serviceName1,State.INSTALLED.name()));
  srs.add(new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name()));
  RequestStatusResponse rsr=ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  ShortTaskStatus sts : rsr.getTasks()) {
    String role=sts.getRole();
    Assert.assertFalse(role.equals(componentName2_1));
    Assert.assertFalse(role.equals(componentName2_2));
  }
  for (  Service service : cluster.getServices().values()) {
    if (service.getName().equals(serviceName2)) {
      Assert.assertEquals(State.STARTED,service.getDesiredState());
    }
 else {
      Assert.assertEquals(State.INSTALLED,service.getDesiredState());
    }
  }
  service2.setMaintenanceState(MaintenanceState.OFF);
  ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  Service service : cluster.getServices().values()) {
    Assert.assertEquals(State.INSTALLED,service.getDesiredState());
  }
  startService(clusterName,serviceName1,false,false,maintenanceStateHelper);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  Host h1=clusters.getHost(host1);
  h1.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  srs=new HashSet<ServiceRequest>();
  srs.add(new ServiceRequest(clusterName,serviceName1,State.INSTALLED.name()));
  srs.add(new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name()));
  rsr=ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  ShortTaskStatus sts : rsr.getTasks()) {
    Assert.assertFalse(sts.getHostName().equals(host1));
  }
  h1.setMaintenanceState(cluster.getClusterId(),MaintenanceState.OFF);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  service2.setMaintenanceState(MaintenanceState.ON);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name());
  rsr=ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertTrue("Service start request defaults to Cluster operation level," + "command does not create tasks",rsr == null || rsr.getTasks().size() == 0);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReConfigureServiceClient() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE";
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="JOBTRACKER";
  String componentName5="TASKTRACKER";
  String componentName6="MAPREDUCE_CLIENT";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName4,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName5,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName6,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName4,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName5,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName2,componentName6,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host3,null);
  createServiceComponentHost(clusterName,serviceName2,componentName6,host3,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  Map<String,String> configs2=new HashMap<String,String>();
  configs2.put("c","d");
  Map<String,String> configs3=new HashMap<String,String>();
  ConfigurationRequest cr1, cr2, cr3, cr4;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr4=new ConfigurationRequest(clusterName,"kerberos-env","version1",configs3,null);
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"kerberos-env",new HashMap<String,String>(),new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  cluster.addConfig(config1);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr4));
  controller.updateClusters(Collections.singleton(crReq),null);
  long requestId1=installService(clusterName,serviceName1,true,false);
  List<Stage> stages=actionDB.getAllStages(requestId1);
  Assert.assertEquals(3,stages.get(0).getOrderedHostRoleCommands().get(0).getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
  installService(clusterName,serviceName2,false,false);
  startService(clusterName,serviceName1,true,false);
  startService(clusterName,serviceName2,true,false);
  cr3=new ConfigurationRequest(clusterName,"core-site","version122",configs2,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  stopService(clusterName,serviceName1,false,false);
  stopService(clusterName,serviceName2,false,false);
  long requestId2=startService(clusterName,serviceName1,true,true);
  long requestId3=startService(clusterName,serviceName2,true,true);
  stages=new ArrayList<>();
  stages.addAll(actionDB.getAllStages(requestId2));
  stages.addAll(actionDB.getAllStages(requestId3));
  HostRoleCommand hdfsCmdHost3=null;
  HostRoleCommand hdfsCmdHost2=null;
  HostRoleCommand mapRedCmdHost2=null;
  HostRoleCommand mapRedCmdHost3=null;
  for (  Stage stage : stages) {
    List<HostRoleCommand> hrcs=stage.getOrderedHostRoleCommands();
    for (    HostRoleCommand hrc : hrcs) {
      LOG.debug("role: " + hrc.getRole());
      if (hrc.getRole().toString().equals("HDFS_CLIENT")) {
        if (hrc.getHostName().equals(host3)) {
          hdfsCmdHost3=hrc;
        }
 else         if (hrc.getHostName().equals(host2)) {
          hdfsCmdHost2=hrc;
        }
      }
      if (hrc.getRole().toString().equals("MAPREDUCE_CLIENT")) {
        if (hrc.getHostName().equals(host2)) {
          mapRedCmdHost2=hrc;
        }
 else         if (hrc.getHostName().equals(host3)) {
          mapRedCmdHost3=hrc;
        }
      }
    }
  }
  Assert.assertNotNull(hdfsCmdHost3);
  Assert.assertNotNull(hdfsCmdHost2);
  ExecutionCommand execCmd=hdfsCmdHost3.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals(3,execCmd.getConfigurationTags().size());
  Assert.assertEquals("version122",execCmd.getConfigurationTags().get("core-site").get("tag"));
  Assert.assertEquals("d",execCmd.getConfigurations().get("core-site").get("c"));
  Assert.assertNotNull(mapRedCmdHost2);
  Assert.assertNotNull(mapRedCmdHost3);
  stopService(clusterName,serviceName1,false,false);
  stopService(clusterName,serviceName2,false,false);
  clusters.getHost(host2).setState(HostState.HEARTBEAT_LOST);
  requestId3=startService(clusterName,serviceName2,true,true);
  stages=actionDB.getAllStages(requestId3);
  HostRoleCommand clientWithHostDown=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().toString().equals("MAPREDUCE_CLIENT") && hrc.getHostName().equals(host2)) {
        clientWithHostDown=hrc;
      }
    }
  }
  Assert.assertNull(clientWithHostDown);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("MAPREDUCE").getServiceComponent("TASKTRACKER").getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHost(host1).getState());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplyConfigurationWithTheSameTag() throws AuthorizationException {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    String tag="version1";
    String type="core-site";
    AmbariException exception=null;
    try {
      AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
      Clusters clusters=injector.getInstance(Clusters.class);
      Gson gson=new Gson();
      clusters.addHost("host1");
      clusters.addHost("host2");
      clusters.addHost("host3");
      Host host=clusters.getHost("host1");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      host=clusters.getHost("host2");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      host=clusters.getHost("host3");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      ClusterRequest clusterRequest=new ClusterRequest(null,"c1","HDP-1.2.0",null);
      amc.createCluster(clusterRequest);
      Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
      serviceRequests.add(new ServiceRequest("c1","HDFS",null));
      ServiceResourceProviderTest.createServices(amc,serviceRequests);
      Type confType=new TypeToken<Map<String,String>>(){
      }
.getType();
      ConfigurationRequest configurationRequest=new ConfigurationRequest("c1",type,tag,gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
      amc.createConfiguration(configurationRequest);
      amc.createConfiguration(configurationRequest);
    }
 catch (    AmbariException e) {
      exception=e;
    }
    assertNotNull(exception);
    String exceptionMessage=MessageFormat.format("Configuration with tag ''{0}'' exists for ''{1}''",tag,type);
    org.junit.Assert.assertEquals(exceptionMessage,exception.getMessage());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceWithInvalidInfo() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  try {
    createService(clusterName,serviceName,State.INSTALLING);
    fail("Service creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName);
    fail("Service creation should have failed");
  }
 catch (  Exception e) {
  }
  try {
    createService(clusterName,serviceName,State.INSTALLED);
    fail("Service creation should fail for invalid initial state");
  }
 catch (  Exception e) {
  }
  createService(clusterName,serviceName,null);
  String serviceName2="MAPREDUCE";
  createService(clusterName,serviceName2,State.INIT);
  ServiceRequest r=new ServiceRequest(clusterName,null,null);
  Set<ServiceResponse> response=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(2,response.size());
  for (  ServiceResponse svc : response) {
    Assert.assertTrue(svc.getServiceName().equals(serviceName) || svc.getServiceName().equals(serviceName2));
    Assert.assertEquals("HDP-0.1",svc.getDesiredStackVersion());
    Assert.assertEquals(State.INIT.toString(),svc.getDesiredState());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostsWithDecommissioned() throws Exception {
  final String host1="h1";
  final String host2="h2";
  String clusterName="foo1";
  setupClusterWithHosts(clusterName,"HDP-2.0.7",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Service s1=clusters.getCluster(clusterName).getService(serviceName);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host1).setComponentAdminState(HostComponentAdminState.DECOMMISSIONED);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host2).setComponentAdminState(HostComponentAdminState.INSERVICE);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("DECOMMISSIONED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSERVICE");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSTALLED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,null);
  r.setAdminState("DECOMMISSIONED");
  try {
    updateHostComponents(Collections.singleton(r),new HashMap<String,String>(),false);
    Assert.fail("Must throw exception when decommission attribute is updated.");
  }
 catch (  IllegalArgumentException ex) {
    Assert.assertTrue(ex.getMessage().contains("Property adminState cannot be modified through update"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetServiceComponents() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  c1.setDesiredStackVersion(new StackId("HDP-0.2"));
  Service s1=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s1);
  s1.setDesiredState(State.INSTALLED);
  s1.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  s1.addServiceComponent(sc1);
  sc1.persist();
  sc1.setDesiredStackVersion(new StackId("HDP-0.1"));
  sc1.setDesiredState(State.UNINSTALLED);
  ServiceComponentRequest r=new ServiceComponentRequest("c1",s1.getName(),sc1.getName(),null);
  Set<ServiceComponentResponse> resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  ServiceComponentResponse resp=resps.iterator().next();
  Assert.assertEquals(c1.getClusterName(),resp.getClusterName());
  Assert.assertEquals(sc1.getName(),resp.getComponentName());
  Assert.assertEquals(s1.getName(),resp.getServiceName());
  Assert.assertEquals("HDP-0.1",resp.getDesiredStackVersion());
  Assert.assertEquals(sc1.getDesiredState().toString(),resp.getDesiredState());
  Assert.assertEquals(c1.getClusterId(),resp.getClusterId().longValue());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigsAttachedToServiceChecks() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  long requestId=startService(clusterName,serviceName,true,false);
  List<Stage> stages=actionDB.getAllStages(requestId);
  boolean serviceCheckFound=false;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HDFS_SERVICE_CHECK)) {
        serviceCheckFound=true;
        Assert.assertEquals(2,hrc.getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
      }
    }
  }
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    Map<String,String> hostParamsStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
    Assert.assertNotNull(hostParamsStage.get("jdk_location"));
  }
  Assert.assertEquals(true,serviceCheckFound);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithDecommissionDatanode() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config=new ConfigImpl("hdfs-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(clusters.getCluster(clusterName),"g1","t1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts"," h1 ");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",params,false);
  request.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertNotNull(execCmd.getConfigurationTags().get("hdfs-site"));
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertEquals(Role.NAMENODE,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStackComponents() throws Exception {
  StackServiceComponentRequest request=new StackServiceComponentRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,null);
  Set<StackServiceComponentResponse> responses=controller.getStackComponents(Collections.singleton(request));
  Assert.assertEquals(STACK_COMPONENTS_CNT,responses.size());
  StackServiceComponentRequest requestWithParams=new StackServiceComponentRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,COMPONENT_NAME);
  Set<StackServiceComponentResponse> responsesWithParams=controller.getStackComponents(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceComponentResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getComponentName(),COMPONENT_NAME);
  }
  StackServiceComponentRequest invalidRequest=new StackServiceComponentRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,NON_EXT_VALUE);
  try {
    controller.getStackComponents(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestStatusLogs() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  for (  Host h : clusters.getHosts()) {
    h.setPrefix(Configuration.PREFIX_DIR);
  }
  Map<String,Config> configs=new HashMap<String,Config>();
  Map<String,String> properties=new HashMap<String,String>();
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  Config c1=new ConfigImpl(cluster,"hdfs-site",properties,propertiesAttributes,injector);
  c1.setTag("v1");
  cluster.addConfig(c1);
  c1.persist();
  configs.put(c1.getType(),c1);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertFalse(taskStatuses.isEmpty());
  for (  ShortTaskStatus task : taskStatuses) {
    Assert.assertEquals("Task output logs don't match",Configuration.PREFIX_DIR + "/output-" + task.getTaskId()+ ".txt",task.getOutputLog());
    Assert.assertEquals("Task error logs don't match",Configuration.PREFIX_DIR + "/errors-" + task.getTaskId()+ ".txt",task.getErrorLog());
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetServiceComponentHostsWithStaleConfigFilter() throws AmbariException, AuthorizationException {
  final String host1="h1";
  final String host2="h2";
  Long clusterId=1L;
  String clusterName="foo1";
  setupClusterWithHosts(clusterName,"HDP-2.0.5",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  HashMap<String,Map<String,String>> actualConfig=new HashMap<String,Map<String,String>>(){
{
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  HashMap<String,Map<String,String>> actualConfigOld=new HashMap<String,Map<String,String>>(){
{
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version0");
        }
      }
);
    }
  }
;
  Service s1=clusters.getCluster(clusterName).getService(serviceName);
  s1.getServiceComponent(componentName1).getServiceComponentHost(host1).updateActualConfigs(actualConfig);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host1).updateActualConfigs(actualConfig);
  s1.getServiceComponent(componentName3).getServiceComponentHost(host1).updateActualConfigs(actualConfigOld);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host2).updateActualConfigs(actualConfigOld);
  s1.getServiceComponent(componentName3).getServiceComponentHost(host2).updateActualConfigs(actualConfig);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setStaleConfig("true");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setStaleConfig("false");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(3,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,host1,null);
  r.setStaleConfig("false");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,host2,null);
  r.setStaleConfig("true");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComponentCategorySentWithRestart() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.7",new ArrayList<String>(){
{
      add("h1");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.7"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  installService("c1","HDFS",false,false);
  startService("c1","HDFS",false,false);
  Cluster c=clusters.getCluster("c1");
  Service s=c.getService("HDFS");
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  for (  ServiceComponent sc : s.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","HDFS_CLIENT",new ArrayList<String>(){
{
      add("h1");
    }
  }
);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",params,false);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("hdfs_client","abc");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  List<Stage> stages=actionDB.getAllStages(response.getRequestId());
  Assert.assertNotNull(stages);
  HostRoleCommand hrc=null;
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : stages) {
    for (    HostRoleCommand cmd : stage.getOrderedHostRoleCommands()) {
      if (cmd.getRole().equals(Role.HDFS_CLIENT)) {
        hrc=cmd;
      }
      Map<String,String> hostParamStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.DB_DRIVER_FILENAME));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.MYSQL_JDBC_URL));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.ORACLE_JDBC_URL));
    }
  }
  Assert.assertNotNull(hrc);
  Assert.assertEquals("RESTART HDFS/HDFS_CLIENT",hrc.getCommandDetail());
  Map<String,String> roleParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getRoleParams();
  Assert.assertNotNull(roleParams);
  Assert.assertEquals("CLIENT",roleParams.get(ExecutionCommand.KeyNames.COMPONENT_CATEGORY));
  Assert.assertTrue(hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().containsKey("hdfs_client"));
  Assert.assertEquals("abc",hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().get("hdfs_client"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServiceComponentHostUpdateStackId() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch3=sc2.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INSTALLED);
  sc2.setDesiredState(State.INSTALLED);
  ServiceComponentHostRequest req1;
  ServiceComponentHostRequest req2;
  ServiceComponentHostRequest req3;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  StackId newStack=new StackId("HDP-0.2");
  StackId oldStack=new StackId("HDP-0.1");
  c1.setCurrentStackVersion(newStack);
  c1.setDesiredStackVersion(newStack);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.UPGRADING);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch1.setStackVersion(oldStack);
  sch2.setStackVersion(oldStack);
  sch1.setDesiredStackVersion(newStack);
  sch2.setDesiredStackVersion(oldStack);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req2.setDesiredStackId("HDP-0.2");
  reqs.add(req2);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","testServiceComponentHostUpdateStackId");
  RequestStatusResponse resp=updateHostComponents(reqs,mapRequestProps,true);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  Assert.assertEquals(1,stages.size());
  Assert.assertEquals(2,stages.get(0).getOrderedHostRoleCommands().size());
  Assert.assertEquals("testServiceComponentHostUpdateStackId",stages.get(0).getRequestContext());
  Assert.assertEquals(State.UPGRADING,sch1.getState());
  Assert.assertEquals(State.UPGRADING,sch2.getState());
  sch1.refresh();
  Assert.assertTrue(sch1.getDesiredStackVersion().compareTo(newStack) == 0);
  sch2.refresh();
  Assert.assertTrue(sch2.getDesiredStackVersion().compareTo(newStack) == 0);
  for (  HostRoleCommand command : stages.get(0).getOrderedHostRoleCommands()) {
    ExecutionCommand execCommand=command.getExecutionCommandWrapper().getExecutionCommand();
    Assert.assertTrue(execCommand.getCommandParams().containsKey("source_stack_version"));
    Assert.assertTrue(execCommand.getCommandParams().containsKey("target_stack_version"));
    Assert.assertEquals(RoleCommand.UPGRADE,execCommand.getRoleCommand());
  }
  sch1.setState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setState(State.UPGRADING);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setState(State.UPGRADING);
  sch3.setDesiredState(State.INSTALLED);
  sch3.setStackVersion(oldStack);
  sch3.setDesiredStackVersion(newStack);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req2.setDesiredStackId("HDP-0.2");
  reqs.add(req2);
  req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
  req3.setDesiredStackId("HDP-0.2");
  reqs.add(req3);
  resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  stages=actionDB.getAllStages(resp.getRequestId());
  Assert.assertEquals(2,stages.size());
  Assert.assertEquals(2,stages.get(0).getOrderedHostRoleCommands().size());
  Assert.assertEquals("",stages.get(0).getRequestContext());
  Assert.assertEquals(State.UPGRADING,sch1.getState());
  Assert.assertEquals(State.UPGRADING,sch2.getState());
  Assert.assertEquals(State.UPGRADING,sch3.getState());
  sch1.refresh();
  Assert.assertTrue(sch1.getDesiredStackVersion().compareTo(newStack) == 0);
  sch2.refresh();
  Assert.assertTrue(sch2.getDesiredStackVersion().compareTo(newStack) == 0);
  sch3.refresh();
  Assert.assertTrue(sch3.getDesiredStackVersion().compareTo(newStack) == 0);
  for (  Stage stage : stages) {
    for (    HostRoleCommand command : stage.getOrderedHostRoleCommands()) {
      ExecutionCommand execCommand=command.getExecutionCommandWrapper().getExecutionCommand();
      Assert.assertTrue(execCommand.getCommandParams().containsKey("source_stack_version"));
      Assert.assertTrue(execCommand.getCommandParams().containsKey("target_stack_version"));
      Assert.assertEquals("{\"stackName\":\"HDP\",\"stackVersion\":\"0.2\"}",execCommand.getCommandParams().get("target_stack_version"));
      Assert.assertEquals(RoleCommand.UPGRADE,execCommand.getRoleCommand());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testDisableAndDeleteStates() throws Exception {
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos5");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
        bind(AmbariEventPublisher.class).toInstance(EasyMock.createMock(AmbariEventPublisher.class));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    Clusters clusters=injector.getInstance(Clusters.class);
    Gson gson=new Gson();
    clusters.addHost("host1");
    clusters.addHost("host2");
    clusters.addHost("host3");
    Host host=clusters.getHost("host1");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host2");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host3");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    ClusterRequest clusterRequest=new ClusterRequest(null,"c1","HDP-1.2.0",null);
    amc.createCluster(clusterRequest);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Type confType=new TypeToken<Map<String,String>>(){
    }
.getType();
    ConfigurationRequest configurationRequest=new ConfigurationRequest("c1","core-site","version1",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version1",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version1",gson.<Map<String,String>>fromJson("{ \"hive.server2.enable.doAs\" : \"true\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    Assert.assertTrue(clusters.getCluster("c1").getDesiredConfigs().containsKey("hive-site"));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<HostRequest> hostRequests=new HashSet<HostRequest>();
    hostRequests.add(new HostRequest("host1","c1",null));
    hostRequests.add(new HostRequest("host2","c1",null));
    hostRequests.add(new HostRequest("host3","c1",null));
    HostResourceProviderTest.createHosts(amc,hostRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Cluster cluster=clusters.getCluster("c1");
    Map<String,ServiceComponentHost> namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    ServiceComponentHost componentHost=namenodes.get("host1");
    Map<String,ServiceComponentHost> hostComponents=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.INSTALLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2",null));
    amc.createHostComponents(componentHostRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    Assert.assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host2");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    RequestStatusResponse response=ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    for (    ShortTaskStatus shortTaskStatus : response.getTasks()) {
      assertFalse("host1".equals(shortTaskStatus.getHostName()) && "NAMENODE".equals(shortTaskStatus.getRole()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.deleteHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    testRunSmokeTestFlag(mapRequestProps,amc,serviceRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host1");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    assertEquals(State.INSTALLED,namenodes.get("host1").getState());
    ServiceComponentHost sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        tmp.setState(State.UNKNOWN);
        sch=tmp;
      }
    }
    assertNotNull(sch);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    mapRequestProps.put(RequestOperationLevel.OPERATION_CLUSTER_ID,"c1");
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    mapRequestProps.clear();
    assertEquals(sch.getServiceComponentName(),"DATANODE");
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    amc.deleteHostComponents(componentHostRequests);
    sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        sch=tmp;
      }
    }
    org.junit.Assert.assertNull(sch);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(2,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.deleteServices(amc,serviceRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(0,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    org.junit.Assert.assertEquals(1,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    configurationRequest=new ConfigurationRequest("c1","core-site","version2",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version2",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version2",gson.<Map<String,String>>fromJson("{ \"hbase_hdfs_root_dir\" : \"/apps/hbase/\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    Map<String,ServiceComponentHost> datanodes=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(3,datanodes.size());
    Map<String,ServiceComponentHost> namenodes2=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes2.size());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithServiceCheckActions() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config=new ConfigImpl("hdfs-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(clusters.getCluster(clusterName),"g1","t1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  long requestId=startService(clusterName,serviceName,true,false);
  HostRoleCommand smokeTestCmd=null;
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HDFS_SERVICE_CHECK)) {
        Assert.assertEquals(2,hrc.getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
        smokeTestCmd=hrc;
      }
    }
  }
  Assert.assertNotNull(smokeTestCmd);
  Assert.assertEquals("c",smokeTestCmd.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("hdfs-site").get("a"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScheduleSmokeTest() throws Exception {
  final String HOST1="host1";
  final String OS_TYPE="centos5";
  final String STACK_ID="HDP-2.0.1";
  final String CLUSTER_NAME="c1";
  final String HDFS_SERVICE_CHECK_ROLE="HDFS_SERVICE_CHECK";
  final String MAPREDUCE2_SERVICE_CHECK_ROLE="MAPREDUCE2_SERVICE_CHECK";
  final String YARN_SERVICE_CHECK_ROLE="YARN_SERVICE_CHECK";
  Map<String,String> mapRequestProps=Collections.emptyMap();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"../version");
      properties.setProperty(Configuration.OS_VERSION_KEY,OS_TYPE);
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    Clusters clusters=injector.getInstance(Clusters.class);
    clusters.addHost(HOST1);
    Host host=clusters.getHost(HOST1);
    setOsFamily(host,"redhat","5.9");
    host.persist();
    ClusterRequest clusterRequest=new ClusterRequest(null,CLUSTER_NAME,STACK_ID,null);
    amc.createCluster(clusterRequest);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"HDFS",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"MAPREDUCE2",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"YARN",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"MAPREDUCE2","HISTORYSERVER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","RESOURCEMANAGER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","NODEMANAGER",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<HostRequest> hostRequests=new HashSet<HostRequest>();
    hostRequests.add(new HostRequest(HOST1,CLUSTER_NAME,null));
    HostResourceProviderTest.createHosts(amc,hostRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"DATANODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"SECONDARY_NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"HISTORYSERVER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"RESOURCEMANAGER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NODEMANAGER",HOST1,null));
    amc.createHostComponents(componentHostRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"HDFS",State.INSTALLED.name()));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"MAPREDUCE2",State.INSTALLED.name()));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"YARN",State.INSTALLED.name()));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Cluster cluster=clusters.getCluster(CLUSTER_NAME);
    for (    String serviceName : cluster.getServices().keySet()) {
      for (      String componentName : cluster.getService(serviceName).getServiceComponents().keySet()) {
        Map<String,ServiceComponentHost> serviceComponentHosts=cluster.getService(serviceName).getServiceComponent(componentName).getServiceComponentHosts();
        for (        Map.Entry<String,ServiceComponentHost> entry : serviceComponentHosts.entrySet()) {
          ServiceComponentHost cHost=entry.getValue();
          cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),STACK_ID));
          cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
        }
      }
    }
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"HDFS",State.STARTED.name()));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"MAPREDUCE2",State.STARTED.name()));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"YARN",State.STARTED.name()));
    RequestStatusResponse response=ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Collection<?> hdfsSmokeTasks=CollectionUtils.select(response.getTasks(),new RolePredicate(HDFS_SERVICE_CHECK_ROLE));
    org.junit.Assert.assertEquals(1,hdfsSmokeTasks.size());
    Collection<?> mapreduce2SmokeTasks=CollectionUtils.select(response.getTasks(),new RolePredicate(MAPREDUCE2_SERVICE_CHECK_ROLE));
    org.junit.Assert.assertEquals(1,mapreduce2SmokeTasks.size());
    Collection<?> yarnSmokeTasks=CollectionUtils.select(response.getTasks(),new RolePredicate(YARN_SERVICE_CHECK_ROLE));
    org.junit.Assert.assertEquals(1,yarnSmokeTasks.size());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateAndGetUsers() throws Exception {
  createUser("user1");
  Set<UserResponse> r=controller.getUsers(Collections.singleton(new UserRequest("user1")));
  Assert.assertEquals(1,r.size());
  UserResponse resp=r.iterator().next();
  Assert.assertEquals("user1",resp.getUsername());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentHostsWithFilters() throws AmbariException, AuthorizationException {
  Cluster c1=setupClusterWithHosts("c1","HDP-0.2",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos5");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s1,"NAMENODE");
  ServiceComponent sc3=serviceComponentFactory.createNew(s3,"HBASE_REGIONSERVER");
  s1.addServiceComponent(sc1);
  s1.addServiceComponent(sc2);
  s3.addServiceComponent(sc3);
  sc1.setDesiredState(State.UNINSTALLED);
  sc3.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc1,"h1");
  ServiceComponentHost sch2=serviceComponentHostFactory.createNew(sc1,"h2");
  ServiceComponentHost sch3=serviceComponentHostFactory.createNew(sc1,"h3");
  ServiceComponentHost sch4=serviceComponentHostFactory.createNew(sc2,"h1");
  ServiceComponentHost sch5=serviceComponentHostFactory.createNew(sc2,"h2");
  ServiceComponentHost sch6=serviceComponentHostFactory.createNew(sc3,"h3");
  sc1.addServiceComponentHost(sch1);
  sc1.addServiceComponentHost(sch2);
  sc1.addServiceComponentHost(sch3);
  sc2.addServiceComponentHost(sch4);
  sc2.addServiceComponentHost(sch5);
  sc3.addServiceComponentHost(sch6);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.UNINSTALLED);
  sch1.persist();
  sch2.persist();
  sch3.persist();
  sch4.persist();
  sch5.persist();
  sch6.persist();
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(null,null,null,null,null);
  try {
    controller.getHostComponents(Collections.singleton(r));
    fail("Expected failure for invalid cluster");
  }
 catch (  Exception e) {
  }
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(6,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s1.getName(),null,null,null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,sc3.getName(),null,null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,State.UNINSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s1.getName(),null,null,State.INIT.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,sc3.getName(),null,State.INSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",State.INIT.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),null,"h1",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h3",State.INSTALLED.toString());
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h3",null);
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  ServiceComponentHostRequest r1, r2, r3;
  r1=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h3",null);
  r2=new ServiceComponentHostRequest(c1.getClusterName(),s3.getName(),sc3.getName(),"h2",null);
  r3=new ServiceComponentHostRequest(c1.getClusterName(),null,null,"h2",null);
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resps=controller.getHostComponents(reqs);
  Assert.assertEquals(4,resps.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetServices___OR_Predicate_ServiceNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service1=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceResponse response=createNiceMock(ServiceResponse.class);
  ServiceResponse response2=createNiceMock(ServiceResponse.class);
  ServiceRequest request1=new ServiceRequest("cluster1","service1",null);
  ServiceRequest request2=new ServiceRequest("cluster1","service2",null);
  ServiceRequest request3=new ServiceRequest("cluster1","service3",null);
  ServiceRequest request4=new ServiceRequest("cluster1","service4",null);
  Set<ServiceRequest> setRequests=new HashSet<ServiceRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createStrictMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(4);
  expect(cluster.getService("service1")).andReturn(service1);
  expect(cluster.getService("service2")).andThrow(new ServiceNotFoundException("cluster1","service2"));
  expect(cluster.getService("service3")).andThrow(new ServiceNotFoundException("cluster1","service3"));
  expect(cluster.getService("service4")).andReturn(service2);
  expect(service1.convertToResponse()).andReturn(response);
  expect(service2.convertToResponse()).andReturn(response2);
  replay(maintHelper,injector,clusters,cluster,service1,service2,response,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Set<ServiceResponse> setResponses=ServiceResourceProviderTest.getServices(controller,setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,service1,service2,response,response2);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallAndStartService() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Map<String,Config> configs=new HashMap<String,Config>();
  Map<String,String> properties=new HashMap<String,String>();
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  properties.put("a","a1");
  properties.put("b","b1");
  Config c1=new ConfigImpl(cluster,"hdfs-site",properties,propertiesAttributes,injector);
  properties.put("c","c1");
  properties.put("d","d1");
  Config c2=new ConfigImpl(cluster,"core-site",properties,propertiesAttributes,injector);
  Config c3=new ConfigImpl(cluster,"foo-site",properties,propertiesAttributes,injector);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  c1.setTag("v1");
  c2.setTag("v1");
  c3.setTag("v1");
  cluster.addConfig(c1);
  cluster.addConfig(c2);
  cluster.addConfig(c3);
  c1.persist();
  c2.persist();
  c3.persist();
  configs.put(c1.getType(),c1);
  configs.put(c2.getType(),c2);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertEquals(5,taskStatuses.size());
  boolean foundH1NN=false;
  boolean foundH1DN=false;
  boolean foundH2DN=false;
  boolean foundH1CLT=false;
  boolean foundH2CLT=false;
  for (  ShortTaskStatus taskStatus : taskStatuses) {
    LOG.debug("Task dump :" + taskStatus.toString());
    Assert.assertEquals(RoleCommand.INSTALL.toString(),taskStatus.getCommand());
    Assert.assertEquals(HostRoleStatus.PENDING.toString(),taskStatus.getStatus());
    if (taskStatus.getHostName().equals("h1")) {
      if (Role.NAMENODE.toString().equals(taskStatus.getRole())) {
        foundH1NN=true;
      }
 else       if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH1DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH1CLT=true;
      }
 else {
        fail("Found invalid role for host h1");
      }
    }
 else     if (taskStatus.getHostName().equals("h2")) {
      if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH2DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH2CLT=true;
      }
 else {
        fail("Found invalid role for host h2");
      }
    }
 else {
      fail("Found invalid host in task list");
    }
  }
  Assert.assertTrue(foundH1DN && foundH1NN && foundH2DN&& foundH1CLT&& foundH2CLT);
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
  for (  Stage stage : stages) {
    LOG.info("Stage Details for Install Service" + ", stageId=" + stage.getStageId() + ", actionId="+ stage.getActionId());
    for (    String host : stage.getHosts()) {
      for (      ExecutionCommandWrapper ecw : stage.getExecutionCommands(host)) {
        Assert.assertFalse(ecw.getExecutionCommand().getHostLevelParams().get("repo_info").isEmpty());
      }
    }
  }
  org.apache.ambari.server.controller.spi.Request request=PropertyHelper.getReadRequest(TaskResourceProvider.TASK_CLUSTER_NAME_PROPERTY_ID,TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID,TaskResourceProvider.TASK_STAGE_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).toPredicate();
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(5,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).and().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals(1L).toPredicate();
  entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(1,entities.size());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    if (sc.getName().equals("HDFS_CLIENT")) {
      Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    }
 else {
      Assert.assertEquals(State.STARTED,sc.getDesiredState());
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(2,stages.size());
  StringBuilder sb=new StringBuilder();
  clusters.debugDump(sb);
  LOG.info("Cluster Dump: " + sb.toString());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        sch.setState(State.INSTALLED);
      }
 else {
        sch.setState(State.INSTALL_FAILED);
      }
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackVersionActiveAttr() throws Exception {
  for (  StackInfo stackInfo : ambariMetaInfo.getStacks(STACK_NAME)) {
    if (stackInfo.getVersion().equalsIgnoreCase(STACK_VERSION)) {
      stackInfo.setActive(true);
    }
  }
  StackVersionRequest requestWithParams=new StackVersionRequest(STACK_NAME,STACK_VERSION);
  Set<StackVersionResponse> responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackVersionResponse responseWithParams : responsesWithParams) {
    Assert.assertTrue(responseWithParams.isActive());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="NAMENODE";
  try {
    createServiceComponent(clusterName,serviceName,componentName,State.INSTALLING);
    fail("ServiceComponent creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName);
    fail("ServiceComponent creation should have failed");
  }
 catch (  Exception e) {
  }
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName));
  ServiceComponentRequest r=new ServiceComponentRequest(clusterName,serviceName,null,null);
  Set<ServiceComponentResponse> response=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,response.size());
  ServiceComponentResponse sc=response.iterator().next();
  Assert.assertEquals(State.INIT.toString(),sc.getDesiredState());
  Assert.assertEquals(componentName,sc.getComponentName());
  Assert.assertEquals(clusterName,sc.getClusterName());
  Assert.assertEquals(serviceName,sc.getServiceName());
}

</code></pre>

<br>
<pre class="type-4 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServiceComponentHostUpdateStackIdError() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc1.getServiceComponentHost(host2);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  ServiceComponentHostRequest req1;
  ServiceComponentHostRequest req2;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("invalid stack id");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Invalid desired stack id");
  c1.setCurrentStackVersion(new StackId("HDP-0.0"));
  sch1.setStackVersion(new StackId("HDP-0.1"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Cluster has not been upgraded yet");
  c1.setCurrentStackVersion(new StackId("HDP2-0.1"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Deployed stack name and requested stack names");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.3");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Component host can only be upgraded to the same version");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Component host is in an invalid state for upgrade");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.UPGRADING);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"The desired state for an upgrade request must be");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.UPGRADING);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,null);
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"The desired state for an upgrade request must be");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.STARTED.toString());
  reqs.add(req2);
  updateHostAndCompareExpectedFailure(reqs,"An upgrade request cannot be combined with other");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,null);
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  RequestStatusResponse resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(resp);
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(resp);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.STARTED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.UNKNOWN);
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  ServiceComponentRequest req1, req2, req3;
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INIT.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.STARTED.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.STARTED);
  sch2.setState(State.INIT);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INIT);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  req3=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  RequestStatusResponse trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertEquals(State.INSTALLED,s1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch4.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch5.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getState());
  Assert.assertEquals(State.INIT,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INIT,sch5.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  Assert.assertTrue(!stages.isEmpty());
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHbaseDecommission() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HBASE";
  createService(clusterName,serviceName,null);
  String componentName1="HBASE_MASTER";
  String componentName2="HBASE_REGIONSERVER";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  Map<String,String> cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2").setState(State.INSTALLED);
  params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("mark_draining_only","true");
      put("slave_type","HBASE_REGIONSERVER");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("true",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("included_hosts","h2");
    }
  }
;
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Included: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertTrue(cmdParams.containsKey("excluded_hosts"));
  Assert.assertEquals("",cmdParams.get("excluded_hosts"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetClusters() throws AmbariException, AuthorizationException {
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  Cluster c1=clusters.getCluster("c1");
  StackId stackId=new StackId("HDP-0.1");
  c1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ClusterRequest r=new ClusterRequest(null,null,null,null);
  Set<ClusterResponse> resp=controller.getClusters(Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  ClusterResponse resp1=resp.iterator().next();
  Assert.assertEquals(c1.getClusterId(),resp1.getClusterId().longValue());
  Assert.assertEquals(c1.getClusterName(),resp1.getClusterName());
  Assert.assertEquals(c1.getDesiredStackVersion().getStackId(),resp1.getDesiredStackVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFiltersWithCustomActions() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","HDFS","","Some custom action.",TargetHostType.ALL,Short.valueOf("10010")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h2");
    }
  }
;
  RequestResourceFilter resourceFilter1=new RequestResourceFilter("HDFS","DATANODE",hosts);
  hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter2=new RequestResourceFilter("HDFS","NAMENODE",hosts);
  resourceFilters.add(resourceFilter1);
  resourceFilters.add(resourceFilter2);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=null;
  try {
    response=controller.createAction(actionRequest,requestProperties);
  }
 catch (  AmbariException ae) {
    LOG.info("Expected exception.",ae);
    Assert.assertTrue(ae.getMessage().contains("Custom action definition only " + "allows one resource filter to be specified"));
  }
  resourceFilters.remove(resourceFilter1);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  HostRoleCommand nnCommand=null;
  for (  HostRoleCommand hrc : actionDB.getRequestTasks(response.getRequestId())) {
    if (hrc.getHostName().equals("h1")) {
      nnCommand=hrc;
    }
  }
  Assert.assertNotNull(nnCommand);
  ExecutionCommand cmd=nnCommand.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("a1",cmd.getRole());
  Assert.assertEquals("10010",cmd.getCommandParams().get("command_timeout"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : actionDB.getAllStages(response.getRequestId())) {
    Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
    Assert.assertTrue(commandParamsStage.containsKey("test"));
  }
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackServices() throws Exception {
  StackServiceRequest request=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,null);
  Set<StackServiceResponse> responses=controller.getStackServices(Collections.singleton(request));
  Assert.assertEquals(11,responses.size());
  StackServiceRequest requestWithParams=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME);
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),SERVICE_NAME);
    Assert.assertTrue(responseWithParams.getConfigTypes().size() > 0);
  }
  StackServiceRequest invalidRequest=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,NON_EXT_VALUE);
  try {
    controller.getStackServices(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetServices() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  Cluster c1=clusters.getCluster("c1");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s1);
  s1.setDesiredStackVersion(new StackId("HDP-0.1"));
  s1.setDesiredState(State.INSTALLED);
  s1.persist();
  ServiceRequest r=new ServiceRequest("c1",null,null);
  Set<ServiceResponse> resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  ServiceResponse resp1=resp.iterator().next();
  Assert.assertEquals(s1.getClusterId(),resp1.getClusterId().longValue());
  Assert.assertEquals(s1.getCluster().getClusterName(),resp1.getClusterName());
  Assert.assertEquals(s1.getName(),resp1.getServiceName());
  Assert.assertEquals("HDP-0.1",s1.getDesiredStackVersion().getStackId());
  Assert.assertEquals(s1.getDesiredStackVersion().getStackId(),resp1.getDesiredStackVersion());
  Assert.assertEquals(State.INSTALLED.toString(),resp1.getDesiredState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithHostActions() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE2";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="HISTORYSERVER";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host3,null);
  createServiceComponentHost(clusterName,serviceName2,componentName4,host3,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2, cr3;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr3=new ConfigurationRequest(clusterName,"mapred-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  cluster=clusters.getCluster(clusterName);
  final Config config=new ConfigImpl("core-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(cluster,"g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config2=new ConfigImpl("mapred-site");
  config2.setProperties(configs);
  config2.setTag("version122");
  groupId=createConfigGroup(cluster,"g2","t2",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Long requestId=installService(clusterName,serviceName1,false,false);
  HostRoleCommand namenodeInstall=null;
  HostRoleCommand clientInstall=null;
  HostRoleCommand slaveInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.NAMENODE) && hrc.getHostName().equals("h1")) {
        namenodeInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h3")) {
        clientInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.DATANODE) && hrc.getHostName().equals("h2")) {
        slaveInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(namenodeInstall);
  Assert.assertNotNull(clientInstall);
  Assert.assertNotNull(slaveInstall);
  Assert.assertTrue(namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("c",namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  startService(clusterName,serviceName1,false,false);
  requestId=installService(clusterName,serviceName2,false,false);
  HostRoleCommand mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("b",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
  ConfigGroup configGroup=cluster.getConfigGroups().get(groupId);
  configGroup.setHosts(new HashMap<Long,Host>(){
{
      put(3L,clusters.getHost("h3"));
    }
  }
);
  configGroup.persist();
  requestId=startService(clusterName,serviceName2,false,false);
  mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("c",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRepositories() throws Exception {
  RepositoryRequest request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,null);
  Set<RepositoryResponse> responses=controller.getRepositories(Collections.singleton(request));
  Assert.assertEquals(REPOS_CNT,responses.size());
  RepositoryRequest requestWithParams=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  Set<RepositoryResponse> responsesWithParams=controller.getRepositories(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  RepositoryResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getRepoId(),REPO_ID);
  }
  RepositoryRequest invalidRequest=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,NON_EXT_VALUE);
  try {
    controller.getRepositories(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecommissonDatanodeAction() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertNotNull(execCmd.getConfigurationTags().get("hdfs-site"));
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertEquals(Role.NAMENODE,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h1");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Map<String,String> cmdParams=execCmd.getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("update_exclude_file_only"));
  Assert.assertTrue(cmdParams.get("update_exclude_file_only").equals("false"));
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.INSTALLED.toString());
  Set<ServiceComponentHostRequest> requests=new HashSet<ServiceComponentHostRequest>();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.INSTALLED);
  r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.STARTED);
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("included_hosts","h1 , h2");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertNotNull(storedTasks);
  scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(2,storedTasks.size());
  int countRefresh=0;
  for (  HostRoleCommand hrc : storedTasks) {
    Assert.assertTrue("DECOMMISSION, Included: h1,h2".equals(hrc.getCommandDetail()));
    Assert.assertTrue("DECOMMISSION".equals(hrc.getCustomCommandName()));
    cmdParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
    if (!cmdParams.containsKey("update_exclude_file_only") || !cmdParams.get("update_exclude_file_only").equals("true")) {
      countRefresh++;
    }
  }
  Assert.assertEquals(2,countRefresh);
  scHost.setComponentAdminState(null);
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateClusterSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Set<ClusterResponse> r=controller.getClusters(Collections.singleton(new ClusterRequest(null,clusterName,null,null)));
  Assert.assertEquals(1,r.size());
  ClusterResponse c=r.iterator().next();
  Assert.assertEquals(clusterName,c.getClusterName());
  try {
    createCluster(clusterName);
    fail("Duplicate cluster creation should fail");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testCreateServiceCheckActions() throws Exception {
  setupClusterWithHosts("c1","HDP-0.1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  cluster.setCurrentStackVersion(new StackId("HDP-0.1"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  config1.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr1",new HashMap<String,String>());
    }
  }
);
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  config2.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr2",new HashMap<String,String>());
    }
  }
);
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addDesiredConfig("_test",Collections.singleton(config1));
  cluster.addDesiredConfig("_test",Collections.singleton(config2));
  Service hdfs=cluster.addService("HDFS");
  Service mapReduce=cluster.addService("MAPREDUCE");
  hdfs.persist();
  mapReduce.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  mapReduce.addServiceComponent(Role.MAPREDUCE_CLIENT.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  mapReduce.getServiceComponent(Role.MAPREDUCE_CLIENT.name()).addServiceComponentHost("h2").persist();
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",Role.HDFS_SERVICE_CHECK.name(),params,false);
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus task=response.getTasks().get(0);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  ExecutionCommandDAO executionCommandDAO=injector.getInstance(ExecutionCommandDAO.class);
  ExecutionCommandEntity commandEntity=executionCommandDAO.findByPK(task.getTaskId());
  Gson gson=new Gson();
  ExecutionCommand executionCommand=gson.fromJson(new StringReader(new String(commandEntity.getCommand())),ExecutionCommand.class);
  assertFalse(executionCommand.getConfigurationTags().isEmpty());
  assertTrue(executionCommand.getConfigurations() == null || executionCommand.getConfigurations().isEmpty());
  assertEquals(1,storedTasks.size());
  HostRoleCommand hostRoleCommand=storedTasks.get(0);
  assertEquals("SERVICE_CHECK HDFS",hostRoleCommand.getCommandDetail());
  assertNull(hostRoleCommand.getCustomCommandName());
  assertEquals(task.getTaskId(),hostRoleCommand.getTaskId());
  assertNotNull(actionRequest.getResourceFilters());
  RequestResourceFilter requestResourceFilter=actionRequest.getResourceFilters().get(0);
  assertEquals(resourceFilter.getServiceName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getServiceName());
  assertEquals(actionRequest.getClusterName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getClusterName());
  assertEquals(actionRequest.getCommandName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRole());
  assertEquals(Role.HDFS_CLIENT.name(),hostRoleCommand.getEvent().getEvent().getServiceComponentName());
  assertEquals(actionRequest.getParameters(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRoleParams());
  assertNotNull(hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations());
  assertEquals(2,hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().size());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),stage.getRequestContext());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  actionRequest=new ExecuteActionRequest("c1",Role.MAPREDUCE_SERVICE_CHECK.name(),null,false);
  resourceFilter=new RequestResourceFilter("MAPREDUCE",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("MAPREDUCE");
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  List<HostRoleCommand> tasks=actionDB.getRequestTasks(response.getRequestId());
  assertEquals(1,tasks.size());
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,null);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  assertEquals("",response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentsWithFilters() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  Service s4=serviceFactory.createNew(c2,"HIVE");
  Service s5=serviceFactory.createNew(c2,"ZOOKEEPER");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  c2.addService(s4);
  c2.addService(s5);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s4.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  s4.persist();
  s5.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s1,"NAMENODE");
  ServiceComponent sc3=serviceComponentFactory.createNew(s3,"HBASE_REGIONSERVER");
  ServiceComponent sc4=serviceComponentFactory.createNew(s4,"HIVE_SERVER");
  ServiceComponent sc5=serviceComponentFactory.createNew(s4,"HIVE_CLIENT");
  ServiceComponent sc6=serviceComponentFactory.createNew(s4,"MYSQL_SERVER");
  ServiceComponent sc7=serviceComponentFactory.createNew(s5,"ZOOKEEPER_SERVER");
  ServiceComponent sc8=serviceComponentFactory.createNew(s5,"ZOOKEEPER_CLIENT");
  s1.addServiceComponent(sc1);
  s1.addServiceComponent(sc2);
  s3.addServiceComponent(sc3);
  s4.addServiceComponent(sc4);
  s4.addServiceComponent(sc5);
  s4.addServiceComponent(sc6);
  s5.addServiceComponent(sc7);
  s5.addServiceComponent(sc8);
  sc1.setDesiredState(State.UNINSTALLED);
  sc3.setDesiredState(State.UNINSTALLED);
  sc5.setDesiredState(State.UNINSTALLED);
  sc6.setDesiredState(State.UNINSTALLED);
  sc7.setDesiredState(State.UNINSTALLED);
  sc8.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  sc4.persist();
  sc5.persist();
  sc6.persist();
  sc7.persist();
  sc8.persist();
  ServiceComponentRequest r=new ServiceComponentRequest(null,null,null,null);
  try {
    ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
    fail("Expected failure for invalid cluster");
  }
 catch (  Exception e) {
  }
  r=new ServiceComponentRequest(c1.getClusterName(),null,null,null);
  Set<ServiceComponentResponse> resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(3,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),null,null,State.UNINSTALLED.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(4,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),s5.getName(),null,null);
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(2,resps.size());
  r=new ServiceComponentRequest(c2.getClusterName(),s4.getName(),null,State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc4.getName(),resps.iterator().next().getComponentName());
  r=new ServiceComponentRequest(c2.getClusterName(),null,sc5.getName(),State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc5.getName(),resps.iterator().next().getComponentName());
  r=new ServiceComponentRequest(c2.getClusterName(),s4.getName(),sc5.getName(),State.INIT.toString());
  resps=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(sc5.getName(),resps.iterator().next().getComponentName());
  ServiceComponentRequest r1, r2, r3;
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  r1=new ServiceComponentRequest(c2.getClusterName(),null,null,State.UNINSTALLED.toString());
  r2=new ServiceComponentRequest(c1.getClusterName(),null,null,null);
  r3=new ServiceComponentRequest(c1.getClusterName(),null,null,State.INIT.toString());
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resps=ComponentResourceProviderTest.getComponents(controller,reqs);
  Assert.assertEquals(7,resps.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponent() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest(STACK_NAME,"2.0.6","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostLevelParamsSentWithCommands() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="PIG";
  createService(clusterName,serviceName,null);
  String componentName1="PIG";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,null,componentName1,host2,null);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : stages) {
    Map<String,String> params=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
    Assert.assertEquals("0.1",params.get("stack_version"));
    Assert.assertNotNull(params.get("jdk_location"));
    Assert.assertNotNull(params.get("db_name"));
    Assert.assertNotNull(params.get("mysql_jdbc_url"));
    Assert.assertNotNull(params.get("oracle_jdbc_url"));
  }
  Map<String,String> paramsCmd=stages.get(0).getOrderedHostRoleCommands().get(0).getExecutionCommandWrapper().getExecutionCommand().getHostLevelParams();
  Assert.assertNotNull(paramsCmd.get("repo_info"));
  Assert.assertNotNull(paramsCmd.get("clientsToUpdateConfigs"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActionNoCluster() throws Exception {
  String hostname1="h1";
  String hostname2="h2";
  addHost(hostname1);
  addHost(hostname2);
  ambariMetaInfo.addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","","","action def description",TargetHostType.ANY,Short.valueOf("60")));
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  Map<String,String> requestParams=new HashMap<String,String>();
  requestParams.put("some_custom_param","abc");
  List<String> hosts=Arrays.asList(hostname1);
  RequestResourceFilter resourceFilter=new RequestResourceFilter(null,null,hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals(hostname1,taskStatus.getHostName());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  hosts=Arrays.asList(hostname1,hostname2);
  resourceFilter=new RequestResourceFilter(null,null,hosts);
  resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  boolean host1Found=false;
  boolean host2Found=false;
  for (  ShortTaskStatus sts : response.getTasks()) {
    if (sts.getHostName().equals(hostname1)) {
      host1Found=true;
    }
 else     if (sts.getHostName().equals(hostname2)) {
      host2Found=true;
    }
  }
  Assert.assertTrue(host1Found);
  Assert.assertTrue(host2Found);
  stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(2,storedTasks.size());
  task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testGetExecutionCommandWithClusterEnvForRetry() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","5");
  configs.put("commands_to_retry","INSTALL");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("phase","INITIAL_INSTALL");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  ExecutionCommand ec=execWrapper.getExecutionCommand();
  Map<String,Map<String,String>> configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.INSTALLED);
  }
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","12");
  configs.put("commands_to_retry","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version2",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("12",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","asdf");
  configs.put("command_retry_max_time_in_sec","-5");
  configs.put("commands_to_retry2","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version3",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("0",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostComponentsBadState() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host1)) {
    sch.setState(State.INSTALLED);
  }
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.UNKNOWN);
  }
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("datanode","dn_value");
  requestProps.put("namenode","nn_value");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  Assert.assertTrue(execWrapper.getExecutionCommand().getCommandParams().containsKey("datanode"));
  Assert.assertFalse(execWrapper.getExecutionCommand().getCommandParams().containsKey("namendode"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    Assert.assertEquals(State.UNKNOWN,sch.getState());
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetPackagesForServiceHost() throws Exception {
  ServiceInfo service=ambariMetaInfo.getStack("HDP","2.0.1").getService("HIVE");
  HashMap<String,String> hostParams=new HashMap<String,String>();
  Map<String,ServiceOsSpecific.Package> packages=new HashMap<String,ServiceOsSpecific.Package>();
  String[] packageNames={"hive","mysql-connector-java","mysql","mysql-server","mysql-client"};
  for (  String packageName : packageNames) {
    ServiceOsSpecific.Package pkg=new ServiceOsSpecific.Package();
    pkg.setName(packageName);
    packages.put(packageName,pkg);
  }
  List<ServiceOsSpecific.Package> rhel5Packages=controller.getPackagesForServiceHost(service,hostParams,"redhat5");
  List<ServiceOsSpecific.Package> expectedRhel5=Arrays.asList(packages.get("hive"),packages.get("mysql-connector-java"),packages.get("mysql"),packages.get("mysql-server"));
  List<ServiceOsSpecific.Package> sles11Packages=controller.getPackagesForServiceHost(service,hostParams,"suse11");
  List<ServiceOsSpecific.Package> expectedSles11=Arrays.asList(packages.get("hive"),packages.get("mysql-connector-java"),packages.get("mysql"),packages.get("mysql-client"));
  assertThat(rhel5Packages,is(expectedRhel5));
  assertThat(sles11Packages,is(expectedSles11));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostUpdateRecursive() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.INIT);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALL_FAILED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  ServiceComponentHostRequest req1, req2, req3, req4, req5;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  try {
    reqs.clear();
    req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
    req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
    req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
    req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
    req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.STARTED.toString());
    reqs.add(req1);
    reqs.add(req2);
    reqs.add(req3);
    reqs.add(req4);
    reqs.add(req5);
    updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  }
 catch (  Exception e) {
    fail("Failure for invalid states");
  }
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,null,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req3=new ServiceComponentHostRequest(clusterName,null,componentName2,host1,State.INSTALLED.toString());
  req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
  req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  reqs.add(req4);
  reqs.add(req5);
  RequestStatusResponse trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNotNull(trackAction);
  long requestId=trackAction.getRequestId();
  Assert.assertFalse(actionDB.getAllStages(requestId).isEmpty());
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRootServices() throws Exception {
  RootServiceRequest request=new RootServiceRequest(null);
  Set<RootServiceResponse> responses=controller.getRootServices(Collections.singleton(request));
  Assert.assertEquals(RootServiceResponseFactory.Services.values().length,responses.size());
  RootServiceRequest requestWithParams=new RootServiceRequest(RootServiceResponseFactory.Services.AMBARI.toString());
  Set<RootServiceResponse> responsesWithParams=controller.getRootServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  RootServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),RootServiceResponseFactory.Services.AMBARI.toString());
  }
  RootServiceRequest invalidRequest=new RootServiceRequest(NON_EXT_VALUE);
  try {
    controller.getRootServices(Collections.singleton(invalidRequest));
  }
 catch (  ObjectNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponent() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host3,null);
  installService(clusterName,serviceName,false,false);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host3,State.INSTALLED.name());
  Set<ServiceComponentHostRequest> setReqs=new HashSet<ServiceComponentHostRequest>();
  setReqs.add(schr);
  RequestStatusResponse resp=updateHostComponents(setReqs,Collections.<String,String>emptyMap(),false);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  HostRoleCommand clientReinstallCmd=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getHostName().equals(host3) && hrc.getRole().toString().equals("HDFS_CLIENT")) {
        clientReinstallCmd=hrc;
        break;
      }
    }
  }
  Assert.assertNotNull(clientReinstallCmd);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStackOperatingSystems() throws Exception {
  OperatingSystemRequest request=new OperatingSystemRequest(STACK_NAME,STACK_VERSION,null);
  Set<OperatingSystemResponse> responses=controller.getOperatingSystems(Collections.singleton(request));
  Assert.assertEquals(OS_CNT,responses.size());
  OperatingSystemRequest requestWithParams=new OperatingSystemRequest(STACK_NAME,STACK_VERSION,OS_TYPE);
  Set<OperatingSystemResponse> responsesWithParams=controller.getOperatingSystems(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  OperatingSystemResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getOsType(),OS_TYPE);
  }
  OperatingSystemRequest invalidRequest=new OperatingSystemRequest(STACK_NAME,STACK_VERSION,NON_EXT_VALUE);
  try {
    controller.getOperatingSystems(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponentFromServiceChange() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName,host2,null);
  installService(clusterName,serviceName,false,false);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName,State.STARTED.name());
  Set<ServiceRequest> setReqs=new HashSet<ServiceRequest>();
  setReqs.add(sr);
  RequestStatusResponse resp=ServiceResourceProviderTest.updateServices(controller,setReqs,Collections.<String,String>emptyMap(),false,true);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  Map<String,Role> hostsToRoles=new HashMap<String,Role>();
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      hostsToRoles.put(hrc.getHostName(),hrc.getRole());
    }
  }
  Map<String,Role> expectedHostsToRoles=new HashMap<String,Role>();
  expectedHostsToRoles.put(host1,Role.HDFS_CLIENT);
  expectedHostsToRoles.put(host2,Role.HDFS_CLIENT);
  Assert.assertEquals(expectedHostsToRoles,hostsToRoles);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkipTaskOnUnhealthyHosts() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host3,null);
  installService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEALTHY);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  clusters.getHost("h3").setState(HostState.HEARTBEAT_LOST);
  long requestId=startService(clusterName,serviceName,true,false);
  List<HostRoleCommand> commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(3,commands.size());
  int commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h1") || command.getHostName().equals("h2"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only two task.",2,commandCount);
  stopService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h2").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=startService(clusterName,serviceName,true,false);
  commands=actionDB.getRequestTasks(requestId);
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one task.",1,commandCount);
  stopService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEALTHY);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=startService(clusterName,serviceName,true,false);
  commands=actionDB.getRequestTasks(requestId);
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h3") || command.getHostName().equals("h2") || command.getHostName().equals("h1"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect all three task.",3,commandCount);
  clusters.getHost("h2").setState(HostState.HEARTBEAT_LOST);
  requestId=stopService(clusterName,serviceName,false,false);
  commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(2,commands.size());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.STOP) {
      Assert.assertTrue(command.getHostName().equals("h3") || command.getHostName().equals("h1"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only two task.",2,commandCount);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc3=s.getServiceComponent(componentName2);
  for (  ServiceComponentHost sch : sc3.getServiceComponentHosts().values()) {
    if (sch.getHostName().equals("h3")) {
      sch.setState(State.INSTALL_FAILED);
    }
  }
  clusters.getHost("h3").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  requestId=installService(clusterName,serviceName,false,false);
  Assert.assertEquals(-1,requestId);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=installService(clusterName,serviceName,false,false);
  commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(1,commands.size());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.INSTALL) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one task.",1,commandCount);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaintenanceState() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-1.2.0"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("context","Called from a test");
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=cluster.getService(serviceName);
  Map<String,Host> hosts=clusters.getHostsForCluster(clusterName);
  MaintenanceStateHelper maintenanceStateHelper=MaintenanceStateHelperTest.getMaintenanceStateHelperInstance(clusters);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName,null);
  sr.setMaintenanceState(MaintenanceState.ON.name());
  ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertEquals(MaintenanceState.ON,service.getMaintenanceState());
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  sr.setMaintenanceState(MaintenanceState.OFF.name());
  ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertEquals(MaintenanceState.OFF,service.getMaintenanceState());
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  HostRequest hr=new HostRequest(host1,clusterName,requestProperties);
  hr.setMaintenanceState(MaintenanceState.ON.name());
  HostResourceProviderTest.updateHosts(controller,Collections.singleton(hr));
  Host host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      MaintenanceState implied=controller.getEffectiveMaintenanceState(sch);
      if (sch.getHostName().equals(host1)) {
        Assert.assertEquals(MaintenanceState.IMPLIED_FROM_HOST,implied);
      }
 else {
        Assert.assertEquals(MaintenanceState.OFF,implied);
      }
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  hr.setMaintenanceState(MaintenanceState.OFF.name());
  HostResourceProviderTest.updateHosts(controller,Collections.singleton(hr));
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  HostRequest hr1=new HostRequest(host1,clusterName,requestProperties);
  hr1.setMaintenanceState(MaintenanceState.ON.name());
  HostRequest hr2=new HostRequest(host2,clusterName,requestProperties);
  hr2.setMaintenanceState(MaintenanceState.ON.name());
  Set<HostRequest> set=new HashSet<HostRequest>();
  set.add(hr1);
  set.add(hr2);
  HostResourceProviderTest.updateHosts(controller,set);
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  host=hosts.get(host2);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  hr1=new HostRequest(host1,clusterName,requestProperties);
  hr1.setMaintenanceState(MaintenanceState.OFF.name());
  hr2=new HostRequest(host2,clusterName,requestProperties);
  hr2.setMaintenanceState(MaintenanceState.OFF.name());
  set=new HashSet<HostRequest>();
  set.add(hr1);
  set.add(hr2);
  HostResourceProviderTest.updateHosts(controller,set);
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  host=hosts.get(host2);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  ServiceComponentHost targetSch=service.getServiceComponent(componentName2).getServiceComponentHosts().get(host2);
  Assert.assertNotNull(targetSch);
  targetSch.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  service.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  targetSch.setMaintenanceState(MaintenanceState.OFF);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE,controller.getEffectiveMaintenanceState(targetSch));
  service.setMaintenanceState(MaintenanceState.OFF);
  Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(targetSch));
  host=hosts.get(host2);
  host.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_HOST,controller.getEffectiveMaintenanceState(targetSch));
  targetSch.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  long id1=installService(clusterName,serviceName,false,false,maintenanceStateHelper,null);
  List<HostRoleCommand> hdfsCmds=actionDB.getRequestTasks(id1);
  Assert.assertNotNull(hdfsCmds);
  HostRoleCommand datanodeCmd=null;
  for (  HostRoleCommand cmd : hdfsCmds) {
    if (cmd.getRole().equals(Role.DATANODE)) {
      datanodeCmd=cmd;
    }
  }
  Assert.assertNotNull(datanodeCmd);
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    if (!sc.getName().equals(componentName2)) {
      continue;
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(sch == targetSch ? State.INIT : State.INSTALLED,sch.getState());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActions() throws Exception {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  Config config3=cf.createNew(cluster,"yarn-site",new HashMap<String,String>(){
{
      put("test.password","supersecret");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addConfig(config3);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  ActionDefinition a1=new ActionDefinition("a1",ActionType.SYSTEM,"test,[optional1]","","","Does file exist",TargetHostType.SPECIFIC,Short.valueOf("100"));
  controller.getAmbariMetaInfo().addActionDefinition(a1);
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a2",ActionType.SYSTEM,"","HDFS","DATANODE","Does file exist",TargetHostType.ALL,Short.valueOf("1000")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("pwd","SECRET:yarn-site:1:test.password");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("datanode","abc");
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","DATANODE",hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h1",taskStatus.getHostName());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals("h1",task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("h1",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> hostParametersStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
  Map<String,String> commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertNotNull(hostParametersStage.get("jdk_location"));
  Assert.assertEquals("900",cmd.getCommandParams().get("command_timeout"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  a1.setDefaultTimeout((short)1800);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  List<HostRoleCommand> storedTasks1=actionDB.getRequestTasks(response.getRequestId());
  cmd=storedTasks1.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("1800",cmd.getCommandParams().get("command_timeout"));
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",null);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a2",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  final List<HostRoleCommand> storedTasks2=actionDB.getRequestTasks(response.getRequestId());
  task=storedTasks2.get(1);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a2",task.getRole().name());
  HashSet<String> expectedHosts=new HashSet<String>(){
{
      add("h2");
      add("h1");
    }
  }
;
  HashSet<String> actualHosts=new HashSet<String>(){
{
      add(storedTasks2.get(1).getHostName());
      add(storedTasks2.get(0).getHostName());
    }
  }
;
  Assert.assertEquals(expectedHosts,actualHosts);
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertEquals("h2",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  hosts=new ArrayList<String>(){
{
      add("h3");
    }
  }
;
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",hosts);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h3",taskStatus.getHostName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRootServiceComponents() throws Exception {
  RootServiceComponentRequest request=new RootServiceComponentRequest(RootServiceResponseFactory.Services.AMBARI.toString(),null);
  Set<RootServiceComponentResponse> responses=controller.getRootServiceComponents(Collections.singleton(request));
  Assert.assertEquals(RootServiceResponseFactory.Services.AMBARI.getComponents().length,responses.size());
  RootServiceComponentRequest requestWithParams=new RootServiceComponentRequest(RootServiceResponseFactory.Services.AMBARI.toString(),RootServiceResponseFactory.Services.AMBARI.getComponents()[0].toString());
  Set<RootServiceComponentResponse> responsesWithParams=controller.getRootServiceComponents(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  RootServiceComponentResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getComponentName(),RootServiceResponseFactory.Services.AMBARI.getComponents()[0].toString());
  }
  RootServiceComponentRequest invalidRequest=new RootServiceComponentRequest(NON_EXT_VALUE,NON_EXT_VALUE);
  try {
    controller.getRootServiceComponents(Collections.singleton(invalidRequest));
  }
 catch (  ObjectNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testTargetedProcessCommand() throws Exception {
  final String host1="h1";
  String clusterName="c1";
  Cluster cluster=setupClusterWithHosts(clusterName,"HDP-2.0.5",Arrays.asList(host1),"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> hdfsConfigs=new HashMap<String,String>();
  hdfsConfigs.put("a","b");
  Map<String,Map<String,String>> hdfsConfigAttributes=new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
;
  ConfigurationRequest cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",hdfsConfigs,hdfsConfigAttributes);
  ClusterRequest crReq1=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq1.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq1),null);
  startService(clusterName,serviceName,false,false);
  ServiceComponentHostRequest req=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"INSTALLED");
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("namenode","p1");
  RequestStatusResponse resp=updateHostComponents(Collections.singleton(req),requestProperties,false);
  assertNotNull(resp);
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host1)) {
    sch.setState(State.INSTALLED);
  }
  resp=updateHostComponents(Collections.singleton(req),new HashMap<String,String>(),false);
  assertNull(resp);
  resp=updateHostComponents(Collections.singleton(req),requestProperties,false);
  assertNotNull(resp);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.2"));
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String serviceName2="HBASE";
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HBASE_MASTER";
  String componentName4="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName2,componentName3,host1,State.INIT.toString());
  ServiceComponentHostRequest r6=new ServiceComponentHostRequest(clusterName,serviceName1,componentName4,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  set1.add(r6);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  Service s2=c1.getService(serviceName2);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s2.getServiceComponent(componentName3);
  ServiceComponent sc4=s1.getServiceComponent(componentName4);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  ServiceComponentHost sch6=sc4.getServiceComponentHost(host2);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sc4.setDesiredState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch6.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  sch6.setState(State.INSTALLED);
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest req1, req2;
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.STARTED);
  sch2.setDesiredState(State.STARTED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.STARTED);
  sch5.setDesiredState(State.STARTED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,s1.getDesiredState());
  Assert.assertEquals(State.STARTED,s2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc1.getDesiredState());
  Assert.assertEquals(State.STARTED,sc2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getDesiredState());
  Assert.assertEquals(State.STARTED,sch2.getDesiredState());
  Assert.assertEquals(State.STARTED,sch3.getDesiredState());
  Assert.assertEquals(State.STARTED,sch4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch5.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch6.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getState());
  Assert.assertEquals(State.INSTALLED,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INSTALLED,sch5.getState());
  Assert.assertEquals(State.INSTALLED,sch6.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  Assert.assertTrue(!stages.isEmpty());
  Assert.assertEquals(3,stages.size());
  Stage stage1=null, stage2=null, stage3=null;
  for (  Stage s : stages) {
    if (s.getStageId() == 0) {
      stage1=s;
    }
    if (s.getStageId() == 1) {
      stage2=s;
    }
    if (s.getStageId() == 2) {
      stage3=s;
    }
  }
  Assert.assertEquals(2,stage1.getExecutionCommands(host1).size());
  Assert.assertEquals(1,stage1.getExecutionCommands(host2).size());
  Assert.assertEquals(1,stage2.getExecutionCommands(host1).size());
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"NAMENODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"DATANODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host2,"NAMENODE"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host1,"HBASE_MASTER"));
  Assert.assertNull(stage1.getExecutionCommandWrapper(host2,"DATANODE"));
  Assert.assertNotNull(stage3.getExecutionCommandWrapper(host1,"HBASE_SERVICE_CHECK"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host2,"HDFS_SERVICE_CHECK"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage s : stages) {
    for (    List<ExecutionCommandWrapper> list : s.getExecutionCommands().values()) {
      for (      ExecutionCommandWrapper ecw : list) {
        if (ecw.getExecutionCommand().getRole().contains("SERVICE_CHECK")) {
          Map<String,String> hostParams=StageUtils.getGson().fromJson(s.getHostParamsStage(),type);
          Assert.assertNotNull(hostParams);
          Assert.assertTrue(hostParams.size() > 0);
          Assert.assertTrue(hostParams.containsKey("stack_version"));
          Assert.assertEquals(hostParams.get("stack_version"),c1.getDesiredStackVersion().getStackVersion());
        }
      }
    }
  }
  sch1.setState(State.STARTED);
  sch2.setState(State.STARTED);
  sch3.setState(State.STARTED);
  sch4.setState(State.STARTED);
  sch5.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceCheckSupported() throws Exception {
  StackServiceRequest hdfsServiceRequest=new StackServiceRequest(STACK_NAME,"2.0.8",SERVICE_NAME);
  Set<StackServiceResponse> responses=controller.getStackServices(Collections.singleton(hdfsServiceRequest));
  Assert.assertEquals(1,responses.size());
  StackServiceResponse response=responses.iterator().next();
  assertTrue(response.isServiceCheckSupported());
  StackServiceRequest fakeServiceRequest=new StackServiceRequest(STACK_NAME,"2.0.8",FAKE_SERVICE_NAME);
  responses=controller.getStackServices(Collections.singleton(fakeServiceRequest));
  Assert.assertEquals(1,responses.size());
  response=responses.iterator().next();
  assertFalse(response.isServiceCheckSupported());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("HDP-0.2"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(State.INIT,s.getDesiredState());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest r;
  try {
    r=new ServiceRequest(clusterName,serviceName,State.INSTALLING.toString());
    reqs.clear();
    reqs.add(r);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected fail for invalid state transition");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  reqs.clear();
  reqs.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceWidgetCreationOnServiceCreate() throws Exception {
  String clusterName="foo1";
  ClusterRequest r=new ClusterRequest(null,clusterName,State.INSTALLED.name(),SecurityType.NONE,"OTHER-2.0",null);
  controller.createCluster(r);
  String serviceName="HBASE";
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("OTHER-2.0"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  WidgetDAO widgetDAO=injector.getInstance(WidgetDAO.class);
  WidgetLayoutDAO widgetLayoutDAO=injector.getInstance(WidgetLayoutDAO.class);
  List<WidgetEntity> widgetEntities=widgetDAO.findAll();
  List<WidgetLayoutEntity> layoutEntities=widgetLayoutDAO.findAll();
  Assert.assertNotNull(widgetEntities);
  Assert.assertFalse(widgetEntities.isEmpty());
  Assert.assertNotNull(layoutEntities);
  Assert.assertFalse(layoutEntities.isEmpty());
  WidgetEntity candidateVisibleEntity=null;
  for (  WidgetEntity entity : widgetEntities) {
    if (entity.getWidgetName().equals("OPEN_CONNECTIONS")) {
      candidateVisibleEntity=entity;
    }
  }
  Assert.assertNotNull(candidateVisibleEntity);
  Assert.assertEquals("GRAPH",candidateVisibleEntity.getWidgetType());
  Assert.assertEquals("ambari",candidateVisibleEntity.getAuthor());
  Assert.assertEquals("CLUSTER",candidateVisibleEntity.getScope());
  Assert.assertNotNull(candidateVisibleEntity.getMetrics());
  Assert.assertNotNull(candidateVisibleEntity.getProperties());
  Assert.assertNotNull(candidateVisibleEntity.getWidgetValues());
  WidgetLayoutEntity candidateLayoutEntity=null;
  for (  WidgetLayoutEntity entity : layoutEntities) {
    if (entity.getLayoutName().equals("default_hbase_layout")) {
      candidateLayoutEntity=entity;
    }
  }
  Assert.assertNotNull(candidateLayoutEntity);
  List<WidgetLayoutUserWidgetEntity> layoutUserWidgetEntities=candidateLayoutEntity.getListWidgetLayoutUserWidgetEntity();
  Assert.assertNotNull(layoutUserWidgetEntities);
  Assert.assertEquals(4,layoutUserWidgetEntities.size());
  Assert.assertEquals("RS_READS_WRITES",layoutUserWidgetEntities.get(0).getWidget().getWidgetName());
  Assert.assertEquals("OPEN_CONNECTIONS",layoutUserWidgetEntities.get(1).getWidget().getWidgetName());
  Assert.assertEquals("FILES_LOCAL",layoutUserWidgetEntities.get(2).getWidget().getWidgetName());
  Assert.assertEquals("UPDATED_BLOCKED_TIME",layoutUserWidgetEntities.get(3).getWidget().getWidgetName());
  Assert.assertEquals("HBASE_SUMMARY",layoutUserWidgetEntities.get(0).getWidget().getDefaultSectionName());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetUsers() throws Exception {
  createUser("user1");
  createUser("user2");
  createUser("user3");
  UserRequest request=new UserRequest(null);
  Set<UserResponse> responses=controller.getUsers(Collections.singleton(request));
  Assert.assertEquals(3,responses.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStackConfigurations() throws Exception {
  StackConfigurationRequest request=new StackConfigurationRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,null);
  Set<StackConfigurationResponse> responses=controller.getStackConfigurations(Collections.singleton(request));
  Assert.assertEquals(STACK_PROPERTIES_CNT,responses.size());
  StackConfigurationRequest requestWithParams=new StackConfigurationRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,PROPERTY_NAME);
  Set<StackConfigurationResponse> responsesWithParams=controller.getStackConfigurations(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackConfigurationResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getPropertyName(),PROPERTY_NAME);
  }
  StackConfigurationRequest invalidRequest=new StackConfigurationRequest(STACK_NAME,STACK_VERSION,SERVICE_NAME,NON_EXT_VALUE);
  try {
    controller.getStackConfigurations(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetClustersWithFilters() throws AmbariException, AuthorizationException {
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  clusters.addCluster("c2",new StackId("HDP-0.1"));
  clusters.addCluster("c3",new StackId("HDP-1.2.0"));
  clusters.addCluster("c4",new StackId("HDP-0.1"));
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  Cluster c3=clusters.getCluster("c3");
  Cluster c4=clusters.getCluster("c4");
  ClusterRequest r=new ClusterRequest(null,null,null,null);
  Set<ClusterResponse> resp=controller.getClusters(Collections.singleton(r));
  Assert.assertEquals(4,resp.size());
  r=new ClusterRequest(null,"c1",null,null);
  resp=controller.getClusters(Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  Assert.assertEquals(c1.getClusterId(),resp.iterator().next().getClusterId().longValue());
  r=new ClusterRequest(null,null,"HDP-0.1",null);
  resp=controller.getClusters(Collections.singleton(r));
  Assert.assertEquals(3,resp.size());
  r=new ClusterRequest(null,null,"",null);
  resp=controller.getClusters(Collections.singleton(r));
  Assert.assertEquals(0,resp.size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicesWithFilters() throws AmbariException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  Cluster c2=clusters.getCluster("c2");
  c1.setDesiredStackVersion(new StackId("HDP-0.2"));
  c2.setDesiredStackVersion(new StackId("HDP-0.2"));
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  Service s3=serviceFactory.createNew(c1,"HBASE");
  Service s4=serviceFactory.createNew(c2,"HIVE");
  Service s5=serviceFactory.createNew(c2,"ZOOKEEPER");
  c1.addService(s1);
  c1.addService(s2);
  c1.addService(s3);
  c2.addService(s4);
  c2.addService(s5);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  s4.setDesiredState(State.INSTALLED);
  s1.persist();
  s2.persist();
  s3.persist();
  s4.persist();
  s5.persist();
  ServiceRequest r=new ServiceRequest(null,null,null);
  Set<ServiceResponse> resp;
  try {
    ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
    fail("Expected failure for invalid request");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(c1.getClusterName(),null,null);
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(3,resp.size());
  r=new ServiceRequest(c1.getClusterName(),s2.getName(),null);
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  Assert.assertEquals(s2.getName(),resp.iterator().next().getServiceName());
  try {
    r=new ServiceRequest(c2.getClusterName(),s1.getName(),null);
    ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
    fail("Expected failure for invalid service");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(c1.getClusterName(),null,"INSTALLED");
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(2,resp.size());
  r=new ServiceRequest(c2.getClusterName(),null,"INIT");
  resp=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(1,resp.size());
  ServiceRequest r1, r2, r3;
  r1=new ServiceRequest(c1.getClusterName(),null,"INSTALLED");
  r2=new ServiceRequest(c2.getClusterName(),null,"INIT");
  r3=new ServiceRequest(c2.getClusterName(),null,"INIT");
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  reqs.addAll(Arrays.asList(r1,r2,r3));
  resp=ServiceResourceProviderTest.getServices(controller,reqs);
  Assert.assertEquals(3,resp.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.BackgroundCustomCommandExecutionTest </h4><pre class="type-4 type-7 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  Configuration configuration;
  TopologyManager topologyManager;
  InMemoryDefaultTestModule module=new InMemoryDefaultTestModule(){
    @Override protected void configure(){
      getProperties().put(Configuration.CUSTOM_ACTION_DEFINITION_KEY,"src/main/resources/custom_action_definitions");
      super.configure();
      bind(ActionManager.class).toInstance(am);
    }
  }
;
  injector=Guice.createInjector(module);
  injector.getInstance(GuiceJpaInitializer.class);
  controller=injector.getInstance(AmbariManagementController.class);
  clusters=injector.getInstance(Clusters.class);
  configuration=injector.getInstance(Configuration.class);
  topologyManager=injector.getInstance(TopologyManager.class);
  Assert.assertEquals("src/main/resources/custom_action_definitions",configuration.getCustomActionDefinitionPath());
  StageUtils.setTopologyManager(topologyManager);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testRebalanceHdfsCustomCommand(){
  try {
    createClusterFixture();
    Map<String,String> requestProperties=new HashMap<String,String>(){
{
        put(REQUEST_CONTEXT_PROPERTY,"Refresh YARN Capacity Scheduler");
        put("command","REBALANCEHDFS");
        put("namenode","{\"threshold\":13}");
      }
    }
;
    ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","REBALANCEHDFS",new HashMap<String,String>(),false);
    actionRequest.getResourceFilters().add(new RequestResourceFilter("HDFS","NAMENODE",Collections.singletonList("c6401")));
    controller.createAction(actionRequest,requestProperties);
    Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
    Request request=requestCapture.getValue();
    Assert.assertNotNull(request);
    Assert.assertNotNull(request.getStages());
    Assert.assertEquals(1,request.getStages().size());
    Stage stage=request.getStages().iterator().next();
    System.out.println(stage);
    Assert.assertEquals(1,stage.getHosts().size());
    List<ExecutionCommandWrapper> commands=stage.getExecutionCommands("c6401");
    Assert.assertEquals(1,commands.size());
    ExecutionCommand command=commands.get(0).getExecutionCommand();
    Assert.assertEquals(AgentCommandType.BACKGROUND_EXECUTION_COMMAND,command.getCommandType());
    Assert.assertEquals("{\"threshold\":13}",command.getCommandParams().get("namenode"));
  }
 catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.ClusterResponseTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicGetAndSet(){
  Long clusterId=new Long(10);
  String clusterName="foo";
  State provisioningState=State.INSTALLED;
  SecurityType securityType=SecurityType.KERBEROS;
  Set<String> hostNames=new HashSet<String>();
  hostNames.add("h1");
  ClusterResponse r1=new ClusterResponse(clusterId,clusterName,provisioningState,securityType,hostNames,hostNames.size(),"bar",null);
  Assert.assertEquals(clusterId,r1.getClusterId());
  Assert.assertEquals(clusterName,r1.getClusterName());
  Assert.assertEquals(provisioningState.name(),r1.getProvisioningState());
  Assert.assertEquals(securityType.name(),r1.getSecurityType());
  Assert.assertArrayEquals(hostNames.toArray(),r1.getHostNames().toArray());
  Assert.assertEquals(Integer.valueOf(1),r1.getTotalHosts());
  Assert.assertEquals("bar",r1.getDesiredStackVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.KerberosHelperTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleServiceSingleHost() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1","host2","SERVICE1",null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(1,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAuthToLocalRules() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  final KerberosPrincipalDescriptor principalDescriptor1=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor1.getValue()).andReturn("principal1/host1@EXAMPLE.COM").times(1);
  expect(principalDescriptor1.getLocalUsername()).andReturn("principal1_user").times(1);
  final KerberosPrincipalDescriptor principalDescriptor2=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor2.getValue()).andReturn("principal2/host2@EXAMPLE.COM").times(1);
  expect(principalDescriptor2.getLocalUsername()).andReturn("principal2_user").times(1);
  final KerberosPrincipalDescriptor principalDescriptor3=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor3.getValue()).andReturn("principal3/host3@EXAMPLE.COM").times(1);
  expect(principalDescriptor3.getLocalUsername()).andReturn("principal3_user").times(1);
  final KerberosIdentityDescriptor identityDescriptor1=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor1.getPrincipalDescriptor()).andReturn(principalDescriptor1).times(1);
  final KerberosIdentityDescriptor identityDescriptor2=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor2.getPrincipalDescriptor()).andReturn(principalDescriptor2).times(1);
  final KerberosIdentityDescriptor identityDescriptor3=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor3.getPrincipalDescriptor()).andReturn(principalDescriptor3).times(1);
  final KerberosServiceDescriptor serviceDescriptor1=createMock(KerberosServiceDescriptor.class);
  expect(serviceDescriptor1.getName()).andReturn("SERVICE1").times(2);
  expect(serviceDescriptor1.getIdentities(true)).andReturn(Arrays.asList(identityDescriptor1,identityDescriptor2,identityDescriptor3)).times(1);
  expect(serviceDescriptor1.getComponents()).andReturn(null).times(1);
  expect(serviceDescriptor1.getAuthToLocalProperties()).andReturn(new HashSet<String>(Arrays.asList("default","explicit_multiple_lines|new_lines","explicit_multiple_lines_escaped|new_lines_escaped","explicit_single_line|spaces","service-site/default","service-site/explicit_multiple_lines|new_lines","service-site/explicit_multiple_lines_escaped|new_lines_escaped","service-site/explicit_single_line|spaces"))).times(1);
  final KerberosDescriptor kerberosDescriptor=createMock(KerberosDescriptor.class);
  expect(kerberosDescriptor.getProperty("additional_realms")).andReturn(null).times(1);
  expect(kerberosDescriptor.getIdentities()).andReturn(null).times(1);
  expect(kerberosDescriptor.getAuthToLocalProperties()).andReturn(null).times(1);
  expect(kerberosDescriptor.getServices()).andReturn(Collections.singletonMap("SERVICE1",serviceDescriptor1)).times(1);
  final Service service1=createNiceMock(Service.class);
  final Cluster cluster=createNiceMock(Cluster.class);
  expect(cluster.getServices()).andReturn(Collections.singletonMap("SERVICE1",service1)).times(1);
  Map<String,Map<String,String>> kerberosConfigurations=new HashMap<String,Map<String,String>>();
  replayAll();
  injector.getInstance(AmbariMetaInfo.class).init();
  Map existingConfigs=new HashMap<String,Map<String,String>>();
  existingConfigs.put("kerberos-env",new HashMap<String,String>());
  kerberosHelper.setAuthToLocalRules(kerberosDescriptor,cluster,"EXAMPLE.COM",existingConfigs,kerberosConfigurations);
  verifyAll();
  Map<String,String> configs;
  configs=kerberosConfigurations.get("");
  assertNotNull(configs);
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("default"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("explicit_multiple_lines"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\\\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\\\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\\\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\\\n"+ "DEFAULT",configs.get("explicit_multiple_lines_escaped"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*// " + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/ " + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/ "+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/ "+ "DEFAULT",configs.get("explicit_single_line"));
  configs=kerberosConfigurations.get("service-site");
  assertNotNull(configs);
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("default"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("explicit_multiple_lines"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\\\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\\\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\\\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\\\n"+ "DEFAULT",configs.get("explicit_multiple_lines_escaped"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*// " + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/ " + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/ "+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/ "+ "DEFAULT",configs.get("explicit_single_line"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleService() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1",null,"SERVICE1",null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(2,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleHost() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1","host1",null,null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(1,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(3,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetServiceConfigurationUpdates() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  final Host hostA=createMockHost("hostA");
  final Host hostB=createMockHost("hostB");
  final Host hostC=createMockHost("hostC");
  Collection<Host> hosts=Arrays.asList(hostA,hostB,hostC);
  final Map<String,String> kerberosEnvProperties=new HashMap<String,String>(){
{
      put("kdc_type","mit-kdc");
      put("realm","FOOBAR.COM");
      put("case_insensitive_username_rules","false");
    }
  }
;
  final Config kerberosEnvConfig=createMock(Config.class);
  expect(kerberosEnvConfig.getProperties()).andReturn(kerberosEnvProperties).atLeastOnce();
  final Map<String,String> krb5ConfProperties=createMock(Map.class);
  final Config krb5ConfConfig=createMock(Config.class);
  expect(krb5ConfConfig.getProperties()).andReturn(krb5ConfProperties).atLeastOnce();
  final KerberosPrincipalDescriptor principalDescriptor1=createMockPrincipalDescriptor("service1/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service1user","service1-site/service.kerberos.principal");
  final KerberosPrincipalDescriptor principalDescriptor1a=createMockPrincipalDescriptor("component1a/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service1user","service1-site/component1a.kerberos.principal");
  final KerberosPrincipalDescriptor principalDescriptor1b=createMockPrincipalDescriptor("component1b/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service1user","service1-site/component1b.kerberos.principal");
  final KerberosPrincipalDescriptor principalDescriptor2a=createMockPrincipalDescriptor("component2a/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service2user","service2-site/component2a.kerberos.principal");
  final KerberosPrincipalDescriptor principalDescriptor2b=createMockPrincipalDescriptor("component2b/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service2user","service2-site/component2b.kerberos.principal");
  final KerberosPrincipalDescriptor principalDescriptor3a=createMockPrincipalDescriptor("component3a/_HOST@${realm}",KerberosPrincipalType.SERVICE,"service3user","service3-site/component3a.kerberos.principal");
  final KerberosKeytabDescriptor keytabDescriptor1=createMockKeytabDescriptor("keytab1","service1-site/service.kerberos.keytab");
  final KerberosKeytabDescriptor keytabDescriptor1a=createMockKeytabDescriptor("keytab1a","service1-site/component1a.kerberos.keytab");
  final KerberosKeytabDescriptor keytabDescriptor1b=createMockKeytabDescriptor("keytab1b","service1-site/component1b.kerberos.keytab");
  final KerberosKeytabDescriptor keytabDescriptor2a=createMockKeytabDescriptor("keytab2a","service2-site/component2a.kerberos.keytab");
  final KerberosKeytabDescriptor keytabDescriptor2b=createMockKeytabDescriptor("keytab2b","service2-site/component2b.kerberos.keytab");
  final KerberosKeytabDescriptor keytabDescriptor3a=createMockKeytabDescriptor("keytab3a","service3-site/component3a.kerberos.keytab");
  final KerberosIdentityDescriptor identityDescriptor1=createMockIdentityDescriptor("identity1",principalDescriptor1,keytabDescriptor1);
  final KerberosIdentityDescriptor identityDescriptor1a=createMockIdentityDescriptor("identity1a",principalDescriptor1a,keytabDescriptor1a);
  final KerberosIdentityDescriptor identityDescriptor1b=createMockIdentityDescriptor("identity1b",principalDescriptor1b,keytabDescriptor1b);
  final KerberosIdentityDescriptor identityDescriptor2a=createMockIdentityDescriptor("identity2a",principalDescriptor2a,keytabDescriptor2a);
  final KerberosIdentityDescriptor identityDescriptor2b=createMockIdentityDescriptor("identity2b",principalDescriptor2b,keytabDescriptor2b);
  final KerberosIdentityDescriptor identityDescriptor3a=createMockIdentityDescriptor("identity3a",principalDescriptor3a,keytabDescriptor3a);
  final KerberosComponentDescriptor componentDescriptor1a=createMockComponentDescriptor("COMPONENT1A",new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor1a);
    }
  }
,new HashMap<String,KerberosConfigurationDescriptor>(){
{
      put("service1-site",createMockConfigurationDescriptor(Collections.singletonMap("component1a.property","${replacement1}")));
    }
  }
);
  final KerberosComponentDescriptor componentDescriptor1b=createMockComponentDescriptor("COMPONENT1B",new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor1b);
    }
  }
,new HashMap<String,KerberosConfigurationDescriptor>(){
{
      put("service1-site",createMockConfigurationDescriptor(Collections.singletonMap("component1b.property","${type1/replacement1}")));
    }
  }
);
  final KerberosComponentDescriptor componentDescriptor2a=createMockComponentDescriptor("COMPONENT2A",new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor2a);
    }
  }
,new HashMap<String,KerberosConfigurationDescriptor>(){
{
      put("service2-site",createMockConfigurationDescriptor(Collections.singletonMap("component2a.property","${type1/replacement2}")));
    }
  }
);
  final KerberosComponentDescriptor componentDescriptor2b=createMockComponentDescriptor("COMPONENT2B",new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor2b);
    }
  }
,new HashMap<String,KerberosConfigurationDescriptor>(){
{
      put("service2-site",createMockConfigurationDescriptor(Collections.singletonMap("component2b.property","${type2/replacement1}")));
    }
  }
);
  final KerberosComponentDescriptor componentDescriptor3a=createMockComponentDescriptor("COMPONENT3A",new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor3a);
    }
  }
,new HashMap<String,KerberosConfigurationDescriptor>(){
{
      put("service3-site",createMockConfigurationDescriptor(Collections.singletonMap("component3a.property","${type3/replacement1}")));
      put("core-site",createMockConfigurationDescriptor(Collections.singletonMap("component3b.property","${type3/replacement2}")));
    }
  }
);
  final KerberosServiceDescriptor serviceDescriptor1=createMockServiceDescriptor("SERVICE1",new HashMap<String,KerberosComponentDescriptor>(){
{
      put("COMPONENT1A",componentDescriptor1a);
      put("COMPONENT1B",componentDescriptor1b);
    }
  }
,new ArrayList<KerberosIdentityDescriptor>(){
{
      add(identityDescriptor1);
    }
  }
);
  final KerberosServiceDescriptor serviceDescriptor2=createMockServiceDescriptor("SERVICE2",new HashMap<String,KerberosComponentDescriptor>(){
{
      put("COMPONENT2A",componentDescriptor2a);
      put("COMPONENT2B",componentDescriptor2b);
    }
  }
,Collections.<KerberosIdentityDescriptor>emptyList());
  final KerberosServiceDescriptor serviceDescriptor3=createMockServiceDescriptor("SERVICE3",new HashMap<String,KerberosComponentDescriptor>(){
{
      put("COMPONENT3A",componentDescriptor3a);
    }
  }
,Collections.<KerberosIdentityDescriptor>emptyList());
  final Map<String,String> kerberosDescriptorProperties=new HashMap<String,String>();
  kerberosDescriptorProperties.put("realm","${kerberos-env/realm}");
  final KerberosDescriptor kerberosDescriptor=createMock(KerberosDescriptor.class);
  expect(kerberosDescriptor.getProperties()).andReturn(kerberosDescriptorProperties).atLeastOnce();
  expect(kerberosDescriptor.getServices()).andReturn(new HashMap<String,KerberosServiceDescriptor>(){
{
      put("SERVICE1",serviceDescriptor1);
      put("SERVICE2",serviceDescriptor2);
      put("SERVICE3",serviceDescriptor3);
    }
  }
).atLeastOnce();
  expect(kerberosDescriptor.getService("SERVICE1")).andReturn(serviceDescriptor1).atLeastOnce();
  expect(kerberosDescriptor.getService("SERVICE2")).andReturn(serviceDescriptor2).atLeastOnce();
  expect(kerberosDescriptor.getService("SERVICE3")).andReturn(serviceDescriptor3).atLeastOnce();
  expect(kerberosDescriptor.getProperty("additional_realms")).andReturn(null).atLeastOnce();
  expect(kerberosDescriptor.getIdentities()).andReturn(null).atLeastOnce();
  expect(kerberosDescriptor.getAuthToLocalProperties()).andReturn(Collections.singleton("core-site/auth.to.local")).atLeastOnce();
  final ResourceProvider artifactResourceProvider=createMock(ArtifactResourceProvider.class);
  expect(artifactResourceProvider.getResources(anyObject(Request.class),anyObject(Predicate.class))).andReturn(Collections.<Resource>emptySet()).atLeastOnce();
  expect(metaInfo.getKerberosDescriptor("HDP","2.2")).andReturn(kerberosDescriptor).atLeastOnce();
  expect(clusterController.ensureResourceProvider(Resource.Type.Artifact)).andReturn(artifactResourceProvider).atLeastOnce();
  RecommendationResponse.BlueprintConfigurations coreSiteRecommendation=createMock(RecommendationResponse.BlueprintConfigurations.class);
  expect(coreSiteRecommendation.getProperties()).andReturn(Collections.singletonMap("newPropertyRecommendation","newPropertyRecommendation"));
  RecommendationResponse.BlueprintConfigurations newTypeRecommendation=createMock(RecommendationResponse.BlueprintConfigurations.class);
  expect(newTypeRecommendation.getProperties()).andReturn(Collections.singletonMap("newTypeRecommendation","newTypeRecommendation"));
  RecommendationResponse.BlueprintConfigurations type1Recommendation=createMock(RecommendationResponse.BlueprintConfigurations.class);
  expect(type1Recommendation.getProperties()).andReturn(Collections.singletonMap("replacement1","not replaced"));
  RecommendationResponse.BlueprintConfigurations service1SiteRecommendation=createMock(RecommendationResponse.BlueprintConfigurations.class);
  expect(service1SiteRecommendation.getProperties()).andReturn(Collections.singletonMap("component1b.property","replaced value"));
  Map<String,RecommendationResponse.BlueprintConfigurations> configurations=new HashMap<String,RecommendationResponse.BlueprintConfigurations>();
  configurations.put("core-site",coreSiteRecommendation);
  configurations.put("new-type",newTypeRecommendation);
  configurations.put("type1",type1Recommendation);
  configurations.put("service1-site",service1SiteRecommendation);
  RecommendationResponse.Blueprint blueprint=createMock(RecommendationResponse.Blueprint.class);
  expect(blueprint.getConfigurations()).andReturn(configurations).once();
  RecommendationResponse.Recommendation recommendations=createMock(RecommendationResponse.Recommendation.class);
  expect(recommendations.getBlueprint()).andReturn(blueprint).once();
  RecommendationResponse recommendationResponse=createMock(RecommendationResponse.class);
  expect(recommendationResponse.getRecommendations()).andReturn(recommendations).once();
  StackAdvisorHelper stackAdvisorHelper=injector.getInstance(StackAdvisorHelper.class);
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(null).once();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(recommendationResponse).once();
  final Service service1=createMockService("SERVICE1",new HashMap<String,ServiceComponent>(){
{
      put("COMPONENT1A",createMockComponent("COMPONENT1A",true,new HashMap<String,ServiceComponentHost>(){
{
          put("hostA",createMockServiceComponentHost());
        }
      }
));
      put("COMPONENT1B",createMockComponent("COMPONENT1B",false,new HashMap<String,ServiceComponentHost>(){
{
          put("hostB",createMockServiceComponentHost());
          put("hostC",createMockServiceComponentHost());
        }
      }
));
    }
  }
);
  final Service service2=createMockService("SERVICE2",new HashMap<String,ServiceComponent>(){
{
      put("COMPONENT2A",createMockComponent("COMPONENT2A",true,new HashMap<String,ServiceComponentHost>(){
{
          put("hostA",createMockServiceComponentHost());
        }
      }
));
      put("COMPONENT2B",createMockComponent("COMPONENT2B",false,new HashMap<String,ServiceComponentHost>(){
{
          put("hostB",createMockServiceComponentHost());
          put("hostC",createMockServiceComponentHost());
        }
      }
));
    }
  }
);
  final Service service3=createMockService("SERVICE3",new HashMap<String,ServiceComponent>(){
{
      put("COMPONENT3A",createMockComponent("COMPONENT3A",true,new HashMap<String,ServiceComponentHost>(){
{
          put("hostA",createMockServiceComponentHost());
        }
      }
));
    }
  }
);
  final Cluster cluster=createMock(Cluster.class);
  expect(cluster.getDesiredConfigByType("krb5-conf")).andReturn(krb5ConfConfig).atLeastOnce();
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(kerberosEnvConfig).atLeastOnce();
  expect(cluster.getSecurityType()).andReturn(SecurityType.KERBEROS).atLeastOnce();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.2")).atLeastOnce();
  expect(cluster.getClusterName()).andReturn("c1").atLeastOnce();
  expect(cluster.getHosts()).andReturn(hosts).anyTimes();
  expect(cluster.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("SERVICE1",service1);
      put("SERVICE2",service2);
      put("SERVICE3",service3);
    }
  }
).anyTimes();
  expect(cluster.isBluePrintDeployed()).andReturn(false).atLeastOnce();
  final Map<String,Map<String,String>> existingConfigurations=new HashMap<String,Map<String,String>>(){
{
      put("kerberos-env",kerberosEnvProperties);
      put("",new HashMap<String,String>(){
{
          put("replacement1","value1");
        }
      }
);
      put("type1",new HashMap<String,String>(){
{
          put("replacement1","value2");
          put("replacement2","value3");
        }
      }
);
      put("type2",new HashMap<String,String>(){
{
          put("replacement1","value4");
          put("replacement2","value5");
        }
      }
);
      put("type3",new HashMap<String,String>(){
{
          put("replacement1","value6");
          put("replacement2","value7");
        }
      }
);
    }
  }
;
  replayAll();
  injector.getInstance(AmbariMetaInfo.class).init();
  Map<String,Map<String,String>> updates1=kerberosHelper.getServiceConfigurationUpdates(cluster,existingConfigurations,new HashSet<String>(Arrays.asList("SERVICE1","SERVICE2","SERVICE3")),false,true,true);
  Map<String,Map<String,String>> updates2=kerberosHelper.getServiceConfigurationUpdates(cluster,existingConfigurations,new HashSet<String>(Arrays.asList("SERVICE1","SERVICE3")),false,true,true);
  verifyAll();
  Map<String,Map<String,String>> expectedUpdates=new HashMap<String,Map<String,String>>(){
{
      put("service1-site",new HashMap<String,String>(){
{
          put("service.kerberos.principal","service1/_HOST@FOOBAR.COM");
          put("service.kerberos.keytab","keytab1");
          put("component1a.kerberos.principal","component1a/_HOST@FOOBAR.COM");
          put("component1a.kerberos.keytab","keytab1a");
          put("component1a.property","value1");
          put("component1b.kerberos.principal","component1b/_HOST@FOOBAR.COM");
          put("component1b.kerberos.keytab","keytab1b");
          put("component1b.property","value2");
        }
      }
);
      put("service2-site",new HashMap<String,String>(){
{
          put("component2a.kerberos.principal","component2a/_HOST@FOOBAR.COM");
          put("component2a.kerberos.keytab","keytab2a");
          put("component2a.property","value3");
          put("component2b.kerberos.principal","component2b/_HOST@FOOBAR.COM");
          put("component2b.kerberos.keytab","keytab2b");
          put("component2b.property","value4");
        }
      }
);
      put("service3-site",new HashMap<String,String>(){
{
          put("component3a.kerberos.principal","component3a/_HOST@FOOBAR.COM");
          put("component3a.kerberos.keytab","keytab3a");
          put("component3a.property","value6");
        }
      }
);
      put("core-site",new HashMap<String,String>(){
{
          put("auth.to.local","RULE:[1:$1@$0](.*@FOOBAR.COM)s/@.*//\n" + "RULE:[2:$1@$0](component1a@FOOBAR.COM)s/.*/service1user/\n" + "RULE:[2:$1@$0](component1b@FOOBAR.COM)s/.*/service1user/\n"+ "RULE:[2:$1@$0](component2a@FOOBAR.COM)s/.*/service2user/\n"+ "RULE:[2:$1@$0](component2b@FOOBAR.COM)s/.*/service2user/\n"+ "RULE:[2:$1@$0](component3a@FOOBAR.COM)s/.*/service3user/\n"+ "RULE:[2:$1@$0](service1@FOOBAR.COM)s/.*/service1user/\n"+ "DEFAULT");
          put("component3b.property","value7");
        }
      }
);
    }
  }
;
  assertEquals(expectedUpdates,updates1);
  expectedUpdates.remove("service2-site");
  expectedUpdates.get("core-site").put("newPropertyRecommendation","newPropertyRecommendation");
  expectedUpdates.get("service1-site").put("component1b.property","replaced value");
  expectedUpdates.put("new-type",new HashMap<String,String>(){
{
      put("newTypeRecommendation","newTypeRecommendation");
    }
  }
);
  assertEquals(expectedUpdates,updates2);
  Map<String,Map<String,String>> expectedExistingConfigurations=new HashMap<String,Map<String,String>>(){
{
      put("kerberos-env",new HashMap<String,String>(){
{
          put("kdc_type","mit-kdc");
          put("realm","FOOBAR.COM");
          put("case_insensitive_username_rules","false");
        }
      }
);
      put("",new HashMap<String,String>(){
{
          put("replacement1","value1");
        }
      }
);
      put("type1",new HashMap<String,String>(){
{
          put("replacement1","value2");
          put("replacement2","value3");
        }
      }
);
      put("type2",new HashMap<String,String>(){
{
          put("replacement1","value4");
          put("replacement2","value5");
        }
      }
);
      put("type3",new HashMap<String,String>(){
{
          put("replacement1","value6");
          put("replacement2","value7");
        }
      }
);
    }
  }
;
  assertEquals(expectedExistingConfigurations,existingConfigurations);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleComponent() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1",null,null,"COMPONENT2",true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(2,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(1,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(1,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.MaintenanceStateHelperTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHostComponentOperationsAllowance() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Method getEffectiveState=MaintenanceStateHelper.class.getMethod("getEffectiveState",new Class[]{ServiceComponentHost.class});
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).addMockedMethod(getEffectiveState).createNiceMock();
  ServiceComponentHost sch=createMock(ServiceComponentHost.class);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.ON);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE_AND_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.OFF);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.ON);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE_AND_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.OFF);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.ON);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE_AND_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.OFF);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.ON);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.IMPLIED_FROM_SERVICE_AND_HOST);
  expect(maintenanceStateHelper.getEffectiveState(anyObject(ServiceComponentHost.class))).andReturn(MaintenanceState.OFF);
  replay(maintenanceStateHelper,sch);
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,sch));
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,sch));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,sch));
  verify(maintenanceStateHelper,sch);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCutOffHosts() throws AmbariException {
  MaintenanceStateHelper.HostPredicate predicate=createMock(MaintenanceStateHelper.HostPredicate.class);
  expect(predicate.shouldHostBeRemoved(eq("host1"))).andReturn(true);
  expect(predicate.shouldHostBeRemoved(eq("host2"))).andReturn(false);
  expect(predicate.shouldHostBeRemoved(eq("host3"))).andReturn(true);
  expect(predicate.shouldHostBeRemoved(eq("host4"))).andReturn(false);
  Set<String> candidates=new HashSet<String>();
  candidates.add("host1");
  candidates.add("host2");
  candidates.add("host3");
  candidates.add("host4");
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  replay(predicate,maintenanceStateHelper);
  Set<String> ignored=maintenanceStateHelper.filterHostsInMaintenanceState(candidates,predicate);
  verify(predicate,maintenanceStateHelper);
  Assert.assertEquals(candidates.size(),2);
  Assert.assertTrue(candidates.contains("host2"));
  Assert.assertTrue(candidates.contains("host4"));
  Assert.assertEquals(ignored.size(),2);
  Assert.assertTrue(ignored.contains("host1"));
  Assert.assertTrue(ignored.contains("host3"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHostComponentImpliedState() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  ServiceComponentHost sch=createMock(ServiceComponentHost.class);
  Service service=createNiceMock(Service.class);
  final Host host=createNiceMock(Host.class);
  expect(sch.getClusterName()).andReturn("c1").anyTimes();
  expect(clusters.getCluster("c1")).andReturn(cluster).anyTimes();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  expect(cluster.getClusterId()).andReturn(1L).anyTimes();
  expect(clusters.getHost("h1")).andReturn(host).anyTimes();
  expect(sch.getHostName()).andReturn("h1").anyTimes();
  expect(sch.getServiceName()).andReturn("HDFS").anyTimes();
  expect(cluster.getService("HDFS")).andReturn(service).anyTimes();
  expect(sch.getMaintenanceState()).andReturn(MaintenanceState.ON).times(1).andReturn(MaintenanceState.OFF).anyTimes();
  expect(service.getMaintenanceState()).andReturn(MaintenanceState.ON);
  expect(host.getMaintenanceState(1L)).andReturn(MaintenanceState.ON);
  expect(service.getMaintenanceState()).andReturn(MaintenanceState.ON);
  expect(host.getMaintenanceState(1L)).andReturn(MaintenanceState.OFF);
  expect(service.getMaintenanceState()).andReturn(MaintenanceState.OFF);
  expect(host.getMaintenanceState(1L)).andReturn(MaintenanceState.ON);
  injectField(maintenanceStateHelper,clusters);
  replay(maintenanceStateHelper,clusters,cluster,sch,host,service);
  MaintenanceState state=maintenanceStateHelper.getEffectiveState(sch);
  Assert.assertEquals(MaintenanceState.ON,state);
  state=maintenanceStateHelper.getEffectiveState(sch);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE_AND_HOST,state);
  state=maintenanceStateHelper.getEffectiveState(sch);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE,state);
  state=maintenanceStateHelper.getEffectiveState(sch);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_HOST,state);
  verify(maintenanceStateHelper,clusters,cluster,sch,host,service);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHostOperationsAllowance() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  Host host=createMock(Host.class);
  expect(host.getMaintenanceState(anyInt())).andReturn(MaintenanceState.ON);
  expect(host.getMaintenanceState(anyInt())).andReturn(MaintenanceState.OFF);
  replay(maintenanceStateHelper,host);
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Cluster));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Host));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.HostComponent));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Cluster));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.Host));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(host,1,Resource.Type.HostComponent));
  verify(maintenanceStateHelper,host);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceOperationsAllowance() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  Service service=createMock(Service.class);
  expect(service.getMaintenanceState()).andReturn(MaintenanceState.ON);
  expect(service.getMaintenanceState()).andReturn(MaintenanceState.OFF);
  replay(maintenanceStateHelper,service);
  Assert.assertEquals(false,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Cluster,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Service,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.Host,service));
  Assert.assertEquals(true,maintenanceStateHelper.isOperationAllowed(Resource.Type.HostComponent,service));
  verify(maintenanceStateHelper,service);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGuessOperationLevel(){
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  replay(maintenanceStateHelper);
  Assert.assertEquals(Resource.Type.Cluster,maintenanceStateHelper.guessOperationLevel(null));
  RequestResourceFilter resourceFilter=new RequestResourceFilter(null,null,null);
  Assert.assertEquals(Resource.Type.Cluster,maintenanceStateHelper.guessOperationLevel(resourceFilter));
  resourceFilter=new RequestResourceFilter("HDFS",null,null);
  Assert.assertEquals(Resource.Type.Service,maintenanceStateHelper.guessOperationLevel(resourceFilter));
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  Assert.assertEquals(Resource.Type.Service,maintenanceStateHelper.guessOperationLevel(resourceFilter));
  ArrayList<String> hosts=new ArrayList<String>();
  hosts.add("host1");
  hosts.add("host2");
  resourceFilter=new RequestResourceFilter("HDFS",null,hosts);
  Assert.assertEquals(Resource.Type.Cluster,maintenanceStateHelper.guessOperationLevel(resourceFilter));
  resourceFilter=new RequestResourceFilter(null,null,hosts);
  Assert.assertEquals(Resource.Type.Host,maintenanceStateHelper.guessOperationLevel(resourceFilter));
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",hosts);
  Assert.assertEquals(Resource.Type.HostComponent,maintenanceStateHelper.guessOperationLevel(resourceFilter));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.RefreshYarnCapacitySchedulerReleaseConfigTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllRequiresRestart() throws AmbariException, AuthorizationException {
  createClusterFixture("HDP-2.0.7");
  Cluster cluster=clusters.getCluster("c1");
  ClusterRequest cr=new ClusterRequest(cluster.getClusterId(),"c1",cluster.getDesiredStackVersion().getStackVersion(),null);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest("c1","core-site","version2",new HashMap<String,String>(),null)));
  controller.updateClusters(Collections.singleton(cr),null);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest("c1",null,null,null,null);
  r.setStaleConfig("true");
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(4,resps.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponent() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest("HDP","2.0.6","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRMRequiresRestart() throws AmbariException, AuthorizationException {
  createClusterFixture("HDP-2.0.7");
  Cluster cluster=clusters.getCluster("c1");
  ClusterRequest cr=new ClusterRequest(cluster.getClusterId(),"c1",cluster.getDesiredStackVersion().getStackVersion(),null);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest("c1","capacity-scheduler","version2",new HashMap<String,String>(),null)));
  controller.updateClusters(Collections.singleton(cr),null);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest("c1",null,null,null,null);
  r.setStaleConfig("true");
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  Assert.assertEquals(true,configHelper.isStaleConfigs(clusters.getCluster("c1").getService("YARN").getServiceComponent("RESOURCEMANAGER").getServiceComponentHost("c6401")));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponentOverwrited() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest("HDP","2.0.7","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerClusterProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerClusterProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("ambari").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource next=resources.iterator().next();
  Assert.assertEquals("ambari",next.getPropertyValue(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID));
  Assert.assertEquals("HDP-1.2.0",next.getPropertyValue(GSInstallerClusterProvider.CLUSTER_VERSION_PROPERTY_ID));
  predicate=new PredicateBuilder().property(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("non-existent Cluster").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerHostProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckStateFromCategory() throws Exception {
  TestGSInstallerStateProvider stateProvider=new TestGSInstallerStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,500);
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("ip-10-190-97-104.ec2.internal").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest("Hosts"),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("HEALTHY",resource.getPropertyValue(GSInstallerHostProvider.HOST_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  Thread.sleep(501);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INIT",resource.getPropertyValue(GSInstallerHostProvider.HOST_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckState() throws Exception {
  TestGSInstallerStateProvider stateProvider=new TestGSInstallerStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,500);
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("ip-10-190-97-104.ec2.internal").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("HEALTHY",resource.getPropertyValue(GSInstallerHostProvider.HOST_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  Thread.sleep(501);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INIT",resource.getPropertyValue(GSInstallerHostProvider.HOST_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerServiceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckStateFromCategory() throws Exception {
  TestGSInstallerStateProvider stateProvider=new TestGSInstallerStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,500);
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest("ServiceInfo"),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("STARTED",resource.getPropertyValue(GSInstallerServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  Thread.sleep(501);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INIT",resource.getPropertyValue(GSInstallerServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesCheckState() throws Exception {
  TestGSInstallerStateProvider stateProvider=new TestGSInstallerStateProvider();
  ClusterDefinition clusterDefinition=new ClusterDefinition(stateProvider,500);
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("STARTED",resource.getPropertyValue(GSInstallerServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  stateProvider.setHealthy(false);
  Thread.sleep(501);
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  resource=resources.iterator().next();
  Assert.assertEquals("INIT",resource.getPropertyValue(GSInstallerServiceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractControllerResourceProviderTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRoleAuthorizationResourceProvider(){
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.RoleAuthorization,null,null,managementController);
  verify(managementController);
  assertEquals(RoleAuthorizationResourceProvider.class,provider.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStackArtifactResourceProvider(){
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.StackArtifact,null,null,managementController);
  assertEquals(StackArtifactResourceProvider.class,provider.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetUserAuthorizationResourceProvider(){
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.UserAuthorization,null,null,managementController);
  verify(managementController);
  assertEquals(UserAuthorizationResourceProvider.class,provider.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourceProvider() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ResourceProviderFactory factory=createMock(ResourceProviderFactory.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  ResourceProvider serviceResourceProvider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  expect(factory.getServiceResourceProvider(propertyIds,keyPropertyIds,managementController)).andReturn(serviceResourceProvider);
  AbstractControllerResourceProvider.init(factory);
  replay(managementController,factory,maintenanceStateHelper);
  AbstractResourceProvider provider=(AbstractResourceProvider)AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Service,propertyIds,keyPropertyIds,managementController);
  Assert.assertTrue(provider instanceof ServiceResourceProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractDRResourceProviderTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourceProvider() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  IvoryService ivoryService=createMock(IvoryService.class);
  AbstractResourceProvider provider=(AbstractResourceProvider)AbstractDRResourceProvider.getResourceProvider(Resource.Type.DRFeed,propertyIds,keyPropertyIds,ivoryService);
  Assert.assertTrue(provider instanceof FeedResourceProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractPropertyProviderTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSubstituteArguments() throws Exception {
  String newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1/name2/$2","$1","foo");
  Assert.assertEquals("category/name1/foo/name2/$2",newPropertyId);
  newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1/name2/$2","$2","bar");
  Assert.assertEquals("category/name1/$1/name2/bar",newPropertyId);
  newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1.toLowerCase()/name2/$2.toUpperCase()","$1","FOO");
  Assert.assertEquals("category/name1/foo/name2/$2.toUpperCase()",newPropertyId);
  newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1.toLowerCase()/name2/$2.toUpperCase()","$2","bar");
  Assert.assertEquals("category/name1/$1.toLowerCase()/name2/BAR",newPropertyId);
  newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1.toLowerCase().substring(1)/name2","$1","FOO");
  Assert.assertEquals("category/name1/oo/name2",newPropertyId);
  newPropertyId=AbstractPropertyProvider.substituteArgument("category/name1/$1.toLowerCase().substring(1).concat(\"_post\")/name2/$2.concat(\"_post\")","$1","FOO");
  newPropertyId=AbstractPropertyProvider.substituteArgument(newPropertyId,"$2","bar");
  Assert.assertEquals("category/name1/oo_post/name2/bar_post",newPropertyId);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateComponentMetricMapHDP1(){
  Map<String,Map<String,PropertyInfo>> componentMetrics=PropertyHelper.getMetricPropertyIds(Resource.Type.HostComponent);
  AbstractPropertyProvider provider=new TestPropertyProvider(componentMetrics);
  Map<String,PropertyInfo> flumeMetrics=provider.getComponentMetrics().get("FLUME_HANDLER");
  int metricsBefore=flumeMetrics.size();
  String specificMetric="metrics/flume/arg1/CHANNEL/arg2/ChannelCapacity";
  String specificPropertyInfoId="arg1.CHANNEL.arg2.ChannelCapacity";
  Map<String,PropertyInfo> componentMetricMap=provider.getComponentMetrics().get("FLUME_HANDLER");
  Assert.assertNull(flumeMetrics.get(specificMetric));
  provider.updateComponentMetricMap(componentMetricMap,specificMetric);
  Assert.assertEquals(metricsBefore + 1,flumeMetrics.size());
  Assert.assertNotNull(flumeMetrics.get(specificMetric));
  Assert.assertEquals(specificPropertyInfoId,flumeMetrics.get(specificMetric).getPropertyId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetQueryParameterValue(){
  String queryParameterId1="qp/variable1";
  String queryParameterValue1="value1";
  String queryParameterId2="qp/variable2";
  String queryParameterValue2="value2";
  Predicate predicate=new PredicateBuilder().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  String queryParameterId3="qp/variable3";
  String queryParameterValue3="value3";
  predicate=new PredicateBuilder().property(queryParameterId3).equals(queryParameterValue3).and().begin().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).end().toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  Assert.assertEquals(queryParameterValue3,AbstractResourceProvider.getQueryParameterValue(queryParameterId3,predicate));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyMaps() throws Exception {
  AbstractResourceProvider provider=new TestResourceProvider();
  Map<String,Object> updatePropertyMap=new HashMap<String,Object>();
  updatePropertyMap.put("SomeProperty","SomeUpdateValue");
  updatePropertyMap.put("SomeOtherProperty",99);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("ClusterName").equals("c1").and().property("ResourceName").equals("r1").toPredicate();
  Set<Map<String,Object>> propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(1,propertyMaps.size());
  Map<String,Object> map=propertyMaps.iterator().next();
  Assert.assertEquals(4,map.size());
  Assert.assertEquals("c1",map.get("ClusterName"));
  Assert.assertEquals("r1",map.get("ResourceName"));
  Assert.assertEquals("SomeUpdateValue",map.get("SomeProperty"));
  Assert.assertEquals(99,map.get("SomeOtherProperty"));
  pb=new PredicateBuilder();
  predicate=pb.property("ClusterName").equals("c1").and().begin().property("ResourceName").equals("r1").or().property("ResourceName").equals("r2").end().toPredicate();
  propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(2,propertyMaps.size());
  for (  Map<String,Object> map2 : propertyMaps) {
    Assert.assertEquals(4,map2.size());
    Assert.assertEquals("c1",map2.get("ClusterName"));
    Object resourceName=map2.get("ResourceName");
    Assert.assertTrue(resourceName.equals("r1") || resourceName.equals("r2"));
    Assert.assertEquals("SomeUpdateValue",map2.get("SomeProperty"));
    Assert.assertEquals(99,map2.get("SomeOtherProperty"));
  }
  predicate=new AlwaysPredicate();
  propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(4,propertyMaps.size());
  for (  Map<String,Object> map2 : propertyMaps) {
    Assert.assertEquals(4,map2.size());
    Assert.assertEquals("c1",map2.get("ClusterName"));
    Object resourceName=map2.get("ResourceName");
    Assert.assertTrue(resourceName.equals("r1") || resourceName.equals("r2") || resourceName.equals("r3")|| resourceName.equals("r4"));
    Assert.assertEquals("SomeUpdateValue",map2.get("SomeProperty"));
    Assert.assertEquals(99,map2.get("SomeOtherProperty"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestStatus(){
  Set<String> propertyIds=new HashSet<String>();
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  replay(maintenanceStateHelper);
  AbstractResourceProvider provider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  RequestStatus status=provider.getRequestStatus(null);
  Assert.assertNull(status.getRequestResource());
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  RequestStatusResponse response=new RequestStatusResponse(99L);
  status=provider.getRequestStatus(response);
  Resource resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  status=provider.getRequestStatus(response,null);
  resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  Resource associatedResource=new ResourceImpl(Resource.Type.Service);
  Set<Resource> associatedResources=Collections.singleton(associatedResource);
  status=provider.getRequestStatus(response,associatedResources);
  resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(associatedResources,status.getAssociatedResources());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ActionResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Action;
  AmbariMetaInfo am=createNiceMock(AmbariMetaInfo.class);
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(am).anyTimes();
  List<ActionDefinition> allDefinition=new ArrayList<ActionDefinition>();
  allDefinition.add(new ActionDefinition("a1",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  allDefinition.add(new ActionDefinition("a2",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  allDefinition.add(new ActionDefinition("a3",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  Set<ActionResponse> allResponse=new HashSet<ActionResponse>();
  for (  ActionDefinition definition : allDefinition) {
    allResponse.add(definition.convertToResponse());
  }
  ActionDefinition namedDefinition=new ActionDefinition("a1",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100"));
  Set<ActionResponse> nameResponse=new HashSet<ActionResponse>();
  nameResponse.add(namedDefinition.convertToResponse());
  expect(am.getAllActionDefinition()).andReturn(allDefinition).once();
  expect(am.getActionDefinition("a1")).andReturn(namedDefinition).once();
  replay(managementController,am);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ActionResourceProvider.ACTION_NAME_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.ACTION_TYPE_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.DEFAULT_TIMEOUT_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.DESCRIPTION_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.INPUTS_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_COMPONENT_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_HOST_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_SERVICE_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String actionName=(String)resource.getPropertyValue(ActionResourceProvider.ACTION_NAME_PROPERTY_ID);
    String actionType=(String)resource.getPropertyValue(ActionResourceProvider.ACTION_TYPE_PROPERTY_ID);
    String defaultTimeout=(String)resource.getPropertyValue(ActionResourceProvider.DEFAULT_TIMEOUT_PROPERTY_ID);
    String description=(String)resource.getPropertyValue(ActionResourceProvider.DESCRIPTION_PROPERTY_ID);
    String inputs=(String)resource.getPropertyValue(ActionResourceProvider.INPUTS_PROPERTY_ID);
    String comp=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_COMPONENT_PROPERTY_ID);
    String svc=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_SERVICE_PROPERTY_ID);
    String host=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_HOST_PROPERTY_ID);
    Assert.assertTrue(allResponse.contains(new ActionResponse(actionName,actionType,inputs,svc,comp,description,host,defaultTimeout)));
  }
  Predicate predicate=new PredicateBuilder().property(ActionResourceProvider.ACTION_NAME_PROPERTY_ID).equals("a1").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("a1",resources.iterator().next().getPropertyValue(ActionResourceProvider.ACTION_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertResourceProviderTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testResponseIsPaginated() throws Exception {
  expect(m_dao.findAll(EasyMock.anyObject(AlertCurrentRequest.class))).andReturn(getClusterMockEntities()).atLeastOnce();
  expect(m_dao.getCount(EasyMock.anyObject(Predicate.class))).andReturn(0).atLeastOnce();
  replay(m_dao);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<String> requestProperties=new HashSet<String>();
  requestProperties.add(AlertResourceProvider.ALERT_ID);
  requestProperties.add(AlertResourceProvider.ALERT_DEFINITION_NAME);
  Request request=PropertyHelper.getReadRequest(requestProperties);
  Predicate predicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_CLUSTER_NAME).equals("c1").toPredicate();
  AlertResourceProvider provider=createProvider();
  QueryResponse response=provider.queryForResources(request,predicate);
  assertFalse(response.isPagedResponse());
  PageRequest pageRequest=new PageRequestImpl(StartingPoint.Beginning,5,10,predicate,null);
  request=PropertyHelper.getReadRequest(requestProperties,null,null,pageRequest,null);
  response=provider.queryForResources(request,predicate);
  assertTrue(response.isPagedResponse());
  verify(m_dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AmbariPrivilegeResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_allTypes() throws Exception {
  Injector injector=createInjector();
  PrivilegeEntity ambariPrivilegeEntity=createNiceMock(PrivilegeEntity.class);
  ResourceEntity ambariResourceEntity=createNiceMock(ResourceEntity.class);
  ResourceTypeEntity ambariResourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  UserEntity ambariUserEntity=createNiceMock(UserEntity.class);
  PrincipalEntity ambariPrincipalEntity=createNiceMock(PrincipalEntity.class);
  PrincipalTypeEntity ambariPrincipalTypeEntity=createNiceMock(PrincipalTypeEntity.class);
  PermissionEntity ambariPermissionEntity=createNiceMock(PermissionEntity.class);
  expect(ambariPrivilegeEntity.getResource()).andReturn(ambariResourceEntity).anyTimes();
  expect(ambariPrivilegeEntity.getId()).andReturn(31).anyTimes();
  expect(ambariPrivilegeEntity.getPrincipal()).andReturn(ambariPrincipalEntity).anyTimes();
  expect(ambariPrivilegeEntity.getPermission()).andReturn(ambariPermissionEntity).anyTimes();
  expect(ambariResourceEntity.getResourceType()).andReturn(ambariResourceTypeEntity).anyTimes();
  expect(ambariResourceTypeEntity.getId()).andReturn(ResourceType.AMBARI.getId()).anyTimes();
  expect(ambariResourceTypeEntity.getName()).andReturn(ResourceType.AMBARI.name()).anyTimes();
  expect(ambariPrincipalEntity.getId()).andReturn(1L).anyTimes();
  expect(ambariUserEntity.getPrincipal()).andReturn(ambariPrincipalEntity).anyTimes();
  expect(ambariUserEntity.getUserName()).andReturn("joe").anyTimes();
  expect(ambariPermissionEntity.getPermissionName()).andReturn("AMBARI.ADMINISTRATOR").anyTimes();
  expect(ambariPermissionEntity.getPermissionLabel()).andReturn("Administrator").anyTimes();
  expect(ambariPrincipalEntity.getPrincipalType()).andReturn(ambariPrincipalTypeEntity).anyTimes();
  expect(ambariPrincipalTypeEntity.getName()).andReturn("USER").anyTimes();
  PrivilegeEntity viewPrivilegeEntity=createNiceMock(PrivilegeEntity.class);
  ResourceEntity viewResourceEntity=createNiceMock(ResourceEntity.class);
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  ViewInstanceEntity viewInstanceEntity=createNiceMock(ViewInstanceEntity.class);
  ResourceTypeEntity viewResourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  UserEntity viewUserEntity=createNiceMock(UserEntity.class);
  PrincipalEntity viewPrincipalEntity=createNiceMock(PrincipalEntity.class);
  PrincipalTypeEntity viewPrincipalTypeEntity=createNiceMock(PrincipalTypeEntity.class);
  PermissionEntity viewPermissionEntity=createNiceMock(PermissionEntity.class);
  expect(viewPrivilegeEntity.getResource()).andReturn(viewResourceEntity).anyTimes();
  expect(viewPrivilegeEntity.getPrincipal()).andReturn(viewPrincipalEntity).anyTimes();
  expect(viewPrivilegeEntity.getPermission()).andReturn(viewPermissionEntity).anyTimes();
  expect(viewPrivilegeEntity.getId()).andReturn(33).anyTimes();
  expect(viewResourceEntity.getResourceType()).andReturn(viewResourceTypeEntity).anyTimes();
  expect(viewResourceTypeEntity.getId()).andReturn(ResourceType.VIEW.getId()).anyTimes();
  expect(viewResourceTypeEntity.getName()).andReturn(ResourceType.VIEW.name()).anyTimes();
  expect(viewPrincipalEntity.getId()).andReturn(5L).anyTimes();
  expect(viewEntity.getInstances()).andReturn(Arrays.asList(viewInstanceEntity)).anyTimes();
  expect(viewInstanceEntity.getViewEntity()).andReturn(viewEntity).anyTimes();
  expect(viewEntity.getCommonName()).andReturn("view").anyTimes();
  expect(viewEntity.getVersion()).andReturn("1.0.1").anyTimes();
  expect(viewEntity.isDeployed()).andReturn(true).anyTimes();
  expect(viewInstanceEntity.getName()).andReturn("inst1").anyTimes();
  expect(viewInstanceEntity.getResource()).andReturn(viewResourceEntity).anyTimes();
  expect(viewUserEntity.getPrincipal()).andReturn(viewPrincipalEntity).anyTimes();
  expect(viewUserEntity.getUserName()).andReturn("bob").anyTimes();
  expect(viewPermissionEntity.getPermissionName()).andReturn("VIEW.USER").anyTimes();
  expect(viewPermissionEntity.getPermissionLabel()).andReturn("View User").anyTimes();
  expect(viewPrincipalEntity.getPrincipalType()).andReturn(viewPrincipalTypeEntity).anyTimes();
  expect(viewPrincipalTypeEntity.getName()).andReturn("USER").anyTimes();
  PrivilegeEntity clusterPrivilegeEntity=createNiceMock(PrivilegeEntity.class);
  ResourceEntity clusterResourceEntity=createNiceMock(ResourceEntity.class);
  ResourceTypeEntity clusterResourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  UserEntity clusterUserEntity=createNiceMock(UserEntity.class);
  PrincipalEntity clusterPrincipalEntity=createNiceMock(PrincipalEntity.class);
  PrincipalTypeEntity clusterPrincipalTypeEntity=createNiceMock(PrincipalTypeEntity.class);
  PermissionEntity clusterPermissionEntity=createNiceMock(PermissionEntity.class);
  ClusterEntity clusterEntity=createNiceMock(ClusterEntity.class);
  expect(clusterPrivilegeEntity.getResource()).andReturn(clusterResourceEntity).anyTimes();
  expect(clusterPrivilegeEntity.getPrincipal()).andReturn(clusterPrincipalEntity).anyTimes();
  expect(clusterPrivilegeEntity.getPermission()).andReturn(clusterPermissionEntity).anyTimes();
  expect(clusterPrivilegeEntity.getId()).andReturn(32).anyTimes();
  expect(clusterResourceEntity.getId()).andReturn(7L).anyTimes();
  expect(clusterResourceEntity.getResourceType()).andReturn(clusterResourceTypeEntity).anyTimes();
  expect(clusterResourceTypeEntity.getId()).andReturn(ResourceType.CLUSTER.getId()).anyTimes();
  expect(clusterResourceTypeEntity.getName()).andReturn(ResourceType.CLUSTER.name()).anyTimes();
  expect(clusterPrincipalEntity.getId()).andReturn(8L).anyTimes();
  expect(clusterUserEntity.getPrincipal()).andReturn(clusterPrincipalEntity).anyTimes();
  expect(clusterUserEntity.getUserName()).andReturn("jeff").anyTimes();
  expect(clusterPermissionEntity.getPermissionName()).andReturn("CLUSTER.USER").anyTimes();
  expect(clusterPermissionEntity.getPermissionLabel()).andReturn("Cluster User").anyTimes();
  expect(clusterPrincipalEntity.getPrincipalType()).andReturn(clusterPrincipalTypeEntity).anyTimes();
  expect(clusterPrincipalTypeEntity.getName()).andReturn("USER").anyTimes();
  expect(clusterEntity.getResource()).andReturn(clusterResourceEntity).anyTimes();
  expect(clusterEntity.getClusterName()).andReturn("cluster1").anyTimes();
  List<UserEntity> userEntities=new LinkedList<UserEntity>();
  userEntities.add(ambariUserEntity);
  userEntities.add(viewUserEntity);
  userEntities.add(clusterUserEntity);
  List<PrivilegeEntity> privilegeEntities=new LinkedList<PrivilegeEntity>();
  privilegeEntities.add(ambariPrivilegeEntity);
  privilegeEntities.add(viewPrivilegeEntity);
  privilegeEntities.add(clusterPrivilegeEntity);
  List<ClusterEntity> clusterEntities=new LinkedList<ClusterEntity>();
  clusterEntities.add(clusterEntity);
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  expect(clusterDAO.findAll()).andReturn(clusterEntities).atLeastOnce();
  PrivilegeDAO privilegeDAO=injector.getInstance(PrivilegeDAO.class);
  expect(privilegeDAO.findAll()).andReturn(privilegeEntities).atLeastOnce();
  UserDAO userDAO=injector.getInstance(UserDAO.class);
  expect(userDAO.findUsersByPrincipal(anyObject(List.class))).andReturn(userEntities).atLeastOnce();
  GroupDAO groupDAO=injector.getInstance(GroupDAO.class);
  expect(groupDAO.findGroupsByPrincipal(anyObject(List.class))).andReturn(Collections.<GroupEntity>emptyList()).atLeastOnce();
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  ResourceProvider provider=getResourceProvider(injector);
  ViewRegistry.getInstance().addDefinition(viewEntity);
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(3,resources.size());
  Map<Object,Resource> resourceMap=new HashMap<Object,Resource>();
  for (  Resource resource : resources) {
    resourceMap.put(resource.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_ID_PROPERTY_ID),resource);
  }
  Resource resource1=resourceMap.get(31);
  Assert.assertEquals(6,resource1.getPropertiesMap().get("PrivilegeInfo").size());
  Assert.assertEquals("AMBARI.ADMINISTRATOR",resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("Administrator",resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_LABEL_PROPERTY_ID));
  Assert.assertEquals("joe",resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_NAME_PROPERTY_ID));
  Assert.assertEquals("USER",resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_TYPE_PROPERTY_ID));
  Assert.assertEquals(31,resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_ID_PROPERTY_ID));
  Assert.assertEquals("AMBARI",resource1.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_TYPE_PROPERTY_ID));
  Resource resource2=resourceMap.get(32);
  Assert.assertEquals(7,resource2.getPropertiesMap().get("PrivilegeInfo").size());
  Assert.assertEquals("CLUSTER.USER",resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("Cluster User",resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_LABEL_PROPERTY_ID));
  Assert.assertEquals("jeff",resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_NAME_PROPERTY_ID));
  Assert.assertEquals("USER",resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_TYPE_PROPERTY_ID));
  Assert.assertEquals(32,resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_ID_PROPERTY_ID));
  Assert.assertEquals("cluster1",resource2.getPropertyValue(ClusterPrivilegeResourceProvider.PRIVILEGE_CLUSTER_NAME_PROPERTY_ID));
  Assert.assertEquals("CLUSTER",resource2.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_TYPE_PROPERTY_ID));
  Resource resource3=resourceMap.get(33);
  Assert.assertEquals(9,resource3.getPropertiesMap().get("PrivilegeInfo").size());
  Assert.assertEquals("VIEW.USER",resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("View User",resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_LABEL_PROPERTY_ID));
  Assert.assertEquals("bob",resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_NAME_PROPERTY_ID));
  Assert.assertEquals("USER",resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_TYPE_PROPERTY_ID));
  Assert.assertEquals(33,resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_ID_PROPERTY_ID));
  Assert.assertEquals("view",resource3.getPropertyValue(ViewPrivilegeResourceProvider.PRIVILEGE_VIEW_NAME_PROPERTY_ID));
  Assert.assertEquals("1.0.1",resource3.getPropertyValue(ViewPrivilegeResourceProvider.PRIVILEGE_VIEW_VERSION_PROPERTY_ID));
  Assert.assertEquals("inst1",resource3.getPropertyValue(ViewPrivilegeResourceProvider.PRIVILEGE_INSTANCE_NAME_PROPERTY_ID));
  Assert.assertEquals("VIEW",resource3.getPropertyValue(AmbariPrivilegeResourceProvider.PRIVILEGE_TYPE_PROPERTY_ID));
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ArtifactResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_instance() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  TreeMap<String,String> foreignKeys=new TreeMap<String,String>();
  foreignKeys.put("cluster","500");
  Map<String,Object> childMap=new TreeMap<String,Object>();
  childMap.put("childKey","childValue");
  Map<String,Object> child2Map=new TreeMap<String,Object>();
  childMap.put("child2",child2Map);
  child2Map.put("child2Key","child2Value");
  Map<String,Object> child3Map=new TreeMap<String,Object>();
  child2Map.put("child3",child3Map);
  Map<String,Object> child4Map=new TreeMap<String,Object>();
  child3Map.put("child4",child4Map);
  child4Map.put("child4Key","child4Value");
  Map<String,Object> artifact_data=new TreeMap<String,Object>();
  artifact_data.put("foo","bar");
  artifact_data.put("child",childMap);
  Map<String,String> responseForeignKeys=new HashMap<String,String>();
  responseForeignKeys.put("cluster","500");
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("test-cluster")).andReturn(cluster).anyTimes();
  expect(clusters.getClusterById(500L)).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(500L).anyTimes();
  expect(cluster.getClusterName()).andReturn("test-cluster").anyTimes();
  expect(request.getPropertyIds()).andReturn(propertyIds).anyTimes();
  expect(dao.findByNameAndForeignKeys(eq("test-artifact"),eq(foreignKeys))).andReturn(entity).once();
  expect(entity.getArtifactName()).andReturn("test-artifact").anyTimes();
  expect(entity.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity.getArtifactData()).andReturn(artifact_data).anyTimes();
  replay(dao,em,controller,request,clusters,cluster,entity,entity2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property("Artifacts/cluster_name").equals("test-cluster").and().property("Artifacts/artifact_name").equals("test-artifact").end().toPredicate();
  Set<Resource> response=resourceProvider.getResources(request,predicate);
  assertEquals(1,response.size());
  Resource resource=response.iterator().next();
  Map<String,Map<String,Object>> responseProperties=resource.getPropertiesMap();
  assertEquals(5,responseProperties.size());
  Map<String,Object> artifactDataMap=responseProperties.get("artifact_data");
  assertEquals("bar",artifactDataMap.get("foo"));
  assertEquals("test-artifact",resource.getPropertyValue("Artifacts/artifact_name"));
  assertEquals("test-cluster",resource.getPropertyValue("Artifacts/cluster_name"));
  assertEquals("bar",resource.getPropertyValue("artifact_data/foo"));
  assertEquals("childValue",resource.getPropertyValue("artifact_data/child/childKey"));
  assertEquals("child2Value",resource.getPropertyValue("artifact_data/child/child2/child2Key"));
  assertEquals("child4Value",resource.getPropertyValue("artifact_data/child/child2/child3/child4/child4Key"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BaseBlueprintProcessorTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependenciesNoOozieClient() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo hCatDependency=new TestDependencyInfo("HIVE/HCAT");
  final DependencyInfo yarnClientDependency=new TestDependencyInfo("YARN/YARN_CLIENT");
  final DependencyInfo tezClientDependency=new TestDependencyInfo("TEZ/TEZ_CLIENT");
  final DependencyInfo mapReduceTwoClientDependency=new TestDependencyInfo("YARN/MAPREDUCE2_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(hCatDependency);
        setOfDependencies.add(yarnClientDependency);
        setOfDependencies.add(tezClientDependency);
        setOfDependencies.add(mapReduceTwoClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",4,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for HCAT","HIVE",testStack.getDependencyConditionalServiceMap().get(hCatDependency));
  assertEquals("Incorrect service dependency for YARN_CLIENT","YARN",testStack.getDependencyConditionalServiceMap().get(yarnClientDependency));
  assertEquals("Incorrect service dependency for TEZ_CLIENT","TEZ",testStack.getDependencyConditionalServiceMap().get(tezClientDependency));
  assertEquals("Incorrect service dependency for MAPREDUCE2_CLIENT","MAPREDUCE2",testStack.getDependencyConditionalServiceMap().get(mapReduceTwoClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependenciesNoMapReduceClient() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo hCatDependency=new TestDependencyInfo("HIVE/HCAT");
  final DependencyInfo yarnClientDependency=new TestDependencyInfo("YARN/YARN_CLIENT");
  final DependencyInfo tezClientDependency=new TestDependencyInfo("TEZ/TEZ_CLIENT");
  final DependencyInfo oozieClientDependency=new TestDependencyInfo("OOZIE/OOZIE_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(hCatDependency);
        setOfDependencies.add(yarnClientDependency);
        setOfDependencies.add(tezClientDependency);
        setOfDependencies.add(oozieClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",4,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for HCAT","HIVE",testStack.getDependencyConditionalServiceMap().get(hCatDependency));
  assertEquals("Incorrect service dependency for YARN_CLIENT","YARN",testStack.getDependencyConditionalServiceMap().get(yarnClientDependency));
  assertEquals("Incorrect service dependency for TEZ_CLIENT","TEZ",testStack.getDependencyConditionalServiceMap().get(tezClientDependency));
  assertEquals("Incorrect service dependency for OOZIE_CLIENT","OOZIE",testStack.getDependencyConditionalServiceMap().get(oozieClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependenciesNoHCAT() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo yarnClientDependency=new TestDependencyInfo("YARN/YARN_CLIENT");
  final DependencyInfo tezClientDependency=new TestDependencyInfo("TEZ/TEZ_CLIENT");
  final DependencyInfo mapReduceTwoClientDependency=new TestDependencyInfo("YARN/MAPREDUCE2_CLIENT");
  final DependencyInfo oozieClientDependency=new TestDependencyInfo("OOZIE/OOZIE_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(yarnClientDependency);
        setOfDependencies.add(tezClientDependency);
        setOfDependencies.add(mapReduceTwoClientDependency);
        setOfDependencies.add(oozieClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",4,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for YARN_CLIENT","YARN",testStack.getDependencyConditionalServiceMap().get(yarnClientDependency));
  assertEquals("Incorrect service dependency for TEZ_CLIENT","TEZ",testStack.getDependencyConditionalServiceMap().get(tezClientDependency));
  assertEquals("Incorrect service dependency for MAPREDUCE2_CLIENT","MAPREDUCE2",testStack.getDependencyConditionalServiceMap().get(mapReduceTwoClientDependency));
  assertEquals("Incorrect service dependency for OOZIE_CLIENT","OOZIE",testStack.getDependencyConditionalServiceMap().get(oozieClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependenciesNoTezClient() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo hCatDependency=new TestDependencyInfo("HIVE/HCAT");
  final DependencyInfo yarnClientDependency=new TestDependencyInfo("YARN/YARN_CLIENT");
  final DependencyInfo mapReduceTwoClientDependency=new TestDependencyInfo("YARN/MAPREDUCE2_CLIENT");
  final DependencyInfo oozieClientDependency=new TestDependencyInfo("OOZIE/OOZIE_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(hCatDependency);
        setOfDependencies.add(yarnClientDependency);
        setOfDependencies.add(mapReduceTwoClientDependency);
        setOfDependencies.add(oozieClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",4,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for HCAT","HIVE",testStack.getDependencyConditionalServiceMap().get(hCatDependency));
  assertEquals("Incorrect service dependency for YARN_CLIENT","YARN",testStack.getDependencyConditionalServiceMap().get(yarnClientDependency));
  assertEquals("Incorrect service dependency for MAPREDUCE2_CLIENT","MAPREDUCE2",testStack.getDependencyConditionalServiceMap().get(mapReduceTwoClientDependency));
  assertEquals("Incorrect service dependency for OOZIE_CLIENT","OOZIE",testStack.getDependencyConditionalServiceMap().get(oozieClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependenciesNoYarnClient() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo hCatDependency=new TestDependencyInfo("HIVE/HCAT");
  final DependencyInfo tezClientDependency=new TestDependencyInfo("TEZ/TEZ_CLIENT");
  final DependencyInfo mapReduceTwoClientDependency=new TestDependencyInfo("YARN/MAPREDUCE2_CLIENT");
  final DependencyInfo oozieClientDependency=new TestDependencyInfo("OOZIE/OOZIE_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(hCatDependency);
        setOfDependencies.add(tezClientDependency);
        setOfDependencies.add(mapReduceTwoClientDependency);
        setOfDependencies.add(oozieClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",4,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for HCAT","HIVE",testStack.getDependencyConditionalServiceMap().get(hCatDependency));
  assertEquals("Incorrect service dependency for TEZ_CLIENT","TEZ",testStack.getDependencyConditionalServiceMap().get(tezClientDependency));
  assertEquals("Incorrect service dependency for MAPREDUCE2_CLIENT","MAPREDUCE2",testStack.getDependencyConditionalServiceMap().get(mapReduceTwoClientDependency));
  assertEquals("Incorrect service dependency for OOZIE_CLIENT","OOZIE",testStack.getDependencyConditionalServiceMap().get(oozieClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStackRegisterConditionalDependencies() throws Exception {
  EasyMockSupport mockSupport=new EasyMockSupport();
  AmbariManagementController mockMgmtController=mockSupport.createMock(AmbariManagementController.class);
  expect(mockMgmtController.getStackServices(isA(Set.class))).andReturn(Collections.<StackServiceResponse>emptySet());
  expect(mockMgmtController.getStackLevelConfigurations((Set<StackLevelConfigurationRequest>)anyObject())).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  final DependencyInfo hCatDependency=new TestDependencyInfo("HIVE/HCAT");
  final DependencyInfo yarnClientDependency=new TestDependencyInfo("YARN/YARN_CLIENT");
  final DependencyInfo tezClientDependency=new TestDependencyInfo("TEZ/TEZ_CLIENT");
  final DependencyInfo mapReduceTwoClientDependency=new TestDependencyInfo("YARN/MAPREDUCE2_CLIENT");
  final DependencyInfo oozieClientDependency=new TestDependencyInfo("OOZIE/OOZIE_CLIENT");
  mockSupport.replayAll();
  Stack testStack=new Stack("HDP","2.1",mockMgmtController){
    @Override public Collection<DependencyInfo> getDependenciesForComponent(    String component){
      if (component.equals("FAKE_MONITORING_SERVER")) {
        Set<DependencyInfo> setOfDependencies=new HashSet<DependencyInfo>();
        setOfDependencies.add(hCatDependency);
        setOfDependencies.add(yarnClientDependency);
        setOfDependencies.add(tezClientDependency);
        setOfDependencies.add(mapReduceTwoClientDependency);
        setOfDependencies.add(oozieClientDependency);
        return setOfDependencies;
      }
      return Collections.emptySet();
    }
    /** 
 * {@inheritDoc}
 */
    @Override void registerConditionalDependencies(){
      super.registerConditionalDependencies();
      Map<DependencyInfo,String> dependencyConditionalServiceMap=getDependencyConditionalServiceMap();
      Collection<DependencyInfo> monitoringDependencies=getDependenciesForComponent("FAKE_MONITORING_SERVER");
      for (      DependencyInfo dependency : monitoringDependencies) {
        if (dependency.getComponentName().equals("HCAT")) {
          dependencyConditionalServiceMap.put(dependency,"HIVE");
        }
 else         if (dependency.getComponentName().equals("OOZIE_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"OOZIE");
        }
 else         if (dependency.getComponentName().equals("YARN_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"YARN");
        }
 else         if (dependency.getComponentName().equals("TEZ_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"TEZ");
        }
 else         if (dependency.getComponentName().equals("MAPREDUCE2_CLIENT")) {
          dependencyConditionalServiceMap.put(dependency,"MAPREDUCE2");
        }
      }
    }
  }
;
  assertEquals("Initial conditional dependency map should be empty",0,testStack.getDependencyConditionalServiceMap().size());
  testStack.registerConditionalDependencies();
  assertEquals("Set of conditional service mappings is an incorrect size",5,testStack.getDependencyConditionalServiceMap().size());
  assertEquals("Incorrect service dependency for HCAT","HIVE",testStack.getDependencyConditionalServiceMap().get(hCatDependency));
  assertEquals("Incorrect service dependency for YARN_CLIENT","YARN",testStack.getDependencyConditionalServiceMap().get(yarnClientDependency));
  assertEquals("Incorrect service dependency for TEZ_CLIENT","TEZ",testStack.getDependencyConditionalServiceMap().get(tezClientDependency));
  assertEquals("Incorrect service dependency for MAPREDUCE2_CLIENT","MAPREDUCE2",testStack.getDependencyConditionalServiceMap().get(mapReduceTwoClientDependency));
  assertEquals("Incorrect service dependency for OOZIE_CLIENT","OOZIE",testStack.getDependencyConditionalServiceMap().get(oozieClientDependency));
  mockSupport.verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintConfigurationProcessorTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues___YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("storm.zookeeper.servers","['localhost']");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("storm.zookeeper.servers");
  assertTrue(updatedVal.startsWith("["));
  assertTrue(updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("'testhost'");
  expectedHosts.add("'testhost2'");
  expectedHosts.add("'testhost2a'");
  expectedHosts.add("'testhost2b'");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__exportedValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","%HOSTGROUP::group1%");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("testhost",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRequiredHostGroups___invalidComponentCountOfZero() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.defaultFS","localhost");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("HIVE_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("host2"));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Collection<String> requiredGroups=updater.getRequiredHostGroups();
  assertEquals(0,requiredGroups.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_DBHostProperty__defaultValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProps=new HashMap<String,String>();
  hiveSiteProps.put("javax.jdo.option.ConnectionURL","jdbc:mysql://localhost/hive?createDatabaseIfNotExist=true");
  Map<String,String> hiveEnvProps=new HashMap<String,String>();
  hiveEnvProps.put("hive_database","New MySQL Database");
  properties.put("hive-site",hiveSiteProps);
  properties.put("hive-env",hiveEnvProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  hgComponents.add("MYSQL_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hive-site").get("javax.jdo.option.ConnectionURL");
  assertEquals("jdbc:mysql://testhost/hive?createDatabaseIfNotExist=true",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabledAndActiveNodeSet() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="serverThree";
  final String expectedHostNameTwo="serverFour";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hadoopEnvProperties.put("dfs_ha_initial_namenode_active",expectedHostName);
  hadoopEnvProperties.put("dfs_ha_initial_namenode_standby",expectedHostNameTwo);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add(expectedHostNameTwo);
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String expectedPropertyValue=hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne);
  if (!expectedPropertyValue.equals(expectedHostName + ":" + expectedPortNum) && !expectedPropertyValue.equals(expectedHostNameTwo + ":" + expectedPortNum)) {
    fail("HTTPS address HA property not properly exported");
  }
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedPropertyValue,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("Active Namenode hostname was not set correctly",expectedHostName,hadoopEnvProperties.get("dfs_ha_initial_namenode_active"));
  assertEquals("Standby Namenode hostname was not set correctly",expectedHostNameTwo,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultUserAndGroupProxyPropertiesSetWhenNotProvided2() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> falconEnvProperties=new HashMap<String,String>();
  properties.put("falcon-env",falconEnvProperties);
  falconEnvProperties.put("falcon_user","test-falcon-user");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> oozieEnvProperties=new HashMap<String,String>();
  parentProperties.put("oozie-env",oozieEnvProperties);
  oozieEnvProperties.put("oozie_user","test-oozie-user");
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  parentProperties.put("core-site",coreSiteProperties);
  coreSiteProperties.put("hadoop.proxyuser.test-oozie-user.hosts","testOozieHostsVal");
  Configuration parentClusterConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentClusterConfig);
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("OOZIE_SERVER");
  hgComponents1.add("FALCON_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<TestHostGroup> hostGroups=Collections.singletonList(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForClusterCreate();
  Map<String,String> leafConfigCoreSiteProps=properties.get("core-site");
  assertEquals(3,leafConfigCoreSiteProps.size());
  assertEquals("testOozieHostsVal",clusterConfig.getPropertyValue("core-site","hadoop.proxyuser.test-oozie-user.hosts"));
  assertEquals("*",leafConfigCoreSiteProps.get("hadoop.proxyuser.test-oozie-user.groups"));
  assertEquals("*",leafConfigCoreSiteProps.get("hadoop.proxyuser.test-falcon-user.hosts"));
  assertEquals("*",leafConfigCoreSiteProps.get("hadoop.proxyuser.test-falcon-user.groups"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__exportedValue_WithPort_UsingMinusSymbolInHostGroupName() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-6%:2180");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-6",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("testhost:2180",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("storm.zookeeper.servers","['%HOSTGROUP::group1%:9090','%HOSTGROUP::group2%:9091']");
  typeProps.put("nimbus.seeds","[%HOSTGROUP::group1%, %HOSTGROUP::group4%]");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  hgComponents.add("NIMBUS");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  hgComponents2.add("NIMBUS");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<String> hgComponents4=new HashSet<String>();
  hgComponents4.add("NIMBUS");
  Set<String> hosts4=new HashSet<String>();
  hosts4.add("testhost4");
  TestHostGroup group4=new TestHostGroup("group4",hgComponents4,hosts4);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  hostGroups.add(group4);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("storm.zookeeper.servers");
  assertTrue(updatedVal.startsWith("["));
  assertTrue(updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("'testhost:9090'");
  expectedHosts.add("'testhost2:9091'");
  expectedHosts.add("'testhost2a:9091'");
  expectedHosts.add("'testhost2b:9091'");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
  String updatedNimbusSeedsVal=topology.getConfiguration().getFullProperties().get("storm-site").get("nimbus.seeds");
  assertTrue("Updated YAML value should start with bracket",updatedNimbusSeedsVal.startsWith("["));
  assertTrue("Updated YAML value should end with bracket",updatedNimbusSeedsVal.endsWith("]"));
  updatedNimbusSeedsVal=updatedNimbusSeedsVal.replaceAll("[\\[\\]]","");
  String[] nimbusHosts=updatedNimbusSeedsVal.split(",");
  Collection<String> expectedNimbusHosts=new HashSet<String>();
  expectedNimbusHosts.add("testhost");
  expectedNimbusHosts.add("testhost4");
  assertEquals("Incorrect number of hosts found in updated Nimbus config property",2,nimbusHosts.length);
  for (  String host : nimbusHosts) {
    assertTrue("Expected Nimbus host = " + host + " not found in nimbus.seeds property value",expectedNimbusHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_SingleHostProperty() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","testhost");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("%HOSTGROUP::group1%",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___withPorts_UsingMinusSymbolInHostGroupName() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("ha.zookeeper.quorum","%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-6%:2181,%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-5%:2181,%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-7%:2181");
  properties.put("core-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-6",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-5",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-7",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("core-site").get("ha.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:2181");
  expectedHosts.add("testhost2:2181");
  expectedHosts.add("testhost2a:2181");
  expectedHosts.add("testhost2b:2181");
  expectedHosts.add("testhost3:2181");
  expectedHosts.add("testhost3a:2181");
  assertEquals(6,hosts.length);
  for (  String host : hosts) {
    assertTrue("Expected host :" + host + "was not included in the multi-server list in this property.",expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseNameNodes() throws Exception {
  final String expectedServiceName="serviceOne";
  Map<String,String> hdfsSiteConfigMap=new HashMap<String,String>();
  hdfsSiteConfigMap.put("dfs.ha.namenodes." + expectedServiceName,"node1");
  String[] result=BlueprintConfigurationProcessor.parseNameNodes(expectedServiceName,hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",result);
  assertEquals("Incorrect array size",1,result.length);
  assertEquals("Incorrect value for returned name nodes","node1",result[0]);
  hdfsSiteConfigMap.put("dfs.ha.namenodes." + expectedServiceName," nodeSeven, nodeEight, nodeNine");
  String[] resultTwo=BlueprintConfigurationProcessor.parseNameNodes(expectedServiceName,hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",resultTwo);
  assertEquals("Incorrect array size",3,resultTwo.length);
  assertEquals("Incorrect value for returned name node","nodeSeven",resultTwo[0]);
  assertEquals("Incorrect value for returned name node","nodeEight",resultTwo[1]);
  assertEquals("Incorrect value for returned name node","nodeNine",resultTwo[2]);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_MultiHostProperty__YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("storm.zookeeper.servers","['testhost:5050','testhost2:9090','testhost2a:9090','testhost2b:9090']");
  typeProps.put("drpc_server_host","['testhost:5050']");
  typeProps.put("storm_ui_server_host","['testhost:5050']");
  typeProps.put("supervisor_hosts","['testhost:5050','testhost2:9090']");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  hgComponents.add("DRPC_SERVER");
  hgComponents.add("STORM_UI_SERVER");
  hgComponents.add("SUPERVISOR");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  hgComponents2.add("SUPERVISOR");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("storm-site").get("storm.zookeeper.servers");
  assertEquals("['%HOSTGROUP::group1%:5050','%HOSTGROUP::group2%:9090']",updatedVal);
  String updatedVa2=properties.get("storm-site").get("drpc_server_host");
  assertEquals("['%HOSTGROUP::group1%:5050']",updatedVa2);
  String updatedVa3=properties.get("storm-site").get("storm_ui_server_host");
  assertEquals("['%HOSTGROUP::group1%:5050']",updatedVa3);
  String updatedVa4=properties.get("storm-site").get("supervisor_hosts");
  assertEquals("['%HOSTGROUP::group1%:5050','%HOSTGROUP::group2%:9090']",updatedVa4);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterVerifyRetrySettingsCustomized() throws Exception {
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  HashMap<String,String> clusterEnvProperties=new HashMap<String,String>();
  configProperties.put("cluster-env",clusterEnvProperties);
  clusterEnvProperties.put("command_retry_enabled","false");
  clusterEnvProperties.put("commands_to_retry","TEST");
  clusterEnvProperties.put("command_retry_max_time_in_sec","1");
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  TestHostGroup testHostGroup=new TestHostGroup("test-host-group-one",Collections.<String>emptySet(),Collections.<String>emptySet());
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,Collections.singleton(testHostGroup));
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("Incorrect number of properties added to cluster-env for retry",3,clusterEnvProperties.size());
  assertEquals("command_retry_enabled was not set to the expected default","false",clusterEnvProperties.get("command_retry_enabled"));
  assertEquals("commands_to_retry was not set to the expected default","TEST",clusterEnvProperties.get("commands_to_retry"));
  assertEquals("command_retry_max_time_in_sec was not set to the expected default","1",clusterEnvProperties.get("command_retry_max_time_in_sec"));
  assertEquals("Incorrect number of config types updated",0,updatedConfigTypes.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabledSpecifyingHostNamesDirectly() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  configProperties.put("hdfs-site",hdfsSiteProperties);
  configProperties.put("hadoop-env",hadoopEnvProperties);
  configProperties.put("core-site",coreSiteProperties);
  configProperties.put("hbase-site",hbaseSiteProperties);
  configProperties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createHostAddress(expectedHostName,expectedPortNum));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createHostAddress(expectedHostNameTwo,expectedPortNum));
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  coreSiteProperties.put("fs.defaultFS","hdfs://" + expectedNameService);
  hbaseSiteProperties.put("hbase.rootdir","hdfs://" + expectedNameService + "/hbase/test/root/dir");
  accumuloSiteProperties.put("instance.volumes","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes");
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostNameTwo + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  String activeHost=hadoopEnvProperties.get("dfs_ha_initial_namenode_active");
  if (activeHost.equals(expectedHostName)) {
    assertEquals("Standby Namenode hostname was not set correctly",expectedHostNameTwo,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  }
 else   if (activeHost.equals(expectedHostNameTwo)) {
    assertEquals("Standby Namenode hostname was not set correctly",expectedHostName,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  }
 else {
    fail("Active Namenode hostname was not set correctly: " + activeHost);
  }
  assertEquals("fs.defaultFS should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService,coreSiteProperties.get("fs.defaultFS"));
  assertEquals("hbase.rootdir should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/hbase/test/root/dir",hbaseSiteProperties.get("hbase.rootdir"));
  assertEquals("instance.volumes should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes",accumuloSiteProperties.get("instance.volumes"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyStackDefaultsOnly() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue2");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ONLY_STACK_DEFAULTS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  reset(stack);
  expect(stack.getConfiguration(bp.getServices())).andReturn(createStackDefaults()).anyTimes();
  replay(stack);
  Set<String> configTypeUpdated=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertTrue(configTypeUpdated.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__defaultValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  Map<String,String> typeProps2=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","localhost");
  typeProps2.put("oozie_heapsize","1024");
  typeProps2.put("oozie_permsize","128");
  properties.put("oozie-env",typeProps2);
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> configTypesUpdated=updater.doUpdateForClusterCreate();
  String updatedVal=properties.get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("testhost",updatedVal);
  String updatedVal1=properties.get("oozie-env").get("oozie_heapsize");
  assertEquals("1024m",updatedVal1);
  String updatedVal2=properties.get("oozie-env").get("oozie_permsize");
  assertEquals("128m",updatedVal2);
  assertEquals("Incorrect number of config types updated",3,configTypesUpdated.size());
  assertTrue("Expected config type not updated",configTypesUpdated.contains("oozie-env"));
  assertTrue("Expected config type not updated",configTypesUpdated.contains("yarn-site"));
  assertTrue("Expected config type not updated",configTypesUpdated.contains("cluster-env"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExportRangerHAPolicyMgrExternalUrlProperty() throws Exception {
  Map<String,String> rangerAdminProperties=Maps.newHashMap();
  rangerAdminProperties.put("DB_FLAVOR","test_db_flavor");
  rangerAdminProperties.put("policymgr_external_url","test_policymgr_external_url");
  Map<String,Map<String,String>> properties=ImmutableMap.of("admin-properties",rangerAdminProperties);
  Configuration clusterConfig=new Configuration(properties,ImmutableMap.<String,Map<String,Map<String,String>>>of());
  Collection<String> hostGroup1Components=ImmutableSet.of("RANGER_ADMIN");
  TestHostGroup group1=new TestHostGroup("group1",hostGroup1Components,Collections.singleton("testhost1"));
  Collection<String> hostGroup2Components=ImmutableSet.of("RANGER_ADMIN");
  TestHostGroup group2=new TestHostGroup("group2",hostGroup2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=ImmutableSet.of(group1,group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertEquals("policymgr_external_url property's original value should be exported when Ranger Admin is deployed to multiple hosts.","test_policymgr_external_url",properties.get("admin-properties").get("policymgr_external_url"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_Storm_Nimbus_HA_Enabled__FQDN_ValuesSpecified_YAML() throws Exception {
  final String expectedValue="[c6401.ambari.apache.org, c6402.ambari.apache.org]";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("nimbus.seeds",expectedValue);
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NIMBUS");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NIMBUS");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("nimbus.seeds");
  assertEquals("nimbus.seeds property should not be updated when FQDNs are specified in configuration",expectedValue,updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_SingleHostProperty__withPort() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("fs.defaultFS","testhost:8020");
  properties.put("core-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("core-site").get("fs.defaultFS");
  assertEquals("%HOSTGROUP::group1%:8020",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_MProperty__defaultValues() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase_master_heapsize","512m");
  properties.put("hbase-env",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-env").get("hbase_master_heapsize");
  assertEquals("512m",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_MProperty__missingM() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase_master_heapsize","512");
  properties.put("hbase-env",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-env").get("hbase_master_heapsize");
  assertEquals("512m",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase.zookeeper.quorum","localhost");
  properties.put("hbase-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-site").get("hbase.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  expectedHosts.add("testhost2a");
  expectedHosts.add("testhost2b");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__defaultValue__WithPort() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("fs.defaultFS","localhost:5050");
  properties.put("core-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("core-site").get("fs.defaultFS");
  assertEquals("testhost:5050",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabled() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  properties.put("core-site",coreSiteProperties);
  properties.put("hbase-site",hbaseSiteProperties);
  properties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.https-address","localhost:8081");
  hdfsSiteProperties.put("dfs.namenode.rpc-address","localhost:8082");
  coreSiteProperties.put("fs.defaultFS","hdfs://" + expectedNameService);
  hbaseSiteProperties.put("hbase.rootdir","hdfs://" + expectedNameService + "/hbase/test/root/dir");
  accumuloSiteProperties.put("instance.volumes","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  String initialActiveHost=hadoopEnvProperties.get("dfs_ha_initial_namenode_active");
  String expectedStandbyHost=null;
  if (initialActiveHost.equals(expectedHostName)) {
    expectedStandbyHost=expectedHostNameTwo;
  }
 else   if (initialActiveHost.equals(expectedHostNameTwo)) {
    expectedStandbyHost=expectedHostName;
  }
 else {
    fail("Active Namenode hostname was not set correctly");
  }
  assertEquals("Standby Namenode hostname was not set correctly",expectedStandbyHost,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  assertEquals("fs.defaultFS should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService,coreSiteProperties.get("fs.defaultFS"));
  assertEquals("hbase.rootdir should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/hbase/test/root/dir",hbaseSiteProperties.get("hbase.rootdir"));
  assertEquals("instance.volumes should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes",accumuloSiteProperties.get("instance.volumes"));
  assertFalse("dfs.namenode.http-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.http-address"));
  assertFalse("dfs.namenode.https-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.https-address"));
  assertFalse("dfs.namenode.rpc-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.rpc-address"));
  assertEquals("Incorrect number of updated config types returned, set = " + updatedConfigTypes,3,updatedConfigTypes.size());
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("cluster-env"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hdfs-site"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hadoop-env"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__MissingOptionalComponent() throws Exception {
  final String expectedHostName="localhost";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.timeline-service.address",expectedHostName);
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("APP_TIMELINE_SERVER")).andReturn(new Cardinality("0-1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("yarn-site").get("yarn.timeline-service.address");
  assertEquals("Timeline Server config property should not have been updated",expectedHostName,updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_DBHostProperty__external() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("javax.jdo.option.ConnectionURL","jdbc:mysql://myHost.com/hive?createDatabaseIfNotExist=true");
  typeProps.put("hive_database","Existing MySQL Database");
  properties.put("hive-env",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hive-env").get("javax.jdo.option.ConnectionURL");
  assertEquals("jdbc:mysql://myHost.com/hive?createDatabaseIfNotExist=true",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHANotEnabled() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  properties.put("core-site",coreSiteProperties);
  properties.put("hbase-site",hbaseSiteProperties);
  properties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.https-address","localhost:8081");
  hdfsSiteProperties.put("dfs.namenode.rpc-address","localhost:8082");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertTrue("dfs.namenode.http-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.http-address"));
  assertTrue("dfs.namenode.https-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.https-address"));
  assertTrue("dfs.namenode.rpc-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.rpc-address"));
  assertEquals("Incorrect number of updated config types returned, set = " + updatedConfigTypes,2,updatedConfigTypes.size());
  assertTrue("Expected config type 'cluster-env' not found in updated set",updatedConfigTypes.contains("cluster-env"));
  assertTrue("Expected config type 'hdfs-site' not found in updated set",updatedConfigTypes.contains("hdfs-site"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_Storm_Nimbus_HA_Enabled__defaultValues_YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("nimbus.seeds","localhost");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NIMBUS");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NIMBUS");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("nimbus.seeds");
  assertTrue("Updated YAML value should start with bracket",updatedVal.startsWith("["));
  assertTrue("Updated YAML value should end with bracket",updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  assertEquals("Incorrect number of hosts found in updated Nimbus config property",2,hosts.length);
  for (  String host : hosts) {
    assertTrue("Expected host name = " + host + " not found in updated Nimbus config property",expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___withPorts() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("templeton.zookeeper.hosts","%HOSTGROUP::group1%:9090,%HOSTGROUP::group2%:9091");
  properties.put("webhcat-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("webhcat-site").get("templeton.zookeeper.hosts");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:9090");
  expectedHosts.add("testhost2:9091");
  expectedHosts.add("testhost2a:9091");
  expectedHosts.add("testhost2b:9091");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues___withPorts() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("templeton.zookeeper.hosts","localhost:9090");
  properties.put("webhcat-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("webhcat-site").get("templeton.zookeeper.hosts");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:9090");
  expectedHosts.add("testhost2:9090");
  expectedHosts.add("testhost2a:9090");
  expectedHosts.add("testhost2b:9090");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyAlways() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentClusterConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentClusterConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ALWAYS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  Set<String> configTypes=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNotNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertEquals(2,topology.getAdvisedConfigurations().size());
  assertFalse(configTypes.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHDFSConfigClusterUpdateQuorumJournalURLSpecifyingHostNamesDirectly() throws Exception {
  final String expectedHostNameOne="c6401.apache.ambari.org";
  final String expectedHostNameTwo="c6402.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  final String expectedHostGroupNameTwo="host_group_2";
  final String expectedQuorumJournalURL="qjournal://" + createHostAddress(expectedHostNameOne,expectedPortNum) + ";"+ createHostAddress(expectedHostNameTwo,expectedPortNum)+ "/mycluster";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  configProperties.put("hdfs-site",hdfsSiteProperties);
  hdfsSiteProperties.put("dfs.namenode.shared.edits.dir",expectedQuorumJournalURL);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton("host1"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  TestHostGroup group2=new TestHostGroup(expectedHostGroupNameTwo,hgComponents2,Collections.singleton("host2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertEquals("HDFS HA shared edits directory property should not have been modified, since FQDNs were specified.",expectedQuorumJournalURL,hdfsSiteProperties.get("dfs.namenode.shared.edits.dir"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterVerifyRetrySettingsDefault() throws Exception {
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  HashMap<String,String> clusterEnvProperties=new HashMap<String,String>();
  configProperties.put("cluster-env",clusterEnvProperties);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  TestHostGroup testHostGroup=new TestHostGroup("test-host-group-one",Collections.<String>emptySet(),Collections.<String>emptySet());
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,Collections.singleton(testHostGroup));
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("Incorrect number of properties added to cluster-env for retry",3,clusterEnvProperties.size());
  assertEquals("command_retry_enabled was not set to the expected default","true",clusterEnvProperties.get("command_retry_enabled"));
  assertEquals("commands_to_retry was not set to the expected default","INSTALL,START",clusterEnvProperties.get("commands_to_retry"));
  assertEquals("command_retry_max_time_in_sec was not set to the expected default","600",clusterEnvProperties.get("command_retry_max_time_in_sec"));
  assertEquals("Incorrect number of config types updated by this operation",1,updatedConfigTypes.size());
  assertTrue("Expected type not included in the updated set",updatedConfigTypes.contains("cluster-env"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__MultipleAppTimelineServer() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.timeline-service.address","testhost:10200");
  typeProps.put("yarn.timeline-service.webapp.address","testhost:8188");
  typeProps.put("yarn.timeline-service.webapp.https.address","testhost:8190");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  group1Components.add("APP_TIMELINE_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  group2Components.add("APP_TIMELINE_SERVER");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("APP_TIMELINE_SERVER")).andReturn(new Cardinality("0-1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("yarn-site").get("yarn.timeline-service.address");
  assertEquals("Timeline Server config property should not have been updated","testhost:10200",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_MultiHostProperty() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase.zookeeper.quorum","testhost,testhost2,testhost2a,testhost2b");
  properties.put("hbase-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("hbase-site").get("hbase.zookeeper.quorum");
  assertEquals("%HOSTGROUP::group1%,%HOSTGROUP::group2%",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_DBHostProperty__exportedValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProps=new HashMap<String,String>();
  hiveSiteProps.put("javax.jdo.option.ConnectionURL","jdbc:mysql://%HOSTGROUP::group1%/hive?createDatabaseIfNotExist=true");
  Map<String,String> hiveEnvProps=new HashMap<String,String>();
  hiveEnvProps.put("hive_database","New MySQL Database");
  properties.put("hive-site",hiveSiteProps);
  properties.put("hive-env",hiveEnvProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  hgComponents.add("MYSQL_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hive-site").get("javax.jdo.option.ConnectionURL");
  assertEquals("jdbc:mysql://testhost/hive?createDatabaseIfNotExist=true",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelevantDefaultUserAndGroupProxyPropertiesSet() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> oozieEnvProperties=new HashMap<String,String>();
  Map<String,String> falconEnvProperties=new HashMap<String,String>();
  properties.put("oozie-env",oozieEnvProperties);
  properties.put("falcon-env",falconEnvProperties);
  oozieEnvProperties.put("oozie_user","test-oozie-user");
  falconEnvProperties.put("falcon_user","test-falcon-user");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("OOZIE_SERVER");
  hgComponents1.add("FALCON_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<TestHostGroup> hostGroups=Collections.singletonList(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForClusterCreate();
  Map<String,String> coreSiteProperties=properties.get("core-site");
  assertEquals(4,coreSiteProperties.size());
  assertEquals("*",coreSiteProperties.get("hadoop.proxyuser.test-oozie-user.hosts"));
  assertEquals("*",coreSiteProperties.get("hadoop.proxyuser.test-oozie-user.groups"));
  assertEquals("*",coreSiteProperties.get("hadoop.proxyuser.test-falcon-user.hosts"));
  assertEquals("*",coreSiteProperties.get("hadoop.proxyuser.test-falcon-user.groups"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequiredHostGroups___multipleGroups() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.defaultFS","localhost");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("HIVE_SERVER");
  hgComponents1.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  hgComponents2.add("DATANODE");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("host2"));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Collection<String> requiredGroups=updater.getRequiredHostGroups();
  assertEquals(2,requiredGroups.size());
  assertTrue(requiredGroups.containsAll(Arrays.asList("group1","group2")));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__exportedValue_UsingMinusSymbolInHostGroupName() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-6%");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-6",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("testhost",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseNameServices() throws Exception {
  Map<String,String> hdfsSiteConfigMap=new HashMap<String,String>();
  hdfsSiteConfigMap.put("dfs.nameservices","serviceOne");
  String[] result=BlueprintConfigurationProcessor.parseNameServices(hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",result);
  assertEquals("Incorrect array size",1,result.length);
  assertEquals("Incorrect value for returned name service","serviceOne",result[0]);
  hdfsSiteConfigMap.put("dfs.nameservices"," serviceTwo, serviceThree, serviceFour");
  String[] resultTwo=BlueprintConfigurationProcessor.parseNameServices(hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",resultTwo);
  assertEquals("Incorrect array size",3,resultTwo.length);
  assertEquals("Incorrect value for returned name service","serviceTwo",resultTwo[0]);
  assertEquals("Incorrect value for returned name service","serviceThree",resultTwo[1]);
  assertEquals("Incorrect value for returned name service","serviceFour",resultTwo[2]);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__exportedValue__WithPort() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("fs.defaultFS","%HOSTGROUP::group1%:5050");
  properties.put("core-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("core-site").get("fs.defaultFS");
  assertEquals("testhost:5050",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_DBHostProperty() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProps=new HashMap<String,String>();
  hiveSiteProps.put("javax.jdo.option.ConnectionURL","jdbc:mysql://testhost/hive?createDatabaseIfNotExist=true");
  properties.put("hive-site",hiveSiteProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  hgComponents.add("MYSQL_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("hive-site").get("javax.jdo.option.ConnectionURL");
  assertEquals("jdbc:mysql://%HOSTGROUP::group1%/hive?createDatabaseIfNotExist=true",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForBlueprintExport_MultiHostProperty__WithPorts() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("templeton.zookeeper.hosts","testhost:5050,testhost2:9090,testhost2a:9090,testhost2b:9090");
  properties.put("webhcat-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  String updatedVal=properties.get("webhcat-site").get("templeton.zookeeper.hosts");
  assertEquals("%HOSTGROUP::group1%:5050,%HOSTGROUP::group2%:9090",updatedVal);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty_exportedValues_withPorts_singleHostValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> yarnSiteConfig=new HashMap<String,String>();
  yarnSiteConfig.put("hadoop.registry.zk.quorum","%HOSTGROUP::host_group_1%:2181");
  properties.put("yarn-site",yarnSiteConfig);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("host_group_1",hgComponents,Collections.singleton("testhost"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertEquals("Multi-host property with single host value was not correctly updated for cluster create.","testhost:2181",topology.getConfiguration().getFullProperties().get("yarn-site").get("hadoop.registry.zk.quorum"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase.zookeeper.quorum","%HOSTGROUP::group1%,%HOSTGROUP::group2%");
  properties.put("hbase-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-site").get("hbase.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  expectedHosts.add("testhost2a");
  expectedHosts.add("testhost2b");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRequiredHostGroups___validComponentCountOfZero() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSite=new HashMap<String,String>();
  properties.put("hive-site",hiveSite);
  Map<String,String> hiveEnv=new HashMap<String,String>();
  properties.put("hive-env",hiveEnv);
  hiveSite.put("javax.jdo.option.ConnectionURL","localhost:1111");
  hiveEnv.put("hive_database","New Database");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("HIVE_SERVER");
  hgComponents1.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("host2"));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Collection<String> requiredGroups=updater.getRequiredHostGroups();
  assertEquals(0,requiredGroups.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationList() throws Exception {
  StackEntity stackEntity=new StackEntity();
  stackEntity.setStackName("test-stack-name");
  stackEntity.setStackVersion("test-stack-version");
  BlueprintEntity entity=createMock(BlueprintEntity.class);
  expect(entity.getStack()).andReturn(stackEntity).anyTimes();
  HashMap<PropertyInfo.PropertyType,Set<String>> pwdProperties=new HashMap<PropertyInfo.PropertyType,Set<String>>(){
{
      put(PropertyInfo.PropertyType.PASSWORD,new HashSet<String>(){
{
          add("test.password");
        }
      }
);
    }
  }
;
  StackInfo info=createMock(StackInfo.class);
  expect(info.getConfigPropertiesTypes("type1")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type2")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type3")).andReturn(pwdProperties).anyTimes();
  expect(metaInfo.getStack("test-stack-name","test-stack-version")).andReturn(info).anyTimes();
  replay(info,metaInfo,entity);
  BlueprintConfigEntity config1=new BlueprintConfigEntity();
  config1.setType("type1");
  config1.setConfigData("{\"key1\":\"value1\"}");
  config1.setBlueprintEntity(entity);
  BlueprintConfigEntity config2=new BlueprintConfigEntity();
  config2.setType("type2");
  config2.setConfigData("{\"key2\":\"value2\"}");
  config2.setConfigAttributes("{}");
  config2.setBlueprintEntity(entity);
  BlueprintConfigEntity config3=new BlueprintConfigEntity();
  config3.setType("type3");
  config3.setConfigData("{\"key3\":\"value3\",\"key4\":\"value4\",\"test.password\":\"pwdValue\"}");
  config3.setConfigAttributes("{\"final\":{\"key3\":\"attrValue1\",\"key4\":\"attrValue2\"}}");
  config3.setBlueprintEntity(entity);
  List<Map<String,Map<String,Object>>> configs=provider.populateConfigurationList(Arrays.asList(config1,config2,config3));
  assertNotNull(configs);
  assertEquals(3,configs.size());
  Map<String,Map<String,Object>> configuration1=configs.get(0);
  assertNotNull(configuration1);
  assertEquals(1,configuration1.size());
  assertTrue(configuration1.containsKey("type1"));
  Map<String,Object> typeConfig1=configuration1.get("type1");
  assertNotNull(typeConfig1);
  assertEquals(1,typeConfig1.size());
  assertTrue(typeConfig1.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties1=(Map<String,String>)typeConfig1.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties1);
  assertEquals(1,confProperties1.size());
  assertEquals("value1",confProperties1.get("key1"));
  Map<String,Map<String,Object>> configuration2=configs.get(1);
  assertNotNull(configuration2);
  assertEquals(1,configuration2.size());
  assertTrue(configuration2.containsKey("type2"));
  Map<String,Object> typeConfig2=configuration2.get("type2");
  assertNotNull(typeConfig2);
  assertEquals(1,typeConfig2.size());
  assertTrue(typeConfig2.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties2=(Map<String,String>)typeConfig2.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties2);
  assertEquals(1,confProperties2.size());
  assertEquals("value2",confProperties2.get("key2"));
  Map<String,Map<String,Object>> configuration3=configs.get(2);
  assertNotNull(configuration3);
  assertEquals(1,configuration3.size());
  assertTrue(configuration3.containsKey("type3"));
  Map<String,Object> typeConfig3=configuration3.get("type3");
  assertNotNull(typeConfig3);
  assertEquals(2,typeConfig3.size());
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties3=(Map<String,String>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties3);
  assertEquals(3,confProperties3.size());
  assertEquals("value3",confProperties3.get("key3"));
  assertEquals("value4",confProperties3.get("key4"));
  assertEquals("SECRET:type3:-1:test.password",confProperties3.get("test.password"));
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID));
  Map<String,Map<String,String>> confAttributes3=(Map<String,Map<String,String>>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID);
  assertNotNull(confAttributes3);
  assertEquals(1,confAttributes3.size());
  assertTrue(confAttributes3.containsKey("final"));
  Map<String,String> finalAttrs=confAttributes3.get("final");
  assertEquals(2,finalAttrs.size());
  assertEquals("attrValue1",finalAttrs.get("key3"));
  assertEquals("attrValue2",finalAttrs.get("key4"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationEntity_newSchema() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  configuration.put("global/properties/property1","val1");
  configuration.put("global/properties/property2","val2");
  configuration.put("global/properties_attributes/final/property1","true");
  configuration.put("global/properties_attributes/final/property2","false");
  configuration.put("global/properties_attributes/deletable/property1","true");
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigData());
  assertNotNull(config.getConfigAttributes());
  Map<?,?> configData=StageUtils.getGson().fromJson(config.getConfigData(),Map.class);
  Map<?,Map<?,?>> configAttrs=StageUtils.getGson().fromJson(config.getConfigAttributes(),Map.class);
  assertNotNull(configData);
  assertNotNull(configAttrs);
  assertEquals(2,configData.size());
  assertTrue(configData.containsKey("property1"));
  assertTrue(configData.containsKey("property2"));
  assertEquals("val1",configData.get("property1"));
  assertEquals("val2",configData.get("property2"));
  assertEquals(2,configAttrs.size());
  assertTrue(configAttrs.containsKey("final"));
  assertTrue(configAttrs.containsKey("deletable"));
  Map<?,?> finalAttrs=configAttrs.get("final");
  assertNotNull(finalAttrs);
  assertEquals(2,finalAttrs.size());
  assertTrue(finalAttrs.containsKey("property1"));
  assertTrue(finalAttrs.containsKey("property2"));
  assertEquals("true",finalAttrs.get("property1"));
  assertEquals("false",finalAttrs.get("property2"));
  Map<?,?> deletableAttrs=configAttrs.get("deletable");
  assertNotNull(deletableAttrs);
  assertEquals(1,deletableAttrs.size());
  assertTrue(deletableAttrs.containsKey("property1"));
  assertEquals("true",deletableAttrs.get("property1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.CalculatedStatusTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatus() throws Exception {
  Collection<HostRoleCommandEntity> tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  CalculatedStatus status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatusFromStages() throws Exception {
  Collection<Stage> stages;
  CalculatedStatus status;
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.IN_PROGRESS,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertEquals(48.3,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.PENDING,status.getStatus());
  assertEquals(0.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.FAILED,status.getStatus());
  assertEquals(55.55,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.TIMEDOUT,status.getStatus());
  assertEquals(66.66,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertNull(status.getDisplayStatus());
  assertEquals(47.5,status.getPercent(),0.1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStatusFromStageEntities() throws Exception {
  Collection<StageEntity> stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED));
  CalculatedStatus status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.IN_PROGRESS,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertEquals(48.3,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.PENDING,status.getStatus());
  assertEquals(0.0,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.FAILED,status.getStatus());
  assertEquals(55.55,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.TIMEDOUT,status.getStatus());
  assertEquals(66.66,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStageEntities(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStageEntities(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStatusFromTaskEntities() throws Exception {
  Collection<HostRoleCommandEntity> tasks=getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  CalculatedStatus status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.PENDING,status.getStatus());
  assertEquals(0.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.FAILED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.FAILED,HostRoleStatus.FAILED,HostRoleStatus.FAILED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,true);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT,HostRoleStatus.TIMEDOUT,HostRoleStatus.TIMEDOUT,HostRoleStatus.TIMEDOUT);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.TIMEDOUT,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT,HostRoleStatus.FAILED,HostRoleStatus.TIMEDOUT,HostRoleStatus.TIMEDOUT);
  status=CalculatedStatus.statusFromTaskEntities(tasks,true);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,true);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertEquals(40.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(54.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING_FAILED,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.HOLDING_FAILED,status.getStatus());
  assertEquals(54.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING_TIMEDOUT,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.HOLDING_TIMEDOUT,status.getStatus());
  assertEquals(54.0,status.getPercent(),0.1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that aborted states calculate correctly. This is needed for upgrades
 * where the upgrade can be ABORTED and must not be calculated as COMPLETED.
 * @throws Exception
 */
@Test public void testAbortedCalculation() throws Exception {
  Collection<HostRoleCommandEntity> tasks=getTaskEntities(HostRoleStatus.ABORTED);
  CalculatedStatus status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  status=CalculatedStatus.statusFromTaskEntities(tasks,true);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.ABORTED);
  status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  status=CalculatedStatus.statusFromTaskEntities(tasks,true);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that a SKIPPED_FAILED status means the stage has completed.
 * @throws Exception
 */
@Test public void testSkippedFailed_Stage() throws Exception {
  Collection<HostRoleCommandEntity> tasks=getTaskEntities(HostRoleStatus.SKIPPED_FAILED);
  CalculatedStatus status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPercent() throws Exception {
  Collection<HostRoleCommandEntity> tasks=getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING);
  CalculatedStatus status=CalculatedStatus.statusFromTaskEntities(tasks,false);
  assertEquals(40.0,status.getPercent(),0.1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCountsWithRepeatHosts() throws Exception {
  List<Stage> stages=new ArrayList<Stage>();
  stages.addAll(getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED)));
  HostRoleCommandEntity entity=new HostRoleCommandEntity();
  entity.setTaskId(taskId++);
  entity.setStatus(HostRoleStatus.PENDING);
  stages.addAll(getStages(Collections.singleton(entity)));
  CalculatedStatus calc=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,calc.getStatus());
  assertEquals(80d,calc.getPercent(),0.1d);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that a SKIPPED_FAILED status of any task means the
 * summary display status for is SKIPPED_FAILED, but summary status is
 * still COMPLETED
 * @throws Exception
 */
@Test public void testSkippedFailed_UpgradeGroup() throws Exception {
  final HostRoleCommandStatusSummaryDTO summary1=createNiceMock(HostRoleCommandStatusSummaryDTO.class);
  ArrayList<HostRoleStatus> taskStatuses1=new ArrayList<HostRoleStatus>(){
{
      add(HostRoleStatus.COMPLETED);
      add(HostRoleStatus.COMPLETED);
      add(HostRoleStatus.COMPLETED);
    }
  }
;
  final HostRoleCommandStatusSummaryDTO summary2=createNiceMock(HostRoleCommandStatusSummaryDTO.class);
  ArrayList<HostRoleStatus> taskStatuses2=new ArrayList<HostRoleStatus>(){
{
      add(HostRoleStatus.COMPLETED);
      add(HostRoleStatus.SKIPPED_FAILED);
      add(HostRoleStatus.COMPLETED);
    }
  }
;
  Map<Long,HostRoleCommandStatusSummaryDTO> stageDto=new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1l,summary1);
      put(2l,summary2);
    }
  }
;
  Set<Long> stageIds=new HashSet<Long>(){
{
      add(1l);
      add(2l);
    }
  }
;
  expect(summary1.getTaskTotal()).andReturn(taskStatuses1.size()).anyTimes();
  expect(summary2.getTaskTotal()).andReturn(taskStatuses2.size()).anyTimes();
  expect(summary1.isStageSkippable()).andReturn(true).anyTimes();
  expect(summary2.isStageSkippable()).andReturn(true).anyTimes();
  expect(summary1.getTaskStatuses()).andReturn(taskStatuses1).anyTimes();
  expect(summary2.getTaskStatuses()).andReturn(taskStatuses2).anyTimes();
  replay(summary1,summary2);
  CalculatedStatus calc=CalculatedStatus.statusFromStageSummary(stageDto,stageIds);
  assertEquals(HostRoleStatus.SKIPPED_FAILED,calc.getDisplayStatus());
  assertEquals(HostRoleStatus.COMPLETED,calc.getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCalculateStatusCounts() throws Exception {
  Collection<HostRoleStatus> hostRoleStatuses=new LinkedList<HostRoleStatus>();
  hostRoleStatuses.add(HostRoleStatus.PENDING);
  hostRoleStatuses.add(HostRoleStatus.QUEUED);
  hostRoleStatuses.add(HostRoleStatus.HOLDING);
  hostRoleStatuses.add(HostRoleStatus.HOLDING_FAILED);
  hostRoleStatuses.add(HostRoleStatus.HOLDING_TIMEDOUT);
  hostRoleStatuses.add(HostRoleStatus.IN_PROGRESS);
  hostRoleStatuses.add(HostRoleStatus.IN_PROGRESS);
  hostRoleStatuses.add(HostRoleStatus.COMPLETED);
  hostRoleStatuses.add(HostRoleStatus.COMPLETED);
  hostRoleStatuses.add(HostRoleStatus.COMPLETED);
  hostRoleStatuses.add(HostRoleStatus.COMPLETED);
  hostRoleStatuses.add(HostRoleStatus.FAILED);
  hostRoleStatuses.add(HostRoleStatus.TIMEDOUT);
  hostRoleStatuses.add(HostRoleStatus.ABORTED);
  hostRoleStatuses.add(HostRoleStatus.SKIPPED_FAILED);
  Map<HostRoleStatus,Integer> counts=CalculatedStatus.calculateStatusCounts(hostRoleStatuses);
  assertEquals(1L,(long)counts.get(HostRoleStatus.PENDING));
  assertEquals(1L,(long)counts.get(HostRoleStatus.QUEUED));
  assertEquals(1L,(long)counts.get(HostRoleStatus.HOLDING));
  assertEquals(1L,(long)counts.get(HostRoleStatus.HOLDING_FAILED));
  assertEquals(1L,(long)counts.get(HostRoleStatus.HOLDING_TIMEDOUT));
  assertEquals(5L,(long)counts.get(HostRoleStatus.IN_PROGRESS));
  assertEquals(8L,(long)counts.get(HostRoleStatus.COMPLETED));
  assertEquals(1L,(long)counts.get(HostRoleStatus.FAILED));
  assertEquals(1L,(long)counts.get(HostRoleStatus.TIMEDOUT));
  assertEquals(1L,(long)counts.get(HostRoleStatus.ABORTED));
  assertEquals(1L,(long)counts.get(HostRoleStatus.SKIPPED_FAILED));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClientConfigResourceProviderTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourcesFromCommonServices() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  CommandScriptDefinition commandScriptDefinition=createNiceMock(CommandScriptDefinition.class);
  Config clusterConfig=createNiceMock(Config.class);
  DesiredConfig desiredConfig=createNiceMock(DesiredConfig.class);
  Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent serviceComponent=createNiceMock(ServiceComponent.class);
  ServiceComponentHost serviceComponentHost=createNiceMock(ServiceComponentHost.class);
  ServiceOsSpecific serviceOsSpecific=createNiceMock(ServiceOsSpecific.class);
  ConfigHelper configHelper=createNiceMock(ConfigHelper.class);
  Configuration configuration=PowerMock.createStrictMockAndExpectNew(Configuration.class);
  Map<String,String> configMap=createNiceMock(Map.class);
  File mockFile=PowerMock.createNiceMock(File.class);
  Runtime runtime=createMock(Runtime.class);
  Process process=createNiceMock(Process.class);
  Map<String,DesiredConfig> desiredConfigMap=new HashMap<String,DesiredConfig>();
  desiredConfigMap.put("hive-site",desiredConfig);
  Map<String,Map<String,String>> allConfigTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  ClientConfigFileDefinition clientConfigFileDefinition=new ClientConfigFileDefinition();
  clientConfigFileDefinition.setDictionaryName("pig-env");
  clientConfigFileDefinition.setFileName("pig-env.sh");
  clientConfigFileDefinition.setType("env");
  List<ClientConfigFileDefinition> clientConfigFileDefinitionList=new LinkedList<ClientConfigFileDefinition>();
  clientConfigFileDefinitionList.add(clientConfigFileDefinition);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Request request=PropertyHelper.getReadRequest(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID,"c1",ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID,ClientConfigResourceProvider.COMPONENT_SERVICE_NAME_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID).equals("c1").toPredicate();
  String clusterName="C1";
  String serviceName="PIG";
  String componentName="PIG";
  String hostName="Host100";
  String desiredState="INSTALLED";
  String stackName="S1";
  String stackVersion="V1";
  String stackRoot="/tmp/stacks/S1/V1";
  String packageFolder=StackManager.COMMON_SERVICES + "/PIG/package";
  String commonServicesPath="/var/lib/ambari-server/src/main/resources" + File.separator + "common-services";
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot="C:\\tmp\\stacks\\S1\\V1";
    packageFolder=StackManager.COMMON_SERVICES + "\\PIG\\package";
  }
  HashMap<String,Host> hosts=new HashMap<String,Host>();
  hosts.put(hostName,host);
  HashMap<String,Service> services=new HashMap<String,Service>();
  services.put(serviceName,service);
  HashMap<String,ServiceComponent> serviceComponentMap=new HashMap<String,ServiceComponent>();
  serviceComponentMap.put(componentName,serviceComponent);
  HashMap<String,ServiceComponentHost> serviceComponentHosts=new HashMap<String,ServiceComponentHost>();
  serviceComponentHosts.put(componentName,serviceComponentHost);
  HashMap<String,ServiceOsSpecific> serviceOsSpecificHashMap=new HashMap<String,ServiceOsSpecific>();
  serviceOsSpecificHashMap.put("key",serviceOsSpecific);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse(clusterName,serviceName,componentName,hostName,desiredState,"",null,null,null);
  Set<ServiceComponentHostResponse> responses=new LinkedHashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  Map<String,String> returnConfigMap=new HashMap<String,String>();
  returnConfigMap.put(Configuration.SERVER_TMP_DIR_KEY,Configuration.SERVER_TMP_DIR_DEFAULT);
  returnConfigMap.put(Configuration.AMBARI_PYTHON_WRAP_KEY,Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(managementController.getConfigHelper()).andReturn(configHelper);
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(configHelper.getEffectiveConfigProperties(cluster,configTags)).andReturn(properties);
  expect(clusterConfig.getType()).andReturn(Configuration.HIVE_CONFIG_TAG).anyTimes();
  expect(configHelper.getEffectiveConfigAttributes(cluster,configTags)).andReturn(attributes);
  expect(configMap.get(Configuration.SERVER_TMP_DIR_KEY)).andReturn(Configuration.SERVER_TMP_DIR_DEFAULT);
  expect(configMap.get(Configuration.AMBARI_PYTHON_WRAP_KEY)).andReturn(Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(configuration.getConfigsMap()).andReturn(returnConfigMap);
  expect(configuration.getResourceDirPath()).andReturn("/var/lib/ambari-server/src/main/resources");
  expect(configuration.getJavaVersion()).andReturn(8);
  expect(configuration.areHostsSysPrepped()).andReturn("false");
  expect(configuration.getExternalScriptTimeout()).andReturn(Integer.parseInt(Configuration.EXTERNAL_SCRIPT_TIMEOUT_DEFAULT));
  Map<String,String> props=new HashMap<String,String>();
  props.put(Configuration.HIVE_METASTORE_PASSWORD_PROPERTY,"pass");
  props.put("key","value");
  expect(clusterConfig.getProperties()).andReturn(props);
  expect(configHelper.getEffectiveDesiredTags(cluster,hostName)).andReturn(allConfigTags);
  expect(cluster.getClusterName()).andReturn(clusterName);
  expect(managementController.getHostComponents((Set<ServiceComponentHostRequest>)anyObject())).andReturn(responses).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  PowerMock.mockStaticPartial(StageUtils.class,"getClusterHostInfo");
  Map<String,Set<String>> clusterHostInfo=new HashMap<String,Set<String>>();
  Set<String> all_hosts=new HashSet<String>(Arrays.asList("Host100","Host101","Host102"));
  Set<String> some_hosts=new HashSet<String>(Arrays.asList("0-1","2"));
  Set<String> ohter_hosts=new HashSet<String>(Arrays.asList("0,1"));
  Set<String> clusterHostTypes=new HashSet<String>(Arrays.asList("nm_hosts","hs_host","namenode_host","rm_host","snamenode_host","slave_hosts","zookeeper_hosts"));
  for (  String hostTypes : clusterHostTypes) {
    if (hostTypes.equals("slave_hosts")) {
      clusterHostInfo.put(hostTypes,ohter_hosts);
    }
 else {
      clusterHostInfo.put(hostTypes,some_hosts);
    }
  }
  Map<String,Host> stringHostMap=new HashMap<String,Host>();
  stringHostMap.put(hostName,host);
  clusterHostInfo.put("all_hosts",all_hosts);
  expect(StageUtils.getClusterHostInfo(cluster)).andReturn(clusterHostInfo);
  expect(stackId.getStackName()).andReturn(stackName).anyTimes();
  expect(stackId.getStackVersion()).andReturn(stackVersion).anyTimes();
  expect(ambariMetaInfo.getComponent(stackName,stackVersion,serviceName,componentName)).andReturn(componentInfo);
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getServicePackageFolder()).andReturn(packageFolder);
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCommandScript()).andReturn(commandScriptDefinition);
  expect(componentInfo.getClientConfigFiles()).andReturn(clientConfigFileDefinitionList);
  expect(cluster.getConfig("hive-site",null)).andReturn(clusterConfig);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigMap);
  expect(clusters.getHost(hostName)).andReturn(host);
  HashMap<String,String> rcaParams=new HashMap<String,String>();
  rcaParams.put("key","value");
  expect(managementController.getRcaParameters()).andReturn(rcaParams).anyTimes();
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getOsSpecifics()).andReturn(new HashMap<String,ServiceOsSpecific>()).anyTimes();
  Set<String> userSet=new HashSet<String>();
  userSet.add("hdfs");
  expect(configHelper.getPropertyValuesWithPropertyType(stackId,PropertyInfo.PropertyType.USER,cluster)).andReturn(userSet);
  PowerMock.expectNew(File.class,new Class<?>[]{String.class},anyObject(String.class)).andReturn(mockFile).anyTimes();
  PowerMock.createNiceMockAndExpectNew(PrintWriter.class,anyObject());
  expect(mockFile.getParent()).andReturn("");
  PowerMock.mockStatic(Runtime.class);
  expect(mockFile.exists()).andReturn(true);
  String commandLine="ambari-python-wrap " + commonServicesPath + "/PIG/package/null generate_configs null "+ commonServicesPath+ "/PIG/package /var/lib/ambari-server/tmp/structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  if (System.getProperty("os.name").contains("Windows")) {
    commandLine="ambari-python-wrap " + commonServicesPath + "\\PIG\\package\\null generate_configs null "+ commonServicesPath+ "\\PIG\\package /var/lib/ambari-server/tmp\\structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  }
  ProcessBuilder processBuilder=PowerMock.createNiceMock(ProcessBuilder.class);
  PowerMock.expectNew(ProcessBuilder.class,Arrays.asList(commandLine.split("\\s+"))).andReturn(processBuilder).once();
  expect(processBuilder.start()).andReturn(process).once();
  InputStream inputStream=new ByteArrayInputStream("some logging info".getBytes());
  expect(process.getInputStream()).andReturn(inputStream);
  replay(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process,configMap);
  PowerMock.replayAll();
  Set<Resource> resources=provider.getResources(request,predicate);
  assertFalse(resources.isEmpty());
  verify(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process);
  PowerMock.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  CommandScriptDefinition commandScriptDefinition=createNiceMock(CommandScriptDefinition.class);
  Config clusterConfig=createNiceMock(Config.class);
  DesiredConfig desiredConfig=createNiceMock(DesiredConfig.class);
  Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent serviceComponent=createNiceMock(ServiceComponent.class);
  ServiceComponentHost serviceComponentHost=createNiceMock(ServiceComponentHost.class);
  ServiceOsSpecific serviceOsSpecific=createNiceMock(ServiceOsSpecific.class);
  ConfigHelper configHelper=createNiceMock(ConfigHelper.class);
  Configuration configuration=PowerMock.createStrictMockAndExpectNew(Configuration.class);
  Map<String,String> configMap=createNiceMock(Map.class);
  File mockFile=PowerMock.createNiceMock(File.class);
  Runtime runtime=createMock(Runtime.class);
  Process process=createNiceMock(Process.class);
  Map<String,DesiredConfig> desiredConfigMap=new HashMap<String,DesiredConfig>();
  desiredConfigMap.put("hive-site",desiredConfig);
  Map<String,Map<String,String>> allConfigTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  ClientConfigFileDefinition clientConfigFileDefinition=new ClientConfigFileDefinition();
  clientConfigFileDefinition.setDictionaryName("pig-env");
  clientConfigFileDefinition.setFileName("pig-env.sh");
  clientConfigFileDefinition.setType("env");
  List<ClientConfigFileDefinition> clientConfigFileDefinitionList=new LinkedList<ClientConfigFileDefinition>();
  clientConfigFileDefinitionList.add(clientConfigFileDefinition);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Request request=PropertyHelper.getReadRequest(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID,"c1",ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID,ClientConfigResourceProvider.COMPONENT_SERVICE_NAME_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID).equals("c1").toPredicate();
  String clusterName="C1";
  String serviceName="PIG";
  String componentName="PIG";
  String hostName="Host100";
  String desiredState="INSTALLED";
  String stackName="S1";
  String stackVersion="V1";
  String stackRoot="/tmp/stacks/S1/V1";
  String packageFolder="PIG/package";
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot="C:\\tmp\\stacks\\S1\\V1";
    packageFolder="PIG\\package";
  }
  HashMap<String,Host> hosts=new HashMap<String,Host>();
  hosts.put(hostName,host);
  HashMap<String,Service> services=new HashMap<String,Service>();
  services.put(serviceName,service);
  HashMap<String,ServiceComponent> serviceComponentMap=new HashMap<String,ServiceComponent>();
  serviceComponentMap.put(componentName,serviceComponent);
  HashMap<String,ServiceComponentHost> serviceComponentHosts=new HashMap<String,ServiceComponentHost>();
  serviceComponentHosts.put(componentName,serviceComponentHost);
  HashMap<String,ServiceOsSpecific> serviceOsSpecificHashMap=new HashMap<String,ServiceOsSpecific>();
  serviceOsSpecificHashMap.put("key",serviceOsSpecific);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse(clusterName,serviceName,componentName,hostName,desiredState,"",null,null,null);
  Set<ServiceComponentHostResponse> responses=new LinkedHashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  Map<String,String> returnConfigMap=new HashMap<String,String>();
  returnConfigMap.put(Configuration.SERVER_TMP_DIR_KEY,Configuration.SERVER_TMP_DIR_DEFAULT);
  returnConfigMap.put(Configuration.AMBARI_PYTHON_WRAP_KEY,Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(managementController.getConfigHelper()).andReturn(configHelper);
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(configHelper.getEffectiveConfigProperties(cluster,configTags)).andReturn(properties);
  expect(clusterConfig.getType()).andReturn(Configuration.HIVE_CONFIG_TAG).anyTimes();
  expect(configHelper.getEffectiveConfigAttributes(cluster,configTags)).andReturn(attributes);
  expect(configMap.get(Configuration.SERVER_TMP_DIR_KEY)).andReturn(Configuration.SERVER_TMP_DIR_DEFAULT);
  expect(configMap.get(Configuration.AMBARI_PYTHON_WRAP_KEY)).andReturn(Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(configuration.getConfigsMap()).andReturn(returnConfigMap);
  expect(configuration.getResourceDirPath()).andReturn(stackRoot);
  expect(configuration.getJavaVersion()).andReturn(8);
  expect(configuration.areHostsSysPrepped()).andReturn("false");
  expect(configuration.getExternalScriptTimeout()).andReturn(Integer.parseInt(Configuration.EXTERNAL_SCRIPT_TIMEOUT_DEFAULT));
  Map<String,String> props=new HashMap<String,String>();
  props.put(Configuration.HIVE_METASTORE_PASSWORD_PROPERTY,"pass");
  props.put("key","value");
  expect(clusterConfig.getProperties()).andReturn(props);
  expect(configHelper.getEffectiveDesiredTags(cluster,hostName)).andReturn(allConfigTags);
  expect(cluster.getClusterName()).andReturn(clusterName);
  expect(managementController.getHostComponents((Set<ServiceComponentHostRequest>)anyObject())).andReturn(responses).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  PowerMock.mockStaticPartial(StageUtils.class,"getClusterHostInfo");
  Map<String,Set<String>> clusterHostInfo=new HashMap<String,Set<String>>();
  Set<String> all_hosts=new HashSet<String>(Arrays.asList("Host100","Host101","Host102"));
  Set<String> some_hosts=new HashSet<String>(Arrays.asList("0-1","2"));
  Set<String> ohter_hosts=new HashSet<String>(Arrays.asList("0,1"));
  Set<String> clusterHostTypes=new HashSet<String>(Arrays.asList("nm_hosts","hs_host","namenode_host","rm_host","snamenode_host","slave_hosts","zookeeper_hosts"));
  for (  String hostTypes : clusterHostTypes) {
    if (hostTypes.equals("slave_hosts")) {
      clusterHostInfo.put(hostTypes,ohter_hosts);
    }
 else {
      clusterHostInfo.put(hostTypes,some_hosts);
    }
  }
  Map<String,Host> stringHostMap=new HashMap<String,Host>();
  stringHostMap.put(hostName,host);
  clusterHostInfo.put("all_hosts",all_hosts);
  expect(StageUtils.getClusterHostInfo(cluster)).andReturn(clusterHostInfo);
  expect(stackId.getStackName()).andReturn(stackName).anyTimes();
  expect(stackId.getStackVersion()).andReturn(stackVersion).anyTimes();
  expect(ambariMetaInfo.getComponent(stackName,stackVersion,serviceName,componentName)).andReturn(componentInfo);
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getServicePackageFolder()).andReturn(packageFolder);
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCommandScript()).andReturn(commandScriptDefinition);
  expect(componentInfo.getClientConfigFiles()).andReturn(clientConfigFileDefinitionList);
  expect(cluster.getConfig("hive-site",null)).andReturn(clusterConfig);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigMap);
  expect(clusters.getHost(hostName)).andReturn(host);
  HashMap<String,String> rcaParams=new HashMap<String,String>();
  rcaParams.put("key","value");
  expect(managementController.getRcaParameters()).andReturn(rcaParams).anyTimes();
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getOsSpecifics()).andReturn(new HashMap<String,ServiceOsSpecific>()).anyTimes();
  Set<String> userSet=new HashSet<String>();
  userSet.add("hdfs");
  expect(configHelper.getPropertyValuesWithPropertyType(stackId,PropertyInfo.PropertyType.USER,cluster)).andReturn(userSet);
  PowerMock.expectNew(File.class,new Class<?>[]{String.class},anyObject(String.class)).andReturn(mockFile).anyTimes();
  PowerMock.createNiceMockAndExpectNew(PrintWriter.class,anyObject());
  expect(mockFile.getParent()).andReturn("");
  PowerMock.mockStatic(Runtime.class);
  expect(mockFile.exists()).andReturn(true);
  String commandLine="ambari-python-wrap /tmp/stacks/S1/V1/PIG/package/null generate_configs null " + "/tmp/stacks/S1/V1/PIG/package /var/lib/ambari-server/tmp/structured-out.json " + "INFO /var/lib/ambari-server/tmp";
  if (System.getProperty("os.name").contains("Windows")) {
    commandLine="ambari-python-wrap " + stackRoot + "\\PIG\\package\\null generate_configs null "+ stackRoot+ "\\PIG\\package /var/lib/ambari-server/tmp\\structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  }
  ProcessBuilder processBuilder=PowerMock.createNiceMock(ProcessBuilder.class);
  PowerMock.expectNew(ProcessBuilder.class,Arrays.asList(commandLine.split("\\s+"))).andReturn(processBuilder).once();
  expect(processBuilder.start()).andReturn(process).once();
  InputStream inputStream=new ByteArrayInputStream("some logging info".getBytes());
  expect(process.getInputStream()).andReturn(inputStream);
  replay(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process,configMap);
  PowerMock.replayAll();
  Set<Resource> resources=provider.getResources(request,predicate);
  assertFalse(resources.isEmpty());
  verify(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process);
  PowerMock.verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterControllerImplTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesPageToOffset() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetEnd,2,2,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(1,pageResponse.getOffset());
  Assert.assertEquals("host:0",pageResponse.getPreviousResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:2",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetEnd,3,2,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(0,pageResponse.getOffset());
  Assert.assertNull(pageResponse.getPreviousResource());
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:2",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesSortedWithPredicateWithItemsTotal() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property("c1/p2").equals(1).toPredicate();
  List<SortRequestProperty> sortRequestProperties=Collections.singletonList(new SortRequestProperty("Hosts/host_name",SortRequest.Order.DESC));
  SortRequest sortRequest=new SortRequestImpl(sortRequestProperties);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.Beginning,1,0,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,predicate,pageRequest,sortRequest);
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(1,list.size());
  Assert.assertEquals(2,pageResponse.getTotalResourceCount().intValue());
  Assert.assertEquals("host:3",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,1,1,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,predicate,pageRequest,sortRequest);
  iterable=pageResponse.getIterable();
  list.clear();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(1,list.size());
  Assert.assertEquals(2,pageResponse.getTotalResourceCount().intValue());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesPageFromStart() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.Beginning,2,0,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.Beginning,3,0,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:2",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateResourcesResolvePredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  Request request=PropertyHelper.getUpdateRequest(propertyMap,null);
  Predicate predicate=new PredicateBuilder().property("c3/p6").equals(1).toPredicate();
  controller.updateResources(Resource.Type.Host,request,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Update,resourceProvider.getLastAction());
  Assert.assertSame(request,resourceProvider.getLastRequest());
  Predicate lastPredicate=resourceProvider.getLastPredicate();
  Assert.assertFalse(predicate.equals(lastPredicate));
  Set<String> predicatePropertyIds=PredicateHelper.getPropertyIds(lastPredicate);
  Collection<String> keyPropertyIds=resourceProvider.getKeyPropertyIds().values();
  Assert.assertEquals(predicatePropertyIds.size(),keyPropertyIds.size());
  Assert.assertTrue(keyPropertyIds.containsAll(predicatePropertyIds));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesResolvePredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Predicate predicate=new PredicateBuilder().property("c3/p6").equals(1).toPredicate();
  controller.deleteResources(Resource.Type.Host,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Delete,resourceProvider.getLastAction());
  Assert.assertNull(resourceProvider.getLastRequest());
  Predicate lastPredicate=resourceProvider.getLastPredicate();
  Assert.assertFalse(predicate.equals(lastPredicate));
  Set<String> predicatePropertyIds=PredicateHelper.getPropertyIds(lastPredicate);
  Collection<String> keyPropertyIds=resourceProvider.getKeyPropertyIds().values();
  Assert.assertEquals(predicatePropertyIds.size(),keyPropertyIds.size());
  Assert.assertTrue(keyPropertyIds.containsAll(predicatePropertyIds));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesPageToEnd() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.End,2,0,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:2",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:3",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.End,3,0,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:2",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:3",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  properties.add(propertyMap);
  Request request=PropertyHelper.getCreateRequest(properties,null);
  controller.createResources(Resource.Type.Host,request);
  Assert.assertEquals(TestHostResourceProvider.Action.Create,resourceProvider.getLastAction());
  Assert.assertSame(request,resourceProvider.getLastRequest());
  Assert.assertNull(resourceProvider.getLastPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateResources() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  Request request=PropertyHelper.getUpdateRequest(propertyMap,null);
  Predicate predicate=new PredicateBuilder().property("c1/p2").equals(1).toPredicate();
  controller.updateResources(Resource.Type.Host,request,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Update,resourceProvider.getLastAction());
  Assert.assertSame(request,resourceProvider.getLastRequest());
  Assert.assertSame(predicate,resourceProvider.getLastPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesPageFromOffset() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,2,1,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(1,pageResponse.getOffset());
  Assert.assertEquals("host:0",pageResponse.getPreviousResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:2",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,3,0,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(0,pageResponse.getOffset());
  Assert.assertNull(pageResponse.getPreviousResource());
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:2",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesWithRetry() throws Exception {
  RetryHelper.init(3);
  Resource.Type type=Resource.Type.Cluster;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  managementController.createCluster(AbstractResourceProviderTest.Matcher.getClusterRequest(null,"Cluster100","HDP-0.1",null));
  expectLastCall().andThrow(new DatabaseException("test"){
  }
).once().andVoid().atLeastOnce();
  replay(managementController,response);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"HDP-0.1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Cluster,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  Assert.assertEquals(request,lastEvent.getRequest());
  Assert.assertNull(lastEvent.getPredicate());
  verify(managementController,response);
  RetryHelper.init(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterStackVersionResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources() throws Exception {
  Resource.Type type=Resource.Type.ClusterStackVersion;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  StackId stackId=new StackId("HDP","2.0.1");
  Map<String,Host> hostsForCluster=new HashMap<String,Host>();
  int hostCount=10;
  for (int i=0; i < hostCount; i++) {
    String hostname="host" + i;
    Host host=createNiceMock(hostname,Host.class);
    expect(host.getHostName()).andReturn(hostname).anyTimes();
    expect(host.getOsFamily()).andReturn("redhat6").anyTimes();
    expect(host.getMaintenanceState(EasyMock.anyLong())).andReturn(MaintenanceState.OFF).anyTimes();
    replay(host);
    hostsForCluster.put(hostname,host);
  }
  final ServiceComponentHost schDatanode=createMock(ServiceComponentHost.class);
  expect(schDatanode.getServiceName()).andReturn("HDFS").anyTimes();
  expect(schDatanode.getServiceComponentName()).andReturn("DATANODE").anyTimes();
  final ServiceComponentHost schNamenode=createMock(ServiceComponentHost.class);
  expect(schNamenode.getServiceName()).andReturn("HDFS").anyTimes();
  expect(schNamenode.getServiceComponentName()).andReturn("NAMENODE").anyTimes();
  final ServiceComponentHost schAMS=createMock(ServiceComponentHost.class);
  expect(schAMS.getServiceName()).andReturn("AMBARI_METRICS").anyTimes();
  expect(schAMS.getServiceComponentName()).andReturn("METRICS_COLLECTOR").anyTimes();
  final List<ServiceComponentHost> schsH1=new ArrayList<ServiceComponentHost>(){
{
      add(schDatanode);
      add(schNamenode);
      add(schAMS);
    }
  }
;
  final List<ServiceComponentHost> schsH2=new ArrayList<ServiceComponentHost>(){
{
      add(schAMS);
    }
  }
;
  RepositoryVersionEntity repoVersion=new RepositoryVersionEntity();
  repoVersion.setId(1l);
  repoVersion.setOperatingSystems(operatingSystemsJson);
  ServiceOsSpecific.Package hdfsPackage=new ServiceOsSpecific.Package();
  hdfsPackage.setName("hdfs");
  List<ServiceOsSpecific.Package> packages=Collections.singletonList(hdfsPackage);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider csvResourceProvider=createNiceMock(ClusterStackVersionResourceProvider.class);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Map<String,Map<String,String>> hostConfigTags=new HashMap<String,Map<String,String>>();
  expect(configHelper.getEffectiveDesiredTags(anyObject(ClusterImpl.class),anyObject(String.class))).andReturn(hostConfigTags);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getJdkResourceUrl()).andReturn("/JdkResourceUrl").anyTimes();
  expect(managementController.getPackagesForServiceHost(anyObject(ServiceInfo.class),(Map<String,String>)anyObject(List.class),anyObject(String.class))).andReturn(packages).times((hostCount - 1) * 2);
  expect(resourceProviderFactory.getHostResourceProvider(anyObject(Set.class),anyObject(Map.class),eq(managementController))).andReturn(csvResourceProvider).anyTimes();
  expect(clusters.getCluster(anyObject(String.class))).andReturn(cluster);
  expect(clusters.getHostsForCluster(anyObject(String.class))).andReturn(hostsForCluster).anyTimes();
  String clusterName="Cluster100";
  expect(cluster.getClusterId()).andReturn(1L).anyTimes();
  expect(cluster.getHosts()).andReturn(hostsForCluster.values()).atLeastOnce();
  expect(cluster.getServices()).andReturn(new HashMap<String,Service>()).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  expect(cluster.getServiceComponentHosts(anyObject(String.class))).andAnswer(new IAnswer<List<ServiceComponentHost>>(){
    @Override public List<ServiceComponentHost> answer() throws Throwable {
      String hostname=(String)EasyMock.getCurrentArguments()[0];
      if (hostname.equals("host2")) {
        return schsH2;
      }
 else {
        return schsH1;
      }
    }
  }
).anyTimes();
  ExecutionCommand executionCommand=createNiceMock(ExecutionCommand.class);
  ExecutionCommandWrapper executionCommandWrapper=createNiceMock(ExecutionCommandWrapper.class);
  expect(executionCommandWrapper.getExecutionCommand()).andReturn(executionCommand).anyTimes();
  Stage stage=createNiceMock(Stage.class);
  expect(stage.getExecutionCommandWrapper(anyObject(String.class),anyObject(String.class))).andReturn(executionCommandWrapper).anyTimes();
  Map<Role,Float> successFactors=new HashMap<>();
  expect(stage.getSuccessFactors()).andReturn(successFactors).atLeastOnce();
  expect(stageFactory.createNew(anyLong(),anyObject(String.class),anyObject(String.class),anyLong(),anyObject(String.class),anyObject(String.class),anyObject(String.class),anyObject(String.class))).andReturn(stage).times((int)Math.ceil(hostCount / MAX_TASKS_PER_STAGE));
  expect(repositoryVersionDAOMock.findByStackAndVersion(anyObject(StackId.class),anyObject(String.class))).andReturn(repoVersion);
  expect(actionManager.getRequestTasks(anyLong())).andReturn(Collections.<HostRoleCommand>emptyList()).anyTimes();
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterId(1l);
  clusterEntity.setClusterName(clusterName);
  ClusterVersionEntity cve=new ClusterVersionEntity(clusterEntity,repoVersion,RepositoryVersionState.INSTALL_FAILED,0,"");
  expect(clusterVersionDAO.findByClusterAndStackAndVersion(anyObject(String.class),anyObject(StackId.class),anyObject(String.class))).andReturn(cve);
  TopologyManager topologyManager=injector.getInstance(TopologyManager.class);
  StageUtils.setTopologyManager(topologyManager);
  replay(managementController,response,clusters,resourceProviderFactory,csvResourceProvider,cluster,repositoryVersionDAOMock,configHelper,schDatanode,schNamenode,schAMS,actionManager,executionCommand,executionCommandWrapper,stage,stageFactory,clusterVersionDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  injector.injectMembers(provider);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_REPOSITORY_VERSION_PROPERTY_ID,"2.2.0.1-885");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_STACK_PROPERTY_ID,"HDP");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_VERSION_PROPERTY_ID,"2.1.1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  RequestStatus status=provider.createResources(request);
  Assert.assertNotNull(status);
  verify(managementController,response,clusters,stageFactory,stage);
  Float successFactor=successFactors.get(Role.INSTALL_PACKAGES);
  Assert.assertEquals(Float.valueOf(0.85f),successFactor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ComponentResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceComponentNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetComponents_OR_Predicate_ServiceComponentNotFoundException() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ComponentInfo component3Info=createNiceMock(ComponentInfo.class);
  ComponentInfo component4Info=createNiceMock(ComponentInfo.class);
  ServiceComponent component1=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponentResponse response1=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentResponse response2=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentRequest request1=new ServiceComponentRequest("cluster1","service1","component1",null);
  ServiceComponentRequest request2=new ServiceComponentRequest("cluster1","service1","component2",null);
  ServiceComponentRequest request3=new ServiceComponentRequest("cluster1","service1","component3",null);
  ServiceComponentRequest request4=new ServiceComponentRequest("cluster1","service1","component4",null);
  ServiceComponentRequest request5=new ServiceComponentRequest("cluster1","service2",null,null);
  Set<ServiceComponentRequest> setRequests=new HashSet<ServiceComponentRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  setRequests.add(request5);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(stackId.getStackName()).andReturn("stackName").anyTimes();
  expect(stackId.getStackVersion()).andReturn("1").anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stackId).anyTimes();
  expect(cluster.getService("service1")).andReturn(service).anyTimes();
  expect(cluster.getService("service2")).andThrow(new ObjectNotFoundException("service2"));
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component3")).andReturn(component3Info);
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component4")).andReturn(component4Info);
  expect(component3Info.getCategory()).andReturn(null);
  expect(component4Info.getCategory()).andReturn(null);
  expect(service.getName()).andReturn("service1").anyTimes();
  expect(service.getServiceComponent("component1")).andThrow(new ServiceComponentNotFoundException("cluster1","service1","component1"));
  expect(service.getServiceComponent("component2")).andThrow(new ServiceComponentNotFoundException("cluster1","service1","component2"));
  expect(service.getServiceComponent("component3")).andReturn(component1);
  expect(service.getServiceComponent("component4")).andReturn(component2);
  expect(component1.convertToResponse()).andReturn(response1);
  expect(component2.convertToResponse()).andReturn(response2);
  replay(clusters,cluster,service,component3Info,component4Info,component1,component2,response1,response2,ambariMetaInfo,stackId,managementController);
  Set<ServiceComponentResponse> setResponses=getComponentResourceProvider(managementController).getComponents(setRequests);
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(clusters,cluster,service,component3Info,component4Info,component1,component2,response1,response2,ambariMetaInfo,stackId,managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetComponents() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponentResponse response=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentRequest request1=new ServiceComponentRequest("cluster1","service1","component1",null);
  Set<ServiceComponentRequest> setRequests=new HashSet<ServiceComponentRequest>();
  setRequests.add(request1);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(stackId.getStackName()).andReturn("stackName").anyTimes();
  expect(stackId.getStackVersion()).andReturn("1").anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andReturn(service);
  expect(cluster.getDesiredStackVersion()).andReturn(stackId).anyTimes();
  expect(service.getName()).andReturn("service1").anyTimes();
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component1")).andReturn(componentInfo);
  expect(componentInfo.getCategory()).andReturn(null);
  expect(component.convertToResponse()).andReturn(response);
  replay(clusters,cluster,service,componentInfo,component,response,ambariMetaInfo,stackId,managementController);
  Set<ServiceComponentResponse> setResponses=getComponentResourceProvider(managementController).getComponents(setRequests);
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(clusters,cluster,service,componentInfo,component,response,ambariMetaInfo,stackId,managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigGroupResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConfigGroupRequest_populatesConfigAttributes() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ConfigGroupResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  Set<Map<String,String>> desiredConfigProperties=new HashSet<Map<String,String>>();
  Map<String,String> desiredConfig1=new HashMap<String,String>();
  desiredConfig1.put("tag","version2");
  desiredConfig1.put("type","type1");
  desiredConfig1.put("properties/key1","value1");
  desiredConfig1.put("properties/key2","value2");
  desiredConfig1.put("properties_attributes/attr1/key1","true");
  desiredConfig1.put("properties_attributes/attr1/key2","false");
  desiredConfig1.put("properties_attributes/attr2/key1","15");
  desiredConfigProperties.add(desiredConfig1);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("ConfigGroup/hosts",new HashMap<String,String>(){
{
      put("host_name","ambari1");
    }
  }
);
  properties.put("ConfigGroup/cluster_name","c");
  properties.put("ConfigGroup/desired_configs",desiredConfigProperties);
  ConfigGroupRequest request=resourceProvider.getConfigGroupRequest(properties);
  assertNotNull(request);
  Map<String,Config> configMap=request.getConfigs();
  assertNotNull(configMap);
  assertEquals(1,configMap.size());
  assertTrue(configMap.containsKey("type1"));
  Config config=configMap.get("type1");
  assertEquals("type1",config.getType());
  Map<String,String> configProperties=config.getProperties();
  assertNotNull(configProperties);
  assertEquals(2,configProperties.size());
  assertEquals("value1",configProperties.get("key1"));
  assertEquals("value2",configProperties.get("key2"));
  Map<String,Map<String,String>> configAttributes=config.getPropertiesAttributes();
  assertNotNull(configAttributes);
  assertEquals(2,configAttributes.size());
  assertTrue(configAttributes.containsKey("attr1"));
  Map<String,String> attr1=configAttributes.get("attr1");
  assertNotNull(attr1);
  assertEquals(2,attr1.size());
  assertEquals("true",attr1.get("key1"));
  assertEquals("false",attr1.get("key2"));
  assertTrue(configAttributes.containsKey("attr2"));
  Map<String,String> attr2=configAttributes.get("attr2");
  assertNotNull(attr2);
  assertEquals(1,attr2.size());
  assertEquals("15",attr2.get("key1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testGetConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Host h1=createNiceMock(Host.class);
  final Long host1Id=1L;
  List<Long> hostIds=new ArrayList<Long>(){
{
      add(host1Id);
    }
  }
;
  List<String> hostNames=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  HostEntity hostEntity1=createMock(HostEntity.class);
  expect(hostDAO.getHostNamesByHostIds(hostIds)).andReturn(hostNames).atLeastOnce();
  expect(hostDAO.findByName("h1")).andReturn(hostEntity1).anyTimes();
  expect(hostEntity1.getHostId()).andReturn(host1Id).anyTimes();
  ConfigGroup configGroup1=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup2=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup3=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup4=createNiceMock(ConfigGroup.class);
  ConfigGroupResponse response1=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response2=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response3=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response4=createNiceMock(ConfigGroupResponse.class);
  Map<Long,ConfigGroup> configGroupMap=new HashMap<Long,ConfigGroup>();
  configGroupMap.put(1L,configGroup1);
  configGroupMap.put(2L,configGroup2);
  configGroupMap.put(3L,configGroup3);
  configGroupMap.put(4L,configGroup4);
  Map<Long,ConfigGroup> configGroupByHostname=new HashMap<Long,ConfigGroup>();
  configGroupByHostname.put(4L,configGroup4);
  expect(configGroup1.convertToResponse()).andReturn(response1).anyTimes();
  expect(configGroup2.convertToResponse()).andReturn(response2).anyTimes();
  expect(configGroup3.convertToResponse()).andReturn(response3).anyTimes();
  expect(configGroup4.convertToResponse()).andReturn(response4).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getConfigGroups()).andReturn(configGroupMap).anyTimes();
  expect(cluster.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(configGroup1.getName()).andReturn("g1").anyTimes();
  expect(configGroup2.getName()).andReturn("g2").anyTimes();
  expect(configGroup3.getName()).andReturn("g3").anyTimes();
  expect(configGroup4.getName()).andReturn("g4").anyTimes();
  expect(configGroup1.getTag()).andReturn("t1").anyTimes();
  expect(configGroup2.getTag()).andReturn("t2").anyTimes();
  expect(configGroup3.getTag()).andReturn("t3").anyTimes();
  expect(configGroup4.getTag()).andReturn("t4").anyTimes();
  Map<Long,Host> hostMap=new HashMap<Long,Host>();
  hostMap.put(host1Id,h1);
  expect(configGroup4.getHosts()).andReturn(hostMap).anyTimes();
  expect(response1.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response2.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response3.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response4.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response1.getId()).andReturn(1L).anyTimes();
  expect(response2.getId()).andReturn(2L).anyTimes();
  expect(response3.getId()).andReturn(3L).anyTimes();
  expect(response4.getId()).andReturn(4L).anyTimes();
  expect(response2.getGroupName()).andReturn("g2").anyTimes();
  expect(response3.getTag()).andReturn("t3").anyTimes();
  expect(cluster.getConfigGroupsByHostname("h1")).andReturn(configGroupByHostname).anyTimes();
  Set<Map<String,Object>> hostObj=new HashSet<Map<String,Object>>();
  Map<String,Object> hostnames=new HashMap<String,Object>();
  hostnames.put("host_name","h1");
  hostObj.add(hostnames);
  expect(response4.getHosts()).andReturn(hostObj).anyTimes();
  replay(managementController,clusters,cluster,hostDAO,hostEntity1,configGroup1,configGroup2,configGroup3,configGroup4,response1,response2,response3,response4);
  ResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  assertEquals(4,resources.size());
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(1L).and().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals(1L,resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID).equals("g2").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals("g2",resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t3").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals("t3",resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  Set<Map<String,Object>> hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_HOSTNAME_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t4").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID).equals(host1Id).toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t4").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_HOSTNAME_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(11L).and().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  NoSuchResourceException resourceException=null;
  try {
    resourceProvider.getResources(request,predicate);
  }
 catch (  NoSuchResourceException ce) {
    resourceException=ce;
  }
  Assert.assertNotNull(resourceException);
  verify(managementController,clusters,cluster,hostDAO,hostEntity1,configGroup1,configGroup2,configGroup3,configGroup4,response1,response2,response3,response4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Configuration;
  StackId stackId=new StackId("HDP","0.1");
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<ConfigurationResponse> allResponse=new HashSet<ConfigurationResponse>();
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag3",3L,null,null));
  Set<ConfigurationResponse> orResponse=new HashSet<ConfigurationResponse>();
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  Capture<Set<ConfigurationRequest>> configRequestCapture1=new Capture<Set<ConfigurationRequest>>();
  Capture<Set<ConfigurationRequest>> configRequestCapture2=new Capture<Set<ConfigurationRequest>>();
  expect(managementController.getConfigurations(capture(configRequestCapture1))).andReturn(allResponse).once();
  expect(managementController.getConfigurations(capture(configRequestCapture2))).andReturn(orResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Set<ConfigurationRequest> setRequest=configRequestCapture1.getValue();
  assertEquals(1,setRequest.size());
  ConfigurationRequest configRequest=setRequest.iterator().next();
  assertEquals("Cluster100",configRequest.getClusterName());
  assertNull(configRequest.getType());
  assertNull(configRequest.getVersionTag());
  Assert.assertEquals(3,resources.size());
  boolean containsResource1=false;
  boolean containsResource2=false;
  boolean containsResource3=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    String stackIdProperty=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_STACK_ID_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    Assert.assertEquals(stackId.getStackId(),stackIdProperty);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
 else     if (tag.equals("tag3")) {
      containsResource3=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  assertTrue(containsResource3);
  predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag1").or().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag2").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  resources=provider.getResources(request,predicate);
  setRequest=configRequestCapture2.getValue();
  assertEquals(2,setRequest.size());
  boolean containsTag1=false;
  boolean containsTag2=false;
  for (  ConfigurationRequest cr : setRequest) {
    assertNull(cr.getClusterName());
    if (cr.getVersionTag().equals("tag1")) {
      containsTag1=true;
    }
 else     if (cr.getVersionTag().equals("tag2")) {
      containsTag2=true;
    }
  }
  assertTrue(containsTag1);
  assertTrue(containsTag2);
  Assert.assertEquals(2,resources.size());
  containsResource1=false;
  containsResource2=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ExportBlueprintRequestTest </h4><pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExport_noConfigs() throws Exception {
  Resource clusterResource=new ResourceImpl(Resource.Type.Cluster);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_ID_PROPERTY_ID,CLUSTER_ID);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"TEST-1.0");
  TreeNode<Resource> clusterNode=new TreeNodeImpl<Resource>(null,clusterResource,"cluster");
  Resource configResource=new ResourceImpl(Resource.Type.Configuration);
  clusterNode.addChild(configResource,"configurations");
  Resource hostsResource=new ResourceImpl(Resource.Type.Host);
  Resource host1Resource=new ResourceImpl(Resource.Type.Host);
  Resource host2Resource=new ResourceImpl(Resource.Type.Host);
  Resource host3Resource=new ResourceImpl(Resource.Type.Host);
  TreeNode<Resource> hostsNode=clusterNode.addChild(hostsResource,"hosts");
  TreeNode<Resource> host1Node=hostsNode.addChild(host1Resource,"host_1");
  TreeNode<Resource> host2Node=hostsNode.addChild(host2Resource,"host_2");
  TreeNode<Resource> host3Node=hostsNode.addChild(host3Resource,"host_3");
  host1Resource.setProperty("Hosts/host_name","host1");
  host2Resource.setProperty("Hosts/host_name","host2");
  host3Resource.setProperty("Hosts/host_name","host3");
  List<String> host1ComponentsList=Arrays.asList("NAMENODE","HDFS_CLIENT","ZOOKEEPER_SERVER","SECONDARY_NAMENODE");
  List<String> host2ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  List<String> host3ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  processHostGroupComponents(host1Node,host1ComponentsList);
  processHostGroupComponents(host2Node,host2ComponentsList);
  processHostGroupComponents(host3Node,host3ComponentsList);
  ExportBlueprintRequest exportBlueprintRequest=new ExportBlueprintRequest(clusterNode);
  assertEquals(CLUSTER_NAME,exportBlueprintRequest.getClusterName());
  Blueprint bp=exportBlueprintRequest.getBlueprint();
  assertEquals("exported-blueprint",bp.getName());
  Map<String,HostGroup> hostGroups=bp.getHostGroups();
  assertEquals(2,hostGroups.size());
  String hg1Name=null;
  String hg2Name=null;
  for (  HostGroup group : hostGroups.values()) {
    Collection<String> components=group.getComponentNames();
    if (components.containsAll(host1ComponentsList)) {
      assertEquals(host1ComponentsList.size(),components.size());
      assertEquals("1",group.getCardinality());
      hg1Name=group.getName();
    }
 else     if (components.containsAll(host2ComponentsList)) {
      assertEquals(host2ComponentsList.size(),components.size());
      assertEquals("2",group.getCardinality());
      hg2Name=group.getName();
    }
 else {
      fail("Host group contained invalid components");
    }
  }
  assertNotNull(hg1Name);
  assertNotNull(hg2Name);
  HostGroupInfo host1Info=exportBlueprintRequest.getHostGroupInfo().get(hg1Name);
  assertEquals(1,host1Info.getHostNames().size());
  assertEquals("host1",host1Info.getHostNames().iterator().next());
  HostGroupInfo host2Info=exportBlueprintRequest.getHostGroupInfo().get(hg2Name);
  assertEquals(2,host2Info.getHostNames().size());
  assertTrue(host2Info.getHostNames().contains("host2") && host2Info.getHostNames().contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.FeedResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  IvoryService service=createMock(IvoryService.class);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  Map<String,Object> properties=new HashMap<String,Object>();
  List<String> feedNames=new LinkedList<String>();
  feedNames.add("Feed1");
  feedNames.add("Feed2");
  feedNames.add("Feed3");
  Map<String,String> props=new HashMap<String,String>();
  Feed feed1=new Feed("Feed1","d","s","sch","source","st","end","l","a","target","st","end","l","a",props);
  Feed feed2=new Feed("Feed2","d","s","sch","source","st","end","l","a","target","st","end","l","a",props);
  Feed feed3=new Feed("Feed3","d","s","sch","source","st","end","l","a","target","st","end","l","a",props);
  expect(service.getFeedNames()).andReturn(feedNames);
  expect(service.getFeed("Feed1")).andReturn(feed1);
  expect(service.getFeed("Feed2")).andReturn(feed2);
  expect(service.getFeed("Feed3")).andReturn(feed3);
  replay(service);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,Collections.<String,String>emptyMap());
  FeedResourceProvider provider=new FeedResourceProvider(service,PropertyHelper.getPropertyIds(Resource.Type.DRFeed),PropertyHelper.getKeyPropertyIds(Resource.Type.DRFeed));
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(3,resources.size());
  verify(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostComponentProcessResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  @SuppressWarnings("unchecked") ResourceProvider provider=init(new HashMap<String,String>(){
{
      put("status","RUNNING");
      put("name","a1");
    }
  }
);
  PredicateBuilder pb=new PredicateBuilder().property(HostComponentProcessResourceProvider.HC_PROCESS_CLUSTER_NAME_ID).equals("c1").and();
  pb=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_HOST_NAME_ID).equals("h1").and();
  Predicate predicate=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_COMPONENT_NAME_ID).equals("comp1").toPredicate();
  Request request=PropertyHelper.getReadRequest(Collections.<String>emptySet());
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(Integer.valueOf(1),Integer.valueOf(resources.size()));
  Resource res=resources.iterator().next();
  Assert.assertNotNull(res.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_NAME_ID));
  Assert.assertNotNull(res.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_STATUS_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostKerberosIdentityResourceProviderTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  KerberosPrincipalDescriptor principalDescriptor1=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor1.getValue()).andReturn("principal1@EXAMPLE.COM");
  expect(principalDescriptor1.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor1.getLocalUsername()).andReturn("principal1");
  KerberosKeytabDescriptor keytabDescriptor1=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor1.getOwnerAccess()).andReturn("rw").times(1);
  expect(keytabDescriptor1.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor1.getFile()).andReturn("/etc/security/keytabs/principal1.headless.keytab").times(1);
  expect(keytabDescriptor1.getOwnerName()).andReturn("principal1").times(1);
  expect(keytabDescriptor1.getGroupName()).andReturn("principal1").times(1);
  KerberosIdentityDescriptor identity1=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity1.getPrincipalDescriptor()).andReturn(principalDescriptor1).times(1);
  expect(identity1.getKeytabDescriptor()).andReturn(keytabDescriptor1).times(1);
  expect(identity1.getName()).andReturn("identity1").times(1);
  KerberosPrincipalDescriptor principalDescriptor2=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor2.getValue()).andReturn("principal2/Host100@EXAMPLE.COM");
  expect(principalDescriptor2.getType()).andReturn(KerberosPrincipalType.SERVICE).times(1);
  expect(principalDescriptor2.getLocalUsername()).andReturn("principal2");
  KerberosIdentityDescriptor identity2=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity2.getPrincipalDescriptor()).andReturn(principalDescriptor2).times(1);
  expect(identity2.getKeytabDescriptor()).andReturn(null).times(1);
  expect(identity2.getName()).andReturn("identity2").times(1);
  KerberosIdentityDescriptor identity3=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity3.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosIdentityDescriptor identity4=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity4.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosPrincipalDescriptor principalDescriptor5=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor5.getValue()).andReturn("principal5@EXAMPLE.COM");
  expect(principalDescriptor5.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor5.getLocalUsername()).andReturn("principal5");
  KerberosKeytabDescriptor keytabDescriptor5=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor5.getOwnerAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getFile()).andReturn("/etc/security/keytabs/principal5.headless.keytab").times(1);
  expect(keytabDescriptor5.getOwnerName()).andReturn("principal5").times(1);
  expect(keytabDescriptor5.getGroupName()).andReturn("hadoop").times(1);
  KerberosIdentityDescriptor identity5=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity5.getPrincipalDescriptor()).andReturn(principalDescriptor5).times(1);
  expect(identity5.getKeytabDescriptor()).andReturn(keytabDescriptor5).times(1);
  expect(identity5.getName()).andReturn("identity5").times(1);
  KerberosPrincipalDAO kerberosPrincipalDAO=createStrictMock(KerberosPrincipalDAO.class);
  expect(kerberosPrincipalDAO.exists("principal1@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal2/Host100@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal5@EXAMPLE.COM")).andReturn(false).times(1);
  KerberosPrincipalHostDAO kerberosPrincipalHostDAO=createStrictMock(KerberosPrincipalHostDAO.class);
  expect(kerberosPrincipalHostDAO.exists("principal1@EXAMPLE.COM",100L)).andReturn(true).times(1);
  expect(kerberosPrincipalHostDAO.exists("principal2/Host100@EXAMPLE.COM",100L)).andReturn(false).times(1);
  HostEntity host100=createStrictMock(HostEntity.class);
  expect(host100.getHostId()).andReturn(100L).times(1);
  HostDAO hostDAO=createStrictMock(HostDAO.class);
  expect(hostDAO.findByName("Host100")).andReturn(host100).times(1);
  Collection<KerberosIdentityDescriptor> identities=new ArrayList<KerberosIdentityDescriptor>();
  identities.add(identity1);
  identities.add(identity2);
  identities.add(identity3);
  identities.add(identity4);
  identities.add(identity5);
  Map<String,Collection<KerberosIdentityDescriptor>> activeIdentities=new HashMap<String,Collection<KerberosIdentityDescriptor>>();
  activeIdentities.put("Host100",identities);
  KerberosHelper kerberosHelper=createStrictMock(KerberosHelper.class);
  expect(kerberosHelper.getActiveIdentities("Cluster100","Host100",null,null,true)).andReturn(activeIdentities).times(1);
  replayAll();
  ResourceProvider provider=new HostKerberosIdentityResourceProvider(managementController);
  Field field;
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosHelper");
  field.setAccessible(true);
  field.set(provider,kerberosHelper);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalHostDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalHostDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("hostDAO");
  field.setAccessible(true);
  field.set(provider,hostDAO);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID).equals("Host100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("Host100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID));
    String principal=(String)resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
    if ("principal1@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal1.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("rw",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("640",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("true",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal2/Host100@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.SERVICE,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("false",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal5@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal5.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("hadoop",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("440",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("unknown",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else {
      Assert.fail("Unexpected principal: " + principal);
    }
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Status_Unhealthy() throws Exception {
  Resource.Type type=Resource.Type.Host;
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostHealthStatus healthStatus=createNiceMock(HostHealthStatus.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  HostResponse hostResponse1=createNiceMock(HostResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider hostResourceProvider=getHostProvider(injector);
  Host host100=createMockHost("Host100","Cluster100",null,"UNHEALTHY","RECOVERABLE",null);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Set<Cluster> clusterSet=new HashSet<Cluster>();
  clusterSet.add(cluster);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse("Cluster100","Service100","Component100","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr2=new ServiceComponentHostResponse("Cluster100","Service100","Component102","Host100","INSTALLED","",null,null,null);
  ServiceComponentHostResponse shr3=new ServiceComponentHostResponse("Cluster100","Service100","Component103","Host100","STARTED","",null,null,null);
  Set<ServiceComponentHostResponse> responses=new HashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  responses.add(shr2);
  responses.add(shr3);
  expect(host100.getMaintenanceState(2)).andReturn(MaintenanceState.OFF).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(responses).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getClustersForHost("Host100")).andReturn(clusterSet).anyTimes();
  expect(clusters.getHosts()).andReturn(Arrays.asList(host100)).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(hostResponse1.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(hostResponse1.getHostname()).andReturn("Host100").anyTimes();
  expect(hostResponse1.getHealthStatus()).andReturn(healthStatus).anyTimes();
  expect(hostResponse1.getStatus()).andReturn(HealthStatus.UNHEALTHY.name()).anyTimes();
  expect(healthStatus.getHealthStatus()).andReturn(HostHealthStatus.HealthStatus.HEALTHY).anyTimes();
  expect(healthStatus.getHealthReport()).andReturn("HEALTHY").anyTimes();
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCategory()).andReturn("MASTER").anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(EasyMock.<Set<String>>anyObject(),EasyMock.<Map<Resource.Type,String>>anyObject(),eq(managementController))).andReturn(hostResourceProvider).anyTimes();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String status=(String)resource.getPropertyValue(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
    Assert.assertEquals("UNHEALTHY",status);
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Status_Alert() throws Exception {
  Resource.Type type=Resource.Type.Host;
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostHealthStatus healthStatus=createNiceMock(HostHealthStatus.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  HostResponse hostResponse1=createNiceMock(HostResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider hostResourceProvider=getHostProvider(injector);
  Host host100=createMockHost("Host100","Cluster100",null,"ALERT","RECOVERABLE",null);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Set<Cluster> clusterSet=new HashSet<Cluster>();
  clusterSet.add(cluster);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse("Cluster100","Service100","Component100","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr2=new ServiceComponentHostResponse("Cluster100","Service100","Component102","Host100","INSTALLED","",null,null,null);
  ServiceComponentHostResponse shr3=new ServiceComponentHostResponse("Cluster100","Service100","Component103","Host100","STARTED","",null,null,null);
  Set<ServiceComponentHostResponse> responses=new HashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  responses.add(shr2);
  responses.add(shr3);
  expect(host100.getMaintenanceState(2)).andReturn(MaintenanceState.OFF).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(responses).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getClustersForHost("Host100")).andReturn(clusterSet).anyTimes();
  expect(clusters.getHosts()).andReturn(Arrays.asList(host100)).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(hostResponse1.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(hostResponse1.getHostname()).andReturn("Host100").anyTimes();
  expect(hostResponse1.getHealthStatus()).andReturn(healthStatus).anyTimes();
  expect(hostResponse1.getStatus()).andReturn(HealthStatus.ALERT.name()).anyTimes();
  expect(healthStatus.getHealthStatus()).andReturn(HostHealthStatus.HealthStatus.HEALTHY).anyTimes();
  expect(healthStatus.getHealthReport()).andReturn("HEALTHY").anyTimes();
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCategory()).andReturn("SLAVE").anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(EasyMock.<Set<String>>anyObject(),EasyMock.<Map<Resource.Type,String>>anyObject(),eq(managementController))).andReturn(hostResourceProvider).anyTimes();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String status=(String)resource.getPropertyValue(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
    Assert.assertEquals("ALERT",status);
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Status_NoCluster() throws Exception {
  Resource.Type type=Resource.Type.Host;
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostHealthStatus healthStatus=createNiceMock(HostHealthStatus.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  Host host100=createMockHost("Host100","Cluster100",null,"HEALTHY","RECOVERABLE",null);
  HostResponse hostResponse1=createNiceMock(HostResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider hostResourceProvider=getHostProvider(injector);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Set<Cluster> clusterSet=new HashSet<Cluster>();
  clusterSet.add(cluster);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse("Cluster100","Service100","Component100","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr2=new ServiceComponentHostResponse("Cluster100","Service100","Component102","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr3=new ServiceComponentHostResponse("Cluster100","Service100","Component103","Host100","STARTED","",null,null,null);
  Set<ServiceComponentHostResponse> responses=new HashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  responses.add(shr2);
  responses.add(shr3);
  expect(host100.getMaintenanceState(2)).andReturn(MaintenanceState.OFF).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(responses).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getClustersForHost("Host100")).andReturn(clusterSet).anyTimes();
  expect(clusters.getHosts()).andReturn(Arrays.asList(host100)).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(hostResponse1.getClusterName()).andReturn("").anyTimes();
  expect(hostResponse1.getHostname()).andReturn("Host100").anyTimes();
  expect(hostResponse1.getHealthStatus()).andReturn(healthStatus).anyTimes();
  expect(hostResponse1.getStatus()).andReturn(HealthStatus.HEALTHY.name()).anyTimes();
  expect(healthStatus.getHealthStatus()).andReturn(HostHealthStatus.HealthStatus.HEALTHY).anyTimes();
  expect(healthStatus.getHealthReport()).andReturn("HEALTHY").anyTimes();
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCategory()).andReturn("MASTER").anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(EasyMock.<Set<String>>anyObject(),EasyMock.<Map<Resource.Type,String>>anyObject(),eq(managementController))).andReturn(hostResourceProvider).anyTimes();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String status=(String)resource.getPropertyValue(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
    Assert.assertEquals("HEALTHY",status);
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Status_Healthy() throws Exception {
  Resource.Type type=Resource.Type.Host;
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostHealthStatus healthStatus=createNiceMock(HostHealthStatus.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  Host host100=createMockHost("Host100","Cluster100",null,"HEALTHY","RECOVERABLE",null);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider hostResourceProvider=getHostProvider(injector);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Set<Cluster> clusterSet=new HashSet<Cluster>();
  clusterSet.add(cluster);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse("Cluster100","Service100","Component100","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr2=new ServiceComponentHostResponse("Cluster100","Service100","Component102","Host100","STARTED","",null,null,null);
  ServiceComponentHostResponse shr3=new ServiceComponentHostResponse("Cluster100","Service100","Component103","Host100","STARTED","",null,null,null);
  Set<ServiceComponentHostResponse> responses=new HashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  responses.add(shr2);
  responses.add(shr3);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(responses).anyTimes();
  expect(host100.getMaintenanceState(2)).andReturn(MaintenanceState.OFF).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getClustersForHost("Host100")).andReturn(clusterSet).anyTimes();
  expect(clusters.getHosts()).andReturn(Arrays.asList(host100)).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(healthStatus.getHealthStatus()).andReturn(HostHealthStatus.HealthStatus.HEALTHY).anyTimes();
  expect(healthStatus.getHealthReport()).andReturn("HEALTHY").anyTimes();
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCategory()).andReturn("MASTER").anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(EasyMock.<Set<String>>anyObject(),EasyMock.<Map<Resource.Type,String>>anyObject(),eq(managementController))).andReturn(hostResourceProvider).anyTimes();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String status=(String)resource.getPropertyValue(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
    Assert.assertEquals("HEALTHY",status);
  }
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that HostNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetHosts___OR_Predicate_HostNotFoundException() throws Exception {
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  Host host1=createNiceMock(Host.class);
  Host host2=createNiceMock(Host.class);
  HostResponse response=createNiceMock(HostResponse.class);
  HostResponse response2=createNiceMock(HostResponse.class);
  HostRequest request1=new HostRequest("host1","cluster1",Collections.<String,String>emptyMap());
  HostRequest request2=new HostRequest("host2","cluster1",Collections.<String,String>emptyMap());
  HostRequest request3=new HostRequest("host3","cluster1",Collections.<String,String>emptyMap());
  HostRequest request4=new HostRequest("host4","cluster1",Collections.<String,String>emptyMap());
  Set<HostRequest> setRequests=new HashSet<HostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(4);
  expect(clusters.getHost("host1")).andReturn(host1);
  expect(host1.getHostName()).andReturn("host1").anyTimes();
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster));
  expect(host1.convertToResponse()).andReturn(response);
  response.setClusterName("cluster1");
  expect(clusters.getHost("host2")).andReturn(host2);
  expect(host2.getHostName()).andReturn("host2").anyTimes();
  expect(clusters.getClustersForHost("host2")).andReturn(Collections.singleton(cluster));
  expect(host2.convertToResponse()).andReturn(response2);
  response2.setClusterName("cluster1");
  expect(clusters.getHost("host3")).andThrow(new HostNotFoundException("host3"));
  expect(clusters.getHost("host4")).andThrow(new HostNotFoundException("host4"));
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<HostResponse> setResponses=getHosts(managementController,setRequests);
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response));
  assertTrue(setResponses.contains(response2));
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Status_Unknown() throws Exception {
  Resource.Type type=Resource.Type.Host;
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  HostHealthStatus healthStatus=createNiceMock(HostHealthStatus.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  HostResponse hostResponse1=createNiceMock(HostResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider hostResourceProvider=getHostProvider(injector);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Host host100=createMockHost("Host100","Cluster100",null,"UNKNOWN","RECOVERABLE",null);
  Set<Cluster> clusterSet=new HashSet<Cluster>();
  clusterSet.add(cluster);
  expect(host100.getMaintenanceState(2)).andReturn(MaintenanceState.OFF).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getClustersForHost("Host100")).andReturn(clusterSet).anyTimes();
  expect(clusters.getHosts()).andReturn(Arrays.asList(host100)).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(hostResponse1.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(hostResponse1.getHostname()).andReturn("Host100").anyTimes();
  expect(hostResponse1.getHealthStatus()).andReturn(healthStatus).anyTimes();
  expect(hostResponse1.getStatus()).andReturn(HealthStatus.UNKNOWN.name()).anyTimes();
  expect(healthStatus.getHealthStatus()).andReturn(HostHealthStatus.HealthStatus.UNKNOWN).anyTimes();
  expect(healthStatus.getHealthReport()).andReturn("UNKNOWN").anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(EasyMock.<Set<String>>anyObject(),EasyMock.<Map<Resource.Type,String>>anyObject(),eq(managementController))).andReturn(hostResourceProvider).anyTimes();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(HostResourceProvider.HOST_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String status=(String)resource.getPropertyValue(HostResourceProvider.HOST_HOST_STATUS_PROPERTY_ID);
    Assert.assertEquals("UNKNOWN",status);
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.InstanceResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  IvoryService service=createMock(IvoryService.class);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  Map<String,Object> properties=new HashMap<String,Object>();
  List<Instance> instances=new LinkedList<Instance>();
  Instance instance1=new Instance("Feed1","Instance1","s","st","et","d","l");
  Instance instance2=new Instance("Feed1","Instance2","s","st","et","d","l");
  Instance instance3=new Instance("Feed1","Instance3","s","st","et","d","l");
  instances.add(instance1);
  instances.add(instance2);
  instances.add(instance3);
  expect(service.getFeedNames()).andReturn(Collections.singletonList("Feed1"));
  expect(service.getInstances("Feed1")).andReturn(instances);
  replay(service);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,Collections.<String,String>emptyMap());
  InstanceResourceProvider provider=new InstanceResourceProvider(service,PropertyHelper.getPropertyIds(Resource.Type.DRInstance),PropertyHelper.getKeyPropertyIds(Resource.Type.DRInstance));
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(3,resources.size());
  verify(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.JobResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJobFetcher4() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(JobResourceProvider.JOB_ID_PROPERTY_ID);
  requestedIds.add(JobResourceProvider.JOB_SUBMIT_TIME_PROPERTY_ID);
  requestedIds.add(JobResourceProvider.JOB_ELAPSED_TIME_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.Job);
  ResourceProvider provider=new TestJobResourceProvider(requestedIds,keyPropertyIds,4);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_ID_PROPERTY_ID).equals("job1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID);
    Assert.assertEquals("job1",workflowId);
    Assert.assertEquals(42l,resource.getPropertyValue(JobResourceProvider.JOB_SUBMIT_TIME_PROPERTY_ID));
    Assert.assertEquals(0l,resource.getPropertyValue(JobResourceProvider.JOB_ELAPSED_TIME_PROPERTY_ID));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJobFetcher1() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(JobResourceProvider.JOB_ID_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.Job);
  ResourceProvider provider=new TestJobResourceProvider(requestedIds,keyPropertyIds,1);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_ID_PROPERTY_ID).equals("job1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID);
    Assert.assertEquals("job1",workflowId);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJobFetcher3() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(JobResourceProvider.JOB_ID_PROPERTY_ID);
  requestedIds.add(JobResourceProvider.JOB_ELAPSED_TIME_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.Job);
  ResourceProvider provider=new TestJobResourceProvider(requestedIds,keyPropertyIds,3);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_ID_PROPERTY_ID).equals("job1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID);
    Assert.assertEquals("job1",workflowId);
    Assert.assertEquals(1l,resource.getPropertyValue(JobResourceProvider.JOB_ELAPSED_TIME_PROPERTY_ID));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJobFetcher2() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(JobResourceProvider.JOB_ID_PROPERTY_ID);
  requestedIds.add(JobResourceProvider.JOB_SUBMIT_TIME_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.Job);
  ResourceProvider provider=new TestJobResourceProvider(requestedIds,keyPropertyIds,2);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_ID_PROPERTY_ID).equals("job1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID);
    Assert.assertEquals("job1",workflowId);
    Assert.assertEquals(42l,resource.getPropertyValue(JobResourceProvider.JOB_SUBMIT_TIME_PROPERTY_ID));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createJobResponse("Cluster100","workflow1","job1"));
  expected.add(createJobResponse("Cluster100","workflow2","job2"));
  expected.add(createJobResponse("Cluster100","workflow2","job3"));
  Resource.Type type=Resource.Type.Job;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  JobFetcher jobFetcher=createMock(JobFetcher.class);
  expect(jobFetcher.fetchJobDetails(propertyIds,null,"workflow2",null)).andReturn(expected).once();
  replay(jobFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new JobResourceProvider(propertyIds,keyPropertyIds,jobFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_WORKFLOW_ID_PROPERTY_ID).equals("workflow2").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(JobResourceProvider.JOB_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID)));
  }
  verify(jobFetcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.PermissionResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  List<PermissionEntity> permissionEntities=new LinkedList<PermissionEntity>();
  PermissionEntity permissionEntity=createNiceMock(PermissionEntity.class);
  ResourceTypeEntity resourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  permissionEntities.add(permissionEntity);
  expect(dao.findAll()).andReturn(permissionEntities);
  expect(permissionEntity.getId()).andReturn(99);
  expect(permissionEntity.getPermissionName()).andReturn("AMBARI.ADMINISTRATOR");
  expect(permissionEntity.getPermissionLabel()).andReturn("Administrator");
  expect(permissionEntity.getResourceType()).andReturn(resourceTypeEntity);
  expect(resourceTypeEntity.getName()).andReturn("AMBARI");
  replay(dao,permissionEntity,resourceTypeEntity);
  PermissionResourceProvider provider=new PermissionResourceProvider();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals(99,resource.getPropertyValue(PermissionResourceProvider.PERMISSION_ID_PROPERTY_ID));
  Assert.assertEquals("AMBARI.ADMINISTRATOR",resource.getPropertyValue(PermissionResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("Administrator",resource.getPropertyValue(PermissionResourceProvider.PERMISSION_LABEL_PROPERTY_ID));
  Assert.assertEquals("AMBARI",resource.getPropertyValue(PermissionResourceProvider.RESOURCE_NAME_PROPERTY_ID));
  verify(dao,permissionEntity,resourceTypeEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ProvisionClusterRequestTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleGroups() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(2,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNotNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test_Creditentials() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  HashMap<String,String> credentialHashMap=new HashMap<>();
  credentialHashMap.put("alias","testAlias");
  credentialHashMap.put("principal","testPrincipal");
  credentialHashMap.put("key","testKey");
  credentialHashMap.put("type","temporary");
  Set<Map<String,String>> credentialsSet=new HashSet<>();
  credentialsSet.add(credentialHashMap);
  properties.put("credentials",credentialsSet);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(provisionClusterRequest.getCredentialsMap().get("testAlias").getAlias(),"testAlias");
  assertEquals(provisionClusterRequest.getCredentialsMap().get("testAlias").getPrincipal(),"testPrincipal");
  assertEquals(provisionClusterRequest.getCredentialsMap().get("testAlias").getKey(),"testKey");
  assertEquals(provisionClusterRequest.getCredentialsMap().get("testAlias").getType().name(),"TEMPORARY");
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostCountSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesCountOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetValidators_defaultPassword() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  properties.put("default_password","pwd");
  TopologyRequest request=new ProvisionClusterRequest(properties,null);
  List<TopologyValidator> validators=request.getTopologyValidators();
  assertEquals(1,validators.size());
  TopologyValidator pwdValidator=validators.get(0);
  TopologyValidator defaultPwdValidator=new RequiredPasswordValidator("pwd");
  assertEquals(pwdValidator,defaultPwdValidator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostNameSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesNameOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetValidators_noDefaultPassword() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  TopologyRequest request=new ProvisionClusterRequest(properties,null);
  List<TopologyValidator> validators=request.getTopologyValidators();
  assertEquals(1,validators.size());
  TopologyValidator pwdValidator=validators.get(0);
  TopologyValidator noDefaultPwdValidator=new RequiredPasswordValidator(null);
  assertEquals(pwdValidator,noDefaultPwdValidator);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RepositoryResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  AmbariManagementController managementController=EasyMock.createMock(AmbariManagementController.class);
  RepositoryResponse rr=new RepositoryResponse(VAL_BASE_URL,VAL_OS,VAL_REPO_ID,VAL_REPO_NAME,null,null,null);
  rr.setStackName(VAL_STACK_NAME);
  rr.setStackVersion(VAL_STACK_VERSION);
  Set<RepositoryResponse> allResponse=new HashSet<RepositoryResponse>();
  allResponse.add(rr);
  expect(managementController.getRepositories(EasyMock.<Set<RepositoryRequest>>anyObject())).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=new RepositoryResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_STACK_NAME_PROPERTY_ID);
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_STACK_VERSION_PROPERTY_ID);
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_REPO_NAME_PROPERTY_ID);
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_BASE_URL_PROPERTY_ID);
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_OS_TYPE_PROPERTY_ID);
  propertyIds.add(RepositoryResourceProvider.REPOSITORY_REPO_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RepositoryResourceProvider.REPOSITORY_STACK_NAME_PROPERTY_ID).equals(VAL_STACK_NAME).and().property(RepositoryResourceProvider.REPOSITORY_STACK_VERSION_PROPERTY_ID).equals(VAL_STACK_VERSION).toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    Object o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_STACK_NAME_PROPERTY_ID);
    Assert.assertEquals(VAL_STACK_NAME,o);
    o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_STACK_VERSION_PROPERTY_ID);
    Assert.assertEquals(VAL_STACK_VERSION,o);
    o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_REPO_NAME_PROPERTY_ID);
    Assert.assertEquals(o,VAL_REPO_NAME);
    o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_BASE_URL_PROPERTY_ID);
    Assert.assertEquals(o,VAL_BASE_URL);
    o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_OS_TYPE_PROPERTY_ID);
    Assert.assertEquals(o,VAL_OS);
    o=resource.getPropertyValue(RepositoryResourceProvider.REPOSITORY_REPO_ID_PROPERTY_ID);
    Assert.assertEquals(o,VAL_REPO_ID);
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestImplTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPropertyIds(){
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Assert.assertEquals(propertyIds,request.getPropertyIds());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestOperationLevelTest </h4><pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExternalLevelName() throws Exception {
  String external=RequestOperationLevel.getExternalLevelName(hostComponent);
  assertEquals(external,host_component);
  try {
    RequestOperationLevel.getExternalLevelName("Wrong_param");
    fail("Should throw exception");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInternalLevelName() throws Exception {
  String internal=RequestOperationLevel.getInternalLevelName(host_component);
  assertEquals(internal,hostComponent);
  internal=RequestOperationLevel.getInternalLevelName(host_component.toLowerCase());
  assertEquals(internal,hostComponent);
  try {
    RequestOperationLevel.getInternalLevelName("Wrong_param");
    fail("Should throw exception");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesCompleted() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().completed(2));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals("COMPLETED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
    Assert.assertEquals(100.0,resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRequestStatusWithNoTasks() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  Clusters clusters=createNiceMock(Clusters.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(anyObject(String.class))).andReturn(null).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(Collections.<Long,HostRoleCommandStatusSummaryDTO>emptyMap()).anyTimes();
  replay(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("COMPLETED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(100.0,resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID));
  }
  verify(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager);
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock)).anyTimes();
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestDAO,hrcDAO,requestMock);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
  }
  verify(managementController,actionManager,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithoutCluster() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  Clusters clusters=createNiceMock(Clusters.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(anyObject(String.class))).andReturn(null).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertNull(resource.getPropertyValue(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID));
  }
  verify(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesWithCluster() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  expect(cluster.getClusterId()).andReturn(50L).anyTimes();
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getClusterId()).andReturn(50L).anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("c1")).andReturn(cluster).anyTimes();
  expect(clusters.getCluster("bad-cluster")).andThrow(new AmbariException("bad cluster!")).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,clusters,cluster,requestMock,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
  }
  predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID).equals("bad-cluster").and().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  try {
    provider.getResources(request,predicate);
  }
 catch (  NoSuchParentResourceException e) {
    e.printStackTrace();
  }
  verify(managementController,actionManager,clusters,cluster,requestMock,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesInProgress() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=new Capture<Collection<Long>>();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts(100L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1).pending(1));
    }
  }
).once();
  expect(hrcDAO.findAggregateCounts(101L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1).queued(1));
    }
  }
).once();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
    if (id == 100L) {
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID));
      int progressPercent=((Double)resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID)).intValue();
      Assert.assertEquals(17,progressPercent);
    }
 else {
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID));
      int progressPercent=((Double)resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID)).intValue();
      Assert.assertEquals(21,progressPercent);
    }
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesFailed() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=new Capture<Collection<Long>>();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts(100L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().failed(1).completed(1));
    }
  }
).once();
  expect(hrcDAO.findAggregateCounts(101L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().aborted(1).timedout(1));
    }
  }
).once();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    if (id == 100L) {
      Assert.assertEquals("FAILED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID));
    }
 else {
      Assert.assertEquals("ABORTED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID));
    }
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
    Assert.assertEquals(100.0,resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesWithRequestSchedule() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  expect(requestMock.getRequestScheduleId()).andReturn(11L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager);
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock)).anyTimes();
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestDAO,hrcDAO,requestMock);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_SOURCE_SCHEDULE);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(11L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_SOURCE_SCHEDULE_ID));
  }
  verify(managementController,actionManager,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesForCommandWithHostPredicate() throws Exception {
  Resource.Type type=Resource.Type.Request;
  Capture<ExecuteActionRequest> actionRequest=new Capture<ExecuteActionRequest>();
  Capture<HashMap<String,String>> propertyMap=new Capture<HashMap<String,String>>();
  Capture<Request> requestCapture=new Capture<>();
  Capture<Predicate> predicateCapture=new Capture<>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  expect(managementController.createAction(capture(actionRequest),capture(propertyMap))).andReturn(response).anyTimes();
  expect(response.getMessage()).andReturn("Message").anyTimes();
  expect(managementController.getClusters()).andReturn(clusters);
  ClusterControllerImpl controller=createNiceMock(ClusterControllerImpl.class);
  HostComponentProcessResourceProvider hostComponentProcessResourceProvider=createNiceMock(HostComponentProcessResourceProvider.class);
  PowerMock.mockStatic(ClusterControllerHelper.class);
  Resource resource=createNiceMock(Resource.class);
  expect(ClusterControllerHelper.getClusterController()).andReturn(controller);
  expect(controller.ensureResourceProvider(Resource.Type.HostComponent)).andReturn(hostComponentProcessResourceProvider);
  expect(hostComponentProcessResourceProvider.getResources(capture(requestCapture),capture(predicateCapture))).andReturn(Collections.singleton(resource));
  replay(managementController,response,controller,hostComponentProcessResourceProvider,resource,clusters);
  PowerMock.replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID,"c1");
  Set<Map<String,Object>> filterSet=new HashSet<Map<String,Object>>();
  String predicateProperty=HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID + "=true";
  Map<String,Object> filterMap=new HashMap<String,Object>();
  filterMap.put(RequestResourceProvider.HOSTS_PREDICATE,predicateProperty);
  filterSet.add(filterMap);
  properties.put(RequestResourceProvider.REQUEST_RESOURCE_FILTER_ID,filterSet);
  propertySet.add(properties);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.COMMAND_ID,"RESTART");
  requestInfoProperties.put(RequestResourceProvider.REQUEST_CONTEXT_ID,"Restart All with Stale Configs");
  Request request=PropertyHelper.getCreateRequest(propertySet,requestInfoProperties);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  provider.createResources(request);
  ExecuteActionRequest capturedRequest=actionRequest.getValue();
  Assert.assertTrue(requestCapture.hasCaptured());
  Assert.assertTrue(predicateCapture.hasCaptured());
  Map<String,Object> predicateProperties=PredicateHelper.getProperties(predicateCapture.getValue());
  String propertyIdToAssert=null;
  Object propertyValueToAssert=null;
  for (  Map.Entry<String,Object> predicateEntry : predicateProperties.entrySet()) {
    if (predicateEntry.getKey().equals(HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID)) {
      propertyIdToAssert=predicateEntry.getKey();
      propertyValueToAssert=predicateEntry.getValue();
    }
  }
  Assert.assertNotNull(propertyIdToAssert);
  Assert.assertEquals("true",(String)propertyValueToAssert);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesWithoutRequestSchedule() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  expect(requestMock.getRequestScheduleId()).andReturn(null).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager);
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock)).anyTimes();
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestMock,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_SOURCE_SCHEDULE);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(null,resource.getPropertyValue(RequestResourceProvider.REQUEST_SOURCE_SCHEDULE));
  }
  verify(managementController,actionManager,requestMock,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesOrPredicate() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock,requestMock1)).anyTimes();
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestMock,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
  }
  verify(managementController,actionManager,requestMock,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestScheduleResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRequestSchedule() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final RequestExecution requestExecution=createNiceMock(RequestExecution.class);
  RequestScheduleResponse requestScheduleResponse=createNiceMock(RequestScheduleResponse.class);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(requestExecution.getId()).andReturn(25L).anyTimes();
  expect(requestExecution.getStatus()).andReturn(RequestExecution.Status.SCHEDULED.name()).anyTimes();
  expect(requestExecution.convertToResponse()).andReturn(requestScheduleResponse).anyTimes();
  expect(requestExecution.convertToResponseWithBody()).andReturn(requestScheduleResponse).anyTimes();
  expect(requestScheduleResponse.getId()).andReturn(25L).anyTimes();
  expect(requestScheduleResponse.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(cluster.getAllRequestExecutions()).andStubAnswer(new IAnswer<Map<Long,RequestExecution>>(){
    @Override public Map<Long,RequestExecution> answer() throws Throwable {
      Map<Long,RequestExecution> requestExecutionMap=new HashMap<Long,RequestExecution>();
      requestExecutionMap.put(requestExecution.getId(),requestExecution);
      return requestExecutionMap;
    }
  }
);
  replay(managementController,clusters,cluster,requestExecution,response,requestScheduleResponse);
  RequestScheduleResourceProvider resourceProvider=getResourceProvider(managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_DESC_PROPERTY_ID,"some description");
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(RequestScheduleResourceProvider.REQUEST_SCHEDULE_ID_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(RequestScheduleResourceProvider.REQUEST_SCHEDULE_ID_PROPERTY_ID).equals(25L).toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals(25L,resources.iterator().next().getPropertyValue(RequestScheduleResourceProvider.REQUEST_SCHEDULE_ID_PROPERTY_ID));
  predicate=new PredicateBuilder().property(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals(25L,resources.iterator().next().getPropertyValue(RequestScheduleResourceProvider.REQUEST_SCHEDULE_ID_PROPERTY_ID));
  verify(managementController,clusters,cluster,requestExecution,response,requestScheduleResponse);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestStageContainerTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRequestStatusResponse(){
  ActionManager actionManager=createStrictMock(ActionManager.class);
  Stage stage1=createNiceMock(Stage.class);
  Stage stage2=createNiceMock(Stage.class);
  HostRoleCommand command1=createNiceMock(HostRoleCommand.class);
  Role role=createNiceMock(Role.class);
  List<Stage> stages=new ArrayList<Stage>();
  RoleCommand roleCommand=RoleCommand.INSTALL;
  HostRoleStatus status=HostRoleStatus.IN_PROGRESS;
  stages.add(stage1);
  stages.add(stage2);
  List<HostRoleCommand> hostRoleCommands=new ArrayList<HostRoleCommand>();
  hostRoleCommands.add(command1);
  expect(actionManager.getRequestTasks(100)).andReturn(hostRoleCommands);
  expect(actionManager.getRequestContext(100)).andReturn("test");
  expect(command1.getTaskId()).andReturn(1L);
  expect(command1.getRoleCommand()).andReturn(roleCommand);
  expect(command1.getRole()).andReturn(role);
  expect(command1.getStatus()).andReturn(status);
  replay(actionManager,stage1,stage2,command1,role);
  RequestStageContainer requestStages=new RequestStageContainer(100L,stages,null,actionManager);
  RequestStatusResponse response=requestStages.getRequestStatusResponse();
  assertEquals(100,response.getRequestId());
  List<ShortTaskStatus> tasks=response.getTasks();
  assertEquals(1,tasks.size());
  ShortTaskStatus task=tasks.get(0);
  assertEquals(1,task.getTaskId());
  assertEquals(roleCommand.toString(),task.getCommand());
  assertEquals(status.toString(),task.getStatus());
  assertEquals("test",response.getRequestContext());
  verify(actionManager,stage1,stage2,command1,role);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestStatusImplTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAssociatedResources() throws Exception {
  RequestStatusImpl status=new RequestStatusImpl(null);
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  Resource associatedResource=new ResourceImpl(Resource.Type.Service);
  Set<Resource> associatedResources=Collections.singleton(associatedResource);
  status=new RequestStatusImpl(null,associatedResources);
  Assert.assertEquals(associatedResources,status.getAssociatedResources());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ResourceImplTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertiesMap(){
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  String p1=PropertyHelper.getPropertyId(null,"p1");
  String p2=PropertyHelper.getPropertyId("c1","p2");
  String p3=PropertyHelper.getPropertyId("c1/c2","p3");
  String p4=PropertyHelper.getPropertyId("c1/c2/c3","p4");
  String p5=PropertyHelper.getPropertyId("c1","p5");
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,1);
  resource.setProperty(p3,(float)1.99);
  resource.setProperty(p4,1.99);
  resource.setProperty(p5,65L);
  Map<String,Map<String,Object>> map=resource.getPropertiesMap();
  Assert.assertEquals(4,map.keySet().size());
  Assert.assertTrue(map.containsKey(""));
  Assert.assertTrue(map.containsKey("c1"));
  Assert.assertTrue(map.containsKey("c1/c2"));
  Assert.assertTrue(map.containsKey("c1/c2/c3"));
  String lastCategory=null;
  for (  Map.Entry<String,Map<String,Object>> entry : map.entrySet()) {
    String category=entry.getKey();
    if (lastCategory != null) {
      Assert.assertTrue(category.compareTo(lastCategory) > 0);
    }
    lastCategory=category;
    String lastProperty=null;
    for (    String property : entry.getValue().keySet()) {
      if (lastProperty != null) {
        Assert.assertTrue(property.compareTo(lastProperty) > 0);
      }
      lastProperty=property;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RoleAuthorizationResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResource() throws Exception {
  RoleAuthorizationEntity roleAuthorizationEntity1=createNiceMock(RoleAuthorizationEntity.class);
  expect(roleAuthorizationEntity1.getAuthorizationId()).andReturn("TEST.DO_SOMETHING").anyTimes();
  expect(roleAuthorizationEntity1.getAuthorizationName()).andReturn("Do Something").anyTimes();
  RoleAuthorizationEntity roleAuthorizationEntity2=createNiceMock(RoleAuthorizationEntity.class);
  expect(roleAuthorizationEntity2.getAuthorizationId()).andReturn("TEST.DO_SOMETHING_ELSE").anyTimes();
  expect(roleAuthorizationEntity2.getAuthorizationName()).andReturn("Do Something Else").anyTimes();
  List<RoleAuthorizationEntity> authorizationEntities=new ArrayList<RoleAuthorizationEntity>();
  authorizationEntities.add(roleAuthorizationEntity1);
  authorizationEntities.add(roleAuthorizationEntity2);
  PermissionEntity permissionEntry=createStrictMock(PermissionEntity.class);
  expect(permissionEntry.getAuthorizations()).andReturn(authorizationEntities).once();
  PermissionDAO permissionDAO=injector.getInstance(PermissionDAO.class);
  expect(permissionDAO.findById(1)).andReturn(permissionEntry).once();
  replayAll();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  RoleAuthorizationResourceProvider provider=new RoleAuthorizationResourceProvider(managementController);
  Predicate predicate=new PredicateBuilder().begin().property(RoleAuthorizationResourceProvider.AUTHORIZATION_ID_PROPERTY_ID).equals("TEST.DO_SOMETHING").and().property(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID).equals("1").end().toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("TEST.DO_SOMETHING",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_ID_PROPERTY_ID));
  Assert.assertEquals("Do Something",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_NAME_PROPERTY_ID));
  Assert.assertEquals(1,resource.getPropertyValue(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID));
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesForPermission() throws Exception {
  RoleAuthorizationEntity roleAuthorizationEntity=createNiceMock(RoleAuthorizationEntity.class);
  expect(roleAuthorizationEntity.getAuthorizationId()).andReturn("TEST.DO_SOMETHING").once();
  expect(roleAuthorizationEntity.getAuthorizationName()).andReturn("Do Something").once();
  List<RoleAuthorizationEntity> authorizationEntities=new ArrayList<RoleAuthorizationEntity>();
  authorizationEntities.add(roleAuthorizationEntity);
  PermissionEntity permissionEntry=createStrictMock(PermissionEntity.class);
  expect(permissionEntry.getAuthorizations()).andReturn(authorizationEntities).once();
  PermissionDAO permissionDAO=injector.getInstance(PermissionDAO.class);
  expect(permissionDAO.findById(1)).andReturn(permissionEntry).once();
  replayAll();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  RoleAuthorizationResourceProvider provider=new RoleAuthorizationResourceProvider(managementController);
  Predicate predicate=new PredicateBuilder().property(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID).equals("1").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("TEST.DO_SOMETHING",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_ID_PROPERTY_ID));
  Assert.assertEquals("Do Something",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_NAME_PROPERTY_ID));
  Assert.assertEquals(1,resource.getPropertyValue(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID));
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  RoleAuthorizationEntity roleAuthorizationEntity=createNiceMock(RoleAuthorizationEntity.class);
  expect(roleAuthorizationEntity.getAuthorizationId()).andReturn("TEST.DO_SOMETHING");
  expect(roleAuthorizationEntity.getAuthorizationName()).andReturn("Do Something");
  List<RoleAuthorizationEntity> authorizationEntities=new ArrayList<RoleAuthorizationEntity>();
  authorizationEntities.add(roleAuthorizationEntity);
  RoleAuthorizationDAO roleAuthorizationDAO=injector.getInstance(RoleAuthorizationDAO.class);
  expect(roleAuthorizationDAO.findAll()).andReturn(authorizationEntities);
  replayAll();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  RoleAuthorizationResourceProvider provider=new RoleAuthorizationResourceProvider(managementController);
  injector.injectMembers(provider);
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("TEST.DO_SOMETHING",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_ID_PROPERTY_ID));
  Assert.assertEquals("Do Something",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_NAME_PROPERTY_ID));
  Assert.assertNull(resource.getPropertyValue(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID));
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RootServiceComponentResourceProviderTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.RootServiceComponent;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<RootServiceComponentResponse> allResponse=new HashSet<RootServiceComponentResponse>();
  allResponse.add(new RootServiceComponentResponse("component1","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component2","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component3","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse(RootServiceResponseFactory.Components.AMBARI_SERVER.name(),"1.1.1",Collections.<String,String>emptyMap()));
  Set<RootServiceComponentResponse> nameResponse=new HashSet<RootServiceComponentResponse>();
  nameResponse.add(new RootServiceComponentResponse("component4","1.1.1",Collections.<String,String>emptyMap()));
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(allResponse).once();
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(nameResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RootServiceComponentResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String componentName=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
    String componentVersion=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
    Long server_clock=(Long)resource.getPropertyValue(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
    if (componentName.equals(RootServiceResponseFactory.Components.AMBARI_SERVER.name())) {
      Assert.assertNotNull(server_clock);
    }
 else {
      Assert.assertNull(server_clock);
    }
    Assert.assertTrue(allResponse.contains(new RootServiceComponentResponse(componentName,componentVersion,Collections.<String,String>emptyMap())));
  }
  Predicate predicate=new PredicateBuilder().property(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID).equals("component4").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("component4",resources.iterator().next().getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RootServiceResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.RootService;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<RootServiceResponse> allResponse=new HashSet<RootServiceResponse>();
  allResponse.add(new RootServiceResponse("service1"));
  allResponse.add(new RootServiceResponse("service2"));
  allResponse.add(new RootServiceResponse("service3"));
  Set<RootServiceResponse> nameResponse=new HashSet<RootServiceResponse>();
  nameResponse.add(new RootServiceResponse("service4"));
  expect(managementController.getRootServices(EasyMock.<Set<RootServiceRequest>>anyObject())).andReturn(allResponse).once();
  expect(managementController.getRootServices(EasyMock.<Set<RootServiceRequest>>anyObject())).andReturn(nameResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String serviceName=(String)resource.getPropertyValue(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID);
    Assert.assertTrue(allResponse.contains(new RootServiceResponse(serviceName)));
  }
  Predicate predicate=new PredicateBuilder().property(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID).equals("service4").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("service4",resources.iterator().next().getPropertyValue(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ScaleClusterRequestTest </h4><pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostCount() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostCount(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP2_NAME);
  assertEquals(GROUP2_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(1,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostCount2() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostCount2(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"2"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(2,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostCountAndPredicate() throws Exception {
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostCountAndPredicate(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group3Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group3Info.getHostGroupName());
  assertEquals(0,group3Info.getHostNames().size());
  assertEquals(1,group3Info.getRequestedHostCount());
  assertEquals(PREDICATE,group3Info.getPredicateString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostNames() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName2(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"2"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(2,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertTrue(group1Info.getHostNames().contains(HOST2_NAME));
  assertEquals(2,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostName() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostGroups() throws Exception {
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostCountAndPredicate(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostCount(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"3"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(3,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP2_NAME);
  assertEquals(GROUP2_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(1,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  HostGroupInfo group3Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group3Info.getHostGroupName());
  assertEquals(0,group3Info.getHostNames().size());
  assertEquals(1,group3Info.getRequestedHostCount());
  assertEquals(PREDICATE,group3Info.getPredicateString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ServiceResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesBadServiceState() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  String serviceName="Service100";
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(cluster.getService(serviceName)).andReturn(service).anyTimes();
  expect(service.getDesiredState()).andReturn(State.STARTED).anyTimes();
  expect(service.getName()).andReturn(serviceName).anyTimes();
  expect(service.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>());
  expect(service.getCluster()).andReturn(cluster);
  cluster.deleteService(serviceName);
  replay(managementController,clusters,cluster,service);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals(serviceName).toPredicate();
  provider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Service,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,service);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_KerberosSpecificProperties_KDCInvalidCredentials() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service0=createNiceMock(Service.class);
  ServiceResponse serviceResponse0=createNiceMock(ServiceResponse.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceFactory serviceFactory=createNiceMock(ServiceFactory.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  KerberosHelper kerberosHeper=createStrictMock(KerberosHelper.class);
  Map<String,Service> allResponseMap=new HashMap<String,Service>();
  allResponseMap.put("KERBEROS",service0);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getServiceFactory()).andReturn(serviceFactory).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(Collections.<ServiceComponentHostResponse>emptySet()).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getServices()).andReturn(allResponseMap).anyTimes();
  expect(cluster.getService("KERBEROS")).andReturn(service0);
  expect(service0.convertToResponse()).andReturn(serviceResponse0).anyTimes();
  expect(service0.getName()).andReturn("Service100").anyTimes();
  expect(serviceResponse0.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(serviceResponse0.getServiceName()).andReturn("KERBEROS").anyTimes();
  kerberosHeper.validateKDCCredentials(cluster);
  expectLastCall().andThrow(new KerberosAdminAuthenticationException("Invalid KDC administrator credentials."));
  replay(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  Class<?> c=provider.getClass();
  Field f=c.getDeclaredField("kerberosHelper");
  f.setAccessible(true);
  f.set(provider,kerberosHeper);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("KERBEROS").toPredicate();
  Request request=PropertyHelper.getReadRequest("ServiceInfo","Services");
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("KERBEROS",resource.getPropertyValue(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID));
    Assert.assertEquals("INVALID_CREDENTIALS",resource.getPropertyValue("Services/attributes/kdc_validation_result"));
    Assert.assertEquals("Invalid KDC administrator credentials.",resource.getPropertyValue("Services/attributes/kdc_validation_failure_details"));
  }
  verify(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_KerberosSpecificProperties() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service0=createNiceMock(Service.class);
  ServiceResponse serviceResponse0=createNiceMock(ServiceResponse.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceFactory serviceFactory=createNiceMock(ServiceFactory.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  KerberosHelper kerberosHeper=createStrictMock(KerberosHelper.class);
  Map<String,Service> allResponseMap=new HashMap<String,Service>();
  allResponseMap.put("KERBEROS",service0);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getServiceFactory()).andReturn(serviceFactory).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(Collections.<ServiceComponentHostResponse>emptySet()).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getServices()).andReturn(allResponseMap).anyTimes();
  expect(cluster.getService("KERBEROS")).andReturn(service0);
  expect(service0.convertToResponse()).andReturn(serviceResponse0).anyTimes();
  expect(service0.getName()).andReturn("Service100").anyTimes();
  expect(serviceResponse0.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(serviceResponse0.getServiceName()).andReturn("KERBEROS").anyTimes();
  kerberosHeper.validateKDCCredentials(cluster);
  replay(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  Class<?> c=provider.getClass();
  Field f=c.getDeclaredField("kerberosHelper");
  f.setAccessible(true);
  f.set(provider,kerberosHeper);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("KERBEROS").toPredicate();
  Request request=PropertyHelper.getReadRequest("ServiceInfo","Services");
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("KERBEROS",resource.getPropertyValue(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID));
    Assert.assertEquals("OK",resource.getPropertyValue("Services/attributes/kdc_validation_result"));
    Assert.assertEquals("",resource.getPropertyValue("Services/attributes/kdc_validation_failure_details"));
  }
  verify(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_KerberosSpecificProperties_NoKDCValidation() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service0=createNiceMock(Service.class);
  ServiceResponse serviceResponse0=createNiceMock(ServiceResponse.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceFactory serviceFactory=createNiceMock(ServiceFactory.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  KerberosHelper kerberosHelper=createStrictMock(KerberosHelper.class);
  Map<String,Service> allResponseMap=new HashMap<String,Service>();
  allResponseMap.put("KERBEROS",service0);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getServiceFactory()).andReturn(serviceFactory).anyTimes();
  expect(managementController.getHostComponents(EasyMock.<Set<ServiceComponentHostRequest>>anyObject())).andReturn(Collections.<ServiceComponentHostResponse>emptySet()).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getServices()).andReturn(allResponseMap).anyTimes();
  expect(cluster.getService("KERBEROS")).andReturn(service0);
  expect(service0.convertToResponse()).andReturn(serviceResponse0).anyTimes();
  expect(service0.getName()).andReturn("Service100").anyTimes();
  expect(serviceResponse0.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(serviceResponse0.getServiceName()).andReturn("KERBEROS").anyTimes();
  replay(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHelper);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  Class<?> c=provider.getClass();
  Field f=c.getDeclaredField("kerberosHelper");
  f.setAccessible(true);
  f.set(provider,kerberosHelper);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("KERBEROS").toPredicate();
  Request request=PropertyHelper.getReadRequest("ServiceInfo");
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("KERBEROS",resource.getPropertyValue(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID));
  }
  verify(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHelper);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_KerberosSpecificProperties_KDCMissingCredentials() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service0=createNiceMock(Service.class);
  ServiceResponse serviceResponse0=createNiceMock(ServiceResponse.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceFactory serviceFactory=createNiceMock(ServiceFactory.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  KerberosHelper kerberosHeper=createStrictMock(KerberosHelper.class);
  Map<String,Service> allResponseMap=new HashMap<String,Service>();
  allResponseMap.put("KERBEROS",service0);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getServiceFactory()).andReturn(serviceFactory).anyTimes();
  expect(managementController.getHostComponents((Set<ServiceComponentHostRequest>)anyObject())).andReturn(Collections.<ServiceComponentHostResponse>emptySet()).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getServices()).andReturn(allResponseMap).anyTimes();
  expect(cluster.getService("KERBEROS")).andReturn(service0);
  expect(service0.convertToResponse()).andReturn(serviceResponse0).anyTimes();
  expect(service0.getName()).andReturn("Service100").anyTimes();
  expect(serviceResponse0.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(serviceResponse0.getServiceName()).andReturn("KERBEROS").anyTimes();
  kerberosHeper.validateKDCCredentials(cluster);
  expectLastCall().andThrow(new KerberosMissingAdminCredentialsException("Missing KDC administrator credentials."));
  replay(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  Class<?> c=provider.getClass();
  Field f=c.getDeclaredField("kerberosHelper");
  f.setAccessible(true);
  f.set(provider,kerberosHeper);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("KERBEROS").toPredicate();
  Request request=PropertyHelper.getReadRequest("ServiceInfo","Services");
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("KERBEROS",resource.getPropertyValue(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID));
    Assert.assertEquals("MISSING_CREDENTIALS",resource.getPropertyValue("Services/attributes/kdc_validation_result"));
    Assert.assertEquals("Missing KDC administrator credentials.",resource.getPropertyValue("Services/attributes/kdc_validation_failure_details"));
  }
  verify(managementController,clusters,cluster,service0,serviceResponse0,ambariMetaInfo,stackId,serviceFactory,kerberosHeper);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesStoppedComponentState() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
class TestComponent {
    public String Name;
    public ServiceComponent Component;
    public State DesiredState;
    public TestComponent(    String name,    ServiceComponent component,    State desiredState){
      Name=name;
      Component=component;
      DesiredState=desiredState;
    }
  }
  TestComponent component1=new TestComponent("Component100",createNiceMock(ServiceComponent.class),State.INSTALLED);
  TestComponent component2=new TestComponent("Component101",createNiceMock(ServiceComponent.class),State.INSTALLED);
  TestComponent component3=new TestComponent("Component102",createNiceMock(ServiceComponent.class),State.INSTALLED);
  Map<String,ServiceComponent> scMap=new HashMap<String,ServiceComponent>();
  scMap.put(component1.Name,component1.Component);
  scMap.put(component2.Name,component2.Component);
  scMap.put(component3.Name,component3.Component);
  String clusterName="Cluster100";
  String serviceName="Service100";
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(cluster.getService(serviceName)).andReturn(service).anyTimes();
  expect(service.getDesiredState()).andReturn(State.STARTED).anyTimes();
  expect(service.getName()).andReturn(serviceName).anyTimes();
  expect(service.getServiceComponents()).andReturn(scMap).anyTimes();
  expect(component1.Component.getDesiredState()).andReturn(component1.DesiredState).anyTimes();
  expect(component2.Component.getDesiredState()).andReturn(component2.DesiredState).anyTimes();
  expect(component3.Component.getDesiredState()).andReturn(component3.DesiredState).anyTimes();
  expect(component1.Component.canBeRemoved()).andReturn(component1.DesiredState.isRemovableState()).anyTimes();
  expect(component2.Component.canBeRemoved()).andReturn(component2.DesiredState.isRemovableState()).anyTimes();
  expect(component3.Component.canBeRemoved()).andReturn(component3.DesiredState.isRemovableState()).anyTimes();
  expect(service.getCluster()).andReturn(cluster);
  cluster.deleteService(serviceName);
  replay(managementController,clusters,cluster,service,component1.Component,component2.Component,component3.Component);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals(clusterName).and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals(serviceName).toPredicate();
  provider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Service,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,service,component1.Component,component2.Component,component3.Component);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.SettingResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateResource_admin() throws Exception {
  setupAuthenticationForAdmin();
  SettingEntity entity=newEntity("motd");
  Capture<SettingEntity> entityCapture=Capture.newInstance();
  Request request=createRequest(entity);
  expect(dao.findByName(entity.getName())).andReturn(null);
  dao.create(capture(entityCapture));
  mockControl.replay();
  RequestStatus response=resourceProvider.createResources(request);
  assertEquals(RequestStatus.Status.Complete,response.getStatus());
  Set<Resource> associatedResources=response.getAssociatedResources();
  assertEquals(1,associatedResources.size());
  SettingEntity capturedEntity=entityCapture.getValue();
  assertEquals(entity.getName(),capturedEntity.getName());
  assertEquals(entity.getContent(),capturedEntity.getContent());
  assertEquals(entity.getSettingType(),capturedEntity.getSettingType());
  assertEquals(AuthorizationHelper.getAuthenticatedName(),capturedEntity.getUpdatedBy());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateResources_admin() throws Exception {
  setupAuthenticationForAdmin();
  String name="motd";
  SettingEntity oldEntity=newEntity(name);
  SettingEntity updatedEntity=oldEntity.clone();
  updatedEntity.setContent("{text}");
  updatedEntity.setSettingType("new-type");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property(SETTING_NAME_PROPERTY_ID).equals(name).end().toPredicate();
  Capture<SettingEntity> capture=Capture.newInstance();
  expect(dao.findByName(name)).andReturn(oldEntity);
  expect(dao.merge(capture(capture))).andReturn(updatedEntity);
  mockControl.replay();
  RequestStatus response=resourceProvider.updateResources(updateRequest(updatedEntity),predicate);
  SettingEntity capturedEntity=capture.getValue();
  assertEquals(RequestStatus.Status.Complete,response.getStatus());
  assertEquals(updatedEntity.getId(),capturedEntity.getId());
  assertEquals(updatedEntity.getName(),capturedEntity.getName());
  assertEquals(updatedEntity.getSettingType(),capturedEntity.getSettingType());
  assertEquals(updatedEntity.getContent(),capturedEntity.getContent());
  assertEquals(AuthorizationHelper.getAuthenticatedName(),capturedEntity.getUpdatedBy());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_instance_clusterUser() throws Exception {
  setupAuthenticationForClusterUser();
  String name="motd";
  SettingEntity entity=newEntity(name);
  Set<Resource> response=getResources_instance(entity,readRequest());
  assertEquals(1,response.size());
  Resource resource=response.iterator().next();
  assertEqualsEntityAndResource(entity,resource);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_instance_admin() throws Exception {
  setupAuthenticationForAdmin();
  SettingEntity entity=newEntity("motd");
  Set<Resource> response=getResources_instance(entity,readRequest());
  assertEquals(1,response.size());
  Resource resource=response.iterator().next();
  assertEqualsEntityAndResource(entity,resource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackAdvisorResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCalculateConfigurations() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.emptySet();
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  RecommendationResourceProvider provider=new RecommendationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController);
  Request request=mock(Request.class);
  Set<Map<String,Object>> propertiesSet=new HashSet<Map<String,Object>>();
  Map<String,Object> propertiesMap=new HashMap<String,Object>();
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/string_prop","string");
  List array=new ArrayList();
  array.add("array1");
  array.add("array2");
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/array_prop",array);
  propertiesSet.add(propertiesMap);
  doReturn(propertiesSet).when(request).getProperties();
  Map<String,Map<String,Map<String,String>>> calculatedConfigurations=provider.calculateConfigurations(request);
  assertNotNull(calculatedConfigurations);
  assertEquals(1,calculatedConfigurations.size());
  Map<String,Map<String,String>> site=calculatedConfigurations.get("site");
  assertNotNull(site);
  assertEquals(1,site.size());
  Map<String,String> properties=site.get("properties");
  assertNotNull(properties);
  assertEquals(2,properties.size());
  assertEquals("string",properties.get("string_prop"));
  assertEquals("[array1, array2]",properties.get("array_prop"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCalculateConfigurationsWithNullPropertyValues() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.emptySet();
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  RecommendationResourceProvider provider=new RecommendationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController);
  Request request=mock(Request.class);
  Set<Map<String,Object>> propertiesSet=new HashSet<Map<String,Object>>();
  Map<String,Object> propertiesMap=new HashMap<String,Object>();
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/string_prop",null);
  List array=new ArrayList();
  array.add("array1");
  array.add("array2");
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/array_prop",array);
  propertiesSet.add(propertiesMap);
  doReturn(propertiesSet).when(request).getProperties();
  Map<String,Map<String,Map<String,String>>> calculatedConfigurations=provider.calculateConfigurations(request);
  assertNotNull(calculatedConfigurations);
  assertEquals(1,calculatedConfigurations.size());
  Map<String,Map<String,String>> site=calculatedConfigurations.get("site");
  assertNotNull(site);
  assertEquals(1,site.size());
  Map<String,String> properties=site.get("properties");
  assertNotNull(properties);
  assertEquals("[array1, array2]",properties.get("array_prop"));
  assertFalse(properties.containsKey("string_prop"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackArtifactResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testGetWidgetDescriptorForService() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  replay(managementController);
  StackArtifactResourceProvider resourceProvider=getStackArtifactResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ARTIFACT_NAME_PROPERTY_ID);
  propertyIds.add(STACK_NAME_PROPERTY_ID);
  propertyIds.add(STACK_VERSION_PROPERTY_ID);
  propertyIds.add(STACK_SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(ARTIFACT_DATA_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(ARTIFACT_NAME_PROPERTY_ID).equals("widgets_descriptor").and().property(STACK_NAME_PROPERTY_ID).equals("OTHER").and().property(STACK_VERSION_PROPERTY_ID).equals("2.0").and().property(STACK_SERVICE_NAME_PROPERTY_ID).equals("HBASE").toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Map<String,Map<String,Object>> propertyMap=resource.getPropertiesMap();
  Map<String,Object> descriptor=propertyMap.get(ARTIFACT_DATA_PROPERTY_ID);
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(1,((List)descriptor.get("layouts")).size());
  WidgetLayout layout=((List<WidgetLayout>)descriptor.get("layouts")).iterator().next();
  Assert.assertEquals("default_hbase_layout",layout.getLayoutName());
  Assert.assertEquals("HBASE_SUMMARY",layout.getSectionName());
  Assert.assertEquals(5,layout.getWidgetLayoutInfoList().size());
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricsDescriptorForService() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  replay(managementController);
  StackArtifactResourceProvider resourceProvider=getStackArtifactResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ARTIFACT_NAME_PROPERTY_ID);
  propertyIds.add(STACK_NAME_PROPERTY_ID);
  propertyIds.add(STACK_VERSION_PROPERTY_ID);
  propertyIds.add(STACK_SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(ARTIFACT_DATA_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(ARTIFACT_NAME_PROPERTY_ID).equals("metrics_descriptor").and().property(STACK_NAME_PROPERTY_ID).equals("OTHER").and().property(STACK_VERSION_PROPERTY_ID).equals("1.0").and().property(STACK_SERVICE_NAME_PROPERTY_ID).equals("HDFS").toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Map<String,Map<String,Object>> propertyMap=resource.getPropertiesMap();
  Map<String,Object> descriptor=propertyMap.get(ARTIFACT_DATA_PROPERTY_ID + "/HDFS/DATANODE");
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(1,((ArrayList)descriptor.get("Component")).size());
  MetricDefinition md=(MetricDefinition)((ArrayList)descriptor.get("Component")).iterator().next();
  Metric m1=md.getMetrics().get("metrics/dfs/datanode/heartBeats_avg_time");
  Metric m2=md.getMetrics().get("metrics/rpc/closeRegion_num_ops");
  Assert.assertEquals(326,md.getMetrics().size());
  Assert.assertTrue(m1.isAmsHostMetric());
  Assert.assertEquals("unitless",m1.getUnit());
  Assert.assertFalse(m2.isAmsHostMetric());
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackConfigurationDependencyResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.StackConfigurationDependency;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationDependencyResponse> allResponse=new HashSet<StackConfigurationDependencyResponse>();
  allResponse.add(new StackConfigurationDependencyResponse("depName","depType"));
  expect(managementController.getStackConfigurationDependencies(AbstractResourceProviderTest.Matcher.getStackConfigurationDependencyRequestSet(null,null,null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackConfigurationDependencyResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationDependencyResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackConfigurationDependencyResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationDependencyResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationDependencyResourceProvider.DEPENDENCY_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationDependencyResourceProvider.DEPENDENCY_TYPE_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String dependencyName=(String)resource.getPropertyValue(StackConfigurationDependencyResourceProvider.DEPENDENCY_NAME_PROPERTY_ID);
    String dependencyType=(String)resource.getPropertyValue(StackConfigurationDependencyResourceProvider.DEPENDENCY_TYPE_PROPERTY_ID);
    Assert.assertEquals("depName",dependencyName);
    Assert.assertEquals("depType",dependencyType);
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_noFinal() throws Exception {
  Map<String,String> attributes=new HashMap<String,String>();
  Resource.Type type=Resource.Type.StackConfiguration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationResponse> allResponse=new HashSet<StackConfigurationResponse>();
  allResponse.add(new StackConfigurationResponse(PROPERTY_NAME,PROPERTY_VALUE,PROPERTY_DESC,TYPE,attributes));
  expect(managementController.getStackConfigurations(AbstractResourceProviderTest.Matcher.getStackConfigurationRequestSet(null,null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackConfigurationResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String propertyName=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
    String propertyValue=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
    String propertyDesc=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
    String propertyType=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
    String propertyIsFinal=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
    Assert.assertEquals(PROPERTY_NAME,propertyName);
    Assert.assertEquals(PROPERTY_VALUE,propertyValue);
    Assert.assertEquals(PROPERTY_DESC,propertyDesc);
    Assert.assertEquals(TYPE,propertyType);
    Assert.assertEquals("false",propertyIsFinal);
  }
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("final","true");
  Resource.Type type=Resource.Type.StackConfiguration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationResponse> allResponse=new HashSet<StackConfigurationResponse>();
  allResponse.add(new StackConfigurationResponse(PROPERTY_NAME,PROPERTY_VALUE,PROPERTY_DESC,TYPE,attributes));
  expect(managementController.getStackConfigurations(AbstractResourceProviderTest.Matcher.getStackConfigurationRequestSet(null,null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackConfigurationResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_DEPENDS_ON_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String propertyName=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
    String propertyValue=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
    String propertyDesc=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
    String propertyType=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
    String propertyIsFinal=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
    String propertyDependencies=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_DEPENDS_ON_PROPERTY_ID);
    Assert.assertEquals(PROPERTY_NAME,propertyName);
    Assert.assertEquals(PROPERTY_VALUE,propertyValue);
    Assert.assertEquals(PROPERTY_DESC,propertyDesc);
    Assert.assertEquals(TYPE,propertyType);
    Assert.assertEquals("true",propertyIsFinal);
    Assert.assertNull(propertyDependencies);
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackDependencyResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchParentResourceException, NoSuchResourceException, AmbariException {
  Request request=createNiceMock(Request.class);
  DependencyInfo dependencyInfo=new DependencyInfo();
  dependencyInfo.setName("service_name/comp_name");
  dependencyInfo.setScope("cluster");
  Predicate namePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.COMPONENT_NAME_ID,"comp_name");
  Predicate depServicePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.DEPENDENT_SERVICE_NAME_ID,"dep_service_name");
  Predicate depCompPredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.DEPENDENT_COMPONENT_NAME_ID,"dep_comp_name");
  Predicate stackNamePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.STACK_NAME_ID,"stack_name");
  Predicate stackVersionPredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.STACK_VERSION_ID,"stack_version");
  Predicate andPredicate=new AndPredicate(namePredicate,depServicePredicate,depCompPredicate,stackNamePredicate,stackVersionPredicate);
  expect(metaInfo.getComponentDependency("stack_name","stack_version","dep_service_name","dep_comp_name","comp_name")).andReturn(dependencyInfo);
  replay(metaInfo,request);
  ResourceProvider provider=createProvider();
  Set<Resource> resources=provider.getResources(request,andPredicate);
  verify(metaInfo);
  assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  assertEquals("cluster",resource.getPropertyValue(StackDependencyResourceProvider.SCOPE_ID));
  assertEquals("comp_name",resource.getPropertyValue(StackDependencyResourceProvider.COMPONENT_NAME_ID));
  assertEquals("service_name",resource.getPropertyValue(StackDependencyResourceProvider.SERVICE_NAME_ID));
  assertEquals("dep_service_name",resource.getPropertyValue(StackDependencyResourceProvider.DEPENDENT_SERVICE_NAME_ID));
  assertEquals("dep_comp_name",resource.getPropertyValue(StackDependencyResourceProvider.DEPENDENT_COMPONENT_NAME_ID));
  assertEquals("stack_name",resource.getPropertyValue(StackDependencyResourceProvider.STACK_NAME_ID));
  assertEquals("stack_version",resource.getPropertyValue(StackDependencyResourceProvider.STACK_VERSION_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_Query() throws SystemException, UnsupportedPropertyException, NoSuchParentResourceException, NoSuchResourceException, AmbariException {
  Request request=createNiceMock(Request.class);
  DependencyInfo dependencyInfo=new DependencyInfo();
  dependencyInfo.setName("service_name/comp_name");
  dependencyInfo.setScope("cluster");
  Predicate namePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.COMPONENT_NAME_ID,"comp_name");
  Predicate name2Predicate=new EqualsPredicate<String>(StackDependencyResourceProvider.COMPONENT_NAME_ID,"comp_name2");
  Predicate depServicePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.DEPENDENT_SERVICE_NAME_ID,"dep_service_name");
  Predicate depCompPredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.DEPENDENT_COMPONENT_NAME_ID,"dep_comp_name");
  Predicate stackNamePredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.STACK_NAME_ID,"stack_name");
  Predicate stackVersionPredicate=new EqualsPredicate<String>(StackDependencyResourceProvider.STACK_VERSION_ID,"stack_version");
  Predicate andPredicate1=new AndPredicate(namePredicate,depServicePredicate,depCompPredicate,stackNamePredicate,stackVersionPredicate);
  Predicate andPredicate2=new AndPredicate(name2Predicate,depServicePredicate,depCompPredicate,stackNamePredicate,stackVersionPredicate);
  Predicate orPredicate=new OrPredicate(andPredicate1,andPredicate2);
  expect(metaInfo.getComponentDependency("stack_name","stack_version","dep_service_name","dep_comp_name","comp_name")).andReturn(dependencyInfo);
  expect(metaInfo.getComponentDependency("stack_name","stack_version","dep_service_name","dep_comp_name","comp_name2")).andThrow(new StackAccessException("test"));
  replay(metaInfo,request);
  ResourceProvider provider=createProvider();
  Set<Resource> resources=provider.getResources(request,orPredicate);
  verify(metaInfo);
  assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  assertEquals("cluster",resource.getPropertyValue(StackDependencyResourceProvider.SCOPE_ID));
  assertEquals("comp_name",resource.getPropertyValue(StackDependencyResourceProvider.COMPONENT_NAME_ID));
  assertEquals("service_name",resource.getPropertyValue(StackDependencyResourceProvider.SERVICE_NAME_ID));
  assertEquals("dep_service_name",resource.getPropertyValue(StackDependencyResourceProvider.DEPENDENT_SERVICE_NAME_ID));
  assertEquals("dep_comp_name",resource.getPropertyValue(StackDependencyResourceProvider.DEPENDENT_COMPONENT_NAME_ID));
  assertEquals("stack_name",resource.getPropertyValue(StackDependencyResourceProvider.STACK_NAME_ID));
  assertEquals("stack_version",resource.getPropertyValue(StackDependencyResourceProvider.STACK_VERSION_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackLevelConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_noFinal() throws Exception {
  Map<String,String> attributes=new HashMap<String,String>();
  Resource.Type type=Resource.Type.StackLevelConfiguration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationResponse> allResponse=new HashSet<StackConfigurationResponse>();
  allResponse.add(new StackConfigurationResponse(PROPERTY_NAME,PROPERTY_VALUE,PROPERTY_DESC,TYPE,attributes));
  expect(managementController.getStackLevelConfigurations(AbstractResourceProviderTest.Matcher.getStackLevelConfigurationRequestSet(null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackLevelConfigurationResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String propertyName=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
    String propertyValue=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
    String propertyDesc=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
    String propertyType=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
    String propertyIsFinal=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
    Assert.assertEquals(PROPERTY_NAME,propertyName);
    Assert.assertEquals(PROPERTY_VALUE,propertyValue);
    Assert.assertEquals(PROPERTY_DESC,propertyDesc);
    Assert.assertEquals(TYPE,propertyType);
    Assert.assertEquals("false",propertyIsFinal);
  }
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("final","true");
  Resource.Type type=Resource.Type.StackLevelConfiguration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationResponse> allResponse=new HashSet<StackConfigurationResponse>();
  allResponse.add(new StackConfigurationResponse(PROPERTY_NAME,PROPERTY_VALUE,PROPERTY_DESC,TYPE,attributes));
  expect(managementController.getStackLevelConfigurations(AbstractResourceProviderTest.Matcher.getStackLevelConfigurationRequestSet(null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackLevelConfigurationResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
  propertyIds.add(StackLevelConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String propertyName=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
    String propertyValue=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
    String propertyDesc=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
    String propertyType=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
    String propertyIsFinal=(String)resource.getPropertyValue(StackLevelConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
    Assert.assertEquals(PROPERTY_NAME,propertyName);
    Assert.assertEquals(PROPERTY_VALUE,propertyValue);
    Assert.assertEquals(PROPERTY_DESC,propertyDesc);
    Assert.assertEquals(TYPE,propertyType);
    Assert.assertEquals("true",propertyIsFinal);
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Stack;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackResponse> allResponse=new HashSet<StackResponse>();
  allResponse.add(new StackResponse("Stack1"));
  allResponse.add(new StackResponse("Stack2"));
  expect(managementController.getStacks(EasyMock.<Set<StackRequest>>anyObject())).andReturn(allResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackResourceProvider.STACK_NAME_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(2,resources.size());
  Set<String> stackNames=new HashSet<String>();
  stackNames.add("Stack1");
  stackNames.add("Stack2");
  for (  Resource resource : resources) {
    String stackName=(String)resource.getPropertyValue(StackResourceProvider.STACK_NAME_PROPERTY_ID);
    Assert.assertTrue(stackNames.contains(stackName));
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackServiceResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetServiceProperties() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Resource.Type type=Resource.Type.StackService;
  StackServiceResponse stackServiceResponse=createNiceMock(StackServiceResponse.class);
  expect(stackServiceResponse.getServiceProperties()).andReturn(TEST_SERVICE_PROPERTIES);
  expect(managementController.getStackServices(anyObject(Set.class))).andReturn(ImmutableSet.of(stackServiceResponse));
  replay(managementController,stackServiceResponse);
  Request request=PropertyHelper.getReadRequest(SERVICE_PROPERTIES_PROPERTY_ID);
  ResourceProvider stackServiceResourceProvider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=stackServiceResourceProvider.getResources(request,null);
  Resource expected=new ResourceImpl(type);
  BaseProvider.setResourceProperty(expected,SERVICE_PROPERTIES_PROPERTY_ID,TEST_SERVICE_PROPERTIES,ImmutableSet.of(SERVICE_PROPERTIES_PROPERTY_ID));
  assertEquals(ImmutableSet.of(expected),resources);
  verify(managementController,stackServiceResponse);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetVisibilityServiceProperties() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Resource.Type type=Resource.Type.StackService;
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setServicePropertyList(TEST_SERVICE_PROPERTY_LIST);
  StackServiceResponse stackServiceResponse=new StackServiceResponse(serviceInfo);
  expect(managementController.getStackServices(anyObject(Set.class))).andReturn(ImmutableSet.of(stackServiceResponse));
  replay(managementController);
  Request request=PropertyHelper.getReadRequest(SERVICE_PROPERTIES_PROPERTY_ID);
  ResourceProvider stackServiceResourceProvider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<Resource> resources=stackServiceResourceProvider.getResources(request,null);
  Map<String,String> expectedServiceProperties=ImmutableMap.<String,String>builder().putAll(TEST_SERVICE_PROPERTIES).put(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY).build();
  Resource expected=new ResourceImpl(type);
  BaseProvider.setResourceProperty(expected,SERVICE_PROPERTIES_PROPERTY_ID,expectedServiceProperties,ImmutableSet.of(SERVICE_PROPERTIES_PROPERTY_ID));
  assertEquals(ImmutableSet.of(expected),resources);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequiredProperties_serviceAndPropertyType() throws Exception {
  AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  AmbariMetaInfo metaInfo=createNiceMock(AmbariMetaInfo.class);
  Capture<Set<StackServiceRequest>> stackServiceRequestCapture=new Capture<Set<StackServiceRequest>>();
  StackServiceResponse stackServiceResponse=createNiceMock(StackServiceResponse.class);
  Capture<Set<StackServiceComponentRequest>> stackComponentRequestCapture=new Capture<Set<StackServiceComponentRequest>>();
  StackServiceComponentResponse stackComponentResponse=createNiceMock(StackServiceComponentResponse.class);
  Capture<Set<StackConfigurationRequest>> stackConfigurationRequestCapture=new Capture<Set<StackConfigurationRequest>>();
  Capture<Set<StackLevelConfigurationRequest>> stackLevelConfigurationRequestCapture=new Capture<Set<StackLevelConfigurationRequest>>();
  StackConfigurationResponse stackConfigurationResponse=EasyMock.createNiceMock(StackConfigurationResponse.class);
  StackConfigurationResponse stackConfigurationResponse2=EasyMock.createNiceMock(StackConfigurationResponse.class);
  expect(controller.getStackServices(capture(stackServiceRequestCapture))).andReturn(Collections.singleton(stackServiceResponse)).anyTimes();
  expect(controller.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  expect(stackServiceResponse.getServiceName()).andReturn("service1").anyTimes();
  expect(stackServiceResponse.getExcludedConfigTypes()).andReturn(Collections.<String>emptySet());
  expect(controller.getStackComponents(capture(stackComponentRequestCapture))).andReturn(Collections.singleton(stackComponentResponse)).anyTimes();
  expect(stackComponentResponse.getComponentName()).andReturn("component1").anyTimes();
  expect(stackComponentResponse.getComponentCategory()).andReturn("test-site.xml").anyTimes();
  expect(controller.getStackConfigurations(capture(stackConfigurationRequestCapture))).andReturn(new HashSet<StackConfigurationResponse>(Arrays.asList(stackConfigurationResponse,stackConfigurationResponse2))).anyTimes();
  expect(controller.getStackLevelConfigurations(capture(stackLevelConfigurationRequestCapture))).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  expect(stackConfigurationResponse.getPropertyName()).andReturn("prop1").anyTimes();
  expect(stackConfigurationResponse.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.PASSWORD)).anyTimes();
  expect(stackConfigurationResponse.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse.isRequired()).andReturn(true).anyTimes();
  expect(stackConfigurationResponse2.getPropertyName()).andReturn("prop2").anyTimes();
  expect(stackConfigurationResponse2.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse2.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse2.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.USER)).anyTimes();
  expect(stackConfigurationResponse2.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse2.isRequired()).andReturn(true).anyTimes();
  expect(metaInfo.getComponentDependencies("test","1.0","service1","component1")).andReturn(Collections.<DependencyInfo>emptyList()).anyTimes();
  replay(controller,stackServiceResponse,stackComponentResponse,stackConfigurationResponse,stackConfigurationResponse2,metaInfo);
  Stack stack=new Stack("test","1.0",controller);
  Collection<Stack.ConfigProperty> requiredPasswordProperties=stack.getRequiredConfigurationProperties("service1",PropertyInfo.PropertyType.PASSWORD);
  assertEquals(1,requiredPasswordProperties.size());
  Stack.ConfigProperty requiredPasswordConfigProperty=requiredPasswordProperties.iterator().next();
  assertEquals("test-site",requiredPasswordConfigProperty.getType());
  assertEquals("prop1",requiredPasswordConfigProperty.getName());
  assertTrue(requiredPasswordConfigProperty.getPropertyTypes().contains(PropertyInfo.PropertyType.PASSWORD));
  StackServiceRequest stackServiceRequest=stackServiceRequestCapture.getValue().iterator().next();
  assertEquals("test",stackServiceRequest.getStackName());
  assertEquals("1.0",stackServiceRequest.getStackVersion());
  StackServiceComponentRequest stackComponentRequest=stackComponentRequestCapture.getValue().iterator().next();
  assertEquals("service1",stackComponentRequest.getServiceName());
  assertEquals("test",stackComponentRequest.getStackName());
  assertEquals("1.0",stackComponentRequest.getStackVersion());
  assertNull(stackComponentRequest.getComponentName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StageResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  StageResourceProvider provider=new StageResourceProvider(managementController);
  Request request=createNiceMock(Request.class);
  Predicate predicate=createNiceMock(Predicate.class);
  List<StageEntity> entities=getStageEntities(HostRoleStatus.COMPLETED);
  expect(dao.findAll(request,predicate)).andReturn(entities);
  expect(clusters.getClusterById(anyLong())).andReturn(cluster).anyTimes();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  replay(dao,clusters,cluster,request,predicate);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals(100.0,resource.getPropertyValue(StageResourceProvider.STAGE_PROGRESS_PERCENT));
  Assert.assertEquals(HostRoleStatus.COMPLETED,resource.getPropertyValue(StageResourceProvider.STAGE_STATUS));
  Assert.assertEquals(HostRoleStatus.COMPLETED,resource.getPropertyValue(StageResourceProvider.STAGE_DISPLAY_STATUS));
  Assert.assertEquals(1000L,resource.getPropertyValue(StageResourceProvider.STAGE_START_TIME));
  Assert.assertEquals(2500L,resource.getPropertyValue(StageResourceProvider.STAGE_END_TIME));
  verify(dao,clusters,cluster);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests getting the display status of a stage which can differ from the final
 * status.
 * @throws Exception
 */
@Test public void testGetDisplayStatus() throws Exception {
  EasyMock.reset(hrcDao);
  expect(hrcDao.findAggregateCounts(EasyMock.anyObject(Long.class))).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(0L,new HostRoleCommandStatusSummaryDTO(0,1000L,2500L,0,0,1,0,0,0,0,0,0,0,0,1));
    }
  }
).anyTimes();
  replay(hrcDao);
  StageResourceProvider provider=new StageResourceProvider(managementController);
  Request request=createNiceMock(Request.class);
  Predicate predicate=createNiceMock(Predicate.class);
  List<StageEntity> entities=getStageEntities(HostRoleStatus.SKIPPED_FAILED);
  entities.get(0).setSkippable(true);
  expect(dao.findAll(request,predicate)).andReturn(entities);
  expect(clusters.getClusterById(anyLong())).andReturn(cluster).anyTimes();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  replay(dao,clusters,cluster,request,predicate);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals(HostRoleStatus.COMPLETED,resource.getPropertyValue(StageResourceProvider.STAGE_STATUS));
  Assert.assertEquals(HostRoleStatus.SKIPPED_FAILED,resource.getPropertyValue(StageResourceProvider.STAGE_DISPLAY_STATUS));
  verify(dao,clusters,cluster);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TargetClusterResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  IvoryService service=createMock(IvoryService.class);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  Map<String,Object> properties=new HashMap<String,Object>();
  List<String> targetClusterNames=new LinkedList<String>();
  targetClusterNames.add("Cluster1");
  targetClusterNames.add("Cluster2");
  targetClusterNames.add("Cluster3");
  Cluster.Interface interface1=new Cluster.Interface("type","endpoint","version");
  Cluster.Location location1=new Cluster.Location("name","path");
  Cluster targetCluster1=new Cluster("Cluster1","Colo",Collections.singleton(interface1),Collections.singleton(location1),Collections.singletonMap("P1","V1"));
  Cluster targetCluster2=new Cluster("Cluster2","Colo",Collections.singleton(interface1),Collections.singleton(location1),Collections.singletonMap("P1","V1"));
  Cluster targetCluster3=new Cluster("Cluster3","Colo",Collections.singleton(interface1),Collections.singleton(location1),Collections.singletonMap("P1","V1"));
  expect(service.getClusterNames()).andReturn(targetClusterNames);
  expect(service.getCluster("Cluster1")).andReturn(targetCluster1);
  expect(service.getCluster("Cluster2")).andReturn(targetCluster2);
  expect(service.getCluster("Cluster3")).andReturn(targetCluster3);
  replay(service);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,Collections.<String,String>emptyMap());
  TargetClusterResourceProvider provider=new TargetClusterResourceProvider(service,PropertyHelper.getPropertyIds(Resource.Type.DRTargetCluster),PropertyHelper.getKeyPropertyIds(Resource.Type.DRTargetCluster));
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(3,resources.size());
  verify(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TaskAttemptResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTaskAttemptFetcher() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.TaskAttempt);
  ResourceProvider provider=new TestTaskAttemptResourceProvider(requestedIds,keyPropertyIds);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID).equals("taskattempt1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID);
    Assert.assertEquals("taskattempt1",workflowId);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createTaskAttemptResponse("Cluster100","workflow1","job1","taskAttempt1"));
  expected.add(createTaskAttemptResponse("Cluster100","workflow2","job2","taskAttempt2"));
  expected.add(createTaskAttemptResponse("Cluster100","workflow2","job2","taskAttempt3"));
  Resource.Type type=Resource.Type.TaskAttempt;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  TaskAttemptFetcher taskAttemptFetcher=createMock(TaskAttemptFetcher.class);
  expect(taskAttemptFetcher.fetchTaskAttemptDetails(propertyIds,null,null,"job2",null)).andReturn(expected).once();
  replay(taskAttemptFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new TaskAttemptResourceProvider(propertyIds,keyPropertyIds,taskAttemptFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(TaskAttemptResourceProvider.TASK_ATTEMPT_JOB_ID_PROPERTY_ID).equals("job2").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID)));
  }
  verify(taskAttemptFetcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TaskResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResourcesForTopology() throws Exception {
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  HostRoleCommandDAO hostRoleCommandDAO=createMock(HostRoleCommandDAO.class);
  TopologyManager topologyManager=createMock(TopologyManager.class);
  HostDAO hostDAO=createMock(HostDAO.class);
  ExecutionCommandDAO executionCommandDAO=createMock(ExecutionCommandDAO.class);
  Injector m_injector=Guice.createInjector(new InMemoryDefaultTestModule());
  TaskResourceProvider provider=(TaskResourceProvider)AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),amc);
  m_injector.injectMembers(provider);
  TaskResourceProvider.s_dao=hostRoleCommandDAO;
  TaskResourceProvider.s_topologyManager=topologyManager;
  List<HostRoleCommandEntity> entities=new ArrayList<>();
  List<HostRoleCommand> commands=new ArrayList<>();
  HostRoleCommandEntity hostRoleCommandEntity=new HostRoleCommandEntity();
  hostRoleCommandEntity.setRequestId(100L);
  hostRoleCommandEntity.setTaskId(100L);
  hostRoleCommandEntity.setStageId(100L);
  hostRoleCommandEntity.setRole(Role.DATANODE);
  hostRoleCommandEntity.setCustomCommandName("customCommandName");
  hostRoleCommandEntity.setCommandDetail("commandDetail");
  commands.add(new HostRoleCommand(hostRoleCommandEntity,hostDAO,executionCommandDAO));
  expect(hostRoleCommandDAO.findAll(EasyMock.anyObject(Request.class),EasyMock.anyObject(Predicate.class))).andReturn(entities).once();
  expect(topologyManager.getTasks(EasyMock.anyLong())).andReturn(commands).once();
  replay(hostRoleCommandDAO,topologyManager);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(TaskResourceProvider.TASK_ID_PROPERTY_ID);
  propertyIds.add(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID);
  propertyIds.add(TaskResourceProvider.TASK_COMMAND_DET_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals("100").and().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    long taskId=(Long)resource.getPropertyValue(TaskResourceProvider.TASK_ID_PROPERTY_ID);
    Assert.assertEquals(100L,taskId);
    Assert.assertEquals(null,resource.getPropertyValue(TaskResourceProvider.TASK_CUST_CMD_NAME_PROPERTY_ID));
    Assert.assertEquals("commandDetail",resource.getPropertyValue(TaskResourceProvider.TASK_COMMAND_DET_PROPERTY_ID));
  }
  verify(hostRoleCommandDAO,topologyManager);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  HostRoleCommandDAO hostRoleCommandDAO=createMock(HostRoleCommandDAO.class);
  Injector m_injector=Guice.createInjector(new InMemoryDefaultTestModule());
  TaskResourceProvider provider=(TaskResourceProvider)AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),amc);
  m_injector.injectMembers(provider);
  TaskResourceProvider.s_dao=hostRoleCommandDAO;
  List<HostRoleCommandEntity> entities=new ArrayList<>();
  HostRoleCommandEntity hostRoleCommandEntity=new HostRoleCommandEntity();
  hostRoleCommandEntity.setRequestId(100L);
  hostRoleCommandEntity.setTaskId(100L);
  hostRoleCommandEntity.setStageId(100L);
  hostRoleCommandEntity.setRole(Role.DATANODE);
  hostRoleCommandEntity.setCustomCommandName("customCommandName");
  hostRoleCommandEntity.setCommandDetail("commandDetail");
  entities.add(hostRoleCommandEntity);
  expect(hostRoleCommandDAO.findAll(EasyMock.anyObject(Request.class),EasyMock.anyObject(Predicate.class))).andReturn(entities).once();
  replay(hostRoleCommandDAO);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(TaskResourceProvider.TASK_ID_PROPERTY_ID);
  propertyIds.add(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID);
  propertyIds.add(TaskResourceProvider.TASK_COMMAND_DET_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals("100").and().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    long taskId=(Long)resource.getPropertyValue(TaskResourceProvider.TASK_ID_PROPERTY_ID);
    Assert.assertEquals(100L,taskId);
    Assert.assertEquals(null,resource.getPropertyValue(TaskResourceProvider.TASK_CUST_CMD_NAME_PROPERTY_ID));
    Assert.assertEquals("commandDetail",resource.getPropertyValue(TaskResourceProvider.TASK_COMMAND_DET_PROPERTY_ID));
  }
  verify(hostRoleCommandDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInvalidStructuredOutput(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput(null);
  Assert.assertNull(result);
  result=taskResourceProvider.parseStructuredOutput("This is some bad JSON");
  Assert.assertNull(result);
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseStructuredOutput(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput("{\"a\":\"b\", \"c\": {\"d\":\"e\",\"f\": [\"g\",\"h\"],\"i\": {\"k\":\"l\"}}}");
  assertEquals(result.size(),2);
  Map<?,?> submap=(Map<?,?>)result.get("c");
  assertEquals(submap.size(),3);
  List sublist=(List)submap.get("f");
  assertEquals(sublist.size(),2);
  Map<?,?> subsubmap=(Map<?,?>)submap.get("i");
  assertEquals(subsubmap.size(),1);
  assertEquals(subsubmap.get("k"),"l");
  result=taskResourceProvider.parseStructuredOutput("{\"a\": invalid JSON}");
  assertNull(result);
  result=taskResourceProvider.parseStructuredOutput("{\"a\": 5}");
  assertEquals(result.get("a"),5);
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseStructuredOutputForHostCheck(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput("{\"host_resolution_check\": {\"failures\": [{\"cause\": [-2, \"Name or service not known\"], \"host\": \"foobar\", \"type\": \"FORWARD_LOOKUP\"}], \"message\": \"There were 1 host(s) that could not resolve to an IP address.\", \"failed_count\": 1, \"success_count\": 3, \"exit_code\": 0}}");
  Assert.assertNotNull(result);
  Map<?,?> host_resolution_check=(Map<?,?>)result.get("host_resolution_check");
  assertEquals(host_resolution_check.get("success_count"),3);
  assertEquals(host_resolution_check.get("failed_count"),1);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderHDP22Test </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests upgrades from HDP-2.2.x to HDP-2.2.y
 * @throws Exception
 */
@SuppressWarnings("serial") @Test public void testCreateIntraStackUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackId oldStack=cluster.getDesiredStackVersion();
  for (  Service s : cluster.getServices().values()) {
    assertEquals(oldStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(oldStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(oldStack,sch.getDesiredStackVersion());
      }
    }
  }
  Config config=new ConfigImpl("hive-site");
  config.setProperties(configTagVersion1Properties);
  config.setTag(configTagVersion1);
  cluster.addConfig(config);
  cluster.addDesiredConfig("admin",Collections.singleton(config));
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.4.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  assertEquals("upgrade_test",upgrade.getUpgradePackage());
  assertEquals(3,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  assertEquals(3,group.getItems().size());
  group=upgrade.getUpgradeGroups().get(0);
  assertEquals(2,group.getItems().size());
  UpgradeItemEntity item=group.getItems().get(1);
  assertEquals("Value is set for the source stack upgrade pack","Goo",item.getText());
  assertTrue(cluster.getDesiredConfigs().containsKey("hive-site"));
  StackId newStack=cluster.getDesiredStackVersion();
  assertTrue(oldStack.equals(newStack));
  for (  Service s : cluster.getServices().values()) {
    assertEquals(newStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(newStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(newStack,sch.getDesiredStackVersion());
      }
    }
  }
  assertEquals(configTagVersion1,cluster.getDesiredConfigByType("hive-site").getTag());
  final Config newConfig=new ConfigImpl("hive-site");
  newConfig.setProperties(configTagVersion2Properties);
  newConfig.setTag(configTagVersion2);
  Set<Config> desiredConfigs=new HashSet<Config>(){
{
      add(newConfig);
    }
  }
;
  cluster.addConfig(newConfig);
  cluster.addDesiredConfig("admin",desiredConfigs);
  assertEquals(configTagVersion2,cluster.getDesiredConfigByType("hive-site").getTag());
  Gson gson=new Gson();
  List<ExecutionCommandEntity> currentExecutionCommands=injector.getInstance(ExecutionCommandDAO.class).findAll();
  for (  ExecutionCommandEntity ece : currentExecutionCommands) {
    String executionCommandJson=new String(ece.getCommand());
    Map<String,Object> commandMap=gson.<Map<String,Object>>fromJson(executionCommandJson,Map.class);
    Set<String> roleCommandsThatMustHaveRefresh=new HashSet<String>();
    roleCommandsThatMustHaveRefresh.add("SERVICE_CHECK");
    roleCommandsThatMustHaveRefresh.add("RESTART");
    roleCommandsThatMustHaveRefresh.add("ACTIONEXECUTE");
    String roleCommand=(String)commandMap.get("roleCommand");
    if (roleCommandsThatMustHaveRefresh.contains(roleCommand)) {
      assertTrue(commandMap.containsKey(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION));
      Object object=commandMap.get(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION);
      assertTrue(object instanceof List);
      @SuppressWarnings("unchecked") List<String> tags=(List<String>)commandMap.get(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION);
      assertEquals(1,tags.size());
      assertEquals("*",tags.get(0));
      ExecutionCommandWrapper executionCommandWrapper=new ExecutionCommandWrapper(executionCommandJson);
      ExecutionCommand executionCommand=executionCommandWrapper.getExecutionCommand();
      Map<String,Map<String,String>> configurationTags=executionCommand.getConfigurationTags();
      assertEquals(configTagVersion2,configurationTags.get("hive-site").get("tag"));
      Map<String,Map<String,String>> configurations=executionCommand.getConfigurations();
      assertEquals("10010",configurations.get("hive-site").get("hive.server2.thrift.port"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that retrieving an upgrade correctly populates less common upgrade
 * options correctly.
 */
@Test public void testGetResourcesWithSpecialOptions() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(0,upgrades.size());
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertNotNull(status);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("Upgrade");
  Predicate predicate=new PredicateBuilder().property(UpgradeResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=upgradeResourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  assertEquals(true,resource.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES));
  assertEquals(true,resource.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateResourcesWithAutoSkipManualVerification() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_TYPE,UpgradeType.ROLLING.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_MANUAL_VERIFICATION,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,Boolean.TRUE.toString());
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity entity=upgrades.get(0);
  assertEquals(cluster.getClusterId(),entity.getClusterId().longValue());
  List<UpgradeGroupEntity> upgradeGroups=entity.getUpgradeGroups();
  assertEquals(2,upgradeGroups.size());
  UpgradeGroupEntity zookeeperGroup=upgradeGroups.get(0);
  assertEquals("ZOOKEEPER",zookeeperGroup.getName());
  List<UpgradeItemEntity> zookeeperUpgradeItems=zookeeperGroup.getItems();
  assertEquals(3,zookeeperUpgradeItems.size());
  assertEquals("Restarting ZooKeeper Server on h1",zookeeperUpgradeItems.get(0).getText());
  assertEquals("Skipping Configuration Task 2.2.0",zookeeperUpgradeItems.get(1).getText());
  assertEquals("Service Check ZooKeeper",zookeeperUpgradeItems.get(2).getText());
  UpgradeGroupEntity postClusterGroup=upgradeGroups.get(1);
  assertEquals("POST_CLUSTER",postClusterGroup.getName());
  List<UpgradeItemEntity> postClusterUpgradeItems=postClusterGroup.getItems();
  assertEquals(1,postClusterUpgradeItems.size());
  assertEquals("Save Cluster State",postClusterUpgradeItems.get(0).getText());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeToBase() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  try {
    upgradeResourceProvider.createResources(request);
    Assert.fail("Expected an exception going downgrade with no upgrade pack");
  }
 catch (  Exception e) {
  }
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.1.1.0");
  Map<String,String> requestInfoProperties=new HashMap<>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertEquals(1,status.getAssociatedResources().size());
  Resource r=status.getAssociatedResources().iterator().next();
  String id=r.getPropertyValue("Upgrade/request_id").toString();
  UpgradeEntity entity=upgradeDao.findUpgrade(Long.parseLong(id));
  assertNotNull(entity);
  assertEquals("2.1.1",entity.getFromVersion());
  assertEquals("2.2.0.0",entity.getToVersion());
  assertEquals(Direction.DOWNGRADE,entity.getDirection());
  StageDAO dao=injector.getInstance(StageDAO.class);
  List<StageEntity> stages=dao.findByRequestId(entity.getRequestId());
  Gson gson=new Gson();
  for (  StageEntity se : stages) {
    Map<String,String> map=gson.fromJson(se.getCommandParamsStage(),Map.class);
    assertTrue(map.containsKey("upgrade_direction"));
    assertEquals("downgrade",map.get("upgrade_direction"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialDowngrade() throws Exception {
  clusters.addHost("h2");
  Host host=clusters.getHost("h2");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  clusters.mapHostToCluster("h2","c1");
  Cluster cluster=clusters.getCluster("c1");
  Service service=cluster.getService("ZOOKEEPER");
  ServiceComponent component=service.getServiceComponent("ZOOKEEPER_SERVER");
  ServiceComponentHost sch=component.addServiceComponentHost("h2");
  sch.setVersion("2.2.2.2");
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(0,upgrades.size());
  UpgradeEntity upgradeEntity=new UpgradeEntity();
  upgradeEntity.setClusterId(cluster.getClusterId());
  upgradeEntity.setDirection(Direction.UPGRADE);
  upgradeEntity.setFromVersion("2.1.1.1");
  upgradeEntity.setToVersion("2.2.2.2");
  upgradeEntity.setUpgradePackage("upgrade_test");
  upgradeEntity.setUpgradeType(UpgradeType.ROLLING);
  upgradeEntity.setRequestId(1L);
  upgradeDao.create(upgradeEntity);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity lastUpgrade=upgradeDao.findLastUpgradeForCluster(cluster.getClusterId());
  assertNotNull(lastUpgrade);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  upgradeResourceProvider.createResources(request);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(2,upgrades.size());
  UpgradeEntity downgrade=upgrades.get(1);
  assertEquals(cluster.getClusterId(),downgrade.getClusterId().longValue());
  List<UpgradeGroupEntity> upgradeGroups=downgrade.getUpgradeGroups();
  assertEquals(3,upgradeGroups.size());
  UpgradeGroupEntity group=upgradeGroups.get(1);
  assertEquals("ZOOKEEPER",group.getName());
  assertEquals(4,group.getItems().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackEntity stackEntity=stackDAO.find("HDP","2.1.1");
  RepositoryVersionEntity repoVersionEntity=new RepositoryVersionEntity();
  repoVersionEntity.setDisplayName("My New Version 3");
  repoVersionEntity.setOperatingSystems("");
  repoVersionEntity.setStack(stackEntity);
  repoVersionEntity.setVersion("2.2.2.3");
  repoVersionDao.create(repoVersionEntity);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.2.3");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  Long id=upgrade.getRequestId();
  assertEquals(3,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  Assert.assertEquals("POST_CLUSTER",group.getName());
  Assert.assertTrue(!group.getItems().isEmpty());
  for (  UpgradeItemEntity item : group.getItems()) {
    Assert.assertFalse(item.getText().toLowerCase().contains("downgrade"));
  }
  requestProps.clear();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.2.2.3");
  Map<String,String> requestInfoProps=new HashMap<String,String>();
  requestInfoProps.put("downgrade","true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProps);
  upgradeResourceProvider.createResources(request);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(2,upgrades.size());
  upgrade=null;
  for (  UpgradeEntity u : upgrades) {
    if (!u.getRequestId().equals(id)) {
      upgrade=u;
    }
  }
  assertNotNull(upgrade);
  assertEquals("Downgrade groups reduced from 3 to 2",2,upgrade.getUpgradeGroups().size());
  group=upgrade.getUpgradeGroups().get(1);
  assertEquals("Execution items increased from 1 to 2",2,group.getItems().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateResourcesWithAutoSkipFailures() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_TYPE,UpgradeType.ROLLING.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_MANUAL_VERIFICATION,Boolean.FALSE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,Boolean.TRUE.toString());
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity entity=upgrades.get(0);
  assertEquals(cluster.getClusterId(),entity.getClusterId().longValue());
  List<UpgradeGroupEntity> upgradeGroups=entity.getUpgradeGroups();
  assertEquals(3,upgradeGroups.size());
  UpgradeGroupEntity preClusterGroup=upgradeGroups.get(0);
  assertEquals("PRE_CLUSTER",preClusterGroup.getName());
  List<UpgradeItemEntity> preClusterUpgradeItems=preClusterGroup.getItems();
  assertEquals(2,preClusterUpgradeItems.size());
  assertEquals("Foo",preClusterUpgradeItems.get(0).getText());
  assertEquals("Foo",preClusterUpgradeItems.get(1).getText());
  UpgradeGroupEntity zookeeperGroup=upgradeGroups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.getName());
  List<UpgradeItemEntity> zookeeperUpgradeItems=zookeeperGroup.getItems();
  assertEquals(5,zookeeperUpgradeItems.size());
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",zookeeperUpgradeItems.get(0).getText());
  assertEquals("Restarting ZooKeeper Server on h1",zookeeperUpgradeItems.get(1).getText());
  assertEquals("Skipping Configuration Task 2.2.0",zookeeperUpgradeItems.get(2).getText());
  assertEquals("Service Check ZooKeeper",zookeeperUpgradeItems.get(3).getText());
  assertEquals("Verifying Skipped Failures",zookeeperUpgradeItems.get(4).getText());
  UpgradeItemEntity skippedFailureCheck=zookeeperUpgradeItems.get(zookeeperUpgradeItems.size() - 1);
  skippedFailureCheck.getTasks().contains(AutoSkipFailedSummaryAction.class.getName());
  UpgradeGroupEntity postClusterGroup=upgradeGroups.get(2);
  assertEquals("POST_CLUSTER",postClusterGroup.getName());
  List<UpgradeItemEntity> postClusterUpgradeItems=postClusterGroup.getItems();
  assertEquals(2,postClusterUpgradeItems.size());
  assertEquals("Please confirm you are ready to finalize",postClusterUpgradeItems.get(0).getText());
  assertEquals("Save Cluster State",postClusterUpgradeItems.get(1).getText());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbort() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"ABORTED");
  UpgradeResourceProvider urp=createProvider(amc);
  Request req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateResourcesWithAutoSkipAll() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_TYPE,UpgradeType.ROLLING.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_MANUAL_VERIFICATION,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,Boolean.TRUE.toString());
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity entity=upgrades.get(0);
  assertEquals(cluster.getClusterId(),entity.getClusterId().longValue());
  List<UpgradeGroupEntity> upgradeGroups=entity.getUpgradeGroups();
  assertEquals(2,upgradeGroups.size());
  UpgradeGroupEntity zookeeperGroup=upgradeGroups.get(0);
  assertEquals("ZOOKEEPER",zookeeperGroup.getName());
  List<UpgradeItemEntity> zookeeperUpgradeItems=zookeeperGroup.getItems();
  assertEquals(4,zookeeperUpgradeItems.size());
  assertEquals("Restarting ZooKeeper Server on h1",zookeeperUpgradeItems.get(0).getText());
  assertEquals("Skipping Configuration Task 2.2.0",zookeeperUpgradeItems.get(1).getText());
  assertEquals("Service Check ZooKeeper",zookeeperUpgradeItems.get(2).getText());
  assertEquals("Verifying Skipped Failures",zookeeperUpgradeItems.get(3).getText());
  UpgradeItemEntity skippedFailureCheck=zookeeperUpgradeItems.get(zookeeperUpgradeItems.size() - 1);
  skippedFailureCheck.getTasks().contains(AutoSkipFailedSummaryAction.class.getName());
  UpgradeGroupEntity postClusterGroup=upgradeGroups.get(1);
  assertEquals("POST_CLUSTER",postClusterGroup.getName());
  List<UpgradeItemEntity> postClusterUpgradeItems=postClusterGroup.getItems();
  assertEquals(1,postClusterUpgradeItems.size());
  assertEquals("Save Cluster State",postClusterUpgradeItems.get(0).getText());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetry() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"ABORTED");
  UpgradeResourceProvider urp=createProvider(amc);
  Request req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
  ActionManager am=injector.getInstance(ActionManager.class);
  List<HostRoleCommand> commands=am.getRequestTasks(id);
  boolean foundOne=false;
  for (  HostRoleCommand hrc : commands) {
    if (hrc.getRole().equals(Role.AMBARI_SERVER_ACTION)) {
      assertEquals(-1L,hrc.getHostId());
      assertNull(hrc.getHostName());
      foundOne=true;
    }
  }
  assertTrue("Expected at least one server-side action",foundOne);
  HostRoleCommand cmd=commands.get(commands.size() - 1);
  HostRoleCommandDAO dao=injector.getInstance(HostRoleCommandDAO.class);
  HostRoleCommandEntity entity=dao.findByPK(cmd.getTaskId());
  entity.setStatus(HostRoleStatus.ABORTED);
  dao.merge(entity);
  requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"PENDING");
  req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testCreateCrossStackUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackId oldStack=cluster.getDesiredStackVersion();
  for (  Service s : cluster.getServices().values()) {
    assertEquals(oldStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(oldStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(oldStack,sch.getDesiredStackVersion());
      }
    }
  }
  Config config=new ConfigImpl("zoo.cfg");
  config.setProperties(new HashMap<String,String>(){
{
      put("a","b");
    }
  }
);
  config.setTag("abcdefg");
  cluster.addConfig(config);
  cluster.addDesiredConfig("admin",Collections.singleton(config));
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test_nonrolling");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  assertEquals(5,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  assertEquals(1,group.getItems().size());
  group=upgrade.getUpgradeGroups().get(0);
  assertEquals(1,group.getItems().size());
  assertTrue(cluster.getDesiredConfigs().containsKey("zoo.cfg"));
  StackId newStack=cluster.getDesiredStackVersion();
  assertFalse(oldStack.equals(newStack));
  for (  Service s : cluster.getServices().values()) {
    assertEquals(newStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(newStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(newStack,sch.getDesiredStackVersion());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPercents() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  StageDAO stageDao=injector.getInstance(StageDAO.class);
  HostRoleCommandDAO hrcDao=injector.getInstance(HostRoleCommandDAO.class);
  List<StageEntity> stages=stageDao.findByRequestId(id);
  List<HostRoleCommandEntity> tasks=hrcDao.findByRequest(id);
  Set<Long> stageIds=new HashSet<Long>();
  for (  StageEntity se : stages) {
    stageIds.add(se.getStageId());
  }
  CalculatedStatus calc=null;
  int i=0;
  for (  HostRoleCommandEntity hrce : tasks) {
    hrce.setStatus(HostRoleStatus.IN_PROGRESS);
    hrcDao.merge(hrce);
    calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
    assertEquals(((i++) + 1) * 4.375d,calc.getPercent(),0.01d);
    assertEquals(HostRoleStatus.IN_PROGRESS,calc.getStatus());
  }
  i=0;
  for (  HostRoleCommandEntity hrce : tasks) {
    hrce.setStatus(HostRoleStatus.COMPLETED);
    hrcDao.merge(hrce);
    calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
    assertEquals(35 + (((i++) + 1) * 8.125),calc.getPercent(),0.01d);
    if (i < 8) {
      assertEquals(HostRoleStatus.IN_PROGRESS,calc.getStatus());
    }
  }
  calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
  assertEquals(HostRoleStatus.COMPLETED,calc.getStatus());
  assertEquals(100d,calc.getPercent(),0.01d);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests merging configurations between existing and new stack values on
 * upgrade.
 * @throws Exception
 */
@Test public void testMergeConfigurations() throws Exception {
  StackId stack211=new StackId("HDP-2.1.1");
  StackId stack220=new StackId("HDP-2.2.0");
  Map<String,Map<String,String>> stack211Configs=new HashMap<String,Map<String,String>>();
  Map<String,String> stack211FooType=new HashMap<String,String>();
  Map<String,String> stack211BarType=new HashMap<String,String>();
  Map<String,String> stack211BazType=new HashMap<String,String>();
  stack211Configs.put("foo-site",stack211FooType);
  stack211Configs.put("bar-site",stack211BarType);
  stack211Configs.put("baz-site",stack211BazType);
  stack211FooType.put("1","one");
  stack211FooType.put("11","one-one");
  stack211BarType.put("2","two");
  stack211BazType.put("3","three");
  Map<String,Map<String,String>> stack220Configs=new HashMap<String,Map<String,String>>();
  Map<String,String> stack220FooType=new HashMap<String,String>();
  Map<String,String> stack220BazType=new HashMap<String,String>();
  Map<String,String> stack220FlumeEnvType=new HashMap<String,String>();
  stack220Configs.put("foo-site",stack220FooType);
  stack220Configs.put("baz-site",stack220BazType);
  stack220Configs.put("flume-env",stack220FlumeEnvType);
  stack220FooType.put("1","one-new");
  stack220FooType.put("111","one-one-one");
  stack220BazType.put("3","three-new");
  stack220FlumeEnvType.put("flume_env_key","flume-env-value");
  Map<String,String> clusterFooType=new HashMap<String,String>();
  Map<String,String> clusterBarType=new HashMap<String,String>();
  Map<String,String> clusterBazType=new HashMap<String,String>();
  Config fooConfig=EasyMock.createNiceMock(Config.class);
  Config barConfig=EasyMock.createNiceMock(Config.class);
  Config bazConfig=EasyMock.createNiceMock(Config.class);
  clusterFooType.put("1","one");
  clusterFooType.put("11","one-one");
  clusterBarType.put("2","two");
  clusterBazType.put("3","three-changed");
  expect(fooConfig.getProperties()).andReturn(clusterFooType);
  expect(barConfig.getProperties()).andReturn(clusterBarType);
  expect(bazConfig.getProperties()).andReturn(clusterBazType);
  Map<String,DesiredConfig> desiredConfigurations=new HashMap<String,DesiredConfig>();
  desiredConfigurations.put("foo-site",null);
  desiredConfigurations.put("bar-site",null);
  desiredConfigurations.put("baz-site",null);
  Cluster cluster=EasyMock.createNiceMock(Cluster.class);
  expect(cluster.getCurrentStackVersion()).andReturn(stack211);
  expect(cluster.getDesiredStackVersion()).andReturn(stack220);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigurations);
  expect(cluster.getDesiredConfigByType("foo-site")).andReturn(fooConfig);
  expect(cluster.getDesiredConfigByType("bar-site")).andReturn(barConfig);
  expect(cluster.getDesiredConfigByType("baz-site")).andReturn(bazConfig);
  EasyMock.reset(configHelper);
  expect(configHelper.getDefaultProperties(EasyMock.eq(stack211),EasyMock.anyObject(Cluster.class))).andReturn(stack211Configs).anyTimes();
  expect(configHelper.getDefaultProperties(EasyMock.eq(stack220),EasyMock.anyObject(Cluster.class))).andReturn(stack220Configs).anyTimes();
  Capture<Map<String,Map<String,String>>> expectedConfigurationsCapture=new Capture<Map<String,Map<String,String>>>();
  configHelper.createConfigTypes(EasyMock.anyObject(Cluster.class),EasyMock.anyObject(AmbariManagementController.class),EasyMock.capture(expectedConfigurationsCapture),EasyMock.anyObject(String.class),EasyMock.anyObject(String.class));
  EasyMock.expectLastCall().once();
  EasyMock.replay(configHelper,cluster,fooConfig,barConfig,bazConfig);
  UpgradeResourceProvider upgradeResourceProvider=createProvider(amc);
  Map<String,UpgradePack> upgradePacks=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  UpgradePack upgrade=upgradePacks.get("upgrade_to_new_stack");
  upgradeResourceProvider.applyStackAndProcessConfigurations(stack211.getStackName(),cluster,"2.2.0.0",Direction.UPGRADE,upgrade,"admin");
  Map<String,Map<String,String>> expectedConfigurations=expectedConfigurationsCapture.getValue();
  Map<String,String> expectedFooType=expectedConfigurations.get("foo-site");
  Map<String,String> expectedBarType=expectedConfigurations.get("bar-site");
  Map<String,String> expectedBazType=expectedConfigurations.get("baz-site");
  assertFalse(expectedConfigurations.containsKey("flume-env"));
  assertEquals("one-new",expectedFooType.get("1"));
  assertEquals("one-one",expectedFooType.get("11"));
  assertEquals("two",expectedBarType.get("2"));
  assertEquals("three-changed",expectedBazType.get("3"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("Upgrade");
  Predicate predicate=new PredicateBuilder().property(UpgradeResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Set<Resource> resources=upgradeResourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("Upgrade/progress_percent"));
  assertNotNull(res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(Direction.UPGRADE,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES));
  assertEquals(UpgradeType.ROLLING,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_TYPE));
  propertyIds.clear();
  propertyIds.add("UpgradeGroup");
  predicate=new PredicateBuilder().property(UpgradeGroupResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeGroupResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeGroupResourceProvider=new UpgradeGroupResourceProvider(amc);
  resources=upgradeGroupResourceProvider.getResources(request,predicate);
  assertEquals(3,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeGroup/status"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/group_id"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/total_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/in_progress_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/completed_task_count"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeItem/status"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("3").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertEquals("Confirm Finalize",res.getPropertyValue("UpgradeItem/context"));
  assertTrue(res.getPropertyValue("UpgradeItem/text").toString().startsWith("Please confirm"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ValidationResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_checkRequestId() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.singleton(ValidationResourceProvider.VALIDATION_ID_PROPERTY_ID);
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  ValidationResourceProvider provider=spy(new ValidationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController));
  StackAdvisorRequest stackAdvisorRequest=mock(StackAdvisorRequest.class);
  Request request=mock(Request.class);
  doReturn(stackAdvisorRequest).when(provider).prepareStackAdvisorRequest(request);
  StackAdvisorHelper saHelper=mock(StackAdvisorHelper.class);
  ValidationResponse response=mock(ValidationResponse.class);
  Version version=mock(Version.class);
  doReturn(3).when(response).getId();
  doReturn(version).when(response).getVersion();
  doReturn(response).when(saHelper).validate(any(StackAdvisorRequest.class));
  ValidationResourceProvider.init(saHelper);
  RequestStatus status=provider.createResources(request);
  Set<Resource> associatedResources=status.getAssociatedResources();
  assertNotNull(associatedResources);
  assertEquals(1,associatedResources.size());
  Resource resource=associatedResources.iterator().next();
  Object requestId=resource.getPropertyValue(ValidationResourceProvider.VALIDATION_ID_PROPERTY_ID);
  assertNotNull(requestId);
  assertEquals(3,requestId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ViewInstanceResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToResource() throws Exception {
  ViewInstanceResourceProvider provider=new ViewInstanceResourceProvider();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ViewInstanceResourceProvider.PROPERTIES_PROPERTY_ID);
  propertyIds.add(ViewInstanceResourceProvider.CLUSTER_HANDLE_PROPERTY_ID);
  ViewInstanceEntity viewInstanceEntity=createNiceMock(ViewInstanceEntity.class);
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  expect(viewInstanceEntity.getViewEntity()).andReturn(viewEntity).anyTimes();
  Map<String,String> propertyMap=new HashMap<String,String>();
  propertyMap.put("par1","val1");
  propertyMap.put("par2","val2");
  expect(viewInstanceEntity.getPropertyMap()).andReturn(propertyMap);
  expect(viewInstanceEntity.getData()).andReturn(Collections.<ViewInstanceDataEntity>emptyList()).anyTimes();
  expect(singleton.checkAdmin()).andReturn(true);
  expect(singleton.checkAdmin()).andReturn(false);
  expect(viewInstanceEntity.getClusterHandle()).andReturn("c1");
  replay(singleton,viewEntity,viewInstanceEntity);
  Resource resource=provider.toResource(viewInstanceEntity,propertyIds);
  Map<String,Map<String,Object>> properties=resource.getPropertiesMap();
  assertEquals(2,properties.size());
  Map<String,Object> props=properties.get("ViewInstanceInfo");
  assertNotNull(props);
  assertEquals(1,props.size());
  assertEquals("c1",props.get("cluster_handle"));
  props=properties.get("ViewInstanceInfo/properties");
  assertNotNull(props);
  assertEquals(2,props.size());
  assertEquals("val1",props.get("par1"));
  assertEquals("val2",props.get("par2"));
  resource=provider.toResource(viewInstanceEntity,propertyIds);
  properties=resource.getPropertiesMap();
  props=properties.get("ViewInstanceInfo/properties");
  assertNull(props);
  verify(singleton,viewEntity,viewInstanceEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ViewPermissionResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  List<PermissionEntity> permissionEntities=new LinkedList<PermissionEntity>();
  PermissionEntity permissionEntity=createNiceMock(PermissionEntity.class);
  PermissionEntity viewUsePermissionEntity=createNiceMock(PermissionEntity.class);
  ResourceTypeEntity resourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  ViewEntity viewEntity=createMock(ViewEntity.class);
  permissionEntities.add(permissionEntity);
  expect(dao.findViewUsePermission()).andReturn(viewUsePermissionEntity);
  expect(dao.findAll()).andReturn(Collections.singletonList(permissionEntity));
  expect(permissionEntity.getId()).andReturn(99);
  expect(permissionEntity.getPermissionName()).andReturn("P1");
  expect(permissionEntity.getResourceType()).andReturn(resourceTypeEntity);
  expect(resourceTypeEntity.getName()).andReturn("V1");
  expect(viewEntity.isDeployed()).andReturn(true).anyTimes();
  expect(viewEntity.getCommonName()).andReturn("V1").anyTimes();
  expect(viewEntity.getVersion()).andReturn("1.0.0").anyTimes();
  expect(viewRegistry.getDefinition(resourceTypeEntity)).andReturn(viewEntity);
  replay(dao,permissionEntity,viewUsePermissionEntity,resourceTypeEntity,viewEntity,viewRegistry);
  ViewPermissionResourceProvider provider=new ViewPermissionResourceProvider();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals(99,resource.getPropertyValue(PermissionResourceProvider.PERMISSION_ID_PROPERTY_ID));
  Assert.assertEquals("P1",resource.getPropertyValue(PermissionResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("V1",resource.getPropertyValue(PermissionResourceProvider.RESOURCE_NAME_PROPERTY_ID));
  verify(dao,permissionEntity,viewUsePermissionEntity,resourceTypeEntity,viewEntity,viewRegistry);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ViewPrivilegeResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources() throws Exception {
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=ViewInstanceEntityTest.getViewInstanceEntity();
  viewDefinition.addInstanceDefinition(viewInstanceDefinition);
  viewInstanceDefinition.setViewEntity(viewDefinition);
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYED);
  ViewRegistry registry=ViewRegistry.getInstance();
  registry.addDefinition(viewDefinition);
  registry.addInstanceDefinition(viewDefinition,viewInstanceDefinition);
  List<PrivilegeEntity> privilegeEntities=new LinkedList<PrivilegeEntity>();
  PrivilegeEntity privilegeEntity=createNiceMock(PrivilegeEntity.class);
  ResourceEntity resourceEntity=createNiceMock(ResourceEntity.class);
  UserEntity userEntity=createNiceMock(UserEntity.class);
  PrincipalEntity principalEntity=createNiceMock(PrincipalEntity.class);
  PrincipalTypeEntity principalTypeEntity=createNiceMock(PrincipalTypeEntity.class);
  PermissionEntity permissionEntity=createNiceMock(PermissionEntity.class);
  List<PrincipalEntity> principalEntities=new LinkedList<PrincipalEntity>();
  principalEntities.add(principalEntity);
  List<UserEntity> userEntities=new LinkedList<UserEntity>();
  userEntities.add(userEntity);
  privilegeEntities.add(privilegeEntity);
  expect(privilegeDAO.findAll()).andReturn(privilegeEntities);
  expect(privilegeEntity.getResource()).andReturn(resourceEntity).anyTimes();
  expect(privilegeEntity.getPrincipal()).andReturn(principalEntity).anyTimes();
  expect(privilegeEntity.getPermission()).andReturn(permissionEntity).anyTimes();
  expect(resourceEntity.getId()).andReturn(20L).anyTimes();
  expect(principalEntity.getId()).andReturn(20L).anyTimes();
  expect(userEntity.getPrincipal()).andReturn(principalEntity).anyTimes();
  expect(userEntity.getUserName()).andReturn("joe").anyTimes();
  expect(permissionEntity.getPermissionName()).andReturn("VIEW.USER").anyTimes();
  expect(permissionEntity.getPermissionLabel()).andReturn("View User").anyTimes();
  expect(principalEntity.getPrincipalType()).andReturn(principalTypeEntity).anyTimes();
  expect(principalTypeEntity.getName()).andReturn("USER").anyTimes();
  expect(permissionDAO.findById(PermissionEntity.VIEW_USER_PERMISSION)).andReturn(permissionEntity);
  expect(userDAO.findUsersByPrincipal(principalEntities)).andReturn(userEntities);
  expect(groupDAO.findGroupsByPrincipal(principalEntities)).andReturn(Collections.<GroupEntity>emptyList());
  replay(privilegeDAO,userDAO,groupDAO,principalDAO,permissionDAO,resourceDAO,privilegeEntity,resourceEntity,userEntity,principalEntity,permissionEntity,principalTypeEntity);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  PrivilegeResourceProvider provider=new ViewPrivilegeResourceProvider();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("VIEW.USER",resource.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_NAME_PROPERTY_ID));
  Assert.assertEquals("View User",resource.getPropertyValue(AmbariPrivilegeResourceProvider.PERMISSION_LABEL_PROPERTY_ID));
  Assert.assertEquals("joe",resource.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_NAME_PROPERTY_ID));
  Assert.assertEquals("USER",resource.getPropertyValue(AmbariPrivilegeResourceProvider.PRINCIPAL_TYPE_PROPERTY_ID));
  verify(privilegeDAO,userDAO,groupDAO,principalDAO,permissionDAO,resourceDAO,privilegeEntity,resourceEntity,userEntity,principalEntity,permissionEntity,principalTypeEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetLayoutResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testGetSingleResource() throws Exception {
  Request request=PropertyHelper.getReadRequest(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID);
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getClusterById(1L)).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  Predicate predicate=new PredicateBuilder().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID).equals("1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID).equals("username").toPredicate();
  expect(dao.findById(1L)).andReturn(getMockEntities().get(0));
  replay(amc,clusters,cluster,dao);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Set<Resource> results=provider.getResources(request,predicate);
  assertEquals(1,results.size());
  Resource r=results.iterator().next();
  Assert.assertEquals("section0",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID));
  Assert.assertEquals("CLUSTER",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID));
  Assert.assertEquals("username",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID));
  Assert.assertEquals("displ_name",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID));
  Assert.assertEquals("layout name0",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID));
  Assert.assertEquals("[]",r.getPropertyValue(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID).toString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  WidgetEntity widgetEntity=new WidgetEntity();
  widgetEntity.setId(1l);
  widgetEntity.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  expect(widgetDAO.findById(anyLong())).andReturn(widgetEntity).anyTimes();
  replay(amc,clusters,cluster,dao,widgetDAO);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  Map<String,String> widget=new HashMap<String,String>();
  widget.put("id","1");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("CLUSTER",entity.getScope());
  Assert.assertEquals("layout_name",entity.getLayoutName());
  Assert.assertEquals("display_name",entity.getDisplayName());
  Assert.assertEquals("section_name",entity.getSectionName());
  Assert.assertEquals("admin",entity.getUserName());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0));
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0).getWidget().getListWidgetLayoutUserWidgetEntity());
  verify(amc,clusters,cluster,dao,widgetDAO);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testGetSingleResource() throws Exception {
  Request request=PropertyHelper.getReadRequest(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID,WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,WidgetResourceProvider.WIDGET_TIME_CREATED_PROPERTY_ID,WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,WidgetResourceProvider.WIDGET_DESCRIPTION_PROPERTY_ID,WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID);
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getClusterById(1L)).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  Predicate predicate=new PredicateBuilder().property(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID).equals("1").and().property(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID).equals("username").toPredicate();
  expect(dao.findById(1L)).andReturn(getMockEntities("CLUSTER").get(0));
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Set<Resource> results=provider.getResources(request,predicate);
  assertEquals(1,results.size());
  Resource r=results.iterator().next();
  Assert.assertEquals("GAUGE",r.getPropertyValue(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID));
  Assert.assertEquals("CLUSTER",r.getPropertyValue(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID));
  Assert.assertEquals("username",r.getPropertyValue(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID));
  Assert.assertEquals("widget name",r.getPropertyValue(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID));
  Object metrics=r.getPropertyValue(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID);
  Assert.assertEquals("[{\"widget_id\":\"metrics/jvm/HeapMemoryUsed\"," + "\"host_component_criteria\":\"host_components/metrics/dfs/FSNamesystem/HAState\\u003dactive\"," + "\"service_name\":\"HDFS\",\"component_name\":\"NAMENODE\","+ "\"name\":\"java.lang:type\\u003dMemory.HeapMemoryUsage[used]\",\"category\":\"\"},"+ "{\"widget_id\":\"metrics/jvm/HeapMemoryMax\","+ "\"host_component_criteria\":\"host_components/metrics/dfs/FSNamesystem/HAState\\u003dactive\","+ "\"service_name\":\"HDFS\",\"component_name\":\"NAMENODE\","+ "\"name\":\"java.lang:type\\u003dMemory.HeapMemoryUsage[max]\","+ "\"category\":\"\"}]",r.getPropertyValue(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID));
  Assert.assertEquals("[{\"name\":\"NameNode Heap\"," + "\"value\":\"${java.lang:type\\u003dMemory.HeapMemoryUsage[used] / " + "java.lang:type\\u003dMemory.HeapMemoryUsage[max]}\"}]",r.getPropertyValue(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID));
  Assert.assertEquals("{\"name\":\"value\"}",r.getPropertyValue(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("USER",entity.getScope());
  Assert.assertEquals("widget name",entity.getWidgetName());
  Assert.assertEquals(null,entity.getDefaultSectionName());
  Assert.assertEquals("GAUGE",entity.getWidgetType());
  Assert.assertEquals("admin",entity.getAuthor());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getMetrics());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getWidgetValues());
  Assert.assertEquals("{\"property2\":\"value2\",\"property1\":\"value1\"}",entity.getProperties());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WorkflowResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createWorkflowResponse("Cluster100","workflow1"));
  expected.add(createWorkflowResponse("Cluster100","workflow2"));
  expected.add(createWorkflowResponse("Cluster100","workflow3"));
  Resource.Type type=Resource.Type.Workflow;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  WorkflowFetcher workflowFetcher=createMock(WorkflowFetcher.class);
  expect(workflowFetcher.fetchWorkflows(propertyIds,"Cluster100",null)).andReturn(expected).once();
  replay(workflowFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new WorkflowResourceProvider(propertyIds,keyPropertyIds,workflowFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(WorkflowResourceProvider.WORKFLOW_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID)));
  }
  verify(workflowFetcher);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWorkflowFetcher() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<String> requestedIds=new HashSet<String>();
  requestedIds.add(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(Resource.Type.Workflow);
  ResourceProvider provider=new TestWorkflowResourceProvider(requestedIds,keyPropertyIds);
  Request request=PropertyHelper.getReadRequest(requestedIds);
  Predicate predicate=new PredicateBuilder().property(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID).equals("workflow1").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    String workflowId=(String)resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID);
    Assert.assertEquals("workflow1",workflowId);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.ivory.ClusterTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetLocations() throws Exception {
  Cluster.Location location=new Cluster.Location("name","path");
  Cluster cluster=new Cluster("Cluster1","Colo",Collections.singleton(new Cluster.Interface("type","endpoint","version")),Collections.singleton(location),Collections.singletonMap("P1","V1"));
  Assert.assertEquals(Collections.singleton(location),cluster.getLocations());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInterfaces() throws Exception {
  Cluster.Interface interface1=new Cluster.Interface("type","endpoint","version");
  Cluster cluster=new Cluster("Cluster1","Colo",Collections.singleton(interface1),Collections.singleton(new Cluster.Location("name","path")),Collections.singletonMap("P1","V1"));
  Assert.assertEquals(Collections.singleton(interface1),cluster.getInterfaces());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.ganglia.GangliaReportPropertyProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider("temporal_ganglia_report_data.json");
  TestGangliaHostProvider hostProvider=new TestGangliaHostProvider();
  GangliaReportPropertyProvider propertyProvider=new GangliaReportPropertyProvider(PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster),streamProvider,configuration,hostProvider,CLUSTER_NAME_PROPERTY_ID);
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID,new TemporalInfoImpl(10L,20L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID),temporalInfoMap);
  Assert.assertEquals(1,propertyProvider.populateResources(Collections.singleton(resource),request,null).size());
  String expected=(configuration.isGangliaSSL() ? "https" : "http") + "://domU-12-31-39-0E-34-E1.compute-1.internal/ganglia/graph.php?g=load_report&json=1";
  Assert.assertEquals(expected,streamProvider.getLastSpec());
  Assert.assertEquals(2,PropertyHelper.getProperties(resource).size());
  Assert.assertNotNull(resource.getPropertyValue(PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.AMSReportPropertyProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(SINGLE_HOST_METRICS_FILE_PATH);
  injectCacheEntryFactoryWithStreamProvider(streamProvider);
  TestMetricHostProvider metricHostProvider=new TestMetricHostProvider();
  ComponentSSLConfiguration sslConfiguration=mock(ComponentSSLConfiguration.class);
  Map<String,Map<String,PropertyInfo>> propertyIds=PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster);
  AMSReportPropertyProvider propertyProvider=new AMSReportPropertyProvider(propertyIds,streamProvider,sslConfiguration,cacheProvider,metricHostProvider,CLUSTER_NAME_PROPERTY_ID);
  String propertyId=PropertyHelper.getPropertyId("metrics/cpu","User");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(propertyId,new TemporalInfoImpl(1416445244800L,1416448936474L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(propertyId),temporalInfoMap);
  Set<Resource> resources=propertyProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertEquals(1,resources.size());
  Resource res=resources.iterator().next();
  Map<String,Object> properties=PropertyHelper.getProperties(resources.iterator().next());
  Assert.assertNotNull(properties);
  URIBuilder uriBuilder=AMSPropertyProvider.getAMSUriBuilder("localhost",8188);
  uriBuilder.addParameter("metricNames","cpu_user");
  uriBuilder.addParameter("appId","HOST");
  uriBuilder.addParameter("startTime","1416445244800");
  uriBuilder.addParameter("endTime","1416448936474");
  Assert.assertEquals(uriBuilder.toString(),streamProvider.getLastSpec());
  Number[][] val=(Number[][])res.getPropertyValue("metrics/cpu/User");
  Assert.assertEquals(111,val.length);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResourceWithAggregateFunction() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(AGGREGATE_CLUSTER_METRICS_FILE_PATH);
  injectCacheEntryFactoryWithStreamProvider(streamProvider);
  TestMetricHostProvider metricHostProvider=new TestMetricHostProvider();
  ComponentSSLConfiguration sslConfiguration=mock(ComponentSSLConfiguration.class);
  Map<String,Map<String,PropertyInfo>> propertyIds=PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster);
  AMSReportPropertyProvider propertyProvider=new AMSReportPropertyProvider(propertyIds,streamProvider,sslConfiguration,cacheProvider,metricHostProvider,CLUSTER_NAME_PROPERTY_ID);
  String propertyId=PropertyHelper.getPropertyId("metrics/cpu","User._sum");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(propertyId,new TemporalInfoImpl(1432033257812L,1432035927922L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(propertyId),temporalInfoMap);
  Set<Resource> resources=propertyProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertEquals(1,resources.size());
  Resource res=resources.iterator().next();
  Map<String,Object> properties=PropertyHelper.getProperties(resources.iterator().next());
  Assert.assertNotNull(properties);
  URIBuilder uriBuilder=AMSPropertyProvider.getAMSUriBuilder("localhost",8188);
  uriBuilder.addParameter("metricNames","cpu_user._sum");
  uriBuilder.addParameter("appId","HOST");
  uriBuilder.addParameter("startTime","1432033257812");
  uriBuilder.addParameter("endTime","1432035927922");
  Assert.assertEquals(uriBuilder.toString(),streamProvider.getLastSpec());
  Number[][] val=(Number[][])res.getPropertyValue("metrics/cpu/User._sum");
  Assert.assertEquals(90,val.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.cache.TimelineMetricCacheTest </h4><pre class="type-4 type-2 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimelineMetricCacheProviderGets() throws Exception {
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getMetricCacheTTLSeconds()).andReturn(3600);
  expect(configuration.getMetricCacheIdleSeconds()).andReturn(100);
  expect(configuration.getMetricsCacheManagerHeapPercent()).andReturn("10%").anyTimes();
  replay(configuration);
  final long now=System.currentTimeMillis();
  TimelineMetrics metrics=new TimelineMetrics();
  TimelineMetric timelineMetric=new TimelineMetric();
  timelineMetric.setMetricName("cpu_user");
  timelineMetric.setAppId("app1");
  TreeMap<Long,Double> metricValues=new TreeMap<Long,Double>();
  metricValues.put(now + 100,1.0);
  metricValues.put(now + 200,2.0);
  metricValues.put(now + 300,3.0);
  timelineMetric.setMetricValues(metricValues);
  metrics.getMetrics().add(timelineMetric);
  TimelineMetricCacheEntryFactory cacheEntryFactory=createMock(TimelineMetricCacheEntryFactory.class);
  TimelineAppMetricCacheKey queryKey=new TimelineAppMetricCacheKey(Collections.singleton("cpu_user"),"app1",new TemporalInfoImpl(now,now + 1000,1));
  TimelineMetricsCacheValue value=new TimelineMetricsCacheValue(now,now + 1000,metrics,null);
  TimelineAppMetricCacheKey testKey=new TimelineAppMetricCacheKey(Collections.singleton("cpu_user"),"app1",new TemporalInfoImpl(now,now + 2000,1));
  expect(cacheEntryFactory.createEntry(anyObject())).andReturn(value);
  cacheEntryFactory.updateEntryValue(testKey,value);
  expectLastCall().once();
  replay(cacheEntryFactory);
  TimelineMetricCacheProvider cacheProvider=createMockBuilder(TimelineMetricCacheProvider.class).addMockedMethod("createCacheConfiguration").withConstructor(configuration,cacheEntryFactory).createNiceMock();
  expect(cacheProvider.createCacheConfiguration()).andReturn(createTestCacheConfiguration(configuration)).anyTimes();
  replay(cacheProvider);
  TimelineMetricCache cache=cacheProvider.getTimelineMetricsCache();
  metrics=cache.getAppTimelineMetricsFromCache(queryKey);
  List<TimelineMetric> metricsList=metrics.getMetrics();
  Assert.assertEquals(1,metricsList.size());
  TimelineMetric metric=metricsList.iterator().next();
  Assert.assertEquals("cpu_user",metric.getMetricName());
  Assert.assertEquals("app1",metric.getAppId());
  Assert.assertSame(metricValues,metric.getMetricValues());
  metrics=cache.getAppTimelineMetricsFromCache(testKey);
  metricsList=metrics.getMetrics();
  Assert.assertEquals(1,metricsList.size());
  Assert.assertEquals("cpu_user",metric.getMetricName());
  Assert.assertEquals("app1",metric.getAppId());
  Assert.assertSame(metricValues,metric.getMetricValues());
  verify(configuration,cacheEntryFactory);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimelineMetricCacheTimeseriesUpdates() throws Exception {
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getMetricsRequestConnectTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestIntervalReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricRequestBufferTimeCatchupInterval()).andReturn(0l);
  replay(configuration);
  TimelineMetricCacheEntryFactory factory=createMockBuilder(TimelineMetricCacheEntryFactory.class).withConstructor(configuration).createMock();
  replay(factory);
  long now=System.currentTimeMillis();
  final TimelineMetric timelineMetric1=new TimelineMetric();
  timelineMetric1.setMetricName("cpu_user");
  timelineMetric1.setAppId("app1");
  TreeMap<Long,Double> metricValues=new TreeMap<Long,Double>();
  metricValues.put(now - 100,1.0);
  metricValues.put(now - 200,2.0);
  metricValues.put(now - 300,3.0);
  timelineMetric1.setMetricValues(metricValues);
  final TimelineMetric timelineMetric2=new TimelineMetric();
  timelineMetric2.setMetricName("cpu_nice");
  timelineMetric2.setAppId("app1");
  metricValues=new TreeMap<Long,Double>();
  metricValues.put(now + 400,1.0);
  metricValues.put(now + 500,2.0);
  metricValues.put(now + 600,3.0);
  timelineMetric2.setMetricValues(metricValues);
  TimelineMetrics existingMetrics=new TimelineMetrics();
  existingMetrics.getMetrics().add(timelineMetric1);
  existingMetrics.getMetrics().add(timelineMetric2);
  TimelineMetricsCacheValue existingMetricValue=new TimelineMetricsCacheValue(now - 1000,now + 1000,existingMetrics,null);
  TimelineMetrics newMetrics=new TimelineMetrics();
  TimelineMetric timelineMetric3=new TimelineMetric();
  timelineMetric3.setMetricName("cpu_user");
  timelineMetric3.setAppId("app1");
  metricValues=new TreeMap<Long,Double>();
  metricValues.put(now + 1400,1.0);
  metricValues.put(now + 1500,2.0);
  metricValues.put(now + 1600,3.0);
  timelineMetric3.setMetricValues(metricValues);
  newMetrics.getMetrics().add(timelineMetric3);
  factory.updateTimelineMetricsInCache(newMetrics,existingMetricValue,now,now + 2000,false);
  Assert.assertEquals(2,existingMetricValue.getTimelineMetrics().getMetrics().size());
  TimelineMetric newMetric1=null;
  TimelineMetric newMetric2=null;
  for (  TimelineMetric metric : existingMetricValue.getTimelineMetrics().getMetrics()) {
    if (metric.getMetricName().equals("cpu_user")) {
      newMetric1=metric;
    }
    if (metric.getMetricName().equals("cpu_nice")) {
      newMetric2=metric;
    }
  }
  Assert.assertNotNull(newMetric1);
  Assert.assertNotNull(newMetric2);
  Assert.assertEquals(3,newMetric1.getMetricValues().size());
  Assert.assertEquals(3,newMetric2.getMetricValues().size());
  Map<Long,Double> newMetricsMap=newMetric1.getMetricValues();
  Iterator<Long> metricKeyIterator=newMetricsMap.keySet().iterator();
  Assert.assertEquals(now + 1400,metricKeyIterator.next().longValue());
  Assert.assertEquals(now + 1500,metricKeyIterator.next().longValue());
  Assert.assertEquals(now + 1600,metricKeyIterator.next().longValue());
  verify(configuration,factory);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimelineMetricCachePrecisionUpdates() throws Exception {
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getMetricCacheTTLSeconds()).andReturn(3600);
  expect(configuration.getMetricCacheIdleSeconds()).andReturn(100);
  expect(configuration.getMetricsCacheManagerHeapPercent()).andReturn("10%").anyTimes();
  expect(configuration.getMetricRequestBufferTimeCatchupInterval()).andReturn(1000l).anyTimes();
  replay(configuration);
  final long now=System.currentTimeMillis();
  long second=1000;
  long min=60 * second;
  long hour=60 * min;
  long day=24 * hour;
  long year=365 * day;
  Map<String,TimelineMetric> valueMap=new HashMap<String,TimelineMetric>();
  TimelineMetric timelineMetric=new TimelineMetric();
  timelineMetric.setMetricName("cpu_user");
  timelineMetric.setAppId("app1");
  TreeMap<Long,Double> metricValues=new TreeMap<Long,Double>();
  for (long i=1 * year - 1 * day; i >= 0; i-=1 * day) {
    metricValues.put(now - i,1.0);
  }
  timelineMetric.setMetricValues(metricValues);
  valueMap.put("cpu_user",timelineMetric);
  List<TimelineMetric> timelineMetricList=new ArrayList<>();
  timelineMetricList.add(timelineMetric);
  TimelineMetrics metrics=new TimelineMetrics();
  metrics.setMetrics(timelineMetricList);
  TimelineAppMetricCacheKey key=new TimelineAppMetricCacheKey(Collections.singleton("cpu_user"),"app1",new TemporalInfoImpl(now - 1 * year,now,1));
  key.setSpec("");
  Map<String,TimelineMetric> newValueMap=new HashMap<String,TimelineMetric>();
  TimelineMetric newTimelineMetric=new TimelineMetric();
  newTimelineMetric.setMetricName("cpu_user");
  newTimelineMetric.setAppId("app1");
  TreeMap<Long,Double> newMetricValues=new TreeMap<Long,Double>();
  for (long i=1 * hour; i <= 2 * day; i+=hour) {
    newMetricValues.put(now - 1 * day + i,2.0);
  }
  newTimelineMetric.setMetricValues(newMetricValues);
  newValueMap.put("cpu_user",newTimelineMetric);
  List<TimelineMetric> newTimelineMetricList=new ArrayList<>();
  newTimelineMetricList.add(newTimelineMetric);
  TimelineMetrics newMetrics=new TimelineMetrics();
  newMetrics.setMetrics(newTimelineMetricList);
  TimelineAppMetricCacheKey newKey=new TimelineAppMetricCacheKey(Collections.singleton("cpu_user"),"app1",new TemporalInfoImpl(now - 1 * day,now + 2 * day,1));
  newKey.setSpec("");
  MetricsRequestHelper metricsRequestHelperForGets=createMock(MetricsRequestHelper.class);
  expect(metricsRequestHelperForGets.fetchTimelineMetrics(EasyMock.isA(URIBuilder.class),anyLong(),anyLong())).andReturn(metrics).andReturn(newMetrics);
  replay(metricsRequestHelperForGets);
  TimelineMetricCacheEntryFactory cacheEntryFactory=createMockBuilder(TimelineMetricCacheEntryFactory.class).withConstructor(configuration).createMock();
  Field requestHelperField=TimelineMetricCacheEntryFactory.class.getDeclaredField("requestHelperForGets");
  requestHelperField.setAccessible(true);
  requestHelperField.set(cacheEntryFactory,metricsRequestHelperForGets);
  requestHelperField=TimelineMetricCacheEntryFactory.class.getDeclaredField("requestHelperForUpdates");
  requestHelperField.setAccessible(true);
  requestHelperField.set(cacheEntryFactory,metricsRequestHelperForGets);
  replay(cacheEntryFactory);
  TimelineMetricCacheProvider cacheProvider=createMockBuilder(TimelineMetricCacheProvider.class).addMockedMethod("createCacheConfiguration").withConstructor(configuration,cacheEntryFactory).createNiceMock();
  expect(cacheProvider.createCacheConfiguration()).andReturn(createTestCacheConfiguration(configuration)).anyTimes();
  replay(cacheProvider);
  TimelineMetricCache cache=cacheProvider.getTimelineMetricsCache();
  metrics=cache.getAppTimelineMetricsFromCache(key);
  List<TimelineMetric> metricsList=metrics.getMetrics();
  Assert.assertEquals(1,metricsList.size());
  TimelineMetric metric=metricsList.iterator().next();
  Assert.assertEquals("cpu_user",metric.getMetricName());
  Assert.assertEquals("app1",metric.getAppId());
  Assert.assertEquals(metricValues,metric.getMetricValues());
  metrics=cache.getAppTimelineMetricsFromCache(newKey);
  metricsList=metrics.getMetrics();
  Assert.assertEquals(1,metricsList.size());
  Assert.assertEquals("cpu_user",metric.getMetricName());
  Assert.assertEquals("app1",metric.getAppId());
  Assert.assertEquals(newMetricValues,metric.getMetricValues());
  verify(configuration,metricsRequestHelperForGets,cacheEntryFactory);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("all") public void testCacheUpdateBoundsOnVariousRequestScenarios() throws Exception {
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getMetricsRequestConnectTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestIntervalReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricRequestBufferTimeCatchupInterval()).andReturn(0l);
  replay(configuration);
  TimelineMetricCacheEntryFactory factory=createMockBuilder(TimelineMetricCacheEntryFactory.class).withConstructor(configuration).createMock();
  replay(factory);
  long now=System.currentTimeMillis();
  final long existingSeriesStartTime=now - (3600 * 1000);
  final long existingSeriesEndTime=now;
  long requestedStartTime=existingSeriesStartTime + 60000;
  long requestedEndTime=existingSeriesEndTime + 60000;
  long newStartTime=factory.getRefreshRequestStartTime(existingSeriesStartTime,existingSeriesEndTime,requestedStartTime);
  long newEndTime=factory.getRefreshRequestEndTime(existingSeriesStartTime,existingSeriesEndTime,requestedEndTime);
  Assert.assertEquals(existingSeriesEndTime,newStartTime);
  Assert.assertEquals(requestedEndTime,newEndTime);
  requestedStartTime=existingSeriesEndTime + 60000;
  requestedEndTime=existingSeriesEndTime + 60000 + 3600000;
  newStartTime=factory.getRefreshRequestStartTime(existingSeriesStartTime,existingSeriesEndTime,requestedStartTime);
  newEndTime=factory.getRefreshRequestEndTime(existingSeriesStartTime,existingSeriesEndTime,requestedEndTime);
  Assert.assertEquals(requestedStartTime,newStartTime);
  Assert.assertEquals(requestedEndTime,newEndTime);
  requestedStartTime=existingSeriesStartTime - 60000;
  requestedEndTime=existingSeriesEndTime + 60000;
  newStartTime=factory.getRefreshRequestStartTime(existingSeriesStartTime,existingSeriesEndTime,requestedStartTime);
  newEndTime=factory.getRefreshRequestEndTime(existingSeriesStartTime,existingSeriesEndTime,requestedEndTime);
  Assert.assertEquals(requestedStartTime,newStartTime);
  Assert.assertEquals(requestedEndTime,newEndTime);
  requestedStartTime=existingSeriesStartTime - 3600000 - 60000;
  requestedEndTime=existingSeriesStartTime - 60000;
  newStartTime=factory.getRefreshRequestStartTime(existingSeriesStartTime,existingSeriesEndTime,requestedStartTime);
  newEndTime=factory.getRefreshRequestEndTime(existingSeriesStartTime,existingSeriesEndTime,requestedEndTime);
  Assert.assertEquals(requestedStartTime,newStartTime);
  Assert.assertEquals(requestedEndTime,newEndTime);
  requestedStartTime=existingSeriesStartTime + 60000;
  requestedEndTime=existingSeriesEndTime - 60000;
  newStartTime=factory.getRefreshRequestStartTime(existingSeriesStartTime,existingSeriesEndTime,requestedStartTime);
  newEndTime=factory.getRefreshRequestEndTime(existingSeriesStartTime,existingSeriesEndTime,requestedEndTime);
  Assert.assertEquals(newStartTime,existingSeriesEndTime);
  Assert.assertEquals(newEndTime,existingSeriesStartTime);
  verify(configuration,factory);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PredicateBuilderTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").or().property(p2).equals("bar").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").or().property(p2).equals("car").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("fun").or().property(p2).equals("car").toPredicate();
  Assert.assertFalse(predicate3.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAndNot(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().not().property(p2).equals("bar").toPredicate();
  Assert.assertFalse(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().not().property(p2).equals("car").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLongOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").or().property(p2).equals("bar").or().property(p3).equals("cat").or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").or().property(p2).equals("car").or().property(p3).equals("cat").or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("fun").or().property(p2).equals("car").or().property(p3).equals("bat").or().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate3.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAnd(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().property(p2).equals("bar").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("car").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAndOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.property(p1).equals("foo").and().property(p2).equals("bar").or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("car").or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("foo").and().property(p2).equals("bar").or().property(p3).equals("can").toPredicate();
  Assert.assertTrue(predicate3.evaluate(resource));
  PredicateBuilder pb4=new PredicateBuilder();
  Predicate predicate4=pb4.property(p1).equals("foo").and().property(p2).equals("bat").or().property(p3).equals("can").toPredicate();
  Assert.assertFalse(predicate4.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLongAnd(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().property(p2).equals("bar").and().property(p3).equals("cat").and().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("bar").and().property(p3).equals("cat").and().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBlocks(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.begin().property(p1).equals("foo").and().property(p2).equals("bar").end().or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.begin().property(p1).equals("foo").and().property(p2).equals("bat").end().or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.begin().property(p1).equals("foo").and().property(p2).equals("bar").end().or().property(p3).equals("can").toPredicate();
  Assert.assertTrue(predicate3.evaluate(resource));
  PredicateBuilder pb4=new PredicateBuilder();
  Predicate predicate4=pb4.begin().property(p1).equals("foo").and().property(p2).equals("bat").end().or().property(p3).equals("can").toPredicate();
  Assert.assertFalse(predicate4.evaluate(resource));
  PredicateBuilder pb5=new PredicateBuilder();
  Predicate predicate5=pb5.property(p1).equals("foo").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertTrue(predicate5.evaluate(resource));
  PredicateBuilder pb6=new PredicateBuilder();
  Predicate predicate6=pb6.property(p1).equals("foo").and().begin().property(p2).equals("bat").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertTrue(predicate6.evaluate(resource));
  PredicateBuilder pb7=new PredicateBuilder();
  Predicate predicate7=pb7.property(p1).equals("foo").and().begin().property(p2).equals("bat").or().property(p3).equals("can").end().toPredicate();
  Assert.assertFalse(predicate7.evaluate(resource));
  PredicateBuilder pb8=new PredicateBuilder();
  Predicate predicate8=pb8.property(p1).equals("fat").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertFalse(predicate8.evaluate(resource));
  PredicateBuilder pb9=new PredicateBuilder();
  Predicate predicate9=pb9.property(p1).equals("foo").and().not().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertFalse(predicate9.evaluate(resource));
  PredicateBuilder pb10=new PredicateBuilder();
  Predicate predicate10=pb10.property(p1).equals("foo").and().not().begin().property(p2).equals("bat").or().property(p3).equals("car").end().toPredicate();
  Assert.assertTrue(predicate10.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNestedBlocks(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.begin().property(p1).equals("foo").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().end().or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.begin().property(p1).equals("fat").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().end().or().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleNot(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.not().property(p1).equals("foo").toPredicate();
  Assert.assertFalse(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.not().property(p1).equals("bar").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PropertyHelperTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyCategory(){
  String propertyId="metrics/yarn/Queue/$1.replaceAll(\",q(\\d+)=\",\"/\").substring(1)/AppsRunning";
  String category=PropertyHelper.getPropertyCategory(propertyId);
  Assert.assertEquals("metrics/yarn/Queue/$1",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics/yarn/Queue",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics/yarn",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertNull(category);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetCategories(){
  String propertyId="metrics/yarn/Queue/$1.replaceAll(\",q(\\d+)=\",\"/\").substring(1)/AppsRunning";
  Set<String> categories=PropertyHelper.getCategories(Collections.singleton(propertyId));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue/$1"));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue"));
  Assert.assertTrue(categories.contains("metrics/yarn"));
  Assert.assertTrue(categories.contains("metrics"));
  String propertyId2="foo/bar/baz";
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(propertyId);
  propertyIds.add(propertyId2);
  categories=PropertyHelper.getCategories(propertyIds);
  Assert.assertTrue(categories.contains("metrics/yarn/Queue/$1"));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue"));
  Assert.assertTrue(categories.contains("metrics/yarn"));
  Assert.assertTrue(categories.contains("metrics"));
  Assert.assertTrue(categories.contains("foo/bar"));
  Assert.assertTrue(categories.contains("foo"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJMXPropertyIds(){
  Map<String,Map<String,PropertyInfo>> metrics=PropertyHelper.getJMXPropertyIds(Resource.Type.HostComponent);
  Map<String,PropertyInfo> componentMetrics=metrics.get("HISTORYSERVER");
  Assert.assertNull(componentMetrics);
  componentMetrics=metrics.get("NAMENODE");
  Assert.assertNotNull(componentMetrics);
  PropertyInfo info=componentMetrics.get("metrics/jvm/memHeapUsedM");
  Assert.assertNotNull(info);
  Assert.assertEquals("Hadoop:service=NameNode,name=jvm.memHeapUsedM",info.getPropertyId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.metadata.RoleCommandOrderTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDependencies() throws IOException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  InputStream testJsonIS=getClass().getClassLoader().getResourceAsStream(TEST_RCO_DATA_FILE);
  ObjectMapper mapper=new ObjectMapper();
  Map<String,Object> testData=mapper.readValue(testJsonIS,new TypeReference<Map<String,Object>>(){
  }
);
  rco.addDependencies(testData);
  mapper.setVisibility(JsonMethod.ALL,JsonAutoDetect.Visibility.ANY);
  String dump=mapper.writeValueAsString(rco.getDependencies());
  List<String> parts=Arrays.asList(dump.substring(1,522).split(Pattern.quote("],")));
  assertEquals(3,parts.size());
  assertTrue(parts.contains("\"RoleCommandPair{role=SECONDARY_NAMENODE, cmd=UPGRADE}\":[{\"role\":{\"name\":\"NAMENODE\"},\"cmd\":\"UPGRADE\"}"));
  assertTrue(parts.contains("\"RoleCommandPair{role=SECONDARY_NAMENODE, cmd=START}\":[{\"role\":{\"name\":\"NAMENODE\"},\"cmd\":\"START\"}"));
  boolean datanodeCommandExists=false;
  for (  String part : parts) {
    if (part.contains("RoleCommandPair{role=DATANODE, cmd=STOP}")) {
      datanodeCommandExists=true;
      String[] parts2=part.split(Pattern.quote(":["));
      assertEquals(2,parts2.length);
      assertEquals("\"RoleCommandPair{role=DATANODE, cmd=STOP}\"",parts2[0]);
      List<String> components=Arrays.asList(new String[]{"\"role\":{\"name\":\"HBASE_MASTER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"RESOURCEMANAGER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"TASKTRACKER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"NODEMANAGER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"HISTORYSERVER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"JOBTRACKER\"},\"cmd\":\"STOP\""});
      Assert.assertTrue(CollectionPresentationUtils.isStringPermutationOfCollection(parts2[1],components,"},{",1,1));
    }
  }
  assertTrue(datanodeCommandExists);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeAtHaRMCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  ServiceComponentHost sch1=createMock(ServiceComponentHostImpl.class);
  ServiceComponentHost sch2=createMock(ServiceComponentHostImpl.class);
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  Map<String,ServiceComponentHost> hostComponents=new HashMap<String,ServiceComponentHost>();
  hostComponents.put("1",sch1);
  hostComponents.put("2",sch2);
  Service yarnService=createMock(Service.class);
  ServiceComponent resourcemanagerSC=createMock(ServiceComponent.class);
  expect(cluster.getService("YARN")).andReturn(yarnService).atLeastOnce();
  expect(cluster.getService("HDFS")).andReturn(null);
  expect(yarnService.getServiceComponent("RESOURCEMANAGER")).andReturn(resourcemanagerSC).anyTimes();
  expect(resourcemanagerSC.getServiceComponentHosts()).andReturn(hostComponents).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  replay(cluster,yarnService,sch1,sch2,resourcemanagerSC);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster,yarnService);
  assertFalse(dependenciesContainBlockedRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.DATANODE));
  RoleCommandPair rmPair=new RoleCommandPair(Role.RESOURCEMANAGER,RoleCommand.START);
  Set<RoleCommandPair> rmRoleCommandPairs=deps.get(rmPair);
  assertNotNull(rmRoleCommandPairs);
  boolean isZookeeperStartPresent=false;
  for (  RoleCommandPair pair : rmRoleCommandPairs) {
    if (pair.cmd == RoleCommand.START && pair.getRole() == Role.ZOOKEEPER_SERVER) {
      isZookeeperStartPresent=true;
    }
  }
  assertTrue(isZookeeperStartPresent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.DBAccessorImplTest </h4><pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateTable() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  dbAccessor.updateTable(tableName,"name","blah","where id = 1");
  Statement statement=dbAccessor.getConnection().createStatement();
  ResultSet resultSet=statement.executeQuery("select name from " + tableName);
  while (resultSet.next()) {
    assertEquals(resultSet.getString("name"),"blah");
  }
  resultSet.close();
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddColumnWithDefault() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  dbAccessor.executeQuery("insert into " + tableName + "(id, name, time) values(1, 'Bob', 1234567)");
  dbAccessor.addColumn(tableName,new DBColumnInfo("test",String.class,1000,"test",false));
  Statement statement=dbAccessor.getConnection().createStatement();
  ResultSet resultSet=statement.executeQuery("select * from " + tableName);
  int count=0;
  while (resultSet.next()) {
    assertEquals(resultSet.getString("test"),"test");
    count++;
  }
  assertEquals(count,1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetNullable() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  dbAccessor.addColumn(tableName,new DBColumnInfo("isNullable",String.class,1000,"test",false));
  Statement statement=dbAccessor.getConnection().createStatement();
  ResultSet resultSet=statement.executeQuery("SELECT isNullable FROM " + tableName);
  ResultSetMetaData rsmd=resultSet.getMetaData();
  assertEquals(ResultSetMetaData.columnNullable,rsmd.isNullable(1));
  statement.close();
  dbAccessor.setColumnNullable(tableName,new DBColumnInfo("isNullable",String.class,1000,"test",false),false);
  statement=dbAccessor.getConnection().createStatement();
  resultSet=statement.executeQuery("SELECT isNullable FROM " + tableName);
  rsmd=resultSet.getMetaData();
  assertEquals(ResultSetMetaData.columnNoNulls,rsmd.isNullable(1));
  statement.close();
  dbAccessor.setColumnNullable(tableName,new DBColumnInfo("isNullable",String.class,1000,"test",false),true);
  statement=dbAccessor.getConnection().createStatement();
  resultSet=statement.executeQuery("SELECT isNullable FROM " + tableName);
  rsmd=resultSet.getMetaData();
  assertEquals(ResultSetMetaData.columnNullable,rsmd.isNullable(1));
  statement.close();
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddColumn() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  DBColumnInfo dbColumnInfo=new DBColumnInfo("description",String.class,null,null,true);
  dbAccessor.addColumn(tableName,dbColumnInfo);
  Statement statement=dbAccessor.getConnection().createStatement();
  statement.execute("update " + tableName + " set description = 'blah' where id = 1");
  ResultSet resultSet=statement.executeQuery("select description from " + tableName);
  while (resultSet.next()) {
    assertEquals(resultSet.getString("description"),"blah");
  }
  resultSet.close();
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddFKConstraint() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  List<DBColumnInfo> columns=new ArrayList<DBColumnInfo>();
  columns.add(new DBColumnInfo("fid",Long.class,null,null,false));
  columns.add(new DBColumnInfo("fname",String.class,null,null,false));
  String foreignTableName=getFreeTableName();
  dbAccessor.createTable(foreignTableName,columns,"fid");
  dbAccessor.addFKConstraint(foreignTableName,"MYFKCONSTRAINT","fid",tableName,"id",false);
  Statement statement=dbAccessor.getConnection().createStatement();
  statement.execute("insert into " + tableName + "(id, name) values(1,'hello')");
  statement.execute("insert into " + foreignTableName + "(fid, fname) values(1,'howdy')");
  ResultSet resultSet=statement.executeQuery("select * from " + foreignTableName);
  int count=0;
  while (resultSet.next()) {
    assertEquals(resultSet.getString("fname"),"howdy");
    count++;
  }
  resultSet.close();
  assertEquals(count,1);
  exception.expect(SQLException.class);
  exception.expectMessage(containsString("MYFKCONSTRAINT"));
  dbAccessor.dropTable(tableName);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterColumn() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  ResultSet rs;
  DBColumnInfo fromColumn;
  DBColumnInfo toColumn;
  Statement statement=dbAccessor.getConnection().createStatement();
  final String dataString="Data for inserting column.";
  toColumn=new DBColumnInfo("name",String.class,500,null,true);
  statement.execute(String.format("INSERT INTO %s(id, name) VALUES (1, '%s')",tableName,dataString));
  dbAccessor.alterColumn(tableName,toColumn);
  rs=statement.executeQuery(String.format("SELECT name FROM %s",tableName));
  while (rs.next()) {
    ResultSetMetaData rsm=rs.getMetaData();
    assertEquals(rs.getString(toColumn.getName()),dataString);
    assertEquals(rsm.getColumnTypeName(1),"VARCHAR");
    assertEquals(rsm.getColumnDisplaySize(1),500);
  }
  rs.close();
  toColumn=new DBColumnInfo("name",char[].class,999,null,true);
  dbAccessor.alterColumn(tableName,toColumn);
  rs=statement.executeQuery(String.format("SELECT name FROM %s",tableName));
  while (rs.next()) {
    ResultSetMetaData rsm=rs.getMetaData();
    Clob clob=rs.getClob(toColumn.getName());
    assertEquals(clob.getSubString(1,(int)clob.length()),dataString);
    assertEquals(rsm.getColumnTypeName(1),"CLOB");
    assertEquals(rsm.getColumnDisplaySize(1),999);
  }
  rs.close();
  toColumn=new DBColumnInfo("name_blob_to_clob",char[].class,567,null,true);
  fromColumn=new DBColumnInfo("name_blob_to_clob",byte[].class,20000,null,true);
  dbAccessor.addColumn(tableName,fromColumn);
  String sql=String.format("insert into %s(id, name_blob_to_clob) values (2, ?)",tableName);
  PreparedStatement preparedStatement=dbAccessor.getConnection().prepareStatement(sql);
  preparedStatement.setBinaryStream(1,new ByteArrayInputStream(dataString.getBytes()),dataString.getBytes().length);
  preparedStatement.executeUpdate();
  preparedStatement.close();
  dbAccessor.alterColumn(tableName,toColumn);
  rs=statement.executeQuery(String.format("SELECT name_blob_to_clob FROM %s WHERE id=2",tableName));
  while (rs.next()) {
    ResultSetMetaData rsm=rs.getMetaData();
    Clob clob=rs.getClob(toColumn.getName());
    assertEquals(clob.getSubString(1,(int)clob.length()),dataString);
    assertEquals(rsm.getColumnTypeName(1),"CLOB");
    assertEquals(rsm.getColumnDisplaySize(1),567);
  }
  rs.close();
  toColumn=new DBColumnInfo("name_blob_to_clob",char[].class,1500,null,true);
  dbAccessor.alterColumn(tableName,toColumn);
  rs=statement.executeQuery(String.format("SELECT name_blob_to_clob FROM %s WHERE id=2",tableName));
  while (rs.next()) {
    ResultSetMetaData rsm=rs.getMetaData();
    Clob clob=rs.getClob(toColumn.getName());
    assertEquals(clob.getSubString(1,(int)clob.length()),dataString);
    assertEquals(rsm.getColumnTypeName(1),"CLOB");
    assertEquals(rsm.getColumnDisplaySize(1),1500);
  }
  rs.close();
  dbAccessor.dropTable(tableName);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRenameColumn() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  dbAccessor.executeQuery("insert into " + tableName + "(id, name, time) values(1, 'Bob', 1234567)");
  dbAccessor.renameColumn(tableName,"time",new DBColumnInfo("new_time",Long.class,0,null,true));
  Statement statement=dbAccessor.getConnection().createStatement();
  ResultSet resultSet=statement.executeQuery("select new_time from " + tableName + " where id=1");
  int count=0;
  while (resultSet.next()) {
    count++;
    long newTime=resultSet.getLong("new_time");
    assertEquals(newTime,1234567L);
  }
  assertEquals(count,1);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateTable() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  Statement statement=dbAccessor.getConnection().createStatement();
  statement.execute(String.format("insert into %s(id, name) values(1,'hello')",tableName));
  ResultSet resultSet=statement.executeQuery(String.format("select * from %s",tableName));
  int count=0;
  while (resultSet.next()) {
    assertEquals(resultSet.getString("name"),"hello");
    count++;
  }
  assertEquals(count,1);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDBSession() throws Exception {
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  String tableName=getFreeTableName();
  createMyTable(tableName);
  dbAccessor.executeQuery("insert into " + tableName + "(id, name, time) values(1, 'Bob', 1234567)");
  DatabaseSession databaseSession=dbAccessor.getNewDatabaseSession();
  databaseSession.login();
  Vector vector=databaseSession.executeSQL("select * from " + tableName + " where id=1");
  assertEquals(vector.size(),1);
  Map map=(Map)vector.get(0);
  assertEquals("Bob",map.get("name".toUpperCase()));
  databaseSession.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertDefinitionDAOTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindById(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  AlertDefinitionEntity definition=definitions.get(2);
  AlertDefinitionEntity retrieved=dao.findById(definition.getDefinitionId());
  assertEquals(definition,retrieved);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByName(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  AlertDefinitionEntity definition=definitions.get(2);
  AlertDefinitionEntity retrieved=dao.findByName(definition.getClusterId(),definition.getDefinitionName());
  assertEquals(definition,retrieved);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertDispatchDAOTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that a newly created group is correctly associated with all global
 * targets.
 */
@Test public void testGlobalTargetAssociatedWithNewGroup() throws Exception {
  AlertTargetEntity target1=m_helper.createGlobalAlertTarget();
  AlertTargetEntity target2=m_helper.createGlobalAlertTarget();
  assertTrue(target1.isGlobal());
  assertTrue(target2.isGlobal());
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(2,group.getAlertTargets().size());
  Iterator<AlertTargetEntity> iterator=group.getAlertTargets().iterator();
  AlertTargetEntity groupTarget1=iterator.next();
  AlertTargetEntity groupTarget2=iterator.next();
  assertTrue(groupTarget1.isGlobal());
  assertTrue(groupTarget2.isGlobal());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindTargetByName() throws Exception {
  List<AlertTargetEntity> targets=m_dao.findAllTargets();
  assertNotNull(targets);
  AlertTargetEntity target=targets.get(3);
  AlertTargetEntity actual=m_dao.findTargetByName(target.getTargetName());
  assertEquals(target,actual);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testCreateTarget() throws Exception {
  int targetCount=m_dao.findAllTargets().size();
  AlertTargetEntity target=m_helper.createAlertTarget();
  Set<AlertTargetEntity> targets=new HashSet<AlertTargetEntity>();
  targets.add(target);
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),targets);
  AlertTargetEntity actual=m_dao.findTargetById(target.getTargetId());
  assertNotNull(actual);
  assertEquals(target.getTargetName(),actual.getTargetName());
  assertEquals(target.getDescription(),actual.getDescription());
  assertEquals(target.getNotificationType(),actual.getNotificationType());
  assertEquals(target.getProperties(),actual.getProperties());
  assertEquals(false,actual.isGlobal());
  assertNotNull(actual.getAlertGroups());
  Iterator<AlertGroupEntity> iterator=actual.getAlertGroups().iterator();
  AlertGroupEntity actualGroup=iterator.next();
  assertEquals(group,actualGroup);
  assertEquals(targetCount + 1,m_dao.findAllTargets().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests finding groups by a definition ID that they are associatd with in
 * order to get any targets associated with that group. This exercises the
 * bi-directional
 * @throws Exception
 */
@Test public void testFindTargetsViaGroupsByDefinition() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  AlertDefinitionEntity definition=definitions.get(0);
  group.addAlertDefinition(definition);
  m_dao.merge(group);
  List<AlertTargetEntity> targets=m_dao.findAllTargets();
  AlertTargetEntity target=targets.get(0);
  Set<AlertTargetEntity> setTargets=Collections.singleton(target);
  group.setAlertTargets(setTargets);
  m_dao.merge(group);
  List<AlertGroupEntity> groups=m_dao.findGroupsByDefinition(definition);
  assertEquals(2,groups.size());
  group=groups.get(groups.indexOf(group));
  assertEquals(1,group.getAlertTargets().size());
  assertEquals(target.getTargetId(),group.getAlertTargets().iterator().next().getTargetId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindGroupByName() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  AlertGroupEntity group=groups.get(3);
  AlertGroupEntity actual=m_dao.findGroupByName(group.getClusterId(),group.getGroupName());
  assertEquals(group,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertsDAOTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindCurrentByService(){
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  int currentAlertExpectedCount=currentAlerts.size();
  assertEquals(5,currentAlertExpectedCount);
  AlertCurrentEntity current=currentAlerts.get(0);
  AlertHistoryEntity history=current.getAlertHistory();
  assertNotNull(history);
  currentAlerts=m_dao.findCurrentByService(m_cluster.getClusterId(),history.getServiceName());
  assertNotNull(currentAlerts);
  assertEquals(currentAlertExpectedCount,currentAlerts.size());
  currentAlerts=m_dao.findCurrentByService(m_cluster.getClusterId(),"foo");
  assertNotNull(currentAlerts);
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByDate(){
  calendar.clear();
  calendar.set(2014,Calendar.JANUARY,1);
  List<AlertHistoryEntity> history=m_dao.findAll(m_cluster.getClusterId(),calendar.getTime(),null);
  assertNotNull(history);
  assertEquals(50,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),null,calendar.getTime());
  assertNotNull(history);
  assertEquals(1,history.size());
  calendar.set(2014,Calendar.JANUARY,5);
  Date startDate=calendar.getTime();
  calendar.set(2014,Calendar.JANUARY,10);
  Date endDate=calendar.getTime();
  history=m_dao.findAll(m_cluster.getClusterId(),startDate,endDate);
  assertNotNull(history);
  assertEquals(6,history.size());
  calendar.set(2014,Calendar.MARCH,5);
  history=m_dao.findAll(m_cluster.getClusterId(),calendar.getTime(),null);
  assertNotNull(history);
  assertEquals(0,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),endDate,startDate);
  assertNotNull(history);
  assertEquals(0,history.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 */
@Test public void testFindCurrentPerHostSummary() throws Exception {
  m_helper.addHost(m_clusters,m_cluster,"h2");
  List<AlertDefinitionEntity> definitions=m_definitionDao.findAll();
  AlertDefinitionEntity definition=definitions.get(0);
  AlertHistoryEntity h2CriticalHistory=new AlertHistoryEntity();
  h2CriticalHistory.setServiceName(definition.getServiceName());
  h2CriticalHistory.setClusterId(m_cluster.getClusterId());
  h2CriticalHistory.setAlertDefinition(definition);
  h2CriticalHistory.setAlertLabel(definition.getDefinitionName() + " h2");
  h2CriticalHistory.setAlertText(definition.getDefinitionName() + " h2");
  h2CriticalHistory.setAlertTimestamp(calendar.getTimeInMillis());
  h2CriticalHistory.setComponentName(definition.getComponentName());
  h2CriticalHistory.setHostName("h2");
  h2CriticalHistory.setAlertState(AlertState.CRITICAL);
  m_dao.create(h2CriticalHistory);
  AlertCurrentEntity h2CriticalCurrent=new AlertCurrentEntity();
  h2CriticalCurrent.setAlertHistory(h2CriticalHistory);
  h2CriticalCurrent.setLatestTimestamp(new Date().getTime());
  h2CriticalCurrent.setOriginalTimestamp(new Date().getTime() - 10800000);
  h2CriticalCurrent.setMaintenanceState(MaintenanceState.OFF);
  m_dao.create(h2CriticalCurrent);
  try {
    long clusterId=m_cluster.getClusterId();
    AlertSummaryDTO summary=m_dao.findCurrentCounts(clusterId,null,null);
    assertEquals(5,summary.getOkCount());
    AlertHistoryEntity h1=m_dao.findCurrentByCluster(clusterId).get(2).getAlertHistory();
    AlertHistoryEntity h2=m_dao.findCurrentByCluster(clusterId).get(3).getAlertHistory();
    AlertHistoryEntity h3=m_dao.findCurrentByCluster(clusterId).get(4).getAlertHistory();
    h1.setAlertState(AlertState.WARNING);
    m_dao.merge(h1);
    h2.setAlertState(AlertState.CRITICAL);
    m_dao.merge(h2);
    h3.setAlertState(AlertState.UNKNOWN);
    m_dao.merge(h3);
    Map<String,AlertSummaryDTO> perHostSummary=m_dao.findCurrentPerHostCounts(clusterId);
    AlertSummaryDTO h1summary=m_dao.findCurrentCounts(clusterId,null,"h1");
    assertEquals(2,h1summary.getOkCount());
    assertEquals(1,h1summary.getWarningCount());
    assertEquals(1,h1summary.getCriticalCount());
    assertEquals(1,h1summary.getUnknownCount());
    assertEquals(0,h1summary.getMaintenanceCount());
    AlertSummaryDTO h2summary=m_dao.findCurrentCounts(clusterId,null,"h2");
    assertEquals(0,h2summary.getOkCount());
    assertEquals(0,h2summary.getWarningCount());
    assertEquals(1,h2summary.getCriticalCount());
    assertEquals(0,h2summary.getUnknownCount());
    assertEquals(0,h2summary.getMaintenanceCount());
    AlertSummaryDTO h1PerHostSummary=perHostSummary.get("h1");
    assertEquals(h1PerHostSummary.getOkCount(),h1summary.getOkCount());
    assertEquals(h1PerHostSummary.getWarningCount(),h1summary.getWarningCount());
    assertEquals(h1PerHostSummary.getCriticalCount(),h1summary.getCriticalCount());
    assertEquals(h1PerHostSummary.getUnknownCount(),h1summary.getUnknownCount());
    assertEquals(h1PerHostSummary.getMaintenanceCount(),h1summary.getMaintenanceCount());
    AlertSummaryDTO h2PerHostSummary=perHostSummary.get("h2");
    assertEquals(h2PerHostSummary.getOkCount(),h2summary.getOkCount());
    assertEquals(h2PerHostSummary.getWarningCount(),h2summary.getWarningCount());
    assertEquals(h2PerHostSummary.getCriticalCount(),h2summary.getCriticalCount());
    assertEquals(h2PerHostSummary.getUnknownCount(),h2summary.getUnknownCount());
    assertEquals(h2PerHostSummary.getMaintenanceCount(),h2summary.getMaintenanceCount());
  }
  finally {
    m_dao.remove(h2CriticalCurrent);
    m_dao.remove(h2CriticalHistory);
    m_clusters.unmapHostFromCluster("h2",m_cluster.getClusterName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests <a
 * href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=398067">https:/
 * /bugs.eclipse.org/bugs/show_bug.cgi?id=398067</a> which causes an inner
 * entity to be stale.
 */
@Test public void testJPAInnerEntityStaleness(){
  List<AlertCurrentEntity> currents=m_dao.findCurrent();
  AlertCurrentEntity current=currents.get(0);
  AlertHistoryEntity oldHistory=current.getAlertHistory();
  AlertHistoryEntity newHistory=new AlertHistoryEntity();
  newHistory.setAlertDefinition(oldHistory.getAlertDefinition());
  newHistory.setAlertInstance(oldHistory.getAlertInstance());
  newHistory.setAlertLabel(oldHistory.getAlertLabel());
  if (oldHistory.getAlertState() == AlertState.OK) {
    newHistory.setAlertState(AlertState.CRITICAL);
  }
 else {
    newHistory.setAlertState(AlertState.OK);
  }
  newHistory.setAlertText("New History");
  newHistory.setClusterId(oldHistory.getClusterId());
  newHistory.setAlertTimestamp(System.currentTimeMillis());
  newHistory.setComponentName(oldHistory.getComponentName());
  newHistory.setHostName(oldHistory.getHostName());
  newHistory.setServiceName(oldHistory.getServiceName());
  m_dao.create(newHistory);
  assertTrue(newHistory.getAlertId().longValue() != oldHistory.getAlertId().longValue());
  current.setAlertHistory(newHistory);
  m_dao.merge(current);
  AlertCurrentEntity newCurrent=m_dao.findCurrentByHostAndName(newHistory.getClusterId(),newHistory.getHostName(),newHistory.getAlertDefinition().getDefinitionName());
  assertEquals(newHistory.getAlertId(),newCurrent.getAlertHistory().getAlertId());
  assertEquals(newHistory.getAlertState(),newCurrent.getAlertHistory().getAlertState());
  newCurrent=m_dao.findCurrentById(current.getAlertId());
  assertEquals(newHistory.getAlertId(),newCurrent.getAlertHistory().getAlertId());
  assertEquals(newHistory.getAlertState(),newCurrent.getAlertHistory().getAlertState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ConfigGroupDAOTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByTag() throws Exception {
  createConfigGroup("c1","hdfs-1","HDFS","some description",null,null);
  List<ConfigGroupEntity> configGroupEntities=configGroupDAO.findAllByTag("HDFS");
  Assert.assertNotNull(configGroupEntities);
  ConfigGroupEntity configGroupEntity=configGroupEntities.get(0);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("hdfs-1",configGroupEntity.getGroupName());
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  Assert.assertEquals("some description",configGroupEntity.getDescription());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindConfigsByGroup() throws Exception {
  StackEntity stackEntity=stackDAO.find("HDP","0.1");
  ClusterConfigEntity configEntity=new ClusterConfigEntity();
  configEntity.setType("core-site");
  configEntity.setTag("version1");
  configEntity.setData("someData");
  configEntity.setAttributes("someAttributes");
  configEntity.setStack(stackEntity);
  List<ClusterConfigEntity> configEntities=new ArrayList<ClusterConfigEntity>();
  configEntities.add(configEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",null,configEntities);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupConfigMappingEntities().size() > 0);
  List<ConfigGroupConfigMappingEntity> configMappingEntities=configGroupConfigMappingDAO.findByGroup(configGroupEntity.getGroupId());
  Assert.assertNotNull(configEntities);
  Assert.assertEquals("core-site",configEntities.get(0).getType());
  Assert.assertEquals("version1",configEntities.get(0).getTag());
  Assert.assertEquals("someData",configEntities.get(0).getData());
  Assert.assertEquals("someAttributes",configEntities.get(0).getAttributes());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByHost() throws Exception {
  List<HostEntity> hosts=new ArrayList<HostEntity>();
  HostEntity hostEntity=new HostEntity();
  hostEntity.setHostName("h1");
  hostEntity.setOsType("centOS");
  hosts.add(hostEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",hosts,null);
  Assert.assertNotNull(hostEntity.getHostId());
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupHostMappingEntities().size() > 0);
  Assert.assertNotNull(configGroupEntity.getConfigGroupHostMappingEntities().iterator().next());
  Set<ConfigGroupHostMapping> hostMappingEntities=configGroupHostMappingDAO.findByHostId(hostEntity.getHostId());
  Assert.assertNotNull(hostMappingEntities);
  for (  ConfigGroupHostMapping hostMappingEntity : hostMappingEntities) {
    Assert.assertEquals(hostEntity.getHostId(),hostMappingEntity.getHostId());
    Assert.assertEquals("centOS",hostMappingEntity.getHost().getOsType());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RequestDAOTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCalculatedStatus() throws Exception {
  createGraph();
  RequestEntity requestEntity=requestDAO.findByPK(100L);
  CalculatedStatus calc1=CalculatedStatus.statusFromStageEntities(requestEntity.getStages());
  Map<Long,HostRoleCommandStatusSummaryDTO> map=hostRoleCommandDAO.findAggregateCounts(100L);
  CalculatedStatus calc2=CalculatedStatus.statusFromStageSummary(map,map.keySet());
  Assert.assertEquals(HostRoleStatus.IN_PROGRESS,calc1.getStatus());
  Assert.assertEquals(calc1.getStatus(),calc2.getStatus());
  Assert.assertEquals(calc1.getPercent(),calc2.getPercent(),0.01d);
  Set<Long> group=new HashSet<Long>();
  group.add(2L);
  group.add(3L);
  group.add(4L);
  List<StageEntity> stages=stageDAO.findByStageIds(requestEntity.getRequestId(),group);
  CalculatedStatus calc3=CalculatedStatus.statusFromStageEntities(stages);
  CalculatedStatus calc4=CalculatedStatus.statusFromStageSummary(map,group);
  Assert.assertEquals(100d,calc3.getPercent(),0.01d);
  Assert.assertEquals(HostRoleStatus.COMPLETED,calc3.getStatus());
  Assert.assertEquals(calc3.getPercent(),calc4.getPercent(),0.01d);
  Assert.assertEquals(calc3.getStatus(),calc4.getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ServiceConfigDAOTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetClusterConfigMappingByStack() throws Exception {
  initClusterEntities();
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  List<ClusterConfigMappingEntity> clusterConfigMappingEntities=clusterDAO.getClusterConfigMappingsByStack(clusterEntity.getClusterId(),HDP_01);
  Assert.assertEquals(2,clusterConfigMappingEntities.size());
  ClusterConfigMappingEntity e1=clusterConfigMappingEntities.get(0);
  String tag1=e1.getTag();
  Assert.assertEquals("version1",tag1);
  String type1=e1.getType();
  Assert.assertEquals("oozie-site",type1);
  ClusterConfigMappingEntity e2=clusterConfigMappingEntities.get(1);
  String tag2=e2.getTag();
  Assert.assertEquals("version2",tag2);
  String type2=e2.getType();
  Assert.assertEquals("oozie-site",type2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the get latest configuration query against clusterconfig table with configuration groups inserted
 */
@Test public void testGetClusterConfigMappingByStackCG() throws Exception {
  initClusterEntitiesWithConfigGroups();
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  List<ConfigGroupEntity> configGroupEntities=configGroupDAO.findAllByTag("OOZIE");
  Assert.assertNotNull(configGroupEntities);
  ConfigGroupEntity configGroupEntity=configGroupEntities.get(0);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("oozie_server",configGroupEntity.getGroupName());
  Assert.assertEquals("OOZIE",configGroupEntity.getTag());
  Assert.assertEquals("oozie server",configGroupEntity.getDescription());
  List<ClusterConfigMappingEntity> clusterConfigMappingEntities=clusterDAO.getClusterConfigMappingsByStack(clusterEntity.getClusterId(),HDP_01);
  Assert.assertEquals(2,clusterConfigMappingEntities.size());
  ClusterConfigMappingEntity e1=clusterConfigMappingEntities.get(0);
  String tag1=e1.getTag();
  Assert.assertEquals("version1",tag1);
  String type1=e1.getType();
  Assert.assertEquals("oozie-site",type1);
  ClusterConfigMappingEntity e2=clusterConfigMappingEntities.get(1);
  String tag2=e2.getTag();
  Assert.assertEquals("version2",tag2);
  String type2=e2.getType();
  Assert.assertEquals("oozie-site",type2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.StageDAOTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that JPA does the sorting work for us.
 */
@Test public void testStageSorting() throws Exception {
  List<SortRequestProperty> sortProperties=new ArrayList<SortRequestProperty>();
  SortRequest sortRequest=new SortRequestImpl(sortProperties);
  Predicate predicate=new PredicateBuilder().property(StageResourceProvider.STAGE_CLUSTER_NAME).equals("c1").toPredicate();
  sortProperties.add(new SortRequestProperty(StageResourceProvider.STAGE_LOG_INFO,SortRequest.Order.ASC));
  Request request=PropertyHelper.getReadRequest(new HashSet<String>(Arrays.<String>asList()),null,null,null,sortRequest);
  List<StageEntity> entities=stageDao.findAll(request,predicate);
  assertEquals(5,entities.size());
  String lastInfo=null;
  for (  StageEntity entity : entities) {
    if (lastInfo == null) {
      lastInfo=entity.getLogInfo();
      continue;
    }
    String currentInfo=entity.getLogInfo();
    assertTrue(lastInfo.compareTo(currentInfo) <= 0);
    lastInfo=currentInfo;
  }
  sortProperties.clear();
  sortProperties.add(new SortRequestProperty(StageResourceProvider.STAGE_LOG_INFO,SortRequest.Order.DESC));
  entities=stageDao.findAll(request,predicate);
  assertEquals(5,entities.size());
  lastInfo=null;
  for (  StageEntity entity : entities) {
    if (null == lastInfo) {
      lastInfo=entity.getLogInfo();
      continue;
    }
    String currentInfo=entity.getLogInfo();
    assertTrue(lastInfo.compareTo(currentInfo) >= 0);
    lastInfo=currentInfo;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.TopologyLogicalRequestDAOTest </h4><pre class="type-4 type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testFindAll() throws Exception {
  create();
  List<TopologyLogicalRequestEntity> logicalRequestEntities=logicalRequestDAO.findAll();
  Assert.assertEquals(1,logicalRequestEntities.size());
  TopologyLogicalRequestEntity logicalRequestEntity=logicalRequestEntities.iterator().next();
  Assert.assertNotNull(logicalRequestEntity.getTopologyRequestId());
  Assert.assertEquals(Long.valueOf(1),logicalRequestEntity.getId());
  Assert.assertEquals("description",logicalRequestEntity.getDescription());
  Assert.assertNotNull(logicalRequestEntity.getTopologyRequestEntity());
  Collection<TopologyHostRequestEntity> hostRequestEntities=logicalRequestEntity.getTopologyHostRequestEntities();
  Assert.assertEquals(1,hostRequestEntities.size());
  TopologyHostRequestEntity hostRequestEntity=hostRequestEntities.iterator().next();
  Assert.assertNotNull(hostRequestEntity.getTopologyHostGroupEntity());
  Assert.assertEquals(hostRequestEntity.getTopologyHostGroupEntity().getId(),hostRequestEntity.getHostGroupId());
  Collection<TopologyHostTaskEntity> taskEntities=hostRequestEntity.getTopologyHostTaskEntities();
  Assert.assertEquals(1,taskEntities.size());
  TopologyHostTaskEntity taskEntity=taskEntities.iterator().next();
  Assert.assertNotNull(taskEntity.getTopologyHostRequestEntity());
  Assert.assertNotNull(taskEntity.getTopologyLogicalTaskEntities());
  Assert.assertEquals(1,taskEntity.getTopologyLogicalTaskEntities().size());
  Assert.assertNotNull(taskEntity.getTopologyLogicalTaskEntities().iterator().next().getTopologyHostTaskEntity());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.UpgradeDAOTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindUpgrade() throws Exception {
  List<UpgradeEntity> items=dao.findUpgrades(clusterId.longValue());
  assertTrue(items.size() > 0);
  UpgradeEntity entity=dao.findUpgrade(items.get(0).getId().longValue());
  assertNotNull(entity);
  assertEquals(1,entity.getUpgradeGroups().size());
  UpgradeGroupEntity group=dao.findUpgradeGroup(entity.getUpgradeGroups().get(0).getId().longValue());
  assertNotNull(group);
  Assert.assertNotSame(entity.getUpgradeGroups().get(0),group);
  assertEquals("group_name",group.getName());
  assertEquals("group title",group.getTitle());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFindForCluster() throws Exception {
  List<UpgradeEntity> items=dao.findUpgrades(clusterId.longValue());
  assertEquals(1,items.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ResourceEntityTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetPrivileges() throws Exception {
  ResourceEntity entity=new ResourceEntity();
  PrivilegeEntity privilegeEntity=new PrivilegeEntity();
  Collection<PrivilegeEntity> privileges=Collections.singleton(privilegeEntity);
  Assert.assertNull(entity.getResourceType());
  entity.setPrivileges(privileges);
  Assert.assertEquals(privileges,entity.getPrivileges());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewEntityTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetGetConfiguration() throws Exception {
  ViewConfig viewConfig=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=getViewEntity(viewConfig);
  Assert.assertEquals(viewConfig,viewDefinition.getConfiguration());
  ViewConfig newViewConfig=ViewConfigTest.getConfig(with_ambari_versions);
  viewDefinition.setConfiguration(newViewConfig);
  Assert.assertEquals(newViewConfig,viewDefinition.getConfiguration());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAmbariProperty() throws Exception {
  ViewConfig viewConfig=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=getViewEntity(viewConfig);
  Assert.assertEquals("v1",viewDefinition.getAmbariProperty("p1"));
  Assert.assertEquals("v2",viewDefinition.getAmbariProperty("p2"));
  Assert.assertEquals("v3",viewDefinition.getAmbariProperty("p3"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsClusterConfigurable() throws Exception {
  ViewConfig viewConfig=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=getViewEntity(viewConfig);
  Assert.assertEquals(viewConfig,viewDefinition.getConfiguration());
  ViewConfig newViewConfig=ViewConfigTest.getConfig();
  viewDefinition.setConfiguration(newViewConfig);
  Assert.assertTrue(viewDefinition.isClusterConfigurable());
  newViewConfig=ViewConfigTest.getConfig(with_ambari_versions);
  viewDefinition.setConfiguration(newViewConfig);
  Assert.assertFalse(viewDefinition.isClusterConfigurable());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewInstanceEntityTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetIcon64() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("/this/is/the/icon/url/instance_1_icon64.png",viewInstanceDefinition.getIcon64());
  viewInstanceDefinition.setIcon64("/a/different/icon.png");
  Assert.assertEquals("/a/different/icon.png",viewInstanceDefinition.getIcon64());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(1);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("/this/is/the/icon/url/icon64.png",viewInstanceDefinition.getIcon64());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAlterNames() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.alterNames());
  viewInstanceDefinition.setAlterNames(false);
  Assert.assertFalse(viewInstanceDefinition.alterNames());
  viewInstanceDefinition.setAlterNames(true);
  Assert.assertTrue(viewInstanceDefinition.alterNames());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstanceData() throws Exception {
  TestSecurityHelper securityHelper=new TestSecurityHelper("user1");
  ViewInstanceEntity viewInstanceDefinition=getViewInstanceEntity(securityHelper);
  viewInstanceDefinition.putInstanceData("key1","foo");
  ViewInstanceDataEntity dataEntity=viewInstanceDefinition.getInstanceData("key1");
  Assert.assertNotNull(dataEntity);
  Assert.assertEquals("foo",dataEntity.getValue());
  Assert.assertEquals("user1",dataEntity.getUser());
  viewInstanceDefinition.putInstanceData("key2","bar");
  viewInstanceDefinition.putInstanceData("key3","baz");
  viewInstanceDefinition.putInstanceData("key4","monkey");
  viewInstanceDefinition.putInstanceData("key5","runner");
  Map<String,String> dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(5,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertEquals("baz",dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
  viewInstanceDefinition.removeInstanceData("key3");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertFalse(dataMap.containsKey("key3"));
  securityHelper.setUser("user2");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertTrue(dataMap.isEmpty());
  viewInstanceDefinition.putInstanceData("key1","aaa");
  viewInstanceDefinition.putInstanceData("key2","bbb");
  viewInstanceDefinition.putInstanceData("key3","ccc");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(3,dataMap.size());
  Assert.assertEquals("aaa",dataMap.get("key1"));
  Assert.assertEquals("bbb",dataMap.get("key2"));
  Assert.assertEquals("ccc",dataMap.get("key3"));
  securityHelper.setUser("user1");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertNull(dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetValidationResult() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml_valid_instance);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewEntityTest.TestValidator validator=new ViewEntityTest.TestValidator();
  validator.result=new ValidationResultImpl(true,"detail");
  viewEntity.setValidator(validator);
  InstanceValidationResultImpl result=viewInstanceEntity.getValidationResult(viewEntity,Validator.ValidationContext.PRE_CREATE);
  Map<String,ValidationResult> propertyResults=result.getPropertyResults();
  junit.framework.Assert.assertEquals(2,propertyResults.size());
  junit.framework.Assert.assertTrue(propertyResults.containsKey("p1"));
  junit.framework.Assert.assertTrue(propertyResults.containsKey("p2"));
  junit.framework.Assert.assertTrue(propertyResults.get("p1").isValid());
  junit.framework.Assert.assertTrue(propertyResults.get("p2").isValid());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetLabel() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("My Instance 1!",viewInstanceDefinition.getLabel());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_without_instance_label).get(0);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("My View!",viewInstanceDefinition.getLabel());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetIcon() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("/this/is/the/icon/url/instance_1_icon.png",viewInstanceDefinition.getIcon());
  viewInstanceDefinition.setIcon("/a/different/icon.png");
  Assert.assertEquals("/a/different/icon.png",viewInstanceDefinition.getIcon());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(1);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("/this/is/the/icon/url/icon.png",viewInstanceDefinition.getIcon());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIsVisible() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.isVisible());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(1);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertFalse(viewInstanceDefinition.isVisible());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_without_instance_label).get(0);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.isVisible());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDescription() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("This is an instance description.",viewInstanceDefinition.getDescription());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_without_instance_label).get(0);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertNull(viewInstanceDefinition.getDescription());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.resources.TestResources </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResource() throws Exception {
  File resFile=resMan.getResource(resourceFile.getName());
  assertTrue(resFile.exists());
  String resContent=FileUtils.readFileToString(resFile);
  assertEquals(resContent,RESOURCE_FILE_CONTENT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.scheduler.ExecutionScheduleManagerTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScheduleBatch() throws Exception {
  RequestExecution requestExecution=createRequestExecution(true);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=null;
  JobDetail jobDetail2=null;
  Trigger trigger1=null;
  Trigger trigger2=null;
  for (  String group : scheduler.getJobGroupNames()) {
    for (    JobKey jobKey : scheduler.getJobKeys(GroupMatcher.jobGroupEquals(ExecutionJob.LINEAR_EXECUTION_JOB_GROUP))) {
      LOG.info("Found job identified by: " + jobKey);
      String jobName=jobKey.getName();
      String jobGroup=jobKey.getGroup();
      List<Trigger> triggers=(List<Trigger>)scheduler.getTriggersOfJob(jobKey);
      Trigger trigger=triggers != null && !triggers.isEmpty() ? triggers.get(0) : null;
      Date nextFireTime=trigger != null ? trigger.getNextFireTime() : null;
      LOG.info("[jobName] : " + jobName + " [groupName] : "+ jobGroup+ " - "+ nextFireTime);
      if (jobName.equals(jobName1)) {
        jobDetail1=scheduler.getJobDetail(jobKey);
        trigger1=trigger;
      }
 else       if (jobName.equals(jobName2)) {
        jobDetail2=scheduler.getJobDetail(jobKey);
        trigger2=trigger;
      }
    }
  }
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(trigger1);
  Assert.assertNotNull(jobDetail2);
  Assert.assertNull(trigger2);
  CronTrigger cronTrigger=(CronTrigger)trigger1;
  Schedule schedule=new Schedule();
  schedule.setMinutes("10");
  schedule.setHours("2");
  schedule.setMonth("*");
  schedule.setDaysOfMonth("*");
  schedule.setDayOfWeek("?");
  Assert.assertEquals(schedule.getScheduleExpression(),cronTrigger.getCronExpression());
  Assert.assertEquals(jobName1,jobDetail1.getKey().getName());
  Assert.assertEquals(jobName2,jobDetail2.getKey().getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-2 type-11 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  InMemoryDefaultTestModule defaultTestModule=new InMemoryDefaultTestModule();
  properties=defaultTestModule.getProperties();
  injector=Guice.createInjector(Modules.override(defaultTestModule).with(new ExecutionSchedulerTestModule()));
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  executionScheduleManager=injector.getInstance(ExecutionScheduleManager.class);
  executionScheduler=injector.getInstance(ExecutionScheduler.class);
  requestExecutionFactory=injector.getInstance(RequestExecutionFactory.class);
  clusterName="c1";
  clusters.addCluster(clusterName,new StackId("HDP-0.1"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  assertThat(executionScheduler,instanceOf(TestExecutionScheduler.class));
  TestExecutionScheduler testExecutionScheduler=(TestExecutionScheduler)executionScheduler;
  scheduler=testExecutionScheduler.getScheduler();
  Assert.assertNotNull(scheduler);
  executionScheduleManager.start();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAllJobs() throws Exception {
  RequestExecution requestExecution=createRequestExecution(true);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=scheduler.getJobDetail(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  JobDetail jobDetail2=scheduler.getJobDetail(JobKey.jobKey(jobName2,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(jobDetail2);
  Assert.assertTrue(!scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
  executionScheduleManager.deleteAllJobs(requestExecution);
  Assert.assertTrue(scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPointInTimeExecutionJob() throws Exception {
  RequestExecution requestExecution=createRequestExecution(false);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=scheduler.getJobDetail(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  JobDetail jobDetail2=scheduler.getJobDetail(JobKey.jobKey(jobName2,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(jobDetail2);
  List<? extends Trigger> triggers=scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(triggers);
  Assert.assertEquals(1,triggers.size());
  assertThat(triggers.get(0),instanceOf(SimpleTrigger.class));
  Assert.assertNull(jobDetail2.getJobDataMap().getString(ExecutionJob.NEXT_EXECUTION_JOB_NAME_KEY));
  int waitCount=0;
  while (scheduler.getCurrentlyExecutingJobs().size() != 0 && waitCount < 10) {
    Thread.sleep(100);
    waitCount++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.AbstractSecurityHeaderFilterTest </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_EmptyValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_DefaultValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER));
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_CustomValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"custom1");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"custom2");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"custom3");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER,"custom1");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,"custom2");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,"custom3");
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_DefaultValuesNoSSL() throws Exception {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"false");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER));
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_CustomValuesNoSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"custom1");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"custom2");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"custom3");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,"custom2");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,"custom3");
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_EmptyValuesNoSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.CertGenerationTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassFileGen() throws Exception {
  File passFile=new File(temp.getRoot().getAbsolutePath() + File.separator + passFileName);
  Assert.assertTrue(passFile.exists());
  String pass=FileUtils.readFileToString(passFile);
  Assert.assertEquals(pass.length(),passLen);
  if (ShellCommandUtil.LINUX) {
    String permissions=ShellCommandUtil.getUnixFilePermissions(passFile.getAbsolutePath());
    Assert.assertEquals(ShellCommandUtil.MASK_OWNER_ONLY_RW,permissions);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AuthorizationHelperTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsAuthorized(){
  RoleAuthorizationEntity readOnlyRoleAuthorizationEntity=new RoleAuthorizationEntity();
  readOnlyRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.CLUSTER_VIEW_METRICS.getId());
  RoleAuthorizationEntity privilegedRoleAuthorizationEntity=new RoleAuthorizationEntity();
  privilegedRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS.getId());
  RoleAuthorizationEntity administratorRoleAuthorizationEntity=new RoleAuthorizationEntity();
  administratorRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.AMBARI_MANAGE_USERS.getId());
  ResourceTypeEntity clusterResourceTypeEntity=new ResourceTypeEntity();
  clusterResourceTypeEntity.setId(1);
  clusterResourceTypeEntity.setName(ResourceType.CLUSTER.name());
  ResourceTypeEntity cluster2ResourceTypeEntity=new ResourceTypeEntity();
  cluster2ResourceTypeEntity.setId(2);
  cluster2ResourceTypeEntity.setName(ResourceType.CLUSTER.name());
  ResourceEntity clusterResourceEntity=new ResourceEntity();
  clusterResourceEntity.setResourceType(clusterResourceTypeEntity);
  clusterResourceEntity.setId(1L);
  ResourceEntity cluster2ResourceEntity=new ResourceEntity();
  cluster2ResourceEntity.setResourceType(cluster2ResourceTypeEntity);
  cluster2ResourceEntity.setId(2L);
  PermissionEntity readOnlyPermissionEntity=new PermissionEntity();
  readOnlyPermissionEntity.setAuthorizations(Collections.singleton(readOnlyRoleAuthorizationEntity));
  PermissionEntity privilegedPermissionEntity=new PermissionEntity();
  privilegedPermissionEntity.setAuthorizations(Arrays.asList(readOnlyRoleAuthorizationEntity,privilegedRoleAuthorizationEntity));
  PermissionEntity administratorPermissionEntity=new PermissionEntity();
  administratorPermissionEntity.setAuthorizations(Arrays.asList(readOnlyRoleAuthorizationEntity,privilegedRoleAuthorizationEntity,administratorRoleAuthorizationEntity));
  PrivilegeEntity readOnlyPrivilegeEntity=new PrivilegeEntity();
  readOnlyPrivilegeEntity.setPermission(readOnlyPermissionEntity);
  readOnlyPrivilegeEntity.setResource(clusterResourceEntity);
  PrivilegeEntity readOnly2PrivilegeEntity=new PrivilegeEntity();
  readOnly2PrivilegeEntity.setPermission(readOnlyPermissionEntity);
  readOnly2PrivilegeEntity.setResource(cluster2ResourceEntity);
  PrivilegeEntity privilegedPrivilegeEntity=new PrivilegeEntity();
  privilegedPrivilegeEntity.setPermission(privilegedPermissionEntity);
  privilegedPrivilegeEntity.setResource(clusterResourceEntity);
  PrivilegeEntity privileged2PrivilegeEntity=new PrivilegeEntity();
  privileged2PrivilegeEntity.setPermission(privilegedPermissionEntity);
  privileged2PrivilegeEntity.setResource(cluster2ResourceEntity);
  PrivilegeEntity administratorPrivilegeEntity=new PrivilegeEntity();
  administratorPrivilegeEntity.setPermission(administratorPermissionEntity);
  administratorPrivilegeEntity.setResource(clusterResourceEntity);
  GrantedAuthority readOnlyAuthority=new AmbariGrantedAuthority(readOnlyPrivilegeEntity);
  GrantedAuthority readOnly2Authority=new AmbariGrantedAuthority(readOnly2PrivilegeEntity);
  GrantedAuthority privilegedAuthority=new AmbariGrantedAuthority(privilegedPrivilegeEntity);
  GrantedAuthority privileged2Authority=new AmbariGrantedAuthority(privileged2PrivilegeEntity);
  GrantedAuthority administratorAuthority=new AmbariGrantedAuthority(administratorPrivilegeEntity);
  Authentication noAccessUser=new TestAuthentication(Collections.<AmbariGrantedAuthority>emptyList());
  Authentication readOnlyUser=new TestAuthentication(Collections.singleton(readOnlyAuthority));
  Authentication privilegedUser=new TestAuthentication(Arrays.asList(readOnlyAuthority,privilegedAuthority));
  Authentication privileged2User=new TestAuthentication(Arrays.asList(readOnly2Authority,privileged2Authority));
  Authentication administratorUser=new TestAuthentication(Collections.singleton(administratorAuthority));
  SecurityContext context=SecurityContextHolder.getContext();
  assertFalse(AuthorizationHelper.isAuthorized(null,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(noAccessUser);
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  context.setAuthentication(readOnlyUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(privilegedUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(privileged2User);
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(administratorUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.AESEncryptorTest </h4><pre class="type-4 type-2 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionDecryption() throws Exception {
  AESEncryptor aes=new AESEncryptor("AESPassPhrase");
  String masterKey="Thisisusermasterkey";
  EncryptionResult res=aes.encrypt(masterKey.getBytes());
  Assert.assertNotNull(res);
  Assert.assertNotNull(res.cipher);
  Assert.assertNotNull(res.iv);
  Assert.assertNotNull(res.salt);
  byte[] descryptedKey=aes.decrypt(res.salt,res.iv,res.cipher);
  Assert.assertEquals(masterKey,new String(descryptedKey,"UTF8"));
  Assert.assertEquals(masterKey.getBytes().length,descryptedKey.length);
  Assert.assertEquals(masterKey.getBytes("UTF8").length,new String(descryptedKey,"UTF8").toCharArray().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.MasterKeyServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeMasterKey() throws Exception {
  File masterKeyFile=new File(fileDir,"master");
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"ThisisSomePassPhrase"));
  MasterKeyService ms=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertTrue(masterKeyFile.exists());
  Set<PosixFilePermission> permissions=Files.getPosixFilePermissions(Paths.get(masterKeyFile.getAbsolutePath()));
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  MasterKeyService ms1=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms1.isMasterKeyInitialized());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms1.getMasterSecret()));
  Assert.assertEquals(new String(ms.getMasterSecret()),new String(ms1.getMasterSecret()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.ldap.AmbariLdapDataPopulatorTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_remove() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(populator);
  replay(externalGroup1);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertTrue(result.getGroupsToBeRemoved().contains("group4"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_update() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("group3").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("group4").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getLdapGroups("group*")).andReturn(externalGroups);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("group*"),batchInfo);
  assertEquals(2,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group1"));
  assertTrue(result.getGroupsToBecomeLdap().contains("group4"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_remove() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user3").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  expect(populator.getExternalLdapUserInfo()).andReturn(Collections.EMPTY_SET);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(2,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("user3"));
  assertTrue(result.getUsersToBeRemoved().contains("user1"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_add() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user3").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user4").anyTimes();
  replay(externalUser1,externalUser2);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("user3"));
  assertTrue(result.getUsersToBeCreated().contains("user4"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("serial") public void testCleanUpLdapUsersWithoutGroup() throws AmbariException {
  final Configuration configuration=createNiceMock(Configuration.class);
  final Users users=createNiceMock(Users.class);
  final GroupEntity ldapGroup=new GroupEntity();
  ldapGroup.setGroupId(1);
  ldapGroup.setGroupName("ldapGroup");
  ldapGroup.setLdapGroup(true);
  ldapGroup.setMemberEntities(new HashSet<MemberEntity>());
  final User ldapUserWithoutGroup=createLdapUserWithoutGroup();
  final User ldapUserWithGroup=createLdapUserWithGroup(ldapGroup);
  final User localUserWithoutGroup=createLocalUserWithoutGroup();
  final User localUserWithGroup=createLocalUserWithGroup(ldapGroup);
  final List<User> allUsers=new ArrayList<User>(){
{
      add(ldapUserWithoutGroup);
      add(ldapUserWithGroup);
      add(localUserWithoutGroup);
      add(localUserWithGroup);
    }
  }
;
  expect(users.getAllUsers()).andReturn(new ArrayList<User>(allUsers));
  final List<User> removedUsers=new ArrayList<User>();
  final Capture<User> userCapture=new Capture<User>();
  users.removeUser(capture(userCapture));
  expectLastCall().andAnswer(new IAnswer<Void>(){
    @Override public Void answer() throws Throwable {
      removedUsers.add(userCapture.getValue());
      allUsers.remove(userCapture.getValue());
      return null;
    }
  }
);
  replay(users);
  final AmbariLdapDataPopulatorTestInstance populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  populator.setLdapTemplate(createNiceMock(LdapTemplate.class));
  populator.setLdapServerProperties(createNiceMock(LdapServerProperties.class));
  populator.cleanUpLdapUsersWithoutGroup();
  assertEquals(removedUsers.size(),1);
  assertEquals(allUsers.size(),3);
  assertTrue(allUsers.contains(ldapUserWithGroup));
  assertTrue(allUsers.contains(localUserWithoutGroup));
  assertTrue(allUsers.contains(localUserWithGroup));
  assertEquals(removedUsers.get(0),ldapUserWithoutGroup);
  verify(users);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_add() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(false).anyTimes();
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(Arrays.asList(group1,group2));
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group4").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(externalGroup1,externalGroup2);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("group3"));
  assertTrue(result.getGroupsToBeCreated().contains("group4"));
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_add() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("xuser3").anyTimes();
  expect(externalUser4.getUserName()).andReturn("xuser4").anyTimes();
  replay(externalUser2,externalUser3,externalUser4);
  expect(populator.getLdapUsers("xuser*")).andReturn(createSet(externalUser3,externalUser4));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user2","xuser*"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("xuser3"));
  assertTrue(result.getUsersToBeCreated().contains("xuser4"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("synced_user1").anyTimes();
  expect(user2.getUserName()).andReturn("synced_user2").anyTimes();
  expect(user3.getUserName()).andReturn("unsynced_user1").anyTimes();
  expect(user4.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user3,user2,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("synced_user2").anyTimes();
  expect(externalUser2.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("external_user1").anyTimes();
  expect(externalUser4.getUserName()).andReturn("external_user2").anyTimes();
  replay(externalUser1,externalUser2,externalUser3,externalUser4);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2,externalUser3,externalUser4));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("synced_user1"));
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("external_user1"));
  assertTrue(result.getUsersToBeCreated().contains("external_user2"));
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("unsynced_user2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_add() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("xgroup1").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("xgroup2").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup2),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("x*")).andReturn(externalGroups);
  expect(populator.getLdapGroups("group2")).andReturn(Collections.singleton(externalGroup2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("x*","group2"),batchInfo);
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("xgroup1"));
  assertTrue(result.getGroupsToBeCreated().contains("xgroup2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeExistingLdapUsers() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("synced_user1").anyTimes();
  expect(user2.getUserName()).andReturn("synced_user2").anyTimes();
  expect(user3.getUserName()).andReturn("unsynced_user1").anyTimes();
  expect(user4.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  expect(populator.getLdapUsers("synced_user1")).andReturn(Collections.EMPTY_SET);
  expect(populator.getLdapUsers("synced_user2")).andReturn(Collections.singleton(createNiceMock(LdapUserDto.class)));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeExistingLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("synced_user1"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_update() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user3").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user3").anyTimes();
  replay(externalUser1,externalUser2);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user3"));
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_allExist() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("xuser3").anyTimes();
  expect(externalUser4.getUserName()).andReturn("xuser4").anyTimes();
  replay(externalUser1,externalUser2,externalUser3,externalUser4);
  expect(populator.getLdapUsers("xuser*")).andReturn(createSet(externalUser3,externalUser4));
  expect(populator.getLdapUsers("user1")).andReturn(Collections.singleton(externalUser1));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user1","user2","xuser*"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("xuser3"));
  assertTrue(result.getUsersToBeCreated().contains("xuser4"));
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user1"));
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  Group group5=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group5.getGroupName()).andReturn("group5").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  expect(group5.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4,group5);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4,group5);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapGroupInfo").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group4").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("group6").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("group7").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(1,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertEquals(1,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group3"));
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("group6"));
  assertTrue(result.getGroupsToBeCreated().contains("group7"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_update() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(false).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(populator);
  replay(externalGroup1,externalGroup2);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group2"));
  assertTrue(result.getGroupsToBecomeLdap().contains("group3"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void synchronizeExistingLdapGroups() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  Group group5=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group5.getGroupName()).andReturn("group5").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  expect(group5.isLdapGroup()).andReturn(true).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4,group5);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4,group5);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  expect(populator.getLdapGroups("group2")).andReturn(Collections.EMPTY_SET);
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapBatchDto batchInfo=new LdapBatchDto();
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup1),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("group4")).andReturn(Collections.singleton(externalGroup1));
  expect(populator.getLdapGroups("group5")).andReturn(Collections.EMPTY_SET);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeExistingLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertTrue(result.getGroupsToBeRemoved().contains("group5"));
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_allExist() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("xgroup1").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("xgroup2").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup1),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup2),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("x*")).andReturn(externalGroups);
  expect(populator.getLdapGroups("group1")).andReturn(Collections.singleton(externalGroup1));
  expect(populator.getLdapGroups("group2")).andReturn(Collections.singleton(externalGroup2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("x*","group1","group2"),batchInfo);
  assertEquals(1,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group1"));
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("xgroup1"));
  assertTrue(result.getGroupsToBeCreated().contains("xgroup2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_update() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("user6").anyTimes();
  replay(externalUser2,externalUser3,externalUser1);
  expect(populator.getLdapUsers("user1")).andReturn(Collections.singleton(externalUser1));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  expect(populator.getLdapUsers("user6")).andReturn(Collections.singleton(externalUser3));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user2","user1","user6"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user1"));
  assertTrue(result.getUsersToBecomeLdap().contains("user6"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.ADKerberosOperationHandlerTest </h4><pre class="type-4 type-12 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessCreateTemplateDefault() throws Exception {
  PrincipalKeyCredential kc=new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD);
  Map<String,String> kerberosEnvMap=new HashMap<String,String>(){
{
      put(ADKerberosOperationHandler.KERBEROS_ENV_LDAP_URL,DEFAULT_LDAP_URL);
      put(ADKerberosOperationHandler.KERBEROS_ENV_PRINCIPAL_CONTAINER_DN,DEFAULT_PRINCIPAL_CONTAINER_DN);
    }
  }
;
  Capture<Name> capturedName=new Capture<Name>(CaptureType.ALL);
  Capture<Attributes> capturedAttributes=new Capture<Attributes>(CaptureType.ALL);
  ADKerberosOperationHandler handler=createMockBuilder(ADKerberosOperationHandler.class).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createInitialLdapContext",Properties.class,Control[].class)).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createSearchControls")).createNiceMock();
  NamingEnumeration<SearchResult> searchResult=createNiceMock(NamingEnumeration.class);
  expect(searchResult.hasMore()).andReturn(false).once();
  LdapContext ldapContext=createNiceMock(LdapContext.class);
  expect(ldapContext.search(anyObject(String.class),anyObject(String.class),anyObject(SearchControls.class))).andReturn(searchResult).once();
  expect(ldapContext.createSubcontext(capture(capturedName),capture(capturedAttributes))).andReturn(createNiceMock(DirContext.class)).anyTimes();
  expect(handler.createInitialLdapContext(anyObject(Properties.class),anyObject(Control[].class))).andReturn(ldapContext).once();
  expect(handler.createSearchControls()).andAnswer(new IAnswer<SearchControls>(){
    @Override public SearchControls answer() throws Throwable {
      SearchControls searchControls=createNiceMock(SearchControls.class);
      replay(searchControls);
      return searchControls;
    }
  }
).once();
  replayAll();
  handler.open(kc,DEFAULT_REALM,kerberosEnvMap);
  handler.createPrincipal("nn/c6501.ambari.apache.org","secret",true);
  handler.createPrincipal("hdfs@" + DEFAULT_REALM,"secret",false);
  handler.close();
  List<Attributes> attributesList=capturedAttributes.getValues();
  Attributes attributes;
  attributes=attributesList.get(0);
  String[] objectClasses=new String[]{"top","person","organizationalPerson","user"};
  Assert.assertNotNull(attributes);
  Assert.assertEquals(7,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("servicePrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("servicePrincipalName").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
  attributes=attributesList.get(1);
  Assert.assertNotNull(attributes);
  Assert.assertEquals(6,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("hdfs",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("hdfs@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.CreateKeytabFilesServerActionTest </h4><pre class="type-4 type-2 type-5 type-20 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureAmbariOnlyAccess() throws Exception {
  Assume.assumeTrue(ShellCommandUtil.UNIX_LIKE);
  Path path;
  Set<PosixFilePermission> permissions;
  File directory=testFolder.newFolder();
  Assert.assertNotNull(directory);
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(directory);
  path=Paths.get(directory.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(3,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  File file=File.createTempFile("temp_","",directory);
  Assert.assertNotNull(file);
  Assert.assertTrue(file.exists());
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(file);
  path=Paths.get(file.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosConfigDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosConfigDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosConfigDataFileWriter writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_SET);
  }
  for (int i=10; i < 15; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_REMOVE);
  }
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosConfigDataFileReader reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 15) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
      if (i < 10) {
        Assert.assertEquals("SET",record.get(KerberosConfigDataFileReader.OPERATION));
      }
 else {
        Assert.assertEquals("REMOVE",record.get(KerberosConfigDataFileReader.OPERATION));
      }
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_SET);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(16,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_REMOVE);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(17,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosIdentityDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosIdentityDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosIdentityDataFileWriter writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.writeRecord("hostName" + i,"serviceName" + i,"serviceComponentName" + i,"principal" + i,"principal_type" + i,"keytabFilePath" + i,"keytabFileOwnerName" + i,"keytabFileOwnerAccess" + i,"keytabFileGroupName" + i,"keytabFileGroupAccess" + i,"false");
  }
  writer.writeRecord("hostName's","serviceName#","serviceComponentName\"","principal","principal_type","keytabFilePath","'keytabFileOwnerName'","<keytabFileOwnerAccess>","\"keytabFileGroupName\"","keytab,File,Group,Access","false");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosIdentityDataFileReader reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(12,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(13,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosOperationHandlerTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileFromBase64EncodedData() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal="principal@REALM.COM";
  Assert.assertTrue(handler.createKeytabFile(principal,"some password",0,file));
  FileInputStream fis=new FileInputStream(file);
  byte[] data=new byte[(int)file.length()];
  Assert.assertEquals(data.length,fis.read(data));
  fis.close();
  File f=handler.createKeytabFile(Base64.encodeBase64String(data));
  if (f != null) {
    try {
      Keytab keytab=Keytab.read(f);
      Assert.assertNotNull(keytab);
      List<KeytabEntry> entries=keytab.getEntries();
      Assert.assertNotNull(entries);
      Assert.assertFalse(entries.isEmpty());
      for (      KeytabEntry entry : entries) {
        Assert.assertEquals(principal,entry.getPrincipalName());
      }
    }
  finally {
      if (!f.delete()) {
        f.deleteOnExit();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileOneAtATime() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  int count;
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  count=entries.size();
  for (  KeytabEntry entry : entries) {
    Assert.assertEquals(principal1,entry.getPrincipalName());
  }
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  Assert.assertEquals(count * 2,entries.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureKeytabFileContainsNoDuplicates() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  Set<String> seenEntries=new HashSet<String>();
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  for (  KeytabEntry entry : entries) {
    String seenEntry=String.format("%s|%s",entry.getPrincipalName(),entry.getKey().getKeyType().toString());
    Assert.assertFalse(seenEntries.contains(seenEntry));
    seenEntries.add(seenEntry);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.ComponentModuleTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ClientToUpdateConfigs(){
  List<String> clientsToUpdate=new ArrayList<String>();
  String client1="one";
  String client2="two";
  clientsToUpdate.add(client1);
  clientsToUpdate.add(client2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setClientsToUpdateConfigs(clientsToUpdate);
  assertEquals(clientsToUpdate,resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs());
  info.setClientsToUpdateConfigs(clientsToUpdate);
  parentInfo.setClientsToUpdateConfigs(null);
  assertEquals(clientsToUpdate,resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs());
  List<String> clientsToUpdate2=new ArrayList<String>();
  String client3="two";
  String client4="four";
  clientsToUpdate2.add(client3);
  clientsToUpdate2.add(client4);
  info.setClientsToUpdateConfigs(clientsToUpdate2);
  parentInfo.setClientsToUpdateConfigs(clientsToUpdate);
  List<String> resolvedClientsToUpdate=resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs();
  assertEquals(2,resolvedClientsToUpdate.size());
  assertTrue(resolvedClientsToUpdate.contains(client3));
  assertTrue(resolvedClientsToUpdate.contains(client4));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Dependencies(){
  List<DependencyInfo> dependencies=new ArrayList<DependencyInfo>();
  DependencyInfo dependency1=new DependencyInfo();
  dependency1.setName("service/one");
  DependencyInfo dependency2=new DependencyInfo();
  dependency2.setName("service/two");
  dependencies.add(dependency1);
  dependencies.add(dependency2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setDependencies(dependencies);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getDependencies());
  info.setDependencies(dependencies);
  parentInfo.setDependencies(null);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getDependencies());
  List<DependencyInfo> dependencies2=new ArrayList<DependencyInfo>();
  DependencyInfo dependency3=new DependencyInfo();
  dependency3.setName("service/two");
  DependencyInfo dependency4=new DependencyInfo();
  dependency4.setName("service/four");
  dependencies2.add(dependency3);
  dependencies2.add(dependency4);
  info.setDependencies(dependencies2);
  parentInfo.setDependencies(dependencies);
  List<DependencyInfo> resolvedDependencies=resolveComponent(info,parentInfo).getModuleInfo().getDependencies();
  assertEquals(3,resolvedDependencies.size());
  assertTrue(resolvedDependencies.contains(dependency1));
  assertTrue(resolvedDependencies.contains(dependency3));
  assertTrue(resolvedDependencies.contains(dependency4));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_CustomCommands() throws Exception {
  List<CustomCommandDefinition> commands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition command1=new CustomCommandDefinition();
  setPrivateField(command1,"name","one");
  CustomCommandDefinition command2=new CustomCommandDefinition();
  setPrivateField(command2,"name","two");
  commands.add(command1);
  commands.add(command2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setCustomCommands(commands);
  assertEquals(commands,resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands());
  info.setCustomCommands(commands);
  parentInfo.setCustomCommands(null);
  assertEquals(commands,resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands());
  List<CustomCommandDefinition> commands2=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition command3=new CustomCommandDefinition();
  setPrivateField(command3,"name","two");
  CustomCommandDefinition command4=new CustomCommandDefinition();
  setPrivateField(command4,"name","four");
  commands2.add(command3);
  commands2.add(command4);
  info.setCustomCommands(commands2);
  parentInfo.setCustomCommands(commands);
  List<CustomCommandDefinition> resolvedCommands=resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands();
  assertEquals(3,resolvedCommands.size());
  assertTrue(resolvedCommands.contains(command1));
  assertTrue(resolvedCommands.contains(command3));
  assertTrue(resolvedCommands.contains(command4));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ConfigDependencies(){
  List<String> dependencies=new ArrayList<String>();
  String dependency1="one";
  String dependency2="two";
  dependencies.add(dependency1);
  dependencies.add(dependency2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setConfigDependencies(dependencies);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies());
  info.setConfigDependencies(dependencies);
  parentInfo.setConfigDependencies(null);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies());
  List<String> dependencies2=new ArrayList<String>();
  String dependency3="two";
  String dependency4="four";
  dependencies2.add(dependency3);
  dependencies2.add(dependency4);
  info.setConfigDependencies(dependencies2);
  parentInfo.setConfigDependencies(dependencies);
  List<String> resolvedDependencies=resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies();
  assertEquals(2,resolvedDependencies.size());
  assertTrue(resolvedDependencies.contains(dependency3));
  assertTrue(resolvedDependencies.contains(dependency4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.ServiceModuleTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_MonitoringService() throws Exception {
  Boolean isMonitoringService=true;
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setMonitoringService(isMonitoringService);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(isMonitoringService,service.getModuleInfo().isMonitoringService());
  info.setMonitoringService(null);
  parentInfo.setMonitoringService(isMonitoringService);
  service=resolveService(info,parentInfo);
  assertEquals(isMonitoringService,service.getModuleInfo().isMonitoringService());
  info.setMonitoringService(isMonitoringService);
  parentInfo.setMonitoringService(false);
  service=resolveService(info,parentInfo);
  assertEquals(isMonitoringService,service.getModuleInfo().isMonitoringService());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_OsSpecifics() throws Exception {
  Map<String,ServiceOsSpecific> osSpecifics=new HashMap<String,ServiceOsSpecific>();
  osSpecifics.put("foo",new ServiceOsSpecific());
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setOsSpecifics(osSpecifics);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(osSpecifics,service.getModuleInfo().getOsSpecifics());
  info.setOsSpecifics(null);
  parentInfo.setOsSpecifics(osSpecifics);
  service=resolveService(info,parentInfo);
  assertEquals(osSpecifics,service.getModuleInfo().getOsSpecifics());
  Map<String,ServiceOsSpecific> osSpecifics2=new HashMap<String,ServiceOsSpecific>();
  osSpecifics.put("bar",new ServiceOsSpecific());
  info.setOsSpecifics(osSpecifics);
  parentInfo.setOsSpecifics(osSpecifics2);
  service=resolveService(info,parentInfo);
  assertEquals(osSpecifics,service.getModuleInfo().getOsSpecifics());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testInvalidServiceInfo(){
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setName("TEST_SERVICE");
  serviceInfo.setVersion("1.0.0");
  serviceInfo.setValid(false);
  serviceInfo.setErrors("Test error message");
  ServiceModule serviceModule=createServiceModule(serviceInfo);
  assertFalse("Service module should be invalid due to the service info being invalid !",serviceModule.isValid());
  assertTrue("Service module error collection should contain error message that caused service info being invalid !",serviceModule.getErrors().contains("Test error message"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_KerberosDescriptorFile() throws Exception {
  File kerberosDescriptorFile=new File("testKerberosDescriptorFile");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  assertEquals(kerberosDescriptorFile,child.getModuleInfo().getKerberosDescriptorFile());
  parent.getModuleInfo().setKerberosDescriptorFile(null);
  resolveService(child,parent);
  assertEquals(kerberosDescriptorFile,child.getModuleInfo().getKerberosDescriptorFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setKerberosDescriptorFile(kerberosDescriptorFile);
  child.getModuleInfo().setKerberosDescriptorFile(null);
  resolveService(child,parent);
  assertEquals(kerberosDescriptorFile,child.getModuleInfo().getKerberosDescriptorFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setKerberosDescriptorFile(new File("someOtherDir"));
  child.getModuleInfo().setKerberosDescriptorFile(kerberosDescriptorFile);
  resolveService(child,parent);
  assertEquals(kerberosDescriptorFile,child.getModuleInfo().getKerberosDescriptorFile());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ConfigDependencies() throws Exception {
  List<String> configDependencies=new ArrayList<String>();
  configDependencies.add("foo");
  configDependencies.add("bar");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setConfigDependencies(configDependencies);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(configDependencies,service.getModuleInfo().getConfigDependencies());
  info.setConfigDependencies(null);
  parentInfo.setConfigDependencies(configDependencies);
  service=resolveService(info,parentInfo);
  assertEquals(configDependencies,service.getModuleInfo().getConfigDependencies());
  List<String> parentCustomCommands=new ArrayList<String>();
  parentCustomCommands.add("bar");
  parentCustomCommands.add("other");
  info.setConfigDependencies(configDependencies);
  parentInfo.setConfigDependencies(parentCustomCommands);
  service=resolveService(info,parentInfo);
  Collection<String> mergedConfigDependencies=service.getModuleInfo().getConfigDependencies();
  assertEquals(3,mergedConfigDependencies.size());
  assertTrue(mergedConfigDependencies.contains("foo"));
  assertTrue(mergedConfigDependencies.contains("bar"));
  assertTrue(mergedConfigDependencies.contains("other"));
  info.setConfigDependencies(null);
  parentInfo.setConfigDependencies(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getConfigDependencies().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_Comment() throws Exception {
  String comment="test comment";
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setComment(comment);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(comment,service.getModuleInfo().getComment());
  info.setComment(null);
  parentInfo.setComment(comment);
  service=resolveService(info,parentInfo);
  assertEquals(comment,service.getModuleInfo().getComment());
  info.setComment(comment);
  parentInfo.setComment("other comment");
  service=resolveService(info,parentInfo);
  assertEquals(comment,service.getModuleInfo().getComment());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_CommandScript() throws Exception {
  CommandScriptDefinition commandScript=new CommandScriptDefinition();
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setCommandScript(commandScript);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(commandScript,service.getModuleInfo().getCommandScript());
  info.setCommandScript(null);
  parentInfo.setCommandScript(commandScript);
  service=resolveService(info,parentInfo);
  assertEquals(commandScript,service.getModuleInfo().getCommandScript());
  CommandScriptDefinition commandScript2=new CommandScriptDefinition();
  info.setCommandScript(commandScript);
  parentInfo.setCommandScript(commandScript2);
  service=resolveService(info,parentInfo);
  assertEquals(commandScript,service.getModuleInfo().getCommandScript());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeServicePropertiesInheritFromParent() throws Exception {
  ServiceInfo serviceInfo=new ServiceInfo();
  ServiceInfo parentServiceInfo=new ServiceInfo();
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("P1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("P2");
  p2.setValue("V2");
  List<ServicePropertyInfo> parentServicePropertyList=Lists.newArrayList(p1,p2);
  parentServiceInfo.setServicePropertyList(parentServicePropertyList);
  ServiceModule serviceModule=resolveService(serviceInfo,parentServiceInfo);
  Map<String,String> parentServiceProperties=ImmutableMap.<String,String>builder().put("P1","V1").put("P2","V2").put(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY).build();
  assertEquals(parentServicePropertyList,serviceModule.getModuleInfo().getServicePropertyList());
  assertEquals(parentServiceProperties,serviceModule.getModuleInfo().getServiceProperties());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__ExcludedTypes() throws Exception {
  ServiceInfo info=new ServiceInfo();
  info.setExcludedConfigTypes(Collections.singleton("BAR"));
  Collection<PropertyInfo> fooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop1=new PropertyInfo();
  prop1.setName("name1");
  prop1.setValue("val1");
  fooProperties.add(prop1);
  PropertyInfo prop2=new PropertyInfo();
  prop2.setName("name2");
  prop2.setValue("val2");
  fooProperties.add(prop2);
  Collection<PropertyInfo> barProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop3=new PropertyInfo();
  prop3.setName("name1");
  prop3.setValue("val3");
  barProperties.add(prop3);
  Collection<PropertyInfo> otherProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop4=new PropertyInfo();
  prop4.setName("name1");
  prop4.setValue("val4");
  otherProperties.add(prop4);
  ConfigurationModule configModule1=createConfigurationModule("FOO",fooProperties);
  ConfigurationModule configModule2=createConfigurationModule("BAR",barProperties);
  ConfigurationModule configModule3=createConfigurationModule("OTHER",otherProperties);
  Collection<ConfigurationModule> configModules=new ArrayList<ConfigurationModule>();
  configModules.add(configModule1);
  configModules.add(configModule2);
  configModules.add(configModule3);
  ServiceModule service=createServiceModule(info,configModules);
  List<PropertyInfo> properties=service.getModuleInfo().getProperties();
  assertEquals(4,properties.size());
  Map<String,Map<String,Map<String,String>>> attributes=service.getModuleInfo().getConfigTypeAttributes();
  assertEquals(2,attributes.size());
  assertTrue(attributes.containsKey("FOO"));
  assertTrue(attributes.containsKey("OTHER"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_ServicePackageFolder() throws Exception {
  String servicePackageFolder="packageDir";
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  assertEquals("packageDir",child.getModuleInfo().getServicePackageFolder());
  parent.getModuleInfo().setServicePackageFolder(null);
  resolveService(child,parent);
  assertEquals(servicePackageFolder,child.getModuleInfo().getServicePackageFolder());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setServicePackageFolder(servicePackageFolder);
  child.getModuleInfo().setServicePackageFolder(null);
  resolveService(child,parent);
  assertEquals(servicePackageFolder,child.getModuleInfo().getServicePackageFolder());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setServicePackageFolder("someOtherDir");
  child.getModuleInfo().setServicePackageFolder(servicePackageFolder);
  resolveService(child,parent);
  assertEquals(servicePackageFolder,child.getModuleInfo().getServicePackageFolder());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_CustomCommands() throws Exception {
  List<CustomCommandDefinition> customCommands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition cmd1=new CustomCommandDefinition();
  setPrivateField(cmd1,"name","cmd1");
  setPrivateField(cmd1,"background",false);
  CustomCommandDefinition cmd2=new CustomCommandDefinition();
  setPrivateField(cmd2,"name","cmd2");
  customCommands.add(cmd1);
  customCommands.add(cmd2);
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setCustomCommands(customCommands);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(customCommands,service.getModuleInfo().getCustomCommands());
  info.setCustomCommands(null);
  parentInfo.setCustomCommands(customCommands);
  service=resolveService(info,parentInfo);
  assertEquals(customCommands,service.getModuleInfo().getCustomCommands());
  List<CustomCommandDefinition> parentCustomCommands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition cmd3=new CustomCommandDefinition();
  setPrivateField(cmd3,"name","cmd1");
  setPrivateField(cmd3,"background",true);
  CustomCommandDefinition cmd4=new CustomCommandDefinition();
  setPrivateField(cmd4,"name","cmd4");
  parentCustomCommands.add(cmd3);
  parentCustomCommands.add(cmd4);
  info.setCustomCommands(customCommands);
  parentInfo.setCustomCommands(parentCustomCommands);
  service=resolveService(info,parentInfo);
  Collection<CustomCommandDefinition> mergedCommands=service.getModuleInfo().getCustomCommands();
  assertEquals(3,mergedCommands.size());
  assertTrue(mergedCommands.contains(cmd2));
  assertTrue(mergedCommands.contains(cmd3));
  assertTrue(mergedCommands.contains(cmd4));
  info.setCustomCommands(null);
  parentInfo.setCustomCommands(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getCustomCommands().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_Configuration__properties() throws Exception {
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  Collection<PropertyInfo> childFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo childProp1=new PropertyInfo();
  childProp1.setName("childName1");
  childProp1.setValue("childVal1");
  childFooProperties.add(childProp1);
  Collection<PropertyInfo> childBarProperties=new ArrayList<PropertyInfo>();
  PropertyInfo childProp2=new PropertyInfo();
  childProp2.setName("childName2");
  childProp2.setValue("childVal2");
  childBarProperties.add(childProp2);
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put(ConfigurationInfo.Supports.DO_NOT_EXTEND.getXmlAttributeName(),"true");
  ConfigurationModule childConfigModule1=createConfigurationModule("FOO",childFooProperties);
  ConfigurationModule childConfigModule2=createConfigurationModule("BAR",childBarProperties,attributes);
  Collection<ConfigurationModule> childModules=new ArrayList<ConfigurationModule>();
  childModules.add(childConfigModule1);
  childModules.add(childConfigModule2);
  Collection<PropertyInfo> parentFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp1=new PropertyInfo();
  parentProp1.setName("parentName1");
  parentProp1.setValue("parentVal1");
  parentFooProperties.add(parentProp1);
  PropertyInfo parentProp12=new PropertyInfo();
  parentProp12.setName("childName1");
  parentProp12.setValue("parentVal1");
  parentFooProperties.add(parentProp12);
  Collection<PropertyInfo> parentBarProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp2=new PropertyInfo();
  parentProp2.setName("parentName2");
  parentProp2.setValue("parentVal2");
  parentBarProperties.add(parentProp2);
  Collection<PropertyInfo> parentOtherProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp3=new PropertyInfo();
  parentProp3.setName("parentName3");
  parentProp3.setValue("parentVal3");
  parentOtherProperties.add(parentProp3);
  ConfigurationModule parentConfigModule1=createConfigurationModule("FOO",parentFooProperties);
  ConfigurationModule parentConfigModule2=createConfigurationModule("BAR",parentBarProperties);
  ConfigurationModule parentConfigModule3=createConfigurationModule("OTHER",parentOtherProperties);
  Collection<ConfigurationModule> parentModules=new ArrayList<ConfigurationModule>();
  parentModules.add(parentConfigModule1);
  parentModules.add(parentConfigModule2);
  parentModules.add(parentConfigModule3);
  ServiceModule child=createServiceModule(info,childModules);
  ServiceModule parent=createServiceModule(parentInfo,parentModules);
  resolveService(child,parent);
  List<PropertyInfo> mergedProperties=child.getModuleInfo().getProperties();
  assertEquals(4,mergedProperties.size());
  Map<String,PropertyInfo> mergedPropertyMap=new HashMap<String,PropertyInfo>();
  for (  PropertyInfo prop : mergedProperties) {
    mergedPropertyMap.put(prop.getName(),prop);
  }
  assertEquals("childVal1",mergedPropertyMap.get("childName1").getValue());
  assertEquals("childVal2",mergedPropertyMap.get("childName2").getValue());
  assertEquals("parentVal1",mergedPropertyMap.get("parentName1").getValue());
  assertEquals("parentVal3",mergedPropertyMap.get("parentName3").getValue());
  Map<String,Map<String,Map<String,String>>> childAttributes=child.getModuleInfo().getConfigTypeAttributes();
  Map<String,Map<String,Map<String,String>>> parentAttributes=parent.getModuleInfo().getConfigTypeAttributes();
  assertEquals(3,childAttributes.size());
  assertAttributes(childAttributes.get("FOO"),Collections.<String,String>emptyMap());
  assertAttributes(childAttributes.get("BAR"),attributes);
  assertAttributes(childAttributes.get("OTHER"),Collections.<String,String>emptyMap());
  assertEquals(3,parentAttributes.size());
  assertAttributes(parentAttributes.get("FOO"),Collections.<String,String>emptyMap());
  assertAttributes(parentAttributes.get("BAR"),Collections.<String,String>emptyMap());
  assertAttributes(parentAttributes.get("OTHER"),Collections.<String,String>emptyMap());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__ExcludedTypes__ParentType() throws Exception {
  ServiceInfo info=new ServiceInfo();
  info.setExcludedConfigTypes(Collections.singleton("BAR"));
  Collection<PropertyInfo> fooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop1=new PropertyInfo();
  prop1.setName("name1");
  prop1.setValue("val1");
  fooProperties.add(prop1);
  PropertyInfo prop2=new PropertyInfo();
  prop2.setName("name2");
  prop2.setValue("val2");
  fooProperties.add(prop2);
  ConfigurationModule childConfigModule=createConfigurationModule("FOO",fooProperties);
  Collection<ConfigurationModule> childConfigModules=new ArrayList<ConfigurationModule>();
  childConfigModules.add(childConfigModule);
  ServiceInfo parentInfo=new ServiceInfo();
  Collection<PropertyInfo> barProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop3=new PropertyInfo();
  prop3.setName("name1");
  prop3.setValue("val3");
  barProperties.add(prop3);
  ConfigurationModule parentConfigModule=createConfigurationModule("BAR",barProperties);
  Collection<ConfigurationModule> parentConfigModules=new ArrayList<ConfigurationModule>();
  parentConfigModules.add(parentConfigModule);
  ServiceModule service=createServiceModule(info,childConfigModules);
  ServiceModule parentService=createServiceModule(parentInfo,parentConfigModules);
  resolveService(service,parentService);
  List<PropertyInfo> properties=service.getModuleInfo().getProperties();
  assertEquals(2,properties.size());
  Map<String,Map<String,Map<String,String>>> attributes=service.getModuleInfo().getConfigTypeAttributes();
  assertEquals(1,attributes.size());
  assertTrue(attributes.containsKey("FOO"));
  Map<String,Map<String,Map<String,String>>> parentAttributes=parentService.getModuleInfo().getConfigTypeAttributes();
  assertEquals(1,parentAttributes.size());
  assertTrue(parentAttributes.containsKey("BAR"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_RestartRequiredAfterChange() throws Exception {
  Boolean isRestartRequired=true;
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setRestartRequiredAfterChange(isRestartRequired);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(isRestartRequired,service.getModuleInfo().isRestartRequiredAfterChange());
  info.setRestartRequiredAfterChange(null);
  parentInfo.setRestartRequiredAfterChange(isRestartRequired);
  service=resolveService(info,parentInfo);
  assertEquals(isRestartRequired,service.getModuleInfo().isRestartRequiredAfterChange());
  info.setRestartRequiredAfterChange(isRestartRequired);
  parentInfo.setRestartRequiredAfterChange(false);
  service=resolveService(info,parentInfo);
  assertEquals(isRestartRequired,service.getModuleInfo().isRestartRequiredAfterChange());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_RequiredServices() throws Exception {
  List<String> requiredServices=new ArrayList<String>();
  requiredServices.add("foo");
  requiredServices.add("bar");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setRequiredServices(requiredServices);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(null);
  parentInfo.setRequiredServices(requiredServices);
  service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(requiredServices);
  parentInfo.setRequiredServices(Collections.singletonList("other"));
  service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(null);
  parentInfo.setRequiredServices(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getRequiredServices().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeServiceProperties() throws Exception {
  ServiceInfo serviceInfo=new ServiceInfo();
  ServiceInfo parentServiceInfo=new ServiceInfo();
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("P1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("P2");
  p2.setValue("V2");
  ServicePropertyInfo p2Override=new ServicePropertyInfo();
  p2Override.setName("P2");
  p2Override.setValue("V2_OVERRIDE");
  ServicePropertyInfo p3=new ServicePropertyInfo();
  p3.setName("P3");
  p3.setValue("V3");
  List<ServicePropertyInfo> parentServicePropertyList=Lists.newArrayList(p1,p2);
  parentServiceInfo.setServicePropertyList(parentServicePropertyList);
  List<ServicePropertyInfo> servicePropertyList=Lists.newArrayList(p2Override,p3);
  serviceInfo.setServicePropertyList(servicePropertyList);
  ServiceModule serviceModule=resolveService(serviceInfo,parentServiceInfo);
  List<ServicePropertyInfo> expectedPropertyList=Lists.newArrayList(p1,p2Override,p3);
  Map<String,String> expectedServiceProperties=ImmutableMap.<String,String>builder().put("P1","V1").put("P2","V2_OVERRIDE").put("P3","V3").put(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY).build();
  List<ServicePropertyInfo> actualPropertyList=serviceModule.getModuleInfo().getServicePropertyList();
  assertTrue(actualPropertyList.containsAll(expectedPropertyList) && expectedPropertyList.containsAll(actualPropertyList));
  assertEquals(expectedServiceProperties,serviceModule.getModuleInfo().getServiceProperties());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_MetricsFile() throws Exception {
  File metricsFile=new File("testMetricsFile");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  assertEquals(metricsFile,child.getModuleInfo().getMetricsFile());
  parent.getModuleInfo().setMetricsFile(null);
  resolveService(child,parent);
  assertEquals(metricsFile,child.getModuleInfo().getMetricsFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setMetricsFile(metricsFile);
  child.getModuleInfo().setMetricsFile(null);
  resolveService(child,parent);
  assertEquals(metricsFile,child.getModuleInfo().getMetricsFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setMetricsFile(new File("someOtherDir"));
  child.getModuleInfo().setMetricsFile(metricsFile);
  resolveService(child,parent);
  assertEquals(metricsFile,child.getModuleInfo().getMetricsFile());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__attributes() throws Exception {
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  Collection<PropertyInfo> childFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo childProp1=new PropertyInfo();
  childProp1.setName("childName1");
  childProp1.setValue("childVal1");
  childFooProperties.add(childProp1);
  Map<String,String> childFooAttributes=new HashMap<String,String>();
  childFooAttributes.put(ConfigurationInfo.Supports.ADDING_FORBIDDEN.getXmlAttributeName(),"false");
  ConfigurationModule childConfigModule1=createConfigurationModule("FOO",childFooProperties,childFooAttributes);
  Collection<ConfigurationModule> childModules=new ArrayList<ConfigurationModule>();
  childModules.add(childConfigModule1);
  Collection<PropertyInfo> parentFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp1=new PropertyInfo();
  parentProp1.setName("parentName1");
  parentProp1.setValue("parentVal1");
  parentFooProperties.add(parentProp1);
  Map<String,String> parentFooAttributes=new HashMap<String,String>();
  parentFooAttributes.put(ConfigurationInfo.Supports.FINAL.getXmlAttributeName(),"true");
  parentFooAttributes.put(ConfigurationInfo.Supports.ADDING_FORBIDDEN.getXmlAttributeName(),"true");
  Collection<PropertyInfo> parentBarProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp2=new PropertyInfo();
  parentProp2.setName("parentName2");
  parentProp2.setValue("parentVal2");
  parentBarProperties.add(parentProp2);
  ConfigurationModule parentConfigModule1=createConfigurationModule("FOO",parentFooProperties,parentFooAttributes);
  ConfigurationModule parentConfigModule2=createConfigurationModule("BAR",parentBarProperties);
  Collection<ConfigurationModule> parentModules=new ArrayList<ConfigurationModule>();
  parentModules.add(parentConfigModule1);
  parentModules.add(parentConfigModule2);
  ServiceModule child=createServiceModule(info,childModules);
  ServiceModule parent=createServiceModule(parentInfo,parentModules);
  resolveService(child,parent);
  Map<String,Map<String,Map<String,String>>> childTypeAttributes=child.getModuleInfo().getConfigTypeAttributes();
  Map<String,Map<String,Map<String,String>>> parentTypeAttributes=parent.getModuleInfo().getConfigTypeAttributes();
  assertTrue(childTypeAttributes.containsKey("FOO"));
  Map<String,Map<String,String>> mergedChildFooAttributes=childTypeAttributes.get("FOO");
  assertTrue(mergedChildFooAttributes.containsKey(ConfigurationInfo.Supports.KEYWORD));
  assertEquals("true",mergedChildFooAttributes.get(ConfigurationInfo.Supports.KEYWORD).get(ConfigurationInfo.Supports.valueOf("FINAL").getPropertyName()));
  assertEquals("false",mergedChildFooAttributes.get(ConfigurationInfo.Supports.KEYWORD).get(ConfigurationInfo.Supports.valueOf("ADDING_FORBIDDEN").getPropertyName()));
  assertEquals(2,childTypeAttributes.size());
  assertEquals(2,parentTypeAttributes.size());
  assertAttributes(parentTypeAttributes.get("FOO"),parentFooAttributes);
  assertAttributes(parentTypeAttributes.get("BAR"),Collections.<String,String>emptyMap());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_DisplayName() throws Exception {
  String displayName="test_display_name";
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setDisplayName(displayName);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(displayName,service.getModuleInfo().getDisplayName());
  info.setDisplayName(null);
  parentInfo.setDisplayName(displayName);
  service=resolveService(info,parentInfo);
  assertEquals(displayName,service.getModuleInfo().getDisplayName());
  info.setDisplayName(displayName);
  parentInfo.setDisplayName("other display name");
  service=resolveService(info,parentInfo);
  assertEquals(displayName,service.getModuleInfo().getDisplayName());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeServicePropertiesInheritFromEmptyParent() throws Exception {
  ServiceInfo serviceInfo=new ServiceInfo();
  ServiceInfo parentServiceInfo=new ServiceInfo();
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("P1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("P2");
  p2.setValue("V2");
  List<ServicePropertyInfo> servicePropertyList=Lists.newArrayList(p1,p2);
  serviceInfo.setServicePropertyList(servicePropertyList);
  ServiceModule serviceModule=resolveService(serviceInfo,parentServiceInfo);
  Map<String,String> serviceProperties=ImmutableMap.<String,String>builder().put("P1","V1").put("P2","V2").put(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY).build();
  assertEquals(servicePropertyList,serviceModule.getModuleInfo().getServicePropertyList());
  assertEquals(serviceProperties,serviceModule.getModuleInfo().getServiceProperties());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_AlertsFile() throws Exception {
  File alertsFile=new File("testAlertsFile");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  assertEquals(alertsFile,child.getModuleInfo().getAlertsFile());
  parent.getModuleInfo().setAlertsFile(null);
  resolveService(child,parent);
  assertEquals(alertsFile,child.getModuleInfo().getAlertsFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setAlertsFile(alertsFile);
  child.getModuleInfo().setAlertsFile(null);
  resolveService(child,parent);
  assertEquals(alertsFile,child.getModuleInfo().getAlertsFile());
  child=createServiceModule(info);
  parent=createServiceModule(parentInfo);
  parent.getModuleInfo().setAlertsFile(new File("someOtherDir"));
  child.getModuleInfo().setAlertsFile(alertsFile);
  resolveService(child,parent);
  assertEquals(alertsFile,child.getModuleInfo().getAlertsFile());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolve_Version() throws Exception {
  String version="1.1";
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setVersion(version);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(version,service.getModuleInfo().getVersion());
  info.setVersion(null);
  parentInfo.setVersion(version);
  service=resolveService(info,parentInfo);
  assertEquals(version,service.getModuleInfo().getVersion());
  info.setVersion(version);
  parentInfo.setVersion("1.0");
  service=resolveService(info,parentInfo);
  assertEquals(version,service.getModuleInfo().getVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Components() throws Exception {
  ComponentInfo info1=new ComponentInfo();
  info1.setName("1");
  ComponentInfo info2=new ComponentInfo();
  info2.setName("2");
  ComponentInfo XX=new ComponentInfo();
  XX.setName("XX");
  ComponentInfo info3=new ComponentInfo();
  info3.setName("1");
  info3.setCardinality("ALL");
  info3.setCategory("category");
  ComponentInfo info4=new ComponentInfo();
  info4.setName("4");
  ComponentInfo info5=new ComponentInfo();
  info5.setName("XX");
  info5.setDeleted(true);
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  List<ComponentInfo> childComponents=info.getComponents();
  childComponents.add(info3);
  childComponents.add(info4);
  childComponents.add(info5);
  List<ComponentInfo> parentComponents=parentInfo.getComponents();
  parentComponents.add(info1);
  parentComponents.add(info2);
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  resolveService(child,parent);
  List<ComponentInfo> components=child.getModuleInfo().getComponents();
  assertEquals(3,components.size());
  Map<String,ComponentInfo> mergedComponents=new HashMap<String,ComponentInfo>();
  for (  ComponentInfo component : components) {
    mergedComponents.put(component.getName(),component);
  }
  assertTrue(mergedComponents.containsKey("1"));
  assertTrue(mergedComponents.containsKey("2"));
  assertTrue(mergedComponents.containsKey("4"));
  assertEquals("ALL",mergedComponents.get("1").getCardinality());
  assertEquals("category",mergedComponents.get("1").getCategory());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMerge_Configuration__ExcludedTypes() throws Exception {
  ServiceInfo info=new ServiceInfo();
  Set<String> childExcludedConfigTypes=new HashSet<String>();
  childExcludedConfigTypes.add("FOO");
  info.setExcludedConfigTypes(childExcludedConfigTypes);
  Collection<PropertyInfo> fooProperties=new ArrayList<PropertyInfo>();
  ConfigurationModule childConfigModule=createConfigurationModule("FOO",fooProperties);
  Collection<ConfigurationModule> childConfigModules=new ArrayList<ConfigurationModule>();
  childConfigModules.add(childConfigModule);
  ServiceInfo parentInfo=new ServiceInfo();
  Set<String> parentExcludedConfigTypes=new HashSet<String>();
  childExcludedConfigTypes.add("BAR");
  info.setExcludedConfigTypes(childExcludedConfigTypes);
  parentInfo.setExcludedConfigTypes(parentExcludedConfigTypes);
  Collection<PropertyInfo> barProperties=new ArrayList<PropertyInfo>();
  ConfigurationModule parentConfigModule=createConfigurationModule("BAR",barProperties);
  Collection<ConfigurationModule> parentConfigModules=new ArrayList<ConfigurationModule>();
  parentConfigModules.add(parentConfigModule);
  ServiceModule service=createServiceModule(info,childConfigModules);
  ServiceModule parentService=createServiceModule(parentInfo,parentConfigModules);
  resolveService(service,parentService);
  assertEquals(2,service.getModuleInfo().getExcludedConfigTypes().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerCommonServicesTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(2,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertFalse(pkg.getSkipUpgrade());
  ServiceOsSpecific.Package lzoPackage=packages.get(1);
  assertEquals("lzo",lzoPackage.getName());
  assertTrue(lzoPackage.getSkipUpgrade());
  assertEquals(pigService.getParent(),"common-services/PIG/1.0");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerMiscTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test ensures the service status check is added into the action metadata when
 * the stack has no parent and is the only stack in the stack family
 */
@Test public void testGetServiceInfoFromSingleStack() throws Exception {
  MetainfoDAO metaInfoDao=createNiceMock(MetainfoDAO.class);
  StackDAO stackDao=createNiceMock(StackDAO.class);
  ActionMetadata actionMetadata=createNiceMock(ActionMetadata.class);
  OsFamily osFamily=createNiceMock(OsFamily.class);
  StackEntity stackEntity=createNiceMock(StackEntity.class);
  actionMetadata.addServiceCheckAction("HDFS");
  expect(stackDao.find(EasyMock.anyObject(String.class),EasyMock.anyObject(String.class))).andReturn(stackEntity).atLeastOnce();
  replay(metaInfoDao,stackDao,actionMetadata,osFamily);
  String singleStack=ClassLoader.getSystemClassLoader().getResource("single_stack").getPath();
  StackManager stackManager=new StackManager(new File(singleStack.replace(StackManager.PATH_DELIMITER,File.separator)),null,osFamily,metaInfoDao,actionMetadata,stackDao);
  Collection<StackInfo> stacks=stackManager.getStacks();
  assertEquals(1,stacks.size());
  assertNotNull(stacks.iterator().next().getService("HDFS"));
  verify(metaInfoDao,stackDao,actionMetadata,osFamily);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientConfigFilesInheritance() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo zkService=stack.getService("ZOOKEEPER");
  List<ComponentInfo> components=zkService.getComponents();
  assertTrue(components.size() == 2);
  ComponentInfo componentInfo=components.get(1);
  List<ClientConfigFileDefinition> clientConfigs=componentInfo.getClientConfigFiles();
  assertEquals(2,clientConfigs.size());
  assertEquals("zookeeper-env",clientConfigs.get(0).getDictionaryName());
  assertEquals("zookeeper-env.sh",clientConfigs.get(0).getFileName());
  assertEquals("env",clientConfigs.get(0).getType());
  assertEquals("zookeeper-log4j",clientConfigs.get(1).getDictionaryName());
  assertEquals("log4j.properties",clientConfigs.get(1).getFileName());
  assertEquals("env",clientConfigs.get(1).getType());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceExtension(){
  StackInfo stack=stackManager.getStack("OTHER","1.0");
  assertNotNull(stack);
  assertEquals("OTHER",stack.getName());
  assertEquals("1.0",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  assertEquals(6,stack.getService("HDFS").getComponents().size());
  ServiceInfo sqoopService=stack.getService("SQOOP2");
  assertNotNull(sqoopService);
  assertEquals("Extended SQOOP",sqoopService.getComment());
  assertEquals("Extended Version",sqoopService.getVersion());
  assertNull(sqoopService.getServicePackageFolder());
  Collection<ComponentInfo> components=sqoopService.getComponents();
  assertEquals(1,components.size());
  ComponentInfo component=components.iterator().next();
  assertEquals("SQOOP",component.getName());
  StackInfo baseStack=stackManager.getStack("HDP","2.1.1");
  ServiceInfo baseSqoopService=baseStack.getService("SQOOP");
  assertEquals(baseSqoopService.isDeleted(),sqoopService.isDeleted());
  assertEquals(baseSqoopService.getAlertsFile(),sqoopService.getAlertsFile());
  assertEquals(baseSqoopService.getClientComponent(),sqoopService.getClientComponent());
  assertEquals(baseSqoopService.getCommandScript(),sqoopService.getCommandScript());
  assertEquals(baseSqoopService.getConfigDependencies(),sqoopService.getConfigDependencies());
  assertEquals(baseSqoopService.getConfigDir(),sqoopService.getConfigDir());
  assertEquals(baseSqoopService.getConfigDependenciesWithComponents(),sqoopService.getConfigDependenciesWithComponents());
  assertEquals(baseSqoopService.getConfigTypeAttributes(),sqoopService.getConfigTypeAttributes());
  assertEquals(baseSqoopService.getCustomCommands(),sqoopService.getCustomCommands());
  assertEquals(baseSqoopService.getExcludedConfigTypes(),sqoopService.getExcludedConfigTypes());
  assertEquals(baseSqoopService.getProperties(),sqoopService.getProperties());
  assertEquals(baseSqoopService.getMetrics(),sqoopService.getMetrics());
  assertNull(baseSqoopService.getMetricsFile());
  assertNull(sqoopService.getMetricsFile());
  assertEquals(baseSqoopService.getOsSpecifics(),sqoopService.getOsSpecifics());
  assertEquals(baseSqoopService.getRequiredServices(),sqoopService.getRequiredServices());
  assertEquals(baseSqoopService.getSchemaVersion(),sqoopService.getSchemaVersion());
  ServiceInfo stormService=stack.getService("STORM");
  assertNotNull(stormService);
  assertEquals("STORM",stormService.getName());
  ServiceInfo baseStormService=baseStack.getService("STORM");
  assertEquals("Apache Hadoop Stream processing framework (Extended)",stormService.getComment());
  assertEquals("New version",stormService.getVersion());
  String packageDir=StringUtils.join(new String[]{"stacks","OTHER","1.0","services","STORM","package"},File.separator);
  assertEquals(packageDir,stormService.getServicePackageFolder());
  List<ComponentInfo> stormServiceComponents=stormService.getComponents();
  List<ComponentInfo> baseStormServiceComponents=baseStormService.getComponents();
  assertEquals(new HashSet<ComponentInfo>(stormServiceComponents),new HashSet<ComponentInfo>(baseStormServiceComponents));
  assertEquals(baseStormService.isDeleted(),stormService.isDeleted());
  assertEquals(baseStormService.getAlertsFile(),stormService.getAlertsFile());
  assertEquals(baseStormService.getClientComponent(),stormService.getClientComponent());
  assertEquals(baseStormService.getCommandScript(),stormService.getCommandScript());
  assertEquals(baseStormService.getConfigDependencies(),stormService.getConfigDependencies());
  assertEquals(baseStormService.getConfigDir(),stormService.getConfigDir());
  assertEquals(baseStormService.getConfigDependenciesWithComponents(),stormService.getConfigDependenciesWithComponents());
  assertEquals(baseStormService.getConfigTypeAttributes(),stormService.getConfigTypeAttributes());
  assertEquals(baseStormService.getCustomCommands(),stormService.getCustomCommands());
  assertEquals(baseStormService.getExcludedConfigTypes(),stormService.getExcludedConfigTypes());
  assertEquals(baseStormService.getProperties(),stormService.getProperties());
  assertEquals(baseStormService.getMetrics(),stormService.getMetrics());
  assertNotNull(baseStormService.getMetricsFile());
  assertNotNull(stormService.getMetricsFile());
  assertFalse(baseStormService.getMetricsFile().equals(stormService.getMetricsFile()));
  assertEquals(baseStormService.getOsSpecifics(),stormService.getOsSpecifics());
  assertEquals(baseStormService.getRequiredServices(),stormService.getRequiredServices());
  assertEquals(baseStormService.getSchemaVersion(),stormService.getSchemaVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMergeRoleCommandOrder() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.1.1");
  Map<String,Object> roleCommandOrder=stack.getRoleCommandOrder().getContent();
  assertTrue(roleCommandOrder.containsKey("optional_glusterfs"));
  assertTrue(roleCommandOrder.containsKey("general_deps"));
  assertTrue(roleCommandOrder.containsKey("optional_no_glusterfs"));
  assertTrue(roleCommandOrder.containsKey("namenode_optional_ha"));
  assertTrue(roleCommandOrder.containsKey("resourcemanager_optional_ha"));
  Map<String,Object> generalDeps=(Map<String,Object>)roleCommandOrder.get("general_deps");
  assertTrue(generalDeps.containsKey("HBASE_MASTER-START"));
  assertTrue(generalDeps.containsKey("HBASE_REGIONSERVER-START"));
  Map<String,Object> optionalNoGlusterfs=(Map<String,Object>)roleCommandOrder.get("optional_no_glusterfs");
  assertTrue(optionalNoGlusterfs.containsKey("SECONDARY_NAMENODE-START"));
  ArrayList<String> hbaseMasterStartValues=(ArrayList<String>)generalDeps.get("HBASE_MASTER-START");
  assertTrue(hbaseMasterStartValues.get(0).equals("ZOOKEEPER_SERVER-START"));
  assertTrue(optionalNoGlusterfs.containsKey("NAMENODE-STOP"));
  ArrayList<String> nameNodeStopValues=(ArrayList<String>)optionalNoGlusterfs.get("NAMENODE-STOP");
  assertTrue(nameNodeStopValues.contains("JOBTRACKER-STOP"));
  assertTrue(nameNodeStopValues.contains("CUSTOM_MASTER-STOP"));
  assertTrue(generalDeps.containsKey("CUSTOM_MASTER-START"));
  ArrayList<String> customMasterStartValues=(ArrayList<String>)generalDeps.get("CUSTOM_MASTER-START");
  assertTrue(customMasterStartValues.contains("ZOOKEEPER_SERVER-START"));
  assertTrue(customMasterStartValues.contains("NAMENODE-START"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServicesWithRangerPluginRoleCommandOrder() throws AmbariException {
  String stackRoot=ClassLoader.getSystemClassLoader().getResource("stacks").getPath().replace("test-classes","classes");
  String commonServices=ClassLoader.getSystemClassLoader().getResource("common-services").getPath().replace("test-classes","classes");
  MetainfoDAO metaInfoDao=createNiceMock(MetainfoDAO.class);
  StackDAO stackDao=createNiceMock(StackDAO.class);
  ActionMetadata actionMetadata=createNiceMock(ActionMetadata.class);
  Configuration config=createNiceMock(Configuration.class);
  expect(config.getSharedResourcesDirPath()).andReturn(ClassLoader.getSystemClassLoader().getResource("").getPath()).anyTimes();
  replay(config,metaInfoDao,stackDao,actionMetadata);
  OsFamily osFamily=new OsFamily(config);
  StackManager stackManager=new StackManager(new File(stackRoot),new File(commonServices),osFamily,metaInfoDao,actionMetadata,stackDao);
  String rangerUserSyncRoleCommand=Role.RANGER_USERSYNC + "-" + RoleCommand.START;
  String rangerAdminRoleCommand=Role.RANGER_ADMIN + "-" + RoleCommand.START;
  String zookeeperServerRoleCommand=Role.ZOOKEEPER_SERVER + "-" + RoleCommand.START;
  String nodeManagerRoleCommand=Role.NODEMANAGER + "-" + RoleCommand.START;
  String mySqlServerRoleCommand=Role.MYSQL_SERVER + "-" + RoleCommand.START;
  StackInfo hdp=stackManager.getStack("HDP","2.3");
  Map<String,Object> rco=hdp.getRoleCommandOrder().getContent();
  Map<String,Object> generalDeps=(Map<String,Object>)rco.get("general_deps");
  Map<String,Object> optionalNoGlusterfs=(Map<String,Object>)rco.get("optional_no_glusterfs");
  String nameNodeRoleCommand=Role.NAMENODE + "-" + RoleCommand.START;
  ArrayList<String> nameNodeBlockers=(ArrayList<String>)optionalNoGlusterfs.get(nameNodeRoleCommand);
  assertTrue(nameNodeRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,nameNodeBlockers.contains(rangerUserSyncRoleCommand));
  String dataNodeRoleCommand=Role.DATANODE + "-" + RoleCommand.START;
  ArrayList<String> dataNodeBlockers=(ArrayList<String>)optionalNoGlusterfs.get(dataNodeRoleCommand);
  assertTrue(dataNodeRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,dataNodeBlockers.contains(rangerUserSyncRoleCommand));
  String resourceManagerCommandRoleCommand=Role.RESOURCEMANAGER + "-" + RoleCommand.START;
  ArrayList<String> resourceManagerBlockers=(ArrayList<String>)generalDeps.get(resourceManagerCommandRoleCommand);
  assertTrue(resourceManagerCommandRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,resourceManagerBlockers.contains(rangerUserSyncRoleCommand));
  String hbaseRoleCommand=Role.HBASE_MASTER + "-" + RoleCommand.START;
  ArrayList<String> hbaseBlockers=(ArrayList<String>)generalDeps.get(hbaseRoleCommand);
  assertTrue(hbaseRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,hbaseBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(hbaseRoleCommand + " should be dependent of " + zookeeperServerRoleCommand,hbaseBlockers.contains(zookeeperServerRoleCommand));
  String knoxRoleCommand=Role.KNOX_GATEWAY + "-" + RoleCommand.START;
  ArrayList<String> knoxBlockers=(ArrayList<String>)generalDeps.get(knoxRoleCommand);
  assertTrue(knoxRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,knoxBlockers.contains(rangerUserSyncRoleCommand));
  String kafkaRoleCommand=Role.KAFKA_BROKER + "-" + RoleCommand.START;
  ArrayList<String> kafkaBlockers=(ArrayList<String>)generalDeps.get(kafkaRoleCommand);
  assertTrue(Role.KAFKA_BROKER + "-" + RoleCommand.START+ " should be dependent of "+ rangerUserSyncRoleCommand,kafkaBlockers.contains(rangerUserSyncRoleCommand));
  String hiveRoleCommand=Role.HIVE_SERVER + "-" + RoleCommand.START;
  ArrayList<String> hiveBlockers=(ArrayList<String>)generalDeps.get(hiveRoleCommand);
  assertTrue(hiveRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,hiveBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(hiveRoleCommand + " should be dependent of " + nodeManagerRoleCommand,hiveBlockers.contains(nodeManagerRoleCommand));
  assertTrue(hiveRoleCommand + " should be dependent of " + mySqlServerRoleCommand,hiveBlockers.contains(mySqlServerRoleCommand));
  String stormRoleCommand=Role.NIMBUS + "-" + RoleCommand.START;
  ArrayList<String> stormBlockers=(ArrayList<String>)generalDeps.get(stormRoleCommand);
  assertTrue(stormRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,stormBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(stormRoleCommand + " should be dependent of " + zookeeperServerRoleCommand,stormBlockers.contains(zookeeperServerRoleCommand));
  String kmsRoleCommand=Role.RANGER_KMS_SERVER + "-" + RoleCommand.START;
  ArrayList<String> rangerKmsBlockers=(ArrayList<String>)generalDeps.get(kmsRoleCommand);
  assertTrue(kmsRoleCommand + " should be dependent of " + rangerAdminRoleCommand,rangerKmsBlockers.contains(rangerAdminRoleCommand));
  ArrayList<String> rangerUserSyncBlockers=(ArrayList<String>)generalDeps.get(rangerUserSyncRoleCommand);
  assertTrue(rangerUserSyncRoleCommand + " should be dependent of " + rangerAdminRoleCommand,rangerUserSyncBlockers.contains(rangerAdminRoleCommand));
  assertTrue(rangerUserSyncRoleCommand + " should be dependent of " + kmsRoleCommand,rangerUserSyncBlockers.contains(kmsRoleCommand));
  ArrayList<String> zookeeperBlockers=(ArrayList<String>)generalDeps.get(zookeeperServerRoleCommand);
  assertTrue(zookeeperServerRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,zookeeperBlockers.contains(rangerUserSyncRoleCommand));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigTypes() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.7");
  ServiceInfo hdfsService=stack.getService("HDFS");
  Map<String,Map<String,Map<String,String>>> configTypes=hdfsService.getConfigTypeAttributes();
  assertEquals(4,configTypes.size());
  Map<String,Map<String,String>> configType=configTypes.get("global");
  assertEquals(1,configType.size());
  Map<String,String> supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("true",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("hdfs-site");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("core-site");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("hadoop-policy");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  ServiceInfo yarnService=stack.getService("YARN");
  configTypes=yarnService.getConfigTypeAttributes();
  assertEquals(4,configTypes.size());
  assertTrue(configTypes.containsKey("yarn-site"));
  assertTrue(configTypes.containsKey("core-site"));
  assertTrue(configTypes.containsKey("global"));
  assertTrue(configTypes.containsKey("capacity-scheduler"));
  configType=configTypes.get("yarn-site");
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("true",supportsMap.get("adding_forbidden"));
  assertEquals("true",supportsMap.get("do_not_extend"));
  ServiceInfo mrService=stack.getService("MAPREDUCE2");
  configTypes=mrService.getConfigTypeAttributes();
  assertEquals(3,configTypes.size());
  assertTrue(configTypes.containsKey("mapred-site"));
  assertTrue(configTypes.containsKey("core-site"));
  assertTrue(configTypes.containsKey("mapred-queue-acls"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(1,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertNull(pigService.getParent());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stageplanner.TestStagePlanner </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleStagePlan() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=mock(ClusterImpl.class);
  when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP-2.0.6"));
  rco.initialize(cluster);
  RoleGraph rg=roleGraphFactory.createNew(rco);
  String hostname="dummy";
  Stage stage=StageUtils.getATestStage(1,1,hostname,"","");
  rg.build(stage);
  List<Stage> outStages=rg.getStages();
  for (  Stage s : outStages) {
    System.out.println(s.toString());
  }
  assertEquals(1,outStages.size());
  assertEquals(stage.getExecutionCommands(hostname),outStages.get(0).getExecutionCommands(hostname));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.CheckHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreUpgradeCheckClusterMissing() throws Exception {
  final Clusters clusters=Mockito.mock(Clusters.class);
  Mockito.when(clusters.getCluster(Mockito.anyString())).thenAnswer(new Answer<Cluster>(){
    @Override public Cluster answer(    InvocationOnMock invocation) throws Throwable {
      final String clusterName=invocation.getArguments()[0].toString();
      if (clusterName.equals("existing")) {
        return Mockito.mock(Cluster.class);
      }
 else {
        throw new ClusterNotFoundException(clusterName);
      }
    }
  }
);
  final OsFamily osFamily=Mockito.mock(OsFamily.class);
  final Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(Clusters.class).toInstance(clusters);
      bind(ClusterVersionDAO.class).toProvider(Providers.<ClusterVersionDAO>of(null));
      bind(HostVersionDAO.class).toProvider(Providers.<HostVersionDAO>of(null));
      bind(UpgradeDAO.class).toProvider(Providers.<UpgradeDAO>of(null));
      bind(RepositoryVersionDAO.class).toProvider(Providers.<RepositoryVersionDAO>of(null));
      bind(RepositoryVersionHelper.class).toProvider(Providers.<RepositoryVersionHelper>of(null));
      bind(AmbariMetaInfo.class).toProvider(Providers.<AmbariMetaInfo>of(null));
      bind(ServicesUpCheck.class).toInstance(new ServicesUpCheck());
      bind(OsFamily.class).toInstance(osFamily);
    }
  }
);
  final CheckHelper helper=injector.getInstance(CheckHelper.class);
  List<AbstractCheckDescriptor> updateChecksRegistry=new ArrayList<AbstractCheckDescriptor>();
  updateChecksRegistry.add(injector.getInstance(ServicesUpCheck.class));
  List<PrerequisiteCheck> upgradeChecks=helper.performChecks(new PrereqCheckRequest("existing"),updateChecksRegistry);
  Assert.assertEquals(PrereqCheckStatus.PASS,upgradeChecks.get(0).getStatus());
  upgradeChecks=helper.performChecks(new PrereqCheckRequest("non-existing"),updateChecksRegistry);
  Assert.assertEquals(PrereqCheckStatus.FAIL,upgradeChecks.get(0).getStatus());
  Assert.assertTrue(!upgradeChecks.get(0).getFailReason().equals("Unexpected server error happened"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigGroupTest </h4><pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveHost() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Long id=configGroup.getId();
  configGroup=cluster.getConfigGroups().get(id);
  Assert.assertNotNull(configGroup);
  clusters.unmapHostFromCluster("h1",clusterName);
  Assert.assertNull(clusters.getHostsForCluster(clusterName).get("h1"));
  Assert.assertNotNull(configGroupHostMappingDAO.findByHostId(1L));
  Assert.assertTrue(configGroupHostMappingDAO.findByHostId(1L).isEmpty());
  Assert.assertFalse(configGroup.getHosts().containsKey(1L));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Assert.assertNotNull(cluster.getConfigGroups().get(configGroup.getId()));
  ConfigGroupEntity configGroupEntity=configGroupDAO.findById(configGroup.getId());
  Collection<ConfigGroupConfigMappingEntity> configMappingEntities=configGroupEntity.getConfigGroupConfigMappingEntities();
  Collection<ConfigGroupHostMappingEntity> hostMappingEntities=configGroupEntity.getConfigGroupHostMappingEntities();
  Assert.assertEquals(configGroup.getId(),configGroupEntity.getGroupId());
  Assert.assertEquals(configGroup.getTag(),configGroupEntity.getTag());
  Assert.assertNotNull(configMappingEntities);
  Assert.assertNotNull(hostMappingEntities);
  Assert.assertEquals("h1",hostMappingEntities.iterator().next().getHostname());
  ConfigGroupConfigMappingEntity configMappingEntity=configMappingEntities.iterator().next();
  Assert.assertEquals("hdfs-site",configMappingEntity.getConfigType());
  Assert.assertEquals("testversion",configMappingEntity.getVersionTag());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigHelperTest.RunWithCustomModule </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesDoNoRemoveExcluded() throws Exception {
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  replay(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockStackVersion,"SERVICE",false);
  Assert.assertNotNull(result);
  Assert.assertEquals(2,result.size());
  verify(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesRemoveExcluded() throws Exception {
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  expect(mockServiceInfo.getExcludedConfigTypes()).andReturn(Collections.singleton("excluded-type")).once();
  expect(mockPropertyInfo1.getFilename()).andReturn("included-type.xml").times(2);
  expect(mockPropertyInfo2.getFilename()).andReturn("excluded-type.xml").once();
  replay(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockStackVersion,"SERVICE",true);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Assert.assertEquals("included-type.xml",result.iterator().next().getFilename());
  verify(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesSimpleInvocation() throws Exception {
  Cluster mockCluster=createStrictMock(Cluster.class);
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockCluster.getCurrentStackVersion()).andReturn(mockStackVersion).once();
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  replay(mockAmbariMetaInfo,mockCluster,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockCluster,"SERVICE");
  Assert.assertNotNull(result);
  Assert.assertEquals(2,result.size());
  verify(mockAmbariMetaInfo,mockCluster,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigHelperTest.RunWithInMemoryDefaultTestModule </h4><pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMap() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","1");
  attributesValues.put("b","2");
  attributesValues.put("f","3");
  attributesValues.put("q","4");
  targetAttributesMap.put("attr",attributesValues);
  Map<String,Map<String,String>> sourceAttributesMap=new HashMap<String,Map<String,String>>();
  attributesValues=new HashMap<String,String>();
  attributesValues.put("a","5");
  attributesValues.put("f","6");
  sourceAttributesMap.put("attr",attributesValues);
  attributesValues=new HashMap<String,String>();
  attributesValues.put("f","7");
  attributesValues.put("q","8");
  sourceAttributesMap.put("attr1",attributesValues);
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(2,targetAttributesMap.size());
  Assert.assertTrue(targetAttributesMap.containsKey("attr"));
  Assert.assertTrue(targetAttributesMap.containsKey("attr1"));
  Map<String,String> attributes=targetAttributesMap.get("attr");
  Assert.assertEquals(4,attributes.size());
  Assert.assertEquals("5",attributes.get("a"));
  Assert.assertEquals("2",attributes.get("b"));
  Assert.assertEquals("6",attributes.get("f"));
  Assert.assertEquals("4",attributes.get("q"));
  attributes=targetAttributesMap.get("attr1");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("7",attributes.get("f"));
  Assert.assertEquals("8",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMapSourceIsNull() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","1");
  attributesValues.put("b","2");
  attributesValues.put("f","3");
  attributesValues.put("q","4");
  targetAttributesMap.put("attr",attributesValues);
  Map<String,Map<String,String>> sourceAttributesMap=null;
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(1,targetAttributesMap.size());
  Assert.assertTrue(targetAttributesMap.containsKey("attr"));
  Map<String,String> attributes=targetAttributesMap.get("attr");
  Assert.assertEquals(4,attributes.size());
  Assert.assertEquals("1",attributes.get("a"));
  Assert.assertEquals("2",attributes.get("b"));
  Assert.assertEquals("3",attributes.get("f"));
  Assert.assertEquals("4",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMapTargetIsNull() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=null;
  Map<String,Map<String,String>> sourceAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","5");
  attributesValues.put("f","6");
  sourceAttributesMap.put("attr",attributesValues);
  attributesValues=new HashMap<String,String>();
  attributesValues.put("f","7");
  attributesValues.put("q","8");
  sourceAttributesMap.put("attr1",attributesValues);
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(2,sourceAttributesMap.size());
  Assert.assertTrue(sourceAttributesMap.containsKey("attr"));
  Assert.assertTrue(sourceAttributesMap.containsKey("attr1"));
  Map<String,String> attributes=sourceAttributesMap.get("attr");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("5",attributes.get("a"));
  Assert.assertEquals("6",attributes.get("f"));
  attributes=sourceAttributesMap.get("attr1");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("7",attributes.get("f"));
  Assert.assertEquals("8",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config1.setProperties(properties);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  Map<String,String> properties2=new HashMap<String,String>();
  properties2.put("namenode_heapsize","1111");
  config2.setProperties(properties2);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> propertyMap=configHelper.getEffectiveConfigProperties(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(propertyMap);
  Assert.assertTrue(propertyMap.containsKey("global"));
  Map<String,String> globalProps=propertyMap.get("global");
  Assert.assertEquals("1111",globalProps.get("namenode_heapsize"));
  Assert.assertEquals("/hadoop/hdfs/namenode",globalProps.get("dfs_namenode_name_dir"));
  Assert.assertTrue(propertyMap.containsKey("core-site"));
  Map<String,String> coreProps=propertyMap.get("core-site");
  Assert.assertTrue(coreProps.containsKey("a"));
  Assert.assertTrue(coreProps.containsKey("c"));
  Assert.assertEquals("30",coreProps.get("ipc.client.connect.max.retries"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesAttributesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("fs.trash.interval","11");
  attributes.put("b","y");
  Map<String,Map<String,String>> config1Attributes=new HashMap<String,Map<String,String>>();
  config1Attributes.put("attribute1",attributes);
  config1.setPropertiesAttributes(config1Attributes);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  attributes=new HashMap<String,String>();
  attributes.put("namenode_heapsize","z");
  attributes.put("c","q");
  Map<String,Map<String,String>> config2Attributes=new HashMap<String,Map<String,String>>();
  config2Attributes.put("attribute2",attributes);
  config2.setPropertiesAttributes(config2Attributes);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,Map<String,String>>> effectiveAttributes=configHelper.getEffectiveConfigAttributes(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(effectiveAttributes);
  Assert.assertEquals(4,effectiveAttributes.size());
  Assert.assertTrue(effectiveAttributes.containsKey("global"));
  Map<String,Map<String,String>> globalAttrs=effectiveAttributes.get("global");
  Assert.assertEquals(1,globalAttrs.size());
  Assert.assertTrue(globalAttrs.containsKey("attribute2"));
  Map<String,String> attribute2Occurances=globalAttrs.get("attribute2");
  Assert.assertEquals(3,attribute2Occurances.size());
  Assert.assertTrue(attribute2Occurances.containsKey("namenode_heapsize"));
  Assert.assertEquals("z",attribute2Occurances.get("namenode_heapsize"));
  Assert.assertTrue(attribute2Occurances.containsKey("dfs_namenode_name_dir"));
  Assert.assertEquals("3",attribute2Occurances.get("dfs_namenode_name_dir"));
  Assert.assertTrue(attribute2Occurances.containsKey("c"));
  Assert.assertEquals("q",attribute2Occurances.get("c"));
  Assert.assertTrue(effectiveAttributes.containsKey("core-site"));
  Map<String,Map<String,String>> coreAttrs=effectiveAttributes.get("core-site");
  Assert.assertEquals(1,coreAttrs.size());
  Assert.assertTrue(coreAttrs.containsKey("attribute1"));
  Map<String,String> attribute1Occurances=coreAttrs.get("attribute1");
  Assert.assertEquals(3,attribute1Occurances.size());
  Assert.assertTrue(attribute1Occurances.containsKey("ipc.client.connect.max.retries"));
  Assert.assertEquals("1",attribute1Occurances.get("ipc.client.connect.max.retries"));
  Assert.assertTrue(attribute1Occurances.containsKey("fs.trash.interval"));
  Assert.assertEquals("11",attribute1Occurances.get("fs.trash.interval"));
  Assert.assertTrue(attribute1Occurances.containsKey("b"));
  Assert.assertEquals("y",attribute1Occurances.get("b"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectiveTagsForHost() throws Exception {
  final Config config=new ConfigImpl("core-site");
  config.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config.setProperties(properties);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> configTags=configHelper.getEffectiveDesiredTags(cluster,"h1");
  Assert.assertNotNull(configTags);
  Map<String,String> tagsWithOverrides=configTags.get("core-site");
  Assert.assertNotNull(tagsWithOverrides);
  Assert.assertTrue(tagsWithOverrides.containsKey(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertEquals("version1",tagsWithOverrides.get(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertTrue(tagsWithOverrides.containsKey(groupId.toString()));
  Assert.assertEquals("version122",tagsWithOverrides.get(groupId.toString()));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNoAttributeOverrides() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(1,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNullAttributes() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,null,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(3,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("a"));
  Assert.assertEquals("true",finalResultAttributes.get("c"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributes() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupFinalAttrs=new HashMap<String,String>();
  confGroupFinalAttrs.put("b","true");
  confGroupAttributes.put("final",confGroupFinalAttrs);
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(2,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("b"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNullProperties() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupFinalAttrs=new HashMap<String,String>();
  confGroupFinalAttrs.put("b","true");
  confGroupAttributes.put("final",confGroupFinalAttrs);
  Config overrideConfig=new ConfigImpl(cluster,"type",null,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(4,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("a"));
  Assert.assertEquals("true",finalResultAttributes.get("b"));
  Assert.assertEquals("true",finalResultAttributes.get("c"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigMergeHelperTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConflicts() throws Exception {
  Cluster clusterMock=createNiceMock(Cluster.class);
  expect(clustersMock.getCluster(anyString())).andReturn(clusterMock);
  expect(clusterMock.getCurrentStackVersion()).andReturn(currentStackId);
  expect(clusterMock.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("HDFS",createNiceMock(Service.class));
      put("ZK",createNiceMock(Service.class));
    }
  }
);
  Set<PropertyInfo> currentHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> currentZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","different.key","different-value-1"));
    }
  }
;
  Set<PropertyInfo> currentStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","modified.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"HDFS")).andReturn(currentHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"ZK")).andReturn(currentZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(currentStackId.getStackName(),currentStackId.getStackVersion())).andReturn(currentStackProperties);
  Set<PropertyInfo> newHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
      add(createPropertyInfo("new-hdfs-config.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> newZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","equal.key","different-value-2"));
      add(createPropertyInfo("zk-env.xml","new.key","new-value-2"));
    }
  }
;
  Set<PropertyInfo> newStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","another.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"HDFS")).andReturn(newHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"ZK")).andReturn(newZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(newStackId.getStackName(),newStackId.getStackVersion())).andReturn(newStackProperties);
  Map<String,String> desiredHdfsEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredHdfsEnvProperties));
  Map<String,String> desiredZkEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredZkEnvProperties));
  Map<String,String> desiredHadoopEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hadoop-env.xml")).andReturn(createConfigMock(desiredHadoopEnvProperties));
  replay(clusterMock,clustersMock,ambariMetaInfoMock);
  ConfigMergeHelper configMergeHelper=injector.getInstance(ConfigMergeHelper.class);
  Map<String,Map<String,ThreeWayValue>> conflicts=configMergeHelper.getConflicts("clustername",newStackId);
  assertNotNull(conflicts);
  assertEquals(2,conflicts.size());
  for (  String key : conflicts.keySet()) {
    if (key.equals("hdfs-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else     if (key.equals("hadoop-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("modified.value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("another.value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else {
      fail("Unexpected key");
    }
  }
  assertEquals(2,conflicts.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.PropertyInfoTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnknownPropertyType() throws Exception {
  String xml="<property>\n" + "  <name>prop_name</name>\n" + "  <value>prop_val</value>\n"+ "  <property-type>PASSWORD USER UNRECOGNIZED_TYPE</property-type>\n"+ "  <description>test description</description>\n"+ "</property>";
  PropertyInfo propertyInfo=propertyInfoFrom(xml);
  Set<PropertyInfo.PropertyType> expectedPropertyTypes=Sets.newHashSet(PropertyInfo.PropertyType.PASSWORD,PropertyInfo.PropertyType.USER);
  assertEquals(expectedPropertyTypes,propertyInfo.getPropertyTypes());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceInfoTest </h4><pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsRestartRequiredAfterRackChange() throws Exception {
  String serviceInfoXml="<metainfo>\n" + "  <schemaVersion>2.0</schemaVersion>\n" + "  <services>\n"+ "    <service>\n"+ "      <name>RESTART</name>\n"+ "      <displayName>RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>true</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>NO_RESTART</name>\n"+ "      <displayName>NO_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>false</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>DEFAULT_RESTART</name>\n"+ "      <displayName>DEFAULT_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>HCFS_SERVICE</name>\n"+ "      <displayName>HCFS_SERVICE</displayName>\n"+ "      <comment>Hadoop Compatible File System</comment>\n"+ "      <version>2.1.1.0</version>\n"+ "      <serviceType>HCFS</serviceType>\n"+ "    </service>\n"+ "  </services>\n"+ "</metainfo>\n";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  assertTrue(serviceInfoMap.get("RESTART").isRestartRequiredAfterRackChange());
  assertFalse(serviceInfoMap.get("NO_RESTART").isRestartRequiredAfterRackChange());
  assertNull(serviceInfoMap.get("DEFAULT_RESTART").isRestartRequiredAfterRackChange());
  assertEquals(serviceInfoMap.get("HCFS_SERVICE").getServiceType(),"HCFS");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCustomMetricsWidgetsFiles() throws Exception {
  String serviceInfoXml="<metainfo>\n" + "  <schemaVersion>2.0</schemaVersion>\n" + "  <services>\n"+ "    <service>\n"+ "      <name>CUSTOM</name>\n"+ "      <displayName>CUSTOM</displayName>\n"+ "      <metricsFileName>CUSTOM_metrics.json</metricsFileName>\n"+ "      <widgetsFileName>CUSTOM_widgets.json</widgetsFileName>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>DEFAULT</name>\n"+ "      <displayName>DEFAULT</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "    </service>\n"+ "  </services>\n"+ "</metainfo>\n";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  assertEquals("CUSTOM_metrics.json",serviceInfoMap.get("CUSTOM").getMetricsFileName());
  assertEquals("CUSTOM_widgets.json",serviceInfoMap.get("CUSTOM").getWidgetsFileName());
  assertEquals("metrics.json",serviceInfoMap.get("DEFAULT").getMetricsFileName());
  assertEquals("widgets.json",serviceInfoMap.get("DEFAULT").getWidgetsFileName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceProperties() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue(serviceProperties.containsKey("PROP1"));
  assertEquals("VAL1",serviceProperties.get("PROP1"));
  assertTrue(serviceProperties.containsKey("PROP2"));
  assertEquals("VAL2",serviceProperties.get("PROP2"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testVisibilityServicePropertyOverride() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "        <property>"+ "          <name>managed</name>"+ "          <value>false</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("false".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateServicePropertyValidationAfterXmlDeserialization() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <version>1.0</version>"+ "      <name>WITH_DUPLICATE_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "        <property>"+ "          <name>managed</name>"+ "          <value>false</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  ServiceInfo serviceInfo=serviceInfoMap.get("WITH_DUPLICATE_PROPS");
  assertFalse("Service info should be in invalid state due to duplicate service property names !",serviceInfo.isValid());
  assertTrue("Service info error collection should contain the name of the duplicate service property !",serviceInfo.getErrors().contains("Duplicate service property with name 'PROP1' found in " + serviceInfo.getName() + ":"+ serviceInfo.getVersion()+ " service definition !"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultVisibilityServiceProperties() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServicePropertyInfoTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValue() throws Exception {
  ServicePropertyInfo p=getServiceProperty(XML);
  String value=p.getValue();
  assertEquals("prop_value",value);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testName() throws Exception {
  ServicePropertyInfo p=getServiceProperty(XML);
  String name=p.getName();
  assertEquals("prop_name",name);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.UpgradeHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckDowngradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(5,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(3);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that a Rolling Upgrades restarts the NameNodes in the following order: standby, active.
 * @throws Exception
 */
@Test public void testNamenodeOrder() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder mastersGroup=groups.get(2);
  assertEquals("CORE_MASTER",mastersGroup.name);
  List<String> orderedNameNodes=new LinkedList<String>();
  for (  StageWrapper sw : mastersGroup.items) {
    if (sw.getType().equals(StageWrapper.Type.RESTART) && sw.getText().toLowerCase().contains("NameNode".toLowerCase())) {
      for (      TaskWrapper tw : sw.getTasks()) {
        for (        String hostName : tw.getHosts()) {
          orderedNameNodes.add(hostName);
        }
      }
    }
  }
  assertEquals(2,orderedNameNodes.size());
  assertEquals("h2",orderedNameNodes.get(0));
  assertEquals("h1",orderedNameNodes.get(1));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that multiple execute tasks with an annotation of synchronized="true" each run in their own stage.
 */
@Test public void testUpgradeWithMultipleTasksInOwnStage() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> upgradePackGroups=upgrade.getGroups(Direction.UPGRADE);
  boolean foundService=false;
  for (  Grouping group : upgradePackGroups) {
    if (group.title.equals("Oozie")) {
      foundService=true;
    }
  }
  assertTrue(foundService);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  int numPrepareStages=0;
  for (  UpgradeGroupHolder group : groups) {
    if (group.name.equals("OOZIE")) {
      assertTrue(group.items.size() > 0);
      for (      StageWrapper sw : group.items) {
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2 (Batch 1 of 2)") || sw.getText().equalsIgnoreCase("Preparing Oozie Server on h3 (Batch 2 of 2)")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server.py".equalsIgnoreCase(task.script));
          assertTrue("stop".equalsIgnoreCase(task.function));
        }
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server_upgrade.py".equalsIgnoreCase(task.script));
          assertTrue("upgrade_oozie_database_and_sharelib".equalsIgnoreCase(task.function));
        }
      }
    }
  }
  assertEquals(3,numPrepareStages);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("OOZIE",groups.get(1).name);
  assertEquals("HIVE",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("CORE_MASTER",groups.get(4).name);
  assertEquals("ZOOKEEPER",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Downgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(8,groups.get(1).items.size());
  assertEquals(3,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
  assertEquals(8,groups.get(4).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTaskWithMultipleConfigurations() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  String transferJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  assertNotNull(transferJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(transferJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals("fooKey",keyValuePairs.get(0).key);
  assertEquals("fooValue",keyValuePairs.get(0).value);
  assertEquals("fooKey2",keyValuePairs.get(1).key);
  assertEquals("fooValue2",keyValuePairs.get(1).value);
  assertEquals("fooKey3",keyValuePairs.get(2).key);
  assertEquals("fooValue3",keyValuePairs.get(2).value);
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeServerActionOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_server_action_test"));
  UpgradePack upgrade=upgrades.get("upgrade_server_action_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals("CLUSTER_SERVER_ACTIONS",group.name);
  List<StageWrapper> stageWrappers=group.items;
  assertEquals(6,stageWrappers.size());
  assertEquals("Pre Upgrade",stageWrappers.get(0).getText());
  assertEquals("Pre Upgrade Zookeeper",stageWrappers.get(1).getText());
  assertEquals("Configuring",stageWrappers.get(2).getText());
  assertEquals("Configuring HDFS",stageWrappers.get(3).getText());
  assertEquals("Calculating Properties",stageWrappers.get(4).getText());
  assertEquals("Calculating HDFS Properties",stageWrappers.get(5).getText());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeAfterPartialUpgrade() throws Exception {
  Clusters clusters=injector.getInstance(Clusters.class);
  ServiceFactory serviceFactory=injector.getInstance(ServiceFactory.class);
  String clusterName="c1";
  StackId stackId=new StackId("HDP-2.1.1");
  clusters.addCluster(clusterName,stackId);
  Cluster c=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,c.getDesiredStackVersion().getStackVersion());
  c.createClusterVersion(stackId,c.getDesiredStackVersion().getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  for (int i=0; i < 2; i++) {
    String hostName="h" + (i + 1);
    clusters.addHost(hostName);
    Host host=clusters.getHost(hostName);
    Map<String,String> hostAttributes=new HashMap<String,String>();
    hostAttributes.put("os_family","redhat");
    hostAttributes.put("os_release_version","6");
    host.setHostAttributes(hostAttributes);
    host.persist();
    clusters.mapHostToCluster(hostName,clusterName);
  }
  c.addService(serviceFactory.createNew(c,"HDFS"));
  Service s=c.getService("HDFS");
  ServiceComponent sc=s.addServiceComponent("NAMENODE");
  sc.addServiceComponentHost("h1");
  sc.addServiceComponentHost("h2");
  List<ServiceComponentHost> schs=c.getServiceComponentHosts("HDFS","NAMENODE");
  assertEquals(2,schs.size());
  HostsType type=new HostsType();
  type.master="h1";
  type.secondary="h2";
  expect(m_masterHostResolver.getMasterAndHosts("ZOOKEEPER","ZOOKEEPER_SERVER")).andReturn(null).anyTimes();
  expect(m_masterHostResolver.getMasterAndHosts("HDFS","NAMENODE")).andReturn(type).anyTimes();
  expect(m_masterHostResolver.getCluster()).andReturn(c).anyTimes();
  replay(m_masterHostResolver);
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertNotNull(upgrade);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(2,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals(1,group.items.size());
  assertEquals("PRE_POST_CLUSTER",group.name);
  group=groups.get(1);
  assertEquals("POST_CLUSTER",group.name);
  assertEquals(3,group.items.size());
  StageWrapper stage=group.items.get(1);
  assertEquals("NameNode Finalize",stage.getText());
  assertEquals(1,stage.getTasks().size());
  TaskWrapper task=stage.getTasks().get(0);
  assertEquals(1,task.getHosts().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManualTaskPostProcessing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalDeleteTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  hiveConfigs.put("condition","1");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals(10,transfers.size());
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
  assertEquals("delete-key",transfers.get(2).deleteKey);
  assertEquals("delete-http",transfers.get(3).deleteKey);
  assertEquals("delete-null-if-value",transfers.get(4).deleteKey);
  assertEquals("delete-blank-if-key",transfers.get(5).deleteKey);
  assertEquals("delete-blank-if-type",transfers.get(6).deleteKey);
  assertEquals("delete-thrift",transfers.get(7).deleteKey);
  assertEquals("delete-if-key-present",transfers.get(8).deleteKey);
  assertEquals("delete-if-key-absent",transfers.get(9).deleteKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(5).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that hosts in MM are not included in the upgrade.
 * @throws Exception
 */
@Test public void testUpgradeOrchestrationWithHostsInMM() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  Host hostInMaintenanceMode=cluster.getHosts().iterator().next();
  hostInMaintenanceMode.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  MasterHostResolver masterHostResolver=new MasterHostResolver(null,cluster,"");
  UpgradeContext context=new UpgradeContext(masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  for (  UpgradeGroupHolder group : groups) {
    for (    StageWrapper stageWrapper : group.items) {
      Set<String> hosts=stageWrapper.getHosts();
      assertFalse(hosts.contains(hostInMaintenanceMode.getHostName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationFullTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_to_new_stack"));
  UpgradePack upgrade=upgrades.get("upgrade_to_new_stack");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(6,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(4).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(5);
  assertEquals(postGroup.name,"POST_CLUSTER");
  assertEquals(postGroup.title,"Finalize Upgrade");
  assertEquals(4,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals("Run On All 2.2.1.0-1234",postGroup.items.get(3).getText());
  assertEquals(1,postGroup.items.get(3).getTasks().size());
  Set<String> hosts=postGroup.items.get(3).getTasks().get(0).getHosts();
  assertNotNull(hosts);
  assertEquals(4,hosts.size());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(5,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(1).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.thrift.port",keyValuePairs.get(0).key);
  assertEquals("10010",keyValuePairs.get(0).value);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.http.port",keyValuePairs.get(0).key);
  assertEquals("10011",keyValuePairs.get(0).value);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationWithNoHeartbeat() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster(false);
  Clusters clusters=injector.getInstance(Clusters.class);
  Host h4=clusters.getHost("h4");
  h4.setState(HostState.HEARTBEAT_LOST);
  h4.persist();
  List<ServiceComponentHost> schs=cluster.getServiceComponentHosts("h4");
  assertEquals(1,schs.size());
  assertEquals(HostState.HEARTBEAT_LOST,schs.get(0).getHostState());
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(7,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckUpgradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  Cluster c=makeCluster();
  Set<String> additionalServices=new HashSet<String>(){
{
      add("HBASE");
      add("PIG");
      add("TEZ");
      add("AMBARI_METRICS");
    }
  }
;
  for (  String service : additionalServices) {
    c.addService(service);
  }
  int numServiceChecksExpected=0;
  Collection<Service> services=c.getServices().values();
  for (  Service service : services) {
    ServiceInfo si=ambariMetaInfo.getService(c.getCurrentStackVersion().getStackName(),c.getCurrentStackVersion().getStackVersion(),service.getName());
    if (null == si.getCommandScript()) {
      continue;
    }
    if (service.getName().equalsIgnoreCase("TEZ")) {
      assertTrue("Expect Tez to not have any service checks",false);
    }
    if (service.getName().equalsIgnoreCase("AMBARI_METRICS")) {
      continue;
    }
    numServiceChecksExpected++;
  }
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_22,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder holder=groups.get(3);
  assertEquals(holder.name,"SERVICE_CHECK_1");
  assertEquals(7,holder.items.size());
  int numServiceChecksActual=0;
  for (  StageWrapper sw : holder.items) {
    for (    Service service : services) {
      Pattern p=Pattern.compile(".*" + service.getName(),Pattern.CASE_INSENSITIVE);
      Matcher matcher=p.matcher(sw.getText());
      if (matcher.matches()) {
        numServiceChecksActual++;
        continue;
      }
    }
  }
  assertEquals(numServiceChecksActual,numServiceChecksExpected);
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuckets() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_bucket_test"));
  UpgradePack upgrade=upgrades.get("upgrade_bucket_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.iterator().next();
  assertEquals(22,group.items.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertDefinitionHashTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHashingAlgorithm() throws Exception {
  List<String> uuids=new ArrayList<String>();
  uuids.add(m_hdfsService.getHash());
  uuids.add(m_hdfsHost.getHash());
  for (  AlertDefinitionEntity entity : m_agentDefinitions) {
    uuids.add(entity.getHash());
  }
  Collections.sort(uuids);
  MessageDigest digest=MessageDigest.getInstance("MD5");
  for (  String uuid : uuids) {
    digest.update(uuid.getBytes());
  }
  byte[] hashBytes=digest.digest();
  String expected=Hex.encodeHexString(hashBytes);
  assertEquals(expected,m_hash.getHash(CLUSTERNAME,HOSTNAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterImplTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteService() throws Exception {
  String serviceToDelete="TEZ";
  String clusterName="TEST_CLUSTER";
  String hostName1="HOST1", hostName2="HOST2";
  clusters.addCluster(clusterName,new StackId("HDP-2.1.1"));
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.addHost(hostName1);
  clusters.addHost(hostName2);
  Host host1=clusters.getHost(hostName1);
  host1.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host1.persist();
  Host host2=clusters.getHost(hostName2);
  host2.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host2.persist();
  clusters.mapHostsToCluster(Sets.newHashSet(hostName1,hostName2),clusterName);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  ServiceComponent nameNode=hdfs.addServiceComponent("NAMENODE");
  nameNode.persist();
  nameNode.addServiceComponentHost(hostName1).persist();
  ServiceComponent dataNode=hdfs.addServiceComponent("DATANODE");
  dataNode.persist();
  dataNode.addServiceComponentHost(hostName1).persist();
  dataNode.addServiceComponentHost(hostName2).persist();
  ServiceComponent hdfsClient=hdfs.addServiceComponent("HDFS_CLIENT");
  hdfsClient.persist();
  hdfsClient.addServiceComponentHost(hostName1).persist();
  hdfsClient.addServiceComponentHost(hostName2).persist();
  Service tez=cluster.addService(serviceToDelete);
  tez.persist();
  ServiceComponent tezClient=tez.addServiceComponent("TEZ_CLIENT");
  tezClient.persist();
  ServiceComponentHost tezClientHost1=tezClient.addServiceComponentHost(hostName1);
  tezClientHost1.persist();
  ServiceComponentHost tezClientHost2=tezClient.addServiceComponentHost(hostName2);
  tezClientHost2.persist();
  cluster.deleteService(serviceToDelete);
  assertFalse("Deleted service should be removed from the service collection !",cluster.getServices().containsKey(serviceToDelete));
  assertEquals("All components of the deleted service should be removed from all hosts",0,cluster.getServiceComponentHosts(serviceToDelete,null).size());
  boolean checkHost1=!cluster.getServiceComponentHosts(hostName1).contains(tezClientHost1);
  boolean checkHost2=!cluster.getServiceComponentHosts(hostName2).contains(tezClientHost2);
  assertTrue("All components of the deleted service should be removed from all hosts",checkHost1 && checkHost2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterTest </h4><pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDesiredConfigs() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  Config config3=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addConfig(config3);
  try {
    c1.addDesiredConfig(null,Collections.singleton(config1));
    fail("Cannot set a null user with config");
  }
 catch (  Exception e) {
  }
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  c1.addDesiredConfig("_test3",Collections.singleton(config3));
  Map<String,DesiredConfig> desiredConfigs=c1.getDesiredConfigs();
  Assert.assertFalse("Expect desired config not contain 'mapred-site'",desiredConfigs.containsKey("mapred-site"));
  Assert.assertTrue("Expect desired config contain " + config1.getType(),desiredConfigs.containsKey("global"));
  Assert.assertTrue("Expect desired config contain " + config3.getType(),desiredConfigs.containsKey("core-site"));
  Assert.assertEquals("Expect desired config for global should be " + config1.getTag(),config1.getTag(),desiredConfigs.get(config1.getType()).getTag());
  Assert.assertEquals("_test1",desiredConfigs.get(config1.getType()).getUser());
  Assert.assertEquals("_test3",desiredConfigs.get(config3.getType()).getUser());
  DesiredConfig dc=desiredConfigs.get(config1.getType());
  Assert.assertTrue("Expect no host-level overrides",(null == dc.getHostOverrides() || dc.getHostOverrides().size() == 0));
  c1.addDesiredConfig("_test2",Collections.singleton(config2));
  Assert.assertEquals("_test2",c1.getDesiredConfigs().get(config2.getType()).getUser());
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  Host host=clusters.getHost("h1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test2",config2);
  desiredConfigs=c1.getDesiredConfigs();
  dc=desiredConfigs.get(config1.getType());
  Assert.assertNotNull("Expect host-level overrides",dc.getHostOverrides());
  Assert.assertEquals("Expect one host-level override",1,dc.getHostOverrides().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceConfigVersionsForGroups() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  c1.addConfig(config1);
  ServiceConfigVersionResponse scvResponse=c1.addDesiredConfig("admin",Collections.singleton(config1));
  assertEquals("SCV 1 should be created",Long.valueOf(1),scvResponse.getVersion());
  Map<String,Collection<ServiceConfigVersionResponse>> activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals("Only one scv should be active",1,activeServiceConfigVersions.get("HDFS").size());
  Config config2=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  ConfigGroup configGroup=configGroupFactory.createNew(c1,"test group","HDFS","descr",Collections.singletonMap("hdfs-site",config2),Collections.<Long,Host>emptyMap());
  configGroup.persist();
  c1.addConfigGroup(configGroup);
  scvResponse=c1.createServiceConfigVersion("HDFS","admin","test note",configGroup);
  assertEquals("SCV 2 should be created",Long.valueOf(2),scvResponse.getVersion());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals("Two service config versions should be active, for default and test groups",2,activeServiceConfigVersions.get("HDFS").size());
  Config config3=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","d");
    }
  }
,new HashMap<String,Map<String,String>>());
  configGroup.setConfigurations(Collections.singletonMap("hdfs-site",config3));
  configGroup.persist();
  scvResponse=c1.createServiceConfigVersion("HDFS","admin","test note",configGroup);
  assertEquals("SCV 3 should be created",Long.valueOf(3),scvResponse.getVersion());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals("Two service config versions should be active, for default and test groups",2,activeServiceConfigVersions.get("HDFS").size());
  assertEquals(3,c1.getServiceConfigVersions().size());
  scvResponse=c1.setServiceConfigVersion("HDFS",2L,"admin","group rollback");
  assertEquals("SCV 4 should be created",Long.valueOf(4),scvResponse.getVersion());
  configGroup=c1.getConfigGroups().get(configGroup.getId());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals("Two service config versions should be active, for default and test groups",2,activeServiceConfigVersions.get("HDFS").size());
  assertEquals(4,c1.getServiceConfigVersions().size());
  Map<String,String> configProperties=configGroup.getConfigurations().get("hdfs-site").getProperties();
  assertEquals("Configurations should be rolled back to a:c ","c",configProperties.get("a"));
  Config config4=new ConfigImpl("hdfs-site");
  config4.setProperties(new HashMap<String,String>(){
{
      put("a","b");
    }
  }
);
  ConfigGroup configGroup2=configGroupFactory.createNew(c1,"test group 2","HDFS","descr",Collections.singletonMap("hdfs-site",config4),Collections.<Long,Host>emptyMap());
  configGroup2.persist();
  c1.addConfigGroup(configGroup2);
  scvResponse=c1.createServiceConfigVersion("HDFS","admin","test note",configGroup2);
  assertEquals("SCV 5 should be created",Long.valueOf(5),scvResponse.getVersion());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals("Three service config versions should be active, for default and test groups",3,activeServiceConfigVersions.get("HDFS").size());
  assertEquals("Five total scvs",5,c1.getServiceConfigVersions().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceConfigVersions() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addDesiredConfig("admin",Collections.singleton(config1));
  List<ServiceConfigVersionResponse> serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(1,serviceConfigVersions.size());
  Map<String,Collection<ServiceConfigVersionResponse>> activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  ServiceConfigVersionResponse hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  Assert.assertEquals("default",hdfsResponse.getGroupName());
  Assert.assertEquals(Long.valueOf(-1),hdfsResponse.getGroupId());
  Assert.assertEquals(Long.valueOf(1),hdfsResponse.getVersion());
  c1.addDesiredConfig("admin",Collections.singleton(config2));
  serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(2,serviceConfigVersions.size());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  assertEquals(Long.valueOf(2),hdfsResponse.getVersion());
  c1.setServiceConfigVersion("HDFS",1L,"admin","test_note");
  serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(3,serviceConfigVersions.size());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  assertEquals(Long.valueOf(3),hdfsResponse.getVersion());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBootstrapHostVersion() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  Host deadHost=cluster.getHosts().iterator().next();
  deadHost.setState(HostState.UNHEALTHY);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (hce.getHostName().equals(deadHost.getHostName())) {
      continue;
    }
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Comprehensive test for transitionHostVersion and recalculateClusterVersion.
 * It creates a cluster with 3 hosts and 3 services, one of which does not advertise a version.
 * It then verifies that all 3 hosts have a version of CURRENT, and so does the cluster.
 * It then adds one more host with a component, so its HostVersion will initialize in CURRENT.
 * Next, it distributes a repo so that it is INSTALLED on the 4 hosts.
 * It then adds one more host, whose HostVersion will be OUT_OF_SYNC for the new repo.
 * After redistributing bits again, it simulates an RU.
 * Finally, some of the hosts will end up with a HostVersion in UPGRADED, and others still in INSTALLED.
 * @throws Exception
 */
@Test public void testTransitionHostVersionAdvanced() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.UPGRADING);
      }
      if (i == hostComponentStates.size() - 1) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
  addHost("h-4",hostAttributes);
  clusters.mapHostToCluster("h-4",clusterName);
  Service svc2=cluster.getService("ZOOKEEPER");
  Service svc3=cluster.getService("GANGLIA");
  ServiceComponent sc2CompA=svc2.getServiceComponent("ZOOKEEPER_SERVER");
  ServiceComponent sc2CompB=svc2.getServiceComponent("ZOOKEEPER_CLIENT");
  ServiceComponent sc3CompB=svc3.getServiceComponent("GANGLIA_MONITOR");
  ServiceComponentHost schHost4Serv2CompA=serviceComponentHostFactory.createNew(sc2CompA,"h-4");
  ServiceComponentHost schHost4Serv2CompB=serviceComponentHostFactory.createNew(sc2CompB,"h-4");
  ServiceComponentHost schHost4Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-4");
  sc2CompA.addServiceComponentHost(schHost4Serv2CompA);
  sc2CompB.addServiceComponentHost(schHost4Serv2CompB);
  sc3CompB.addServiceComponentHost(schHost4Serv3CompB);
  schHost4Serv2CompA.persist();
  schHost4Serv2CompB.persist();
  schHost4Serv3CompB.persist();
  simulateStackVersionListener(stackId,v1,cluster,hostComponentStateDAO.findByHost("h-4"));
  Collection<HostVersionEntity> hostVersions=hostVersionDAO.findAll();
  Assert.assertEquals(hostVersions.size(),clusters.getHosts().size());
  HostVersionEntity h4Version1=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v1,"h-4");
  Assert.assertNotNull(h4Version1);
  Assert.assertEquals(h4Version1.getState(),RepositoryVersionState.CURRENT);
  String v2="2.2.0-456";
  RepositoryVersionEntity rv2=helper.getOrCreateRepositoryVersion(stackId,v2);
  for (  String hostName : clusters.getHostsForCluster(clusterName).keySet()) {
    HostEntity host=hostDAO.findByName(hostName);
    HostVersionEntity hve=new HostVersionEntity(host,rv2,RepositoryVersionState.INSTALLED);
    hostVersionDAO.create(hve);
  }
  cluster.createClusterVersion(stackId,v2,"admin",RepositoryVersionState.INSTALLING);
  cluster.transitionClusterVersion(stackId,v2,RepositoryVersionState.INSTALLED);
  ClusterVersionEntity cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertNotNull(cv2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.INSTALLED);
  addHost("h-5",hostAttributes);
  clusters.mapHostToCluster("h-5",clusterName);
  ServiceComponentHost schHost5Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-5");
  sc3CompB.addServiceComponentHost(schHost5Serv3CompB);
  schHost5Serv3CompB.persist();
  HostVersionEntity h5Version2=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v2,"h-5");
  Assert.assertNotNull(h5Version2);
  Assert.assertEquals(h5Version2.getState(),RepositoryVersionState.OUT_OF_SYNC);
  h5Version2.setState(RepositoryVersionState.INSTALLED);
  hostVersionDAO.merge(h5Version2);
  versionedComponentCount=0;
  hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v2);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv2);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v2);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 2);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
        Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
      }
    }
  }
  cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
  Collection<HostVersionEntity> v2HostVersions=hostVersionDAO.findByClusterStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(v2HostVersions.size(),clusters.getHostsForCluster(clusterName).size());
  for (  HostVersionEntity hve : v2HostVersions) {
    if (hve.getHostName().equals("h-3") || hve.getHostName().equals("h-5")) {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.INSTALLED);
    }
 else {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.UPGRADED);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosDescriptorTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor_NameCollisions() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  KerberosIdentityDescriptor identity;
  identity=descriptor.getReferencedIdentityDescriptor("/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals(null,identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE1/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE1",identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE2/SERVICE2_COMPONENT1/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE2_COMPONENT1",identity.getParent().getName());
  Assert.assertNotNull(identity.getParent().getParent());
  Assert.assertEquals("SERVICE2",identity.getParent().getParent().getName());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor_RelativePath() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  Assert.assertNotNull(descriptor);
  KerberosServiceDescriptor serviceDescriptor=descriptor.getService("SERVICE2");
  Assert.assertNotNull(serviceDescriptor);
  KerberosComponentDescriptor componentDescriptor=serviceDescriptor.getComponent("SERVICE2_COMPONENT1");
  Assert.assertNotNull(componentDescriptor);
  KerberosIdentityDescriptor identity;
  identity=componentDescriptor.getReferencedIdentityDescriptor("../service2_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service2_identity",identity.getName());
  Assert.assertEquals(serviceDescriptor,identity.getParent());
  identity=serviceDescriptor.getReferencedIdentityDescriptor("../service2_identity");
  Assert.assertNull(identity);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  KerberosIdentityDescriptor identity;
  identity=descriptor.getReferencedIdentityDescriptor("/stack_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("stack_identity",identity.getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE1/service1_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service1_identity",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE1",identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE2/SERVICE2_COMPONENT1/service2_component1_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service2_component1_identity",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE2_COMPONENT1",identity.getParent().getName());
  Assert.assertNotNull(identity.getParent().getParent());
  Assert.assertEquals("SERVICE2",identity.getParent().getParent().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.services.AlertNoticeDispatchServiceTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests a digest dispatch for SNMP.
 * @throws Exception
 */
@Test public void testSingleDispatch() throws Exception {
  MockSnmpDispatcher dispatcher=new MockSnmpDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(getSnmpMockNotices()).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.expect(m_dispatchFactory.getDispatcher("SNMP")).andReturn(dispatcher).atLeastOnce();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  List<Notification> notifications=dispatcher.getNotifications();
  assertEquals(2,notifications.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests a digest dispatch for email.
 * @throws Exception
 */
@Test public void testDigestDispatch() throws Exception {
  MockEmailDispatcher dispatcher=new MockEmailDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dispatchFactory.getDispatcher("EMAIL")).andReturn(dispatcher).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNotNull(notification);
  assertTrue(notification.Subject.contains("OK[1]"));
  assertTrue(notification.Subject.contains("Critical[0]"));
  assertTrue(notification.Body.contains(ALERT_UNIQUE_TEXT));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the parsing of the {@link AlertHistoryEntity} list into{@link AlertSummaryInfo}.
 * @throws Exception
 */
@Test public void testAlertInfo() throws Exception {
  AlertHistoryEntity history=m_histories.get(0);
  AlertInfo alertInfo=new AlertInfo(history);
  assertEquals(history.getAlertDefinition().getLabel(),alertInfo.getAlertName());
  assertEquals(history.getAlertState(),alertInfo.getAlertState());
  assertEquals(history.getAlertText(),alertInfo.getAlertText());
  assertEquals(history.getComponentName(),alertInfo.getComponentName());
  assertEquals(history.getHostName(),alertInfo.getHostName());
  assertEquals(history.getServiceName(),alertInfo.getServiceName());
  assertEquals(false,alertInfo.hasComponentName());
  assertEquals(true,alertInfo.hasHostName());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests that a failed dispatch invokes the callback to mark the UUIDs of the
 * notices as FAILED.
 * @throws Exception
 */
@Test public void testFailedDispatch() throws Exception {
  MockEmailDispatcher dispatcher=new MockEmailDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).once();
  EasyMock.expect(m_dao.findNoticeByUuid(ALERT_NOTICE_UUID_1)).andReturn(notice).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).once();
  EasyMock.expect(m_dispatchFactory.getDispatcher(dispatcher.getType())).andReturn(dispatcher).once();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNull(notification);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when a dispatcher doesn't call back, the{@link AlertNoticeEntity} will be put from{@link NotificationState#PENDING} to {@link NotificationState#DISPATCHED}.
 * @throws Exception
 */
@Test public void testDispatcherWithoutCallbacks() throws Exception {
  MockNoCallbackDispatcher dispatcher=new MockNoCallbackDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.expect(m_dispatchFactory.getDispatcher(dispatcher.getType())).andReturn(dispatcher).once();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNotNull(notification);
  assertEquals(NotificationState.DISPATCHED,notice.getNotifyState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.ConfigUpgradePackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigUpgradeDefinitionParsing() throws Exception {
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  Map<String,ConfigUpgradeChangeDefinition> changesByID=cup.enumerateConfigChangesByID();
  ConfigUpgradeChangeDefinition hdp_2_1_1_nm_pre_upgrade=changesByID.get("hdp_2_1_1_nm_pre_upgrade");
  assertEquals("core-site",hdp_2_1_1_nm_pre_upgrade.getConfigType());
  assertEquals(4,hdp_2_1_1_nm_pre_upgrade.getTransfers().size());
  ConfigUpgradeChangeDefinition.Transfer t1=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(0);
  assertEquals(TransferOperation.COPY,t1.operation);
  assertEquals("copy-key",t1.fromKey);
  assertEquals("copy-key-to",t1.toKey);
  ConfigUpgradeChangeDefinition.Transfer t2=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(1);
  assertEquals(TransferOperation.COPY,t2.operation);
  assertEquals("my-site",t2.fromType);
  assertEquals("my-copy-key",t2.fromKey);
  assertEquals("my-copy-key-to",t2.toKey);
  assertTrue(t2.keepKeys.isEmpty());
  ConfigUpgradeChangeDefinition.Transfer t3=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(2);
  assertEquals(TransferOperation.MOVE,t3.operation);
  assertEquals("move-key",t3.fromKey);
  assertEquals("move-key-to",t3.toKey);
  ConfigUpgradeChangeDefinition.Transfer t4=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(3);
  assertEquals(TransferOperation.DELETE,t4.operation);
  assertEquals("delete-key",t4.deleteKey);
  assertNull(t4.toKey);
  assertTrue(t4.preserveEdits);
  assertEquals(1,t4.keepKeys.size());
  assertEquals("important-key",t4.keepKeys.get(0));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMerge(){
  ArrayList<ConfigUpgradePack> cups=new ArrayList<>();
  for (int cupIndex=0; cupIndex < 3; cupIndex++) {
    ArrayList<AffectedService> services=new ArrayList<>();
    for (int serviceIndex=0; serviceIndex < 2; serviceIndex++) {
      String serviceName;
      if (serviceIndex == 0) {
        serviceName="HDFS";
      }
 else {
        serviceName=String.format("SOME_SERVICE_%s",cupIndex);
      }
      ArrayList<AffectedComponent> components=new ArrayList<>();
      for (int componentIndex=0; componentIndex < 2; componentIndex++) {
        String componentName;
        if (componentIndex == 0) {
          componentName="NAMENODE";
        }
 else {
          componentName="SOME_COMPONENT_" + cupIndex;
        }
        ArrayList<ConfigUpgradeChangeDefinition> changeDefinitions=new ArrayList<>();
        for (int changeIndex=0; changeIndex < 2; changeIndex++) {
          String change_id=String.format("CHANGE_%s_%s_%s_%s",cupIndex,serviceIndex,componentIndex,changeIndex);
          ConfigUpgradeChangeDefinition changeDefinition=new ConfigUpgradeChangeDefinition();
          changeDefinition.id=change_id;
          changeDefinitions.add(changeDefinition);
        }
        AffectedComponent component=new AffectedComponent();
        component.name=componentName;
        component.changes=changeDefinitions;
        components.add(component);
      }
      AffectedService service=new AffectedService();
      service.name=serviceName;
      service.components=components;
      services.add(service);
    }
    ConfigUpgradePack cupI=new ConfigUpgradePack();
    cupI.services=services;
    cups.add(cupI);
  }
  ConfigUpgradePack result=ConfigUpgradePack.merge(cups);
  assertEquals(result.enumerateConfigChangesByID().entrySet().size(),24);
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(0).id,"CHANGE_0_0_0_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(1).id,"CHANGE_0_0_0_1");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(2).id,"CHANGE_1_0_0_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(3).id,"CHANGE_1_0_0_1");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(4).id,"CHANGE_2_0_0_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("NAMENODE").changes.get(5).id,"CHANGE_2_0_0_1");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_0").changes.get(0).id,"CHANGE_0_0_1_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_0").changes.get(1).id,"CHANGE_0_0_1_1");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_1").changes.get(0).id,"CHANGE_1_0_1_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_1").changes.get(1).id,"CHANGE_1_0_1_1");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_2").changes.get(0).id,"CHANGE_2_0_1_0");
  assertEquals(result.getServiceMap().get("HDFS").getComponentMap().get("SOME_COMPONENT_2").changes.get(1).id,"CHANGE_2_0_1_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_0").getComponentMap().get("NAMENODE").changes.get(0).id,"CHANGE_0_1_0_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_0").getComponentMap().get("NAMENODE").changes.get(1).id,"CHANGE_0_1_0_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_0").getComponentMap().get("SOME_COMPONENT_0").changes.get(0).id,"CHANGE_0_1_1_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_0").getComponentMap().get("SOME_COMPONENT_0").changes.get(1).id,"CHANGE_0_1_1_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_1").getComponentMap().get("NAMENODE").changes.get(0).id,"CHANGE_1_1_0_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_1").getComponentMap().get("NAMENODE").changes.get(1).id,"CHANGE_1_1_0_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_1").getComponentMap().get("SOME_COMPONENT_1").changes.get(0).id,"CHANGE_1_1_1_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_1").getComponentMap().get("SOME_COMPONENT_1").changes.get(1).id,"CHANGE_1_1_1_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_2").getComponentMap().get("NAMENODE").changes.get(0).id,"CHANGE_2_1_0_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_2").getComponentMap().get("NAMENODE").changes.get(1).id,"CHANGE_2_1_0_1");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_2").getComponentMap().get("SOME_COMPONENT_2").changes.get(0).id,"CHANGE_2_1_1_0");
  assertEquals(result.getServiceMap().get("SOME_SERVICE_2").getComponentMap().get("SOME_COMPONENT_2").changes.get(1).id,"CHANGE_2_1_1_1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.OSFamilyTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParsingOS() throws Exception {
  Map<String,String> expected_map=new HashMap<String,String>();
  expected_map.put("distro","ubuntu");
  expected_map.put("versions","12");
  String test_value="ubuntu12";
  Class[] parse_os_args={String.class};
  Method parse_os=os_family.getClass().getDeclaredMethod("parse_os",parse_os_args);
  parse_os.setAccessible(true);
  Object test_map=parse_os.invoke(os_family,test_value);
  parse_os.setAccessible(false);
  Assert.assertNotNull(test_map);
  Assert.assertEquals(expected_map.getClass().getName(),test_map.getClass().getName());
  Assert.assertEquals(expected_map,test_map);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.UpgradePackTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSkippableFailures() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  Set<String> keys=upgrades.keySet();
  for (  String key : keys) {
    Assert.assertFalse(upgrades.get(key).isComponentFailureAutoSkipped());
    Assert.assertFalse(upgrades.get(key).isServiceCheckFailureAutoSkipped());
  }
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  UpgradePack upgradePack=upgrades.get("upgrade_test_skip_failures");
  Assert.assertTrue(upgradePack.isComponentFailureAutoSkipped());
  Assert.assertTrue(upgradePack.isServiceCheckFailureAutoSkipped());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupOrdersForNonRolling(){
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","Stop High-Level Daemons","Backups","Stop Low-Level Daemons","UPDATE_DESIRED_STACK_ID","ALL_HOST_OPS","ZOOKEEPER","HDFS","MR and YARN","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("Restore Backups","UPDATE_DESIRED_STACK_ID","ALL_HOST_OPS","ZOOKEEPER","HDFS","MR and YARN","POST_CLUSTER");
  Iterator<String> itr_up=expected_up.iterator();
  List<Grouping> upgrade_groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : upgrade_groups) {
    assertEquals(true,itr_up.hasNext());
    assertEquals(itr_up.next(),g.name);
  }
  Iterator<String> itr_down=expected_down.iterator();
  List<Grouping> downgrade_groups=upgrade.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : downgrade_groups) {
    assertEquals(true,itr_down.hasNext());
    assertEquals(itr_down.next(),g.name);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForNonRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  assertTrue(upgrade.getType() == UpgradeType.NON_ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(10,groups.size());
  Grouping group=null;
  ClusterGrouping clusterGroup=null;
  UpdateStackGrouping updateStackGroup=null;
  StopGrouping stopGroup=null;
  RestartGrouping restartGroup=null;
  group=groups.get(0);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Prepare Upgrade",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(1);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for High-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Take Backups",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(3);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for Low-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(4);
  assertEquals(UpdateStackGrouping.class,group.getClass());
  updateStackGroup=(UpdateStackGrouping)group;
  assertEquals("Update Desired Stack Id",updateStackGroup.title);
  assertNull(updateStackGroup.parallelScheduler);
  group=groups.get(5);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Set Version On All Hosts",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(6);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("Zookeeper",restartGroup.title);
  assertNull(restartGroup.parallelScheduler);
  group=groups.get(7);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("HDFS",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(2,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(8);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("MR and YARN",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(9);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Finalize {{direction.text.proper}}",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupOrdersForRolling(){
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  PrerequisiteCheckConfig prerequisiteCheckConfig=upgrade.getPrerequisiteCheckConfig();
  assertNotNull(prerequisiteCheckConfig);
  assertNotNull(prerequisiteCheckConfig.globalProperties);
  assertTrue(prerequisiteCheckConfig.getGlobalProperties().containsKey("global-property-1"));
  assertEquals("global-value-1",prerequisiteCheckConfig.getGlobalProperties().get("global-property-1"));
  assertNotNull(prerequisiteCheckConfig.prerequisiteCheckProperties);
  assertEquals(2,prerequisiteCheckConfig.prerequisiteCheckProperties.size());
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").get("dfs-protocols-regex"));
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").get("dfs-protocols-regex"));
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","ZOOKEEPER","CORE_MASTER","SERVICE_CHECK_1","CORE_SLAVES","SERVICE_CHECK_2","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("PRE_CLUSTER","CORE_SLAVES","SERVICE_CHECK_2","CORE_MASTER","SERVICE_CHECK_1","ZOOKEEPER","POST_CLUSTER");
  Grouping serviceCheckGroup=null;
  int i=0;
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_up.get(i),g.name);
    i++;
    if (g.name.equals("SERVICE_CHECK_1")) {
      serviceCheckGroup=g;
    }
  }
  List<String> expected_priority=Arrays.asList("HDFS","HBASE","YARN");
  assertNotNull(serviceCheckGroup);
  assertEquals(ServiceCheckGrouping.class,serviceCheckGroup.getClass());
  ServiceCheckGrouping scg=(ServiceCheckGrouping)serviceCheckGroup;
  Set<String> priorities=scg.getPriorities();
  assertEquals(3,priorities.size());
  i=0;
  for (  String s : priorities) {
    assertEquals(expected_priority.get(i++),s);
  }
  i=0;
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_down.get(i),g.name);
    i++;
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(4,groups.size());
  Grouping group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  ClusterGrouping cluster_group=(ClusterGrouping)group;
  assertEquals("Run on All",group.title);
  cluster_group=(ClusterGrouping)groups.get(3);
  List<ExecuteStage> stages=cluster_group.executionStages;
  assertEquals(3,stages.size());
  assertNotNull(stages.get(0).intendedDirection);
  assertEquals(Direction.DOWNGRADE,stages.get(0).intendedDirection);
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  assertEquals(3,groups.size());
  group=groups.get(1);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Run on All",group.title);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Finalize Upgrade",group.title);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeParsing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertEquals("2.2.*.*",upgrade.getTarget());
  Map<String,List<String>> expectedStages=new LinkedHashMap<String,List<String>>(){
{
      put("ZOOKEEPER",Arrays.asList("ZOOKEEPER_SERVER"));
      put("HDFS",Arrays.asList("NAMENODE","DATANODE"));
    }
  }
;
  int i=0;
  for (  Entry<String,List<String>> entry : expectedStages.entrySet()) {
    assertTrue(upgrade.getTasks().containsKey(entry.getKey()));
    assertEquals(i++,indexOf(upgrade.getTasks(),entry.getKey()));
    assertEquals(entry.getValue().size(),upgrade.getTasks().get(entry.getKey()).size());
    int j=0;
    for (    String comp : entry.getValue()) {
      assertEquals(j++,indexOf(upgrade.getTasks().get(entry.getKey()),comp));
    }
  }
  assertTrue(upgrade.getTasks().containsKey("HDFS"));
  assertTrue(upgrade.getTasks().get("HDFS").containsKey("NAMENODE"));
  ProcessingComponent pc=upgrade.getTasks().get("HDFS").get("NAMENODE");
  assertNotNull(pc.preTasks);
  assertNotNull(pc.postTasks);
  assertNotNull(pc.tasks);
  assertNull(pc.preDowngradeTasks);
  assertNull(pc.postDowngradeTasks);
  assertEquals(1,pc.tasks.size());
  assertEquals(Task.Type.RESTART,pc.tasks.get(0).getType());
  assertEquals(RestartTask.class,pc.tasks.get(0).getClass());
  assertTrue(upgrade.getTasks().containsKey("ZOOKEEPER"));
  assertTrue(upgrade.getTasks().get("ZOOKEEPER").containsKey("ZOOKEEPER_SERVER"));
  pc=upgrade.getTasks().get("HDFS").get("DATANODE");
  assertNotNull(pc.preDowngradeTasks);
  assertEquals(0,pc.preDowngradeTasks.size());
  assertNotNull(pc.postDowngradeTasks);
  assertEquals(1,pc.postDowngradeTasks.size());
  pc=upgrade.getTasks().get("ZOOKEEPER").get("ZOOKEEPER_SERVER");
  assertNotNull(pc.preTasks);
  assertEquals(1,pc.preTasks.size());
  assertNotNull(pc.postTasks);
  assertEquals(1,pc.postTasks.size());
  assertNotNull(pc.tasks);
  assertEquals(1,pc.tasks.size());
  pc=upgrade.getTasks().get("YARN").get("NODEMANAGER");
  assertNotNull(pc.preTasks);
  assertEquals(2,pc.preTasks.size());
  Task t=pc.preTasks.get(1);
  assertEquals(ConfigureTask.class,t.getClass());
  ConfigureTask ct=(ConfigureTask)t;
  assertEquals("hdp_2_1_1_nm_pre_upgrade",ct.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.upgrade.StageWrapperBuilderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that a new task was inserted into the upgrade which will check for
 * skipped failures and display a summary.
 * @throws Exception
 */
@Test public void testAutoSkipCheckInserted() throws Exception {
  UpgradeContext upgradeContext=new UpgradeContext(null,null,null,null,Direction.UPGRADE,UpgradeType.ROLLING);
  upgradeContext.setAutoSkipComponentFailures(true);
  upgradeContext.setAutoSkipServiceCheckFailures(true);
  Grouping grouping=new Grouping();
  grouping.skippable=true;
  MockStageWrapperBuilder builder=new MockStageWrapperBuilder(grouping);
  List<StageWrapper> mockStageWrappers=new ArrayList<>();
  StageWrapper mockStageWrapper=EasyMock.createNiceMock(StageWrapper.class);
  mockStageWrappers.add(mockStageWrapper);
  builder.setMockStageWrappers(mockStageWrappers);
  List<StageWrapper> stageWrappers=builder.build(upgradeContext);
  Assert.assertEquals(2,stageWrappers.size());
  StageWrapper skipSummaryWrapper=stageWrappers.get(1);
  Assert.assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,skipSummaryWrapper.getType());
  ServerActionTask task=(ServerActionTask)(skipSummaryWrapper.getTasks().get(0).getTasks().get(0));
  Assert.assertEquals(AutoSkipFailedSummaryAction.class.getName(),task.implClass);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the various build methods of a builder are invoked in the
 * correct order.
 * @throws Exception
 */
@Test public void testBuildOrder() throws Exception {
  UpgradeContext upgradeContext=new UpgradeContext(null,null,null,null,Direction.UPGRADE,UpgradeType.ROLLING);
  MockStageWrapperBuilder builder=new MockStageWrapperBuilder(null);
  List<StageWrapper> stageWrappers=builder.build(upgradeContext);
  List<Integer> invocationOrder=builder.getInvocationOrder();
  Assert.assertEquals(Integer.valueOf(0),invocationOrder.get(0));
  Assert.assertEquals(Integer.valueOf(1),invocationOrder.get(1));
  Assert.assertEquals(Integer.valueOf(2),invocationOrder.get(2));
  Assert.assertTrue(stageWrappers.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.svccomphost.ServiceComponentHostTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  sch.setDesiredState(State.INSTALLED);
  sch.setState(State.INSTALLING);
  sch.setStackVersion(new StackId("HDP-1.2.0"));
  ServiceComponentHostResponse r=sch.convertToResponse();
  Assert.assertEquals("HDFS",r.getServiceName());
  Assert.assertEquals("DATANODE",r.getComponentName());
  Assert.assertEquals(hostName1,r.getHostname());
  Assert.assertEquals(clusterName,r.getClusterName());
  Assert.assertEquals(State.INSTALLED.toString(),r.getDesiredState());
  Assert.assertEquals(State.INSTALLING.toString(),r.getLiveState());
  Assert.assertEquals("HDP-1.2.0",r.getStackVersion());
  Assert.assertFalse(r.isStaleConfig());
  StringBuilder sb=new StringBuilder();
  sch.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisableInVariousStates() throws AmbariException, InvalidStateTransitionException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)sch;
  long timestamp=0;
  HashSet<State> validStates=new HashSet<State>();
  validStates.add(State.INSTALLED);
  validStates.add(State.INSTALL_FAILED);
  validStates.add(State.UNKNOWN);
  validStates.add(State.DISABLED);
  for (  State state : validStates) {
    sch.setState(state);
    ServiceComponentHostEvent disableEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_DISABLE);
    impl.handleEvent(disableEvent);
    Assert.assertEquals(-1,impl.getLastOpStartTime());
    Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
    Assert.assertEquals(-1,impl.getLastOpEndTime());
    Assert.assertEquals(State.DISABLED,impl.getState());
  }
  HashSet<State> invalidStates=new HashSet<State>();
  invalidStates.add(State.INIT);
  invalidStates.add(State.INSTALLING);
  invalidStates.add(State.STARTING);
  invalidStates.add(State.STARTED);
  invalidStates.add(State.STOPPING);
  invalidStates.add(State.UNINSTALLING);
  invalidStates.add(State.UNINSTALLED);
  invalidStates.add(State.UPGRADING);
  for (  State state : invalidStates) {
    sch.setState(state);
    ServiceComponentHostEvent disableEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_DISABLE);
    boolean exceptionThrown=false;
    try {
      impl.handleEvent(disableEvent);
    }
 catch (    Exception e) {
      exceptionThrown=true;
    }
    Assert.assertTrue("Exception not thrown on invalid event",exceptionThrown);
    Assert.assertEquals(-1,impl.getLastOpStartTime());
    Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
    Assert.assertEquals(-1,impl.getLastOpEndTime());
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCanBeRemoved() throws Exception {
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)createNewServiceComponentHost(clusterName,"HDFS","HDFS_CLIENT",hostName1,true);
  for (  State state : State.values()) {
    impl.setState(state);
    if (state.isRemovableState()) {
      Assert.assertTrue(impl.canBeRemoved());
    }
 else {
      Assert.assertFalse(impl.canBeRemoved());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testStaleConfigsAttributes() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setStackVersion(new StackId(stackVersion));
  sch2.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLING);
  sch2.setStackVersion(new StackId(stackVersion));
  sch3.setDesiredState(State.INSTALLED);
  sch3.setState(State.INSTALLING);
  sch3.setStackVersion(new StackId(stackVersion));
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo1");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  makeConfig(cluster,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch3.updateActualConfigs(actual);
  makeConfig(cluster,"mapred-site","version1",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("mapred-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch3.setRestartRequired(false);
  sch3.updateActualConfigs(actual);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  Map<String,Map<String,String>> c1PropAttributes=new HashMap<String,Map<String,String>>();
  c1PropAttributes.put("final",new HashMap<String,String>());
  c1PropAttributes.get("final").put("hdfs1","true");
  makeConfig(cluster,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,c1PropAttributes);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  Map<String,Map<String,String>> c2PropAttributes=new HashMap<String,Map<String,String>>();
  c2PropAttributes.put("final",new HashMap<String,String>());
  c2PropAttributes.get("final").put("hdfs1","false");
  makeConfig(cluster,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,c2PropAttributes);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version4",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStopInVariousStates() throws AmbariException, InvalidStateTransitionException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)sch;
  sch.setDesiredState(State.STARTED);
  sch.setState(State.INSTALLED);
  long timestamp=0;
  ServiceComponentHostEvent stopEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_STOP);
  long startTime=timestamp;
  impl.handleEvent(stopEvent);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  Assert.assertEquals(State.STOPPING,impl.getState());
  sch.setState(State.INSTALL_FAILED);
  boolean exceptionThrown=false;
  try {
    impl.handleEvent(stopEvent);
  }
 catch (  Exception e) {
    exceptionThrown=true;
  }
  Assert.assertTrue("Exception not thrown on invalid event",exceptionThrown);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  sch.setState(State.INSTALLED);
  ServiceComponentHostEvent stopEvent2=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_STOP);
  startTime=timestamp;
  impl.handleEvent(stopEvent2);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  Assert.assertEquals(State.STOPPING,impl.getState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActualConfigs() throws Exception {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","NAMENODE",hostName1,false);
  sch.setDesiredState(State.INSTALLED);
  sch.setState(State.INSTALLING);
  sch.setStackVersion(new StackId("HDP-1.2.0"));
  sch.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  Cluster cluster=clusters.getCluster(clusterName);
  final ConfigGroup configGroup=configGroupFactory.createNew(cluster,"cg1","t1","",new HashMap<String,Config>(),new HashMap<Long,Host>());
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("core-site",new HashMap<String,String>(){
{
          put("tag","version1");
          put(configGroup.getId().toString(),"version2");
        }
      }
);
    }
  }
;
  sch.updateActualConfigs(actual);
  Map<String,HostConfig> confirm=sch.getActualConfigs();
  Assert.assertEquals(2,confirm.size());
  Assert.assertTrue(confirm.containsKey("global"));
  Assert.assertTrue(confirm.containsKey("core-site"));
  Assert.assertEquals(1,confirm.get("core-site").getConfigGroupOverrides().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityState() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostEntity hostEntity=hostDAO.findByName(hostName);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  HostComponentDesiredStateDAO daoHostComponentDesiredState=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity entityHostComponentDesiredState;
  HostComponentDesiredStateEntityPK pkHostComponentDesiredState=new HostComponentDesiredStateEntityPK();
  pkHostComponentDesiredState.setClusterId(cluster.getClusterId());
  pkHostComponentDesiredState.setComponentName(sch1.getServiceComponentName());
  pkHostComponentDesiredState.setServiceName(sch1.getServiceName());
  pkHostComponentDesiredState.setHostId(hostEntity.getHostId());
  HostComponentStateDAO daoHostComponentState=injector.getInstance(HostComponentStateDAO.class);
  HostComponentStateEntity entityHostComponentState;
  for (  SecurityState state : SecurityState.values()) {
    sch1.setSecurityState(state);
    entityHostComponentState=daoHostComponentState.findByIndex(cluster.getClusterId(),sch1.getServiceName(),sch1.getServiceComponentName(),hostEntity.getHostId());
    Assert.assertNotNull(entityHostComponentState);
    Assert.assertEquals(state,entityHostComponentState.getSecurityState());
    try {
      sch1.setDesiredSecurityState(state);
      Assert.assertTrue(state.isEndpoint());
      entityHostComponentDesiredState=daoHostComponentDesiredState.findByPK(pkHostComponentDesiredState);
      Assert.assertNotNull(entityHostComponentDesiredState);
      Assert.assertEquals(state,entityHostComponentDesiredState.getSecurityState());
    }
 catch (    AmbariException e) {
      Assert.assertFalse(state.isEndpoint());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAndSetBasicInfo() throws AmbariException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","NAMENODE",hostName1,false);
  sch.setDesiredState(State.INSTALLED);
  sch.setState(State.INSTALLING);
  sch.setStackVersion(new StackId("HDP-1.2.0"));
  sch.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  Assert.assertEquals(State.INSTALLING,sch.getState());
  Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
  Assert.assertEquals("HDP-1.2.0",sch.getStackVersion().getStackId());
  Assert.assertEquals("HDP-1.2.0",sch.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaintenance() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostEntity hostEntity=hostDAO.findByName(hostName);
  Assert.assertNotNull(hostEntity);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  HostComponentDesiredStateEntityPK pk=new HostComponentDesiredStateEntityPK();
  pk.setClusterId(Long.valueOf(cluster.getClusterId()));
  pk.setComponentName(sch1.getServiceComponentName());
  pk.setServiceName(sch1.getServiceName());
  pk.setHostId(hostEntity.getHostId());
  HostComponentDesiredStateDAO dao=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity entity=dao.findByPK(pk);
  Assert.assertEquals(MaintenanceState.OFF,entity.getMaintenanceState());
  Assert.assertEquals(MaintenanceState.OFF,sch1.getMaintenanceState());
  sch1.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,sch1.getMaintenanceState());
  entity=dao.findByPK(pk);
  Assert.assertEquals(MaintenanceState.ON,entity.getMaintenanceState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaleConfigs() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  final HostEntity hostEntity=hostDAO.findByName(hostName);
  Assert.assertNotNull(hostEntity.getHostId());
  Cluster cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setStackVersion(new StackId(stackVersion));
  sch2.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLING);
  sch2.setStackVersion(new StackId(stackVersion));
  sch3.setDesiredState(State.INSTALLED);
  sch3.setState(State.INSTALLING);
  sch3.setStackVersion(new StackId(stackVersion));
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo1");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch3.updateActualConfigs(actual);
  makeConfig(cluster,"foo","version1",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.put("hdfs-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://foo");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put("tag","version2");
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  final Host host=clusters.getHostsForCluster(clusterName).get(hostName);
  Assert.assertNotNull(host);
  final Config c=configFactory.createNew(cluster,"hdfs-site",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://goo");
    }
  }
,new HashMap<String,Map<String,String>>());
  c.setTag("version3");
  c.persist();
  cluster.addConfig(c);
  host.addDesiredConfig(cluster.getClusterId(),true,"user",c);
  ConfigGroup configGroup=configGroupFactory.createNew(cluster,"g1","t1","",new HashMap<String,Config>(){
{
      put("hdfs-site",c);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put(configGroup.getId().toString(),"version3");
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version2",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo3");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  makeConfig(cluster,"core-site","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("fs.trash.interval","360");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  actual.put("core-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  final Config c1=configFactory.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("fs.trash.interval","400");
    }
  }
,new HashMap<String,Map<String,String>>());
  c1.setTag("version2");
  c1.persist();
  cluster.addConfig(c1);
  configGroup=configGroupFactory.createNew(cluster,"g2","t2","",new HashMap<String,Config>(){
{
      put("core-site",c1);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  Long id=configGroup.getId();
  HashMap<String,String> tags=new HashMap<String,String>(2);
  tags.put("tag","version1");
  tags.put(id.toString(),"version2");
  actual.put("core-site",tags);
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  cluster.deleteConfigGroup(id);
  Assert.assertNull(cluster.getConfigGroups().get(id));
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  tags.remove(id.toString());
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.AmbariContextTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAmbariResources() throws Exception {
  Capture<ClusterRequest> clusterRequestCapture=new Capture<ClusterRequest>();
  controller.createCluster(capture(clusterRequestCapture));
  expectLastCall().once();
  expect(cluster.getServices()).andReturn(clusterServices).anyTimes();
  Capture<Set<ServiceRequest>> serviceRequestCapture=new Capture<Set<ServiceRequest>>();
  Capture<Set<ServiceComponentRequest>> serviceComponentRequestCapture=new Capture<Set<ServiceComponentRequest>>();
  serviceResourceProvider.createServices(capture(serviceRequestCapture));
  expectLastCall().once();
  componentResourceProvider.createComponents(capture(serviceComponentRequestCapture));
  expectLastCall().once();
  Capture<Request> serviceInstallRequestCapture=new Capture<Request>();
  Capture<Request> serviceStartRequestCapture=new Capture<Request>();
  Capture<Predicate> installPredicateCapture=new Capture<Predicate>();
  Capture<Predicate> startPredicateCapture=new Capture<Predicate>();
  expect(serviceResourceProvider.updateResources(capture(serviceInstallRequestCapture),capture(installPredicateCapture))).andReturn(null).once();
  expect(serviceResourceProvider.updateResources(capture(serviceStartRequestCapture),capture(startPredicateCapture))).andReturn(null).once();
  replayAll();
  context.createAmbariResources(topology,CLUSTER_NAME,null);
  ClusterRequest clusterRequest=clusterRequestCapture.getValue();
  assertEquals(CLUSTER_NAME,clusterRequest.getClusterName());
  assertEquals(String.format("%s-%s",STACK_NAME,STACK_VERSION),clusterRequest.getStackVersion());
  Collection<ServiceRequest> serviceRequests=serviceRequestCapture.getValue();
  assertEquals(2,serviceRequests.size());
  Collection<String> servicesFound=new HashSet<String>();
  for (  ServiceRequest serviceRequest : serviceRequests) {
    servicesFound.add(serviceRequest.getServiceName());
    assertEquals(CLUSTER_NAME,serviceRequest.getClusterName());
  }
  assertTrue(servicesFound.size() == 2 && servicesFound.containsAll(Arrays.asList("service1","service2")));
  Collection<ServiceComponentRequest> serviceComponentRequests=serviceComponentRequestCapture.getValue();
  assertEquals(3,serviceComponentRequests.size());
  Map<String,Collection<String>> foundServiceComponents=new HashMap<String,Collection<String>>();
  for (  ServiceComponentRequest componentRequest : serviceComponentRequests) {
    assertEquals(CLUSTER_NAME,componentRequest.getClusterName());
    String serviceName=componentRequest.getServiceName();
    Collection<String> serviceComponents=foundServiceComponents.get(serviceName);
    if (serviceComponents == null) {
      serviceComponents=new HashSet<String>();
      foundServiceComponents.put(serviceName,serviceComponents);
    }
    serviceComponents.add(componentRequest.getComponentName());
  }
  assertEquals(2,foundServiceComponents.size());
  Collection<String> service1Components=foundServiceComponents.get("service1");
  assertEquals(2,service1Components.size());
  assertTrue(service1Components.containsAll(Arrays.asList("s1Component1","s1Component2")));
  Collection<String> service2Components=foundServiceComponents.get("service2");
  assertEquals(1,service2Components.size());
  assertTrue(service2Components.contains("s2Component1"));
  Request installRequest=serviceInstallRequestCapture.getValue();
  Set<Map<String,Object>> installPropertiesSet=installRequest.getProperties();
  assertEquals(1,installPropertiesSet.size());
  Map<String,Object> installProperties=installPropertiesSet.iterator().next();
  assertEquals(CLUSTER_NAME,installProperties.get(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
  assertEquals("INSTALLED",installProperties.get(ServiceResourceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  assertEquals(new EqualsPredicate<String>(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME),installPredicateCapture.getValue());
  Request startRequest=serviceStartRequestCapture.getValue();
  Set<Map<String,Object>> startPropertiesSet=startRequest.getProperties();
  assertEquals(1,startPropertiesSet.size());
  Map<String,Object> startProperties=startPropertiesSet.iterator().next();
  assertEquals(CLUSTER_NAME,startProperties.get(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
  assertEquals("STARTED",startProperties.get(ServiceResourceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  assertEquals(new EqualsPredicate<String>(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME),installPredicateCapture.getValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRegisterHostWithConfigGroup_createNewConfigGroup() throws Exception {
  expect(cluster.getConfigGroups()).andReturn(Collections.<Long,ConfigGroup>emptyMap()).once();
  expect(clusterController.ensureResourceProvider(Resource.Type.ConfigGroup)).andReturn(configGroupResourceProvider).once();
  expect(configGroupResourceProvider.createResources(capture(configGroupRequestCapture))).andReturn(null).once();
  configHelper.moveDeprecatedGlobals(stackId,group1Configuration.getFullProperties(1),CLUSTER_NAME);
  replayAll();
  context.registerHostWithConfigGroup(HOST1,topology,HOST_GROUP_1);
  Set<ConfigGroupRequest> configGroupRequests=configGroupRequestCapture.getValue();
  assertEquals(1,configGroupRequests.size());
  ConfigGroupRequest configGroupRequest=configGroupRequests.iterator().next();
  assertEquals(CLUSTER_NAME,configGroupRequest.getClusterName());
  assertEquals("testBP:group1",configGroupRequest.getGroupName());
  assertEquals("service1",configGroupRequest.getTag());
  assertEquals("Host Group Configuration",configGroupRequest.getDescription());
  Collection<String> requestHosts=configGroupRequest.getHosts();
  requestHosts.retainAll(group1Hosts);
  assertEquals(group1Hosts.size(),requestHosts.size());
  Map<String,Config> requestConfig=configGroupRequest.getConfigs();
  assertEquals(1,requestConfig.size());
  Config type1Config=requestConfig.get("type1");
  assertEquals("type1",type1Config.getType());
  assertEquals("group1",type1Config.getTag());
  Map<String,String> requestProps=type1Config.getProperties();
  assertEquals(3,requestProps.size());
  assertEquals("val1.2",requestProps.get("prop1"));
  assertEquals("val2",requestProps.get("prop2"));
  assertEquals("val3",requestProps.get("prop3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.BlueprintFactoryTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateBlueprint() throws Exception {
  Map<String,Object> props=BlueprintResourceProviderTest.getBlueprintTestProperties().iterator().next();
  replay(stack,dao,entity,configEntity);
  Blueprint blueprint=testFactory.createBlueprint(props,null);
  assertEquals(BLUEPRINT_NAME,blueprint.getName());
  assertSame(stack,blueprint.getStack());
  assertEquals(2,blueprint.getHostGroups().size());
  Map<String,HostGroup> hostGroups=blueprint.getHostGroups();
  HostGroup group1=hostGroups.get("group1");
  assertEquals("group1",group1.getName());
  assertEquals("1",group1.getCardinality());
  Collection<String> components=group1.getComponentNames();
  assertEquals(2,components.size());
  assertTrue(components.contains("component1"));
  assertTrue(components.contains("component2"));
  Collection<String> services=group1.getServices();
  assertEquals(2,services.size());
  assertTrue(services.contains("test-service1"));
  assertTrue(services.contains("test-service2"));
  assertTrue(group1.containsMasterComponent());
  Configuration configuration=group1.getConfiguration();
  assertTrue(configuration.getProperties().isEmpty());
  assertTrue(configuration.getAttributes().isEmpty());
  HostGroup group2=hostGroups.get("group2");
  assertEquals("group2",group2.getName());
  assertEquals("2",group2.getCardinality());
  components=group2.getComponentNames();
  assertEquals(1,components.size());
  assertTrue(components.contains("component1"));
  services=group2.getServices();
  assertEquals(1,services.size());
  assertTrue(services.contains("test-service1"));
  assertTrue(group2.containsMasterComponent());
  configuration=group2.getConfiguration();
  assertTrue(configuration.getProperties().isEmpty());
  assertTrue(configuration.getAttributes().isEmpty());
  verify(dao,entity,configEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigurationFactoryTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNewSyntax() throws Exception {
  ConfigurationFactory factory=new ConfigurationFactory();
  Configuration configuration=factory.getConfiguration(getNewSyntaxConfigProps());
  Map<String,Map<String,String>> properties=configuration.getProperties();
  assertEquals(2,properties.size());
  Map<String,String> configProperties1=properties.get("foo-type");
  assertEquals(2,configProperties1.size());
  assertEquals("prop1Value",configProperties1.get("prop1"));
  assertEquals("prop2Value",configProperties1.get("prop2"));
  Map<String,String> configProperties2=properties.get("bar-type");
  assertEquals(1,configProperties2.size());
  assertEquals("prop3Value",configProperties2.get("prop3"));
  Map<String,Map<String,Map<String,String>>> attributes=configuration.getAttributes();
  assertEquals(2,attributes.size());
  Map<String,Map<String,String>> configType1Attributes=attributes.get("foo-type");
  assertEquals(3,configType1Attributes.size());
  Map<String,String> configType1Prop1Attributes=configType1Attributes.get("prop1");
  assertEquals(2,configType1Prop1Attributes.size());
  assertEquals("attribute1-prop1-value",configType1Prop1Attributes.get("attribute1"));
  assertEquals("attribute2-prop1-value",configType1Prop1Attributes.get("attribute2"));
  Map<String,String> configType1Prop2Attributes=configType1Attributes.get("prop2");
  assertEquals(1,configType1Prop2Attributes.size());
  assertEquals("attribute1-prop2-value",configType1Prop2Attributes.get("attribute1"));
  Map<String,String> configType1Prop3Attributes=configType1Attributes.get("prop3");
  assertEquals(1,configType1Prop3Attributes.size());
  assertEquals("attribute1-prop3-value",configType1Prop3Attributes.get("attribute1"));
  Map<String,Map<String,String>> configType2Attributes=attributes.get("foobar-type");
  assertEquals(2,configType2Attributes.size());
  Map<String,String> configType2Prop1Attributes=configType2Attributes.get("prop10");
  assertEquals(1,configType2Prop1Attributes.size());
  assertEquals("attribute1-prop10-value",configType2Prop1Attributes.get("attribute1"));
  Map<String,String> configType2Prop2Attributes=configType2Attributes.get("prop11");
  assertEquals(1,configType2Prop2Attributes.size());
  assertEquals("attribute10-prop11-value",configType2Prop2Attributes.get("attribute10"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigurationTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFullAttributes_withParent(){
  Configuration configuration=createConfigurationWithParents_AttributesOnly();
  Map<String,Map<String,Map<String,String>>> fullAttributes=configuration.getFullAttributes();
  assertEquals(2,fullAttributes.size());
  Map<String,Map<String,String>> type1Attributes=fullAttributes.get("type1");
  assertEquals(4,type1Attributes.size());
  Map<String,String> attribute1Properties=type1Attributes.get("attribute1");
  assertEquals(5,attribute1Properties.size());
  assertEquals("val1.3",attribute1Properties.get("prop1"));
  assertEquals("val2.2",attribute1Properties.get("prop2"));
  assertEquals("val3.1",attribute1Properties.get("prop3"));
  assertEquals("val6.2",attribute1Properties.get("prop6"));
  assertEquals("val9.3",attribute1Properties.get("prop9"));
  Map<String,String> attribute2Properties=type1Attributes.get("attribute2");
  assertEquals(2,attribute2Properties.size());
  assertEquals("val4.3",attribute2Properties.get("prop4"));
  assertEquals("val5.1",attribute2Properties.get("prop5"));
  Map<String,String> attribute3Properties=type1Attributes.get("attribute3");
  assertEquals(2,attribute3Properties.size());
  assertEquals("val7.3",attribute3Properties.get("prop7"));
  assertEquals("val8.2",attribute3Properties.get("prop8"));
  Map<String,String> attribute4Properties=type1Attributes.get("attribute4");
  assertEquals(2,attribute4Properties.size());
  assertEquals("val10.3",attribute4Properties.get("prop10"));
  assertEquals("val11.3",attribute4Properties.get("prop11"));
  Map<String,Map<String,String>> type2Attributes=fullAttributes.get("type2");
  assertEquals(2,type2Attributes.size());
  Map<String,String> attribute100Properties=type2Attributes.get("attribute100");
  assertEquals(3,attribute100Properties.size());
  assertEquals("val100.3",attribute100Properties.get("prop100"));
  assertEquals("val101.1",attribute100Properties.get("prop101"));
  assertEquals("val102.3",attribute100Properties.get("prop102"));
  Map<String,String> attribute101Properties=type2Attributes.get("attribute101");
  assertEquals(2,attribute101Properties.size());
  assertEquals("val100.2",attribute101Properties.get("prop100"));
  assertEquals("val101.1",attribute101Properties.get("prop101"));
  Configuration expectedConfiguration=createConfigurationWithParents_AttributesOnly();
  assertEquals(expectedConfiguration.getAttributes(),configuration.getAttributes());
  assertEquals(expectedConfiguration.getParentConfiguration().getAttributes(),configuration.getParentConfiguration().getAttributes());
  assertEquals(expectedConfiguration.getParentConfiguration().getParentConfiguration().getAttributes(),configuration.getParentConfiguration().getParentConfiguration().getAttributes());
  assertEquals(EMPTY_PROPERTIES,configuration.getProperties());
  Collection<String> configTypes=configuration.getAllConfigTypes();
  assertEquals(2,configTypes.size());
  assertTrue(configTypes.containsAll(Arrays.asList("type1","type2")));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFullProperties_withParent(){
  Configuration configuration=createConfigurationWithParents_PropsOnly();
  Map<String,Map<String,String>> fullProperties=configuration.getFullProperties();
  assertEquals(4,fullProperties.size());
  Map<String,String> type1Props=fullProperties.get("type1");
  assertEquals(5,type1Props.size());
  assertEquals("val1.3",type1Props.get("prop1"));
  assertEquals("val2.2",type1Props.get("prop2"));
  assertEquals("val3.1",type1Props.get("prop3"));
  assertEquals("val6.2",type1Props.get("prop6"));
  assertEquals("val9.3",type1Props.get("prop9"));
  Map<String,String> type2Props=fullProperties.get("type2");
  assertEquals(2,type2Props.size());
  assertEquals("val4.3",type2Props.get("prop4"));
  assertEquals("val5.1",type2Props.get("prop5"));
  Map<String,String> type3Props=fullProperties.get("type3");
  assertEquals(2,type3Props.size());
  assertEquals("val7.3",type3Props.get("prop7"));
  assertEquals("val8.2",type3Props.get("prop8"));
  Map<String,String> type4Props=fullProperties.get("type4");
  assertEquals(2,type4Props.size());
  assertEquals("val10.3",type4Props.get("prop10"));
  assertEquals("val11.3",type4Props.get("prop11"));
  Configuration expectedConfiguration=createConfigurationWithParents_PropsOnly();
  assertEquals(expectedConfiguration.getProperties(),configuration.getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getProperties(),configuration.getParentConfiguration().getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getParentConfiguration().getProperties(),configuration.getParentConfiguration().getParentConfiguration().getProperties());
  assertEquals(EMPTY_ATTRIBUTES,configuration.getAttributes());
  Collection<String> configTypes=configuration.getAllConfigTypes();
  assertEquals(4,configTypes.size());
  assertTrue(configTypes.containsAll(Arrays.asList("type1","type2","type3","type4")));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetFullProperties_withParent_specifyDepth(){
  Configuration configuration=createConfigurationWithParents_PropsOnly();
  Map<String,Map<String,String>> fullProperties=configuration.getFullProperties(1);
  assertEquals(4,fullProperties.size());
  Map<String,String> type1Props=fullProperties.get("type1");
  assertEquals(4,type1Props.size());
  assertEquals("val1.3",type1Props.get("prop1"));
  assertEquals("val2.2",type1Props.get("prop2"));
  assertEquals("val6.2",type1Props.get("prop6"));
  assertEquals("val9.3",type1Props.get("prop9"));
  Map<String,String> type2Props=fullProperties.get("type2");
  assertEquals(1,type2Props.size());
  assertEquals("val4.3",type2Props.get("prop4"));
  Map<String,String> type3Props=fullProperties.get("type3");
  assertEquals(2,type3Props.size());
  assertEquals("val7.3",type3Props.get("prop7"));
  assertEquals("val8.2",type3Props.get("prop8"));
  Map<String,String> type4Props=fullProperties.get("type4");
  assertEquals(2,type4Props.size());
  assertEquals("val10.3",type4Props.get("prop10"));
  assertEquals("val11.3",type4Props.get("prop11"));
  Configuration expectedConfiguration=createConfigurationWithParents_PropsOnly();
  assertEquals(expectedConfiguration.getProperties(),configuration.getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getProperties(),configuration.getParentConfiguration().getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getParentConfiguration().getProperties(),configuration.getParentConfiguration().getParentConfiguration().getProperties());
  assertEquals(EMPTY_ATTRIBUTES,configuration.getAttributes());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog151Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.5.1",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.5.0",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog160Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.6.0",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.5.1",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog161Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.6.1",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.6.0",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog170Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.6.1",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.7.0",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog200Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.0.0",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRepositoryTable(){
  final RepositoryInfo repositoryInfo1=new RepositoryInfo();
  repositoryInfo1.setOsType("redhat6");
  repositoryInfo1.setRepoId("HDP-2.2");
  repositoryInfo1.setBaseUrl("http://public-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.2.6.0");
  final RepositoryInfo repositoryInfo2=new RepositoryInfo();
  repositoryInfo2.setOsType("suse11");
  repositoryInfo2.setRepoId("HDP-UTILS-1.1.0.20");
  repositoryInfo2.setBaseUrl("http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.20/repos/suse11sp3");
  List<RepositoryInfo> repos=new ArrayList<RepositoryInfo>(){
{
      add(repositoryInfo1);
      add(repositoryInfo2);
    }
  }
;
  String output=UpgradeCatalog200.repositoryTable(repos);
  assertEquals("  redhat6 |            HDP-2.2 | http://public-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.2.6.0 \n" + "   suse11 | HDP-UTILS-1.1.0.20 | http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.20/repos/suse11sp3 \n",output);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("1.7.0",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog210Test </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact_Simple() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_simple.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  assertNotNull(kerberosDescriptorOrig.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog210 upgradeMock=createMockBuilder(UpgradeCatalog210.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  assertNull(kerberosDescriptorUpdated.getIdentity("/hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact_NoHDFSService() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_no_hdfs.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  assertNotNull(kerberosDescriptorOrig.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNull(serviceDescriptor);
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog210 upgradeMock=createMockBuilder(UpgradeCatalog210.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  assertNull(kerberosDescriptorUpdated.getIdentity("/hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.1.0",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.0.0",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestUpdateHiveEnvContent(){
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  final AmbariManagementController mockAmbariManagementController=easyMockSupport.createNiceMock(AmbariManagementController.class);
  final ConfigHelper mockConfigHelper=easyMockSupport.createMock(ConfigHelper.class);
  final Clusters mockClusters=easyMockSupport.createStrictMock(Clusters.class);
  final Injector mockInjector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(AmbariManagementController.class).toInstance(mockAmbariManagementController);
      bind(ConfigHelper.class).toInstance(mockConfigHelper);
      bind(Clusters.class).toInstance(mockClusters);
      bind(DBAccessor.class).toInstance(createNiceMock(DBAccessor.class));
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
    }
  }
);
  String content="# Start HIVE_AUX_JARS_PATH \n" + "if [ \"${HIVE_AUX_JARS_PATH}\" != \"\" ]; then\n" + "  export HIVE_AUX_JARS_PATH=${HIVE_AUX_JARS_PATH}\n"+ "elif [ -d \"/usr/hdp/current/hive-webhcat/share/hcatalog\" ]; then \n"+ "  export HIVE_AUX_JARS_PATH=/usr/hdp/current/hive-webhcat/share/hcatalog\n"+ "fi\n"+ "#End HIVE_AUX_JARS_PATH";
  String expectedContent="# Start HIVE_AUX_JARS_PATH \n" + "if [ \"${HIVE_AUX_JARS_PATH}\" != \"\" ]; then\n" + "  if [ -f \"${HIVE_AUX_JARS_PATH}\" ]; then    \n"+ "    export HIVE_AUX_JARS_PATH=${HIVE_AUX_JARS_PATH}\n"+ "  elif [ -d \"/usr/hdp/current/hive-webhcat/share/hcatalog\" ]; then\n"+ "    export HIVE_AUX_JARS_PATH=/usr/hdp/current/hive-webhcat/share/hcatalog/hive-hcatalog-core.jar\n"+ "  fi\n"+ "elif [ -d \"/usr/hdp/current/hive-webhcat/share/hcatalog\" ]; then\n"+ "  export HIVE_AUX_JARS_PATH=/usr/hdp/current/hive-webhcat/share/hcatalog/hive-hcatalog-core.jar\n"+ "fi\n"+ "#End HIVE_AUX_JARS_PATH";
  String modifiedContent=mockInjector.getInstance(UpgradeCatalog210.class).updateHiveEnvContent(content);
  Assert.assertEquals(modifiedContent,expectedContent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog211Test </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  final OsFamily osFamily=createNiceMock(OsFamily.class);
  Provider<EntityManager> entityManagerProvider=initEntityManagerProvider();
  replayAll();
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor,osFamily,entityManagerProvider.get());
  Assert.assertEquals("2.1.1",upgradeCatalog.getTargetVersion());
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  final OsFamily osFamily=createNiceMock(OsFamily.class);
  Provider<EntityManager> entityManagerProvider=initEntityManagerProvider();
  replayAll();
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor,osFamily,entityManagerProvider.get());
  Assert.assertEquals("2.1.0",upgradeCatalog.getSourceVersion());
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog212Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.1.1",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.1.2",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog220Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSourceVersion(){
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.1.2.1",upgradeCatalog.getSourceVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTargetVersion() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  UpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Assert.assertEquals("2.2.0",upgradeCatalog.getTargetVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateAmsEnvContent() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
  Method updateAmsEnvContent=UpgradeCatalog220.class.getDeclaredMethod("updateAmsEnvContent",String.class);
  UpgradeCatalog220 upgradeCatalog220=new UpgradeCatalog220(injector);
  String oldContent="some_content";
  String expectedContent="some_content" + "\n" + "# AMS Collector GC options\n"+ "export AMS_COLLECTOR_GC_OPTS=\"-XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=70 "+ "-XX:+UseCMSInitiatingOccupancyOnly -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps "+ "-XX:+UseGCLogFileRotation -XX:GCLogFileSize=10M "+ "-Xloggc:{{ams_collector_log_dir}}/collector-gc.log-`date +'%Y%m%d%H%M'`\"\n"+ "export AMS_COLLECTOR_OPTS=\"$AMS_COLLECTOR_OPTS $AMS_COLLECTOR_GC_OPTS\"\n"+ "\n"+ "# HBase compaction policy enabled\n"+ "export HBASE_NORMALIZATION_ENABLED={{ams_hbase_normalizer_enabled}}\n"+ "\n"+ "# HBase compaction policy enabled\n"+ "export HBASE_FIFO_COMPACTION_POLICY_ENABLED={{ams_hbase_fifo_compaction_policy_enabled}}\n";
  String result=(String)updateAmsEnvContent.invoke(upgradeCatalog220,oldContent);
  Assert.assertEquals(expectedContent,result);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateAmsHbaseEnvContent() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
  Method updateAmsHbaseEnvContent=UpgradeCatalog220.class.getDeclaredMethod("updateAmsHbaseEnvContent",String.class);
  UpgradeCatalog220 upgradeCatalog220=new UpgradeCatalog220(injector);
  String oldContent="export HBASE_CLASSPATH=${HBASE_CLASSPATH}\n" + "\n" + "# The maximum amount of heap to use, in MB. Default is 1000.\n"+ "export HBASE_HEAPSIZE={{hbase_heapsize}}\n";
  String expectedContent="export HBASE_CLASSPATH=${HBASE_CLASSPATH}\n" + "\n" + "# The maximum amount of heap to use, in MB. Default is 1000.\n"+ "#export HBASE_HEAPSIZE={{hbase_heapsize}}\n"+ "\n"+ "# The maximum amount of heap to use for hbase shell.\n"+ "export HBASE_SHELL_OPTS=\"-Xmx256m\"\n";
  String result=(String)updateAmsHbaseEnvContent.invoke(upgradeCatalog220,oldContent);
  Assert.assertEquals(expectedContent,result);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_2_1_3.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog220 upgradeMock=createMockBuilder(UpgradeCatalog220.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("hdfs"));
  KerberosComponentDescriptor namenodeComponent=serviceDescriptor.getComponent("NAMENODE");
  assertNotNull(namenodeComponent.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/NAMENODE/hdfs"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog221Test </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateAmsEnvContent() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
  Method updateAmsEnvContent=UpgradeCatalog221.class.getDeclaredMethod("updateAmsEnvContent",String.class);
  UpgradeCatalog221 upgradeCatalog221=new UpgradeCatalog221(injector);
  String oldContent="some_content\n" + "# AMS Collector options\n" + "export AMS_COLLECTOR_OPTS=\"-Djava.library.path=/usr/lib/ams-hbase/lib/hadoop-native\"\n"+ "{% if security_enabled %}\n"+ "export AMS_COLLECTOR_OPTS=\"$AMS_COLLECTOR_OPTS -Djava.security.auth.login.config={{ams_collector_jaas_config_file}} "+ "-Dzookeeper.sasl.client.username={{zk_servicename}}\"\n"+ "{% endif %}";
  String expectedContent="some_content\n" + "# AMS Collector options\n" + "export AMS_COLLECTOR_OPTS=\"-Djava.library.path=/usr/lib/ams-hbase/lib/hadoop-native\"\n"+ "{% if security_enabled %}\n"+ "export AMS_COLLECTOR_OPTS=\"$AMS_COLLECTOR_OPTS -Djava.security.auth.login.config={{ams_collector_jaas_config_file}}\"\n"+ "{% endif %}";
  String result=(String)updateAmsEnvContent.invoke(upgradeCatalog221,oldContent);
  Assert.assertEquals(expectedContent,result);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateAmsHbaseEnvContent() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
  Method updateAmsHbaseEnvContent=UpgradeCatalog221.class.getDeclaredMethod("updateAmsHbaseEnvContent",String.class);
  UpgradeCatalog221 upgradeCatalog221=new UpgradeCatalog221(injector);
  String oldContent="some_content\n" + "{% if security_enabled %}\n" + "export HBASE_OPTS=\"$HBASE_OPTS -Djava.security.auth.login.config={{client_jaas_config_file}} -Dzookeeper.sasl.client.username={{zk_servicename}}\"\n"+ "export HBASE_MASTER_OPTS=\"$HBASE_MASTER_OPTS -Djava.security.auth.login.config={{master_jaas_config_file}} -Dzookeeper.sasl.client.username={{zk_servicename}}\"\n"+ "export HBASE_REGIONSERVER_OPTS=\"$HBASE_REGIONSERVER_OPTS -Djava.security.auth.login.config={{regionserver_jaas_config_file}} -Dzookeeper.sasl.client.username={{zk_servicename}}\"\n"+ "export HBASE_ZOOKEEPER_OPTS=\"$HBASE_ZOOKEEPER_OPTS -Djava.security.auth.login.config={{ams_zookeeper_jaas_config_file}} -Dzookeeper.sasl.client.username={{zk_servicename}}\"\n"+ "{% endif %}";
  String expectedContent="some_content\n" + "{% if security_enabled %}\n" + "export HBASE_OPTS=\"$HBASE_OPTS -Djava.security.auth.login.config={{client_jaas_config_file}}\"\n"+ "export HBASE_MASTER_OPTS=\"$HBASE_MASTER_OPTS -Djava.security.auth.login.config={{master_jaas_config_file}}\"\n"+ "export HBASE_REGIONSERVER_OPTS=\"$HBASE_REGIONSERVER_OPTS -Djava.security.auth.login.config={{regionserver_jaas_config_file}}\"\n"+ "export HBASE_ZOOKEEPER_OPTS=\"$HBASE_ZOOKEEPER_OPTS -Djava.security.auth.login.config={{ams_zookeeper_jaas_config_file}}\"\n"+ "{% endif %}";
  String result=(String)updateAmsHbaseEnvContent.invoke(upgradeCatalog221,oldContent);
  Assert.assertEquals(expectedContent,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog230Test </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  final DBAccessor dbAccessor=injector.getInstance(DBAccessor.class);
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getDatabaseUrl()).andReturn(Configuration.JDBC_IN_MEMORY_URL).anyTimes();
  Capture<DBAccessor.DBColumnInfo> columnCapture=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> columnCapturePermissionLabel=EasyMock.newCapture();
  Capture<List<DBAccessor.DBColumnInfo>> columnsCaptureRoleAuthorization=EasyMock.newCapture();
  Capture<List<DBAccessor.DBColumnInfo>> columnsCapturePermissionRoleAuthorization=EasyMock.newCapture();
  dbAccessor.alterColumn(eq("host_role_command"),capture(columnCapture));
  expectLastCall();
  dbAccessor.addColumn(eq("adminpermission"),capture(columnCapturePermissionLabel));
  expectLastCall();
  dbAccessor.createTable(eq("roleauthorization"),capture(columnsCaptureRoleAuthorization),eq("authorization_id"));
  expectLastCall();
  dbAccessor.createTable(eq("permission_roleauthorization"),capture(columnsCapturePermissionRoleAuthorization),eq("permission_id"),eq("authorization_id"));
  expectLastCall();
  dbAccessor.addFKConstraint("permission_roleauthorization","FK_permission_roleauth_pid","permission_id","adminpermission","permission_id",false);
  expectLastCall();
  dbAccessor.addFKConstraint("permission_roleauthorization","FK_permission_roleauth_aid","authorization_id","roleauthorization","authorization_id",false);
  expectLastCall();
  replayAll();
  AbstractUpgradeCatalog upgradeCatalog=injector.getInstance(UpgradeCatalog230.class);
  Class<?> c=AbstractUpgradeCatalog.class;
  Field f=c.getDeclaredField("configuration");
  f.setAccessible(true);
  f.set(upgradeCatalog,configuration);
  upgradeCatalog.executeDDLUpdates();
  verifyAll();
  assertTrue(columnCapture.getValue().isNullable());
  assertEquals(columnCapturePermissionLabel.getValue().getName(),"permission_label");
  assertEquals(columnCapturePermissionLabel.getValue().getType(),String.class);
  assertEquals(columnCapturePermissionLabel.getValue().getLength(),Integer.valueOf(255));
  assertEquals(columnCapturePermissionLabel.getValue().isNullable(),true);
  List<DBAccessor.DBColumnInfo> columnInfos;
  DBAccessor.DBColumnInfo columnInfo;
  columnInfos=columnsCaptureRoleAuthorization.getValue();
  assertEquals(2,columnInfos.size());
  columnInfo=columnInfos.get(0);
  assertEquals("authorization_id",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(100),columnInfo.getLength());
  columnInfo=columnInfos.get(1);
  assertEquals("authorization_name",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(255),columnInfo.getLength());
  columnInfos=columnsCapturePermissionRoleAuthorization.getValue();
  assertEquals(2,columnInfos.size());
  columnInfo=columnInfos.get(0);
  assertEquals("permission_id",columnInfo.getName());
  assertEquals(Long.class,columnInfo.getType());
  assertEquals(null,columnInfo.getLength());
  columnInfo=columnInfos.get(1);
  assertEquals("authorization_id",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(100),columnInfo.getLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.SetUtilsTest </h4><pre class="type-4 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  try {
    SetUtils.split(null,0);
    Assert.fail("Expected IllegalArgumentException.");
  }
 catch (  IllegalArgumentException e) {
  }
  int size=10;
  List<Set<Integer>> subsets=SetUtils.split(null,size);
  Assert.assertEquals(0,subsets.size());
  subsets=SetUtils.split(Collections.EMPTY_SET,size);
  Assert.assertEquals(0,subsets.size());
  subsets=SetUtils.split(Collections.singleton(0),size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(1,subsets.get(0).size());
  Set<Integer> set=new LinkedHashSet<Integer>(5);
  for (int i=0; i < 5; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(5,subsets.get(0).size());
  set=new LinkedHashSet<Integer>(10);
  for (int i=0; i < 10; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(1,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  set=new LinkedHashSet<Integer>(11);
  for (int i=0; i < 11; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(2,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(1,subsets.get(1).size());
  set=new LinkedHashSet<Integer>(20);
  for (int i=0; i < 20; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(2,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(10,subsets.get(1).size());
  set=new LinkedHashSet<Integer>(27);
  for (int i=0; i < 27; i++) {
    set.add(i);
  }
  subsets=SetUtils.split(set,size);
  Assert.assertEquals(3,subsets.size());
  Assert.assertEquals(10,subsets.get(0).size());
  Assert.assertEquals(10,subsets.get(1).size());
  Assert.assertEquals(7,subsets.get(2).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.StageUtilsTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJasonToExecutionCommand() throws JsonGenerationException, JsonMappingException, JAXBException, IOException {
  StageUtils stageUtils=new StageUtils(injector.getInstance(StageFactory.class));
  Stage s=StageUtils.getATestStage(1,2,"host1","clusterHostInfo","hostParamsStage");
  ExecutionCommand cmd=s.getExecutionCommands(getHostName()).get(0).getExecutionCommand();
  HashMap<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
  Map<String,String> globalTag=new HashMap<String,String>();
  globalTag.put("tag","version1");
  configTags.put("global",globalTag);
  cmd.setConfigurationTags(configTags);
  String json=StageUtils.jaxbToString(cmd);
  InputStream is=new ByteArrayInputStream(json.getBytes(Charset.forName("UTF8")));
  ExecutionCommand cmdDes=new Gson().fromJson(new InputStreamReader(is),ExecutionCommand.class);
  assertEquals(cmd.toString(),cmdDes.toString());
  assertEquals(cmd,cmdDes);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterHostInfo() throws Exception {
  final HashMap<String,String> hostAttributes=new HashMap<String,String>(){
{
      put("os_family","redhat");
      put("os_release_version","5.9");
    }
  }
;
  final Clusters clusters=createNiceMock(Clusters.class);
  List<Host> hosts=new ArrayList<Host>();
  List<String> hostNames=new ArrayList<String>();
  List<Integer> pingPorts=Arrays.asList(StageUtils.DEFAULT_PING_PORT,StageUtils.DEFAULT_PING_PORT,StageUtils.DEFAULT_PING_PORT,8671,8671,null,8672,8672,null,8673);
  for (int i=0; i < 10; i++) {
    String hostname=String.format("h%d",i);
    Host host=createNiceMock(Host.class);
    expect(host.getHostName()).andReturn(hostname).anyTimes();
    expect(host.getHostAttributes()).andReturn(hostAttributes).anyTimes();
    expect(host.getCurrentPingPort()).andReturn(pingPorts.get(i)).anyTimes();
    hosts.add(host);
    hostNames.add(hostname);
    expect(clusters.getHost(hostname)).andReturn(host).anyTimes();
  }
  final ServiceComponentHost nnh0ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(nnh0ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost snnh1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(snnh1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh0ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh0ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh2ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh2ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh8ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh8ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbm5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbm5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs8ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs8ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrjt5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrjt5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt2ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt2ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.DECOMMISSIONED).anyTimes();
  final ServiceComponentHost mrtt3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.DECOMMISSIONED).anyTimes();
  final ServiceComponentHost mrtt4ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt4ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost nns7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(nns7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  Map<String,Collection<String>> projectedTopology=new HashMap<String,Collection<String>>();
  final HashMap<String,ServiceComponentHost> nnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h0",nnh0ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"NAMENODE",nnServiceComponentHosts.keySet());
  final HashMap<String,ServiceComponentHost> snnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",snnh1ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"SECONDARY_NAMENODE",snnServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> dnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h0",dnh0ServiceComponentHost);
      put("h1",dnh1ServiceComponentHost);
      put("h2",dnh2ServiceComponentHost);
      put("h3",dnh3ServiceComponentHost);
      put("h5",dnh5ServiceComponentHost);
      put("h7",dnh7ServiceComponentHost);
      put("h8",dnh8ServiceComponentHost);
      put("h9",dnh9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"DATANODE",dnServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> hbmServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h5",hbm5ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"HBASE_MASTER",hbmServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> hbrsServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",hbrs1ServiceComponentHost);
      put("h3",hbrs3ServiceComponentHost);
      put("h5",hbrs5ServiceComponentHost);
      put("h8",hbrs8ServiceComponentHost);
      put("h9",hbrs9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"HBASE_REGIONSERVER",hbrsServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> mrjtServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h5",mrjt5ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"JOBTRACKER",mrjtServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> mrttServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",mrtt1ServiceComponentHost);
      put("h2",mrtt2ServiceComponentHost);
      put("h3",mrtt3ServiceComponentHost);
      put("h4",mrtt4ServiceComponentHost);
      put("h5",mrtt5ServiceComponentHost);
      put("h7",mrtt7ServiceComponentHost);
      put("h9",mrtt9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"TASKTRACKER",mrttServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> nnsServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h7",nns7ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"NONAME_SERVER",nnsServiceComponentHosts.keySet());
  final ServiceComponent nnComponent=createMock(ServiceComponent.class);
  expect(nnComponent.getName()).andReturn("NAMENODE").anyTimes();
  expect(nnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return nnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(nnComponent.getServiceComponentHosts()).andReturn(nnServiceComponentHosts).anyTimes();
  expect(nnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent snnComponent=createMock(ServiceComponent.class);
  expect(snnComponent.getName()).andReturn("SECONDARY_NAMENODE").anyTimes();
  expect(snnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return snnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(snnComponent.getServiceComponentHosts()).andReturn(snnServiceComponentHosts).anyTimes();
  expect(snnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent dnComponent=createMock(ServiceComponent.class);
  expect(dnComponent.getName()).andReturn("DATANODE").anyTimes();
  expect(dnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return dnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(dnComponent.getServiceComponentHosts()).andReturn(dnServiceComponentHosts).anyTimes();
  expect(dnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent hbmComponent=createMock(ServiceComponent.class);
  expect(hbmComponent.getName()).andReturn("HBASE_MASTER").anyTimes();
  expect(hbmComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return hbmServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(hbmComponent.getServiceComponentHosts()).andReturn(hbmServiceComponentHosts).anyTimes();
  expect(hbmComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent hbrsComponent=createMock(ServiceComponent.class);
  expect(hbrsComponent.getName()).andReturn("HBASE_REGIONSERVER").anyTimes();
  expect(hbrsComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return hbrsServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  Map<String,ServiceComponentHost> hbrsHosts=Maps.filterKeys(hbrsServiceComponentHosts,new Predicate<String>(){
    @Override public boolean apply(    String s){
      return s.equals("h1");
    }
  }
);
  expect(hbrsComponent.getServiceComponentHosts()).andReturn(hbrsServiceComponentHosts).anyTimes();
  expect(hbrsComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent mrjtComponent=createMock(ServiceComponent.class);
  expect(mrjtComponent.getName()).andReturn("JOBTRACKER").anyTimes();
  expect(mrjtComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return mrjtServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(mrjtComponent.getServiceComponentHosts()).andReturn(mrjtServiceComponentHosts).anyTimes();
  expect(mrjtComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent mrttCompomnent=createMock(ServiceComponent.class);
  expect(mrttCompomnent.getName()).andReturn("TASKTRACKER").anyTimes();
  expect(mrttCompomnent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return mrttServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(mrttCompomnent.getServiceComponentHosts()).andReturn(mrttServiceComponentHosts).anyTimes();
  expect(mrttCompomnent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent nnsComponent=createMock(ServiceComponent.class);
  expect(nnsComponent.getName()).andReturn("NONAME_SERVER").anyTimes();
  expect(nnsComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return nnsServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(nnsComponent.getServiceComponentHosts()).andReturn(nnsServiceComponentHosts).anyTimes();
  expect(nnsComponent.isClientComponent()).andReturn(false).anyTimes();
  final Service hdfsService=createMock(Service.class);
  expect(hdfsService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("NAMENODE",nnComponent);
      put("SECONDARY_NAMENODE",snnComponent);
      put("DATANODE",dnComponent);
    }
  }
).anyTimes();
  final Service hbaseService=createMock(Service.class);
  expect(hbaseService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("HBASE_MASTER",hbmComponent);
      put("HBASE_REGIONSERVER",hbrsComponent);
    }
  }
).anyTimes();
  final Service mrService=createMock(Service.class);
  expect(mrService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("JOBTRACKER",mrjtComponent);
      put("TASKTRACKER",mrttCompomnent);
    }
  }
).anyTimes();
  final Service nnService=createMock(Service.class);
  expect(nnService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("NONAME_SERVER",nnsComponent);
    }
  }
).anyTimes();
  Cluster cluster=createMock(Cluster.class);
  expect(cluster.getHosts()).andReturn(hosts).anyTimes();
  expect(cluster.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("HDFS",hdfsService);
      put("HBASE",hbaseService);
      put("MAPREDUCE",mrService);
      put("NONAME",nnService);
    }
  }
).anyTimes();
  final TopologyManager topologyManager=injector.getInstance(TopologyManager.class);
  topologyManager.getPendingHostComponents();
  expectLastCall().andReturn(projectedTopology).once();
  replayAll();
  injector.getInstance(AmbariMetaInfo.class).init();
  Map<String,Set<String>> info=StageUtils.getClusterHostInfo(cluster);
  verifyAll();
  Set<String> allHosts=info.get(StageUtils.HOSTS_LIST);
  assertEquals(hosts.size(),allHosts.size());
  for (  Host host : hosts) {
    assertTrue(allHosts.contains(host.getHostName()));
  }
  checkServiceHostIndexes(info,"DATANODE","slave_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"NAMENODE","namenode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"SECONDARY_NAMENODE","snamenode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"HBASE_MASTER","hbase_master_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"HBASE_REGIONSERVER","hbase_rs_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"JOBTRACKER","jtnode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"TASKTRACKER","mapred_tt_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"NONAME_SERVER","noname_server_hosts",projectedTopology,hostNames);
  Set<String> actualPingPorts=info.get(StageUtils.PORTS);
  if (pingPorts.contains(null)) {
    assertEquals(new HashSet<Integer>(pingPorts).size(),actualPingPorts.size() + 1);
  }
 else {
    assertEquals(new HashSet<Integer>(pingPorts).size(),actualPingPorts.size());
  }
  List<Integer> pingPortsActual=getRangeMappedDecompressedSet(actualPingPorts);
  List<Integer> reindexedPorts=getReindexedList(pingPortsActual,new ArrayList<String>(allHosts),hostNames);
  List<Integer> expectedPingPorts=new ArrayList<Integer>(pingPorts);
  for (int i=0; i < expectedPingPorts.size(); i++) {
    if (expectedPingPorts.get(i) == null) {
      expectedPingPorts.set(i,StageUtils.DEFAULT_PING_PORT);
    }
  }
  assertEquals(expectedPingPorts,reindexedPorts);
  assertTrue(info.containsKey("decom_tt_hosts"));
  Set<String> decommissionedHosts=info.get("decom_tt_hosts");
  assertEquals(2,decommissionedHosts.toString().split(",").length);
  assertTrue(info.containsKey(StageUtils.AMBARI_SERVER_HOST));
  Set<String> serverHost=info.get(StageUtils.AMBARI_SERVER_HOST);
  assertEquals(1,serverHost.size());
  assertEquals(StageUtils.getHostName(),serverHost.iterator().next());
  assertTrue(getDecompressedSet(info.get("hbase_rs_hosts")).contains(9));
  info=StageUtils.substituteHostIndexes(info);
  checkServiceHostNames(info,"DATANODE","slave_hosts",projectedTopology);
  checkServiceHostNames(info,"NAMENODE","namenode_host",projectedTopology);
  checkServiceHostNames(info,"SECONDARY_NAMENODE","snamenode_host",projectedTopology);
  checkServiceHostNames(info,"HBASE_MASTER","hbase_master_hosts",projectedTopology);
  checkServiceHostNames(info,"HBASE_REGIONSERVER","hbase_rs_hosts",projectedTopology);
  checkServiceHostNames(info,"JOBTRACKER","jtnode_host",projectedTopology);
  checkServiceHostNames(info,"TASKTRACKER","mapred_tt_hosts",projectedTopology);
  checkServiceHostNames(info,"NONAME_SERVER","noname_server_hosts",projectedTopology);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestDateUtils </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConvertToReadableTime() throws Exception {
  Long timestamp=1389125737000L;
  String readableTime=DateUtils.convertToReadableTime(timestamp);
  SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
  sdf.setTimeZone(TimeZone.getTimeZone("UTC"));
  Assert.assertEquals("2014-01-07 20:15:37",sdf.format(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(readableTime)));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToDate() throws Exception {
  String time="2013-11-18T14:29:29-0000";
  Date date=DateUtils.convertToDate(time);
  Assert.assertNotNull(date);
  Calendar calendar=Calendar.getInstance();
  calendar.setTimeZone(TimeZone.getTimeZone("UTC"));
  calendar.set(Calendar.YEAR,2013);
  calendar.set(Calendar.MONTH,Calendar.NOVEMBER);
  calendar.set(Calendar.DAY_OF_MONTH,18);
  calendar.set(Calendar.HOUR_OF_DAY,14);
  calendar.set(Calendar.MINUTE,29);
  calendar.set(Calendar.SECOND,29);
  calendar.set(Calendar.MILLISECOND,0);
  Assert.assertEquals(0,date.compareTo(calendar.getTime()));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDateDifferenceInMinutes() throws Exception {
  Calendar calendar=Calendar.getInstance();
  calendar.setTimeZone(TimeZone.getTimeZone("UTC"));
  calendar.set(Calendar.YEAR,2013);
  calendar.set(Calendar.MONTH,Calendar.NOVEMBER);
  calendar.set(Calendar.DAY_OF_MONTH,18);
  calendar.set(Calendar.HOUR_OF_DAY,14);
  calendar.set(Calendar.MINUTE,49);
  calendar.set(Calendar.SECOND,29);
  calendar.set(Calendar.MILLISECOND,0);
  String time="2013-11-18T14:29:29-0000";
  Date date=DateUtils.convertToDate(time);
  Long diff=(Math.abs(date.getTime() - calendar.getTimeInMillis())) / (60 * 1000) % 60;
  Assert.assertEquals(Long.valueOf(20L).longValue(),diff.longValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestHTTPUtils </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostAndPortFromProperty(){
  String value=null;
  HostAndPort hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org:";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org:50070";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertEquals(hp.host,"c6401.ambari.apache.org");
  Assert.assertEquals(hp.port,50070);
  value="  c6401.ambari.apache.org:50070   ";
  Assert.assertEquals(hp.host,"c6401.ambari.apache.org");
  Assert.assertEquals(hp.port,50070);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestParallel </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration exceptions
 * @throws Exception
 */
@Test public void testParallelForLoopIterationExceptions() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        throw new RuntimeException("Ignore this exception");
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests nested {@link org.apache.ambari.server.utils.Parallel} forLoop
 * @throws Exception
 */
@Test public void testNestedParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final ParallelLoopResult<Integer>[] innerLoopResults=new ParallelLoopResult[input.size()];
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    final Integer in1){
      int sq=in1 * in1;
      ParallelLoopResult<Integer> innerLoopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
        @Override public Integer run(        Integer in2){
          return in1 * in2;
        }
      }
);
      innerLoopResults[in1]=innerLoopResult;
      return in1 * in1;
    }
  }
);
  Assert.assertNotNull(loopResult);
  Assert.assertTrue(loopResult.getIsCompleted());
  List<Integer> output=loopResult.getResult();
  Assert.assertNotNull(output);
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
    ParallelLoopResult<Integer> innerLoopResult=innerLoopResults[i];
    Assert.assertNotNull(innerLoopResult);
    Assert.assertTrue(innerLoopResult.getIsCompleted());
    List<Integer> innerOutput=innerLoopResult.getResult();
    Assert.assertNotNull(innerOutput);
    Assert.assertEquals(input.size(),innerOutput.size());
    for (int j=0; j < input.size(); j++) {
      Assert.assertEquals(i * j,(int)innerOutput.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests Parallel.forLoop
 * @throws Exception
 */
@Test public void testParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      return in1 * in1;
    }
  }
);
  Assert.assertTrue(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration failures
 * @throws Exception
 */
@Test public void testParallelForLoopIterationFailures() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        return null;
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestShellCommandUtil </h4><pre class="type-4 type-13 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnixFilePermissions() throws Exception {
  File dummyFile=new File(temp.getRoot() + File.separator + "dummy");
  new FileOutputStream(dummyFile).close();
  if (ShellCommandUtil.LINUX) {
    ShellCommandUtil.setUnixFilePermissions("600",dummyFile.getAbsolutePath());
    String p=ShellCommandUtil.getUnixFilePermissions(dummyFile.getAbsolutePath());
    assertEquals("600",p);
    ShellCommandUtil.setUnixFilePermissions("444",dummyFile.getAbsolutePath());
    p=ShellCommandUtil.getUnixFilePermissions(dummyFile.getAbsolutePath());
    assertEquals("444",p);
    ShellCommandUtil.setUnixFilePermissions("777",dummyFile.getAbsolutePath());
    p=ShellCommandUtil.getUnixFilePermissions(dummyFile.getAbsolutePath());
    assertEquals("777",p);
  }
 else {
    ShellCommandUtil.setUnixFilePermissions(ShellCommandUtil.MASK_OWNER_ONLY_RW,dummyFile.getAbsolutePath());
    String p=ShellCommandUtil.getUnixFilePermissions(dummyFile.getAbsolutePath());
    assertEquals(p,ShellCommandUtil.MASK_EVERYBODY_RWX);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewClassLoaderTest </h4><pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResource() throws Exception {
  ClassLoader parentClassLoader=createMock(ClassLoader.class);
  URL parentResource=new File("parent-resource").toURI().toURL();
  ViewConfig viewConfig=createNiceMock(ViewConfig.class);
  expect(parentClassLoader.getResource("parent-resource")).andReturn(parentResource).once();
  replay(parentClassLoader,viewConfig);
  File file=new File("./src/test/resources");
  URL testURL=file.toURI().toURL();
  URL[] urls=new URL[]{testURL};
  ViewClassLoader classLoader=new ViewClassLoader(viewConfig,parentClassLoader,urls);
  URL url=classLoader.getResource("ambari.properties");
  Assert.assertNotNull(url);
  url=classLoader.getResource("parent-resource");
  Assert.assertNotNull(url);
  Assert.assertSame(parentResource,url);
  verify(parentClassLoader,viewConfig);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadClass() throws Exception {
  TestClassLoader parentClassLoader=createMock(TestClassLoader.class);
  Class parentClass=Object.class;
  ViewConfig viewConfig=createNiceMock(ViewConfig.class);
  expect(parentClassLoader.getPackage("org.apache.ambari.server.view")).andReturn(null).anyTimes();
  expect(parentClassLoader.loadClass("java.lang.Object")).andReturn(parentClass).anyTimes();
  expect(parentClassLoader.loadClass("ParentClass")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.ambari.server.controller.spi.ResourceProvider")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.ambari.view.ViewContext")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("javax.xml.parsers.SAXParserFactory")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("com.google.inject.AbstractModule")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.slf4j.LoggerFactory")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("com.sun.jersey.api.ConflictException")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.velocity.VelocityContext")).andReturn(parentClass).once();
  replay(parentClassLoader,viewConfig);
  File file=new File("./target/test-classes");
  URL testURL=file.toURI().toURL();
  URL[] urls=new URL[]{testURL};
  ViewClassLoader classLoader=new ViewClassLoader(viewConfig,parentClassLoader,urls);
  Class clazz=classLoader.loadClass("ParentClass");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.ambari.server.controller.spi.ResourceProvider");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.ambari.view.ViewContext");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("javax.xml.parsers.SAXParserFactory");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("com.google.inject.AbstractModule");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.slf4j.LoggerFactory");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("com.sun.jersey.api.ConflictException");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.velocity.VelocityContext");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  verify(parentClassLoader,viewConfig);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewContextImplTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertiesWithParameters() throws Exception {
  InstanceConfig instanceConfig=createNiceMock(InstanceConfig.class);
  expect(instanceConfig.getName()).andReturn("Instance").anyTimes();
  replay(instanceConfig);
  ViewEntity viewDefinition=createNiceMock(ViewEntity.class);
  expect(viewDefinition.getName()).andReturn("View").anyTimes();
  expect(viewDefinition.getCommonName()).andReturn("View").times(2);
  expect(viewDefinition.getClassLoader()).andReturn(ViewContextImplTest.class.getClassLoader()).anyTimes();
  expect(viewDefinition.getConfiguration()).andReturn(ViewConfigTest.getConfig()).anyTimes();
  ViewParameterEntity parameter1=createNiceMock(ViewParameterEntity.class);
  expect(parameter1.getName()).andReturn("p1").anyTimes();
  ViewParameterEntity parameter2=createNiceMock(ViewParameterEntity.class);
  expect(parameter2.getName()).andReturn("p2").anyTimes();
  expect(viewDefinition.getParameters()).andReturn(Arrays.asList(parameter1,parameter2)).anyTimes();
  replay(viewDefinition,parameter1,parameter2);
  ViewInstanceEntity viewInstanceDefinition=createMockBuilder(ViewInstanceEntity.class).addMockedMethod("getUsername").addMockedMethod("getName").addMockedMethod("getViewEntity").withConstructor(viewDefinition,instanceConfig).createMock();
  expect(viewInstanceDefinition.getUsername()).andReturn("User").times(1);
  expect(viewInstanceDefinition.getUsername()).andReturn("User2").times(1);
  expect(viewInstanceDefinition.getName()).andReturn("Instance").anyTimes();
  expect(viewInstanceDefinition.getViewEntity()).andReturn(viewDefinition).anyTimes();
  replay(viewInstanceDefinition);
  ViewRegistry viewRegistry=createNiceMock(ViewRegistry.class);
  expect(viewRegistry.getCluster(viewInstanceDefinition)).andReturn(null).anyTimes();
  replay(viewRegistry);
  viewInstanceDefinition.putProperty("p1","/tmp/some/path/${username}");
  viewInstanceDefinition.putProperty("p2",new DefaultMasker().mask("/tmp/path/$viewName"));
  viewInstanceDefinition.putProperty("p3","/path/$instanceName");
  viewInstanceDefinition.putProperty("p4","/path/to/${unspecified_parameter}");
  viewInstanceDefinition.putProperty("p5","/path/to/${incorrect_parameter");
  viewInstanceDefinition.putProperty("p6","/path/to/\\${username}");
  viewInstanceDefinition.putProperty("p7","/path/to/\\$viewName");
  viewInstanceDefinition.putProperty("p8",null);
  ViewContextImpl viewContext=new ViewContextImpl(viewInstanceDefinition,viewRegistry);
  Map<String,String> properties=viewContext.getProperties();
  Assert.assertEquals(8,properties.size());
  Assert.assertEquals("/tmp/some/path/User",properties.get("p1"));
  Assert.assertEquals("/tmp/path/View",properties.get("p2"));
  Assert.assertEquals("/path/Instance",properties.get("p3"));
  Assert.assertEquals("/path/to/${unspecified_parameter}",properties.get("p4"));
  Assert.assertEquals("/path/to/${incorrect_parameter",properties.get("p5"));
  Assert.assertEquals("/path/to/${username}",properties.get("p6"));
  Assert.assertEquals("/path/to/$viewName",properties.get("p7"));
  Assert.assertNull(properties.get("p8"));
  properties=viewContext.getProperties();
  Assert.assertEquals(8,properties.size());
  Assert.assertEquals("/tmp/some/path/User2",properties.get("p1"));
  Assert.assertEquals("/tmp/path/View",properties.get("p2"));
  Assert.assertEquals("/path/Instance",properties.get("p3"));
  Assert.assertEquals("/path/to/${unspecified_parameter}",properties.get("p4"));
  Assert.assertEquals("/path/to/${incorrect_parameter",properties.get("p5"));
  Assert.assertEquals("/path/to/${username}",properties.get("p6"));
  Assert.assertEquals("/path/to/$viewName",properties.get("p7"));
  Assert.assertNull(properties.get("p8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewExtractorTest </h4><pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEnsureExtractedArchiveDirectory() throws Exception {
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  expect(extractedArchiveDir.exists()).andReturn(true);
  replay(extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,viewJarFile,jarEntry,fos,configuration,viewDir,fileEntry,viewDAO);
  ViewExtractor viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,viewJarFile,jarEntry,fos,configuration,viewDir,fileEntry,viewDAO);
  reset(extractedArchiveDir);
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(true);
  replay(extractedArchiveDir);
  viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir);
  reset(extractedArchiveDir);
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(false);
  replay(extractedArchiveDir);
  viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertFalse(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertFalse(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewRegistryTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadViewArchives_exception() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views").anyTimes();
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views").anyTimes();
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  expect(viewDir.listFiles()).andReturn(new File[]{viewArchive}).anyTimes();
  expect(viewArchive.isDirectory()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.mkdir()).andReturn(true);
  expect(archiveDir.toURI()).andReturn(new URI("file:./"));
  expect(metaInfDir.mkdir()).andReturn(true);
  expect(viewJarFile.getNextJarEntry()).andReturn(jarEntry);
  expect(viewJarFile.getNextJarEntry()).andReturn(null);
  expect(jarEntry.getName()).andReturn("view.xml");
  expect(jarEntry.isDirectory()).andReturn(false);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(10);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(-1);
  fos.write(anyObject(byte[].class),eq(0),eq(10));
  fos.flush();
  fos.close();
  viewJarFile.closeEntry();
  viewJarFile.close();
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(true);
  expect(classesDir.exists()).andReturn(true);
  expect(classesDir.toURI()).andReturn(new URI("file:./"));
  expect(libDir.exists()).andReturn(true);
  expect(libDir.listFiles()).andReturn(new File[]{fileEntry});
  expect(fileEntry.toURI()).andReturn(new URI("file:./"));
  expect(viewDAO.findByName("MY_VIEW{1.0.0}")).andThrow(new IllegalArgumentException("Expected exception."));
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  ViewRegistry registry=getRegistry(viewDAO,viewInstanceDAO,userDAO,memberDAO,privilegeDAO,resourceDAO,resourceTypeDAO,securityHelper,handlerList,null,archiveUtility,ambariMetaInfo);
  registry.readViewArchives();
  ViewEntity view=null;
  long timeout=System.currentTimeMillis() + 10000L;
  while ((view == null || !view.getStatus().equals(ViewDefinition.ViewStatus.ERROR)) && System.currentTimeMillis() < timeout) {
    view=registry.getDefinition("MY_VIEW","1.0.0");
  }
  Assert.assertNotNull(view);
  Assert.assertEquals(ViewDefinition.ViewStatus.ERROR,view.getStatus());
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUninstallViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Configuration ambariConfig=new Configuration(new Properties());
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ResourceEntity resource=new ResourceEntity();
  resource.setId(3L);
  viewInstanceEntity.setResource(resource);
  PrivilegeEntity privilege1=createNiceMock(PrivilegeEntity.class);
  PrivilegeEntity privilege2=createNiceMock(PrivilegeEntity.class);
  List<PrivilegeEntity> privileges=Arrays.asList(privilege1,privilege2);
  PrincipalEntity principalEntity=createNiceMock(PrincipalEntity.class);
  expect(privilege1.getPrincipal()).andReturn(principalEntity);
  expect(privilege2.getPrincipal()).andReturn(principalEntity);
  principalEntity.removePrivilege(privilege1);
  principalEntity.removePrivilege(privilege2);
  expect(privilegeDAO.findByResourceId(3L)).andReturn(privileges);
  privilegeDAO.remove(privilege1);
  privilegeDAO.remove(privilege2);
  viewInstanceDAO.remove(viewInstanceEntity);
  handlerList.removeViewInstance(viewInstanceEntity);
  replay(viewInstanceDAO,privilegeDAO,handlerList,privilege1,privilege2,principalEntity);
  registry.addDefinition(viewEntity);
  registry.addInstanceDefinition(viewEntity,viewInstanceEntity);
  registry.uninstallViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(0,viewInstanceDefinitions.size());
  verify(viewInstanceDAO,privilegeDAO,handlerList,privilege1,privilege2,principalEntity);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener_allVersions() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW",null);
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  registry.unregisterListener(listener,"MY_VIEW",null);
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertTrue(viewInstanceDefinitions.isEmpty());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_UPDATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  try {
    registry.updateViewInstance(updateInstance);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,validator,result);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateViewInstance_validatorPass() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_UPDATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(true).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  registry.updateViewInstance(updateInstance);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,validator,result);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW","1.0.0");
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  registry.unregisterListener(listener,"MY_VIEW","1.0.0");
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Assert.assertTrue(viewInstanceEntity.isVisible());
  updateInstance.setLabel("new label");
  updateInstance.setDescription("new description");
  updateInstance.setVisible(false);
  registry.updateViewInstance(updateInstance);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals("new label",instanceEntity.getLabel());
  Assert.assertEquals("new description",instanceEntity.getDescription());
  Assert.assertFalse(instanceEntity.isVisible());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExtractViewArchive() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  InputStream is=createMock(InputStream.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ViewExtractor viewExtractor=createMock(ViewExtractor.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",viewArchive);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",viewArchive);
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views");
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views");
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  Capture<ViewEntity> viewEntityCapture=new Capture<ViewEntity>();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work")).andReturn(true);
  }
 else {
    expect(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work")).andReturn(true);
  }
  expect(viewExtractor.extractViewArchive(capture(viewEntityCapture),eq(viewArchive),eq(archiveDir))).andReturn(null);
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  TestViewModule module=new TestViewModule(viewExtractor,archiveUtility,configuration);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(ViewRegistry.extractViewArchive("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",module,true));
  }
 else {
    Assert.assertTrue(ViewRegistry.extractViewArchive("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",module,true));
  }
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInstallViewInstance_validatorPass() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  handlerList.addViewInstance(viewInstanceEntity);
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(true).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetViewInstanceProperties() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  Map<String,String> instanceProperties=new HashMap<String,String>();
  instanceProperties.put("p1","newV1");
  instanceProperties.put("p2","newV2");
  registry.setViewInstanceProperties(viewInstanceEntity,instanceProperties,viewEntity.getConfiguration(),viewEntity.getClassLoader());
  Assert.assertEquals("newV1",viewInstanceEntity.getProperty("p1").getValue());
  Assert.assertEquals("bmV3VjI=",viewInstanceEntity.getProperty("p2").getValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInstallViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  handlerList.addViewInstance(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,resourceTypeDAO,securityHelper,handlerList);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  Assert.assertEquals("MY_VIEW{1.0.0}",viewInstanceEntity.getResource().getResourceType().getName());
  verify(viewDAO,viewInstanceDAO,resourceTypeDAO,securityHelper,handlerList);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewSubResourceProviderTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetResources_temporal() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  Map<Resource.Type,ViewSubResourceDefinition> resourceDefinitions=viewEntity.getResourceDefinitions();
  Assert.assertEquals(1,resourceDefinitions.size());
  Resource.Type type=resourceDefinitions.keySet().iterator().next();
  ViewSubResourceProvider viewSubResourceProvider=new ViewSubResourceProvider(type,MyResource.class,"id",viewEntity);
  Set<String> requestProperties=new HashSet<String>();
  requestProperties.add("metrics/myMetric");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  TemporalInfo temporalInfo=new TemporalInfoImpl(1000L,1100L,10L);
  temporalInfoMap.put("metrics/myMetric",temporalInfo);
  Request request=PropertyHelper.getReadRequest(requestProperties,temporalInfoMap);
  Predicate predicate=new AlwaysPredicate();
  Set<Resource> resources=viewSubResourceProvider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  Map<Resource.Type,ViewSubResourceDefinition> resourceDefinitions=viewEntity.getResourceDefinitions();
  Assert.assertEquals(1,resourceDefinitions.size());
  Resource.Type type=resourceDefinitions.keySet().iterator().next();
  ViewSubResourceProvider viewSubResourceProvider=new ViewSubResourceProvider(type,MyResource.class,"id",viewEntity);
  Request request=PropertyHelper.getReadRequest("id","properties","metrics/myMetric");
  Predicate predicate=new AlwaysPredicate();
  Set<Resource> resources=viewSubResourceProvider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property("metrics/myMetric").greaterThan(1).toPredicate();
  resources=viewSubResourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertTrue(((Integer)resources.iterator().next().getPropertyValue("metrics/myMetric")) > 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.AutoInstanceConfigTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServices() throws Exception {
  AutoInstanceConfig config=getAutoInstanceConfigs(VIEW_XML);
  List<String> serviceNames=config.getServices();
  assertEquals(2,serviceNames.size());
  assertTrue(serviceNames.contains("HIVE"));
  assertTrue(serviceNames.contains("HDFS"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetName() throws Exception {
  AutoInstanceConfig config=getAutoInstanceConfigs(VIEW_XML);
  Assert.assertEquals("INSTANCE1",config.getName());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescription() throws Exception {
  AutoInstanceConfig config=getAutoInstanceConfigs(VIEW_XML);
  assertEquals("This is a description.",config.getDescription());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStackId() throws Exception {
  AutoInstanceConfig config=getAutoInstanceConfigs(VIEW_XML);
  assertEquals("HDP-2.0",config.getStackId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.InstanceConfigTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs();
  Assert.assertEquals(2,instances.size());
  List<PropertyConfig> properties=instances.get(0).getProperties();
  Assert.assertEquals(2,properties.size());
  properties=instances.get(1).getProperties();
  Assert.assertEquals(1,properties.size());
  instances=getInstanceConfigs(xml_no_properties);
  Assert.assertEquals(1,instances.size());
  properties=instances.get(0).getProperties();
  Assert.assertNotNull(properties);
  Assert.assertEquals(0,properties.size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsVisible() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs(xml_visible);
  Assert.assertEquals(3,instances.size());
  Assert.assertTrue(instances.get(0).isVisible());
  Assert.assertFalse(instances.get(1).isVisible());
  Assert.assertTrue(instances.get(2).isVisible());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.PersistenceConfigTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntities() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig(xml);
  PersistenceConfig persistenceConfig=config.getPersistence();
  Assert.assertEquals(2,persistenceConfig.getEntities().size());
  config=ViewConfigTest.getConfig(xml_no_entities);
  persistenceConfig=config.getPersistence();
  Assert.assertTrue(persistenceConfig.getEntities().isEmpty());
  config=ViewConfigTest.getConfig(xml_no_persistence);
  persistenceConfig=config.getPersistence();
  Assert.assertTrue(persistenceConfig.getEntities().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.ViewConfigTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIsSystem() throws Exception {
  ViewConfig config=getConfig(system_xml);
  Assert.assertTrue(config.isSystem());
  config=getConfig(non_system_xml);
  Assert.assertFalse(config.isSystem());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMinAmbariVersion() throws Exception {
  ViewConfig config=getConfig();
  Assert.assertNull(config.getMinAmbariVersion());
  config=getConfig(with_ambari_versions);
  Assert.assertEquals("1.6.1",config.getMinAmbariVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMaxAmbariVersion() throws Exception {
  ViewConfig config=getConfig();
  Assert.assertNull(config.getMaxAmbariVersion());
  config=getConfig(with_ambari_versions);
  Assert.assertEquals("2.0.0",config.getMaxAmbariVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  ViewConfig config=getConfig();
  List<ResourceConfig> resources=config.getResources();
  Assert.assertEquals(2,resources.size());
  Assert.assertEquals("resource",resources.get(0).getName());
  Assert.assertEquals("subresource",resources.get(1).getName());
  config=getConfig(minimal_xml);
  resources=config.getResources();
  Assert.assertNotNull(resources);
  Assert.assertEquals(0,resources.size());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExtraClasspath() throws Exception {
  ViewConfig config=getConfig(system_xml);
  Assert.assertNull(config.getExtraClasspath());
  config=getConfig(EXTRA_CLASSPATH_XML);
  Assert.assertEquals("/var/lib/,/tmp/foo.jar",config.getExtraClasspath());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstances() throws Exception {
  ViewConfig config=getConfig(xml);
  List<InstanceConfig> instances=config.getInstances();
  Assert.assertEquals(2,instances.size());
  Assert.assertEquals("INSTANCE1",instances.get(0).getName());
  Assert.assertEquals("INSTANCE2",instances.get(1).getName());
  config=getConfig(minimal_xml);
  instances=config.getInstances();
  Assert.assertNotNull(instances);
  Assert.assertEquals(0,instances.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetParameters() throws Exception {
  ViewConfig config=getConfig();
  List<ParameterConfig> parameters=config.getParameters();
  Assert.assertEquals(2,parameters.size());
  Assert.assertEquals("p1",parameters.get(0).getName());
  Assert.assertEquals("p2",parameters.get(1).getName());
  config=getConfig(minimal_xml);
  parameters=config.getParameters();
  Assert.assertNotNull(parameters);
  Assert.assertEquals(0,parameters.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAutoInstance() throws Exception {
  ViewConfig config=getConfig(xml);
  AutoInstanceConfig instance=config.getAutoInstance();
  Assert.assertEquals("AUTO-INSTANCE",instance.getName());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetView() throws Exception {
  ViewConfig config=getConfig(view_class_xml);
  Assert.assertEquals("ViewImpl",config.getView());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.events.EventImplTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetViewSubject() throws Exception {
  EventImpl event=getEvent("MyEvent",Collections.<String,String>emptyMap(),view_xml);
  Assert.assertEquals("MY_VIEW",event.getViewSubject().getViewName());
  Assert.assertEquals("My View!",event.getViewSubject().getLabel());
  Assert.assertEquals("1.0.0",event.getViewSubject().getVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetViewInstanceSubject() throws Exception {
  EventImpl event=getEvent("MyEvent",Collections.<String,String>emptyMap(),view_xml);
  Assert.assertNull(event.getViewInstanceSubject());
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  event=getEvent("MyEvent",Collections.<String,String>emptyMap(),viewInstanceEntity);
  Assert.assertEquals(viewInstanceEntity,event.getViewInstanceSubject());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetId() throws Exception {
  EventImpl event=getEvent("MyEvent",Collections.<String,String>emptyMap(),view_xml);
  Assert.assertEquals("MyEvent",event.getId());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetProperties() throws Exception {
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("p1","v1");
  properties.put("p2","v2");
  EventImpl event=getEvent("MyEvent",properties,view_xml);
  Assert.assertEquals(properties,event.getProperties());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.persistence.DataStoreImplTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFindAll_multiple() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  DynamicEntity dynamicEntity1=createMock(DynamicEntity.class);
  DynamicEntity dynamicEntity2=createMock(DynamicEntity.class);
  DynamicEntity dynamicEntity3=createMock(DynamicEntity.class);
  Query query=createMock(Query.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  expect(entityManager.createQuery("SELECT e FROM DS_DataStoreImplTest$TestEntity_1 e WHERE e.DS_name='foo'")).andReturn(query);
  entityManager.close();
  List<DynamicEntity> entityList=new LinkedList<DynamicEntity>();
  entityList.add(dynamicEntity1);
  entityList.add(dynamicEntity2);
  entityList.add(dynamicEntity3);
  expect(query.getResultList()).andReturn(entityList);
  expect(dynamicEntity1.get("DS_id")).andReturn(99);
  expect(dynamicEntity1.get("DS_name")).andReturn("foo");
  TestSubEntity subEntity1=new TestSubEntity("bar");
  expect(dynamicEntity1.get("DS_subEntity")).andReturn(subEntity1);
  expect(dynamicEntity2.get("DS_id")).andReturn(100);
  expect(dynamicEntity2.get("DS_name")).andReturn("foo");
  TestSubEntity subEntity2=new TestSubEntity("bar");
  expect(dynamicEntity2.get("DS_subEntity")).andReturn(subEntity2);
  expect(dynamicEntity3.get("DS_id")).andReturn(101);
  expect(dynamicEntity3.get("DS_name")).andReturn("foo");
  TestSubEntity subEntity3=new TestSubEntity("bar");
  expect(dynamicEntity3.get("DS_subEntity")).andReturn(subEntity3);
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity1,dynamicEntity2,dynamicEntity3,query,schemaManager);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  Collection<TestEntity> entities=dataStore.findAll(TestEntity.class,"name='foo'");
  Assert.assertEquals(3,entities.size());
  for (  TestEntity entity : entities) {
    Assert.assertEquals("foo",entity.getName());
  }
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity1,dynamicEntity2,dynamicEntity3,query,schemaManager);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFind() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  DynamicEntity dynamicEntity=createMock(DynamicEntity.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  Capture<Class> entityClassCapture=new Capture<Class>();
  expect(entityManager.find(capture(entityClassCapture),eq(99))).andReturn(dynamicEntity);
  entityManager.close();
  expect(dynamicEntity.get("DS_id")).andReturn(99);
  expect(dynamicEntity.get("DS_name")).andReturn("foo");
  TestSubEntity subEntity=new TestSubEntity("bar");
  expect(dynamicEntity.get("DS_subEntity")).andReturn(subEntity);
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity,schemaManager);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  TestEntity entity=dataStore.find(TestEntity.class,99);
  Assert.assertEquals(entityClassCapture.getValue(),typeCapture2.getValue().getJavaClass());
  Assert.assertEquals(99,entity.getId());
  Assert.assertEquals("foo",entity.getName());
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity,schemaManager);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFindAll() throws Exception {
  DynamicClassLoader classLoader=new DynamicClassLoader(DataStoreImplTest.class.getClassLoader());
  EntityManagerFactory entityManagerFactory=createMock(EntityManagerFactory.class);
  EntityManager entityManager=createMock(EntityManager.class);
  JPADynamicHelper jpaDynamicHelper=createNiceMock(JPADynamicHelper.class);
  SchemaManager schemaManager=createNiceMock(SchemaManager.class);
  DynamicEntity dynamicEntity=createMock(DynamicEntity.class);
  Query query=createMock(Query.class);
  Capture<DynamicType> typeCapture=new Capture<DynamicType>();
  Capture<DynamicType> typeCapture2=new Capture<DynamicType>();
  jpaDynamicHelper.addTypes(eq(true),eq(true),capture(typeCapture),capture(typeCapture2));
  expect(entityManagerFactory.createEntityManager()).andReturn(entityManager);
  expect(entityManager.createQuery("SELECT e FROM DS_DataStoreImplTest$TestEntity_1 e WHERE e.DS_id=99")).andReturn(query);
  entityManager.close();
  expect(query.getResultList()).andReturn(Collections.singletonList(dynamicEntity));
  expect(dynamicEntity.get("DS_id")).andReturn(99);
  expect(dynamicEntity.get("DS_name")).andReturn("foo");
  TestSubEntity subEntity=new TestSubEntity("bar");
  expect(dynamicEntity.get("DS_subEntity")).andReturn(subEntity);
  replay(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity,query,schemaManager);
  DataStoreImpl dataStore=getDataStore(entityManagerFactory,jpaDynamicHelper,classLoader,schemaManager);
  Collection<TestEntity> entities=dataStore.findAll(TestEntity.class,"id=99");
  Assert.assertEquals(1,entities.size());
  TestEntity entity=entities.iterator().next();
  Assert.assertEquals(99,entity.getId());
  Assert.assertEquals("foo",entity.getName());
  verify(entityManagerFactory,entityManager,jpaDynamicHelper,dynamicEntity,query,schemaManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.shell.commands.ClusterCommandsTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAutoAssignForEmptyResult() throws InvalidHostGroupHostAssociation {
  Map<String,List<String>> hostGroups=singletonMap("group1",asList("host1"));
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",hostGroups);
  when(context.getFocusValue()).thenReturn("blueprint");
  when(client.recommendAssignments("blueprint")).thenReturn(new HashMap<String,List<String>>());
  clusterCommands.autoAssign();
  Map<String,List<String>> result=(Map<String,List<String>>)ReflectionTestUtils.getField(clusterCommands,"hostGroups");
  assertEquals(hostGroups,result);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAutoAssign() throws InvalidHostGroupHostAssociation {
  Map<String,List<String>> hostGroups=singletonMap("group1",asList("host1"));
  Map<String,List<String>> newAssignments=singletonMap("group1",asList("host1"));
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",hostGroups);
  when(context.getFocusValue()).thenReturn("blueprint");
  when(client.recommendAssignments("blueprint")).thenReturn(newAssignments);
  clusterCommands.autoAssign();
  Map<String,List<String>> result=(Map<String,List<String>>)ReflectionTestUtils.getField(clusterCommands,"hostGroups");
  assertEquals(newAssignments,result);
  verify(context).setHint(Hints.CREATE_CLUSTER);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.filebrowser.FilebrowserTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUploadFile() throws Exception {
  Response response=uploadFile("/tmp/","testUpload",".tmp","Hello world");
  Assert.assertEquals(200,response.getStatus());
  Response listdir=fileBrowserService.fileOps().listdir("/tmp");
  JSONObject responseObject=(JSONObject)listdir.getEntity();
  JSONArray statuses=(JSONArray)responseObject.get("files");
  System.out.println(statuses.size());
  Response response2=fileBrowserService.download().browse("/tmp/testUpload.tmp",false,false,httpHeaders,uriInfo);
  Assert.assertEquals(200,response2.getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.filebrowser.PropertyValidatorTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValidatePropertyWithValidHdfsURI(){
  Map<String,String> propertyMap=new HashMap<String,String>();
  propertyMap.put(PropertyValidator.WEBHDFS_URL,"hdfs://host:1234/");
  ViewInstanceDefinition instanceDefinition=getInstanceDef(propertyMap);
  ValidationResult result=new PropertyValidator().validateProperty(PropertyValidator.WEBHDFS_URL,instanceDefinition,null);
  assertEquals(result,ValidationResult.SUCCESS);
  assertEquals(result.isValid(),true);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValidatePropertyWithValidWebhdfsURI(){
  Map<String,String> propertyMap=new HashMap<String,String>();
  propertyMap.put(PropertyValidator.WEBHDFS_URL,"webhdfs://host:1234/");
  ViewInstanceDefinition instanceDefinition=getInstanceDef(propertyMap);
  ValidationResult result=new PropertyValidator().validateProperty(PropertyValidator.WEBHDFS_URL,instanceDefinition,null);
  assertEquals(result,ValidationResult.SUCCESS);
  assertEquals(result.isValid(),true);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValidatePropertyWithLocalFileURI(){
  Map<String,String> propertyMap=new HashMap<String,String>();
  propertyMap.put(PropertyValidator.WEBHDFS_URL,"file:///");
  ViewInstanceDefinition instanceDefinition=getInstanceDef(propertyMap);
  ValidationResult result=new PropertyValidator().validateProperty(PropertyValidator.WEBHDFS_URL,instanceDefinition,null);
  assertEquals(result.getClass(),PropertyValidator.InvalidPropertyValidationResult.class);
  assertEquals(result.isValid(),false);
  assertEquals(result.getDetail(),"Must be valid URL");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.client.UtilsTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRemoveEmptyStrings() throws Exception {
  String[] arrayWithSomeEmptyStrings=new String[]{"",null,"string1",null,"","string2",""};
  String[] expectedStrings=Utils.removeEmptyStrings(arrayWithSomeEmptyStrings);
  assertEquals(2,expectedStrings.length);
  assertEquals("string1",expectedStrings[0]);
  assertEquals("string2",expectedStrings[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.files.FileServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFakeFile() throws IOException, InterruptedException {
  String content="Fake file content";
  String encodedContent=Base64.encodeBase64String(content.getBytes());
  String filepath="fakefile://" + encodedContent;
  Response response=fileService.getFilePage(filepath,0l);
  ServiceTestUtils.assertHTTPResponseOK(response);
  JSONObject obj=((JSONObject)response.getEntity());
  assertFileJsonResponseSanity(obj);
  FileResource fileResource=(FileResource)obj.get("file");
  Assert.assertEquals(content,fileResource.getFileContent());
  Assert.assertEquals(0,fileResource.getPage());
  Assert.assertFalse(fileResource.isHasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.jobs.ATSParserTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHiveJobsList() throws Exception {
  IATSParser jobLoader=new ATSParser(new ATSRequestsDelegateStub());
  List<HiveQueryId> jobs=jobLoader.getHiveQueryIdsList("hive");
  Assert.assertEquals(1,jobs.size());
  HiveQueryId job=jobs.get(0);
  Assert.assertEquals("hive_20150209144848_c3a5a07b-c3b6-4f57-a6d5-3dadecdd6fd0",job.entity);
  Assert.assertEquals(1423493324L,job.starttime);
  Assert.assertEquals("hive",job.user);
  Assert.assertEquals(1423493342L - 1423493324L,job.duration);
  Assert.assertEquals("select count(*) from z",job.query);
  Assert.assertEquals(1,job.dagNames.size());
  Assert.assertEquals("hive_20150209144848_c3a5a07b-c3b6-4f57-a6d5-3dadecdd6fd0:4",job.dagNames.get(0));
  Assert.assertEquals(2,job.stages.size());
  Assert.assertTrue(HiveQueryId.ATS_15_RESPONSE_VERSION > job.version);
  jobLoader=new ATSParser(new ATSV15RequestsDelegateStub());
  List<HiveQueryId> jobsv2=jobLoader.getHiveQueryIdsList("hive");
  Assert.assertEquals(1,jobsv2.size());
  HiveQueryId jobv2=jobsv2.get(0);
  Assert.assertTrue(HiveQueryId.ATS_15_RESPONSE_VERSION <= jobv2.version);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.jobs.AggregatorTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobWithHS2OutsideOfView() throws Exception {
  HiveQueryId hiveQueryId=getSampleHiveQueryId("ENTITY-NAME");
  ensureOperationIdSet(hiveQueryId);
  MockATSParser atsParser=getMockATSWithQueries(hiveQueryId);
  Aggregator aggregator=new Aggregator(getEmptyJobResourceManager(),getEmptyOperationHandleResourceManager(),atsParser);
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(1,aggregated.size());
  Job job=aggregated.get(0);
  Assert.assertEquals("ENTITY-NAME",job.getId());
  Assert.assertEquals(SOME_QUERY,job.getTitle());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobOnlyInView() throws Exception {
  MockJobResourceManager jobResourceManager=getJobResourceManagerWithJobs(getSampleViewJob("1"));
  StoredOperationHandle operationHandle=getSampleOperationHandle("5","1");
  MockOperationHandleResourceManager operationHandleResourceManager=getOperationHandleRMWithEntities(operationHandle);
  Aggregator aggregator=new Aggregator(jobResourceManager,operationHandleResourceManager,getEmptyATSParser());
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(1,aggregated.size());
  Job job=aggregated.get(0);
  Assert.assertEquals("1",job.getId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobBothATSAndViewV2() throws Exception {
  HiveQueryId hiveQueryId=getSampleHiveQueryIdV2("ENTITY-NAME");
  hiveQueryId.operationId=Aggregator.hexStringToUrlSafeBase64("1b2b");
  MockATSParser atsParser=getMockATSWithQueries(hiveQueryId);
  MockJobResourceManager jobResourceManager=getJobResourceManagerWithJobs(getSampleViewJob("1"));
  StoredOperationHandle operationHandle=getSampleOperationHandle("5","1");
  operationHandle.setGuid("1b2b");
  MockOperationHandleResourceManager operationHandleResourceManager=getOperationHandleRMWithEntities(operationHandle);
  Aggregator aggregator=new Aggregator(jobResourceManager,operationHandleResourceManager,atsParser);
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(1,aggregated.size());
  Job job=aggregated.get(0);
  Assert.assertEquals("1",job.getId());
  Assert.assertEquals("app_test_1",job.getApplicationId());
  Assert.assertEquals("ENTITY-NAME",job.getDagId());
  Assert.assertEquals("SUCCEEDED",job.getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobOutsideOfHS2() throws Exception {
  HiveQueryId hiveQueryId=getSampleHiveQueryId("ENTITY-NAME");
  ensureOperationIdUnset(hiveQueryId);
  MockATSParser atsParser=getMockATSWithQueries(hiveQueryId);
  Aggregator aggregator=new Aggregator(getEmptyJobResourceManager(),getEmptyOperationHandleResourceManager(),atsParser);
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(1,aggregated.size());
  Job job=aggregated.get(0);
  Assert.assertEquals("ENTITY-NAME",job.getId());
  Assert.assertEquals(SOME_QUERY,job.getTitle());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobComplex() throws Exception {
  HiveQueryId hiveQueryId1=getSampleHiveQueryId("ENTITY-NAME");
  hiveQueryId1.operationId=Aggregator.hexStringToUrlSafeBase64("1a1b");
  Job job1=getSampleViewJob("1");
  StoredOperationHandle operationHandle1=getSampleOperationHandle("5","1");
  operationHandle1.setGuid("1a1b");
  HiveQueryId hiveQueryId2=getSampleHiveQueryId("ENTITY-NAME2");
  hiveQueryId2.operationId=Aggregator.hexStringToUrlSafeBase64("2a2a");
  Job job3=getSampleViewJob("3");
  StoredOperationHandle operationHandle3=getSampleOperationHandle("6","3");
  operationHandle3.setGuid("3c3d");
  MockATSParser atsParser=getMockATSWithQueries(hiveQueryId1,hiveQueryId2);
  MockJobResourceManager jobResourceManager=getJobResourceManagerWithJobs(job1,job3);
  MockOperationHandleResourceManager operationHandleRM=getOperationHandleRMWithEntities(operationHandle1,operationHandle3);
  Aggregator aggregator=new Aggregator(jobResourceManager,operationHandleRM,atsParser);
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(3,aggregated.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadJobBothATSAndView() throws Exception {
  HiveQueryId hiveQueryId=getSampleHiveQueryId("ENTITY-NAME");
  hiveQueryId.operationId=Aggregator.hexStringToUrlSafeBase64("1b2b");
  MockATSParser atsParser=getMockATSWithQueries(hiveQueryId);
  MockJobResourceManager jobResourceManager=getJobResourceManagerWithJobs(getSampleViewJob("1"));
  StoredOperationHandle operationHandle=getSampleOperationHandle("5","1");
  operationHandle.setGuid("1b2b");
  MockOperationHandleResourceManager operationHandleResourceManager=getOperationHandleRMWithEntities(operationHandle);
  Aggregator aggregator=new Aggregator(jobResourceManager,operationHandleResourceManager,atsParser);
  List<Job> aggregated=aggregator.readAll("luke");
  Assert.assertEquals(1,aggregated.size());
  Job job=aggregated.get(0);
  Assert.assertEquals("1",job.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.jobs.LogParserTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseTezLog(){
  String log="INFO : Tez session hasn't been created yet. Opening session\n" + "INFO :\n" + "\n"+ "INFO : Status: Running (Executing on YARN cluster with App id application_1423156117563_0003)\n"+ "\n"+ "INFO : Map 1: -/- Reducer 2: 0/1\n"+ "INFO : Map 1: 0/1 Reducer 2: 0/1\n"+ "INFO : Map 1: 0/1 Reducer 2: 0/1\n"+ "INFO : Map 1: 0(+1)/1 Reducer 2: 0/1\n"+ "INFO : Map 1: 0(+1)/1 Reducer 2: 0/1\n"+ "INFO : Map 1: 1/1 Reducer 2: 0(+1)/1\n"+ "INFO : Map 1: 1/1 Reducer 2: 1/1 ";
  LogParser p=LogParser.parseLog(log);
  Assert.assertEquals(1,p.getAppsList().size());
  Assert.assertEquals("application_1423156117563_0003",(((LogParser.AppId)(p.getAppsList().toArray())[0]).getIdentifier()));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseMRLog(){
  String log="INFO : Number of reduce tasks determined at compile time: 1\n" + "INFO : In order to change the average load for a reducer (in bytes):\n" + "INFO : set hive.exec.reducers.bytes.per.reducer=<number>\n"+ "INFO : In order to limit the maximum number of reducers:\n"+ "INFO : set hive.exec.reducers.max=<number>\n"+ "INFO : In order to set a constant number of reducers:\n"+ "INFO : set mapreduce.job.reduces=<number>\n"+ "WARN : Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.\n"+ "INFO : number of splits:1\n"+ "INFO : Submitting tokens for job: job_1421248330903_0003\n"+ "INFO : The url to track the job: http://dataworker.hortonworks.com:8088/proxy/application_1421248330903_0003/\n"+ "INFO : Starting Job = job_1421248330903_0003, Tracking URL = http://dataworker.hortonworks.com:8088/proxy/application_1421248330903_0003/\n"+ "INFO : Kill Command = /usr/hdp/current/hadoop-client/bin/hadoop job -kill job_1421248330903_0003\n"+ "INFO : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1\n"+ "INFO : 2015-01-21 15:03:55,979 Stage-1 map = 0%, reduce = 0%\n"+ "INFO : 2015-01-21 15:04:07,503 Stage-1 map = 100%, reduce = 0%, Cumulative CPU 0.79 sec\n"+ "INFO : 2015-01-21 15:04:17,384 Stage-1 map = 100%, reduce = 100%, Cumulative CPU 1.86 sec\n"+ "INFO : MapReduce Total cumulative CPU time: 1 seconds 860 msec\n"+ "INFO : Ended Job = job_1421248330903_0003";
  LogParser p=LogParser.parseLog(log);
  Assert.assertEquals(1,p.getAppsList().size());
  Assert.assertEquals("application_1421248330903_0003",(((LogParser.AppId)(p.getAppsList().toArray())[0]).getIdentifier()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.resources.FileResourceServiceTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void deleteFileResourceItem(){
  Response createdFileResourceItem=doCreateFileResourceItem();
  Object createdUdfId=((FileResourceItem)((JSONObject)createdFileResourceItem.getEntity()).get("fileResource")).getId();
  Response response=resourceService.delete(String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  thrown.expect(NotFoundFormattedException.class);
  resourceService.getOne(String.valueOf(createdUdfId));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateFileResourceItem(){
  Response createdFileResourceItem=doCreateFileResourceItem();
  Object createdUdfId=((FileResourceItem)((JSONObject)createdFileResourceItem.getEntity()).get("fileResource")).getId();
  FileResourceService.ResourceRequest request=new FileResourceService.ResourceRequest();
  request.fileResource=new FileResourceItem();
  request.fileResource.setPath("/tmp/updatedFileResourceItem.jar");
  request.fileResource.setName("TestFileResourceItem2");
  Response response=resourceService.update(request,String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=resourceService.getOne(String.valueOf(createdUdfId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("fileResource"));
  Assert.assertEquals(((FileResourceItem)obj.get("fileResource")).getName(),request.fileResource.getName());
  Assert.assertEquals(((FileResourceItem)obj.get("fileResource")).getPath(),request.fileResource.getPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.savedQueries.SavedQueryResourceManagerTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMakeShortQuery() throws Exception {
  String query="select * from table;";
  String shortQuery=SavedQueryResourceManager.makeShortQuery(query);
  Assert.assertEquals(query,shortQuery);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMakeShortQuery42Trim() throws Exception {
  String str50="12345678901234567890123456789012345678901234567890";
  String str42="123456789012345678901234567890123456789012";
  String shortQuery=SavedQueryResourceManager.makeShortQuery(str50);
  Assert.assertEquals(str42,shortQuery);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMakeShortQueryRemoveSet() throws Exception {
  String str50="set hive.execution.engine=tez;\nselect * from table;";
  String shortQuery=SavedQueryResourceManager.makeShortQuery(str50);
  Assert.assertEquals("select * from table;",shortQuery);
  str50="set hive.execution.engine = tez;  \n select * from table;";
  shortQuery=SavedQueryResourceManager.makeShortQuery(str50);
  Assert.assertEquals("select * from table;",shortQuery);
  str50="SET  property=value;\nselect * from table;";
  shortQuery=SavedQueryResourceManager.makeShortQuery(str50);
  Assert.assertEquals("select * from table;",shortQuery);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.savedQueries.SavedQueryServiceTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void delete(){
  Response created=doCreateSavedQuery();
  Object createdId=((SavedQuery)((JSONObject)created.getEntity()).get("savedQuery")).getId();
  Response response=savedQueryService.delete(String.valueOf(createdId));
  Assert.assertEquals(204,response.getStatus());
  thrown.expect(NotFoundFormattedException.class);
  savedQueryService.getOne(String.valueOf(createdId));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void update(){
  Response created=doCreateSavedQuery();
  Object createdId=((SavedQuery)((JSONObject)created.getEntity()).get("savedQuery")).getId();
  SavedQueryService.SavedQueryRequest request=new SavedQueryService.SavedQueryRequest();
  request.savedQuery=new SavedQuery();
  request.savedQuery.setTitle("Updated Query");
  Response response=savedQueryService.update(request,String.valueOf(createdId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=savedQueryService.getOne(String.valueOf(createdId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertEquals(((SavedQuery)obj.get("savedQuery")).getTitle(),request.savedQuery.getTitle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.udfs.UDFServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateUDF(){
  Response createdUDF=doCreateUDF();
  Object createdUdfId=((UDF)((JSONObject)createdUDF.getEntity()).get("udf")).getId();
  UDFService.UDFRequest request=new UDFService.UDFRequest();
  request.udf=new UDF();
  request.udf.setClassname("/tmp/updatedUDF.jar");
  request.udf.setName("TestUDF2");
  Response response=udfService.update(request,String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=udfService.getOne(String.valueOf(createdUdfId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertEquals(((UDF)obj.get("udf")).getName(),request.udf.getName());
  Assert.assertEquals(((UDF)obj.get("udf")).getClassname(),request.udf.getClassname());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void deleteUDF(){
  Response createdUDF=doCreateUDF();
  Object createdUdfId=((UDF)((JSONObject)createdUDF.getEntity()).get("udf")).getId();
  Response response=udfService.delete(String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  thrown.expect(NotFoundFormattedException.class);
  udfService.getOne(String.valueOf(createdUdfId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.FileTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateFile() throws IOException, InterruptedException {
  String name=UUID.randomUUID().toString().replaceAll("-","");
  Response response=doCreateFile(name,"12323");
  Assert.assertEquals(204,response.getStatus());
  String name2=UUID.randomUUID().toString().replaceAll("-","");
  Response response2=doCreateFile(name2,"12323");
  Assert.assertEquals(204,response2.getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.IntegrationalTest </h4><pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testStorageDependsOnInstance() throws Exception {
  StorageUtil.dropAllConnections();
  ViewContext context1=createNiceMock(ViewContext.class);
  ViewContext context2=createNiceMock(ViewContext.class);
  ViewContext context3=createNiceMock(ViewContext.class);
  expect(context1.getProperties()).andReturn(properties).anyTimes();
  expect(context1.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context1.getInstanceName()).andReturn("Pig1").anyTimes();
  expect(context2.getProperties()).andReturn(properties).anyTimes();
  expect(context2.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context2.getInstanceName()).andReturn("Pig2").anyTimes();
  expect(context3.getProperties()).andReturn(properties).anyTimes();
  expect(context3.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context3.getInstanceName()).andReturn("Pig1").anyTimes();
  replay(context1,context2,context3);
  Storage storage1=StorageUtil.getInstance(context1).getStorage();
  Storage storage2=StorageUtil.getInstance(context2).getStorage();
  Assert.assertNotSame(storage1,storage2);
  Storage storage1_2=StorageUtil.getInstance(context1).getStorage();
  Storage storage2_2=StorageUtil.getInstance(context1).getStorage();
  Assert.assertSame(storage1_2,storage2_2);
  Storage storage1_3=StorageUtil.getInstance(context1).getStorage();
  Storage storage3_3=StorageUtil.getInstance(context3).getStorage();
  Assert.assertSame(storage1_3,storage3_3);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testHdfsApiDependsOnInstance() throws Exception {
  UserLocal.dropAllConnections(HdfsApi.class);
  ViewContext context1=createNiceMock(ViewContext.class);
  ViewContext context2=createNiceMock(ViewContext.class);
  ViewContext context3=createNiceMock(ViewContext.class);
  expect(context1.getProperties()).andReturn(properties).anyTimes();
  expect(context1.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context1.getInstanceName()).andReturn("Pig1").anyTimes();
  expect(context2.getProperties()).andReturn(properties).anyTimes();
  expect(context2.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context2.getInstanceName()).andReturn("Pig2").anyTimes();
  expect(context3.getProperties()).andReturn(properties).anyTimes();
  expect(context3.getUsername()).andReturn("ambari-qa").anyTimes();
  expect(context3.getInstanceName()).andReturn("Pig1").anyTimes();
  replay(context1,context2,context3);
  HdfsApi hdfsApi1=UserLocalObjects.getHdfsApi(context1);
  HdfsApi hdfsApi2=UserLocalObjects.getHdfsApi(context2);
  Assert.assertNotSame(hdfsApi1,hdfsApi2);
  HdfsApi hdfsApi1_2=UserLocalObjects.getHdfsApi(context1);
  HdfsApi hdfsApi2_2=UserLocalObjects.getHdfsApi(context1);
  Assert.assertSame(hdfsApi1_2,hdfsApi2_2);
  HdfsApi hdfsApi1_3=UserLocalObjects.getHdfsApi(context1);
  HdfsApi hdfsApi3_3=UserLocalObjects.getHdfsApi(context3);
  Assert.assertSame(hdfsApi1_3,hdfsApi3_3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.JobTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKillJobWithRemove() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createStrictMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  data.id="job_id_##";
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals(201,response.getStatus());
  reset(api);
  api.killJob(eq("job_id_##"));
  expect(api.checkJob(anyString())).andReturn(api.new JobInfo()).anyTimes();
  replay(api);
  JSONObject obj=(JSONObject)response.getEntity();
  PigJob job=((PigJob)obj.get("job"));
  response=jobService.killJob(job.getId(),"true");
  Assert.assertEquals(204,response.getStatus());
  thrown.expect(NotFoundFormattedException.class);
  jobService.getJob(job.getId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobStatusFlow() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  data.id="job_id_#";
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  PigJob job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  reset(api);
  TempletonApi.JobInfo info=api.new JobInfo();
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_RUNNING);
  info.percentComplete="30% complete";
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  Assert.assertEquals(30,(Object)job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_SUCCEEDED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_COMPLETED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  Assert.assertNull(job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_PREP);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_FAILED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_FAILED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_KILLED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_KILLED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKillJobNoRemove() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createStrictMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  data.id="job_id_##";
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals(201,response.getStatus());
  reset(api);
  api.killJob(eq("job_id_##"));
  expect(api.checkJob(anyString())).andReturn(api.new JobInfo()).anyTimes();
  replay(api);
  JSONObject obj=(JSONObject)response.getEntity();
  PigJob job=((PigJob)obj.get("job"));
  response=jobService.killJob(job.getId(),null);
  Assert.assertEquals(204,response.getStatus());
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJobNoArguments() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),(String)isNull())).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig",null,jobService);
  Assert.assertEquals("",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSubmitJobUsernameProvided() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  properties.put("dataworker.username","luke");
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListJobs() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream).anyTimes();
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),(String)isNull())).andReturn(data).anyTimes();
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig",null,null,"x42",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=doCreateJob("Test","/tmp/script.pig",null,null,"x42",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=doCreateJob("Test","/tmp/script.pig",null,null,"100",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=jobService.getJobList("x42");
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("jobs"));
  Assert.assertEquals(2,((List)obj.get("jobs")).size());
  response=jobService.getJobList(null);
  Assert.assertEquals(200,response.getStatus());
  obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("jobs"));
  Assert.assertTrue(((List)obj.get("jobs")).size() > 2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJob() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSubmitJobForcedContent() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  ByteArrayOutputStream baScriptStream=new ByteArrayOutputStream();
  ByteArrayOutputStream baTempletonArgsStream=new ByteArrayOutputStream();
  FSDataOutputStream scriptStream=new FSDataOutputStream(baScriptStream);
  FSDataOutputStream templetonArgsStream=new FSDataOutputStream(baTempletonArgsStream);
  expect(hdfsApi.create(endsWith("script.pig"),eq(true))).andReturn(scriptStream);
  expect(hdfsApi.create(endsWith("params"),eq(true))).andReturn(templetonArgsStream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test",null,"-useHCatalog","pwd",null,jobService);
  Assert.assertEquals(201,response.getStatus());
  Assert.assertEquals("-useHCatalog",baTempletonArgsStream.toString());
  Assert.assertEquals("pwd",baScriptStream.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.utils.ambari.ServicesTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldReturnUrlIfSingleIsConfiguredInCustomConfig(){
  Map<String,String> map=new HashMap<>();
  map.put("yarn.resourcemanager.url",HTTP_RM_URL1);
  ViewContext viewContext=getViewContext(map);
  AmbariApi ambariApi=createNiceMock(AmbariApi.class);
  expect(ambariApi.isClusterAssociated()).andReturn(false);
  replay(viewContext);
  Services services=new Services(ambariApi,viewContext);
  assertEquals(HTTP_RM_URL1,services.getRMUrl());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldReturnActiveRMUrlWhenConnectingToStandby() throws Exception {
  Map<String,String> map=new HashMap<>();
  map.put("yarn.resourcemanager.url",HTTP_RM_URL1 + ", " + HTTP_RM_URL2);
  ViewContext viewContext=getViewContext(map);
  AmbariApi ambariApi=createNiceMock(AmbariApi.class);
  URLStreamProvider urlStreamProvider=createNiceMock(URLStreamProvider.class);
  InputStream inputStream=IOUtils.toInputStream("{\"clusterInfo\": {\"haState\": \"STANDBY\"}}");
  expect(ambariApi.isClusterAssociated()).andReturn(false);
  expect(viewContext.getURLStreamProvider()).andReturn(urlStreamProvider).anyTimes();
  expect(urlStreamProvider.readFrom(eq(HTTP_RM_URL1 + RM_INFO_API_ENDPOINT),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andReturn(inputStream);
  InputStream inputStreamActive=IOUtils.toInputStream("{\"clusterInfo\": {\"haState\": \"ACTIVE\"}}");
  expect(urlStreamProvider.readFrom(eq(HTTP_RM_URL2 + RM_INFO_API_ENDPOINT),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andReturn(inputStreamActive);
  replayAll();
  Services services=new Services(ambariApi,viewContext);
  assertEquals(HTTP_RM_URL2,services.getRMUrl());
  verify(urlStreamProvider);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldConnectToFirstUrlWhenMultipleRMUrlIsConfiguredInCustomConfig() throws IOException {
  Map<String,String> map=new HashMap<>();
  map.put("yarn.resourcemanager.url",HTTP_RM_URL1 + ", " + HTTP_RM_URL2);
  ViewContext viewContext=getViewContext(map);
  AmbariApi ambariApi=createNiceMock(AmbariApi.class);
  URLStreamProvider urlStreamProvider=createNiceMock(URLStreamProvider.class);
  InputStream inputStream=IOUtils.toInputStream("{\"clusterInfo\": {\"haState\": \"ACTIVE\"}}");
  expect(ambariApi.isClusterAssociated()).andReturn(false);
  expect(viewContext.getURLStreamProvider()).andReturn(urlStreamProvider);
  expect(urlStreamProvider.readFrom(eq(HTTP_RM_URL1 + RM_INFO_API_ENDPOINT),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andReturn(inputStream);
  replayAll();
  Services services=new Services(ambariApi,viewContext);
  assertEquals(HTTP_RM_URL1,services.getRMUrl());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldConnectToSecondUrlWhenTheFirstURLTimesOut() throws Exception {
  Map<String,String> map=new HashMap<>();
  map.put("yarn.resourcemanager.url",HTTP_RM_URL1 + ", " + HTTP_RM_URL2);
  ViewContext viewContext=getViewContext(map);
  AmbariApi ambariApi=createNiceMock(AmbariApi.class);
  URLStreamProvider urlStreamProvider=createNiceMock(URLStreamProvider.class);
  InputStream inputStream=IOUtils.toInputStream("{\"clusterInfo\": {\"haState\": \"ACTIVE\"}}");
  expect(ambariApi.isClusterAssociated()).andReturn(false);
  expect(viewContext.getURLStreamProvider()).andReturn(urlStreamProvider).anyTimes();
  expect(urlStreamProvider.readFrom(eq(HTTP_RM_URL1 + RM_INFO_API_ENDPOINT),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andThrow(new IOException());
  expect(urlStreamProvider.readFrom(eq(HTTP_RM_URL2 + RM_INFO_API_ENDPOINT),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andReturn(inputStream);
  replayAll();
  Services services=new Services(ambariApi,viewContext);
  assertEquals(HTTP_RM_URL2,services.getRMUrl());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldReturnATSUrlConfiguredInCustomMode() throws Exception {
  Map<String,String> map=new HashMap<>();
  map.put("yarn.timeline-server.url",HTTP_RM_URL1);
  ViewContext viewContext=getViewContext(map);
  AmbariApi ambariApi=createNiceMock(AmbariApi.class);
  expect(ambariApi.isClusterAssociated()).andReturn(false);
  replay(viewContext);
  Services services=new Services(ambariApi,viewContext);
  assertEquals(HTTP_RM_URL1,services.getTimelineServerUrl());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.sink.timeline.HadoopTimelineMetricsSinkTest </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDuplicateTimeSeriesNotSaved() throws Exception {
  HadoopTimelineMetricsSink sink=createMockBuilder(HadoopTimelineMetricsSink.class).withConstructor().addMockedMethod("appendPrefix").addMockedMethod("emitMetrics").createNiceMock();
  SubsetConfiguration conf=createNiceMock(SubsetConfiguration.class);
  expect(conf.getString(eq("slave.host.name"))).andReturn("testhost").anyTimes();
  expect(conf.getParent()).andReturn(null).anyTimes();
  expect(conf.getPrefix()).andReturn("service").anyTimes();
  expect(conf.getString(eq(COLLECTOR_HOST_PROPERTY))).andReturn("localhost:63188").anyTimes();
  expect(conf.getString(eq("serviceName-prefix"),eq(""))).andReturn("").anyTimes();
  expect(conf.getInt(eq(MAX_METRIC_ROW_CACHE_SIZE),anyInt())).andReturn(10).anyTimes();
  expect(conf.getInt(eq(METRICS_SEND_INTERVAL),anyInt())).andReturn(10).anyTimes();
  conf.setListDelimiter(eq(','));
  expectLastCall().anyTimes();
  expect(conf.getKeys()).andReturn(new Iterator(){
    @Override public boolean hasNext(){
      return false;
    }
    @Override public Object next(){
      return null;
    }
    @Override public void remove(){
    }
  }
).once();
  AbstractMetric metric=createNiceMock(AbstractMetric.class);
  expect(metric.name()).andReturn("metricName").anyTimes();
  expect(metric.value()).andReturn(1.0).once();
  expect(metric.value()).andReturn(2.0).once();
  expect(metric.value()).andReturn(3.0).once();
  expect(metric.value()).andReturn(4.0).once();
  expect(metric.value()).andReturn(5.0).once();
  expect(metric.value()).andReturn(6.0).once();
  MetricsRecord record=createNiceMock(MetricsRecord.class);
  expect(record.name()).andReturn("testName").anyTimes();
  expect(record.context()).andReturn("testContext").anyTimes();
  sink.appendPrefix(eq(record),(StringBuilder)anyObject());
  expectLastCall().anyTimes().andStubAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      return null;
    }
  }
);
  final Long now=System.currentTimeMillis();
  expect(record.timestamp()).andReturn(now).times(2);
  expect(record.timestamp()).andReturn(now + 100l).times(2);
  expect(record.timestamp()).andReturn(now + 200l).once();
  expect(record.timestamp()).andReturn(now + 300l).once();
  expect(record.metrics()).andReturn(Arrays.asList(metric)).anyTimes();
  final List<TimelineMetrics> capturedMetrics=new ArrayList<TimelineMetrics>();
  sink.emitMetrics((TimelineMetrics)anyObject());
  expectLastCall().andStubAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      capturedMetrics.add((TimelineMetrics)EasyMock.getCurrentArguments()[0]);
      return null;
    }
  }
);
  replay(conf,sink,record,metric);
  sink.init(conf);
  sink.putMetrics(record);
  sink.putMetrics(record);
  sink.putMetrics(record);
  sink.putMetrics(record);
  sink.putMetrics(record);
  sink.putMetrics(record);
  verify(conf,sink,record,metric);
  Assert.assertEquals(2,capturedMetrics.size());
  Iterator<TimelineMetrics> metricsIterator=capturedMetrics.iterator();
  TimelineMetric timelineMetric1=metricsIterator.next().getMetrics().get(0);
  Assert.assertEquals(2,timelineMetric1.getMetricValues().size());
  Iterator<Long> timestamps=timelineMetric1.getMetricValues().keySet().iterator();
  Assert.assertEquals(now,timestamps.next());
  Assert.assertEquals(new Long(now + 100l),timestamps.next());
  Iterator<Double> values=timelineMetric1.getMetricValues().values().iterator();
  Assert.assertEquals(new Double(1.0),values.next());
  Assert.assertEquals(new Double(3.0),values.next());
  TimelineMetric timelineMetric2=metricsIterator.next().getMetrics().get(0);
  Assert.assertEquals(2,timelineMetric2.getMetricValues().size());
  timestamps=timelineMetric2.getMetricValues().keySet().iterator();
  Assert.assertEquals(new Long(now + 200l),timestamps.next());
  Assert.assertEquals(new Long(now + 300l),timestamps.next());
  values=timelineMetric2.getMetricValues().values().iterator();
  Assert.assertEquals(new Double(5.0),values.next());
  Assert.assertEquals(new Double(6.0),values.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryClientService </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttemptReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  GetApplicationAttemptReportRequest request=GetApplicationAttemptReportRequest.newInstance(appAttemptId);
  GetApplicationAttemptReportResponse response=historyServer.getClientService().getClientHandler().getApplicationAttemptReport(request);
  ApplicationAttemptReport attemptReport=response.getApplicationAttemptReport();
  Assert.assertNotNull(attemptReport);
  Assert.assertEquals("appattempt_0_0001_000001",attemptReport.getApplicationAttemptId().toString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplications() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationId appId1=ApplicationId.newInstance(0,2);
  writeApplicationStartData(appId1);
  writeApplicationFinishData(appId1);
  GetApplicationsRequest request=GetApplicationsRequest.newInstance();
  GetApplicationsResponse response=historyServer.getClientService().getClientHandler().getApplications(request);
  List<ApplicationReport> appReport=response.getApplicationList();
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.get(0).getApplicationId());
  Assert.assertEquals(appId1,appReport.get(1).getApplicationId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttempts() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ApplicationAttemptId appAttemptId1=ApplicationAttemptId.newInstance(appId,2);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  writeApplicationAttemptStartData(appAttemptId1);
  writeApplicationAttemptFinishData(appAttemptId1);
  GetApplicationAttemptsRequest request=GetApplicationAttemptsRequest.newInstance(appId);
  GetApplicationAttemptsResponse response=historyServer.getClientService().getClientHandler().getApplicationAttempts(request);
  List<ApplicationAttemptReport> attemptReports=response.getApplicationAttemptList();
  Assert.assertNotNull(attemptReports);
  Assert.assertEquals(appAttemptId,attemptReports.get(0).getApplicationAttemptId());
  Assert.assertEquals(appAttemptId1,attemptReports.get(1).getApplicationAttemptId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainers() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  ContainerId containerId1=ContainerId.newInstance(appAttemptId,2);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeContainerStartData(containerId1);
  writeContainerFinishData(containerId1);
  writeApplicationFinishData(appId);
  GetContainersRequest request=GetContainersRequest.newInstance(appAttemptId);
  GetContainersResponse response=historyServer.getClientService().getClientHandler().getContainers(request);
  List<ContainerReport> containers=response.getContainerList();
  Assert.assertNotNull(containers);
  Assert.assertEquals(containerId,containers.get(1).getContainerId());
  Assert.assertEquals(containerId1,containers.get(0).getContainerId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  GetApplicationReportRequest request=GetApplicationReportRequest.newInstance(appId);
  GetApplicationReportResponse response=historyServer.getClientService().getClientHandler().getApplicationReport(request);
  ApplicationReport appReport=response.getApplicationReport();
  Assert.assertNotNull(appReport);
  Assert.assertEquals("application_0_0001",appReport.getApplicationId().toString());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeApplicationFinishData(appId);
  GetContainerReportRequest request=GetContainerReportRequest.newInstance(containerId);
  GetContainerReportResponse response=historyServer.getClientService().getClientHandler().getContainerReport(request);
  ContainerReport container=response.getContainerReport();
  Assert.assertNotNull(container);
  Assert.assertEquals(containerId,container.getContainerId());
  Assert.assertEquals(expectedLogUrl,container.getLogUrl());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryManagerImpl </h4><pre class="type-4 type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  ApplicationReport appReport=applicationHistoryManagerImpl.getApplication(appId);
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.getApplicationId());
  Assert.assertEquals(appAttemptId,appReport.getCurrentApplicationAttemptId());
  Assert.assertEquals(appAttemptId.toString(),appReport.getHost());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestMemoryApplicationHistoryStore </h4><pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationAttemptHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numAppAttempts=5;
  writeApplicationStartData(appId);
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    writeApplicationAttemptStartData(appAttemptId);
    writeApplicationAttemptFinishData(appAttemptId);
  }
  Assert.assertEquals(numAppAttempts,store.getApplicationAttempts(appId).size());
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    ApplicationAttemptHistoryData data=store.getApplicationAttempt(appAttemptId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appAttemptId.toString(),data.getHost());
    Assert.assertEquals(appAttemptId.toString(),data.getDiagnosticsInfo());
  }
  writeApplicationFinishData(appId);
  appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numApps=5;
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    writeApplicationStartData(appId);
    writeApplicationFinishData(appId);
  }
  Assert.assertEquals(numApps,store.getAllApplications().size());
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    ApplicationHistoryData data=store.getApplication(appId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appId.toString(),data.getApplicationName());
    Assert.assertEquals(appId.toString(),data.getDiagnosticsInfo());
  }
  appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationStartData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteContainerHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  writeApplicationAttemptStartData(appAttemptId);
  int numContainers=5;
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  Assert.assertEquals(numContainers,store.getContainers(appAttemptId).size());
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    ContainerHistoryData data=store.getContainer(containerId);
    Assert.assertNotNull(data);
    Assert.assertEquals(Priority.newInstance(containerId.getId()),data.getPriority());
    Assert.assertEquals(containerId.toString(),data.getDiagnosticsInfo());
  }
  ContainerHistoryData masterContainer=store.getAMContainer(appAttemptId);
  Assert.assertNotNull(masterContainer);
  Assert.assertEquals(ContainerId.newInstance(appAttemptId,1),masterContainer.getContainerId());
  writeApplicationAttemptFinishData(appAttemptId);
  containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testMassiveWriteContainerHistory() throws IOException {
  long mb=1024 * 1024;
  Runtime runtime=Runtime.getRuntime();
  long usedMemoryBefore=(runtime.totalMemory() - runtime.freeMemory()) / mb;
  int numContainers=100000;
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  for (int i=1; i <= numContainers; ++i) {
    ContainerId containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  long usedMemoryAfter=(runtime.totalMemory() - runtime.freeMemory()) / mb;
  Assert.assertTrue((usedMemoryAfter - usedMemoryBefore) < 200);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.AbstractMiniHBaseClusterTest </h4><pre class="type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
/** 
 * A canary test. Will show if the infrastructure is set-up correctly.
 */
@Test public void testClusterOK() throws Exception {
  Connection conn=getConnection(getUrl());
  conn.setAutoCommit(true);
  String sampleDDL="CREATE TABLE TEST_METRICS " + "(TEST_COLUMN VARCHAR " + "CONSTRAINT pk PRIMARY KEY (TEST_COLUMN)) "+ "DATA_BLOCK_ENCODING='FAST_DIFF', IMMUTABLE_ROWS=true, "+ "TTL=86400, COMPRESSION='NONE' ";
  Statement stmt=conn.createStatement();
  stmt.executeUpdate(sampleDDL);
  conn.commit();
  ResultSet rs=stmt.executeQuery("SELECT COUNT(TEST_COLUMN) FROM TEST_METRICS");
  rs.next();
  long l=rs.getLong(1);
  assertThat(l).isGreaterThanOrEqualTo(0);
  stmt.execute("DROP TABLE TEST_METRICS");
  conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.HBaseTimelineMetricStoreTest </h4><pre class="type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testParseMetricNamesToAggregationFunctions() throws Exception {
  List<String> metricNames=Arrays.asList(MEM_METRIC + "._avg",MEM_METRIC + "._rate._avg",BYTES_IN_METRIC,BYTES_NOT_AFUNCTION_METRIC);
  HashMap<String,List<Function>> mfm=HBaseTimelineMetricStore.parseMetricNamesToAggregationFunctions(metricNames);
  assertThat(mfm).hasSize(3).containsKeys(MEM_METRIC,BYTES_IN_METRIC,BYTES_NOT_AFUNCTION_METRIC);
  assertThat(mfm.get(MEM_METRIC)).containsOnly(new Function(AVG,null),new Function(AVG,RATE));
  assertThat(mfm.get(BYTES_IN_METRIC)).contains(Function.DEFAULT_VALUE_FUNCTION);
  assertThat(mfm.get(BYTES_NOT_AFUNCTION_METRIC)).contains(Function.DEFAULT_VALUE_FUNCTION);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.ITPhoenixHBaseAccessor </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordLatestWithFunction() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,new Configuration(),new TimelineMetricMetadataManager(hdb,new Configuration()));
  long startTime=System.currentTimeMillis();
  long ctime=startTime + 1;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute + 1;
  boolean success=agg.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),null,null,null,null,null,Precision.SECONDS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,Collections.singletonMap("disk_free",Collections.singletonList(new Function(Function.ReadFunction.SUM,null))));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free._sum",metric.getMetricName());
  assertEquals(1,metric.getMetricValues().size());
  assertEquals(3,metric.getMetricValues().values().iterator().next().intValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordsSeconds() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,new Configuration(),new TimelineMetricMetadataManager(hdb,new Configuration()));
  long startTime=System.currentTimeMillis();
  long ctime=startTime + 1;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute + 1;
  boolean success=agg.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),null,null,null,startTime,endTime,Precision.SECONDS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,singletonValueFunctionMap("disk_free"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free",metric.getMetricName());
  assertEquals(5,metric.getMetricValues().size());
  assertEquals(1.5,metric.getMetricValues().values().iterator().next(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricRecordsHours() throws IOException, SQLException {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorHourly(hdb,new Configuration());
  MetricHostAggregate expectedAggregate=createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  long startTime=System.currentTimeMillis();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_MINUTE_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_used"),Collections.singletonList("test_host"),"test_app",null,startTime,endTime,Precision.HOURS,null,true);
  TimelineMetrics timelineMetrics=hdb.getMetricRecords(condition,singletonValueFunctionMap("disk_used"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_used",metric.getMetricName());
  assertEquals("test_host",metric.getHostName());
  assertEquals(1,metric.getMetricValues().size());
  Iterator<Map.Entry<Long,Double>> iterator=metric.getMetricValues().entrySet().iterator();
  assertEquals(0.75,iterator.next().getValue(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordsHours() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorHourly(hdb,new Configuration());
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  Map<TimelineClusterMetric,MetricClusterAggregate> records=new HashMap<TimelineClusterMetric,MetricClusterAggregate>();
  records.put(createEmptyTimelineClusterMetric(ctime),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  hdb.saveClusterAggregateRecords(records);
  boolean success=agg.doWork(startTime,ctime + minute);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_used"),null,null,null,startTime,ctime + minute,Precision.HOURS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,singletonValueFunctionMap("disk_used"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_used",metric.getMetricName());
  assertEquals("test_app",metric.getAppId());
  assertEquals(1,metric.getMetricValues().size());
  assertEquals(2.0,metric.getMetricValues().values().iterator().next(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricRecordsMinutes() throws IOException, SQLException {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,new Configuration());
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + minute,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  long endTime=ctime + minute;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),Collections.singletonList("local1"),null,null,startTime,endTime,Precision.MINUTES,null,false);
  TimelineMetrics timelineMetrics=hdb.getMetricRecords(condition,singletonValueFunctionMap("disk_free"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free",metric.getMetricName());
  assertEquals("local1",metric.getHostName());
  assertEquals(1,metric.getMetricValues().size());
  Iterator<Map.Entry<Long,Double>> iterator=metric.getMetricValues().entrySet().iterator();
  assertEquals(1.5,iterator.next().getValue(),0.00001);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITClusterAggregator </h4><pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterAggregateMetricNormalization() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  TimelineMetric metric1=new TimelineMetric();
  metric1.setMetricName("yarn.ClusterMetrics.NumActiveNMs");
  metric1.setAppId("resourcemanager");
  metric1.setHostName("h1");
  metric1.setStartTime(1431372311811l);
  metric1.setMetricValues(new TreeMap<Long,Double>(){
{
      put(1431372311811l,1.0);
      put(1431372321811l,1.0);
      put(1431372331811l,1.0);
      put(1431372341811l,1.0);
      put(1431372351811l,1.0);
      put(1431372361811l,1.0);
      put(1431372371810l,1.0);
    }
  }
);
  TimelineMetric metric2=new TimelineMetric();
  metric2.setMetricName("yarn.ClusterMetrics.NumActiveNMs");
  metric2.setAppId("resourcemanager");
  metric2.setHostName("h1");
  metric2.setStartTime(1431372381810l);
  metric2.setMetricValues(new TreeMap<Long,Double>(){
{
      put(1431372381810l,1.0);
      put(1431372391811l,1.0);
      put(1431372401811l,1.0);
      put(1431372411811l,1.0);
      put(1431372421811l,1.0);
      put(1431372431811l,1.0);
      put(1431372441810l,1.0);
    }
  }
);
  TimelineMetrics metrics=new TimelineMetrics();
  metrics.setMetrics(Collections.singletonList(metric1));
  insertMetricRecords(conn,metrics,1431372371810l);
  metrics.setMetrics(Collections.singletonList(metric2));
  insertMetricRecords(conn,metrics,1431372441810l);
  long startTime=1431372055000l;
  long endTime=1431372655000l;
  agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("yarn.ClusterMetrics.NumActiveNMs".equals(currentMetric.getMetricName())) {
      assertEquals(1,currentHostAggregate.getNumberOfHosts());
      assertEquals(1.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(1.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  Assert.assertEquals(5,recordCount);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppLevelHostMetricAggregates() throws Exception {
  Configuration conf=getConfigurationForTest(false);
  conf.set(CLUSTER_AGGREGATOR_APP_IDS,"app1");
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,conf,new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric((ctime),"local1","app1",null,"app_metric_random",1));
  ctime+=10;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","cpu_user",1));
  ctime+=10;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","cpu_user",2));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(Collections.singletonList("cpu_user"),null,"app1",null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  TimelineClusterMetric currentMetric=null;
  MetricClusterAggregate currentHostAggregate=null;
  while (rs.next()) {
    currentMetric=metricReader.fromResultSet(rs);
    currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    recordCount++;
  }
  assertEquals(3,recordCount);
  assertNotNull(currentMetric);
  assertEquals("cpu_user",currentMetric.getMetricName());
  assertEquals("app1",currentMetric.getAppId());
  assertNotNull(currentHostAggregate);
  assertEquals(1,currentHostAggregate.getNumberOfHosts());
  assertEquals(1.0d,currentHostAggregate.getSum());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateClusterIgnoringInstance() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000 * 2;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local1","i1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local2","i1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local1","i2","disk_free",3));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local2","i2","disk_free",4));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local1","i1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime - 100,"local2","i1","disk_free",3));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local1","i2","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + 100,"local2","i2","disk_free",4));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime - 1000,endTime + 1000);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      System.out.println("OUTPUT: " + currentMetric + " - "+ currentHostAggregate);
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(5.0,Math.floor(currentHostAggregate.getSum()));
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  Assert.assertEquals(5,recordCount);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateDifferentMetricsOnClusterProperly() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_used",1));
  ctime+=2 * minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_used",1));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(3.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else     if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(1,currentHostAggregate.getNumberOfHosts());
      assertEquals(1.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(1.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateClusterProperly() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,getConfigurationForTest(false),new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=2 * minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  while (rs.next()) {
    TimelineClusterMetric currentMetric=metricReader.fromResultSet(rs);
    MetricClusterAggregate currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2,currentHostAggregate.getNumberOfHosts());
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(1.0,currentHostAggregate.getMin());
      assertEquals(3.0,currentHostAggregate.getSum());
      recordCount++;
    }
 else {
      fail("Unexpected entry");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITMetricAggregator </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateHourProperly() throws Exception {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorHourly(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_MINUTE_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_HOURLY_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(12 * 20,currentHostAggregate.getNumberOfSamples());
      assertEquals(12 * 15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateMinuteProperly() throws Exception {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareTimelineMetrics(startTime,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  long endTime=startTime + 1000 * 60 * 4;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_MINUTE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  int count=0;
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else     if ("mem_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  assertEquals("Two aggregated entries expected",2,count);
}

</code></pre>

<br>
<pre class="type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testShouldInsertMetrics() throws Exception {
  long startTime=System.currentTimeMillis();
  TimelineMetrics metricsSent=prepareTimelineMetrics(startTime,"local");
  hdb.insertMetricRecords(metricsSent);
  Condition queryCondition=new DefaultCondition(null,Collections.singletonList("local"),null,null,startTime,startTime + (15 * 60 * 1000),null,null,false);
  TimelineMetrics recordRead=hdb.getMetricRecords(queryCondition,null);
  assertThat(recordRead.getMetrics()).hasSize(2).extracting("metricName").containsOnly("mem_free","disk_free");
  assertThat(metricsSent.getMetrics()).usingElementComparator(TIME_IGNORING_COMPARATOR).containsExactlyElementsOf(recordRead.getMetrics());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregationUsingGroupByQuery() throws Exception {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,getConfigurationForTest(true));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareTimelineMetrics(startTime,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  long endTime=startTime + 1000 * 60 * 4;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_MINUTE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  int count=0;
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else     if ("mem_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  assertEquals("Two aggregated entries expected",2,count);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricAggregateDaily() throws Exception {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorDaily(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_HOURLY_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_DAILY_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(12 * 20,currentHostAggregate.getNumberOfSamples());
      assertEquals(12 * 15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.timeline.TestLeveldbTimelineStore </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeleteEntitiesPrimaryFilters() throws IOException, InterruptedException {
  Map<String,Set> primaryFilter=Collections.singletonMap("user",Collections.singleton((Object)"otheruser"));
  TimelineEntities atsEntities=new TimelineEntities();
  atsEntities.setEntities(Collections.singletonList(createEntity(entityId1b,entityType1,789l,Collections.singletonList(ev2),null,primaryFilter,null)));
  TimelinePutResponse response=store.put(atsEntities);
  assertEquals(0,response.getErrors().size());
  NameValuePair pfPair=new NameValuePair("user","otheruser");
  List<TimelineEntity> entities=getEntitiesWithPrimaryFilter("type_1",pfPair);
  assertEquals(1,entities.size());
  verifyEntityInfo(entityId1b,entityType1,Collections.singletonList(ev2),EMPTY_REL_ENTITIES,primaryFilter,EMPTY_MAP,entities.get(0));
  entities=getEntitiesWithPrimaryFilter("type_1",userFilter);
  assertEquals(2,entities.size());
  verifyEntityInfo(entityId1,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(0));
  verifyEntityInfo(entityId1b,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(1));
  ((LeveldbTimelineStore)store).discardOldEntities(-123l);
  assertEquals(1,getEntitiesWithPrimaryFilter("type_1",pfPair).size());
  assertEquals(2,getEntitiesWithPrimaryFilter("type_1",userFilter).size());
  ((LeveldbTimelineStore)store).discardOldEntities(123l);
  assertEquals(0,getEntities("type_1").size());
  assertEquals(0,getEntities("type_2").size());
  assertEquals(0,((LeveldbTimelineStore)store).getEntityTypes().size());
  assertEquals(0,getEntitiesWithPrimaryFilter("type_1",pfPair).size());
  assertEquals(0,getEntitiesWithPrimaryFilter("type_1",userFilter).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.webapp.TestAHSWebApp </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAppControllerIndex() throws Exception {
  ApplicationHistoryManager ahManager=mock(ApplicationHistoryManager.class);
  Injector injector=WebAppTests.createMockInjector(ApplicationHistoryManager.class,ahManager);
  AHSController controller=injector.getInstance(AHSController.class);
  controller.index();
  Assert.assertEquals("Application History",controller.get(TITLE,"unknown"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.webapp.TestAHSWebServices </h4><pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleContainers() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("applicationhistory").path("apps").path(appId.toString()).path("appattempts").path(appAttemptId.toString()).path("containers").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  JSONObject json=response.getEntity(JSONObject.class);
  assertEquals("incorrect number of elements",1,json.length());
  JSONObject containers=json.getJSONObject("containers");
  assertEquals("incorrect number of elements",1,containers.length());
  JSONArray array=containers.getJSONArray("container");
  assertEquals("incorrect number of elements",5,array.length());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleContainer() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("applicationhistory").path("apps").path(appId.toString()).path("appattempts").path(appAttemptId.toString()).path("containers").path(containerId.toString()).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  JSONObject json=response.getEntity(JSONObject.class);
  assertEquals("incorrect number of elements",1,json.length());
  JSONObject container=json.getJSONObject("container");
  assertEquals(containerId.toString(),container.getString("containerId"));
  assertEquals(containerId.toString(),container.getString("diagnosticsInfo"));
  assertEquals("0",container.getString("allocatedMB"));
  assertEquals("0",container.getString("allocatedVCores"));
  assertEquals(NodeId.newInstance("localhost",0).toString(),container.getString("assignedNodeId"));
  assertEquals(Priority.newInstance(containerId.getId()).toString(),container.getString("priority"));
  Configuration conf=new YarnConfiguration();
  assertEquals(WebAppUtils.getHttpSchemePrefix(conf) + WebAppUtils.getAHSWebAppURLWithoutScheme(conf) + "/applicationhistory/logs/localhost:0/container_0_0001_01_000001/"+ "container_0_0001_01_000001/test user",container.getString("logUrl"));
  assertEquals(ContainerState.COMPLETE.toString(),container.getString("containerState"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleAttempt() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("applicationhistory").path("apps").path(appId.toString()).path("appattempts").path(appAttemptId.toString()).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  JSONObject json=response.getEntity(JSONObject.class);
  assertEquals("incorrect number of elements",1,json.length());
  JSONObject appAttempt=json.getJSONObject("appAttempt");
  assertEquals(appAttemptId.toString(),appAttempt.getString("appAttemptId"));
  assertEquals(appAttemptId.toString(),appAttempt.getString("host"));
  assertEquals(appAttemptId.toString(),appAttempt.getString("diagnosticsInfo"));
  assertEquals("test tracking url",appAttempt.getString("trackingUrl"));
  assertEquals(YarnApplicationAttemptState.FINISHED.toString(),appAttempt.get("appAttemptState"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.webapp.TestTimelineWebServices </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPostEntities() throws Exception {
  TimelineEntities entities=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  entity.setEntityId("test id");
  entity.setEntityType("test type");
  entity.setStartTime(System.currentTimeMillis());
  entities.addEntity(entity);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelinePutResponse putResposne=response.getEntity(TimelinePutResponse.class);
  Assert.assertNotNull(putResposne);
  Assert.assertEquals(0,putResposne.getErrors().size());
  response=r.path("ws").path("v1").path("timeline").path("test type").path("test id").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("test id",entity.getEntityId());
  Assert.assertEquals("test type",entity.getEntityType());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromTs() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").queryParam("fromTs",Long.toString(beforeTime)).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  assertEquals(0,response.getEntity(TimelineEntities.class).getEntities().size());
  response=r.path("ws").path("v1").path("timeline").path("type_1").queryParam("fromTs",Long.toString(System.currentTimeMillis())).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  assertEquals(2,response.getEntity(TimelineEntities.class).getEntities().size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
