<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.ambari.funtest.server.tests.DeleteServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Set up a test cluster with a service, a host and a few components.
 * Attempt to delete the service. Verify the state of the DB.
 * @throws Exception
 */
@Test public void testDeleteService() throws Exception {
  String clusterName="c1";
  String serviceName="HDFS";
  ConnectionParams params=new ConnectionParams();
  params.setServerName("localhost");
  params.setServerApiPort(serverPort);
  params.setServerAgentPort(serverAgentPort);
  params.setUserName("admin");
  params.setPassword("admin");
  ClusterUtils clusterUtils=injector.getInstance(ClusterUtils.class);
  clusterUtils.createSampleCluster(params);
  JsonElement jsonResponse=RestApiUtils.executeRequest(new GetServiceWebRequest(params,clusterName,serviceName));
  assertTrue(!jsonResponse.isJsonNull());
  JsonObject jsonServiceInfoObj=jsonResponse.getAsJsonObject().get("ServiceInfo").getAsJsonObject();
  String cluster_name=jsonServiceInfoObj.get("cluster_name").getAsString();
  assertEquals(cluster_name,clusterName);
  String service_name=jsonServiceInfoObj.get("service_name").getAsString();
  assertEquals(service_name,serviceName);
  jsonResponse=RestApiUtils.executeRequest(new StopServiceWebRequest(params,clusterName,serviceName));
  ClusterServiceDAO clusterServiceDAO=injector.getInstance(ClusterServiceDAO.class);
  List<ClusterServiceEntity> clusterServiceEntities=clusterServiceDAO.findAll();
  assertEquals(clusterServiceEntities.size(),1);
  assertEquals(clusterServiceEntities.get(0).getServiceName(),serviceName);
  ClusterServiceEntity clusterServiceEntity=clusterServiceEntities.get(0);
  long clusterId=clusterServiceEntity.getClusterId();
  ServiceDesiredStateDAO serviceDesiredStateDAO=injector.getInstance(ServiceDesiredStateDAO.class);
  List<ServiceDesiredStateEntity> serviceDesiredStateEntities=serviceDesiredStateDAO.findAll();
  assertEquals(serviceDesiredStateEntities.size(),1);
  ServiceDesiredStateEntity serviceDesiredStateEntity=serviceDesiredStateEntities.get(0);
  assertEquals(serviceDesiredStateEntity.getServiceName(),serviceName);
  assertEquals(serviceDesiredStateEntity.getDesiredState(),State.INSTALLED);
  ServiceComponentDesiredStateDAO serviceComponentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  List<ServiceComponentDesiredStateEntity> serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  assertEquals(serviceComponentDesiredStateEntities.size(),3);
  for (  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity : serviceComponentDesiredStateEntities) {
    assertEquals(serviceComponentDesiredStateEntity.getDesiredState(),State.INSTALLED);
  }
  HostComponentStateDAO hostComponentStateDAO=injector.getInstance(HostComponentStateDAO.class);
  List<HostComponentStateEntity> hostComponentStateEntities=hostComponentStateDAO.findAll();
  assertEquals(hostComponentStateEntities.size(),3);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  List<HostComponentDesiredStateEntity> hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  assertEquals(hostComponentDesiredStateEntities.size(),3);
  jsonResponse=RestApiUtils.executeRequest(new DeleteServiceWebRequest(params,clusterName,serviceName));
  WebResponse webResponse=new GetServiceWebRequest(params,clusterName,serviceName).getResponse();
  assertEquals(webResponse.getStatusCode(),HttpStatus.SC_NOT_FOUND);
  clusterServiceEntity=clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName);
  assertTrue(clusterServiceEntity == null);
  ServiceDesiredStateEntityPK serviceDesiredStateEntityPK=injector.getInstance(ServiceDesiredStateEntityPK.class);
  serviceDesiredStateEntityPK.setClusterId(clusterId);
  serviceDesiredStateEntityPK.setServiceName(serviceName);
  serviceDesiredStateEntity=serviceDesiredStateDAO.findByPK(serviceDesiredStateEntityPK);
  assertTrue(serviceDesiredStateEntity == null);
  ServiceComponentDesiredStateEntityPK serviceComponentDesiredStateEntityPK=injector.getInstance(ServiceComponentDesiredStateEntityPK.class);
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByPK(serviceComponentDesiredStateEntityPK);
  assertTrue(serviceComponentDesiredStateEntity == null);
  hostComponentStateEntities=hostComponentStateDAO.findByService(serviceName);
  assertEquals(hostComponentStateEntities.size(),0);
  hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  assertEquals(hostComponentDesiredStateEntities.size(),0);
  jsonResponse=RestApiUtils.executeRequest(new DeleteClusterWebRequest(params,clusterName));
  LOG.info(jsonResponse);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.funtest.server.tests.GetStacksTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Waits for the ambari server to startup and then checks it's
 * status by querying /api/v1/stacks (does not touch the DB)
 */
@Test public void testServerStatus() throws IOException {
  String stacksPath="/api/v1/stacks";
  String stacksUrl=String.format(SERVER_URL_FORMAT,serverPort) + stacksPath;
  HttpClient httpClient=new HttpClient();
  GetMethod getMethod=new GetMethod(stacksUrl);
  try {
    getMethod.addRequestHeader("Authorization",getBasicAdminAuthentication());
    getMethod.addRequestHeader("X-Requested-By","ambari");
    int statusCode=httpClient.executeMethod(getMethod);
    assertEquals(HttpStatus.SC_OK,statusCode);
    String responseBody=getMethod.getResponseBodyAsString();
    assertTrue(responseBody != null);
    JsonElement jsonElement=new JsonParser().parse(new JsonReader(new StringReader(responseBody)));
    assertTrue(jsonElement != null);
    JsonObject jsonObject=jsonElement.getAsJsonObject();
    assertTrue(jsonObject.has("items"));
    JsonArray stacksArray=jsonObject.get("items").getAsJsonArray();
    assertTrue(stacksArray.size() > 0);
  }
  finally {
    getMethod.releaseConnection();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.funtest.server.tests.RoleBasedAccessControlBasicTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Creates an anonymous user (user with no role). Attempts to get the list of clusters
 * @throws Exception
 */
@Test public void testGetClustersAsAnonUser() throws Exception {
  JsonElement jsonResponse;
  ConnectionParams adminConnectionParams=createAdminConnectionParams();
  String anonUserName="nothing";
  String anonUserPwd="nothing";
  ClusterUtils.createUser(adminConnectionParams,clusterName,anonUserName,anonUserPwd,AmbariUserRole.NONE);
  ConnectionParams anonUserParams=createConnectionParams(anonUserName,anonUserPwd);
  jsonResponse=RestApiUtils.executeRequest(new GetAllClustersWebRequest(anonUserParams));
  assertFalse(jsonResponse.isJsonNull());
  jsonResponse=RestApiUtils.executeRequest(new DeleteUserWebRequest(adminConnectionParams,anonUserName));
  LOG.info(jsonResponse);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ClusterDefinitionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetHosts() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  Set<String> hosts=clusterDefinition.getHosts();
  Assert.assertTrue(hosts.contains("NAMENODE_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("SECONDARY_NAMENODE_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("FLUME_SERVICE1.acme.com"));
  Assert.assertTrue(hosts.contains("FLUME_SERVICE2.acme.com"));
  Assert.assertTrue(hosts.contains("FLUME_SERVICE3.acme.com"));
  Assert.assertTrue(hosts.contains("HBASE_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("HIVE_SERVER_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("JOBTRACKER_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("OOZIE_SERVER_MASTER.acme.com"));
  Assert.assertTrue(hosts.contains("slave1.acme.com"));
  Assert.assertTrue(hosts.contains("slave2.acme.com"));
  Assert.assertTrue(hosts.contains("slave3.acme.com"));
  Assert.assertTrue(hosts.contains("WEBHCAT_MASTER.acme.com"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetComponents() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  Set<String> components=clusterDefinition.getComponents("HDFS");
  Assert.assertTrue(components.contains("NAMENODE"));
  Assert.assertTrue(components.contains("SECONDARY_NAMENODE"));
  Assert.assertTrue(components.contains("DATANODE"));
  components=clusterDefinition.getComponents("MAPREDUCE");
  Assert.assertTrue(components.contains("JOBTRACKER"));
  Assert.assertTrue(components.contains("TASKTRACKER"));
  components=clusterDefinition.getComponents("FLUME");
  Assert.assertTrue(components.contains("FLUME_SERVER"));
  components=clusterDefinition.getComponents("OOZIE");
  Assert.assertTrue(components.contains("OOZIE_SERVER"));
  components=clusterDefinition.getComponents("HBASE");
  Assert.assertTrue(components.contains("HBASE_MASTER"));
  Assert.assertTrue(components.contains("HBASE_REGIONSERVER"));
  components=clusterDefinition.getComponents("ZOOKEEPER");
  Assert.assertTrue(components.contains("ZOOKEEPER_SERVER"));
  components=clusterDefinition.getComponents("HIVE");
  Assert.assertTrue(components.contains("HIVE_SERVER"));
  clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider("clusterproperties_HDP2_HA.txt","myCluster","HDP-2.0.6"),new TestHostInfoProvider());
  components=clusterDefinition.getComponents("HDFS");
  Assert.assertTrue(components.contains("NAMENODE"));
  Assert.assertTrue(components.contains("SECONDARY_NAMENODE"));
  Assert.assertTrue(components.contains("DATANODE"));
  Assert.assertTrue(components.contains("ZKFC"));
  Assert.assertTrue(components.contains("JOURNALNODE"));
  clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider("clusterproperties_HDP21_HA.txt","myCluster","HDP-2.1.2"),new TestHostInfoProvider());
  components=clusterDefinition.getComponents("HDFS");
  Assert.assertTrue(components.contains("NAMENODE"));
  Assert.assertTrue(components.contains("ZKFC"));
  Assert.assertTrue(components.contains("JOURNALNODE"));
  components=clusterDefinition.getComponents("YARN");
  Assert.assertTrue(components.contains("RESOURCEMANAGER"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHDP2ServicesAndComponents(){
  StateProvider mockStateProvider=createStrictMock(StateProvider.class);
  ClusterDefinitionProvider mockClusterDefinitionProvider=createStrictMock(ClusterDefinitionProvider.class);
  HostInfoProvider mockHostInfoProvider=createStrictMock(HostInfoProvider.class);
  TestClusterDefinitionProvider testClusterDefinitionProvider=new TestClusterDefinitionProvider("clusterproperties_HDP2.txt","myCluster","HDP-2.0.6");
  expect(mockClusterDefinitionProvider.getClusterName()).andDelegateTo(testClusterDefinitionProvider);
  expect(mockClusterDefinitionProvider.getVersionId()).andDelegateTo(testClusterDefinitionProvider);
  expect(mockClusterDefinitionProvider.getInputStream()).andDelegateTo(testClusterDefinitionProvider);
  replay(mockClusterDefinitionProvider,mockHostInfoProvider,mockStateProvider);
  ClusterDefinition clusterDefinition=new ClusterDefinition(mockStateProvider,mockClusterDefinitionProvider,mockHostInfoProvider);
  Assert.assertFalse(clusterDefinition.getServices().contains("MAPREDUCE"));
  Assert.assertTrue(clusterDefinition.getServices().contains("PIG"));
  Assert.assertTrue(clusterDefinition.getServices().contains("SQOOP"));
  Assert.assertTrue(clusterDefinition.getServices().contains("YARN"));
  Assert.assertTrue(clusterDefinition.getServices().contains("MAPREDUCE2"));
  Assert.assertTrue(clusterDefinition.getComponents("MAPREDUCE2").contains("MAPREDUCE2_CLIENT"));
  Assert.assertTrue(clusterDefinition.getComponents("YARN").contains("NODEMANAGER"));
  Assert.assertTrue(clusterDefinition.getComponents("YARN").contains("RESOURCEMANAGER"));
  Assert.assertTrue(clusterDefinition.getComponents("YARN").contains("YARN_CLIENT"));
  verify(mockClusterDefinitionProvider,mockHostInfoProvider,mockStateProvider);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetHostComponents() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  Set<String> hostComponents=clusterDefinition.getHostComponents("HDFS","NAMENODE_MASTER.acme.com");
  Assert.assertTrue(hostComponents.contains("NAMENODE"));
  hostComponents=clusterDefinition.getHostComponents("HDFS","slave1.acme.com");
  Assert.assertTrue(hostComponents.contains("DATANODE"));
  hostComponents=clusterDefinition.getHostComponents("HDFS","slave2.acme.com");
  Assert.assertTrue(hostComponents.contains("DATANODE"));
  clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider("clusterproperties_HDP2_HA.txt","myCluster","HDP-2.0.6"),new TestHostInfoProvider());
  hostComponents=clusterDefinition.getHostComponents("HDFS","WINHDP-1");
  Assert.assertTrue(hostComponents.contains("NAMENODE"));
  Assert.assertTrue(hostComponents.contains("JOURNALNODE"));
  Assert.assertTrue(hostComponents.contains("ZKFC"));
  Assert.assertFalse(hostComponents.contains("DATANODE"));
  Assert.assertFalse(hostComponents.contains("SECONDARY_NAMENODE"));
  hostComponents=clusterDefinition.getHostComponents("HDFS","WINHDP-2");
  Assert.assertTrue(hostComponents.contains("NAMENODE"));
  Assert.assertTrue(hostComponents.contains("JOURNALNODE"));
  Assert.assertTrue(hostComponents.contains("ZKFC"));
  Assert.assertTrue(hostComponents.contains("DATANODE"));
  Assert.assertTrue(hostComponents.contains("SECONDARY_NAMENODE"));
  clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider("clusterproperties_HDP21_HA.txt","myCluster","HDP-2.1.2"),new TestHostInfoProvider());
  hostComponents=clusterDefinition.getHostComponents("YARN","WINHDP-1");
  Assert.assertTrue(hostComponents.contains("RESOURCEMANAGER"));
  hostComponents=clusterDefinition.getHostComponents("HDFS","WINHDP-1");
  Assert.assertTrue(hostComponents.contains("NAMENODE"));
  Assert.assertTrue(hostComponents.contains("JOURNALNODE"));
  hostComponents=clusterDefinition.getHostComponents("YARN","WINHDP-2");
  Assert.assertTrue(hostComponents.contains("RESOURCEMANAGER"));
  hostComponents=clusterDefinition.getHostComponents("HDFS","WINHDP-2");
  Assert.assertTrue(hostComponents.contains("NAMENODE"));
  Assert.assertTrue(hostComponents.contains("JOURNALNODE"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetMajorStackVersion(){
  TestClusterDefinitionProvider testClusterDefinitionProvider=new TestClusterDefinitionProvider("clusterproperties_HDP2.txt","myCluster","HDP-2.0.6");
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),testClusterDefinitionProvider,new TestHostInfoProvider());
  Integer majorVersion=clusterDefinition.getMajorStackVersion();
  Integer minorVersion=clusterDefinition.getMinorStackVersion();
  Assert.assertTrue(2 == majorVersion);
  Assert.assertTrue(0 == minorVersion);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetServices() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  Set<String> services=clusterDefinition.getServices();
  Assert.assertTrue(services.contains("HDFS"));
  Assert.assertTrue(services.contains("FLUME"));
  Assert.assertTrue(services.contains("OOZIE"));
  Assert.assertTrue(services.contains("MAPREDUCE"));
  Assert.assertTrue(services.contains("HBASE"));
  Assert.assertTrue(services.contains("ZOOKEEPER"));
  Assert.assertTrue(services.contains("HIVE"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ClusterProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ClusterProvider provider=new ClusterProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("myCluster").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource next=resources.iterator().next();
  Assert.assertEquals("myCluster",next.getPropertyValue(ClusterProvider.CLUSTER_NAME_PROPERTY_ID));
  Assert.assertEquals("HDP-1.2.9",next.getPropertyValue(ClusterProvider.CLUSTER_VERSION_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("non-existent Cluster").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ComponentProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ComponentProvider provider=new ComponentProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("TASKTRACKER").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(ComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("TASKTRACKER").or().property(ComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("DATANODE").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(ComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("BadComponent").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.HostComponentProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostComponentProvider provider=new HostComponentProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(HostComponentProvider.HOST_COMPONENT_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(5,resources.size());
  predicate=new PredicateBuilder().property(HostComponentProvider.HOST_COMPONENT_HOST_NAME_PROPERTY_ID).equals("UnknownHost").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.HostProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  HostProvider provider=new HostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("NAMENODE_MASTER.acme.com").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("HBASE_MASTER.acme.com").or().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("slave3.acme.com").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(HostProvider.HOST_NAME_PROPERTY_ID).equals("unknownHost").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.NoOpProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCheckPropertyIds() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  NoOpProvider provider=new NoOpProvider(Resource.Type.Workflow,clusterDefinition);
  Assert.assertTrue(provider.checkPropertyIds(Collections.singleton("id")).isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.ServiceProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  ServiceProvider provider=new ServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("HDFS").or().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("FLUME").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(ServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("NO SERVICE").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.SQLPropertyProviderTest </h4><pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_multi() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcQueueTime_avg_time");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcQueueTime_avg_time");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getString("RecordTypeContext")).andReturn("rpc");
  expect(resultSet.getString("RecordTypeName")).andReturn("rpc");
  expect(resultSet.getString("TagPairs")).andReturn("");
  expect(resultSet.getString("MetricName")).andReturn("RpcSlowResponse_num_ops");
  expect(resultSet.getString("ServiceName")).andReturn("datanode");
  expect(resultSet.getString("NodeName")).andReturn("host1");
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),new TestHostInfoProvider(),CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,20L,1L));
  Set<String> propertyIds=new LinkedHashSet<String>();
  propertyIds.add(PROPERTY_ID_1);
  propertyIds.add(PROPERTY_ID_2);
  Request request=PropertyHelper.getReadRequest(propertyIds,temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  Assert.assertEquals(3L,resource.getPropertyValue(PROPERTY_ID_2));
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),new TestHostInfoProvider(),CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,20L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_temporalStartTimeOnly() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  TestHostInfoProvider hostProvider=new TestHostInfoProvider();
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),hostProvider,CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,-1L,-1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  Assert.assertEquals(1,provider.populateResources(Collections.singleton(resource),request,null).size());
  Assert.assertTrue(resource.getPropertyValue(PROPERTY_ID_1) instanceof Number[][]);
  Number[][] datapoints=(Number[][])resource.getPropertyValue(PROPERTY_ID_1);
  for (int i=0; i < datapoints.length; ++i) {
    Assert.assertEquals((long)i,datapoints[i][0]);
    Assert.assertEquals((999990L + i) / 1000,datapoints[i][1]);
  }
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.SQLProviderModuleTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreatePropertyProviders(){
  SQLProviderModule providerModule=new SQLProviderModule();
  providerModule.createPropertyProviders(Resource.Type.Component);
  List<PropertyProvider> providers=providerModule.getPropertyProviders(Resource.Type.Component);
  Assert.assertTrue(providers.get(0) instanceof JMXPropertyProvider);
  Assert.assertTrue(providers.get(1) instanceof SQLPropertyProvider);
  providerModule.createPropertyProviders(Resource.Type.HostComponent);
  providers=providerModule.getPropertyProviders(Resource.Type.HostComponent);
  Assert.assertTrue(providers.get(0) instanceof JMXPropertyProvider);
  Assert.assertTrue(providers.get(1) instanceof SQLPropertyProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.logging.JpaLoggerTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testShouldLog() throws Exception {
  JpaLogger logger=new JpaLogger();
  Assert.assertTrue(logger.shouldLog(SessionLog.SEVERE,""));
  Assert.assertTrue(logger.shouldLog(SessionLog.WARNING,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.CONFIG,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.FINER,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.ALL,""));
  logger.setLogLevel(Level.FINER);
  Assert.assertTrue(logger.shouldLog(SessionLog.SEVERE,""));
  Assert.assertTrue(logger.shouldLog(SessionLog.WARNING,""));
  Assert.assertTrue(logger.shouldLog(SessionLog.CONFIG,""));
  Assert.assertTrue(logger.shouldLog(SessionLog.FINER,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.ALL,""));
  logger.setLogLevel(Level.SEVERE);
  Assert.assertTrue(logger.shouldLog(SessionLog.SEVERE,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.WARNING,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.CONFIG,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.FINER,""));
  Assert.assertFalse(logger.shouldLog(SessionLog.ALL,""));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.StateRecoveryManagerTest </h4><pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckHostAndClusterVersions() throws Exception {
  StateRecoveryManager stateRecoveryManager=injector.getInstance(StateRecoveryManager.class);
  final Capture<RepositoryVersionState> installFailedHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> installingHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> installedHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> outOfSyncHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradeFailedHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradingHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradedHostVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> currentHostVersionCapture=new Capture<RepositoryVersionState>();
  expect(hostVersionDAOMock.findAll()).andReturn(new ArrayList<HostVersionEntity>(){
{
      add(getHostVersionMock("install_failed_version",RepositoryVersionState.INSTALL_FAILED,installFailedHostVersionCapture));
      add(getHostVersionMock("installing_version",RepositoryVersionState.INSTALLING,installingHostVersionCapture));
      add(getHostVersionMock("installed_version",RepositoryVersionState.INSTALLED,installedHostVersionCapture));
      add(getHostVersionMock("out_of_sync_version",RepositoryVersionState.OUT_OF_SYNC,outOfSyncHostVersionCapture));
      add(getHostVersionMock("upgrade_failed_version",RepositoryVersionState.UPGRADE_FAILED,upgradeFailedHostVersionCapture));
      add(getHostVersionMock("upgrading_version",RepositoryVersionState.UPGRADING,upgradingHostVersionCapture));
      add(getHostVersionMock("upgraded_version",RepositoryVersionState.UPGRADED,upgradedHostVersionCapture));
      add(getHostVersionMock("current_version",RepositoryVersionState.CURRENT,currentHostVersionCapture));
    }
  }
);
  final Capture<RepositoryVersionState> installFailedClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> installingClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> installedClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> outOfSyncClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradeFailedClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradingClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> upgradedClusterVersionCapture=new Capture<RepositoryVersionState>();
  final Capture<RepositoryVersionState> currentClusterVersionCapture=new Capture<RepositoryVersionState>();
  expect(clusterVersionDAOMock.findAll()).andReturn(new ArrayList<ClusterVersionEntity>(){
{
      add(getClusterVersionMock("install_failed_version",RepositoryVersionState.INSTALL_FAILED,installFailedClusterVersionCapture));
      add(getClusterVersionMock("installing_version",RepositoryVersionState.INSTALLING,installingClusterVersionCapture));
      add(getClusterVersionMock("installed_version",RepositoryVersionState.INSTALLED,installedClusterVersionCapture));
      add(getClusterVersionMock("out_of_sync_version",RepositoryVersionState.OUT_OF_SYNC,outOfSyncClusterVersionCapture));
      add(getClusterVersionMock("upgrade_failed_version",RepositoryVersionState.UPGRADE_FAILED,upgradeFailedClusterVersionCapture));
      add(getClusterVersionMock("upgrading_version",RepositoryVersionState.UPGRADING,upgradingClusterVersionCapture));
      add(getClusterVersionMock("upgraded_version",RepositoryVersionState.UPGRADED,upgradedClusterVersionCapture));
      add(getClusterVersionMock("current_version",RepositoryVersionState.CURRENT,currentClusterVersionCapture));
    }
  }
);
  replay(hostVersionDAOMock,clusterVersionDAOMock);
  stateRecoveryManager.checkHostAndClusterVersions();
  assertFalse(installFailedHostVersionCapture.hasCaptured());
  assertEquals(installingHostVersionCapture.getValue(),RepositoryVersionState.INSTALL_FAILED);
  assertFalse(installedHostVersionCapture.hasCaptured());
  assertFalse(outOfSyncHostVersionCapture.hasCaptured());
  assertFalse(upgradeFailedHostVersionCapture.hasCaptured());
  assertFalse(upgradingHostVersionCapture.hasCaptured());
  assertFalse(upgradedHostVersionCapture.hasCaptured());
  assertFalse(currentHostVersionCapture.hasCaptured());
  assertFalse(installFailedClusterVersionCapture.hasCaptured());
  assertEquals(installingClusterVersionCapture.getValue(),RepositoryVersionState.INSTALL_FAILED);
  assertFalse(installedClusterVersionCapture.hasCaptured());
  assertFalse(outOfSyncClusterVersionCapture.hasCaptured());
  assertFalse(upgradeFailedClusterVersionCapture.hasCaptured());
  assertFalse(upgradingClusterVersionCapture.hasCaptured());
  assertFalse(upgradedClusterVersionCapture.hasCaptured());
  assertFalse(currentClusterVersionCapture.hasCaptured());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.HostRoleStatusTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsHoldingState() throws Exception {
  Assert.assertFalse(HostRoleStatus.ABORTED.isHoldingState());
  Assert.assertFalse(HostRoleStatus.COMPLETED.isHoldingState());
  Assert.assertFalse(HostRoleStatus.FAILED.isHoldingState());
  Assert.assertFalse(HostRoleStatus.IN_PROGRESS.isHoldingState());
  Assert.assertFalse(HostRoleStatus.PENDING.isHoldingState());
  Assert.assertFalse(HostRoleStatus.QUEUED.isHoldingState());
  Assert.assertFalse(HostRoleStatus.TIMEDOUT.isHoldingState());
  Assert.assertTrue(HostRoleStatus.HOLDING.isHoldingState());
  Assert.assertTrue(HostRoleStatus.HOLDING_FAILED.isHoldingState());
  Assert.assertTrue(HostRoleStatus.HOLDING_TIMEDOUT.isHoldingState());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsCompletedState() throws Exception {
  Assert.assertTrue(HostRoleStatus.ABORTED.isCompletedState());
  Assert.assertTrue(HostRoleStatus.COMPLETED.isCompletedState());
  Assert.assertTrue(HostRoleStatus.FAILED.isCompletedState());
  Assert.assertFalse(HostRoleStatus.IN_PROGRESS.isCompletedState());
  Assert.assertFalse(HostRoleStatus.PENDING.isCompletedState());
  Assert.assertFalse(HostRoleStatus.QUEUED.isCompletedState());
  Assert.assertTrue(HostRoleStatus.TIMEDOUT.isCompletedState());
  Assert.assertFalse(HostRoleStatus.HOLDING.isCompletedState());
  Assert.assertFalse(HostRoleStatus.HOLDING_FAILED.isCompletedState());
  Assert.assertFalse(HostRoleStatus.HOLDING_TIMEDOUT.isCompletedState());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsFailedState() throws Exception {
  Assert.assertTrue(HostRoleStatus.ABORTED.isFailedState());
  Assert.assertFalse(HostRoleStatus.COMPLETED.isFailedState());
  Assert.assertTrue(HostRoleStatus.FAILED.isFailedState());
  Assert.assertFalse(HostRoleStatus.IN_PROGRESS.isFailedState());
  Assert.assertFalse(HostRoleStatus.PENDING.isFailedState());
  Assert.assertFalse(HostRoleStatus.QUEUED.isFailedState());
  Assert.assertTrue(HostRoleStatus.TIMEDOUT.isFailedState());
  Assert.assertFalse(HostRoleStatus.HOLDING.isFailedState());
  Assert.assertFalse(HostRoleStatus.HOLDING_FAILED.isFailedState());
  Assert.assertFalse(HostRoleStatus.HOLDING_TIMEDOUT.isFailedState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionDBAccessorImpl </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPersistActions() throws AmbariException {
  populateActionDB(db,hostName,requestId,stageId);
  for (  Stage stage : db.getAllStages(requestId)) {
    log.info("taskId={}" + stage.getExecutionCommands(hostName).get(0).getExecutionCommand().getTaskId());
    assertTrue(stage.getExecutionCommands(hostName).get(0).getExecutionCommand().getTaskId() > 0);
    assertTrue(executionCommandDAO.findByPK(stage.getExecutionCommands(hostName).get(0).getExecutionCommand().getTaskId()) != null);
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests getting requests which are fully COMPLETED out the database. This
 * will test for partial completions as well.
 * @throws AmbariException
 */
@Test public void testGetCompletedRequests() throws AmbariException {
  List<Long> requestIds=new ArrayList<Long>();
  requestIds.add(requestId);
  requestIds.add(requestId + 1);
  populateActionDBWithCompletedRequest(db,hostName,requestId,stageId);
  List<Long> requestIdsResult=db.getRequestsByStatus(RequestStatus.COMPLETED,BaseRequest.DEFAULT_PAGE_SIZE,false);
  assertEquals(1,requestIdsResult.size());
  assertTrue(requestIdsResult.contains(requestId));
  populateActionDBWithPartiallyCompletedRequest(db,hostName,requestId + 1,stageId);
  requestIdsResult=db.getRequestsByStatus(RequestStatus.COMPLETED,BaseRequest.DEFAULT_PAGE_SIZE,false);
  assertEquals(1,requestIdsResult.size());
  assertTrue(requestIdsResult.contains(requestId));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStagesInProgressWithManyStages() throws AmbariException {
  populateActionDBMultipleStages(3,db,hostName,requestId,stageId);
  populateActionDBMultipleStages(3,db,hostName,requestId + 1,stageId + 3);
  populateActionDBMultipleStages(3,db,hostName,requestId + 2,stageId + 3);
  int commandsInProgressCount=db.getCommandsInProgressCount();
  List<Stage> stages=db.getStagesInProgress();
  assertEquals(18,commandsInProgressCount);
  assertEquals(9,stages.size());
  long lastRequestId=Integer.MIN_VALUE;
  for (  Stage stage : stages) {
    assertTrue(stage.getRequestId() >= lastRequestId);
    lastRequestId=stage.getRequestId();
  }
  db.abortOperation(requestId);
  commandsInProgressCount=db.getCommandsInProgressCount();
  stages=db.getStagesInProgress();
  assertEquals(12,commandsInProgressCount);
  assertEquals(6,stages.size());
  stages.get(0).setHostRoleStatus(hostName,Role.HBASE_MASTER.toString(),HostRoleStatus.COMPLETED);
  db.hostRoleScheduled(stages.get(0),hostName,Role.HBASE_MASTER.toString());
  commandsInProgressCount=db.getCommandsInProgressCount();
  stages=db.getStagesInProgress();
  assertEquals(11,commandsInProgressCount);
  assertEquals(6,stages.size());
  stages.get(0).setHostRoleStatus(hostName,Role.HBASE_REGIONSERVER.toString(),HostRoleStatus.COMPLETED);
  db.hostRoleScheduled(stages.get(0),hostName,Role.HBASE_REGIONSERVER.toString());
  commandsInProgressCount=db.getCommandsInProgressCount();
  stages=db.getStagesInProgress();
  assertEquals(10,commandsInProgressCount);
  assertEquals(5,stages.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostRole() throws Exception {
  populateActionDB(db,hostName,requestId,stageId);
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 50000; i++) {
    sb.append("1234567890");
  }
  String largeString=sb.toString();
  CommandReport commandReport=new CommandReport();
  commandReport.setStatus(HostRoleStatus.COMPLETED.toString());
  commandReport.setStdOut(largeString);
  commandReport.setStdErr(largeString);
  commandReport.setStructuredOut(largeString);
  commandReport.setExitCode(123);
  db.updateHostRoleState(hostName,requestId,stageId,Role.HBASE_MASTER.toString(),commandReport);
  List<HostRoleCommandEntity> commandEntities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(1,commandEntities.size());
  HostRoleCommandEntity commandEntity=commandEntities.get(0);
  HostRoleCommand command=db.getTask(commandEntity.getTaskId());
  assertNotNull(command);
  assertEquals(largeString,command.getStdout());
  assertEquals(largeString,command.getStructuredOut());
  assertTrue(command.getEndTime() != -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionManager </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionResponse() throws AmbariException {
  ActionDBAccessor db=injector.getInstance(ActionDBAccessorImpl.class);
  ActionManager am=new ActionManager(5000,1200000,new ActionQueue(),clusters,db,new HostsMap((String)null),unitOfWork,injector.getInstance(RequestFactory.class),null,null);
  populateActionDB(db,hostname);
  Stage stage=db.getAllStages(requestId).get(0);
  Assert.assertEquals(stageId,stage.getStageId());
  stage.setHostRoleStatus(hostname,"HBASE_MASTER",HostRoleStatus.QUEUED);
  db.hostRoleScheduled(stage,hostname,"HBASE_MASTER");
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setTaskId(1);
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setRole("HBASE_MASTER");
  cr.setStatus("COMPLETED");
  cr.setStdErr("ERROR");
  cr.setStdOut("OUTPUT");
  cr.setStructuredOut("STRUCTURED_OUTPUT");
  cr.setExitCode(215);
  reports.add(cr);
  am.processTaskResponse(hostname,reports,stage.getOrderedHostRoleCommands());
  assertEquals(215,am.getAction(requestId,stageId).getExitCode(hostname,"HBASE_MASTER"));
  assertEquals(HostRoleStatus.COMPLETED,am.getAction(requestId,stageId).getHostRoleStatus(hostname,"HBASE_MASTER"));
  assertEquals("ERROR",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStderr());
  assertEquals("OUTPUT",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStdout());
  assertEquals("STRUCTURED_OUTPUT",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStructuredOut());
  assertNotNull(db.getRequest(requestId));
  assertFalse(db.getRequest(requestId).getEndTime() == -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionScheduler </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test sends verifies that ActionScheduler returns up-to-date cluster host info and caching works correctly.
 */
@Test public void testClusterHostInfoCache() throws Exception {
  Type type=new TypeToken<Map<String,Set<String>>>(){
  }
.getType();
  Map<String,Set<String>> clusterHostInfo1=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO,type);
  Map<String,Set<String>> clusterHostInfo2=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO_UPDATED,type);
  int stageId=1;
  int requestId1=1;
  int requestId2=2;
  ActionQueue aq=new ActionQueue();
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  Host host=mock(Host.class);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname,sch);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  when(fsm.getHost(anyString())).thenReturn(host);
  when(host.getState()).thenReturn(HostState.HEALTHY);
  when(host.getHostName()).thenReturn(hostname);
  ActionDBAccessor db=mock(ActionDBAccessorImpl.class);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  Stage s1=StageUtils.getATestStage(requestId1,stageId,hostname,CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  Stage s2=StageUtils.getATestStage(requestId2,stageId,hostname,CLUSTER_HOST_INFO_UPDATED,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  when(db.getCommandsInProgressCount()).thenReturn(1);
  when(db.getStagesInProgress()).thenReturn(Collections.singletonList(s1));
  ActionScheduler scheduler=new ActionScheduler(100,100,db,aq,fsm,10000,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.setTaskTimeoutAdjustment(false);
  List<AgentCommand> ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals(String.valueOf(requestId1) + "-" + stageId,((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo1,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  when(db.getCommandsInProgressCount()).thenReturn(1);
  when(db.getStagesInProgress()).thenReturn(Collections.singletonList(s2));
  ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals(String.valueOf(requestId2) + "-" + stageId,((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo2,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test sends a new action to the action scheduler and verifies that the action
 * shows up in the action queue.
 */
@Test public void testActionSchedule() throws Exception {
  Type type=new TypeToken<Map<String,Set<String>>>(){
  }
.getType();
  Map<String,List<String>> clusterHostInfo=StageUtils.getGson().fromJson(CLUSTER_HOST_INFO,type);
  ActionQueue aq=new ActionQueue();
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(fsm.getClusterById(anyLong())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(oneClusterMock.getClusterId()).thenReturn(Long.valueOf(1L));
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  Host host=mock(Host.class);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname,sch);
  HostEntity hostEntity=new HostEntity();
  hostEntity.setHostName(hostname);
  hostDAO.merge(hostEntity);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  when(fsm.getHost(anyString())).thenReturn(host);
  when(host.getState()).thenReturn(HostState.HEALTHY);
  when(host.getHostName()).thenReturn(hostname);
  ActionDBAccessor db=mock(ActionDBAccessorImpl.class);
  List<Stage> stages=new ArrayList<Stage>();
  Stage s=StageUtils.getATestStage(1,977,hostname,CLUSTER_HOST_INFO,"{\"host_param\":\"param_value\"}","{\"stage_param\":\"param_value\"}");
  stages.add(s);
  when(db.getCommandsInProgressCount()).thenReturn(stages.size());
  when(db.getStagesInProgress()).thenReturn(stages);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  ActionScheduler scheduler=new ActionScheduler(100,5,db,aq,fsm,10000,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.setTaskTimeoutAdjustment(false);
  List<AgentCommand> ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals("1-977",((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  ac=waitForQueueSize(hostname,aq,1,scheduler);
  assertTrue(ac.get(0) instanceof ExecutionCommand);
  assertEquals("1-977",((ExecutionCommand)(ac.get(0))).getCommandId());
  assertEquals(clusterHostInfo,((ExecutionCommand)(ac.get(0))).getClusterHostInfo());
  s.setHostRoleStatus(hostname,"NAMENODE",HostRoleStatus.COMPLETED);
  ac=aq.dequeueAll(hostname);
  ac=waitForQueueSize(hostname,aq,0,scheduler);
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies that ActionScheduler respects "disable parallel stage execution option"
 */
@Test public void testIndependentStagesExecutionDisabled() throws Exception {
  ActionQueue aq=new ActionQueue();
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  String hostname1="ahost.ambari.apache.org";
  String hostname2="bhost.ambari.apache.org";
  String hostname3="chost.ambari.apache.org";
  String hostname4="chost.ambari.apache.org";
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname1,sch);
  hosts.put(hostname2,sch);
  hosts.put(hostname3,sch);
  hosts.put(hostname4,sch);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  List<Stage> stages=new ArrayList<Stage>();
  Stage stage=getStageWithSingleTask(hostname1,"cluster1",Role.HIVE_CLIENT,RoleCommand.INSTALL,Service.Type.HIVE,1,1,1);
  Map<String,String> hiveSite=new TreeMap<String,String>();
  hiveSite.put("javax.jdo.option.ConnectionPassword","password");
  hiveSite.put("hive.server2.thrift.port","10000");
  Map<String,Map<String,String>> configurations=new TreeMap<String,Map<String,String>>();
  configurations.put("hive-site",hiveSite);
  stage.getExecutionCommands(hostname1).get(0).getExecutionCommand().setConfigurations(configurations);
  stages.add(stage);
  stages.add(getStageWithSingleTask(hostname1,"cluster1",Role.GANGLIA_MONITOR,RoleCommand.START,Service.Type.GANGLIA,2,2,2));
  stages.add(getStageWithSingleTask(hostname2,"cluster1",Role.HIVE_CLIENT,RoleCommand.INSTALL,Service.Type.HIVE,3,3,3));
  stages.add(getStageWithSingleTask(hostname3,"cluster1",Role.DATANODE,RoleCommand.START,Service.Type.HDFS,4,4,4));
  stages.add(getStageWithSingleTask(hostname4,"cluster1",Role.GANGLIA_MONITOR,RoleCommand.START,Service.Type.GANGLIA,5,5,4));
  ActionDBAccessor db=mock(ActionDBAccessor.class);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  when(db.getCommandsInProgressCount()).thenReturn(stages.size());
  when(db.getStagesInProgress()).thenReturn(stages);
  Properties properties=new Properties();
  properties.put(Configuration.PARALLEL_STAGE_EXECUTION_KEY,"false");
  Configuration conf=new Configuration(properties);
  ActionScheduler scheduler=new ActionScheduler(100,50,db,aq,fsm,3,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.doWork();
  Assert.assertEquals(HostRoleStatus.QUEUED,stages.get(0).getHostRoleStatus(hostname1,"HIVE_CLIENT"));
  Assert.assertEquals(HostRoleStatus.PENDING,stages.get(1).getHostRoleStatus(hostname1,"GANGLIA_MONITOR"));
  Assert.assertEquals(HostRoleStatus.PENDING,stages.get(2).getHostRoleStatus(hostname2,"HIVE_CLIENT"));
  Assert.assertEquals(HostRoleStatus.PENDING,stages.get(3).getHostRoleStatus(hostname3,"DATANODE"));
  Assert.assertEquals(HostRoleStatus.PENDING,stages.get(4).getHostRoleStatus(hostname4,"GANGLIA_MONITOR"));
  Assert.assertFalse(stages.get(0).getExecutionCommands(hostname1).get(0).getExecutionCommand().getConfigurations().containsKey("javax.jdo.option.ConnectionPassword"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testExclusiveRequests() throws Exception {
  ActionQueue aq=new ActionQueue();
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch=mock(ServiceComponentHost.class);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(scomp.getServiceComponentHost(anyString())).thenReturn(sch);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  String hostname1="hostname1";
  String hostname2="hostname2";
  String hostname3="hostname3";
  hosts.put(hostname1,sch);
  hosts.put(hostname2,sch);
  hosts.put(hostname3,sch);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  long requestId1=1;
  long requestId2=2;
  long requestId3=3;
  final List<Stage> stagesInProgress=new ArrayList<Stage>();
  int namenodeCmdTaskId=1;
  stagesInProgress.add(getStageWithSingleTask(hostname1,"cluster1",Role.NAMENODE,RoleCommand.START,Service.Type.HDFS,namenodeCmdTaskId,1,(int)requestId1));
  stagesInProgress.add(getStageWithSingleTask(hostname1,"cluster1",Role.DATANODE,RoleCommand.START,Service.Type.HDFS,2,2,(int)requestId1));
  stagesInProgress.add(getStageWithSingleTask(hostname2,"cluster1",Role.DATANODE,RoleCommand.STOP,Service.Type.HDFS,3,3,(int)requestId2));
  stagesInProgress.add(getStageWithSingleTask(hostname3,"cluster1",Role.DATANODE,RoleCommand.START,Service.Type.HDFS,4,4,(int)requestId3));
  Host host1=mock(Host.class);
  when(fsm.getHost(anyString())).thenReturn(host1);
  when(host1.getState()).thenReturn(HostState.HEALTHY);
  when(host1.getHostName()).thenReturn(hostname);
  Host host2=mock(Host.class);
  when(fsm.getHost(anyString())).thenReturn(host2);
  when(host2.getState()).thenReturn(HostState.HEALTHY);
  when(host2.getHostName()).thenReturn(hostname);
  Host host3=mock(Host.class);
  when(fsm.getHost(anyString())).thenReturn(host3);
  when(host3.getState()).thenReturn(HostState.HEALTHY);
  when(host3.getHostName()).thenReturn(hostname);
  ActionDBAccessor db=mock(ActionDBAccessor.class);
  when(db.getCommandsInProgressCount()).thenReturn(stagesInProgress.size());
  when(db.getStagesInProgress()).thenReturn(stagesInProgress);
  List<HostRoleCommand> requestTasks=new ArrayList<HostRoleCommand>();
  for (  Stage stage : stagesInProgress) {
    requestTasks.addAll(stage.getOrderedHostRoleCommands());
  }
  when(db.getRequestTasks(anyLong())).thenReturn(requestTasks);
  when(db.getAllStages(anyLong())).thenReturn(stagesInProgress);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      List<CommandReport> reports=(List<CommandReport>)invocation.getArguments()[0];
      for (      CommandReport report : reports) {
        String actionId=report.getActionId();
        long[] requestStageIds=StageUtils.getRequestStage(actionId);
        Long requestId=requestStageIds[0];
        Long stageId=requestStageIds[1];
        Long id=report.getTaskId();
        for (        Stage stage : stagesInProgress) {
          if (requestId.equals(stage.getRequestId()) && stageId.equals(stage.getStageId())) {
            for (            HostRoleCommand hostRoleCommand : stage.getOrderedHostRoleCommands()) {
              if (hostRoleCommand.getTaskId() == id) {
                hostRoleCommand.setStatus(HostRoleStatus.valueOf(report.getStatus()));
              }
            }
          }
        }
      }
      return null;
    }
  }
).when(db).updateHostRoleStates(anyCollectionOf(CommandReport.class));
  when(db.getTask(anyLong())).thenAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocation) throws Throwable {
      Long taskId=(Long)invocation.getArguments()[0];
      for (      Stage stage : stagesInProgress) {
        for (        HostRoleCommand command : stage.getOrderedHostRoleCommands()) {
          if (taskId.equals(command.getTaskId())) {
            return command;
          }
        }
      }
      return null;
    }
  }
);
  final Map<Long,Boolean> startedRequests=new HashMap<Long,Boolean>();
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      startedRequests.put((Long)invocation.getArguments()[0],true);
      return null;
    }
  }
).when(db).startRequest(anyLong());
  RequestEntity request1=mock(RequestEntity.class);
  when(request1.isExclusive()).thenReturn(false);
  RequestEntity request2=mock(RequestEntity.class);
  when(request2.isExclusive()).thenReturn(true);
  RequestEntity request3=mock(RequestEntity.class);
  when(request3.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(requestId1)).thenReturn(request1);
  when(db.getRequestEntity(requestId2)).thenReturn(request2);
  when(db.getRequestEntity(requestId3)).thenReturn(request3);
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  ActionScheduler scheduler=new ActionScheduler(100,50,db,aq,fsm,3,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.doWork();
  Assert.assertTrue(startedRequests.containsKey(requestId1));
  Assert.assertFalse(startedRequests.containsKey(requestId2));
  Assert.assertFalse(startedRequests.containsKey(requestId3));
  stagesInProgress.remove(0);
  scheduler.doWork();
  Assert.assertTrue(startedRequests.containsKey(requestId1));
  Assert.assertFalse(startedRequests.containsKey(requestId2));
  Assert.assertFalse(startedRequests.containsKey(requestId3));
  stagesInProgress.remove(0);
  scheduler.doWork();
  Assert.assertTrue(startedRequests.containsKey(requestId1));
  Assert.assertTrue(startedRequests.containsKey(requestId2));
  Assert.assertFalse(startedRequests.containsKey(requestId3));
  stagesInProgress.remove(0);
  scheduler.doWork();
  Assert.assertTrue(startedRequests.containsKey(requestId1));
  Assert.assertTrue(startedRequests.containsKey(requestId2));
  Assert.assertTrue(startedRequests.containsKey(requestId3));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSuccessCriteria(){
  RoleStats rs1=new RoleStats(1,(float)0.5);
  rs1.numSucceeded=1;
  assertTrue(rs1.isSuccessFactorMet());
  rs1.numSucceeded=0;
  assertFalse(rs1.isSuccessFactorMet());
  RoleStats rs2=new RoleStats(2,(float)0.5);
  rs2.numSucceeded=1;
  assertTrue(rs2.isSuccessFactorMet());
  RoleStats rs3=new RoleStats(3,(float)0.5);
  rs3.numSucceeded=2;
  assertTrue(rs2.isSuccessFactorMet());
  rs3.numSucceeded=1;
  assertFalse(rs3.isSuccessFactorMet());
  RoleStats rs4=new RoleStats(3,(float)1.0);
  rs4.numSucceeded=2;
  assertFalse(rs3.isSuccessFactorMet());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.AgentResourceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deserializeClasses(){
  String DirectoryJSON="[{name:'/var/lib', type:'directory'},{name:'b', type:'directory'}]";
  String PackageDetailJSON="[{name:'abc', version:'2.3', repoName:'HDP'},{name:'abc', version:'3.3', repoName:'HDP-epel'}]";
  String ExistingUserJSON="[{name:'hdfs', homeDir:'/var/lib/hadoop', status:''}, " + "{name:'ambari_qa', homeDir:'/var/home/ambari_qa',status:'None'}]";
  String JavaProcJSON="[{user:'root', pid:'355', hadoop:'True', command:'cmd'}, " + "{user:'hdfs', pid:'325', hadoop:'False', command:'cmd = 2'}]";
  String AlternativeJSON="[{name:'/etc/alternatives/hdfs-conf', target:'/etc/hadoop/conf.dist'}, " + "{name:'abc', target:'def'}]";
  String AgentEnvJSON="{\"alternatives\": " + AlternativeJSON + ", \"existingUsers\": "+ ExistingUserJSON+ ", \"umask\": \"18\", \"installedPackages\": "+ PackageDetailJSON+ ", \"stackFoldersAndFiles\": "+ DirectoryJSON+ ", \"firewallRunning\": \"true\", \"firewallName\": \"iptables\", \"transparentHugePage\": \"never\"}";
  AgentEnv.Directory[] dirs=getJsonFormString(DirectoryJSON,AgentEnv.Directory[].class);
  Assert.assertEquals("/var/lib",dirs[0].getName());
  Assert.assertEquals("directory",dirs[1].getType());
  AgentEnv.PackageDetail[] pkgs=getJsonFormString(PackageDetailJSON,AgentEnv.PackageDetail[].class);
  Assert.assertEquals("abc",pkgs[0].getName());
  Assert.assertEquals("HDP",pkgs[0].getRepoName());
  Assert.assertEquals("3.3",pkgs[1].getVersion());
  AgentEnv.ExistingUser[] users=getJsonFormString(ExistingUserJSON,AgentEnv.ExistingUser[].class);
  Assert.assertEquals("hdfs",users[0].getUserName());
  Assert.assertEquals("/var/lib/hadoop",users[0].getUserHomeDir());
  Assert.assertEquals("None",users[1].getUserStatus());
  AgentEnv.JavaProc[] procs=getJsonFormString(JavaProcJSON,AgentEnv.JavaProc[].class);
  Assert.assertEquals("root",procs[0].getUser());
  Assert.assertEquals(355,procs[0].getPid());
  Assert.assertEquals("cmd = 2",procs[1].getCommand());
  Assert.assertEquals(false,procs[1].isHadoop());
  AgentEnv.Alternative[] alternatives=getJsonFormString(AlternativeJSON,AgentEnv.Alternative[].class);
  Assert.assertEquals("/etc/alternatives/hdfs-conf",alternatives[0].getName());
  Assert.assertEquals("/etc/hadoop/conf.dist",alternatives[0].getTarget());
  Assert.assertEquals("abc",alternatives[1].getName());
  Assert.assertEquals("def",alternatives[1].getTarget());
  AgentEnv agentEnv=getJsonFormString(AgentEnvJSON,AgentEnv.class);
  Assert.assertTrue(18 == agentEnv.getUmask());
  Assert.assertEquals("never",agentEnv.getTransparentHugePage());
  Assert.assertTrue(Boolean.TRUE == agentEnv.getFirewallRunning());
  Assert.assertEquals("iptables",agentEnv.getFirewallName());
  Assert.assertEquals("/etc/alternatives/hdfs-conf",agentEnv.getAlternatives()[0].getName());
  Assert.assertEquals("/etc/hadoop/conf.dist",agentEnv.getAlternatives()[0].getTarget());
  Assert.assertEquals("abc",agentEnv.getAlternatives()[1].getName());
  Assert.assertEquals("def",agentEnv.getAlternatives()[1].getTarget());
  Assert.assertEquals("abc",agentEnv.getInstalledPackages()[0].getName());
  Assert.assertEquals("HDP",agentEnv.getInstalledPackages()[0].getRepoName());
  Assert.assertEquals("3.3",agentEnv.getInstalledPackages()[1].getVersion());
  Assert.assertEquals("hdfs",agentEnv.getExistingUsers()[0].getUserName());
  Assert.assertEquals("/var/lib/hadoop",agentEnv.getExistingUsers()[0].getUserHomeDir());
  Assert.assertEquals("None",agentEnv.getExistingUsers()[1].getUserStatus());
  Assert.assertEquals("/var/lib",agentEnv.getStackFoldersAndFiles()[0].getName());
  Assert.assertEquals("directory",agentEnv.getStackFoldersAndFiles()[1].getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestActionQueue </h4><pre class="type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentOperations() throws InterruptedException {
  ActionQueue aq=new ActionQueue();
  String[] hosts=new String[]{"h0","h1","h2","h3","h4","h5","h6","h7","h8","h9"};
  ActionQueueOperation[] enqueOperators=new ActionQueueOperation[threadCount];
  ActionQueueOperation[] dequeOperators=new ActionQueueOperation[threadCount];
  ActionQueueOperation[] dequeAllOperators=new ActionQueueOperation[threadCount];
  List<Thread> producers=new ArrayList<Thread>();
  List<Thread> consumers=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    dequeOperators[i]=new ActionQueueOperation(aq,hosts,ActionQueueOperation.OpType.DEQUEUE);
    Thread t=new Thread(dequeOperators[i]);
    consumers.add(t);
    t.start();
  }
  for (int i=0; i < threadCount; i++) {
    enqueOperators[i]=new ActionQueueOperation(aq,hosts,ActionQueueOperation.OpType.ENQUEUE);
    Thread t=new Thread(enqueOperators[i]);
    producers.add(t);
    t.start();
  }
  for (int i=0; i < threadCount; i++) {
    dequeAllOperators[i]=new ActionQueueOperation(aq,hosts,ActionQueueOperation.OpType.DEQUEUEALL);
    Thread t=new Thread(dequeAllOperators[i]);
    consumers.add(t);
    t.start();
  }
  Thread.sleep(100);
  for (int i=0; i < threadCount; i++) {
    enqueOperators[i].stop();
  }
  for (  Thread producer : producers) {
    producer.join();
  }
  boolean allDequeued=false;
  while (!allDequeued) {
    Thread.sleep(10);
    allDequeued=true;
    for (    String host : hosts) {
      if (aq.size(host) > 0) {
        allDequeued=false;
        break;
      }
    }
  }
  for (int i=0; i < threadCount; i++) {
    dequeOperators[i].stop();
    dequeAllOperators[i].stop();
  }
  for (  Thread consumer : consumers) {
    consumer.join();
  }
  for (int h=0; h < hosts.length; h++) {
    long opsEnqueued=0;
    long opsDequeued=0;
    for (int i=0; i < threadCount; i++) {
      opsEnqueued+=enqueOperators[i].getOpCounts()[h];
      opsDequeued+=dequeOperators[i].getOpCounts()[h];
      opsDequeued+=dequeAllOperators[i].getOpCounts()[h];
    }
    assertTrue(opsEnqueued != 0);
    assertEquals(0,aq.size(hosts[h]));
    LOG.info("Host: " + hosts[h] + ", opsEnqueued: "+ opsEnqueued+ ", opsDequeued: "+ opsDequeued);
    assertEquals(opsDequeued,opsEnqueued);
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testConcurrentHostCheck() throws InterruptedException {
  ActionQueue aq=new ActionQueue();
  String[] hosts=new String[]{"h0","h1","h2","h3","h4"};
  ActionQueueOperation[] hostCheckers=new ActionQueueOperation[threadCount];
  ActionQueueOperation[] hostUpdaters=new ActionQueueOperation[threadCount];
  List<Thread> producers=new ArrayList<Thread>();
  List<Thread> consumers=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    hostCheckers[i]=new ActionQueueOperation(aq,hosts,ActionQueueOperation.OpType.CHECKPENDING);
    Thread t=new Thread(hostCheckers[i]);
    consumers.add(t);
    t.start();
  }
  for (int i=0; i < threadCount; i++) {
    hostUpdaters[i]=new ActionQueueOperation(aq,hosts,ActionQueueOperation.OpType.UPDATEHOSTLIST);
    Thread t=new Thread(hostUpdaters[i]);
    producers.add(t);
    t.start();
  }
  Thread.sleep(100);
  for (int i=0; i < threadCount; i++) {
    hostUpdaters[i].stop();
  }
  for (  Thread producer : producers) {
    producer.join();
  }
  for (int i=0; i < threadCount; i++) {
    hostCheckers[i].stop();
  }
  for (  Thread consumer : consumers) {
    consumer.join();
  }
  int totalChecks=0;
  int totalUpdates=0;
  for (int i=0; i < threadCount; i++) {
    totalChecks+=hostUpdaters[i].getOpCounts()[0];
    for (int h=0; h < hosts.length; h++) {
      totalUpdates+=hostCheckers[i].getOpCounts()[h];
    }
  }
  LOG.info("Report: totalChecks: " + totalChecks + ", totalUpdates: "+ totalUpdates);
  HashSet<String> hostsWithPendingtasks=new HashSet<String>();
  aq.updateListOfHostsWithPendingTask(hostsWithPendingtasks);
  hostsWithPendingtasks.add("h1");
  aq.updateListOfHostsWithPendingTask(hostsWithPendingtasks);
  assertTrue(aq.hasPendingTask("h1"));
  assertFalse(aq.hasPendingTask("h2"));
  hostsWithPendingtasks.add("h1");
  hostsWithPendingtasks.add("h2");
  aq.updateListOfHostsWithPendingTask(hostsWithPendingtasks);
  assertTrue(aq.hasPendingTask("h1"));
  assertTrue(aq.hasPendingTask("h2"));
  hostsWithPendingtasks.clear();
  hostsWithPendingtasks.add("h2");
  aq.updateListOfHostsWithPendingTask(hostsWithPendingtasks);
  assertFalse(aq.hasPendingTask("h1"));
  assertTrue(aq.hasPendingTask("h2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatHandler </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRegistrationAgentConfig() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setCurrentPingPort(DummyCurrentPingPort);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  reg.setPrefix(Configuration.PREFIX_DIR);
  RegistrationResponse rr=handler.handleRegistration(reg);
  Map<String,String> config=rr.getAgentConfig();
  assertFalse(config.isEmpty());
  assertTrue(config.containsKey(Configuration.CHECK_REMOTE_MOUNTS_KEY));
  assertTrue("false".equals(config.get(Configuration.CHECK_REMOTE_MOUNTS_KEY)));
  assertTrue(config.containsKey(Configuration.CHECK_MOUNTS_TIMEOUT_KEY));
  assertTrue("0".equals(config.get(Configuration.CHECK_MOUNTS_TIMEOUT_KEY)));
  assertTrue("true".equals(config.get(Configuration.ENABLE_AUTO_AGENT_CACHE_UPDATE_KEY)));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterNewNode() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  fsm.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS("redhat5");
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  reg.setPrefix(Configuration.PREFIX_DIR);
  RegistrationResponse response=handler.handleRegistration(reg);
  assertEquals(hostObject.getState(),HostState.HEALTHY);
  assertEquals("redhat5",hostObject.getOsType());
  assertEquals(RegistrationStatus.OK,response.getResponseStatus());
  assertEquals(0,response.getResponseId());
  assertEquals(reg.getPrefix(),hostObject.getPrefix());
  assertTrue(response.getStatusCommands().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegistrationPublicHostname() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setPublicHostname(DummyHostname1 + "-public");
  reg.setAgentVersion(metaInfo.getServerVersion());
  handler.handleRegistration(reg);
  assertEquals(hostObject.getState(),HostState.HEALTHY);
  assertEquals(DummyOsType,hostObject.getOsType());
  assertTrue(hostObject.getLastRegistrationTime() != 0);
  assertEquals(hostObject.getLastHeartbeatTime(),hostObject.getLastRegistrationTime());
  Host verifyHost=clusters.getHost(DummyHostname1);
  assertEquals(verifyHost.getPublicHostName(),reg.getPublicHostname());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectKeytabApplicableHost() throws Exception {
  List<Map<String,String>> kcp;
  Map<String,String> properties;
  kcp=testInjectKeytabSetKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertEquals("hdfs",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertEquals("r",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertEquals("hadoop",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertEquals("",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertEquals(Base64.encodeBase64String("hello".getBytes()),kcp.get(0).get(KerberosServerAction.KEYTAB_CONTENT_BASE64));
  kcp=testInjectKeytabRemoveKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosServerAction.KEYTAB_CONTENT_BASE64));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testHeartbeatCustomStartStop() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.getServiceComponent(NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(SECONDARY_NAMENODE).persist();
  hdfs.getServiceComponent(SECONDARY_NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  ActionQueue aq=new ActionQueue();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  ServiceComponentHost serviceComponentHost2=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(NAMENODE).getServiceComponentHost(DummyHostname1);
  serviceComponentHost1.setState(State.INSTALLED);
  serviceComponentHost2.setState(State.STARTED);
  serviceComponentHost1.setRestartRequired(true);
  serviceComponentHost2.setRestartRequired(true);
  HeartBeat hb=new HeartBeat();
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setServiceName(HDFS);
  cr.setRoleCommand("CUSTOM_COMMAND");
  cr.setCustomCommand("START");
  cr.setTaskId(1);
  cr.setRole(DATANODE);
  cr.setStatus("COMPLETED");
  cr.setStdErr("");
  cr.setStdOut("");
  cr.setExitCode(215);
  cr.setClusterName(DummyCluster);
  CommandReport crn=new CommandReport();
  crn.setActionId(StageUtils.getActionId(requestId,stageId));
  crn.setServiceName(HDFS);
  crn.setRoleCommand("CUSTOM_COMMAND");
  crn.setCustomCommand("STOP");
  crn.setTaskId(1);
  crn.setRole(NAMENODE);
  crn.setStatus("COMPLETED");
  crn.setStdErr("");
  crn.setStdOut("");
  crn.setExitCode(215);
  crn.setClusterName(DummyCluster);
  reports.add(cr);
  reports.add(crn);
  hb.setReports(reports);
  assertTrue(serviceComponentHost1.isRestartRequired());
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  State componentState1=serviceComponentHost1.getState();
  assertEquals(State.STARTED,componentState1);
  assertFalse(serviceComponentHost1.isRestartRequired());
  State componentState2=serviceComponentHost2.getState();
  assertEquals(State.INSTALLED,componentState2);
  assertTrue(serviceComponentHost2.isRestartRequired());
}

</code></pre>

<br>
<pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectKeytabNotApplicableHost() throws Exception {
  List<Map<String,String>> kcp;
  kcp=testInjectKeytabSetKeytab("c6401.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertTrue(kcp.isEmpty());
  kcp=testInjectKeytabRemoveKeytab("c6401.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertTrue(kcp.isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testStatusHeartbeatWithVersion() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.getServiceComponent(NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(HDFS_CLIENT).persist();
  hdfs.getServiceComponent(HDFS_CLIENT).addServiceComponentHost(DummyHostname1).persist();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  ServiceComponentHost serviceComponentHost2=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(NAMENODE).getServiceComponentHost(DummyHostname1);
  ServiceComponentHost serviceComponentHost3=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(HDFS_CLIENT).getServiceComponentHost(DummyHostname1);
  StackId stack130=new StackId("HDP-1.3.0");
  StackId stack120=new StackId("HDP-1.2.0");
  serviceComponentHost1.setState(State.INSTALLED);
  serviceComponentHost2.setState(State.STARTED);
  serviceComponentHost3.setState(State.STARTED);
  serviceComponentHost1.setStackVersion(stack130);
  serviceComponentHost2.setStackVersion(stack120);
  serviceComponentHost3.setStackVersion(stack120);
  HeartBeat hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(0);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(new ArrayList<CommandReport>());
  hb.setAgentEnv(new AgentEnv());
  hb.setMounts(new ArrayList<DiskInfo>());
  ArrayList<ComponentStatus> componentStatuses=new ArrayList<ComponentStatus>();
  ComponentStatus componentStatus1=createComponentStatus(DummyCluster,HDFS,DummyHostStatus,State.STARTED,SecurityState.UNSECURED,DATANODE,"{\"stackName\":\"HDP\",\"stackVersion\":\"1.3.0\"}");
  ComponentStatus componentStatus2=createComponentStatus(DummyCluster,HDFS,DummyHostStatus,State.STARTED,SecurityState.UNSECURED,NAMENODE,"");
  ComponentStatus componentStatus3=createComponentStatus(DummyCluster,HDFS,DummyHostStatus,State.INSTALLED,SecurityState.UNSECURED,HDFS_CLIENT,"{\"stackName\":\"HDP\",\"stackVersion\":\"1.3.0\"}");
  componentStatuses.add(componentStatus1);
  componentStatuses.add(componentStatus2);
  componentStatuses.add(componentStatus3);
  hb.setComponentStatus(componentStatuses);
  ActionQueue aq=new ActionQueue();
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  assertEquals("Matching value " + serviceComponentHost1.getStackVersion(),stack130,serviceComponentHost1.getStackVersion());
  assertEquals("Matching value " + serviceComponentHost2.getStackVersion(),stack120,serviceComponentHost2.getStackVersion());
  assertEquals("Matching value " + serviceComponentHost3.getStackVersion(),stack130,serviceComponentHost3.getStackVersion());
  assertTrue(hb.getAgentEnv().getHostHealth().getServerTimeStampAtReporting() >= hb.getTimestamp());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test @SuppressWarnings("unchecked") public void testStatusHeartbeatWithAnnotation() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.addServiceComponent(SECONDARY_NAMENODE).persist();
  ActionQueue aq=new ActionQueue();
  HeartBeat hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(0);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(new ArrayList<CommandReport>());
  ArrayList<ComponentStatus> componentStatuses=new ArrayList<ComponentStatus>();
  hb.setComponentStatus(componentStatuses);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
    }
  }
).anyTimes();
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  HeartBeatResponse resp=handler.handleHeartBeat(hb);
  Assert.assertFalse(resp.hasMappedComponents());
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  serviceComponentHost1.setState(State.INIT);
  hb=new HeartBeat();
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(1);
  hb.setHostname(DummyHostname1);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setReports(new ArrayList<CommandReport>());
  hb.setComponentStatus(componentStatuses);
  resp=handler.handleHeartBeat(hb);
  Assert.assertTrue(resp.hasMappedComponents());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestId() throws IOException, InvalidStateTransitionException, JsonGenerationException, JAXBException {
  HeartBeatHandler heartBeatHandler=injector.getInstance(HeartBeatHandler.class);
  Register register=new Register();
  register.setHostname("newHost");
  register.setTimestamp(new Date().getTime());
  register.setResponseId(123);
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS("redhat5");
  register.setHardwareProfile(hi);
  register.setAgentVersion(metaInfo.getServerVersion());
  RegistrationResponse registrationResponse=heartBeatHandler.handleRegistration(register);
  assertEquals("ResponseId should start from zero",0L,registrationResponse.getResponseId());
  HeartBeat heartBeat=constructHeartBeat("newHost",registrationResponse.getResponseId(),Status.HEALTHY);
  HeartBeatResponse hbResponse=heartBeatHandler.handleHeartBeat(heartBeat);
  assertEquals("responseId was not incremented",1L,hbResponse.getResponseId());
  assertTrue("Not cached response returned",hbResponse == heartBeatHandler.handleHeartBeat(heartBeat));
  heartBeat.setResponseId(1L);
  hbResponse=heartBeatHandler.handleHeartBeat(heartBeat);
  assertEquals("responseId was not incremented",2L,hbResponse.getResponseId());
  assertFalse("Agent is flagged for restart",hbResponse.isRestartAgent());
  log.debug(StageUtils.jaxbToString(hbResponse));
  heartBeat.setResponseId(20L);
  hbResponse=heartBeatHandler.handleHeartBeat(heartBeat);
  assertTrue("Agent is not flagged for restart",hbResponse.isRestartAgent());
  log.debug(StageUtils.jaxbToString(hbResponse));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegistrationWithBadVersion() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion("");
  reg.setPrefix(Configuration.PREFIX_DIR);
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non compatible agent version");
  }
 catch (  AmbariException e) {
    log.debug("Error:" + e.getMessage());
    Assert.assertTrue(e.getMessage().contains("Cannot register host with non compatible agent version"));
  }
  reg.setAgentVersion(null);
  try {
    handler.handleRegistration(reg);
    fail("Expected failure for non compatible agent version");
  }
 catch (  AmbariException e) {
    log.debug("Error:" + e.getMessage());
    Assert.assertTrue(e.getMessage().contains("Cannot register host with non compatible agent version"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testStateCommandsAtRegistration() throws AmbariException, InvalidStateTransitionException {
  List<StatusCommand> dummyCmds=new ArrayList<StatusCommand>();
  StatusCommand statusCmd1=new StatusCommand();
  statusCmd1.setClusterName(DummyCluster);
  statusCmd1.setServiceName(HDFS);
  dummyCmds.add(statusCmd1);
  HeartbeatMonitor hm=mock(HeartbeatMonitor.class);
  when(hm.generateStatusCommands(anyString())).thenReturn(dummyCmds);
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  ActionQueue actionQueue=new ActionQueue();
  HeartBeatHandler handler=new HeartBeatHandler(fsm,actionQueue,am,injector);
  handler.setHeartbeatMonitor(hm);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  RegistrationResponse registrationResponse=handler.handleRegistration(reg);
  registrationResponse.getStatusCommands();
  assertTrue(registrationResponse.getStatusCommands().size() == 1);
  assertTrue(registrationResponse.getStatusCommands().get(0).equals(statusCmd1));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRestartRequiredAfterInstallClient() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(HDFS_CLIENT).persist();
  hdfs.getServiceComponent(HDFS_CLIENT).addServiceComponentHost(DummyHostname1).persist();
  ActionQueue aq=new ActionQueue();
  ServiceComponentHost serviceComponentHost=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(HDFS_CLIENT).getServiceComponentHost(DummyHostname1);
  serviceComponentHost.setState(State.INSTALLED);
  serviceComponentHost.setRestartRequired(true);
  HeartBeat hb=new HeartBeat();
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setServiceName(HDFS);
  cr.setRoleCommand("INSTALL");
  cr.setCustomCommand("EXECUTION_COMMAND");
  cr.setTaskId(1);
  cr.setRole(HDFS_CLIENT);
  cr.setStatus("COMPLETED");
  cr.setStdErr("");
  cr.setStdOut("");
  cr.setExitCode(215);
  cr.setClusterName(DummyCluster);
  cr.setConfigurationTags(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  reports.add(cr);
  hb.setReports(reports);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  Assert.assertNotNull(serviceComponentHost.getActualConfigs());
  Assert.assertFalse(serviceComponentHost.isRestartRequired());
  Assert.assertEquals(serviceComponentHost.getActualConfigs().size(),1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegistration() throws AmbariException, InvalidStateTransitionException {
  ActionManager am=getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  HeartBeatHandler handler=new HeartBeatHandler(fsm,new ActionQueue(),am,injector);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setCurrentPingPort(DummyCurrentPingPort);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  reg.setPrefix(Configuration.PREFIX_DIR);
  handler.handleRegistration(reg);
  assertEquals(hostObject.getState(),HostState.HEALTHY);
  assertEquals(DummyOsType,hostObject.getOsType());
  assertEquals(DummyCurrentPingPort,hostObject.getCurrentPingPort());
  assertTrue(hostObject.getLastRegistrationTime() != 0);
  assertEquals(hostObject.getLastHeartbeatTime(),hostObject.getLastRegistrationTime());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatMonitor </h4><pre class="type-12 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeatStateCommandsEnqueueing() throws AmbariException, InterruptedException, InvalidStateTransitionException {
  StackId stackId=new StackId("HDP-0.1");
  Clusters clusters=injector.getInstance(Clusters.class);
  clusters.addHost(hostname1);
  setOsFamily(clusters.getHost(hostname1),"redhat","5.9");
  clusters.getHost(hostname1).persist();
  clusters.addCluster(clusterName,stackId);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Set<String> hostNames=new HashSet<String>(){
{
      add(hostname1);
    }
  }
;
  clusters.mapHostsToCluster(hostNames,clusterName);
  Service hdfs=cluster.addService(serviceName);
  hdfs.persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.SECONDARY_NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  ActionQueue aqMock=mock(ActionQueue.class);
  ArgumentCaptor<AgentCommand> commandCaptor=ArgumentCaptor.forClass(AgentCommand.class);
  ActionManager am=mock(ActionManager.class);
  HeartbeatMonitor hm=new HeartbeatMonitor(clusters,aqMock,am,heartbeatMonitorWakeupIntervalMS,injector);
  HeartBeatHandler handler=new HeartBeatHandler(clusters,aqMock,am,injector);
  Register reg=new Register();
  reg.setHostname(hostname1);
  reg.setResponseId(12);
  reg.setTimestamp(System.currentTimeMillis() - 15);
  reg.setAgentVersion(ambariMetaInfo.getServerVersion());
  HostInfo hi=new HostInfo();
  hi.setOS("Centos5");
  reg.setHardwareProfile(hi);
  handler.handleRegistration(reg);
  HeartBeat hb=new HeartBeat();
  hb.setHostname(hostname1);
  hb.setNodeStatus(new HostStatus(HostStatus.Status.HEALTHY,"cool"));
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(13);
  handler.handleHeartBeat(hb);
  LOG.info("YYY");
  clusters.getHost(hostname1).setLastHeartbeatTime(System.currentTimeMillis() - 15);
  hm.start();
  Thread.sleep(3 * heartbeatMonitorWakeupIntervalMS);
  hm.shutdown();
  int tryNumber=0;
  while (hm.isAlive()) {
    hm.join(2 * heartbeatMonitorWakeupIntervalMS);
    tryNumber++;
    if (tryNumber >= 5) {
      fail("HeartbeatMonitor should be already stopped");
    }
  }
  verify(aqMock,atLeast(2)).enqueue(eq(hostname1),commandCaptor.capture());
  List<AgentCommand> cmds=commandCaptor.getAllValues();
  assertTrue("HeartbeatMonitor should generate StatusCommands for host1",cmds.size() >= 2);
  for (  AgentCommand command : cmds) {
    assertEquals("HDFS",((StatusCommand)command).getServiceName());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateCommandsGeneration() throws AmbariException, InterruptedException, InvalidStateTransitionException {
  StackId stackId=new StackId("HDP-0.1");
  Clusters clusters=injector.getInstance(Clusters.class);
  clusters.addHost(hostname1);
  setOsFamily(clusters.getHost(hostname1),"redhat","6.3");
  clusters.getHost(hostname1).persist();
  clusters.addHost(hostname2);
  setOsFamily(clusters.getHost(hostname2),"redhat","6.3");
  clusters.getHost(hostname2).persist();
  clusters.addCluster(clusterName,stackId);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Set<String> hostNames=new HashSet<String>(){
{
      add(hostname1);
      add(hostname2);
    }
  }
;
  ConfigFactory configFactory=injector.getInstance(ConfigFactory.class);
  Config config=configFactory.createNew(cluster,"hadoop-env",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version1");
  cluster.addConfig(config);
  cluster.addDesiredConfig("_test",Collections.singleton(config));
  clusters.mapHostsToCluster(hostNames,clusterName);
  Service hdfs=cluster.addService(serviceName);
  hdfs.persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.SECONDARY_NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  ActionQueue aq=new ActionQueue();
  ActionManager am=mock(ActionManager.class);
  HeartbeatMonitor hm=new HeartbeatMonitor(clusters,aq,am,heartbeatMonitorWakeupIntervalMS,injector);
  HeartBeatHandler handler=new HeartBeatHandler(clusters,aq,am,injector);
  Register reg=new Register();
  reg.setHostname(hostname1);
  reg.setResponseId(12);
  reg.setTimestamp(System.currentTimeMillis() - 300);
  reg.setAgentVersion(ambariMetaInfo.getServerVersion());
  HostInfo hi=new HostInfo();
  hi.setOS("Centos5");
  reg.setHardwareProfile(hi);
  handler.handleRegistration(reg);
  HeartBeat hb=new HeartBeat();
  hb.setHostname(hostname1);
  hb.setNodeStatus(new HostStatus(HostStatus.Status.HEALTHY,"cool"));
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(12);
  handler.handleHeartBeat(hb);
  List<StatusCommand> cmds=hm.generateStatusCommands(hostname1);
  assertTrue("HeartbeatMonitor should generate StatusCommands for host1",cmds.size() == 3);
  assertEquals("HDFS",cmds.get(0).getServiceName());
  boolean containsDATANODEStatus=false;
  boolean containsNAMENODEStatus=false;
  boolean containsSECONDARY_NAMENODEStatus=false;
  for (  StatusCommand cmd : cmds) {
    containsDATANODEStatus|=cmd.getComponentName().equals("DATANODE");
    containsNAMENODEStatus|=cmd.getComponentName().equals("NAMENODE");
    containsSECONDARY_NAMENODEStatus|=cmd.getComponentName().equals("SECONDARY_NAMENODE");
    assertTrue(cmd.getConfigurations().size() > 0);
  }
  assertEquals(true,containsDATANODEStatus);
  assertEquals(true,containsNAMENODEStatus);
  assertEquals(true,containsSECONDARY_NAMENODEStatus);
  cmds=hm.generateStatusCommands(hostname2);
  assertTrue("HeartbeatMonitor should not generate StatusCommands for host2 because it has no services",cmds.isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatusCommandForAnyComponents() throws Exception {
  StackId stackId=new StackId("HDP-0.1");
  Clusters clusters=injector.getInstance(Clusters.class);
  clusters.addHost(hostname1);
  setOsFamily(clusters.getHost(hostname1),"redhat","6.3");
  clusters.getHost(hostname1).persist();
  clusters.addHost(hostname2);
  setOsFamily(clusters.getHost(hostname2),"redhat","6.3");
  clusters.getHost(hostname2).persist();
  clusters.addCluster(clusterName,stackId);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Set<String> hostNames=new HashSet<String>(){
{
      add(hostname1);
      add(hostname2);
    }
  }
;
  ConfigFactory configFactory=injector.getInstance(ConfigFactory.class);
  Config config=configFactory.createNew(cluster,"hadoop-env",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version1");
  cluster.addConfig(config);
  cluster.addDesiredConfig("_test",Collections.singleton(config));
  clusters.mapHostsToCluster(hostNames,clusterName);
  Service hdfs=cluster.addService(serviceName);
  hdfs.persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.SECONDARY_NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost(hostname1).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost(hostname2).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).getServiceComponentHost(hostname2).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setDesiredState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setDesiredState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setDesiredState(State.INSTALLED);
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).getServiceComponentHost(hostname1).setDesiredState(State.INSTALLED);
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).getServiceComponentHost(hostname2).setDesiredState(State.INSTALLED);
  ActionQueue aq=new ActionQueue();
  ActionManager am=mock(ActionManager.class);
  HeartbeatMonitor hm=new HeartbeatMonitor(clusters,aq,am,heartbeatMonitorWakeupIntervalMS,injector);
  HeartBeatHandler handler=new HeartBeatHandler(clusters,aq,am,injector);
  Register reg=new Register();
  reg.setHostname(hostname1);
  reg.setResponseId(12);
  reg.setTimestamp(System.currentTimeMillis() - 300);
  reg.setAgentVersion(ambariMetaInfo.getServerVersion());
  HostInfo hi=new HostInfo();
  hi.setOS("Centos5");
  reg.setHardwareProfile(hi);
  handler.handleRegistration(reg);
  HeartBeat hb=new HeartBeat();
  hb.setHostname(hostname1);
  hb.setNodeStatus(new HostStatus(HostStatus.Status.HEALTHY,"cool"));
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(12);
  handler.handleHeartBeat(hb);
  List<StatusCommand> cmds=hm.generateStatusCommands(hostname1);
  assertTrue("HeartbeatMonitor should generate StatusCommands for host1",cmds.size() == 4);
  assertEquals("HDFS",cmds.get(0).getServiceName());
  boolean containsDATANODEStatus=false;
  boolean containsNAMENODEStatus=false;
  boolean containsSECONDARY_NAMENODEStatus=false;
  boolean containsHDFS_CLIENTStatus=false;
  for (  StatusCommand cmd : cmds) {
    containsDATANODEStatus|=cmd.getComponentName().equals("DATANODE");
    containsNAMENODEStatus|=cmd.getComponentName().equals("NAMENODE");
    containsSECONDARY_NAMENODEStatus|=cmd.getComponentName().equals("SECONDARY_NAMENODE");
    containsHDFS_CLIENTStatus|=cmd.getComponentName().equals("HDFS_CLIENT");
    assertTrue(cmd.getConfigurations().size() > 0);
    assertEquals(State.INSTALLED,cmd.getDesiredState());
    assertEquals(false,cmd.getHasStaleConfigs());
  }
  assertTrue(containsDATANODEStatus);
  assertTrue(containsNAMENODEStatus);
  assertTrue(containsSECONDARY_NAMENODEStatus);
  assertTrue(containsHDFS_CLIENTStatus);
  cmds=hm.generateStatusCommands(hostname2);
  assertTrue("HeartbeatMonitor should generate StatusCommands for host2, " + "even if it has only client components",cmds.size() == 1);
  assertTrue(cmds.get(0).getComponentName().equals(Role.HDFS_CLIENT.name()));
  assertEquals(hostname2,cmds.get(0).getHostname());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateCommandsWithAlertsGeneration() throws AmbariException, InterruptedException, InvalidStateTransitionException {
  StackId stackId=new StackId("HDP-2.0.7");
  Clusters clusters=injector.getInstance(Clusters.class);
  clusters.addHost(hostname1);
  setOsFamily(clusters.getHost(hostname1),"redhat","6.3");
  clusters.getHost(hostname1).persist();
  clusters.addHost(hostname2);
  setOsFamily(clusters.getHost(hostname2),"redhat","6.3");
  clusters.getHost(hostname2).persist();
  clusters.addCluster(clusterName,stackId);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Set<String> hostNames=new HashSet<String>(){
{
      add(hostname1);
      add(hostname2);
    }
  }
;
  clusters.mapHostsToCluster(hostNames,clusterName);
  Service hdfs=cluster.addService(serviceName);
  hdfs.persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.addServiceComponent(Role.SECONDARY_NAMENODE.name()).persist();
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).addServiceComponentHost(hostname1).persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  hdfs.getServiceComponent(Role.SECONDARY_NAMENODE.name()).getServiceComponentHost(hostname1).setState(State.INSTALLED);
  ActionQueue aq=new ActionQueue();
  ActionManager am=mock(ActionManager.class);
  HeartbeatMonitor hm=new HeartbeatMonitor(clusters,aq,am,heartbeatMonitorWakeupIntervalMS,injector);
  HeartBeatHandler handler=new HeartBeatHandler(clusters,aq,am,injector);
  Register reg=new Register();
  reg.setHostname(hostname1);
  reg.setResponseId(12);
  reg.setTimestamp(System.currentTimeMillis() - 300);
  reg.setAgentVersion(ambariMetaInfo.getServerVersion());
  HostInfo hi=new HostInfo();
  hi.setOS("Centos5");
  reg.setHardwareProfile(hi);
  handler.handleRegistration(reg);
  HeartBeat hb=new HeartBeat();
  hb.setHostname(hostname1);
  hb.setNodeStatus(new HostStatus(HostStatus.Status.HEALTHY,"cool"));
  hb.setTimestamp(System.currentTimeMillis());
  hb.setResponseId(12);
  handler.handleHeartBeat(hb);
  List<StatusCommand> cmds=hm.generateStatusCommands(hostname1);
  assertEquals("HeartbeatMonitor should generate StatusCommands for host1",3,cmds.size());
  assertEquals("HDFS",cmds.get(0).getServiceName());
  cmds=hm.generateStatusCommands(hostname2);
  assertTrue("HeartbeatMonitor should not generate StatusCommands for host2 because it has no services",cmds.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.QueryCreateHandlerTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest() throws Exception {
  final String BODY_STRING="Body string";
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resourceInstance=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  ResourceInstanceFactory resourceInstanceFactory=createNiceMock(ResourceInstanceFactory.class);
  Query query=createNiceMock(Query.class);
  Predicate predicate=createNiceMock(Predicate.class);
  Result result=createNiceMock(Result.class);
  ResourceInstance subResource=createNiceMock(ResourceInstance.class);
  ResourceDefinition subResourceDefinition=createNiceMock(ResourceDefinition.class);
  ClusterController controller=createNiceMock(ClusterController.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  String resourceKeyProperty="resourceKeyProperty";
  String createKeyProperty="createKeyProperty";
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  PersistenceManager pm=createNiceMock(PersistenceManager.class);
  ResourceInstance createResource=createNiceMock(ResourceInstance.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource statusResource1=createNiceMock(Resource.class);
  Resource statusResource2=createNiceMock(Resource.class);
  RequestHandler readHandler=createStrictMock(RequestHandler.class);
  ResultStatus resultStatus=createNiceMock(ResultStatus.class);
  Capture<RequestBody> bodyCapture=new Capture<RequestBody>();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  Set<NamedPropertySet> setRequestProps=new HashSet<NamedPropertySet>();
  Map<String,Object> mapProperties=new HashMap<String,Object>();
  Set<Map<String,Object>> arraySet=new HashSet<Map<String,Object>>();
  mapProperties.put("components",arraySet);
  Map<String,Object> map=new HashMap<String,Object>();
  map.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"SECONDARY_NAMENODE");
  arraySet.add(map);
  map=new HashMap<String,Object>();
  map.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"HDFS_CLIENT");
  arraySet.add(map);
  setRequestProps.add(new NamedPropertySet("",mapProperties));
  Set<Map<String,Object>> setCreateProps=new HashSet<Map<String,Object>>();
  Map<String,Object> map1=new HashMap<String,Object>();
  map1.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"SECONDARY_NAMENODE");
  map1.put(createKeyProperty,"id1");
  setCreateProps.add(map1);
  Map<String,Object> map2=new HashMap<String,Object>();
  map2.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"SECONDARY_NAMENODE");
  map2.put(createKeyProperty,"id2");
  setCreateProps.add(map2);
  Map<String,Object> map3=new HashMap<String,Object>();
  map3.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"HDFS_CLIENT");
  map3.put(createKeyProperty,"id1");
  setCreateProps.add(map3);
  Map<String,Object> map4=new HashMap<String,Object>();
  map4.put(PropertyHelper.getPropertyId("ServiceComponentInfo","component_name"),"HDFS_CLIENT");
  map4.put(createKeyProperty,"id2");
  setCreateProps.add(map4);
  Map<String,ResourceInstance> mapSubResources=new HashMap<String,ResourceInstance>();
  mapSubResources.put("components",subResource);
  TreeNode<Resource> resultTree=new TreeNodeImpl<Resource>(null,null,"result");
  resultTree.addChild(resource1,"resource1");
  resultTree.addChild(resource2,"resource2");
  Set<Resource> setStatusResources=new HashSet<Resource>();
  setStatusResources.add(statusResource1);
  setStatusResources.add(statusResource2);
  expect(readHandler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false);
  expect(result.getResultTree()).andReturn(resultTree);
  expect(body.getBody()).andReturn(BODY_STRING).anyTimes();
  expect(request.getResource()).andReturn(resourceInstance).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(body.getNamedPropertySets()).andReturn(setRequestProps).anyTimes();
  expect(resourceInstance.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceInstance.getKeyValueMap()).andReturn(mapIds).anyTimes();
  expect(resourceInstance.getSubResources()).andReturn(mapSubResources).anyTimes();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Service).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(subResource.getResourceDefinition()).andReturn(subResourceDefinition).anyTimes();
  expect(subResourceDefinition.getType()).andReturn(Resource.Type.Component).anyTimes();
  expect(controller.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(controller.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn(resourceKeyProperty).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Service)).andReturn(createKeyProperty).anyTimes();
  expect(result.getResultTree()).andReturn(resultTree).anyTimes();
  expect(resource1.getPropertyValue(resourceKeyProperty)).andReturn("id1").anyTimes();
  expect(resource2.getPropertyValue(resourceKeyProperty)).andReturn("id2").anyTimes();
  expect(resourceInstanceFactory.createResource(Resource.Type.Component,mapIds)).andReturn(createResource).anyTimes();
  expect(createResource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(pm.create(same(createResource),capture(bodyCapture))).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete).anyTimes();
  expect(status.getAssociatedResources()).andReturn(setStatusResources).anyTimes();
  expect(statusResource1.getType()).andReturn(Resource.Type.Component).anyTimes();
  expect(statusResource2.getType()).andReturn(Resource.Type.Component).anyTimes();
  replay(request,body,resourceInstance,resourceDefinition,query,predicate,result,subResource,subResourceDefinition,controller,serviceSchema,componentSchema,resource1,resource2,pm,resourceInstanceFactory,createResource,status,statusResource1,statusResource2,readHandler,resultStatus);
  Result testResult=new TestQueryCreateHandler(resourceInstanceFactory,controller,pm,readHandler).handleRequest(request);
  Collection<TreeNode<Resource>> children=testResult.getResultTree().getChild("resources").getChildren();
  assertEquals(2,children.size());
  boolean containsStatusResource1=false;
  boolean containsStatusResource2=false;
  for (  TreeNode<Resource> child : children) {
    Resource r=child.getObject();
    if (r == statusResource1) {
      containsStatusResource1=true;
    }
 else     if (r == statusResource2) {
      containsStatusResource2=true;
    }
  }
  assertTrue(containsStatusResource1);
  assertTrue(containsStatusResource2);
  assertEquals(ResultStatus.STATUS.CREATED,testResult.getStatus().getStatus());
  RequestBody createBody=bodyCapture.getValue();
  assertEquals(BODY_STRING,createBody.getBody());
  assertEquals(4,createBody.getPropertySets().size());
  assertEquals(setCreateProps,createBody.getPropertySets());
  verify(request,body,resourceInstance,resourceDefinition,query,predicate,result,subResource,subResourceDefinition,controller,serviceSchema,componentSchema,resource1,resource2,pm,resourceInstanceFactory,createResource,status,statusResource1,statusResource2,readHandler,resultStatus);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.ExtendedResourcePredicateVisitorTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetExtendedPredicate() throws Exception {
  Resource resource1=new ResourceImpl(Resource.Type.Service);
  resource1.setProperty("name","service1");
  Resource resource2=new ResourceImpl(Resource.Type.Service);
  resource2.setProperty("name","service2");
  Map<String,Object> resource1SubProperties1=new HashMap<String,Object>();
  resource1SubProperties1.put("sub1/category/p1",1);
  resource1SubProperties1.put("sub1/category/p2",2);
  resource1SubProperties1.put("sub1/category/p3",3);
  Map<String,Object> resource1SubProperties2=new HashMap<String,Object>();
  resource1SubProperties2.put("sub1/category/p1",1);
  resource1SubProperties2.put("sub1/category/p2",4);
  resource1SubProperties2.put("sub1/category/p3",6);
  Map<String,Object> resource1SubProperties3=new HashMap<String,Object>();
  resource1SubProperties3.put("sub1/category/p1",1);
  resource1SubProperties3.put("sub1/category/p2",8);
  resource1SubProperties3.put("sub1/category/p3",12);
  Set<Map<String,Object>> resource1SubPropertiesSet=new HashSet<Map<String,Object>>();
  resource1SubPropertiesSet.add(resource1SubProperties1);
  resource1SubPropertiesSet.add(resource1SubProperties2);
  resource1SubPropertiesSet.add(resource1SubProperties3);
  Map<String,Object> resource2SubProperties1=new HashMap<String,Object>();
  resource2SubProperties1.put("sub1/category/p1",2);
  resource2SubProperties1.put("sub1/category/p2",2);
  resource2SubProperties1.put("sub1/category/p3",3);
  Map<String,Object> resource2SubProperties2=new HashMap<String,Object>();
  resource2SubProperties2.put("sub1/category/p1",2);
  resource2SubProperties2.put("sub1/category/p2",4);
  resource2SubProperties2.put("sub1/category/p3",6);
  Map<String,Object> resource2SubProperties3=new HashMap<String,Object>();
  resource2SubProperties3.put("sub1/category/p1",2);
  resource2SubProperties3.put("sub1/category/p2",8);
  resource2SubProperties3.put("sub1/category/p3",12);
  Set<Map<String,Object>> resource2SubPropertiesSet=new HashSet<Map<String,Object>>();
  resource2SubPropertiesSet.add(resource2SubProperties1);
  resource2SubPropertiesSet.add(resource2SubProperties2);
  resource2SubPropertiesSet.add(resource2SubProperties3);
  Map<Resource,Set<Map<String,Object>>> extendedPropertyMap=new HashMap<Resource,Set<Map<String,Object>>>();
  extendedPropertyMap.put(resource1,resource1SubPropertiesSet);
  extendedPropertyMap.put(resource2,resource2SubPropertiesSet);
  Predicate predicate=new PredicateBuilder().property("sub1/category/p1").equals(1).toPredicate();
  ExtendedResourcePredicateVisitor visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  Predicate extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertTrue(extendedPredicate.evaluate(resource1));
  Assert.assertFalse(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().property("sub1/category/p1").equals(2).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertFalse(extendedPredicate.evaluate(resource1));
  Assert.assertTrue(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().property("sub1/category/p2").equals(4).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertTrue(extendedPredicate.evaluate(resource1));
  Assert.assertTrue(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().property("sub1/category/p2").equals(5).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertFalse(extendedPredicate.evaluate(resource1));
  Assert.assertFalse(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().not().property("sub1/category/p2").equals(5).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertTrue(extendedPredicate.evaluate(resource1));
  Assert.assertTrue(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().property("sub1/category/p1").equals(1).and().property("sub1/category/p2").equals(4).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertTrue(extendedPredicate.evaluate(resource1));
  Assert.assertFalse(extendedPredicate.evaluate(resource2));
  predicate=new PredicateBuilder().property("sub1/category/p1").equals(1).or().property("sub1/category/p2").equals(4).toPredicate();
  visitor=new ExtendedResourcePredicateVisitor(extendedPropertyMap);
  PredicateHelper.visit(predicate,visitor);
  extendedPredicate=visitor.getExtendedPredicate();
  Assert.assertTrue(extendedPredicate.evaluate(resource1));
  Assert.assertTrue(extendedPredicate.evaluate(resource2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.QueryImplTest </h4><pre class="type-4 type-13 type-10 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJoinedResourceProperties() throws Exception {
  ResourceDefinition resourceDefinition=new StackResourceDefinition();
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Stack,"HDP");
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addProperty("versions/*",null);
  instance.addProperty("versions/operating_systems/*",null);
  instance.addProperty("versions/operating_systems/repositories/*",null);
  instance.execute();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("versions/operating_systems/repositories/Repositories/repo_id");
  propertyIds.add("versions/operating_systems/OperatingSystems/os_type");
  Map<Resource,Set<Map<String,Object>>> resourcePropertiesMap=instance.getJoinedResourceProperties(propertyIds,null,null);
  Set<Map<String,Object>> propertyMaps=null;
  for (  Map.Entry<Resource,Set<Map<String,Object>>> resourceSetEntry : resourcePropertiesMap.entrySet()) {
    Assert.assertEquals(Resource.Type.Stack,resourceSetEntry.getKey().getType());
    propertyMaps=resourceSetEntry.getValue();
  }
  if (propertyMaps == null) {
    fail("No property maps found!");
  }
  Assert.assertEquals(6,propertyMaps.size());
  for (  Map<String,Object> map : propertyMaps) {
    Assert.assertEquals(2,map.size());
    Assert.assertTrue(map.containsKey("versions/operating_systems/OperatingSystems/os_type"));
    Assert.assertTrue(map.containsKey("versions/operating_systems/repositories/Repositories/repo_id"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsCollection__False(){
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  mapIds.put(Resource.Type.Service,"service");
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Service).anyTimes();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(Collections.<SubResourceDefinition>emptySet()).anyTimes();
  replay(resourceDefinition);
  ResourceInstance instance=new TestQuery(mapIds,resourceDefinition);
  assertFalse(instance.isCollectionResource());
  verify(resourceDefinition);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsCollection__True(){
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  mapIds.put(Resource.Type.Cluster,"cluster");
  mapIds.put(Resource.Type.Service,null);
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Service).anyTimes();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(Collections.<SubResourceDefinition>emptySet()).anyTimes();
  replay(resourceDefinition);
  ResourceInstance instance=new TestQuery(mapIds,resourceDefinition);
  assertTrue(instance.isCollectionResource());
  verify(resourceDefinition);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.ClusterBlueprintRendererTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResultWithAttributes() throws Exception {
  ServiceInfo hdfsService=new ServiceInfo();
  hdfsService.setName("HDFS");
  ServiceInfo mrService=new ServiceInfo();
  mrService.setName("MAPREDUCE");
  Result result=new ResultImpl(true);
  Map<String,Object> testDesiredConfigMap=new HashMap<String,Object>();
  DesiredConfig testDesiredConfig=new DesiredConfig();
  testDesiredConfig.setTag("test-tag-one");
  testDesiredConfigMap.put("test-type-one",testDesiredConfig);
  createClusterResultTree(result.getResultTree(),testDesiredConfigMap);
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Collection<Map<String,Object>> host_groups=(Collection<Map<String,Object>>)properties.get("").get("host_groups");
  assertEquals(2,host_groups.size());
  for (  Map<String,Object> hostGroupProperties : host_groups) {
    String host_group_name=(String)hostGroupProperties.get("name");
    if (host_group_name.equals("host_group_1")) {
      assertEquals("1",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(5,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("JOBTRACKER","TASKTRACKER","NAMENODE","DATANODE","AMBARI_SERVER"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
 else     if (host_group_name.equals("host_group_2")) {
      assertEquals("2",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(2,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("TASKTRACKER","DATANODE"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
  }
  List<Map<String,Map<String,Map<String,?>>>> configurationsResult=(List<Map<String,Map<String,Map<String,?>>>>)blueprintResource.getPropertyValue("configurations");
  assertEquals("Incorrect number of config maps added",1,configurationsResult.size());
  Map<String,Map<String,?>> configMap=configurationsResult.iterator().next().get("test-type-one");
  assertNotNull("Expected config map was not included",configMap);
  assertEquals("Incorrect number of maps added under expected type",2,configMap.size());
  assertTrue("Expected properties map was not found",configMap.containsKey("properties"));
  assertTrue("Expected properties_attributes map was not found",configMap.containsKey("properties_attributes"));
  Map<String,?> propertiesResult=configMap.get("properties");
  assertEquals("Incorrect number of config properties found",1,propertiesResult.size());
  Map<String,?> attributesResult=configMap.get("properties_attributes");
  assertEquals("Incorrect number of config attributes found",1,attributesResult.size());
  assertEquals("Incorrect property value included","valueOne",propertiesResult.get("propertyOne"));
  assertNotNull("Expected attribute not found in exported Blueprint",attributesResult.get("final"));
  assertTrue("Attribute type map was not included",attributesResult.get("final") instanceof Map);
  Map<String,?> finalMap=(Map<String,?>)attributesResult.get("final");
  assertEquals("Attribute value is not correct","true",finalMap.get("propertyOne"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testClusterRendererDefaults() throws Exception {
  Renderer clusterBlueprintRenderer=new ClusterBlueprintRenderer();
  assertFalse("ClusterBlueprintRenderer should not require property provider input",clusterBlueprintRenderer.requiresPropertyProviderInput());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance(){
  QueryInfo rootQuery=new QueryInfo(new ClusterResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Cluster");
  rootQuery.getProperties().add("foo/bar");
  rootQuery.getProperties().add("prop1");
  QueryInfo hostInfo=new QueryInfo(new HostResourceDefinition(),new HashSet<String>());
  queryTree.addChild(hostInfo,"Host");
  QueryInfo hostComponentInfo=new QueryInfo(new HostComponentResourceDefinition(),new HashSet<String>());
  queryTree.getChild("Host").addChild(hostComponentInfo,"HostComponent");
  ClusterBlueprintRenderer renderer=new ClusterBlueprintRenderer();
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  Set<String> rootProperties=propertyTree.getObject();
  assertEquals(2,rootProperties.size());
  assertNotNull(propertyTree.getChild("Host"));
  assertTrue(propertyTree.getChild("Host").getObject().isEmpty());
  assertNotNull(propertyTree.getChild("Host/HostComponent"));
  assertEquals(1,propertyTree.getChild("Host/HostComponent").getObject().size());
  assertTrue(propertyTree.getChild("Host/HostComponent").getObject().contains("HostRoles/component_name"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_noComponentNode(){
  QueryInfo rootQuery=new QueryInfo(new ClusterResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Cluster");
  rootQuery.getProperties().add("foo/bar");
  rootQuery.getProperties().add("prop1");
  ClusterBlueprintRenderer renderer=new ClusterBlueprintRenderer();
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  Set<String> rootProperties=propertyTree.getObject();
  assertEquals(2,rootProperties.size());
  assertNotNull(propertyTree.getChild("Host"));
  assertTrue(propertyTree.getChild("Host").getObject().isEmpty());
  assertNotNull(propertyTree.getChild("Host/HostComponent"));
  assertEquals(1,propertyTree.getChild("Host/HostComponent").getObject().size());
  assertTrue(propertyTree.getChild("Host/HostComponent").getObject().contains("HostRoles/component_name"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.DefaultRendererTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_subResource_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceComponentInfo/service_name").anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  HashSet<String> componentProperties=new HashSet<String>();
  componentProperties.add("goo/car");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),componentProperties),"Component");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(3,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(3,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/service_name"));
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  assertTrue(componentNode.getObject().contains("goo/car"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_subResource_propertiesTopLevelOnly(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceComponentInfo/service_name").anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(3,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(2,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/service_name"));
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_subResource_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceComponentInfo/service_name").anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(2,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/service_name"));
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(schema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Alert)).andReturn(schema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Artifact)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceComponentInfo/service_name").anyTimes();
  replay(schemaFactory,schema);
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertTrue(propertyTree.getObject().isEmpty());
  assertEquals(3,propertyTree.getChildren().size());
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(2,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/service_name"));
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(3,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(3,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_subResource_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceComponentInfo/service_name").anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  DefaultRenderer renderer=new DefaultRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(2,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/service_name"));
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRequiresInputDefault() throws Exception {
  Renderer defaultRenderer=new DefaultRenderer();
  assertTrue("Default renderer for cluster resources must require property provider input",defaultRenderer.requiresPropertyProviderInput());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.MetricsPaddingRendererTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__NullPadding_property(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("ServiceInfo/cluster_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  MetricsPaddingRenderer renderer=new MetricsPaddingRenderer("null_padding");
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(4,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("ServiceInfo/cluster_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  assertTrue(propertyTree.getObject().contains("params/padding/NULLS"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.MinimalRendererTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(schema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Alert)).andReturn(schema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Artifact)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,schema);
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertTrue(propertyTree.getObject().isEmpty());
  assertEquals(3,propertyTree.getChildren().size());
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(1,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(1,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_subResource_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(1,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(1,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_subResource_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  HashSet<String> componentProperties=new HashSet<String>();
  componentProperties.add("goo/car");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),componentProperties),"Component");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(2,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  assertTrue(componentNode.getObject().contains("goo/car"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_properties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema schema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(schema).anyTimes();
  expect(schema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  replay(schemaFactory,schema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  assertEquals(0,propertyTree.getChildren().size());
  verify(schemaFactory,schema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult_propsSetOnSubResource() throws Exception {
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema clusterSchema=createNiceMock(Schema.class);
  Schema hostSchema=createNiceMock(Schema.class);
  Schema hostComponentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Cluster)).andReturn(clusterSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Host)).andReturn(hostSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.HostComponent)).andReturn(hostComponentSchema).anyTimes();
  expect(clusterSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Hosts/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("Hosts/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("HostRoles/cluster_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("HostRoles/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.HostComponent)).andReturn("HostRoles/component_name").anyTimes();
  replay(schemaFactory,clusterSchema,hostSchema,hostComponentSchema);
  Result result=new ResultImpl(true);
  createResultTree(result.getResultTree());
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  renderer.finalizeProperties(createPropertyTreeWithSubProps(),false);
  TreeNode<Resource> resultTree=renderer.finalizeResult(result).getResultTree();
  assertNull(resultTree.getStringProperty("isCollection"));
  assertEquals(1,resultTree.getChildren().size());
  TreeNode<Resource> clusterNode=resultTree.getChildren().iterator().next();
  Resource clusterResource=clusterNode.getObject();
  Map<String,Map<String,Object>> clusterProperties=clusterResource.getPropertiesMap();
  assertEquals(2,clusterProperties.size());
  assertEquals(3,clusterProperties.get("Clusters").size());
  assertEquals("testCluster",clusterProperties.get("Clusters").get("cluster_name"));
  assertEquals("HDP-1.3.3",clusterProperties.get("Clusters").get("version"));
  assertEquals("value1",clusterProperties.get("Clusters").get("prop1"));
  assertEquals(1,clusterProperties.get("").size());
  assertEquals("bar",clusterProperties.get("").get("foo"));
  TreeNode<Resource> hosts=clusterNode.getChildren().iterator().next();
  for (  TreeNode<Resource> hostNode : hosts.getChildren()) {
    Resource hostResource=hostNode.getObject();
    Map<String,Map<String,Object>> hostProperties=hostResource.getPropertiesMap();
    assertEquals(2,hostProperties.size());
    assertEquals(1,hostProperties.get("Hosts").size());
    assertTrue(hostProperties.get("Hosts").containsKey("host_name"));
    assertEquals(1,hostProperties.get("").size());
    assertEquals("bar",hostProperties.get("").get("foo"));
    for (    TreeNode<Resource> componentNode : hostNode.getChildren().iterator().next().getChildren()) {
      Resource componentResource=componentNode.getObject();
      Map<String,Map<String,Object>> componentProperties=componentResource.getPropertiesMap();
      assertEquals(1,componentProperties.size());
      assertEquals(1,componentProperties.get("HostRoles").size());
      assertTrue(componentProperties.get("HostRoles").containsKey("component_name"));
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult() throws Exception {
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema clusterSchema=createNiceMock(Schema.class);
  Schema hostSchema=createNiceMock(Schema.class);
  Schema hostComponentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Cluster)).andReturn(clusterSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Host)).andReturn(hostSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.HostComponent)).andReturn(hostComponentSchema).anyTimes();
  expect(clusterSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Hosts/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("Hosts/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("HostRoles/cluster_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("HostRoles/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.HostComponent)).andReturn("HostRoles/component_name").anyTimes();
  replay(schemaFactory,clusterSchema,hostSchema,hostComponentSchema);
  Result result=new ResultImpl(true);
  createResultTree(result.getResultTree());
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  renderer.finalizeProperties(createPropertyTree(),false);
  TreeNode<Resource> resultTree=renderer.finalizeResult(result).getResultTree();
  assertNull(resultTree.getStringProperty("isCollection"));
  assertEquals(1,resultTree.getChildren().size());
  TreeNode<Resource> clusterNode=resultTree.getChildren().iterator().next();
  Resource clusterResource=clusterNode.getObject();
  Map<String,Map<String,Object>> clusterProperties=clusterResource.getPropertiesMap();
  assertEquals(2,clusterProperties.size());
  assertEquals(3,clusterProperties.get("Clusters").size());
  assertEquals("testCluster",clusterProperties.get("Clusters").get("cluster_name"));
  assertEquals("HDP-1.3.3",clusterProperties.get("Clusters").get("version"));
  assertEquals("value1",clusterProperties.get("Clusters").get("prop1"));
  assertEquals(1,clusterProperties.get("").size());
  assertEquals("bar",clusterProperties.get("").get("foo"));
  TreeNode<Resource> hosts=clusterNode.getChildren().iterator().next();
  for (  TreeNode<Resource> hostNode : hosts.getChildren()) {
    Resource hostResource=hostNode.getObject();
    Map<String,Map<String,Object>> hostProperties=hostResource.getPropertiesMap();
    assertEquals(1,hostProperties.size());
    assertEquals(1,hostProperties.get("Hosts").size());
    assertTrue(hostProperties.get("Hosts").containsKey("host_name"));
    for (    TreeNode<Resource> componentNode : hostNode.getChildren().iterator().next().getChildren()) {
      Resource componentResource=componentNode.getObject();
      Map<String,Map<String,Object>> componentProperties=componentResource.getPropertiesMap();
      assertEquals(1,componentProperties.size());
      assertEquals(1,componentProperties.get("HostRoles").size());
      assertTrue(componentProperties.get("HostRoles").containsKey("component_name"));
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_subResource_propertiesTopLevelOnly(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  serviceProperties.add("foo/bar");
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(2,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  assertTrue(propertyTree.getObject().contains("foo/bar"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(1,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__collection_subResource_noProperties(){
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema serviceSchema=createNiceMock(Schema.class);
  Schema componentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Service)).andReturn(serviceSchema).anyTimes();
  expect(serviceSchema.getKeyPropertyId(Resource.Type.Service)).andReturn("ServiceInfo/service_name").anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Component)).andReturn(componentSchema).anyTimes();
  expect(componentSchema.getKeyPropertyId(Resource.Type.Component)).andReturn("ServiceComponentInfo/component_name").anyTimes();
  replay(schemaFactory,serviceSchema,componentSchema);
  HashSet<String> serviceProperties=new HashSet<String>();
  QueryInfo rootQuery=new QueryInfo(new ServiceResourceDefinition(),serviceProperties);
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Service");
  queryTree.addChild(new QueryInfo(new ComponentResourceDefinition(),new HashSet<String>()),"Component");
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,true);
  assertEquals(1,propertyTree.getChildren().size());
  assertEquals(1,propertyTree.getObject().size());
  assertTrue(propertyTree.getObject().contains("ServiceInfo/service_name"));
  TreeNode<Set<String>> componentNode=propertyTree.getChild("Component");
  assertEquals(0,componentNode.getChildren().size());
  assertEquals(1,componentNode.getObject().size());
  assertTrue(componentNode.getObject().contains("ServiceComponentInfo/component_name"));
  verify(schemaFactory,serviceSchema,componentSchema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.BaseResourceDefinitionTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRenderer(){
  ResourceDefinition resource=getResourceDefinition();
  assertTrue(resource.getRenderer(null) instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("default") instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("minimal") instanceof MinimalRenderer);
  try {
    resource.getRenderer("foo");
    fail("Should have thrown an exception due to invalid renderer type");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.BlueprintResourceDefinitionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  BlueprintResourceDefinition definition=new BlueprintResourceDefinition();
  Assert.assertTrue(definition.getSubResourceDefinitions().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCreateDirectives(){
  BlueprintResourceDefinition definition=new BlueprintResourceDefinition();
  Collection<String> directives=definition.getCreateDirectives();
  Assert.assertEquals(1,directives.size());
  Assert.assertTrue(directives.contains("validate_topology"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ClusterResourceDefinitionTest </h4><pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRenderer(){
  ResourceDefinition resource=new ClusterResourceDefinition();
  assertTrue(resource.getRenderer(null) instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("default") instanceof DefaultRenderer);
  assertTrue(resource.getRenderer("minimal") instanceof MinimalRenderer);
  assertTrue(resource.getRenderer("blueprint") instanceof ClusterBlueprintRenderer);
  try {
    resource.getRenderer("foo");
    fail("Should have thrown an exception due to invalid renderer type");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition resource=new ClusterResourceDefinition();
  Set<SubResourceDefinition> subResources=resource.getSubResourceDefinitions();
  assertEquals(12,subResources.size());
  assertTrue(includesType(subResources,Resource.Type.Service));
  assertTrue(includesType(subResources,Resource.Type.Host));
  assertTrue(includesType(subResources,Resource.Type.Configuration));
  assertTrue(includesType(subResources,Resource.Type.Request));
  assertTrue(includesType(subResources,Resource.Type.Workflow));
  assertTrue(includesType(subResources,Resource.Type.ConfigGroup));
  assertTrue(includesType(subResources,Resource.Type.AlertDefinition));
  assertTrue(includesType(subResources,Resource.Type.ServiceConfigVersion));
  assertTrue(includesType(subResources,Resource.Type.ClusterPrivilege));
  assertTrue(includesType(subResources,Resource.Type.Alert));
  assertTrue(includesType(subResources,Resource.Type.ClusterStackVersion));
  assertTrue(includesType(subResources,Resource.Type.Artifact));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.CredentialResourceDefinitionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  CredentialResourceDefinition definition=new CredentialResourceDefinition();
  Assert.assertTrue(definition.getSubResourceDefinitions().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.HostResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  final ResourceDefinition resource=new HostResourceDefinition();
  Set<SubResourceDefinition> subResources=resource.getSubResourceDefinitions();
  assertEquals(4,subResources.size());
  assertTrue(includesType(subResources,Resource.Type.HostComponent));
  assertTrue(includesType(subResources,Resource.Type.Alert));
  assertTrue(includesType(subResources,Resource.Type.HostStackVersion));
  assertTrue(includesType(subResources,Resource.Type.HostKerberosIdentity));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.InstanceResourceDefinitionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  InstanceResourceDefinition definition=new InstanceResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=definition.getSubResourceDefinitions();
  Assert.assertTrue(subResourceDefinitions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.PermissionResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  PermissionResourceDefinition permissionResourceDefinition=new PermissionResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=permissionResourceDefinition.getSubResourceDefinitions();
  Set<Resource.Type> expectedSubTypes=new HashSet<Resource.Type>();
  expectedSubTypes.add(Resource.Type.RoleAuthorization);
  Assert.assertEquals(1,subResourceDefinitions.size());
  for (  SubResourceDefinition subResourceDefinition : subResourceDefinitions) {
    Assert.assertTrue(expectedSubTypes.contains(subResourceDefinition.getType()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ServiceResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition resource=new ServiceResourceDefinition();
  Set<SubResourceDefinition> subResources=resource.getSubResourceDefinitions();
  assertEquals(3,subResources.size());
  assertTrue(includesType(subResources,Resource.Type.Component));
  assertTrue(includesType(subResources,Resource.Type.Alert));
  assertTrue(includesType(subResources,Resource.Type.Artifact));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.StackConfigurationDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition resource=new StackConfigurationResourceDefinition();
  Set<SubResourceDefinition> subResources=resource.getSubResourceDefinitions();
  assertEquals(1,subResources.size());
  assertTrue(includesType(subResources,Resource.Type.StackConfigurationDependency));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.StackConfigurationDependencyDefinitionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition resource=new StackConfigurationDependencyResourceDefinition();
  Set<SubResourceDefinition> subResources=resource.getSubResourceDefinitions();
  assertTrue(subResources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.StackServiceResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition def=new StackServiceResourceDefinition();
  Set<SubResourceDefinition> subResources=def.getSubResourceDefinitions();
  assertEquals(5,subResources.size());
  boolean configReturned=false;
  boolean componentReturned=false;
  boolean artifactReturned=false;
  boolean themesReturned=false;
  for (  SubResourceDefinition subResource : subResources) {
    Resource.Type type=subResource.getType();
    if (type.equals(Resource.Type.StackConfiguration)) {
      configReturned=true;
    }
 else     if (type.equals(Resource.Type.StackServiceComponent)) {
      componentReturned=true;
    }
 else     if (type.equals(Resource.Type.StackArtifact)) {
      artifactReturned=true;
    }
 else     if (type.equals(Resource.Type.Theme)) {
      themesReturned=true;
    }
  }
  assertTrue(configReturned);
  assertTrue(componentReturned);
  assertTrue(artifactReturned);
  assertTrue(themesReturned);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.StackVersionResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions(){
  ResourceDefinition def=new StackVersionResourceDefinition();
  Set<SubResourceDefinition> subResources=def.getSubResourceDefinitions();
  assertEquals(6,subResources.size());
  boolean operatingSystemFound=false;
  boolean serviceFound=false;
  boolean configFound=false;
  boolean repoFound=false;
  boolean artifactReturned=false;
  boolean compatibleFound=false;
  for (  SubResourceDefinition subResource : subResources) {
    Resource.Type type=subResource.getType();
    if (type.equals(Resource.Type.OperatingSystem)) {
      operatingSystemFound=true;
    }
 else     if (type.equals(Resource.Type.StackService)) {
      serviceFound=true;
    }
 else     if (type.equals(Resource.Type.StackLevelConfiguration)) {
      configFound=true;
    }
 else     if (type.equals(Resource.Type.RepositoryVersion)) {
      repoFound=true;
    }
 else     if (type.equals(Resource.Type.StackArtifact)) {
      artifactReturned=true;
    }
 else     if (type.equals(Resource.Type.CompatibleRepositoryVersion)) {
      compatibleFound=true;
    }
  }
  assertTrue(operatingSystemFound);
  assertTrue(serviceFound);
  assertTrue(configFound);
  assertTrue(repoFound);
  assertTrue(artifactReturned);
  assertTrue(compatibleFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.TargetClusterResourceDefinitionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  TargetClusterResourceDefinition definition=new TargetClusterResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=definition.getSubResourceDefinitions();
  Assert.assertTrue(subResourceDefinitions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ViewInstanceResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  ViewInstanceResourceDefinition viewInstanceResourceDefinition=getViewInstanceResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=viewInstanceResourceDefinition.getSubResourceDefinitions();
  Assert.assertEquals(3,subResourceDefinitions.size());
  for (  SubResourceDefinition subResourceDefinition : subResourceDefinitions) {
    Resource.Type type=subResourceDefinition.getType();
    Assert.assertTrue(type.name().equals("sub1") || type.name().equals("sub2") || type.equals(Resource.Type.ViewPrivilege));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ViewPermissionResourceDefinitionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  ViewPermissionResourceDefinition ViewPermissionResourceDefinition=new ViewPermissionResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=ViewPermissionResourceDefinition.getSubResourceDefinitions();
  Assert.assertTrue(subResourceDefinitions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ViewVersionResourceDefinitionTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  ViewVersionResourceDefinition viewVersionResourceDefinition=new ViewVersionResourceDefinition();
  Set<SubResourceDefinition> subResourceDefinitions=viewVersionResourceDefinition.getSubResourceDefinitions();
  Assert.assertEquals(2,subResourceDefinitions.size());
  for (  SubResourceDefinition subResourceDefinition : subResourceDefinitions) {
    String name=subResourceDefinition.getType().name();
    Assert.assertTrue(name.equals("ViewInstance") || name.equals("ViewPermission"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.rest.KdcServerConnectionVerificationTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Successful() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andReturn(null).once();
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Fail_TimeoutErrorCode() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(new KerberosException(ErrorType.KRB_ERR_GENERIC,"TimeOut occurred"));
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Fail_UnknownException() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(new RuntimeException("This is a really bad exception"));
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Fail_GeneralErrorCode_NotTimeout() throws Exception {
  KrbError error=createNiceMock(KrbError.class);
  expect(error.getErrorCode()).andReturn(ErrorType.KRB_ERR_GENERIC).once();
  expect(error.getMessageType()).andReturn(KerberosMessageType.KRB_ERROR).once();
  KerberosException exception=createNiceMock(KerberosException.class);
  expect(exception.getError()).andReturn(error).once();
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(exception);
  replay(connection,exception,error);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection,exception);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidate__Success() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andReturn(null).once();
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host:11111");
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Successful2() throws Exception {
  KrbError error=createNiceMock(KrbError.class);
  expect(error.getErrorCode()).andReturn(ErrorType.KDC_ERR_C_PRINCIPAL_UNKNOWN).once();
  expect(error.getMessageType()).andReturn(KerberosMessageType.KRB_ERROR).once();
  KerberosException exception=createNiceMock(KerberosException.class);
  expect(exception.getError()).andReturn(error).once();
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(exception);
  replay(connection,exception,error);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection,exception);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidate__Fail_InvalidPort() throws Exception {
  assertFalse(new KdcServerConnectionVerification(configuration).isKdcReachable("test-host:abcd"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Successful() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andReturn(null).once();
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Fail_TimeoutErrorCode() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(new KerberosException(ErrorType.KRB_ERR_GENERIC,"TimeOut occurred"));
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Successful2() throws Exception {
  KrbError error=createNiceMock(KrbError.class);
  expect(error.getErrorCode()).andReturn(ErrorType.KDC_ERR_C_PRINCIPAL_UNKNOWN).once();
  expect(error.getMessageType()).andReturn(KerberosMessageType.KRB_ERROR).once();
  KerberosException exception=createNiceMock(KerberosException.class);
  expect(exception.getError()).andReturn(error).once();
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(exception);
  replay(connection,exception,error);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection,exception);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateTCP__Fail_Timeout() throws Exception {
  int timeout=1;
  KdcConnection connection=new BlockingKdcConnection(null);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  kdcConnVerifier.setConnectionTimeout(timeout);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,TCP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertFalse(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(timeout * 1000,kdcConfig.getTimeout());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Fail_GeneralErrorCode_NotTimeout() throws Exception {
  KrbError error=createNiceMock(KrbError.class);
  expect(error.getErrorCode()).andReturn(ErrorType.KRB_ERR_GENERIC).once();
  expect(error.getMessageType()).andReturn(KerberosMessageType.KRB_ERROR).once();
  KerberosException exception=createNiceMock(KerberosException.class);
  expect(exception.getError()).andReturn(error).once();
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(exception);
  replay(connection,exception,error);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertTrue(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection,exception);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Fail_UnknownException() throws Exception {
  KdcConnection connection=createStrictMock(KdcConnection.class);
  expect(connection.getTgt("noUser@noRealm","noPassword")).andThrow(new RuntimeException("This is a really bad exception"));
  replay(connection);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(10 * 1000,kdcConfig.getTimeout());
  verify(connection);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testValidate__Live() throws Exception {
  KdcServerConnectionVerification kdcConnVerifier=new KdcServerConnectionVerification(configuration);
  boolean result=kdcConnVerifier.isKdcReachable("c6501:88");
  assertTrue(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateUDP__Fail_Timeout() throws Exception {
  int timeout=1;
  KdcConnection connection=new BlockingKdcConnection(null);
  TestKdcServerConnectionVerification kdcConnVerifier=new TestKdcServerConnectionVerification(configuration,connection);
  kdcConnVerifier.setConnectionTimeout(timeout);
  boolean result=kdcConnVerifier.isKdcReachable("test-host",11111,UDP);
  assertFalse(result);
  KdcConfig kdcConfig=kdcConnVerifier.getConfigUsedInConnectionCreation();
  assertTrue(kdcConfig.isUseUdp());
  assertEquals("test-host",kdcConfig.getHostName());
  assertEquals(11111,kdcConfig.getKdcPort());
  assertEquals(timeout * 1000,kdcConfig.getTimeout());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.AmbariMetaInfoTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testGlobalMapping() throws Exception {
  ServiceInfo sinfo=metaInfo.getService("HDP","0.2","HDFS");
  List<PropertyInfo> pinfo=sinfo.getProperties();
  boolean checkforglobal=false;
  for (  PropertyInfo pinfol : pinfo) {
    if ("global.xml".equals(pinfol.getFilename())) {
      checkforglobal=true;
    }
  }
  Assert.assertTrue(checkforglobal);
  sinfo=metaInfo.getService("HDP","0.2","MAPREDUCE");
  boolean checkforhadoopheapsize=false;
  pinfo=sinfo.getProperties();
  for (  PropertyInfo pinfol : pinfo) {
    if ("global.xml".equals(pinfol.getFilename())) {
      if ("hadoop_heapsize".equals(pinfol.getName())) {
        checkforhadoopheapsize=true;
      }
    }
  }
  Assert.assertTrue(checkforhadoopheapsize);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedBaseUrl() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  Capture<MetainfoEntity> c=new Capture<MetainfoEntity>();
  metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  reset(entity);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(metainfoDAO.merge(EasyMock.capture(c))).andReturn(entity).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,prevBaseUrl);
  assertEquals(prevBaseUrl,c.getValue().getMetainfoValue());
  assertTrue(repoInfo.isBaseUrlFromSaved());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
      assertEquals(ri.getBaseUrl(),ri.getLatestBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Method: Map<String, ServiceInfo> getServices(String stackName, String
 * version, String serviceName)
 * @throws AmbariException
 */
@Test public void getServices() throws AmbariException {
  Map<String,ServiceInfo> services=metaInfo.getServices(STACK_NAME_HDP,STACK_VERSION_HDP);
  LOG.info("Getting all the services ");
  for (  Map.Entry<String,ServiceInfo> entry : services.entrySet()) {
    LOG.info("Service Name " + entry.getKey() + " values "+ entry.getValue());
  }
  assertTrue(services.containsKey("HDFS"));
  assertTrue(services.containsKey("MAPREDUCE"));
  assertNotNull(services);
  assertFalse(services.keySet().size() == 0);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomConfigDir() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"2.0.7","MAPREDUCE2");
  boolean found=false;
  for (  PropertyInfo pi : service.getProperties()) {
    if (pi.getName().equals("mr2-prop")) {
      Assert.assertEquals("some-mr2-value",pi.getValue());
      found=true;
    }
  }
  Assert.assertTrue(found);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHive134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HIVE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("HIVE_METASTORE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_SERVER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(1,dependencyList.size());
      DependencyInfo dependency=dependencyList.get(0);
      Assert.assertEquals("ZOOKEEPER/ZOOKEEPER_SERVER",dependency.getName());
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("MYSQL_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests merging stack-based with existing definitions works
 * @throws Exception
 */
@Test public void testAlertDefinitionMerging() throws Exception {
  Injector injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  injector.getInstance(GuiceJpaInitializer.class);
  injector.getInstance(EntityManager.class);
  long clusterId=injector.getInstance(OrmTestHelper.class).createCluster("cluster" + System.currentTimeMillis());
  Class<?> c=metaInfo.getClass().getSuperclass();
  Field f=c.getDeclaredField("alertDefinitionDao");
  f.setAccessible(true);
  f.set(metaInfo,injector.getInstance(AlertDefinitionDAO.class));
  f=c.getDeclaredField("ambariServiceAlertDefinitions");
  f.setAccessible(true);
  f.set(metaInfo,injector.getInstance(AmbariServiceAlertDefinitions.class));
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getClusterById(clusterId);
  cluster.setDesiredStackVersion(new StackId(STACK_NAME_HDP,"2.0.6"));
  cluster.addService("HDFS");
  metaInfo.reconcileAlertDefinitions(clusters);
  AlertDefinitionDAO dao=injector.getInstance(AlertDefinitionDAO.class);
  List<AlertDefinitionEntity> definitions=dao.findAll(clusterId);
  assertEquals(9,definitions.size());
  int hostAlertCount=0;
  for (  AlertDefinitionEntity definition : definitions) {
    if (definition.getServiceName().equals("AMBARI") && definition.getComponentName().equals("AMBARI_AGENT")) {
      hostAlertCount++;
    }
  }
  assertEquals(1,hostAlertCount);
  assertEquals(8,definitions.size() - hostAlertCount);
  for (  AlertDefinitionEntity definition : definitions) {
    definition.setScheduleInterval(28);
    dao.merge(definition);
  }
  metaInfo.reconcileAlertDefinitions(clusters);
  definitions=dao.findAll();
  assertEquals(9,definitions.size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertEquals(28,definition.getScheduleInterval().intValue());
  }
  definitions=dao.findAllEnabled(cluster.getClusterId());
  assertEquals(8,definitions.size());
  AlertDefinitionEntity entity=new AlertDefinitionEntity();
  entity.setClusterId(clusterId);
  entity.setDefinitionName("bad_hdfs_alert");
  entity.setLabel("Bad HDFS Alert");
  entity.setDescription("A way to fake a component being removed");
  entity.setEnabled(true);
  entity.setHash(UUID.randomUUID().toString());
  entity.setScheduleInterval(1);
  entity.setServiceName("HDFS");
  entity.setComponentName("BAD_COMPONENT");
  entity.setSourceType(SourceType.METRIC);
  entity.setSource("{\"type\" : \"METRIC\"}");
  dao.create(entity);
  definitions=dao.findAllEnabled(cluster.getClusterId());
  assertEquals(9,definitions.size());
  metaInfo.reconcileAlertDefinitions(clusters);
  definitions=dao.findAllEnabled(cluster.getClusterId());
  assertEquals(8,definitions.size());
  definitions=dao.findAll();
  assertEquals(10,definitions.size());
  entity=dao.findById(entity.getDefinitionId());
  assertFalse(entity.getEnabled());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepos() throws Exception {
  Map<String,List<RepositoryInfo>> repos=metaInfo.getRepository(STACK_NAME_HDP,STACK_VERSION_HDP);
  Set<String> centos5Cnt=new HashSet<String>();
  Set<String> centos6Cnt=new HashSet<String>();
  Set<String> redhat6cnt=new HashSet<String>();
  Set<String> redhat5cnt=new HashSet<String>();
  for (  List<RepositoryInfo> vals : repos.values()) {
    for (    RepositoryInfo repo : vals) {
      LOG.debug("Dumping repo info : " + repo.toString());
      if (repo.getOsType().equals("centos5")) {
        centos5Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("centos6")) {
        centos6Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat6")) {
        redhat6cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat5")) {
        redhat5cnt.add(repo.getRepoId());
      }
 else {
        fail("Found invalid os " + repo.getOsType());
      }
      if (repo.getRepoId().equals("epel")) {
        assertFalse(repo.getMirrorsList().isEmpty());
        assertNull(repo.getBaseUrl());
      }
 else {
        assertNull(repo.getMirrorsList());
        assertFalse(repo.getBaseUrl().isEmpty());
      }
    }
  }
  assertEquals(3,centos5Cnt.size());
  assertEquals(3,redhat6cnt.size());
  assertEquals(3,redhat5cnt.size());
  assertEquals(3,centos6Cnt.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigDependencies() throws Exception {
  ServiceInfo serviceInfo=metaInfo.getService(STACK_NAME_HDP,EXT_STACK_NAME,SERVICE_NAME_MAPRED2);
  assertNotNull(serviceInfo);
  assertTrue(!serviceInfo.getConfigDependencies().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaInfoFileFilter() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  File stackRoot=new File("src/test/resources/stacks");
  File version=new File("src/test/resources/version");
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot=new File(ClassLoader.getSystemClassLoader().getResource("stacks").getPath());
    version=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"version");
  }
  File stackRootTmp=new File(buildDir + "/ambari-metaInfo");
  stackRootTmp.mkdir();
  FileUtils.copyDirectory(stackRoot,stackRootTmp);
  AmbariMetaInfo ambariMetaInfo=createAmbariMetaInfo(stackRootTmp,version);
  File f1, f2, f3;
  f1=new File(stackRootTmp.getAbsolutePath() + "/001.svn");
  f1.createNewFile();
  f2=new File(stackRootTmp.getAbsolutePath() + "/abcd.svn/001.svn");
  f2.mkdirs();
  f2.createNewFile();
  f3=new File(stackRootTmp.getAbsolutePath() + "/.svn");
  if (!f3.exists()) {
    f3.createNewFile();
  }
  ambariMetaInfo.init();
  getServices();
  getComponentsByService();
  Assert.assertNotNull(ambariMetaInfo.getStack("abcd.svn","001.svn"));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsJson() throws Exception {
  ServiceInfo svc=metaInfo.getService(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getMetricsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.6","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getMetricsFile());
  List<MetricDefinition> list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS",SERVICE_COMPONENT_NAME,Resource.Type.Component.name());
  Assert.assertNotNull(list);
  list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list);
  List<MetricDefinition> list0=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list0);
  Assert.assertTrue("Expecting subsequent calls to use a cached value for the definition",list == list0);
  list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.6","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPasswordPropertyAttribute() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"2.0.1","HIVE");
  List<PropertyInfo> propertyInfoList=service.getProperties();
  Assert.assertNotNull(propertyInfoList);
  PropertyInfo passwordProperty=null;
  for (  PropertyInfo propertyInfo : propertyInfoList) {
    if (propertyInfo.isRequireInput() && propertyInfo.getPropertyTypes().contains(PropertyInfo.PropertyType.PASSWORD)) {
      passwordProperty=propertyInfo;
    }
 else {
      Assert.assertTrue(propertyInfo.getPropertyTypes().isEmpty());
    }
  }
  Assert.assertNotNull(passwordProperty);
  Assert.assertEquals("javax.jdo.option.ConnectionPassword",passwordProperty.getName());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getComponentsByService() throws AmbariException {
  List<ComponentInfo> components=metaInfo.getComponentsByService(STACK_NAME_HDP,STACK_VERSION_HDP,SERVICE_NAME_HDFS);
  assertNotNull(components);
  assertTrue(components.size() > 0);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertiesSharedName() throws Exception {
  Set<PropertyInfo> properties=metaInfo.getPropertiesByName(STACK_NAME_HDP,STACK_VERSION_HDP_02,SERVICE_NAME_HDFS,SHARED_PROPERTY_NAME);
  Assert.assertEquals(2,properties.size());
  for (  PropertyInfo propertyInfo : properties) {
    Assert.assertEquals(SHARED_PROPERTY_NAME,propertyInfo.getName());
    Assert.assertTrue(propertyInfo.getFilename().equals(HADOOP_ENV_FILE_NAME) || propertyInfo.getFilename().equals(HDFS_LOG4J_FILE_NAME));
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void isValidService() throws AmbariException {
  boolean valid=metaInfo.isValidService(STACK_NAME_HDP,STACK_VERSION_HDP,SERVICE_NAME_HDFS);
  assertTrue(valid);
  boolean invalid=metaInfo.isValidService(STACK_NAME_HDP,STACK_VERSION_HDP,NON_EXT_VALUE);
  assertFalse(invalid);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void isSupportedStack() throws AmbariException {
  boolean supportedStack=metaInfo.isSupportedStack(STACK_NAME_HDP,STACK_VERSION_HDP);
  assertTrue(supportedStack);
  boolean notSupportedStack=metaInfo.isSupportedStack(NON_EXT_VALUE,NON_EXT_VALUE);
  assertFalse(notSupportedStack);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getRepository() throws AmbariException {
  Map<String,List<RepositoryInfo>> repository=metaInfo.getRepository(STACK_NAME_HDP,STACK_VERSION_HDP);
  assertNotNull(repository);
  assertFalse(repository.get("centos5").isEmpty());
  assertFalse(repository.get("centos6").isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtendedStackDefinition() throws Exception {
  StackInfo stackInfo=metaInfo.getStack(STACK_NAME_HDP,EXT_STACK_NAME);
  Assert.assertTrue(stackInfo != null);
  Collection<ServiceInfo> serviceInfos=stackInfo.getServices();
  Assert.assertFalse(serviceInfos.isEmpty());
  Assert.assertTrue(serviceInfos.size() > 1);
  ServiceInfo deletedService=null;
  ServiceInfo redefinedService=null;
  for (  ServiceInfo serviceInfo : serviceInfos) {
    if (serviceInfo.getName().equals("SQOOP")) {
      deletedService=serviceInfo;
    }
    if (serviceInfo.getName().equals("YARN")) {
      redefinedService=serviceInfo;
    }
  }
  Assert.assertNull("SQOOP is a deleted service, should not be a part of " + "the extended stack.",deletedService);
  Assert.assertNotNull(redefinedService);
  Assert.assertEquals("YARN service is expected to be defined with 3 active" + " components.",3,redefinedService.getComponents().size());
  Assert.assertEquals("TEZ is expected to be a part of extended stack " + "definition","TEZ",redefinedService.getClientComponent().getName());
  Assert.assertFalse("YARN CLIENT is a deleted component.",redefinedService.getClientComponent().getName().equals("YARN_CLIENT"));
  Assert.assertNotNull(redefinedService.getProperties());
  Assert.assertTrue(redefinedService.getProperties().size() > 4);
  PropertyInfo deleteProperty1=null;
  PropertyInfo deleteProperty2=null;
  PropertyInfo redefinedProperty1=null;
  PropertyInfo redefinedProperty2=null;
  PropertyInfo redefinedProperty3=null;
  PropertyInfo inheritedProperty=null;
  PropertyInfo newProperty=null;
  PropertyInfo newEnhancedProperty=null;
  PropertyInfo propertyWithExtraValueAttributes=null;
  PropertyInfo originalProperty=null;
  PropertyDependencyInfo propertyDependencyInfo=new PropertyDependencyInfo("yarn-site","new-enhanced-yarn-property");
  for (  PropertyInfo propertyInfo : redefinedService.getProperties()) {
    if (propertyInfo.getName().equals("yarn.resourcemanager.resource-tracker.address")) {
      deleteProperty1=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.scheduler.address")) {
      deleteProperty2=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.address")) {
      redefinedProperty1=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.admin.address")) {
      redefinedProperty2=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.health-checker.interval-ms")) {
      redefinedProperty3=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.address")) {
      inheritedProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("new-yarn-property")) {
      newProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("new-enhanced-yarn-property")) {
      newEnhancedProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.aux-services")) {
      originalProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("property.with.extra.value.attributes")) {
      propertyWithExtraValueAttributes=propertyInfo;
    }
  }
  Assert.assertNull(deleteProperty1);
  Assert.assertNull(deleteProperty2);
  Assert.assertNotNull(redefinedProperty1);
  Assert.assertNotNull(redefinedProperty2);
  Assert.assertNotNull("yarn.nodemanager.address expected to be inherited " + "from parent",inheritedProperty);
  Assert.assertEquals("localhost:100009",redefinedProperty1.getValue());
  Assert.assertNotNull(redefinedProperty3);
  Assert.assertEquals("135000",redefinedProperty3.getValue());
  Assert.assertEquals("",redefinedProperty2.getValue());
  Assert.assertNotNull(newProperty);
  Assert.assertEquals("some-value",newProperty.getValue());
  Assert.assertEquals("some description.",newProperty.getDescription());
  Assert.assertEquals("yarn-site.xml",newProperty.getFilename());
  Assert.assertEquals(1,newProperty.getDependedByProperties().size());
  Assert.assertTrue(newProperty.getDependedByProperties().contains(propertyDependencyInfo));
  Assert.assertNotNull(newEnhancedProperty);
  Assert.assertEquals("1024",newEnhancedProperty.getValue());
  Assert.assertEquals("some enhanced description.",newEnhancedProperty.getDescription());
  Assert.assertEquals("yarn-site.xml",newEnhancedProperty.getFilename());
  Assert.assertEquals(2,newEnhancedProperty.getDependsOnProperties().size());
  Assert.assertTrue(newEnhancedProperty.getDependsOnProperties().contains(new PropertyDependencyInfo("yarn-site","new-yarn-property")));
  Assert.assertTrue(newEnhancedProperty.getDependsOnProperties().contains(new PropertyDependencyInfo("global","yarn_heapsize")));
  Assert.assertEquals("MB",newEnhancedProperty.getPropertyValueAttributes().getUnit());
  Assert.assertEquals("int",newEnhancedProperty.getPropertyValueAttributes().getType());
  Assert.assertEquals("512",newEnhancedProperty.getPropertyValueAttributes().getMinimum());
  Assert.assertEquals("15360",newEnhancedProperty.getPropertyValueAttributes().getMaximum());
  Assert.assertEquals("256",newEnhancedProperty.getPropertyValueAttributes().getIncrementStep());
  Assert.assertNull(newEnhancedProperty.getPropertyValueAttributes().getEntries());
  Assert.assertNull(newEnhancedProperty.getPropertyValueAttributes().getEntriesEditable());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getEmptyValueValid());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getVisible());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getReadOnly());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getEditableOnlyAtInstall());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getOverridable());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getShowPropertyName());
  Assert.assertNotNull(originalProperty);
  Assert.assertEquals("mapreduce.shuffle",originalProperty.getValue());
  Assert.assertEquals("Auxilliary services of NodeManager",originalProperty.getDescription());
  Assert.assertEquals(6,redefinedService.getConfigDependencies().size());
  Assert.assertEquals(7,redefinedService.getConfigDependenciesWithComponents().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChildCustomCommandScriptInheritance() throws Exception {
  ComponentInfo component=metaInfo.getComponent(STACK_NAME_HDP,"2.0.7","HDFS","NAMENODE");
  CustomCommandDefinition ccd=findCustomCommand("DECOMMISSION",component);
  Assert.assertEquals("scripts/namenode_dec.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_parent_command.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("REBALANCEHDFS",component);
  Assert.assertEquals("scripts/namenode.py",ccd.getCommandScript().getScript());
  Assert.assertTrue(ccd.isBackground());
  Assert.assertEquals(3,component.getCustomCommands().size());
  component=metaInfo.getComponent(STACK_NAME_HDP,"2.0.8","HDFS","NAMENODE");
  Assert.assertEquals(4,component.getCustomCommands().size());
  ccd=findCustomCommand("YET_ANOTHER_PARENT_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_parent_command.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("DECOMMISSION",component);
  Assert.assertEquals("scripts/namenode_dec_overr.py",ccd.getCommandScript().getScript());
  ccd=findCustomCommand("YET_ANOTHER_CHILD_COMMAND",component);
  Assert.assertEquals("scripts/yet_another_child_command.py",ccd.getCommandScript().getScript());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosJson() throws Exception {
  ServiceInfo svc;
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.8","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile1=svc.getKerberosDescriptorFile();
  Assert.assertNotNull(kerberosDescriptorFile1);
  Assert.assertTrue(kerberosDescriptorFile1.exists());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.1.1","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile2=svc.getKerberosDescriptorFile();
  Assert.assertNotNull(kerberosDescriptorFile1);
  Assert.assertTrue(kerberosDescriptorFile1.exists());
  Assert.assertEquals(kerberosDescriptorFile1,kerberosDescriptorFile2);
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.7","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile3=svc.getKerberosDescriptorFile();
  Assert.assertNull(kerberosDescriptorFile3);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(ri.getBaseUrl(),ri.getDefaultBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGanglia134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","GANGLIA");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(2,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("GANGLIA_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("GANGLIA_MONITOR")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertTrue(component.getAutoDeploy().isEnabled());
      Assert.assertEquals("ALL",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedUtilsBaseUrl() throws Exception {
  String stackVersion="0.2";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP-Utils/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/0.2/redhat6/HDP-UTILS-1.1.0.15:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,stackVersion,"redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_UTILS_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapReduce134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","MAPREDUCE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("JOBTRACKER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("TASKTRACKER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1+",component.getCardinality());
    }
    if (name.equals("HISTORYSERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("MAPREDUCE/JOBTRACKER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("MAPREDUCE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void isOsSupported() throws Exception {
  Assert.assertTrue(metaInfo.isOsSupported("redhat5"));
  Assert.assertTrue(metaInfo.isOsSupported("centos5"));
  Assert.assertTrue(metaInfo.isOsSupported("oraclelinux5"));
  Assert.assertTrue(metaInfo.isOsSupported("redhat6"));
  Assert.assertTrue(metaInfo.isOsSupported("centos6"));
  Assert.assertTrue(metaInfo.isOsSupported("oraclelinux6"));
  Assert.assertTrue(metaInfo.isOsSupported("suse11"));
  Assert.assertTrue(metaInfo.isOsSupported("sles11"));
  Assert.assertTrue(metaInfo.isOsSupported("ubuntu12"));
  Assert.assertTrue(metaInfo.isOsSupported("win2008server6"));
  Assert.assertTrue(metaInfo.isOsSupported("win2008serverr26"));
  Assert.assertTrue(metaInfo.isOsSupported("win2012server6"));
  Assert.assertTrue(metaInfo.isOsSupported("win2012serverr26"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetUpdatedBaseUrl() throws Exception {
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.updateRepoBaseURL("HDP","2.1.1","redhat6","HDP-2.1.1",newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1");
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getDefaultBaseUrl().equals(ri.getBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1",prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCrossCheckJmxToGangliaMetrics() throws Exception {
  File stacks=new File("src/main/resources/stacks");
  File version=new File("src/test/resources/version");
  File commonServicesRoot=new File("src/main/resources/common-services");
  if (System.getProperty("os.name").contains("Windows")) {
    stacks=new File(ClassLoader.getSystemClassLoader().getResource("stacks").getPath());
    version=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"version");
    commonServicesRoot=new File(ClassLoader.getSystemClassLoader().getResource("common-services").getPath());
  }
  Properties properties=new Properties();
  properties.setProperty(Configuration.METADATA_DIR_PATH,stacks.getPath());
  properties.setProperty(Configuration.COMMON_SERVICES_DIR_PATH,commonServicesRoot.getPath());
  properties.setProperty(Configuration.SERVER_VERSION_FILE,version.getPath());
  Configuration configuration=new Configuration(properties);
  TestAmbariMetaInfo ambariMetaInfo=new TestAmbariMetaInfo(configuration);
  ambariMetaInfo.replayAllMocks();
  try {
    ambariMetaInfo.init();
  }
 catch (  Exception e) {
    LOG.info("Error in metainfo initializing ",e);
    throw e;
  }
  waitForAllReposToBeResolved(ambariMetaInfo);
  String[] metricsTypes={Resource.Type.Component.name(),Resource.Type.HostComponent.name()};
  for (  StackInfo stackInfo : ambariMetaInfo.getStacks(STACK_NAME_HDP)) {
    for (    ServiceInfo serviceInfo : stackInfo.getServices()) {
      for (      ComponentInfo componentInfo : serviceInfo.getComponents()) {
        for (        String metricType : metricsTypes) {
          List<MetricDefinition> list=ambariMetaInfo.getMetrics(stackInfo.getName(),stackInfo.getVersion(),serviceInfo.getName(),componentInfo.getName(),metricType);
          String currentComponentInfo=stackInfo.getName() + "-" + stackInfo.getVersion()+ ", "+ serviceInfo.getName()+ ", "+ componentInfo.getName()+ ", "+ metricType;
          if (list == null) {
            LOG.info("No metrics found for " + currentComponentInfo);
            continue;
          }
          LOG.info("Cross-checking JMX-to-Ganglia metrics for " + currentComponentInfo);
          Map<String,Metric> jmxMetrics=Collections.emptyMap();
          for (          MetricDefinition metricDefinition : list) {
            if ("jmx".equals(metricDefinition.getType())) {
              jmxMetrics=metricDefinition.getMetrics();
              for (              Metric metric : jmxMetrics.values()) {
                Assert.assertTrue(metric.isPointInTime());
                Assert.assertFalse(metric.isTemporal());
              }
            }
          }
          LinkedList<String> failedMetrics=new LinkedList<String>();
          for (          MetricDefinition metricDefinition : list) {
            if ("ganglia".equals(metricDefinition.getType())) {
              for (              Map.Entry<String,Metric> metricEntry : metricDefinition.getMetrics().entrySet()) {
                Assert.assertTrue(metricEntry.getValue().isTemporal());
                if (metricEntry.getValue().isPointInTime() && jmxMetrics.containsKey(metricEntry.getKey())) {
                  failedMetrics.add(metricEntry.getKey());
                }
              }
            }
          }
          Assert.assertEquals(failedMetrics.toString() + " metrics defined with pointInTime=true for both jmx and ganglia types.",0,failedMetrics.size());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertsJson() throws Exception {
  ServiceInfo svc=metaInfo.getService(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.6","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNull(svc.getAlertsFile());
  Set<AlertDefinition> set=metaInfo.getAlertDefinitions(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(set);
  Assert.assertTrue(set.size() > 0);
  AlertDefinition nameNodeProcess=null;
  AlertDefinition nameNodeCpu=null;
  AlertDefinition datanodeStorage=null;
  AlertDefinition ignoreHost=null;
  Iterator<AlertDefinition> iterator=set.iterator();
  while (iterator.hasNext()) {
    AlertDefinition definition=iterator.next();
    if (definition.getName().equals("namenode_process")) {
      nameNodeProcess=definition;
    }
    if (definition.getName().equals("namenode_cpu")) {
      nameNodeCpu=definition;
    }
    if (definition.getName().equals("datanode_storage")) {
      datanodeStorage=definition;
    }
    if (definition.getName().equals("hdfs_ignore_host_test")) {
      ignoreHost=definition;
    }
  }
  assertNotNull(nameNodeProcess);
  assertNotNull(nameNodeCpu);
  assertNotNull(ignoreHost);
  assertEquals("NameNode Host CPU Utilization",nameNodeCpu.getLabel());
  assertFalse(nameNodeProcess.isHostIgnored());
  assertEquals("A description of namenode_process",nameNodeProcess.getDescription());
  Source source=nameNodeProcess.getSource();
  assertNotNull(source);
  assertNotNull(((PortSource)source).getPort());
  Reporting reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNull(reporting.getCritical().getValue());
  assertNull(reporting.getWarning());
  assertFalse(nameNodeCpu.isHostIgnored());
  assertEquals("A description of namenode_cpu",nameNodeCpu.getDescription());
  source=nameNodeCpu.getSource();
  assertNotNull(source);
  reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNotNull(reporting.getCritical().getValue());
  assertNotNull(reporting.getWarning());
  assertNotNull(reporting.getWarning().getText());
  assertNotNull(reporting.getWarning().getValue());
  assertNotNull(datanodeStorage);
  assertEquals("A description of datanode_storage",datanodeStorage.getDescription());
  assertFalse(datanodeStorage.isHostIgnored());
  MetricSource metricSource=(MetricSource)datanodeStorage.getSource();
  assertNotNull(metricSource.getUri());
  assertNotNull(metricSource.getUri().getHttpsProperty());
  assertNotNull(metricSource.getUri().getHttpsPropertyValue());
  assertNotNull(metricSource.getUri().getHttpsUri());
  assertNotNull(metricSource.getUri().getHttpUri());
  assertEquals(12345,metricSource.getUri().getDefaultPort());
  assertTrue(ignoreHost.isHostIgnored());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.BaseRequestTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_WithBody_InvalidQuery() throws Exception {
  UriInfo uriInfo=createMock(UriInfo.class);
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  RequestBody body=createNiceMock(RequestBody.class);
  Exception exception=new InvalidQueryException("test");
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,null,null,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(body.getQueryString()).andReturn("blahblahblah");
  expect(compiler.compile("blahblahblah")).andThrow(exception);
  replay(compiler,uriInfo,queryParams,resource,resourceDefinition,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,queryParams,resource,resourceDefinition,body);
  assertEquals(400,processResult.getStatus().getStatusCode());
  assertTrue(processResult.getStatus().isErrorState());
  assertEquals("Unable to compile query predicate: test",processResult.getStatus().getMessage());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFields() throws Exception {
  String fields="prop,category/prop1,category2/category3/prop2[1,2,3],prop3[4,5,6],category4[7,8,9],sub-resource/*[10,11,12],finalProp";
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> mapQueryParams=createMock(MultivaluedMap.class);
  expect(uriInfo.getQueryParameters()).andReturn(mapQueryParams);
  expect(mapQueryParams.getFirst("fields")).andReturn(fields);
  replay(uriInfo,mapQueryParams);
  Request request=getTestRequest(null,null,uriInfo,null,null,null,null);
  Map<String,TemporalInfo> mapFields=request.getFields();
  assertEquals(7,mapFields.size());
  String prop="prop";
  assertTrue(mapFields.containsKey(prop));
  assertNull(mapFields.get(prop));
  String prop1=PropertyHelper.getPropertyId("category","prop1");
  assertTrue(mapFields.containsKey(prop1));
  assertNull(mapFields.get(prop1));
  String prop2=PropertyHelper.getPropertyId("category2/category3","prop2");
  assertTrue(mapFields.containsKey(prop2));
  assertEquals(new TemporalInfoImpl(1,2,3),mapFields.get(prop2));
  String prop3="prop3";
  assertTrue(mapFields.containsKey(prop3));
  assertEquals(new TemporalInfoImpl(4,5,6),mapFields.get(prop3));
  String category4="category4";
  assertTrue(mapFields.containsKey(category4));
  assertEquals(new TemporalInfoImpl(7,8,9),mapFields.get(category4));
  String subResource=PropertyHelper.getPropertyId("sub-resource","*");
  assertTrue(mapFields.containsKey(subResource));
  assertEquals(new TemporalInfoImpl(10,11,12),mapFields.get(subResource));
  String finalProp="finalProp";
  assertTrue(mapFields.containsKey(finalProp));
  assertNull(mapFields.get(finalProp));
  verify(uriInfo,mapQueryParams);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.NamedPropertySetTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  Map<String,Object> mapProps=new HashMap<String,Object>();
  mapProps.put("foo","bar");
  NamedPropertySet propertySet=new NamedPropertySet("foo",mapProps);
  NamedPropertySet propertySet2=new NamedPropertySet("foo",mapProps);
  assertEquals(propertySet,propertySet2);
  NamedPropertySet propertySet3=new NamedPropertySet("bar",mapProps);
  assertFalse(propertySet.equals(propertySet3));
  NamedPropertySet propertySet4=new NamedPropertySet("foo",new HashMap<String,Object>());
  assertFalse(propertySet.equals(propertySet4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.ViewSubResourceServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResultSerializer_Json() throws Exception {
  UriInfo uriInfo=createMock(UriInfo.class);
  Resource resource=createMock(Resource.class);
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  TreeNode<Resource> child=tree.addChild(resource,"resource1");
  child.setProperty("href","this is an href");
  HashMap<String,Object> mapRootProps=new HashMap<String,Object>();
  mapRootProps.put("prop1","value1");
  mapRootProps.put("prop2","value2");
  HashMap<String,Object> mapCategoryProps=new HashMap<String,Object>();
  mapCategoryProps.put("catProp1","catValue1");
  mapCategoryProps.put("catProp2","catValue2");
  Map<String,Map<String,Object>> propertyMap=new HashMap<String,Map<String,Object>>();
  propertyMap.put(null,mapRootProps);
  propertyMap.put("category",mapCategoryProps);
  expect(resource.getPropertiesMap()).andReturn(propertyMap).anyTimes();
  expect(resource.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(uriInfo,resource);
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  Resource.Type type=new Resource.Type("subResource");
  ViewSubResourceService service=new ViewSubResourceService(type,viewInstanceEntity);
  ResultSerializer serializer=service.getResultSerializer(MediaType.APPLICATION_JSON_TYPE);
  Object o=serializer.serialize(result);
  assertTrue(o instanceof Map);
  Map map=(Map)o;
  assertEquals(4,map.size());
  assertEquals("value1",map.get("prop1"));
  assertEquals("value2",map.get("prop2"));
  assertEquals("this is an href",map.get("href"));
  Object o2=map.get("category");
  assertNotNull(o2);
  assertTrue(o2 instanceof Map);
  Map subMap=(Map)o2;
  assertEquals(2,subMap.size());
  assertEquals("catValue1",subMap.get("catProp1"));
  assertEquals("catValue2",subMap.get("catProp2"));
  verify(uriInfo,resource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.parsers.JsonRequestBodyParserTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse_QueryPost() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostJson).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  boolean contains3=false;
  for (  NamedPropertySet ps : setProperties) {
    Map<String,Object> mapProps=ps.getProperties();
    assertEquals(1,mapProps.size());
    Set<Map<String,Object>> set=(Set<Map<String,Object>>)mapProps.get("services");
    for (    Map<String,Object> map : set) {
      String serviceName=(String)map.get("ServiceInfo/service_name");
      if (serviceName.equals("unitTestService1")) {
        assertEquals(1,map.size());
        contains1=true;
      }
 else       if (serviceName.equals("unitTestService2")) {
        assertEquals("prop1Value",map.get("ServiceInfo/property1"));
        assertEquals(2,map.size());
        contains2=true;
      }
 else       if (serviceName.equals("unitTestService3")) {
        assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
        assertEquals(2,map.size());
        contains3=true;
      }
 else {
        fail("Unexpected service name");
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  assertTrue(contains3);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
  assertEquals("java.util.LinkedHashSet",body.getNamedPropertySets().iterator().next().getProperties().get("services").getClass().getName());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse___QueryPost_QueryInBody() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostJsonWithQuery).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals("foo=bar",body.getQueryString());
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  boolean contains3=false;
  for (  NamedPropertySet ps : setProperties) {
    assertEquals("",ps.getName());
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      Set<Map<String,Object>> set=(Set<Map<String,Object>>)entry.getValue();
      for (      Map<String,Object> map : set) {
        String serviceName=(String)map.get("ServiceInfo/service_name");
        if (serviceName.equals("unitTestService1")) {
          assertEquals(1,map.size());
          contains1=true;
        }
 else         if (serviceName.equals("unitTestService2")) {
          assertEquals("prop1Value",map.get("ServiceInfo/property1"));
          assertEquals(2,map.size());
          contains2=true;
        }
 else         if (serviceName.equals("unitTestService3")) {
          assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
          assertEquals(2,map.size());
          contains3=true;
        }
 else {
          fail("Unexpected service name");
        }
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  assertTrue(contains3);
  String b=body.getBody();
  assertEquals(queryPostJsonWithQuery,b);
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse___QueryPost_multipleSubResTypes() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostMultipleSubResourcesJson).iterator().next();
  Set<NamedPropertySet> setProperties=body.getNamedPropertySets();
  assertEquals(1,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  for (  NamedPropertySet ps : setProperties) {
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      Set<Map<String,Object>> set=(Set<Map<String,Object>>)entry.getValue();
      for (      Map<String,Object> map : set) {
        String serviceName=(String)map.get("ServiceInfo/service_name");
        if (serviceName.equals("unitTestService1")) {
          assertEquals("foo",entry.getKey());
          assertEquals(1,map.size());
          contains1=true;
        }
 else         if (serviceName.equals("unitTestService2")) {
          assertEquals("bar",entry.getKey());
          assertEquals("prop2Value",map.get("ServiceInfo/Category/property2"));
          assertEquals(2,map.size());
          contains2=true;
        }
 else {
          fail("Unexpected service name");
        }
      }
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(1,setProps2.size());
  assertEquals(setProperties,setProps2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse_Array() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(arrayJson).iterator().next();
  Set<NamedPropertySet> setProps=body.getNamedPropertySets();
  assertEquals(3,setProps.size());
  boolean cluster1Matches=false;
  boolean cluster2Matches=false;
  boolean cluster3Matches=false;
  Map<String,String> mapCluster1=new HashMap<String,String>();
  mapCluster1.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster1");
  Map<String,String> mapCluster2=new HashMap<String,String>();
  mapCluster2.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster2");
  mapCluster2.put(PropertyHelper.getPropertyId("Clusters","property1"),"prop1Value");
  Map<String,String> mapCluster3=new HashMap<String,String>();
  mapCluster3.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster3");
  mapCluster3.put(PropertyHelper.getPropertyId("Clusters/Category","property2"),null);
  for (  NamedPropertySet propertySet : setProps) {
    assertEquals("",propertySet.getName());
    Map<String,Object> mapProps=propertySet.getProperties();
    if (mapProps.equals(mapCluster1)) {
      cluster1Matches=true;
    }
 else     if (mapProps.equals(mapCluster2)) {
      cluster2Matches=true;
    }
 else     if (mapProps.equals(mapCluster3)) {
      cluster3Matches=true;
    }
  }
  assertTrue(cluster1Matches);
  assertTrue(cluster2Matches);
  assertTrue(cluster3Matches);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(3,setProps2.size());
  assertEquals(setProps,setProps2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse___Array_NoArrayBrackets() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(arrayJson2).iterator().next();
  Set<NamedPropertySet> setProps=body.getNamedPropertySets();
  assertEquals(3,setProps.size());
  boolean cluster1Matches=false;
  boolean cluster2Matches=false;
  boolean cluster3Matches=false;
  Map<String,String> mapCluster1=new HashMap<String,String>();
  mapCluster1.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster1");
  Map<String,String> mapCluster2=new HashMap<String,String>();
  mapCluster2.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster2");
  mapCluster2.put(PropertyHelper.getPropertyId("Clusters","property1"),"prop1Value");
  Map<String,String> mapCluster3=new HashMap<String,String>();
  mapCluster3.put(PropertyHelper.getPropertyId("Clusters","cluster_name"),"unitTestCluster3");
  mapCluster3.put(PropertyHelper.getPropertyId("Clusters/Category","property2"),"prop2Value");
  for (  NamedPropertySet propertySet : setProps) {
    Map<String,Object> mapProps=propertySet.getProperties();
    if (mapProps.equals(mapCluster1)) {
      cluster1Matches=true;
    }
 else     if (mapProps.equals(mapCluster2)) {
      cluster2Matches=true;
    }
 else     if (mapProps.equals(mapCluster3)) {
      cluster3Matches=true;
    }
  }
  assertTrue(cluster1Matches);
  assertTrue(cluster2Matches);
  assertTrue(cluster3Matches);
  String b=body.getBody();
  body=parser.parse(b).iterator().next();
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(3,setProps2.size());
  assertEquals(setProps,setProps2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.serializers.CsvSerializerTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializeResources_NoColumnInfo() throws Exception {
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  List<TreeMap<String,Object>> data=new ArrayList<TreeMap<String,Object>>(){
{
      add(new TreeMap<String,Object>(){
{
          put("property1","value1a");
          put("property2","value2a");
          put("property3","value3a");
          put("property4","value4a");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1'b");
          put("property2","value2'b");
          put("property3","value3'b");
          put("property4","value4'b");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1,c");
          put("property2","value2,c");
          put("property3","value3,c");
          put("property4","value4,c");
        }
      }
);
    }
  }
;
  tree.setName("items");
  tree.setProperty("isCollection","true");
  addChildResource(tree,"resource",0,data.get(0));
  addChildResource(tree,"resource",1,data.get(1));
  addChildResource(tree,"resource",2,data.get(2));
  replayAll();
  Object o=new CsvSerializer().serialize(result).toString().replace("\r","");
  verifyAll();
  assertNotNull(o);
  StringReader reader=new StringReader(o.toString());
  CSVParser csvParser=new CSVParser(reader,CSVFormat.DEFAULT);
  List<CSVRecord> records=csvParser.getRecords();
  assertNotNull(records);
  assertEquals(3,records.size());
  int i=0;
  for (  CSVRecord record : records) {
    TreeMap<String,Object> actualData=data.get(i++);
    assertEquals(actualData.size(),record.size());
    for (    String item : record) {
      assertTrue(actualData.containsValue(item));
    }
  }
  csvParser.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorBlueprintProcessorTest </h4><pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdviseConfiguration() throws StackAdvisorException, ConfigurationTopologyException {
  Map<String,AdvisedConfiguration> advisedConfigurations=new HashMap<String,AdvisedConfiguration>();
  expect(clusterTopology.getBlueprint()).andReturn(blueprint).anyTimes();
  expect(clusterTopology.getHostGroupInfo()).andReturn(createHostGroupInfo()).anyTimes();
  expect(clusterTopology.getAdvisedConfigurations()).andReturn(advisedConfigurations).anyTimes();
  expect(clusterTopology.getConfiguration()).andReturn(configuration).anyTimes();
  expect(clusterTopology.isClusterKerberosEnabled()).andReturn(false).anyTimes();
  expect(clusterTopology.getConfigRecommendationStrategy()).andReturn(ConfigRecommendationStrategy.ALWAYS_APPLY);
  expect(blueprint.getStack()).andReturn(stack).anyTimes();
  expect(stack.getVersion()).andReturn("2.3").anyTimes();
  expect(stack.getName()).andReturn("HDP").anyTimes();
  expect(stack.getConfiguration(Arrays.asList("HDFS","YARN","HIVE"))).andReturn(createStackDefaults()).anyTimes();
  expect(blueprint.getServices()).andReturn(Arrays.asList("HDFS","YARN","HIVE")).anyTimes();
  expect(blueprint.getHostGroups()).andReturn(createHostGroupMap()).anyTimes();
  expect(hostGroup.getComponentNames()).andReturn(Arrays.asList("comp1","comp2")).anyTimes();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(createRecommendationResponse());
  expect(configuration.getFullProperties()).andReturn(createProps()).anyTimes();
  replay(clusterTopology,blueprint,stack,hostGroup,configuration,stackAdvisorHelper);
  underTest.adviseConfiguration(clusterTopology);
  assertTrue(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey1"));
  assertTrue(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey3"));
  assertTrue(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey2"));
  assertTrue(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey3"));
  assertEquals("dummyValue",advisedConfigurations.get("core-site").getProperties().get("dummyKey1"));
  assertEquals(Boolean.toString(true),advisedConfigurations.get("core-site").getPropertyValueAttributes().get("dummyKey2").getDelete());
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdviseConfigurationWithOnlyStackDefaultsApply() throws StackAdvisorException, ConfigurationTopologyException {
  Map<String,AdvisedConfiguration> advisedConfigurations=new HashMap<String,AdvisedConfiguration>();
  expect(clusterTopology.getBlueprint()).andReturn(blueprint).anyTimes();
  expect(clusterTopology.getHostGroupInfo()).andReturn(createHostGroupInfo()).anyTimes();
  expect(clusterTopology.getAdvisedConfigurations()).andReturn(advisedConfigurations).anyTimes();
  expect(clusterTopology.getConfiguration()).andReturn(configuration).anyTimes();
  expect(clusterTopology.isClusterKerberosEnabled()).andReturn(false).anyTimes();
  expect(clusterTopology.getConfigRecommendationStrategy()).andReturn(ConfigRecommendationStrategy.ONLY_STACK_DEFAULTS_APPLY);
  expect(blueprint.getStack()).andReturn(stack).anyTimes();
  expect(stack.getVersion()).andReturn("2.3").anyTimes();
  expect(stack.getName()).andReturn("HDP").anyTimes();
  expect(stack.getConfiguration(Arrays.asList("HDFS","YARN","HIVE"))).andReturn(createStackDefaults()).anyTimes();
  expect(blueprint.getServices()).andReturn(Arrays.asList("HDFS","YARN","HIVE")).anyTimes();
  expect(blueprint.getHostGroups()).andReturn(createHostGroupMap()).anyTimes();
  expect(hostGroup.getComponentNames()).andReturn(Arrays.asList("comp1","comp2")).anyTimes();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(createRecommendationResponse());
  expect(configuration.getFullProperties()).andReturn(createProps()).anyTimes();
  replay(clusterTopology,blueprint,stack,hostGroup,configuration,stackAdvisorHelper);
  underTest.adviseConfiguration(clusterTopology);
  assertTrue(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey1"));
  assertFalse(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey3"));
  assertTrue(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey2"));
  assertFalse(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey3"));
  assertEquals("dummyValue",advisedConfigurations.get("core-site").getProperties().get("dummyKey1"));
  assertEquals(Boolean.toString(true),advisedConfigurations.get("core-site").getPropertyValueAttributes().get("dummyKey2").getDelete());
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdviseConfigurationWithOnlyStackDefaultsApplyWhenNoUserInputForDefault() throws StackAdvisorException, ConfigurationTopologyException {
  Map<String,Map<String,String>> props=createProps();
  props.get("core-site").put("dummyKey3","stackDefaultValue");
  Map<String,AdvisedConfiguration> advisedConfigurations=new HashMap<String,AdvisedConfiguration>();
  expect(clusterTopology.getBlueprint()).andReturn(blueprint).anyTimes();
  expect(clusterTopology.getHostGroupInfo()).andReturn(createHostGroupInfo()).anyTimes();
  expect(clusterTopology.getAdvisedConfigurations()).andReturn(advisedConfigurations).anyTimes();
  expect(clusterTopology.getConfiguration()).andReturn(configuration).anyTimes();
  expect(clusterTopology.isClusterKerberosEnabled()).andReturn(false).anyTimes();
  expect(clusterTopology.getConfigRecommendationStrategy()).andReturn(ConfigRecommendationStrategy.ONLY_STACK_DEFAULTS_APPLY);
  expect(blueprint.getStack()).andReturn(stack).anyTimes();
  expect(stack.getVersion()).andReturn("2.3").anyTimes();
  expect(stack.getName()).andReturn("HDP").anyTimes();
  expect(stack.getConfiguration(Arrays.asList("HDFS","YARN","HIVE"))).andReturn(createStackDefaults()).anyTimes();
  expect(blueprint.getServices()).andReturn(Arrays.asList("HDFS","YARN","HIVE")).anyTimes();
  expect(blueprint.getHostGroups()).andReturn(createHostGroupMap()).anyTimes();
  expect(hostGroup.getComponentNames()).andReturn(Arrays.asList("comp1","comp2")).anyTimes();
  expect(stackAdvisorHelper.recommend(anyObject(StackAdvisorRequest.class))).andReturn(createRecommendationResponse());
  expect(configuration.getFullProperties()).andReturn(props).anyTimes();
  replay(clusterTopology,blueprint,stack,hostGroup,configuration,stackAdvisorHelper);
  underTest.adviseConfiguration(clusterTopology);
  assertTrue(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey1"));
  assertTrue(advisedConfigurations.get("core-site").getProperties().containsKey("dummyKey3"));
  assertTrue(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey2"));
  assertTrue(advisedConfigurations.get("core-site").getPropertyValueAttributes().containsKey("dummyKey3"));
  assertEquals("dummyValue",advisedConfigurations.get("core-site").getProperties().get("dummyKey1"));
  assertEquals(Boolean.toString(true),advisedConfigurations.get("core-site").getPropertyValueAttributes().get("dummyKey2").getDelete());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorHelperTest </h4><pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=StackAdvisorException.class) @SuppressWarnings("unchecked") public void testValidate_commandThrowsException_throwsException() throws StackAdvisorException, IOException {
  Configuration configuration=mock(Configuration.class);
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorHelper helper=spy(new StackAdvisorHelper(configuration,saRunner,metaInfo));
  StackAdvisorCommand<ValidationResponse> command=mock(StackAdvisorCommand.class);
  StackAdvisorRequestType requestType=StackAdvisorRequestType.HOST_GROUPS;
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").ofType(requestType).build();
  when(command.invoke(request)).thenThrow(new StackAdvisorException("message"));
  doReturn(command).when(helper).createValidationCommand(requestType);
  helper.validate(request);
  assertTrue(false);
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=StackAdvisorException.class) @SuppressWarnings("unchecked") public void testRecommend_commandThrowsException_throwsException() throws StackAdvisorException, IOException {
  Configuration configuration=mock(Configuration.class);
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorHelper helper=spy(new StackAdvisorHelper(configuration,saRunner,metaInfo));
  StackAdvisorCommand<RecommendationResponse> command=mock(StackAdvisorCommand.class);
  StackAdvisorRequestType requestType=StackAdvisorRequestType.HOST_GROUPS;
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").ofType(requestType).build();
  when(command.invoke(request)).thenThrow(new StackAdvisorException("message"));
  doReturn(command).when(helper).createRecommendationCommand(requestType);
  helper.recommend(request);
  assertTrue(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.StackAdvisorRequestTypeTest </h4><pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=StackAdvisorException.class) public void testFromString_throwsException() throws StackAdvisorException {
  String text="unknown_type";
  StackAdvisorRequestType.fromString(text);
  assertTrue(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.ConfigurationRecommendationCommandTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessHostGroups() throws Exception {
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  File file=mock(File.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  ConfigurationRecommendationCommand command=new ConfigurationRecommendationCommand(file,"script",1,saRunner,metaInfo);
  StackAdvisorRequest request=mock(StackAdvisorRequest.class);
  Map<String,Set<String>> componentHostGroupMap=new HashMap<String,Set<String>>();
  Set<String> components1=new HashSet<String>();
  components1.add("component1");
  components1.add("component4");
  components1.add("component5");
  componentHostGroupMap.put("group1",components1);
  Set<String> components2=new HashSet<String>();
  components2.add("component2");
  components2.add("component3");
  componentHostGroupMap.put("group2",components2);
  doReturn(componentHostGroupMap).when(request).getHostComponents();
  Set<RecommendationResponse.HostGroup> hostGroups=command.processHostGroups(request);
  assertNotNull(hostGroups);
  assertEquals(2,hostGroups.size());
  Map<String,RecommendationResponse.HostGroup> hostGroupMap=new HashMap<String,RecommendationResponse.HostGroup>();
  for (  RecommendationResponse.HostGroup hostGroup : hostGroups) {
    hostGroupMap.put(hostGroup.getName(),hostGroup);
  }
  RecommendationResponse.HostGroup hostGroup1=hostGroupMap.get("group1");
  assertNotNull(hostGroup1);
  Set<Map<String,String>> host1Components=hostGroup1.getComponents();
  assertNotNull(host1Components);
  assertEquals(3,host1Components.size());
  Set<String> componentNames1=new HashSet<String>();
  for (  Map<String,String> host1Component : host1Components) {
    assertNotNull(host1Component);
    assertEquals(1,host1Component.size());
    String componentName=host1Component.get("name");
    assertNotNull(componentName);
    componentNames1.add(componentName);
  }
  assertEquals(3,componentNames1.size());
  assertTrue(componentNames1.contains("component1"));
  assertTrue(componentNames1.contains("component4"));
  assertTrue(componentNames1.contains("component5"));
  RecommendationResponse.HostGroup hostGroup2=hostGroupMap.get("group2");
  assertNotNull(hostGroup2);
  Set<Map<String,String>> host2Components=hostGroup2.getComponents();
  assertNotNull(host2Components);
  assertEquals(2,host2Components.size());
  Set<String> componentNames2=new HashSet<String>();
  for (  Map<String,String> host2Component : host2Components) {
    assertNotNull(host2Component);
    assertEquals(1,host2Component.size());
    String componentName=host2Component.get("name");
    assertNotNull(componentName);
    componentNames2.add(componentName);
  }
  assertEquals(2,componentNames2.size());
  assertTrue(componentNames2.contains("component2"));
  assertTrue(componentNames2.contains("component3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.StackAdvisorCommandTest </h4><pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=StackAdvisorException.class) public void testInvoke_saRunnerNotSucceed_throwsException() throws StackAdvisorException {
  File recommendationsDir=temp.newFolder("recommendationDir");
  String stackAdvisorScript="echo";
  int requestId=0;
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  doReturn(Collections.emptyList()).when(metaInfo).getStackParentVersions(anyString(),anyString());
  StackAdvisorCommand<TestResource> command=spy(new TestStackAdvisorCommand(recommendationsDir,stackAdvisorScript,requestId,saRunner,metaInfo));
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").build();
  String hostsJSON="{\"hosts\" : \"localhost\"";
  String servicesJSON="{\"services\" : \"HDFS\"";
  StackAdvisorData data=new StackAdvisorData(hostsJSON,servicesJSON);
  doReturn(hostsJSON).when(command).getHostsInformation(request);
  doReturn(servicesJSON).when(command).getServicesInformation(request);
  doReturn(data).when(command).adjust(any(StackAdvisorData.class),any(StackAdvisorRequest.class));
  doThrow(new StackAdvisorRequestException("error")).when(saRunner).runScript(any(String.class),any(StackAdvisorCommandType.class),any(File.class));
  command.invoke(request);
  assertTrue(false);
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=WebApplicationException.class) public void testInvoke_adjustThrowsException_throwsException() throws StackAdvisorException {
  File recommendationsDir=temp.newFolder("recommendationDir");
  String stackAdvisorScript="echo";
  int requestId=0;
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  doReturn(Collections.emptyList()).when(metaInfo).getStackParentVersions(anyString(),anyString());
  StackAdvisorCommand<TestResource> command=spy(new TestStackAdvisorCommand(recommendationsDir,stackAdvisorScript,requestId,saRunner,metaInfo));
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").build();
  doReturn("{\"hosts\" : \"localhost\"").when(command).getHostsInformation(request);
  doReturn("{\"services\" : \"HDFS\"").when(command).getServicesInformation(request);
  doThrow(new WebApplicationException()).when(command).adjust(any(StackAdvisorData.class),any(StackAdvisorRequest.class));
  doThrow(new StackAdvisorException("error")).when(saRunner).runScript(any(String.class),any(StackAdvisorCommandType.class),any(File.class));
  command.invoke(request);
  assertTrue(false);
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=StackAdvisorException.class) public void testInvoke_invalidRequest_throwsException() throws StackAdvisorException {
  File recommendationsDir=temp.newFolder("recommendationDir");
  String stackAdvisorScript="echo";
  int requestId=0;
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  doReturn(Collections.emptyList()).when(metaInfo).getStackParentVersions(anyString(),anyString());
  StackAdvisorCommand<TestResource> command=spy(new TestStackAdvisorCommand(recommendationsDir,stackAdvisorScript,requestId,saRunner,metaInfo));
  StackAdvisorRequest request=StackAdvisorRequestBuilder.forStack("stackName","stackVersion").build();
  doThrow(new StackAdvisorException("message")).when(command).validate(request);
  command.invoke(request);
  assertTrue(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.bootstrap.BootStrapTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPolling() throws Exception {
  File tmpFolder=temp.newFolder("bootstrap");
  FileUtils.writeStringToFile(new File(tmpFolder,"host1.done"),"0");
  FileUtils.writeStringToFile(new File(tmpFolder,"host1.log"),"err_log_1");
  FileUtils.writeStringToFile(new File(tmpFolder,"host2.done"),"1");
  FileUtils.writeStringToFile(new File(tmpFolder,"host2.log"),"err_log_2");
  List<String> listHosts=new ArrayList<String>();
  listHosts.add("host1");
  listHosts.add("host2");
  BSHostStatusCollector collector=new BSHostStatusCollector(tmpFolder,listHosts);
  collector.run();
  List<BSHostStatus> polledHostStatus=collector.getHostStatus();
  Assert.assertTrue(polledHostStatus.size() == 2);
  Assert.assertEquals(polledHostStatus.get(0).getHostName(),"host1");
  Assert.assertEquals(polledHostStatus.get(0).getLog(),"err_log_1");
  Assert.assertEquals(polledHostStatus.get(0).getStatus(),"DONE");
  Assert.assertEquals(polledHostStatus.get(1).getHostName(),"host2");
  Assert.assertEquals(polledHostStatus.get(1).getLog(),"err_log_2");
  Assert.assertEquals(polledHostStatus.get(1).getStatus(),"FAILED");
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun() throws Exception {
  Properties properties=new Properties();
  String bootdir=temp.newFolder("bootdir").toString();
  String metadetadir=temp.newFolder("metadetadir").toString();
  String serverVersionFilePath=temp.newFolder("serverVersionFilePath").toString();
  LOG.info("Bootdir is " + bootdir);
  LOG.info("Metadetadir is " + metadetadir);
  LOG.info("ServerVersionFilePath is " + serverVersionFilePath);
  String sharedResourcesDir="src/test/resources/";
  if (System.getProperty("os.name").contains("Windows")) {
    sharedResourcesDir=ClassLoader.getSystemClassLoader().getResource("").getPath();
  }
  properties.setProperty(Configuration.BOOTSTRAP_DIR,bootdir);
  properties.setProperty(Configuration.BOOTSTRAP_SCRIPT,prepareEchoCommand(bootdir));
  properties.setProperty(Configuration.SRVR_KSTR_DIR_KEY,"target" + File.separator + "classes");
  properties.setProperty(Configuration.METADATA_DIR_PATH,metadetadir);
  properties.setProperty(Configuration.SERVER_VERSION_FILE,serverVersionFilePath);
  properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,sharedResourcesDir);
  Configuration conf=new Configuration(properties);
  AmbariMetaInfo ambariMetaInfo=new AmbariMetaInfo(conf);
  BootStrapImpl impl=new BootStrapImpl(conf,ambariMetaInfo);
  impl.init();
  SshHostInfo info=new SshHostInfo();
  info.setSshKey("xyz");
  ArrayList<String> hosts=new ArrayList<String>();
  hosts.add("host1");
  hosts.add("host2");
  info.setUserRunAs("root");
  info.setHosts(hosts);
  info.setUser("user");
  info.setPassword("passwd");
  BSResponse response=impl.runBootStrap(info);
  LOG.info("Response id from bootstrap " + response.getRequestId());
  BootStrapStatus status=impl.getStatus(response.getRequestId());
  LOG.info("Status " + status.getStatus());
  int num=0;
  while ((status.getStatus() == BSStat.RUNNING) && (num < 50)) {
    status=impl.getStatus(response.getRequestId());
    Thread.sleep(1000);
    num++;
  }
  Thread.sleep(5000);
  LOG.info("Status: log " + status.getLog() + " status="+ status.getStatus());
  Assert.assertTrue(status.getLog().contains("host1,host2"));
  Assert.assertEquals(BSStat.SUCCESS,status.getStatus());
  Assert.assertFalse(new File(bootdir + File.separator + "1"+ File.separator+ "sshKey").exists());
  Assert.assertFalse(new File(bootdir + File.separator + "1"+ File.separator+ "host_pass").exists());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostFailure() throws Exception {
  Properties properties=new Properties();
  String bootdir=temp.newFolder("bootdir").toString();
  String metadetadir=temp.newFolder("metadetadir").toString();
  String serverVersionFilePath=temp.newFolder("serverVersionFilePath").toString();
  LOG.info("Bootdir is " + bootdir);
  LOG.info("Metadetadir is " + metadetadir);
  LOG.info("ServerVersionFilePath is " + serverVersionFilePath);
  String sharedResourcesDir="src/test/resources/";
  String serverKSTRDir="target" + File.separator + "classes";
  if (System.getProperty("os.name").contains("Windows")) {
    sharedResourcesDir=ClassLoader.getSystemClassLoader().getResource("").getPath();
    serverKSTRDir=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"classes").getPath();
  }
  properties.setProperty(Configuration.BOOTSTRAP_DIR,bootdir);
  properties.setProperty(Configuration.BOOTSTRAP_SCRIPT,prepareEchoCommand(bootdir));
  properties.setProperty(Configuration.SRVR_KSTR_DIR_KEY,serverKSTRDir);
  properties.setProperty(Configuration.METADATA_DIR_PATH,metadetadir);
  properties.setProperty(Configuration.SERVER_VERSION_FILE,serverVersionFilePath);
  properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,sharedResourcesDir);
  Configuration conf=new Configuration(properties);
  AmbariMetaInfo ambariMetaInfo=new AmbariMetaInfo(conf);
  BootStrapImpl impl=new BootStrapImpl(conf,ambariMetaInfo);
  impl.init();
  SshHostInfo info=new SshHostInfo();
  info.setSshKey("xyz");
  ArrayList<String> hosts=new ArrayList<String>();
  hosts.add("host1");
  hosts.add("host2");
  info.setHosts(hosts);
  info.setUser("user");
  info.setUserRunAs("root");
  info.setPassword("passwd");
  BSResponse response=impl.runBootStrap(info);
  long requestId=response.getRequestId();
  LOG.info("Response id from bootstrap " + requestId);
  File requestDir=new File(bootdir,Long.toString(requestId));
  int num=0;
  while (!requestDir.exists() && num < 500) {
    Thread.sleep(100);
    num++;
  }
  if (!requestDir.exists()) {
    LOG.warn("RequestDir does not exists");
  }
  FileUtils.writeStringToFile(new File(requestDir,"host1.done"),"0");
  FileUtils.writeStringToFile(new File(requestDir,"host2.done"),"1");
  BootStrapStatus status=impl.getStatus(response.getRequestId());
  LOG.info("Status " + status.getStatus());
  num=0;
  while ((status.getStatus() == BSStat.RUNNING) && (num < 500)) {
    status=impl.getStatus(response.getRequestId());
    Thread.sleep(100);
    num++;
  }
  LOG.info("Status: log " + status.getLog() + " status="+ status.getStatus());
  Assert.assertTrue(status.getLog().contains("host1,host2"));
  Assert.assertEquals(BSStat.ERROR,status.getStatus());
  Assert.assertEquals("DONE",status.getHostsStatus().get(0).getStatus());
  Assert.assertEquals("FAILED",status.getHostsStatus().get(1).getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ClientRetryPropertyCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(m_clusters.getCluster("cluster")).thenReturn(cluster);
  Map<String,Service> services=new HashMap<String,Service>();
  Mockito.when(cluster.getServices()).thenReturn(services);
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setRepositoryVersion("2.3.0.0");
  Assert.assertFalse(m_check.isApplicable(request));
  services.put("HDFS",Mockito.mock(Service.class));
  Assert.assertTrue(m_check.isApplicable(request));
  services.clear();
  services.put("OOZIE",Mockito.mock(Service.class));
  Assert.assertTrue(m_check.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ComponentsInstallationCheckTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerform() throws Exception {
  PowerMockito.mockStatic(HostComponentSummary.class);
  final ComponentsInstallationCheck componentsInstallationCheck=new ComponentsInstallationCheck();
  componentsInstallationCheck.clustersProvider=new Provider<Clusters>(){
    @Override public Clusters get(){
      return clusters;
    }
  }
;
  componentsInstallationCheck.ambariMetaInfo=new Provider<AmbariMetaInfo>(){
    @Override public AmbariMetaInfo get(){
      return ambariMetaInfo;
    }
  }
;
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP","2.2"));
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  final Service hdfsService=Mockito.mock(Service.class);
  final Service tezService=Mockito.mock(Service.class);
  final Service amsService=Mockito.mock(Service.class);
  Mockito.when(hdfsService.getMaintenanceState()).thenReturn(MaintenanceState.OFF);
  Mockito.when(tezService.getMaintenanceState()).thenReturn(MaintenanceState.OFF);
  Mockito.when(amsService.getMaintenanceState()).thenReturn(MaintenanceState.OFF);
  HashMap<String,Service> clusterServices=new HashMap<String,Service>();
  clusterServices.put("HDFS",hdfsService);
  clusterServices.put("TEZ",tezService);
  clusterServices.put("AMBARI_METRICS",amsService);
  Mockito.when(hdfsService.getName()).thenReturn("HDFS");
  Mockito.when(tezService.getName()).thenReturn("TEZ");
  Mockito.when(amsService.getName()).thenReturn("AMBARI_METRICS");
  Mockito.when(hdfsService.isClientOnlyService()).thenReturn(false);
  Mockito.when(tezService.isClientOnlyService()).thenReturn(true);
  Mockito.when(amsService.isClientOnlyService()).thenReturn(false);
  Mockito.when(cluster.getServices()).thenReturn(clusterServices);
  Mockito.when(ambariMetaInfo.getComponent(Mockito.anyString(),Mockito.anyString(),Mockito.anyString(),Mockito.anyString())).thenAnswer(new Answer<ComponentInfo>(){
    @Override public ComponentInfo answer(    InvocationOnMock invocation) throws Throwable {
      ComponentInfo anyInfo=Mockito.mock(ComponentInfo.class);
      if (invocation.getArguments().length > 3 && "DATANODE".equals(invocation.getArguments()[3])) {
        Mockito.when(anyInfo.getCardinality()).thenReturn("1+");
      }
 else {
        Mockito.when(anyInfo.getCardinality()).thenReturn(null);
      }
      return anyInfo;
    }
  }
);
  Map<String,ServiceComponent> hdfsComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent nameNode=Mockito.mock(ServiceComponent.class);
  Mockito.when(nameNode.getName()).thenReturn("NAMENODE");
  Mockito.when(nameNode.isClientComponent()).thenReturn(false);
  Mockito.when(nameNode.isVersionAdvertised()).thenReturn(true);
  Mockito.when(nameNode.isMasterComponent()).thenReturn(true);
  ServiceComponent dataNode=Mockito.mock(ServiceComponent.class);
  Mockito.when(dataNode.getName()).thenReturn("DATANODE");
  Mockito.when(dataNode.isClientComponent()).thenReturn(false);
  Mockito.when(dataNode.isVersionAdvertised()).thenReturn(true);
  Mockito.when(dataNode.isMasterComponent()).thenReturn(false);
  ServiceComponent zkfc=Mockito.mock(ServiceComponent.class);
  Mockito.when(zkfc.getName()).thenReturn("ZKFC");
  Mockito.when(zkfc.isClientComponent()).thenReturn(false);
  Mockito.when(zkfc.isVersionAdvertised()).thenReturn(false);
  Mockito.when(zkfc.isMasterComponent()).thenReturn(false);
  hdfsComponents.put("NAMENODE",nameNode);
  hdfsComponents.put("DATANODE",dataNode);
  hdfsComponents.put("ZKFC",zkfc);
  Mockito.when(hdfsService.getServiceComponents()).thenReturn(hdfsComponents);
  Map<String,ServiceComponent> tezComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent tezClient=Mockito.mock(ServiceComponent.class);
  Mockito.when(tezClient.getName()).thenReturn("TEZ_CLIENT");
  Mockito.when(tezClient.isClientComponent()).thenReturn(true);
  Mockito.when(tezClient.isVersionAdvertised()).thenReturn(true);
  tezComponents.put("TEZ_CLIENT",tezClient);
  Mockito.when(tezService.getServiceComponents()).thenReturn(tezComponents);
  Map<String,ServiceComponent> amsComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent metricsCollector=Mockito.mock(ServiceComponent.class);
  Mockito.when(metricsCollector.getName()).thenReturn("METRICS_COLLECTOR");
  Mockito.when(metricsCollector.isClientComponent()).thenReturn(false);
  Mockito.when(metricsCollector.isVersionAdvertised()).thenReturn(false);
  ServiceComponent metricsMonitor=Mockito.mock(ServiceComponent.class);
  Mockito.when(metricsMonitor.getName()).thenReturn("METRICS_MONITOR");
  Mockito.when(metricsMonitor.isClientComponent()).thenReturn(false);
  Mockito.when(metricsMonitor.isVersionAdvertised()).thenReturn(false);
  amsComponents.put("METRICS_COLLECTOR",metricsCollector);
  amsComponents.put("METRICS_MONITOR",metricsMonitor);
  Mockito.when(amsService.getServiceComponents()).thenReturn(amsComponents);
  final HostComponentSummary hcsNameNode=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode1=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode2=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode3=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsZKFC=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsTezClient=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsMetricsCollector=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsMetricsMonitor=Mockito.mock(HostComponentSummary.class);
  List<HostComponentSummary> allHostComponentSummaries=new ArrayList<HostComponentSummary>();
  allHostComponentSummaries.add(hcsNameNode);
  allHostComponentSummaries.add(hcsDataNode1);
  allHostComponentSummaries.add(hcsDataNode2);
  allHostComponentSummaries.add(hcsDataNode3);
  allHostComponentSummaries.add(hcsZKFC);
  allHostComponentSummaries.add(hcsTezClient);
  allHostComponentSummaries.add(hcsMetricsCollector);
  allHostComponentSummaries.add(hcsMetricsMonitor);
  final Map<String,Host> hosts=new HashMap<String,Host>();
  final Host host1=Mockito.mock(Host.class);
  final Host host2=Mockito.mock(Host.class);
  final Host host3=Mockito.mock(Host.class);
  Mockito.when(host1.getMaintenanceState(1L)).thenReturn(MaintenanceState.OFF);
  Mockito.when(host2.getMaintenanceState(1L)).thenReturn(MaintenanceState.OFF);
  Mockito.when(host3.getMaintenanceState(1L)).thenReturn(MaintenanceState.OFF);
  hosts.put("host1",host1);
  hosts.put("host2",host2);
  hosts.put("host3",host3);
  Mockito.when(hcsNameNode.getHostName()).thenReturn("host1");
  Mockito.when(hcsDataNode1.getHostName()).thenReturn("host1");
  Mockito.when(hcsDataNode2.getHostName()).thenReturn("host2");
  Mockito.when(hcsDataNode3.getHostName()).thenReturn("host3");
  Mockito.when(hcsZKFC.getHostName()).thenReturn("host1");
  Mockito.when(hcsTezClient.getHostName()).thenReturn("host2");
  Mockito.when(hcsMetricsCollector.getHostName()).thenReturn("host3");
  Mockito.when(hcsMetricsMonitor.getHostName()).thenReturn("host3");
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","NAMENODE")).thenReturn(Arrays.asList(hcsNameNode));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","DATANODE")).thenReturn(Arrays.asList(hcsDataNode1,hcsDataNode2,hcsDataNode3));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","ZKFC")).thenReturn(Arrays.asList(hcsZKFC));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("TEZ","TEZ_CLIENT")).thenReturn(Arrays.asList(hcsTezClient));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("AMBARI_METRICS","METRICS_COLLECTOR")).thenReturn(Arrays.asList(hcsMetricsCollector));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("AMBARI_METRICS","METRICS_MONITOR")).thenReturn(Arrays.asList(hcsMetricsMonitor));
  for (  String hostName : hosts.keySet()) {
    Mockito.when(clusters.getHost(hostName)).thenReturn(hosts.get(hostName));
  }
  for (  HostComponentSummary hcs : allHostComponentSummaries) {
    Mockito.when(hcs.getDesiredState()).thenReturn(State.INSTALLED);
    Mockito.when(hcs.getCurrentState()).thenReturn(State.STARTED);
  }
  Mockito.when(hcsTezClient.getCurrentState()).thenReturn(State.INSTALLED);
  PrerequisiteCheck check=new PrerequisiteCheck(null,null);
  componentsInstallationCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsMetricsCollector.getCurrentState()).thenReturn(State.INSTALL_FAILED);
  Mockito.when(hcsMetricsMonitor.getCurrentState()).thenReturn(State.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  componentsInstallationCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsTezClient.getCurrentState()).thenReturn(State.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  componentsInstallationCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertTrue(check.getFailReason().indexOf("Service components in INSTALL_FAILED state") > -1);
  Mockito.when(tezService.getMaintenanceState()).thenReturn(MaintenanceState.ON);
  Mockito.when(hcsTezClient.getCurrentState()).thenReturn(State.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  componentsInstallationCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(tezService.getMaintenanceState()).thenReturn(MaintenanceState.OFF);
  Mockito.when(host2.getMaintenanceState(1L)).thenReturn(MaintenanceState.ON);
  Mockito.when(hcsTezClient.getCurrentState()).thenReturn(State.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  componentsInstallationCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest("c1");
  checkRequest.setRepositoryVersion("HDP-2.2.0.0");
  checkRequest.setSourceStackId(new StackId("HDP","2.2"));
  checkRequest.setTargetStackId(new StackId("HDP","2.2"));
  ComponentsInstallationCheck cic=new ComponentsInstallationCheck();
  Configuration config=Mockito.mock(Configuration.class);
  cic.config=config;
  Assert.assertTrue(cic.isApplicable(checkRequest));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ConfigurationMergeCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplicable() throws Exception {
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setTargetStackId(stackId_1_0);
  ConfigurationMergeCheck cmc=new ConfigurationMergeCheck();
  Configuration config=EasyMock.createMock(Configuration.class);
  replay(config);
  cmc.config=config;
  Assert.assertTrue(cmc.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.HiveMultipleMetastoreCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that the check is applicable when hive is installed.
 * @throws Exception
 */
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(m_clusters.getCluster("cluster")).thenReturn(cluster);
  Map<String,Service> services=new HashMap<String,Service>();
  Mockito.when(cluster.getServices()).thenReturn(services);
  services.put("HDFS",Mockito.mock(Service.class));
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setRepositoryVersion("2.3.0.0");
  Assert.assertFalse(m_check.isApplicable(request));
  services.put("HIVE",Mockito.mock(Service.class));
  Assert.assertTrue(m_check.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.HostsHeartbeatCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest("c1");
  checkRequest.setRepositoryVersion("HDP-2.2.0.0");
  checkRequest.setSourceStackId(new StackId("HDP","2.2"));
  checkRequest.setTargetStackId(new StackId("HDP","2.2"));
  HostsHeartbeatCheck hhc=new HostsHeartbeatCheck();
  Configuration config=Mockito.mock(Configuration.class);
  hhc.config=config;
  Assert.assertTrue(hhc.isApplicable(checkRequest));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.HostsMasterMaintenanceCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setRepositoryVersion("not null");
  HostsMasterMaintenanceCheck hmmc=new HostsMasterMaintenanceCheck();
  Configuration config=Mockito.mock(Configuration.class);
  hmmc.config=config;
  Assert.assertTrue(hmmc.isApplicable(request));
  Assert.assertTrue(new HostsMasterMaintenanceCheck().isApplicable(request));
  HostsMasterMaintenanceCheck hmmc2=new HostsMasterMaintenanceCheck();
  hmmc2.config=config;
  Assert.assertTrue(hmmc2.isApplicable(request));
  request.setRepositoryVersion(null);
  hmmc2.config=config;
  Assert.assertFalse(hmmc2.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.HostsRepositoryVersionCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setRepositoryVersion("not null");
  HostsRepositoryVersionCheck hrvc=new HostsRepositoryVersionCheck();
  Configuration config=Mockito.mock(Configuration.class);
  hrvc.config=config;
  Assert.assertTrue(hrvc.isApplicable(request));
  Assert.assertTrue(new HostsMasterMaintenanceCheck().isApplicable(request));
  HostsRepositoryVersionCheck hrvc2=new HostsRepositoryVersionCheck();
  hrvc2.config=config;
  Assert.assertTrue(hrvc2.isApplicable(request));
  request.setRepositoryVersion(null);
  HostsMasterMaintenanceCheck hmmc2=new HostsMasterMaintenanceCheck();
  hmmc2.config=config;
  Assert.assertFalse(hmmc2.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.InstallPackagesCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest(clusterName);
  checkRequest.setRepositoryVersion(repositoryVersion);
  checkRequest.setSourceStackId(sourceStackId);
  checkRequest.setTargetStackId(targetStackId);
  InstallPackagesCheck ipc=new InstallPackagesCheck();
  Configuration config=Mockito.mock(Configuration.class);
  ipc.config=config;
  Assert.assertTrue(ipc.isApplicable(checkRequest));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerform() throws Exception {
  StackId stackId=new StackId("HDP","2.2");
  PowerMockito.mockStatic(HostComponentSummary.class);
  final InstallPackagesCheck installPackagesCheck=new InstallPackagesCheck();
  installPackagesCheck.clustersProvider=new Provider<Clusters>(){
    @Override public Clusters get(){
      return clusters;
    }
  }
;
  installPackagesCheck.ambariMetaInfo=new Provider<AmbariMetaInfo>(){
    @Override public AmbariMetaInfo get(){
      return ambariMetaInfo;
    }
  }
;
  installPackagesCheck.clusterVersionDAOProvider=new Provider<ClusterVersionDAO>(){
    @Override public ClusterVersionDAO get(){
      return clusterVersionDAO;
    }
  }
;
  installPackagesCheck.hostVersionDaoProvider=new Provider<HostVersionDAO>(){
    @Override public HostVersionDAO get(){
      return hostVersionDAO;
    }
  }
;
  installPackagesCheck.repositoryVersionDaoProvider=new Provider<RepositoryVersionDAO>(){
    @Override public RepositoryVersionDAO get(){
      return repositoryVersionDAO;
    }
  }
;
  StackEntity stack=new StackEntity();
  stack.setStackName(stackId.getStackName());
  stack.setStackVersion(stackId.getStackVersion());
  RepositoryVersionEntity rve=new RepositoryVersionEntity(stack,repositoryVersion,repositoryVersion,"rhel6");
  Mockito.when(repositoryVersionDAO.findByStackNameAndVersion(Mockito.anyString(),Mockito.anyString())).thenReturn(rve);
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterName()).thenReturn(clusterName);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(stackId);
  Mockito.when(clusters.getCluster(clusterName)).thenReturn(cluster);
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALLED);
  Mockito.when(clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,targetStackId,repositoryVersion)).thenReturn(clusterVersionEntity);
  final List<String> hostNames=new ArrayList<String>();
  hostNames.add("host1");
  hostNames.add("host2");
  hostNames.add("host3");
  final List<Host> hosts=new ArrayList<Host>();
  final List<HostVersionEntity> hostVersionEntities=new ArrayList<HostVersionEntity>();
  for (  String hostName : hostNames) {
    Host host=Mockito.mock(Host.class);
    host.setHostName(hostName);
    Mockito.when(host.getHostName()).thenReturn(hostName);
    Mockito.when(host.getMaintenanceState(1L)).thenReturn(MaintenanceState.OFF);
    hosts.add(host);
    HostVersionEntity hve=Mockito.mock(HostVersionEntity.class);
    Mockito.when(hve.getRepositoryVersion()).thenReturn(rve);
    Mockito.when(hve.getState()).thenReturn(RepositoryVersionState.INSTALLED);
    hostVersionEntities.add(hve);
    Mockito.when(hostVersionDAO.findByHost(hostName)).thenReturn(Collections.singletonList(hve));
  }
  Mockito.when(cluster.getHosts()).thenReturn(hosts);
  PrereqCheckRequest checkRequest=new PrereqCheckRequest(clusterName);
  checkRequest.setRepositoryVersion(repositoryVersion);
  checkRequest.setSourceStackId(sourceStackId);
  checkRequest.setTargetStackId(targetStackId);
  PrerequisiteCheck check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hostVersionEntities.get(0).getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertNotNull(check.getFailedOn());
  Assert.assertTrue(check.getFailedOn().contains("host1"));
  Mockito.when(hostVersionEntities.get(0).getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  Mockito.when(hosts.get(0).getMaintenanceState(1L)).thenReturn(MaintenanceState.ON);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertNotNull(check.getFailedOn());
  Assert.assertTrue(check.getFailedOn().contains(clusterName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.MapReduce2JobHistoryStatePreservingCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(m_clusters.getCluster("cluster")).thenReturn(cluster);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP-2.3"));
  Map<String,Service> services=new HashMap<String,Service>();
  Mockito.when(cluster.getServices()).thenReturn(services);
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(cluster.getCurrentClusterVersion()).thenReturn(clusterVersionEntity);
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setTargetStackId(new StackId("HDP","2.3.1.1"));
  request.setSourceStackId(new StackId("HDP","2.3.0.0"));
  Assert.assertFalse(m_check.isApplicable(request));
  services.put("MAPREDUCE2",Mockito.mock(Service.class));
  Assert.assertTrue(m_check.isApplicable(request));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("serial") @Test public void testIsApplicableMinimumStackVersion() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getServices()).thenReturn(new HashMap<String,Service>(){
{
      put("MAPREDUCE2",null);
    }
  }
);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("MYSTACK-12.2"));
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(cluster.getCurrentClusterVersion()).thenReturn(clusterVersionEntity);
  RepositoryVersionEntity repositoryVersionEntity=Mockito.mock(RepositoryVersionEntity.class);
  Mockito.when(clusterVersionEntity.getRepositoryVersion()).thenReturn(repositoryVersionEntity);
  Mockito.when(m_clusters.getCluster("c1")).thenReturn(cluster);
  PrereqCheckRequest request=new PrereqCheckRequest("c1");
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.0.0.1");
  boolean isApplicable=m_check.isApplicable(request);
  Assert.assertTrue(isApplicable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.RangerPasswordCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplicable() throws Exception {
  final Service service=EasyMock.createMock(Service.class);
  Map<String,Service> services=new HashMap<>();
  services.put("RANGER",service);
  Cluster cluster=m_clusters.getCluster("cluster");
  EasyMock.reset(cluster);
  expect(cluster.getServices()).andReturn(services).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP-2.3")).anyTimes();
  replay(cluster);
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setSourceStackId(new StackId("HDP-2.3"));
  assertTrue(m_rpc.isApplicable(request));
  request=new PrereqCheckRequest("cluster");
  request.setSourceStackId(new StackId("HDP-2.2"));
  assertFalse(m_rpc.isApplicable(request));
  EasyMock.reset(cluster);
  expect(cluster.getServices()).andReturn(services).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("WILDSTACK-2.0")).anyTimes();
  replay(cluster);
  request=new PrereqCheckRequest("cluster");
  request.setSourceStackId(new StackId("HDP-2.2"));
  assertTrue(m_rpc.isApplicable(request));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.SecondaryNamenodeDeletedCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  final Map<String,Service> services=new HashMap<>();
  final Service service=Mockito.mock(Service.class);
  services.put("HDFS",service);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getServices()).thenReturn(services);
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  Assert.assertTrue(secondaryNamenodeDeletedCheck.isApplicable(new PrereqCheckRequest("cluster")));
  PrereqCheckRequest req=new PrereqCheckRequest("cluster");
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.FAIL);
  Assert.assertFalse(secondaryNamenodeDeletedCheck.isApplicable(req));
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.PASS);
  Assert.assertTrue(secondaryNamenodeDeletedCheck.isApplicable(req));
  services.remove("HDFS");
  Assert.assertFalse(secondaryNamenodeDeletedCheck.isApplicable(new PrereqCheckRequest("cluster")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesMaintenanceModeCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest("c1");
  checkRequest.setRepositoryVersion("HDP-2.2.0.0");
  checkRequest.setSourceStackId(new StackId("HDP","2.2"));
  checkRequest.setTargetStackId(new StackId("HDP","2.2"));
  ServicesMaintenanceModeCheck smmc=new ServicesMaintenanceModeCheck();
  Configuration config=Mockito.mock(Configuration.class);
  smmc.config=config;
  Assert.assertTrue(smmc.isApplicable(checkRequest));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  final Map<String,Service> services=new HashMap<>();
  final Service service=Mockito.mock(Service.class);
  services.put("YARN",service);
  Mockito.when(cluster.getServices()).thenReturn(services);
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Assert.assertTrue(servicesMapReduceDistributedCacheCheck.isApplicable(new PrereqCheckRequest("cluster")));
  PrereqCheckRequest req=new PrereqCheckRequest("cluster");
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.FAIL);
  Assert.assertFalse(servicesMapReduceDistributedCacheCheck.isApplicable(req));
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.PASS);
  Assert.assertTrue(servicesMapReduceDistributedCacheCheck.isApplicable(req));
  services.remove("YARN");
  Assert.assertFalse(servicesMapReduceDistributedCacheCheck.isApplicable(new PrereqCheckRequest("cluster")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesNamenodeHighAvailabilityCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  final Map<String,Service> services=new HashMap<>();
  final Service service=Mockito.mock(Service.class);
  services.put("HDFS",service);
  Mockito.when(cluster.getServices()).thenReturn(services);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  Assert.assertTrue(servicesNamenodeHighAvailabilityCheck.isApplicable(new PrereqCheckRequest("cluster")));
  services.remove("HDFS");
  Assert.assertFalse(servicesNamenodeHighAvailabilityCheck.isApplicable(new PrereqCheckRequest("cluster")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesNamenodeTruncateCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest("c1");
  checkRequest.setRepositoryVersion("HDP-2.2.0.0");
  checkRequest.setSourceStackId(new StackId("HDP","2.2"));
  checkRequest.setTargetStackId(new StackId("HDP","2.2"));
  Assert.assertTrue(m_check.isApplicable(checkRequest));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesTezDistributedCacheCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  final Map<String,Service> services=new HashMap<>();
  final Service service=Mockito.mock(Service.class);
  services.put("TEZ",service);
  Mockito.when(cluster.getServices()).thenReturn(services);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  Assert.assertTrue(servicesTezDistributedCacheCheck.isApplicable(new PrereqCheckRequest("cluster")));
  PrereqCheckRequest req=new PrereqCheckRequest("cluster");
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.FAIL);
  Assert.assertFalse(servicesTezDistributedCacheCheck.isApplicable(req));
  req.addResult(CheckDescription.SERVICES_NAMENODE_HA,PrereqCheckStatus.PASS);
  Assert.assertTrue(servicesTezDistributedCacheCheck.isApplicable(req));
  services.remove("TEZ");
  Assert.assertFalse(servicesTezDistributedCacheCheck.isApplicable(new PrereqCheckRequest("cluster")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesUpCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  PrereqCheckRequest checkRequest=new PrereqCheckRequest("c1");
  checkRequest.setRepositoryVersion("HDP-2.2.0.0");
  checkRequest.setSourceStackId(new StackId("HDP","2.2"));
  checkRequest.setTargetStackId(new StackId("HDP","2.2"));
  ServicesUpCheck suc=new ServicesUpCheck();
  Configuration config=Mockito.mock(Configuration.class);
  suc.config=config;
  Assert.assertTrue(suc.isApplicable(checkRequest));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerform() throws Exception {
  PowerMockito.mockStatic(HostComponentSummary.class);
  final ServicesUpCheck servicesUpCheck=new ServicesUpCheck();
  servicesUpCheck.clustersProvider=new Provider<Clusters>(){
    @Override public Clusters get(){
      return clusters;
    }
  }
;
  servicesUpCheck.ambariMetaInfo=new Provider<AmbariMetaInfo>(){
    @Override public AmbariMetaInfo get(){
      return ambariMetaInfo;
    }
  }
;
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP","2.2"));
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  final Service hdfsService=Mockito.mock(Service.class);
  final Service tezService=Mockito.mock(Service.class);
  final Service amsService=Mockito.mock(Service.class);
  HashMap<String,Service> clusterServices=new HashMap<String,Service>();
  clusterServices.put("HDFS",hdfsService);
  clusterServices.put("TEZ",tezService);
  clusterServices.put("AMBARI_METRICS",amsService);
  Mockito.when(hdfsService.getName()).thenReturn("HDFS");
  Mockito.when(tezService.getName()).thenReturn("TEZ");
  Mockito.when(amsService.getName()).thenReturn("AMBARI_METRICS");
  Mockito.when(hdfsService.isClientOnlyService()).thenReturn(false);
  Mockito.when(tezService.isClientOnlyService()).thenReturn(true);
  Mockito.when(amsService.isClientOnlyService()).thenReturn(false);
  Mockito.when(cluster.getServices()).thenReturn(clusterServices);
  Mockito.when(ambariMetaInfo.getComponent(Mockito.anyString(),Mockito.anyString(),Mockito.anyString(),Mockito.anyString())).thenAnswer(new Answer<ComponentInfo>(){
    @Override public ComponentInfo answer(    InvocationOnMock invocation) throws Throwable {
      ComponentInfo anyInfo=Mockito.mock(ComponentInfo.class);
      if (invocation.getArguments().length > 3 && "DATANODE".equals(invocation.getArguments()[3])) {
        Mockito.when(anyInfo.getCardinality()).thenReturn("1+");
      }
 else {
        Mockito.when(anyInfo.getCardinality()).thenReturn(null);
      }
      return anyInfo;
    }
  }
);
  Map<String,ServiceComponent> hdfsComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent nameNode=Mockito.mock(ServiceComponent.class);
  Mockito.when(nameNode.getName()).thenReturn("NAMENODE");
  Mockito.when(nameNode.isClientComponent()).thenReturn(false);
  Mockito.when(nameNode.isVersionAdvertised()).thenReturn(true);
  Mockito.when(nameNode.isMasterComponent()).thenReturn(true);
  ServiceComponent dataNode=Mockito.mock(ServiceComponent.class);
  Mockito.when(dataNode.getName()).thenReturn("DATANODE");
  Mockito.when(dataNode.isClientComponent()).thenReturn(false);
  Mockito.when(dataNode.isVersionAdvertised()).thenReturn(true);
  Mockito.when(dataNode.isMasterComponent()).thenReturn(false);
  ServiceComponent zkfc=Mockito.mock(ServiceComponent.class);
  Mockito.when(zkfc.getName()).thenReturn("ZKFC");
  Mockito.when(zkfc.isClientComponent()).thenReturn(false);
  Mockito.when(zkfc.isVersionAdvertised()).thenReturn(false);
  Mockito.when(zkfc.isMasterComponent()).thenReturn(false);
  hdfsComponents.put("NAMENODE",nameNode);
  hdfsComponents.put("DATANODE",dataNode);
  hdfsComponents.put("ZKFC",zkfc);
  Mockito.when(hdfsService.getServiceComponents()).thenReturn(hdfsComponents);
  Map<String,ServiceComponent> tezComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent tezClient=Mockito.mock(ServiceComponent.class);
  Mockito.when(tezClient.getName()).thenReturn("TEZ_CLIENT");
  Mockito.when(tezClient.isClientComponent()).thenReturn(true);
  Mockito.when(tezClient.isVersionAdvertised()).thenReturn(true);
  tezComponents.put("TEZ_CLIENT",tezClient);
  Mockito.when(tezService.getServiceComponents()).thenReturn(tezComponents);
  Map<String,ServiceComponent> amsComponents=new HashMap<String,ServiceComponent>();
  ServiceComponent metricsCollector=Mockito.mock(ServiceComponent.class);
  Mockito.when(metricsCollector.getName()).thenReturn("METRICS_COLLECTOR");
  Mockito.when(metricsCollector.isClientComponent()).thenReturn(false);
  Mockito.when(metricsCollector.isVersionAdvertised()).thenReturn(false);
  ServiceComponent metricsMonitor=Mockito.mock(ServiceComponent.class);
  Mockito.when(metricsMonitor.getName()).thenReturn("METRICS_MONITOR");
  Mockito.when(metricsMonitor.isClientComponent()).thenReturn(false);
  Mockito.when(metricsMonitor.isVersionAdvertised()).thenReturn(false);
  amsComponents.put("METRICS_COLLECTOR",metricsCollector);
  amsComponents.put("METRICS_MONITOR",metricsMonitor);
  Mockito.when(amsService.getServiceComponents()).thenReturn(amsComponents);
  final HostComponentSummary hcsNameNode=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode1=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode2=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsDataNode3=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsZKFC=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsTezClient=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsMetricsCollector=Mockito.mock(HostComponentSummary.class);
  final HostComponentSummary hcsMetricsMonitor=Mockito.mock(HostComponentSummary.class);
  List<HostComponentSummary> allHostComponentSummaries=new ArrayList<HostComponentSummary>();
  allHostComponentSummaries.add(hcsNameNode);
  allHostComponentSummaries.add(hcsDataNode1);
  allHostComponentSummaries.add(hcsDataNode2);
  allHostComponentSummaries.add(hcsDataNode3);
  allHostComponentSummaries.add(hcsZKFC);
  allHostComponentSummaries.add(hcsTezClient);
  allHostComponentSummaries.add(hcsMetricsCollector);
  allHostComponentSummaries.add(hcsMetricsMonitor);
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","NAMENODE")).thenReturn(Arrays.asList(hcsNameNode));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","DATANODE")).thenReturn(Arrays.asList(hcsDataNode1,hcsDataNode2,hcsDataNode3));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("HDFS","ZKFC")).thenReturn(Arrays.asList(hcsZKFC));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("TEZ","TEZ_CLIENT")).thenReturn(Arrays.asList(hcsTezClient));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("AMBARI_METRICS","METRICS_COLLECTOR")).thenReturn(Arrays.asList(hcsMetricsCollector));
  Mockito.when(HostComponentSummary.getHostComponentSummaries("AMBARI_METRICS","METRICS_MONITOR")).thenReturn(Arrays.asList(hcsMetricsMonitor));
  for (  HostComponentSummary hcs : allHostComponentSummaries) {
    Mockito.when(hcs.getDesiredState()).thenReturn(State.INSTALLED);
    Mockito.when(hcs.getCurrentState()).thenReturn(State.STARTED);
  }
  PrerequisiteCheck check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsNameNode.getDesiredState()).thenReturn(State.STARTED);
  Mockito.when(hcsDataNode1.getDesiredState()).thenReturn(State.STARTED);
  check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsZKFC.getCurrentState()).thenReturn(State.INSTALLED);
  Mockito.when(hcsMetricsCollector.getCurrentState()).thenReturn(State.INSTALLED);
  Mockito.when(hcsMetricsMonitor.getCurrentState()).thenReturn(State.INSTALLED);
  check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsNameNode.getCurrentState()).thenReturn(State.INSTALLED);
  Mockito.when(hcsDataNode1.getCurrentState()).thenReturn(State.INSTALLED);
  check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Mockito.when(hcsNameNode.getCurrentState()).thenReturn(State.STARTED);
  Mockito.when(hcsDataNode1.getCurrentState()).thenReturn(State.INSTALLED);
  check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hcsNameNode.getCurrentState()).thenReturn(State.STARTED);
  Mockito.when(hcsDataNode1.getCurrentState()).thenReturn(State.INSTALLED);
  Mockito.when(hcsDataNode2.getCurrentState()).thenReturn(State.INSTALLED);
  check=new PrerequisiteCheck(null,null);
  servicesUpCheck.perform(check,new PrereqCheckRequest("cluster"));
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertTrue(check.getFailReason().indexOf("50%") > -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.ServicesYarnWorkPreservingCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  final Map<String,Service> services=new HashMap<>();
  final Service service=Mockito.mock(Service.class);
  services.put("YARN",service);
  Mockito.when(cluster.getServices()).thenReturn(services);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(clusters.getCluster("cluster")).thenReturn(cluster);
  Assert.assertTrue(servicesYarnWorkPreservingCheck.isApplicable(new PrereqCheckRequest("cluster")));
  services.remove("YARN");
  Assert.assertFalse(servicesYarnWorkPreservingCheck.isApplicable(new PrereqCheckRequest("cluster")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.UpgradeCheckOrderTest </h4><pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that instances of {@link AbstractCheckDescriptor} are ordered
 * correctly.
 * @throws Exception
 */
@Test public void testUpgradeOrder() throws Exception {
  String sourceResourceDirectory="src" + File.separator + "test"+ File.separator+ "resources";
  Properties properties=new Properties();
  properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
  properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
  properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,sourceResourceDirectory);
  Injector injector=Guice.createInjector(new ControllerModule(properties));
  UpgradeCheckRegistry registry=injector.getInstance(UpgradeCheckRegistry.class);
  UpgradeCheckRegistry registry2=injector.getInstance(UpgradeCheckRegistry.class);
  Assert.assertEquals(registry,registry2);
  List<AbstractCheckDescriptor> checks=registry.getUpgradeChecks();
  ClassPathScanningCandidateComponentProvider scanner=new ClassPathScanningCandidateComponentProvider(false);
  AssignableTypeFilter filter=new AssignableTypeFilter(AbstractCheckDescriptor.class);
  scanner.addIncludeFilter(filter);
  Set<BeanDefinition> beanDefinitions=scanner.findCandidateComponents("org.apache.ambari.server");
  Assert.assertEquals(beanDefinitions.size(),checks.size());
  AbstractCheckDescriptor lastCheck=null;
  for (  AbstractCheckDescriptor check : checks) {
    UpgradeCheckGroup group=UpgradeCheckGroup.DEFAULT;
    UpgradeCheckGroup lastGroup=UpgradeCheckGroup.DEFAULT;
    if (null != lastCheck) {
      UpgradeCheck annotation=check.getClass().getAnnotation(UpgradeCheck.class);
      UpgradeCheck lastAnnotation=lastCheck.getClass().getAnnotation(UpgradeCheck.class);
      if (null != annotation && null != lastAnnotation) {
        group=annotation.group();
        lastGroup=lastAnnotation.group();
        Assert.assertTrue(lastGroup.getOrder().compareTo(group.getOrder()) <= 0);
      }
    }
    lastCheck=check;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.YarnTimelineServerStatePreservingCheckTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("serial") @Test public void testIsApplicableMinimumStackVersion() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getServices()).thenReturn(new HashMap<String,Service>(){
{
      put("YARN",null);
    }
  }
);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("MYSTACK-12.2"));
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(cluster.getCurrentClusterVersion()).thenReturn(clusterVersionEntity);
  RepositoryVersionEntity repositoryVersionEntity=Mockito.mock(RepositoryVersionEntity.class);
  Mockito.when(clusterVersionEntity.getRepositoryVersion()).thenReturn(repositoryVersionEntity);
  Mockito.when(m_clusters.getCluster("c1")).thenReturn(cluster);
  Map<String,String> checkProperties=new HashMap<String,String>();
  checkProperties.put("min-applicable-stack-version","HDP-2.2.4.2");
  PrerequisiteCheckConfig prerequisiteCheckConfig=Mockito.mock(PrerequisiteCheckConfig.class);
  Mockito.when(prerequisiteCheckConfig.getCheckProperties(m_check.getClass().getName())).thenReturn(checkProperties);
  PrereqCheckRequest request=new PrereqCheckRequest("c1");
  request.setPrerequisiteCheckConfig(prerequisiteCheckConfig);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.3.0.1");
  boolean isApplicable=m_check.isApplicable(request);
  Assert.assertTrue(isApplicable);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testIsApplicable() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(m_clusters.getCluster("cluster")).thenReturn(cluster);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP-2.2"));
  Map<String,Service> services=new HashMap<String,Service>();
  Mockito.when(cluster.getServices()).thenReturn(services);
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(cluster.getCurrentClusterVersion()).thenReturn(clusterVersionEntity);
  RepositoryVersionEntity repositoryVersionEntity=Mockito.mock(RepositoryVersionEntity.class);
  Mockito.when(clusterVersionEntity.getRepositoryVersion()).thenReturn(repositoryVersionEntity);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.4.2");
  Map<String,String> checkProperties=new HashMap<String,String>();
  checkProperties.put("min-applicable-stack-version","HDP-2.2.4.2");
  PrerequisiteCheckConfig prerequisiteCheckConfig=Mockito.mock(PrerequisiteCheckConfig.class);
  Mockito.when(prerequisiteCheckConfig.getCheckProperties(m_check.getClass().getName())).thenReturn(checkProperties);
  PrereqCheckRequest request=new PrereqCheckRequest("cluster");
  request.setRepositoryVersion("2.3.0.0");
  request.setPrerequisiteCheckConfig(prerequisiteCheckConfig);
  Assert.assertFalse(m_check.isApplicable(request));
  services.put("YARN",Mockito.mock(Service.class));
  Assert.assertTrue(m_check.isApplicable(request));
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.0.0");
  Assert.assertFalse(m_check.isApplicable(request));
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.4.2");
  Assert.assertTrue(m_check.isApplicable(request));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("serial") @Test public void testIsApplicableMinimumHDPStackVersion() throws Exception {
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getServices()).thenReturn(new HashMap<String,Service>(){
{
      put("YARN",null);
    }
  }
);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(new StackId("HDP-2.2"));
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(cluster.getCurrentClusterVersion()).thenReturn(clusterVersionEntity);
  RepositoryVersionEntity repositoryVersionEntity=Mockito.mock(RepositoryVersionEntity.class);
  Mockito.when(clusterVersionEntity.getRepositoryVersion()).thenReturn(repositoryVersionEntity);
  Mockito.when(m_clusters.getCluster("c1")).thenReturn(cluster);
  Map<String,String> checkProperties=new HashMap<String,String>();
  checkProperties.put("min-applicable-stack-version","HDP-2.2.4.2");
  PrerequisiteCheckConfig prerequisiteCheckConfig=Mockito.mock(PrerequisiteCheckConfig.class);
  Mockito.when(prerequisiteCheckConfig.getCheckProperties(m_check.getClass().getName())).thenReturn(checkProperties);
  PrereqCheckRequest request=new PrereqCheckRequest("c1");
  request.setPrerequisiteCheckConfig(prerequisiteCheckConfig);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.1.1.1");
  boolean isApplicable=m_check.isApplicable(request);
  Assert.assertFalse(isApplicable);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.4.1");
  isApplicable=m_check.isApplicable(request);
  Assert.assertFalse(isApplicable);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.4.2");
  isApplicable=m_check.isApplicable(request);
  Assert.assertTrue(isApplicable);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.2.4.4");
  isApplicable=m_check.isApplicable(request);
  Assert.assertTrue(isApplicable);
  Mockito.when(repositoryVersionEntity.getVersion()).thenReturn("2.3.1.1");
  isApplicable=m_check.isApplicable(request);
  Assert.assertTrue(isApplicable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.configuration.ComponentSSLConfigurationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsGangliaSSL() throws Exception {
  ComponentSSLConfiguration sslConfiguration=getConfiguration("tspath","tspass","tstype",true);
  Assert.assertTrue(sslConfiguration.isGangliaSSL());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.configuration.ConfigurationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * ambari.properties contains "security.server.two_way_ssl=true" option
 * @throws Exception
 */
@Test public void testTwoWayAuthTurnedOn() throws Exception {
  Properties ambariProperties=new Properties();
  ambariProperties.setProperty("security.server.two_way_ssl","true");
  Configuration conf=new Configuration(ambariProperties);
  Assert.assertTrue(conf.getTwoWaySsl());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExperimentalConcurrentStageProcessing() throws Exception {
  final Properties ambariProperties=new Properties();
  final Configuration configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isExperimentalConcurrentStageProcessingEnabled());
  ambariProperties.setProperty(Configuration.EXPERIMENTAL_CONCURRENCY_STAGE_PROCESSING_ENABLED,Boolean.TRUE.toString());
  Assert.assertTrue(configuration.isExperimentalConcurrentStageProcessingEnabled());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsViewRemoveUndeployedEnabled() throws Exception {
  final Properties ambariProperties=new Properties();
  Configuration configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isViewRemoveUndeployedEnabled());
  ambariProperties.setProperty(Configuration.VIEWS_REMOVE_UNDEPLOYED,"false");
  configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isViewRemoveUndeployedEnabled());
  ambariProperties.setProperty(Configuration.VIEWS_REMOVE_UNDEPLOYED,"true");
  configuration=new Configuration(ambariProperties);
  Assert.assertTrue(configuration.isViewRemoveUndeployedEnabled());
  ambariProperties.setProperty(Configuration.VIEWS_REMOVE_UNDEPLOYED,Configuration.VIEWS_REMOVE_UNDEPLOYED_DEFAULT);
  configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isViewRemoveUndeployedEnabled());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * ambari.properties doesn't contain "security.server.two_way_ssl" option
 * @throws Exception
 */
@Test public void testDefaultTwoWayAuthNotSet() throws Exception {
  Assert.assertFalse(new Configuration().getTwoWaySsl());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClientHTTPSSettings() throws IOException {
  File passFile=File.createTempFile("https.pass.","txt");
  passFile.deleteOnExit();
  String password="pass12345";
  FileUtils.writeStringToFile(passFile,password);
  Properties ambariProperties=new Properties();
  ambariProperties.setProperty(Configuration.API_USE_SSL,"true");
  ambariProperties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,passFile.getParent());
  ambariProperties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,passFile.getName());
  String oneWayPort=RandomStringUtils.randomNumeric(4);
  String twoWayPort=RandomStringUtils.randomNumeric(4);
  ambariProperties.setProperty(Configuration.SRVR_TWO_WAY_SSL_PORT_KEY,twoWayPort.toString());
  ambariProperties.setProperty(Configuration.SRVR_ONE_WAY_SSL_PORT_KEY,oneWayPort.toString());
  Configuration conf=new Configuration(ambariProperties);
  Assert.assertTrue(conf.getApiSSLAuthentication());
  Assert.assertFalse(conf.getConfigsMap().get(Configuration.KSTR_NAME_KEY).equals(conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_KSTR_NAME_KEY)));
  Assert.assertFalse(conf.getConfigsMap().get(Configuration.SRVR_CRT_NAME_KEY).equals(conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_CRT_NAME_KEY)));
  Assert.assertEquals("keystore.p12",conf.getConfigsMap().get(Configuration.KSTR_NAME_KEY));
  Assert.assertEquals("PKCS12",conf.getConfigsMap().get(Configuration.KSTR_TYPE_KEY));
  Assert.assertEquals("keystore.p12",conf.getConfigsMap().get(Configuration.TSTR_NAME_KEY));
  Assert.assertEquals("PKCS12",conf.getConfigsMap().get(Configuration.TSTR_TYPE_KEY));
  Assert.assertEquals("https.keystore.p12",conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_KSTR_NAME_KEY));
  Assert.assertEquals("PKCS12",conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_KSTR_TYPE_KEY));
  Assert.assertEquals("https.keystore.p12",conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_TSTR_NAME_KEY));
  Assert.assertEquals("PKCS12",conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_TSTR_TYPE_KEY));
  Assert.assertEquals(passFile.getName(),conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY));
  Assert.assertEquals(password,conf.getConfigsMap().get(Configuration.CLIENT_API_SSL_CRT_PASS_KEY));
  Assert.assertEquals(Integer.parseInt(twoWayPort),conf.getTwoWayAuthPort());
  Assert.assertEquals(Integer.parseInt(oneWayPort),conf.getOneWayAuthPort());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * ambari.properties contains "security.server.two_way_ssl=false" option
 * @throws Exception
 */
@Test public void testTwoWayAuthTurnedOff() throws Exception {
  Properties ambariProperties=new Properties();
  ambariProperties.setProperty("security.server.two_way_ssl","false");
  Configuration conf=new Configuration(ambariProperties);
  Assert.assertFalse(conf.getTwoWaySsl());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertCaching() throws Exception {
  final Properties ambariProperties=new Properties();
  final Configuration configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isAlertCacheEnabled());
  ambariProperties.setProperty(Configuration.ALERTS_CACHE_ENABLED,Boolean.TRUE.toString());
  ambariProperties.setProperty(Configuration.ALERTS_CACHE_FLUSH_INTERVAL,"60");
  ambariProperties.setProperty(Configuration.ALERTS_CACHE_SIZE,"1000");
  Assert.assertTrue(configuration.isAlertCacheEnabled());
  Assert.assertEquals(60,configuration.getAlertCacheFlushInterval());
  Assert.assertEquals(1000,configuration.getAlertCacheSize());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsViewValidationEnabled() throws Exception {
  final Properties ambariProperties=new Properties();
  Configuration configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isViewValidationEnabled());
  ambariProperties.setProperty(Configuration.VIEWS_VALIDATE,"false");
  configuration=new Configuration(ambariProperties);
  Assert.assertFalse(configuration.isViewValidationEnabled());
  ambariProperties.setProperty(Configuration.VIEWS_VALIDATE,"true");
  configuration=new Configuration(ambariProperties);
  Assert.assertTrue(configuration.isViewValidationEnabled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariCustomCommandExecutionHelperTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTopologyRefreshRequired() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  AmbariCustomCommandExecutionHelper helper=injector.getInstance(AmbariCustomCommandExecutionHelper.class);
  createClusterFixture("HDP-2.1.1");
  Assert.assertTrue(helper.isTopologyRefreshRequired("START","c1","HDFS"));
  Assert.assertTrue(helper.isTopologyRefreshRequired("RESTART","c1","HDFS"));
  Assert.assertFalse(helper.isTopologyRefreshRequired("STOP","c1","HDFS"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariHandlerListTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddViewInstance() throws Exception {
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  final WebAppContext handler=createNiceMock(WebAppContext.class);
  Server server=createNiceMock(Server.class);
  expect(handler.getServer()).andReturn(server);
  handler.setServer(null);
  Capture<FilterHolder> securityHeaderFilterCapture=new Capture<FilterHolder>();
  Capture<FilterHolder> persistFilterCapture=new Capture<FilterHolder>();
  Capture<FilterHolder> securityFilterCapture=new Capture<FilterHolder>();
  handler.addFilter(capture(securityHeaderFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.addFilter(capture(persistFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.addFilter(capture(securityFilterCapture),eq("/*"),eq(AmbariServer.DISPATCHER_TYPES));
  handler.setAllowNullPathInfo(true);
  replay(handler,server);
  AmbariHandlerList handlerList=getAmbariHandlerList(handler);
  handlerList.addViewInstance(viewInstanceEntity);
  ArrayList<Handler> handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertTrue(handlers.contains(handler));
  Assert.assertEquals(ambariViewsSecurityHeaderFilter,securityHeaderFilterCapture.getValue().getFilter());
  Assert.assertEquals(persistFilter,persistFilterCapture.getValue().getFilter());
  Assert.assertEquals(springSecurityFilter,securityFilterCapture.getValue().getFilter());
  verify(handler,server);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveViewInstance() throws Exception {
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  final WebAppContext handler=createNiceMock(WebAppContext.class);
  Server server=createNiceMock(Server.class);
  expect(handler.getServer()).andReturn(server);
  handler.setServer(null);
  replay(handler,server);
  AmbariHandlerList handlerList=getAmbariHandlerList(handler);
  handlerList.addViewInstance(viewInstanceEntity);
  ArrayList<Handler> handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertTrue(handlers.contains(handler));
  handlerList.removeViewInstance(viewInstanceEntity);
  handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertFalse(handlers.contains(handler));
  verify(handler,server);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerImplTest </h4><pre class="type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_HostNotFoundException_hostProvidedInQuery() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponent component3=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  final ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1",null,null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host2",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3",null,null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(3);
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack).anyTimes();
  expect(stack.getStackName()).andReturn("stackName").anyTimes();
  expect(stack.getStackVersion()).andReturn("stackVersion").anyTimes();
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(Collections.singletonMap("foo",componentHost1));
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(clusters.getClustersForHost("host2")).andThrow(new HostNotFoundException("host2"));
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component3")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component3")).andReturn(component3);
  expect(component3.getName()).andReturn("component3");
  expect(component3.getServiceComponentHosts()).andReturn(Collections.singletonMap("foo",componentHost2));
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost2.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  Assert.assertNotNull(setResponses);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(componentHost)).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster));
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack);
  expect(stack.getStackName()).andReturn("stackName");
  expect(stack.getStackVersion()).andReturn("stackVersion");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost);
    }
  }
);
  expect(componentHost.convertToResponse()).andReturn(response);
  expect(componentHost.getHostName()).andReturn("host1").anyTimes();
  expect(maintHelper.getEffectiveState(componentHost,host)).andReturn(MaintenanceState.OFF);
  replay(maintHelper,injector,clusters,cluster,host,response,stack,ambariMetaInfo,service,component,componentHost);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(injector,clusters,cluster,host,response,stack,ambariMetaInfo,service,component,componentHost);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___NullHostName_NullComponentName() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service1=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceComponent component1=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHost componentHost3=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response3=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,null,null,null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  Map<String,Service> mapServices=new HashMap<String,Service>();
  mapServices.put("foo",service1);
  mapServices.put("bar",service2);
  Map<String,ServiceComponentHost> mapHostComponents=new HashMap<String,ServiceComponentHost>();
  mapHostComponents.put("foo",componentHost1);
  mapHostComponents.put("bar",componentHost2);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",createNiceMock(Host.class));
    }
  }
).anyTimes();
  expect(cluster.getServices()).andReturn(mapServices);
  expect(service1.getServiceComponents()).andReturn(Collections.singletonMap("foo",component1));
  expect(service2.getServiceComponents()).andReturn(Collections.singletonMap("bar",component2));
  expect(component1.getName()).andReturn("component1").anyTimes();
  expect(component2.getName()).andReturn("component2").anyTimes();
  expect(component1.getServiceComponentHosts()).andReturn(mapHostComponents);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(componentHost2.getHostName()).andReturn("host1");
  expect(componentHost3.getHostName()).andReturn("host1");
  expect(component2.getServiceComponentHosts()).andReturn(Collections.singletonMap("foobar",componentHost3));
  expect(componentHost3.convertToResponse()).andReturn(response3);
  replay(maintHelper,injector,clusters,cluster,response1,response2,response3,stack,ambariMetaInfo,service1,service2,component1,component2,componentHost1,componentHost2,componentHost3);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(3,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  assertTrue(setResponses.contains(response3));
  verify(injector,clusters,cluster,response1,response2,response3,stack,ambariMetaInfo,service1,service2,component1,component2,componentHost1,componentHost2,componentHost3);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_ServiceNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponent component3=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  final ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host1",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(3);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster)).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack).anyTimes();
  expect(stack.getStackName()).andReturn("stackName").anyTimes();
  expect(stack.getStackVersion()).andReturn("stackVersion").anyTimes();
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost1);
    }
  }
);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component2")).andReturn("service2");
  expect(cluster.getService("service2")).andThrow(new ServiceNotFoundException("cluster1","service2"));
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component3")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component3")).andReturn(component3);
  expect(component3.getName()).andReturn("component3");
  expect(component3.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost2);
    }
  }
);
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost2.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,component2,component3,componentHost1,componentHost2,response1,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,component2,component3,componentHost1,componentHost2,response1,response2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusters() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  ClusterRequest request1=new ClusterRequest(null,"cluster1","1",Collections.<String>emptySet());
  Cluster cluster=createNiceMock(Cluster.class);
  ClusterResponse response=createNiceMock(ClusterResponse.class);
  Set<ClusterRequest> setRequests=new HashSet<ClusterRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.convertToResponse()).andReturn(response);
  CredentialStoreService credentialStoreService=createNiceMock(CredentialStoreService.class);
  expect(credentialStoreService.isInitialized(anyObject(CredentialStoreType.class))).andReturn(true).anyTimes();
  replay(injector,clusters,cluster,response,credentialStoreService);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Field f=controller.getClass().getDeclaredField("credentialStoreService");
  f.setAccessible(true);
  f.set(controller,credentialStoreService);
  Set<ClusterResponse> setResponses=controller.getClusters(setRequests);
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(injector,clusters,cluster,response,credentialStoreService);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___ServiceComponentHostFilteredByState() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  request1.setState("INSTALLED");
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster));
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack);
  expect(cluster.getClusterName()).andReturn("cl1");
  expect(stack.getStackName()).andReturn("stackName");
  expect(stack.getStackVersion()).andReturn("stackVersion");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1").anyTimes();
  expect(component.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost1);
    }
  }
);
  expect(componentHost1.getState()).andReturn(State.INSTALLED);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,componentHost1,response1);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> responses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertTrue(responses.size() == 1);
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,componentHost1,response1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ClusterNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetClusters___OR_Predicate_ClusterNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Cluster cluster=createNiceMock(Cluster.class);
  Cluster cluster2=createNiceMock(Cluster.class);
  ClusterResponse response=createNiceMock(ClusterResponse.class);
  ClusterResponse response2=createNiceMock(ClusterResponse.class);
  ClusterRequest request1=new ClusterRequest(null,"cluster1","1",Collections.<String>emptySet());
  ClusterRequest request2=new ClusterRequest(null,"cluster2","1",Collections.<String>emptySet());
  ClusterRequest request3=new ClusterRequest(null,"cluster3","1",Collections.<String>emptySet());
  ClusterRequest request4=new ClusterRequest(null,"cluster4","1",Collections.<String>emptySet());
  Set<ClusterRequest> setRequests=new HashSet<ClusterRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andThrow(new ClusterNotFoundException("cluster1"));
  expect(clusters.getCluster("cluster2")).andReturn(cluster);
  expect(clusters.getCluster("cluster3")).andReturn(cluster2);
  expect(clusters.getCluster("cluster4")).andThrow(new ClusterNotFoundException("cluster4"));
  expect(cluster.convertToResponse()).andReturn(response);
  expect(cluster2.convertToResponse()).andReturn(response2);
  CredentialStoreService credentialStoreService=createNiceMock(CredentialStoreService.class);
  expect(credentialStoreService.isInitialized(anyObject(CredentialStoreType.class))).andReturn(true).anyTimes();
  replay(injector,clusters,cluster,cluster2,response,response2,credentialStoreService);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Field f=controller.getClass().getDeclaredField("credentialStoreService");
  f.setAccessible(true);
  f.set(controller,credentialStoreService);
  Set<ClusterResponse> setResponses=controller.getClusters(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,cluster2,response,response2,credentialStoreService);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_ServiceComponentHostNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponent component3=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  final ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper stateHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(stateHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host1",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(stateHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(3);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster)).anyTimes();
  expect(cluster.getService("service1")).andReturn(service).times(3);
  expect(cluster.getDesiredStackVersion()).andReturn(stack).anyTimes();
  expect(stack.getStackName()).andReturn("stackName").anyTimes();
  expect(stack.getStackVersion()).andReturn("stackVersion").anyTimes();
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost1);
    }
  }
);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component2")).andReturn("service1");
  expect(service.getServiceComponent("component2")).andReturn(component2);
  expect(component2.getName()).andReturn("component2");
  expect(component2.getServiceComponentHosts()).andReturn(null);
  expect(componentHost2.getHostName()).andReturn("host1");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component3")).andReturn("service1");
  expect(service.getServiceComponent("component3")).andReturn(component3);
  expect(component3.getName()).andReturn("component3");
  expect(component3.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost2);
    }
  }
);
  expect(componentHost2.convertToResponse()).andReturn(response2);
  replay(stateHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,component2,component3,componentHost1,componentHost2,response1,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,component,component2,component3,componentHost1,componentHost2,response1,response2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_ServiceComponentNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponent component3=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  final ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1","host1",null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host1",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3","host1",null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(3);
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster)).anyTimes();
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack).anyTimes();
  expect(stack.getStackName()).andReturn("stackName").anyTimes();
  expect(stack.getStackVersion()).andReturn("stackVersion").anyTimes();
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost1);
    }
  }
);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component2")).andReturn("service2");
  expect(cluster.getService("service2")).andReturn(service2);
  expect(service2.getServiceComponent("component2")).andThrow(new ServiceComponentNotFoundException("cluster1","service2","component2"));
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component3")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component3")).andReturn(component3);
  expect(component3.getName()).andReturn("component3");
  expect(component3.getServiceComponentHosts()).andReturn(new HashMap<String,ServiceComponentHost>(){
{
      put("host1",componentHost2);
    }
  }
);
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost2.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___NullHostName() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1",null,null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  Map<String,ServiceComponentHost> mapHostComponents=new HashMap<String,ServiceComponentHost>();
  mapHostComponents.put("foo",componentHost1);
  mapHostComponents.put("bar",componentHost2);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",createNiceMock(Host.class));
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack);
  expect(stack.getStackName()).andReturn("stackName");
  expect(stack.getStackVersion()).andReturn("stackVersion");
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1").anyTimes();
  expect(component.getServiceComponentHosts()).andReturn(mapHostComponents);
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(componentHost2.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,response1,response2,stack,ambariMetaInfo,service,component,componentHost1,componentHost2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,response1,response2,stack,ambariMetaInfo,service,component,componentHost1,componentHost2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExecutionCommand() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  ExecutionCommand ec=controller.getExecutionCommand(cluster,s1.getServiceComponent("NAMENODE").getServiceComponentHost("h1"),RoleCommand.START);
  assertEquals("1-0",ec.getCommandId());
  assertEquals("foo1",ec.getClusterName());
  Map<String,Map<String,String>> configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(2,configurations.size());
  assertTrue(configurations.containsKey("hdfs-site"));
  assertTrue(configurations.containsKey("core-site"));
  assertTrue(ec.getConfigurationAttributes().containsKey("hdfs-site"));
  assertTrue(ec.getConfigurationAttributes().containsKey("core-site"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("0",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
  Map<String,Set<String>> chInfo=ec.getClusterHostInfo();
  assertTrue(chInfo.containsKey("namenode_host"));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testUpdateClusterVersionBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  String serviceName="MAPREDUCE";
  String host1="h1";
  String host2="h2";
  String componentName="JOBTRACKER";
  StackId currentStackId=new StackId("HDP-0.1");
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createCluster(clusterName);
  Cluster c=clusters.getCluster(clusterName);
  c.setDesiredStackVersion(currentStackId);
  createService(clusterName,serviceName,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName,null);
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName,host1,null);
  createServiceComponentHost(clusterName,null,componentName,host2,null);
  c.getService(serviceName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.STARTED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setStackVersion(currentStackId);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setStackVersion(currentStackId);
  ClusterRequest r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.0.1",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("must be greater than current version"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDPLocal-1.2.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade not possible between different stacks"));
  }
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(serviceName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade needs all services to be stopped"));
    Assert.assertTrue(e.getMessage().contains(componentName));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  StackId expectedStackId=new StackId("HDP-0.2");
  Assert.assertTrue(expectedStackId.equals(c.getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getDesiredStackVersion()));
  Assert.assertTrue(expectedStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getDesiredStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).getStackVersion()));
  Assert.assertTrue(currentStackId.equals(c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).getStackVersion()));
  ServiceComponent sc=c.getService(serviceName).getServiceComponent(componentName);
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.UPGRADING,sc.getServiceComponentHost(host2).getState());
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
    fail("Update cluster should fail");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("A prior upgrade request with id"));
  }
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setDesiredState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host1).setState(State.INSTALLED);
  c.getService(serviceName).getServiceComponent(componentName).getServiceComponentHost(host2).setState(State.INSTALLED);
  c.setCurrentStackVersion(expectedStackId);
  r=new ClusterRequest(c.getClusterId(),clusterName,"",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,null,null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  controller.updateClusters(Collections.singleton(r),mapRequestProps);
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.INSTALLED,sc.getServiceComponentHost(host2).getState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackVersions() throws Exception {
  StackVersionRequest request=new StackVersionRequest(STACK_NAME,null);
  Set<StackVersionResponse> responses=controller.getStackVersions(Collections.singleton(request));
  Assert.assertEquals(STACK_VERSIONS_CNT,responses.size());
  StackVersionRequest requestWithParams=new StackVersionRequest(STACK_NAME,STACK_VERSION);
  Set<StackVersionResponse> responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackVersionResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getStackVersion(),STACK_VERSION);
  }
  StackVersionRequest invalidRequest=new StackVersionRequest(STACK_NAME,NON_EXT_VALUE);
  try {
    controller.getStackVersions(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
  requestWithParams=new StackVersionRequest(STACK_NAME,"2.1.1");
  responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  StackVersionResponse resp=responsesWithParams.iterator().next();
  assertNotNull(resp.getUpgradePacks());
  assertEquals(8,resp.getUpgradePacks().size());
  assertTrue(resp.getUpgradePacks().contains("upgrade_test"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void setMonitoringServicesRestartRequired() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  StackId stackId=new StackId("HDP-2.0.8");
  cluster.setDesiredStackVersion(stackId);
  cluster.setCurrentStackVersion(stackId);
  String hdfsService="HDFS";
  String fakeMonitoringService="FAKENAGIOS";
  createService(clusterName,hdfsService,null);
  createService(clusterName,fakeMonitoringService,null);
  String namenode="NAMENODE";
  String datanode="DATANODE";
  String hdfsClient="HDFS_CLIENT";
  String fakeServer="FAKE_MONITORING_SERVER";
  createServiceComponent(clusterName,hdfsService,namenode,State.INIT);
  createServiceComponent(clusterName,hdfsService,datanode,State.INIT);
  createServiceComponent(clusterName,fakeMonitoringService,fakeServer,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,hdfsService,namenode,host1,null);
  createServiceComponentHost(clusterName,hdfsService,datanode,host1,null);
  createServiceComponentHost(clusterName,fakeMonitoringService,fakeServer,host1,null);
  ServiceComponentHost monitoringServiceComponentHost=null;
  for (  ServiceComponentHost sch : cluster.getServiceComponentHosts(host1)) {
    if (sch.getServiceComponentName().equals(fakeServer)) {
      monitoringServiceComponentHost=sch;
    }
  }
  assertFalse(monitoringServiceComponentHost.isRestartRequired());
  createServiceComponent(clusterName,hdfsService,hdfsClient,State.INIT);
  createServiceComponentHost(clusterName,hdfsService,hdfsClient,host1,null);
  assertTrue(monitoringServiceComponentHost.isRestartRequired());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecretReferences() throws AmbariException, AuthorizationException {
  final String host1="h1";
  final String host2="h2";
  Long clusterId=1L;
  String clusterName="foo1";
  Cluster cl=setupClusterWithHosts(clusterName,"HDP-2.0.5",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  ClusterRequest crReq;
  ConfigurationRequest cr;
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("test.password","first");
      put("test.password.empty","");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:1:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","brandNewPassword");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:666:test.password");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
  }
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version4",new HashMap<String,String>(){
{
      put("foo","bar");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(Collections.singleton(crReq),null);
  cr=new ConfigurationRequest(clusterName,"hdfs-site","version5",new HashMap<String,String>(){
{
      put("test.password","SECRET:hdfs-site:4:test.password");
      put("new","new");
    }
  }
,new HashMap<String,Map<String,String>>());
  crReq=new ClusterRequest(clusterId,clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr));
  try {
    controller.updateClusters(Collections.singleton(crReq),null);
    fail("Request need to be failed with wrong secret reference");
  }
 catch (  AmbariException e) {
    assertEquals("Error when parsing secret reference. Cluster: foo1 ConfigType: hdfs-site ConfigVersion: 4 does not contain property 'test.password'",e.getMessage());
  }
  cl.getAllConfigs();
  assertEquals(cl.getAllConfigs().size(),4);
  Config v1=cl.getConfigByVersion("hdfs-site",1l);
  Config v2=cl.getConfigByVersion("hdfs-site",2l);
  Config v3=cl.getConfigByVersion("hdfs-site",3l);
  Config v4=cl.getConfigByVersion("hdfs-site",4l);
  assertEquals(v1.getProperties().get("test.password"),"first");
  assertEquals(v2.getProperties().get("test.password"),"first");
  assertEquals(v3.getProperties().get("test.password"),"brandNewPassword");
  assertFalse(v4.getProperties().containsKey("test.password"));
  final ConfigurationRequest configRequest=new ConfigurationRequest(clusterName,"hdfs-site",null,null,null);
  configRequest.setIncludeProperties(true);
  Set<ConfigurationResponse> requestedConfigs=controller.getConfigurations(new HashSet<ConfigurationRequest>(){
{
      add(configRequest);
    }
  }
);
  for (  ConfigurationResponse resp : requestedConfigs) {
    String secretName="SECRET:hdfs-site:" + resp.getVersion().toString() + ":test.password";
    if (resp.getConfigs().containsKey("test.password")) {
      assertEquals(resp.getConfigs().get("test.password"),secretName);
    }
    if (resp.getConfigs().containsKey("test.password.empty")) {
      assertEquals(resp.getConfigs().get("test.password.empty"),"");
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void setRestartRequiredAfterChangeService() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  StackId stackId=new StackId("HDP-2.0.7");
  cluster.setDesiredStackVersion(stackId);
  cluster.setCurrentStackVersion(stackId);
  String hdfsService="HDFS";
  String zookeeperService="ZOOKEEPER";
  createService(clusterName,hdfsService,null);
  createService(clusterName,zookeeperService,null);
  String namenode="NAMENODE";
  String datanode="DATANODE";
  String hdfsClient="HDFS_CLIENT";
  String zookeeperServer="ZOOKEEPER_SERVER";
  createServiceComponent(clusterName,hdfsService,namenode,State.INIT);
  createServiceComponent(clusterName,hdfsService,datanode,State.INIT);
  createServiceComponent(clusterName,zookeeperService,zookeeperServer,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,hdfsService,namenode,host1,null);
  createServiceComponentHost(clusterName,hdfsService,datanode,host1,null);
  createServiceComponentHost(clusterName,zookeeperService,zookeeperServer,host1,null);
  ServiceComponentHost zookeeperSch=null;
  for (  ServiceComponentHost sch : cluster.getServiceComponentHosts(host1)) {
    if (sch.getServiceComponentName().equals(zookeeperServer)) {
      zookeeperSch=sch;
    }
  }
  assertFalse(zookeeperSch.isRestartRequired());
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,zookeeperService,zookeeperServer,host2,null);
  assertFalse(zookeeperSch.isRestartRequired());
  deleteServiceComponentHost(clusterName,zookeeperService,zookeeperServer,host2,null);
  deleteHost(host2);
  assertTrue(zookeeperSch.isRestartRequired());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServices2() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceResponse response=createNiceMock(ServiceResponse.class);
  ServiceRequest request1=new ServiceRequest("cluster1","service1",null);
  Set<ServiceRequest> setRequests=new HashSet<ServiceRequest>();
  setRequests.add(request1);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createStrictMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.convertToResponse()).andReturn(response);
  replay(maintHelper,injector,clusters,cluster,service,response);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Set<ServiceResponse> setResponses=ServiceResourceProviderTest.getServices(controller,setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(injector,clusters,cluster,service,response);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHost() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  String host3="h3";
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,ServiceComponentHost> hostComponents=cluster.getService(serviceName).getServiceComponent(componentName1).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  hostComponents=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  Set<HostRequest> requests=new HashSet<HostRequest>();
  requests.clear();
  requests.add(new HostRequest(host1,clusterName,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    fail("Expect failure deleting hosts when components exist and have not been deleted.");
  }
 catch (  Exception e) {
  }
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"DISABLED"));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,"DISABLED"));
  updateHostComponents(schRequests,new HashMap<String,String>(),false);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host1,null));
  controller.deleteHostComponents(schRequests);
  Assert.assertEquals(0,cluster.getServiceComponentHosts(host1).size());
  requests.clear();
  requests.add(new HostRequest(host1,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
  }
 catch (  Exception e) {
    fail("Did not expect an error deleting the host from the cluster. Error: " + e.getMessage());
  }
  Assert.assertFalse(clusters.getHostsForCluster(clusterName).containsKey(host1));
  Assert.assertFalse(clusters.getClustersForHost(host1).contains(cluster));
  requests.clear();
  requests.add(new HostRequest(host2,clusterName,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
  }
 catch (  Exception e) {
    fail("Did not expect an error deleting the host from the cluster. Error: " + e.getMessage());
  }
  Assert.assertFalse(clusters.getHostsForCluster(clusterName).containsKey(host2));
  Assert.assertFalse(clusters.getClustersForHost(host2).contains(cluster));
  requests.clear();
  requests.add(new HostRequest(host1,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    Assert.fail("Expected a HostNotFoundException trying to remove a host that was already deleted.");
  }
 catch (  HostNotFoundException e) {
  }
  try {
    clusters.getHost(host1);
    Assert.fail("Expected a HostNotFoundException.");
  }
 catch (  HostNotFoundException e) {
  }
  requests.clear();
  requests.add(new HostRequest(host3,null,null));
  try {
    HostResourceProviderTest.deleteHosts(controller,requests);
    Assert.fail("Expected a HostNotFoundException trying to remove a host that was never added.");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrl() throws Exception {
  String INCORRECT_URL_2="http://bar.com/foo";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertNotNull(repo);
  assertNotNull(repo.getBaseUrl());
  String original=repo.getBaseUrl();
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(original,repo.getBaseUrl());
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,INCORRECT_BASE_URL);
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(INCORRECT_BASE_URL,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,INCORRECT_URL_2);
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertFalse(INCORRECT_BASE_URL.equals(repo.getBaseUrl()));
  assertEquals(INCORRECT_URL_2,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  Configuration configuration=injector.getInstance(Configuration.class);
  Properties properties=configuration.getProperties();
  properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
  properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
  Configuration newConfiguration=new Configuration(properties);
  AmbariMetaInfo ami=new AmbariMetaInfo(newConfiguration);
  injector.injectMembers(ami);
  ami.init();
  repo=ami.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(INCORRECT_URL_2,repo.getBaseUrl());
  assertNotNull(repo.getDefaultBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  ami.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,original);
  repo=ami.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(original,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrlController() throws Exception {
  String badUrl="http://hortonworks.com";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  RepositoryRequest request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(badUrl);
  Set<RepositoryRequest> requests=new HashSet<RepositoryRequest>();
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.fail("Expected a bad URL to throw an exception");
  }
 catch (  Exception e) {
    assertNotNull(e);
    Assert.assertTrue(e.getMessage().contains(badUrl));
  }
  request.setVerifyBaseUrl(false);
  controller.updateRepositories(requests);
  Assert.assertEquals(request.getBaseUrl(),repo.getBaseUrl());
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("https://hortonworks.com");
  requests.add(request);
  controller.updateRepositories(requests);
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("pro://hortonworks.com");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("http://rrr1.cccc");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(repo.getDefaultBaseUrl());
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(repo.getBaseUrl(),repo.getDefaultBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  String baseUrl=repo.getDefaultBaseUrl();
  if (!baseUrl.endsWith("/")) {
    baseUrl+="/";
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("ubuntu12")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  baseUrl=baseUrl.substring(0,baseUrl.length() - 1);
  Assert.assertTrue(!baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"/repodata/repomd.xml");
  Assert.assertTrue(!baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("suse11")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/foo/bar.xml,/repodata/repomd.xml");
  Assert.assertTrue(configuration.getRepoValidationSuffixes("ubuntu12").length > 1);
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassiveSkipServices() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  String componentName1_1="NAMENODE";
  String componentName1_2="DATANODE";
  String componentName1_3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1_1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName1_2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName1_3,State.INIT);
  String componentName2_1="JOBTRACKER";
  String componentName2_2="TASKTRACKER";
  createServiceComponent(clusterName,serviceName2,componentName2_1,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName2_2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1_1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName1_2,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName1_2,host2,null);
  createServiceComponentHost(clusterName,serviceName2,componentName2_1,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName2_2,host2,null);
  MaintenanceStateHelper maintenanceStateHelper=MaintenanceStateHelperTest.getMaintenanceStateHelperInstance(clusters);
  installService(clusterName,serviceName1,false,false,maintenanceStateHelper,null);
  installService(clusterName,serviceName2,false,false,maintenanceStateHelper,null);
  startService(clusterName,serviceName1,false,false,maintenanceStateHelper);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("context","Called from a test");
  Cluster cluster=clusters.getCluster(clusterName);
  for (  Service service : cluster.getServices().values()) {
    Assert.assertEquals(State.STARTED,service.getDesiredState());
  }
  Service service2=cluster.getService(serviceName2);
  service2.setMaintenanceState(MaintenanceState.ON);
  Set<ServiceRequest> srs=new HashSet<ServiceRequest>();
  srs.add(new ServiceRequest(clusterName,serviceName1,State.INSTALLED.name()));
  srs.add(new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name()));
  RequestStatusResponse rsr=ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  ShortTaskStatus sts : rsr.getTasks()) {
    String role=sts.getRole();
    Assert.assertFalse(role.equals(componentName2_1));
    Assert.assertFalse(role.equals(componentName2_2));
  }
  for (  Service service : cluster.getServices().values()) {
    if (service.getName().equals(serviceName2)) {
      Assert.assertEquals(State.STARTED,service.getDesiredState());
    }
 else {
      Assert.assertEquals(State.INSTALLED,service.getDesiredState());
    }
  }
  service2.setMaintenanceState(MaintenanceState.OFF);
  ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  Service service : cluster.getServices().values()) {
    Assert.assertEquals(State.INSTALLED,service.getDesiredState());
  }
  startService(clusterName,serviceName1,false,false,maintenanceStateHelper);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  Host h1=clusters.getHost(host1);
  h1.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  srs=new HashSet<ServiceRequest>();
  srs.add(new ServiceRequest(clusterName,serviceName1,State.INSTALLED.name()));
  srs.add(new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name()));
  rsr=ServiceResourceProviderTest.updateServices(controller,srs,requestProperties,false,false,maintenanceStateHelper);
  for (  ShortTaskStatus sts : rsr.getTasks()) {
    Assert.assertFalse(sts.getHostName().equals(host1));
  }
  h1.setMaintenanceState(cluster.getClusterId(),MaintenanceState.OFF);
  startService(clusterName,serviceName2,false,false,maintenanceStateHelper);
  service2.setMaintenanceState(MaintenanceState.ON);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName2,State.INSTALLED.name());
  rsr=ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertTrue("Service start request defaults to Cluster operation level," + "command does not create tasks",rsr == null || rsr.getTasks().size() == 0);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceWithInvalidInfo() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  try {
    createService(clusterName,serviceName,State.INSTALLING);
    fail("Service creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName);
    fail("Service creation should have failed");
  }
 catch (  Exception e) {
  }
  try {
    createService(clusterName,serviceName,State.INSTALLED);
    fail("Service creation should fail for invalid initial state");
  }
 catch (  Exception e) {
  }
  createService(clusterName,serviceName,null);
  String serviceName2="MAPREDUCE";
  createService(clusterName,serviceName2,State.INIT);
  ServiceRequest r=new ServiceRequest(clusterName,null,null);
  Set<ServiceResponse> response=ServiceResourceProviderTest.getServices(controller,Collections.singleton(r));
  Assert.assertEquals(2,response.size());
  for (  ServiceResponse svc : response) {
    Assert.assertTrue(svc.getServiceName().equals(serviceName) || svc.getServiceName().equals(serviceName2));
    Assert.assertEquals("HDP-0.1",svc.getDesiredStackVersion());
    Assert.assertEquals(State.INIT.toString(),svc.getDesiredState());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostsWithDecommissioned() throws Exception {
  final String host1="h1";
  final String host2="h2";
  String clusterName="foo1";
  setupClusterWithHosts(clusterName,"HDP-2.0.7",new ArrayList<String>(){
{
      add(host1);
      add(host2);
    }
  }
,"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Service s1=clusters.getCluster(clusterName).getService(serviceName);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host1).setComponentAdminState(HostComponentAdminState.DECOMMISSIONED);
  s1.getServiceComponent(componentName2).getServiceComponentHost(host2).setComponentAdminState(HostComponentAdminState.INSERVICE);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(5,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("DECOMMISSIONED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSERVICE");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  r=new ServiceComponentHostRequest(clusterName,null,null,null,null);
  r.setAdminState("INSTALLED");
  resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(0,resps.size());
  r=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,null);
  r.setAdminState("DECOMMISSIONED");
  try {
    updateHostComponents(Collections.singleton(r),new HashMap<String,String>(),false);
    Assert.fail("Must throw exception when decommission attribute is updated.");
  }
 catch (  IllegalArgumentException ex) {
    Assert.assertTrue(ex.getMessage().contains("Property adminState cannot be modified through update"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest(null,null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo",null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo","bar",null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,ClusterNotFoundException.class));
  }
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  clusters.addCluster("bar",new StackId("HDP-0.1"));
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","bar",null);
    set1.add(valid1);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid service");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("bar","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(0,clusters.getCluster("foo").getServices().size());
  set1.clear();
  ServiceRequest valid=new ServiceRequest("foo","HDFS",null);
  set1.add(valid);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for existing service");
  }
 catch (  Exception e) {
  }
  Assert.assertEquals(1,clusters.getCluster("foo").getServices().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUpdateStacks() throws Exception {
  StackInfo stackInfo=ambariMetaInfo.getStack(STACK_NAME,STACK_VERSION);
  for (  RepositoryInfo repositoryInfo : stackInfo.getRepositories()) {
    assertFalse(INCORRECT_BASE_URL.equals(repositoryInfo.getBaseUrl()));
    repositoryInfo.setBaseUrl(INCORRECT_BASE_URL);
    assertTrue(INCORRECT_BASE_URL.equals(repositoryInfo.getBaseUrl()));
  }
  controller.updateStacks();
  stackInfo=ambariMetaInfo.getStack(STACK_NAME,STACK_VERSION);
  for (  RepositoryInfo repositoryInfo : stackInfo.getRepositories()) {
    assertFalse(INCORRECT_BASE_URL.equals(repositoryInfo.getBaseUrl()));
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckWhenHostIsUnhealthy() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host3,null);
  installService(clusterName,serviceName,false,false);
  clusters.getHost("h3").setState(HostState.UNHEALTHY);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  long requestId=startService(clusterName,serviceName,true,false);
  List<HostRoleCommand> commands=actionDB.getRequestTasks(requestId);
  int commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.SERVICE_CHECK && command.getRole() == Role.HDFS_SERVICE_CHECK) {
      Assert.assertTrue(command.getHostName().equals("h2"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one service check.",1,commandCount);
  stopService(clusterName,serviceName,false,false);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  clusters.getHost("h2").setState(HostState.HEARTBEAT_LOST);
  requestId=startService(clusterName,serviceName,true,false);
  commands=actionDB.getRequestTasks(requestId);
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.SERVICE_CHECK && command.getRole() == Role.HDFS_SERVICE_CHECK) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one service check.",1,commandCount);
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("foo1",Role.HDFS_SERVICE_CHECK.name(),null,false);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  commands=actionDB.getRequestTasks(response.getRequestId());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.SERVICE_CHECK && command.getRole() == Role.HDFS_SERVICE_CHECK) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one service check.",1,commandCount);
  clusters.getHost("h3").setState(HostState.WAITING_FOR_HOST_STATUS_UPDATES);
  clusters.getHost("h2").setState(HostState.INIT);
  response=controller.createAction(actionRequest,requestProperties);
  commands=actionDB.getRequestTasks(response.getRequestId());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.SERVICE_CHECK && command.getRole() == Role.HDFS_SERVICE_CHECK) {
      Assert.assertTrue(command.getHostName().equals("h3") || command.getHostName().equals("h2"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one service check.",1,commandCount);
  Assert.assertEquals("",response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestStatusLogs() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  for (  Host h : clusters.getHosts()) {
    h.setPrefix(Configuration.PREFIX_DIR);
  }
  Map<String,Config> configs=new HashMap<String,Config>();
  Map<String,String> properties=new HashMap<String,String>();
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  Config c1=new ConfigImpl(cluster,"hdfs-site",properties,propertiesAttributes,injector);
  c1.setTag("v1");
  cluster.addConfig(c1);
  c1.persist();
  configs.put(c1.getType(),c1);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertFalse(taskStatuses.isEmpty());
  for (  ShortTaskStatus task : taskStatuses) {
    Assert.assertEquals("Task output logs don't match",Configuration.PREFIX_DIR + "/output-" + task.getTaskId()+ ".txt",task.getOutputLog());
    Assert.assertEquals("Task error logs don't match",Configuration.PREFIX_DIR + "/errors-" + task.getTaskId()+ ".txt",task.getErrorLog());
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComponentCategorySentWithRestart() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.7",new ArrayList<String>(){
{
      add("h1");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.7"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  installService("c1","HDFS",false,false);
  startService("c1","HDFS",false,false);
  Cluster c=clusters.getCluster("c1");
  Service s=c.getService("HDFS");
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  for (  ServiceComponent sc : s.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","HDFS_CLIENT",new ArrayList<String>(){
{
      add("h1");
    }
  }
);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",params,false);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("hdfs_client","abc");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  List<Stage> stages=actionDB.getAllStages(response.getRequestId());
  Assert.assertNotNull(stages);
  HostRoleCommand hrc=null;
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : stages) {
    for (    HostRoleCommand cmd : stage.getOrderedHostRoleCommands()) {
      if (cmd.getRole().equals(Role.HDFS_CLIENT)) {
        hrc=cmd;
      }
      Map<String,String> hostParamStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.DB_DRIVER_FILENAME));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.MYSQL_JDBC_URL));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.ORACLE_JDBC_URL));
    }
  }
  Assert.assertNotNull(hrc);
  Assert.assertEquals("RESTART HDFS/HDFS_CLIENT",hrc.getCommandDetail());
  Map<String,String> roleParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getRoleParams();
  Assert.assertNotNull(roleParams);
  Assert.assertEquals("CLIENT",roleParams.get(ExecutionCommand.KeyNames.COMPONENT_CATEGORY));
  Assert.assertTrue(hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().containsKey("hdfs_client"));
  Assert.assertEquals("abc",hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().get("hdfs_client"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServiceComponentHostUpdateStackId() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch3=sc2.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INSTALLED);
  sc2.setDesiredState(State.INSTALLED);
  ServiceComponentHostRequest req1;
  ServiceComponentHostRequest req2;
  ServiceComponentHostRequest req3;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  StackId newStack=new StackId("HDP-0.2");
  StackId oldStack=new StackId("HDP-0.1");
  c1.setCurrentStackVersion(newStack);
  c1.setDesiredStackVersion(newStack);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.UPGRADING);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch1.setStackVersion(oldStack);
  sch2.setStackVersion(oldStack);
  sch1.setDesiredStackVersion(newStack);
  sch2.setDesiredStackVersion(oldStack);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req2.setDesiredStackId("HDP-0.2");
  reqs.add(req2);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","testServiceComponentHostUpdateStackId");
  RequestStatusResponse resp=updateHostComponents(reqs,mapRequestProps,true);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  Assert.assertEquals(1,stages.size());
  Assert.assertEquals(2,stages.get(0).getOrderedHostRoleCommands().size());
  Assert.assertEquals("testServiceComponentHostUpdateStackId",stages.get(0).getRequestContext());
  Assert.assertEquals(State.UPGRADING,sch1.getState());
  Assert.assertEquals(State.UPGRADING,sch2.getState());
  sch1.refresh();
  Assert.assertTrue(sch1.getDesiredStackVersion().compareTo(newStack) == 0);
  sch2.refresh();
  Assert.assertTrue(sch2.getDesiredStackVersion().compareTo(newStack) == 0);
  for (  HostRoleCommand command : stages.get(0).getOrderedHostRoleCommands()) {
    ExecutionCommand execCommand=command.getExecutionCommandWrapper().getExecutionCommand();
    Assert.assertTrue(execCommand.getCommandParams().containsKey("source_stack_version"));
    Assert.assertTrue(execCommand.getCommandParams().containsKey("target_stack_version"));
    Assert.assertEquals(RoleCommand.UPGRADE,execCommand.getRoleCommand());
  }
  sch1.setState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setState(State.UPGRADING);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setState(State.UPGRADING);
  sch3.setDesiredState(State.INSTALLED);
  sch3.setStackVersion(oldStack);
  sch3.setDesiredStackVersion(newStack);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req2.setDesiredStackId("HDP-0.2");
  reqs.add(req2);
  req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
  req3.setDesiredStackId("HDP-0.2");
  reqs.add(req3);
  resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  stages=actionDB.getAllStages(resp.getRequestId());
  Assert.assertEquals(2,stages.size());
  Assert.assertEquals(2,stages.get(0).getOrderedHostRoleCommands().size());
  Assert.assertEquals("",stages.get(0).getRequestContext());
  Assert.assertEquals(State.UPGRADING,sch1.getState());
  Assert.assertEquals(State.UPGRADING,sch2.getState());
  Assert.assertEquals(State.UPGRADING,sch3.getState());
  sch1.refresh();
  Assert.assertTrue(sch1.getDesiredStackVersion().compareTo(newStack) == 0);
  sch2.refresh();
  Assert.assertTrue(sch2.getDesiredStackVersion().compareTo(newStack) == 0);
  sch3.refresh();
  Assert.assertTrue(sch3.getDesiredStackVersion().compareTo(newStack) == 0);
  for (  Stage stage : stages) {
    for (    HostRoleCommand command : stage.getOrderedHostRoleCommands()) {
      ExecutionCommand execCommand=command.getExecutionCommandWrapper().getExecutionCommand();
      Assert.assertTrue(execCommand.getCommandParams().containsKey("source_stack_version"));
      Assert.assertTrue(execCommand.getCommandParams().containsKey("target_stack_version"));
      Assert.assertEquals("{\"stackName\":\"HDP\",\"stackVersion\":\"0.2\"}",execCommand.getCommandParams().get("target_stack_version"));
      Assert.assertEquals(RoleCommand.UPGRADE,execCommand.getRoleCommand());
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyConfigs() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  ClusterRequest cr=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),null,null);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",null,null)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  Config config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  Map<String,String> map=new HashMap<String,String>();
  map.clear();
  map.put("c","d");
  Map<String,Map<String,String>> attributesMap=new HashMap<String,Map<String,String>>();
  attributesMap.put("final",new HashMap<String,String>());
  attributesMap.get("final").put("c","true");
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v3",map,attributesMap)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertTrue(config.getProperties().containsKey("c"));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertEquals("v2",config.getTag());
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
)));
  try {
    controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
    Assert.fail("Expect failure when creating a config that exists");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testDisableAndDeleteStates() throws Exception {
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos5");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
        bind(AmbariEventPublisher.class).toInstance(EasyMock.createMock(AmbariEventPublisher.class));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    Clusters clusters=injector.getInstance(Clusters.class);
    Gson gson=new Gson();
    clusters.addHost("host1");
    clusters.addHost("host2");
    clusters.addHost("host3");
    Host host=clusters.getHost("host1");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host2");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host3");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    ClusterRequest clusterRequest=new ClusterRequest(null,"c1","HDP-1.2.0",null);
    amc.createCluster(clusterRequest);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Type confType=new TypeToken<Map<String,String>>(){
    }
.getType();
    ConfigurationRequest configurationRequest=new ConfigurationRequest("c1","core-site","version1",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version1",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version1",gson.<Map<String,String>>fromJson("{ \"hive.server2.enable.doAs\" : \"true\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    Assert.assertTrue(clusters.getCluster("c1").getDesiredConfigs().containsKey("hive-site"));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<HostRequest> hostRequests=new HashSet<HostRequest>();
    hostRequests.add(new HostRequest("host1","c1",null));
    hostRequests.add(new HostRequest("host2","c1",null));
    hostRequests.add(new HostRequest("host3","c1",null));
    HostResourceProviderTest.createHosts(amc,hostRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Cluster cluster=clusters.getCluster("c1");
    Map<String,ServiceComponentHost> namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    ServiceComponentHost componentHost=namenodes.get("host1");
    Map<String,ServiceComponentHost> hostComponents=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.INSTALLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2",null));
    amc.createHostComponents(componentHostRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    Assert.assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host2");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    RequestStatusResponse response=ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    for (    ShortTaskStatus shortTaskStatus : response.getTasks()) {
      assertFalse("host1".equals(shortTaskStatus.getHostName()) && "NAMENODE".equals(shortTaskStatus.getRole()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.deleteHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    testRunSmokeTestFlag(mapRequestProps,amc,serviceRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host1");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    assertEquals(State.INSTALLED,namenodes.get("host1").getState());
    ServiceComponentHost sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        tmp.setState(State.UNKNOWN);
        sch=tmp;
      }
    }
    assertNotNull(sch);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    mapRequestProps.put(RequestOperationLevel.OPERATION_CLUSTER_ID,"c1");
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    mapRequestProps.clear();
    assertEquals(sch.getServiceComponentName(),"DATANODE");
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    amc.deleteHostComponents(componentHostRequests);
    sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        sch=tmp;
      }
    }
    org.junit.Assert.assertNull(sch);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(2,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.deleteServices(amc,serviceRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(0,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    org.junit.Assert.assertEquals(1,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    configurationRequest=new ConfigurationRequest("c1","core-site","version2",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version2",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version2",gson.<Map<String,String>>fromJson("{ \"hbase_hdfs_root_dir\" : \"/apps/hbase/\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    Map<String,ServiceComponentHost> datanodes=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(3,datanodes.size());
    Map<String,ServiceComponentHost> namenodes2=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes2.size());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetServices___OR_Predicate_ServiceNotFoundException() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  Clusters clusters=createNiceMock(Clusters.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service1=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceResponse response=createNiceMock(ServiceResponse.class);
  ServiceResponse response2=createNiceMock(ServiceResponse.class);
  ServiceRequest request1=new ServiceRequest("cluster1","service1",null);
  ServiceRequest request2=new ServiceRequest("cluster1","service2",null);
  ServiceRequest request3=new ServiceRequest("cluster1","service3",null);
  ServiceRequest request4=new ServiceRequest("cluster1","service4",null);
  Set<ServiceRequest> setRequests=new HashSet<ServiceRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper);
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createStrictMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(4);
  expect(cluster.getService("service1")).andReturn(service1);
  expect(cluster.getService("service2")).andThrow(new ServiceNotFoundException("cluster1","service2"));
  expect(cluster.getService("service3")).andThrow(new ServiceNotFoundException("cluster1","service3"));
  expect(cluster.getService("service4")).andReturn(service2);
  expect(service1.convertToResponse()).andReturn(response);
  expect(service2.convertToResponse()).andReturn(response2);
  replay(maintHelper,injector,clusters,cluster,service1,service2,response,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  Set<ServiceResponse> setResponses=ServiceResourceProviderTest.getServices(controller,setRequests);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,service1,service2,response,response2);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallAndStartService() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Map<String,Config> configs=new HashMap<String,Config>();
  Map<String,String> properties=new HashMap<String,String>();
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  properties.put("a","a1");
  properties.put("b","b1");
  Config c1=new ConfigImpl(cluster,"hdfs-site",properties,propertiesAttributes,injector);
  properties.put("c","c1");
  properties.put("d","d1");
  Config c2=new ConfigImpl(cluster,"core-site",properties,propertiesAttributes,injector);
  Config c3=new ConfigImpl(cluster,"foo-site",properties,propertiesAttributes,injector);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  c1.setTag("v1");
  c2.setTag("v1");
  c3.setTag("v1");
  cluster.addConfig(c1);
  cluster.addConfig(c2);
  cluster.addConfig(c3);
  c1.persist();
  c2.persist();
  c3.persist();
  configs.put(c1.getType(),c1);
  configs.put(c2.getType(),c2);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertEquals(5,taskStatuses.size());
  boolean foundH1NN=false;
  boolean foundH1DN=false;
  boolean foundH2DN=false;
  boolean foundH1CLT=false;
  boolean foundH2CLT=false;
  for (  ShortTaskStatus taskStatus : taskStatuses) {
    LOG.debug("Task dump :" + taskStatus.toString());
    Assert.assertEquals(RoleCommand.INSTALL.toString(),taskStatus.getCommand());
    Assert.assertEquals(HostRoleStatus.PENDING.toString(),taskStatus.getStatus());
    if (taskStatus.getHostName().equals("h1")) {
      if (Role.NAMENODE.toString().equals(taskStatus.getRole())) {
        foundH1NN=true;
      }
 else       if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH1DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH1CLT=true;
      }
 else {
        fail("Found invalid role for host h1");
      }
    }
 else     if (taskStatus.getHostName().equals("h2")) {
      if (Role.DATANODE.toString().equals(taskStatus.getRole())) {
        foundH2DN=true;
      }
 else       if (Role.HDFS_CLIENT.toString().equals(taskStatus.getRole())) {
        foundH2CLT=true;
      }
 else {
        fail("Found invalid role for host h2");
      }
    }
 else {
      fail("Found invalid host in task list");
    }
  }
  Assert.assertTrue(foundH1DN && foundH1NN && foundH2DN&& foundH1CLT&& foundH2CLT);
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
  for (  Stage stage : stages) {
    LOG.info("Stage Details for Install Service" + ", stageId=" + stage.getStageId() + ", actionId="+ stage.getActionId());
    for (    String host : stage.getHosts()) {
      for (      ExecutionCommandWrapper ecw : stage.getExecutionCommands(host)) {
        Assert.assertFalse(ecw.getExecutionCommand().getHostLevelParams().get("repo_info").isEmpty());
      }
    }
  }
  org.apache.ambari.server.controller.spi.Request request=PropertyHelper.getReadRequest(TaskResourceProvider.TASK_CLUSTER_NAME_PROPERTY_ID,TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID,TaskResourceProvider.TASK_STAGE_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).toPredicate();
  List<HostRoleCommandEntity> entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(5,entities.size());
  predicate=new PredicateBuilder().property(TaskResourceProvider.TASK_REQUEST_ID_PROPERTY_ID).equals(trackAction.getRequestId()).and().property(TaskResourceProvider.TASK_ID_PROPERTY_ID).equals(1L).toPredicate();
  entities=hostRoleCommandDAO.findAll(request,predicate);
  Assert.assertEquals(1,entities.size());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    if (sc.getName().equals("HDFS_CLIENT")) {
      Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    }
 else {
      Assert.assertEquals(State.STARTED,sc.getDesiredState());
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(2,stages.size());
  StringBuilder sb=new StringBuilder();
  clusters.debugDump(sb);
  LOG.info("Cluster Dump: " + sb.toString());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        sch.setState(State.INSTALLED);
      }
 else {
        sch.setState(State.INSTALL_FAILED);
      }
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  requests.clear();
  requests.add(r);
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackVersionActiveAttr() throws Exception {
  for (  StackInfo stackInfo : ambariMetaInfo.getStacks(STACK_NAME)) {
    if (stackInfo.getVersion().equalsIgnoreCase(STACK_VERSION)) {
      stackInfo.setActive(true);
    }
  }
  StackVersionRequest requestWithParams=new StackVersionRequest(STACK_NAME,STACK_VERSION);
  Set<StackVersionResponse> responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackVersionResponse responseWithParams : responsesWithParams) {
    Assert.assertTrue(responseWithParams.isActive());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.STARTED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.UNKNOWN);
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  ServiceComponentRequest req1, req2, req3;
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INIT.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.STARTED.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.STARTED);
  sch2.setState(State.INIT);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INIT);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  req3=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  RequestStatusResponse trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertEquals(State.INSTALLED,s1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch4.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch5.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getState());
  Assert.assertEquals(State.INIT,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INIT,sch5.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  Assert.assertTrue(!stages.isEmpty());
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHbaseDecommission() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HBASE";
  createService(clusterName,serviceName,null);
  String componentName1="HBASE_MASTER";
  String componentName2="HBASE_REGIONSERVER";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  Map<String,String> cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2").setState(State.INSTALLED);
  params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("mark_draining_only","true");
      put("slave_type","HBASE_REGIONSERVER");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("true",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("included_hosts","h2");
    }
  }
;
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Included: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertTrue(cmdParams.containsKey("excluded_hosts"));
  Assert.assertEquals("",cmdParams.get("excluded_hosts"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFiltersWithCustomActions() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","HDFS","","Some custom action.",TargetHostType.ALL,Short.valueOf("10010")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h2");
    }
  }
;
  RequestResourceFilter resourceFilter1=new RequestResourceFilter("HDFS","DATANODE",hosts);
  hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter2=new RequestResourceFilter("HDFS","NAMENODE",hosts);
  resourceFilters.add(resourceFilter1);
  resourceFilters.add(resourceFilter2);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=null;
  try {
    response=controller.createAction(actionRequest,requestProperties);
  }
 catch (  AmbariException ae) {
    LOG.info("Expected exception.",ae);
    Assert.assertTrue(ae.getMessage().contains("Custom action definition only " + "allows one resource filter to be specified"));
  }
  resourceFilters.remove(resourceFilter1);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  HostRoleCommand nnCommand=null;
  for (  HostRoleCommand hrc : actionDB.getRequestTasks(response.getRequestId())) {
    if (hrc.getHostName().equals("h1")) {
      nnCommand=hrc;
    }
  }
  Assert.assertNotNull(nnCommand);
  ExecutionCommand cmd=nnCommand.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("a1",cmd.getRole());
  Assert.assertEquals("10010",cmd.getCommandParams().get("command_timeout"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : actionDB.getAllStages(response.getRequestId())) {
    Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
    Assert.assertTrue(commandParamsStage.containsKey("test"));
  }
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackServices() throws Exception {
  StackServiceRequest request=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,null);
  Set<StackServiceResponse> responses=controller.getStackServices(Collections.singleton(request));
  Assert.assertEquals(11,responses.size());
  StackServiceRequest requestWithParams=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME);
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),SERVICE_NAME);
    Assert.assertTrue(responseWithParams.getConfigTypes().size() > 0);
  }
  StackServiceRequest invalidRequest=new StackServiceRequest(STACK_NAME,NEW_STACK_VERSION,NON_EXT_VALUE);
  try {
    controller.getStackServices(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithHostActions() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE2";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="HISTORYSERVER";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host3,null);
  createServiceComponentHost(clusterName,serviceName2,componentName4,host3,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2, cr3;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr3=new ConfigurationRequest(clusterName,"mapred-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  cluster=clusters.getCluster(clusterName);
  final Config config=new ConfigImpl("core-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(cluster,"g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config2=new ConfigImpl("mapred-site");
  config2.setProperties(configs);
  config2.setTag("version122");
  groupId=createConfigGroup(cluster,"g2","t2",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Long requestId=installService(clusterName,serviceName1,false,false);
  HostRoleCommand namenodeInstall=null;
  HostRoleCommand clientInstall=null;
  HostRoleCommand slaveInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.NAMENODE) && hrc.getHostName().equals("h1")) {
        namenodeInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h3")) {
        clientInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.DATANODE) && hrc.getHostName().equals("h2")) {
        slaveInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(namenodeInstall);
  Assert.assertNotNull(clientInstall);
  Assert.assertNotNull(slaveInstall);
  Assert.assertTrue(namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("c",namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  startService(clusterName,serviceName1,false,false);
  requestId=installService(clusterName,serviceName2,false,false);
  HostRoleCommand mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("b",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
  ConfigGroup configGroup=cluster.getConfigGroups().get(groupId);
  configGroup.setHosts(new HashMap<Long,Host>(){
{
      put(3L,clusters.getHost("h3"));
    }
  }
);
  configGroup.persist();
  requestId=startService(clusterName,serviceName2,false,false);
  mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("c",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecommissonDatanodeAction() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertNotNull(execCmd.getConfigurationTags().get("hdfs-site"));
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertEquals(Role.NAMENODE,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h1");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Map<String,String> cmdParams=execCmd.getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("update_exclude_file_only"));
  Assert.assertTrue(cmdParams.get("update_exclude_file_only").equals("false"));
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.INSTALLED.toString());
  Set<ServiceComponentHostRequest> requests=new HashSet<ServiceComponentHostRequest>();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.INSTALLED);
  r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.STARTED);
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("included_hosts","h1 , h2");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertNotNull(storedTasks);
  scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(2,storedTasks.size());
  int countRefresh=0;
  for (  HostRoleCommand hrc : storedTasks) {
    Assert.assertTrue("DECOMMISSION, Included: h1,h2".equals(hrc.getCommandDetail()));
    Assert.assertTrue("DECOMMISSION".equals(hrc.getCustomCommandName()));
    cmdParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
    if (!cmdParams.containsKey("update_exclude_file_only") || !cmdParams.get("update_exclude_file_only").equals("true")) {
      countRefresh++;
    }
  }
  Assert.assertEquals(2,countRefresh);
  scHost.setComponentAdminState(null);
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testCreateServiceCheckActions() throws Exception {
  setupClusterWithHosts("c1","HDP-0.1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  cluster.setCurrentStackVersion(new StackId("HDP-0.1"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  config1.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr1",new HashMap<String,String>());
    }
  }
);
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  config2.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr2",new HashMap<String,String>());
    }
  }
);
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addDesiredConfig("_test",Collections.singleton(config1));
  cluster.addDesiredConfig("_test",Collections.singleton(config2));
  Service hdfs=cluster.addService("HDFS");
  Service mapReduce=cluster.addService("MAPREDUCE");
  hdfs.persist();
  mapReduce.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  mapReduce.addServiceComponent(Role.MAPREDUCE_CLIENT.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  mapReduce.getServiceComponent(Role.MAPREDUCE_CLIENT.name()).addServiceComponentHost("h2").persist();
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",Role.HDFS_SERVICE_CHECK.name(),params,false);
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus task=response.getTasks().get(0);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  ExecutionCommandDAO executionCommandDAO=injector.getInstance(ExecutionCommandDAO.class);
  ExecutionCommandEntity commandEntity=executionCommandDAO.findByPK(task.getTaskId());
  Gson gson=new Gson();
  ExecutionCommand executionCommand=gson.fromJson(new StringReader(new String(commandEntity.getCommand())),ExecutionCommand.class);
  assertFalse(executionCommand.getConfigurationTags().isEmpty());
  assertTrue(executionCommand.getConfigurations() == null || executionCommand.getConfigurations().isEmpty());
  assertEquals(1,storedTasks.size());
  HostRoleCommand hostRoleCommand=storedTasks.get(0);
  assertEquals("SERVICE_CHECK HDFS",hostRoleCommand.getCommandDetail());
  assertNull(hostRoleCommand.getCustomCommandName());
  assertEquals(task.getTaskId(),hostRoleCommand.getTaskId());
  assertNotNull(actionRequest.getResourceFilters());
  RequestResourceFilter requestResourceFilter=actionRequest.getResourceFilters().get(0);
  assertEquals(resourceFilter.getServiceName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getServiceName());
  assertEquals(actionRequest.getClusterName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getClusterName());
  assertEquals(actionRequest.getCommandName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRole());
  assertEquals(Role.HDFS_CLIENT.name(),hostRoleCommand.getEvent().getEvent().getServiceComponentName());
  assertEquals(actionRequest.getParameters(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRoleParams());
  assertNotNull(hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations());
  assertEquals(2,hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().size());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),stage.getRequestContext());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  actionRequest=new ExecuteActionRequest("c1",Role.MAPREDUCE_SERVICE_CHECK.name(),null,false);
  resourceFilter=new RequestResourceFilter("MAPREDUCE",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("MAPREDUCE");
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  List<HostRoleCommand> tasks=actionDB.getRequestTasks(response.getRequestId());
  assertEquals(1,tasks.size());
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,null);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  assertEquals("",response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponent() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest(STACK_NAME,"2.0.6","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesMultiple() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
  ServiceRequest valid2=new ServiceRequest("foo","MAPREDUCE",null);
  set1.add(valid1);
  set1.add(valid2);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    valid1=new ServiceRequest("foo","PIG",null);
    valid2=new ServiceRequest("foo","MAPREDUCE",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid services");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,DuplicateResourceException.class));
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(2,clusters.getCluster("foo").getServices().size());
  Assert.assertNotNull(clusters.getCluster("foo").getService("HDFS"));
  Assert.assertNotNull(clusters.getCluster("foo").getService("MAPREDUCE"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActionNoCluster() throws Exception {
  String hostname1="h1";
  String hostname2="h2";
  addHost(hostname1);
  addHost(hostname2);
  ambariMetaInfo.addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","","","action def description",TargetHostType.ANY,Short.valueOf("60")));
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  Map<String,String> requestParams=new HashMap<String,String>();
  requestParams.put("some_custom_param","abc");
  List<String> hosts=Arrays.asList(hostname1);
  RequestResourceFilter resourceFilter=new RequestResourceFilter(null,null,hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals(hostname1,taskStatus.getHostName());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  hosts=Arrays.asList(hostname1,hostname2);
  resourceFilter=new RequestResourceFilter(null,null,hosts);
  resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  boolean host1Found=false;
  boolean host2Found=false;
  for (  ShortTaskStatus sts : response.getTasks()) {
    if (sts.getHostName().equals(hostname1)) {
      host1Found=true;
    }
 else     if (sts.getHostName().equals(hostname2)) {
      host2Found=true;
    }
  }
  Assert.assertTrue(host1Found);
  Assert.assertTrue(host2Found);
  stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(2,storedTasks.size());
  task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testGetExecutionCommandWithClusterEnvForRetry() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","5");
  configs.put("commands_to_retry","INSTALL");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("phase","INITIAL_INSTALL");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  ExecutionCommand ec=execWrapper.getExecutionCommand();
  Map<String,Map<String,String>> configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.INSTALLED);
  }
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","12");
  configs.put("commands_to_retry","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version2",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("12",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","asdf");
  configs.put("command_retry_max_time_in_sec","-5");
  configs.put("commands_to_retry2","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version3",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("0",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostComponentsBadState() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host1)) {
    sch.setState(State.INSTALLED);
  }
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.UNKNOWN);
  }
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("datanode","dn_value");
  requestProps.put("namenode","nn_value");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  Assert.assertTrue(execWrapper.getExecutionCommand().getCommandParams().containsKey("datanode"));
  Assert.assertFalse(execWrapper.getExecutionCommand().getCommandParams().containsKey("namendode"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    Assert.assertEquals(State.UNKNOWN,sch.getState());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostUpdateRecursive() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.INIT);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALL_FAILED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  ServiceComponentHostRequest req1, req2, req3, req4, req5;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  try {
    reqs.clear();
    req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
    req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
    req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
    req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
    req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.STARTED.toString());
    reqs.add(req1);
    reqs.add(req2);
    reqs.add(req3);
    reqs.add(req4);
    reqs.add(req5);
    updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  }
 catch (  Exception e) {
    fail("Failure for invalid states");
  }
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,null,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req3=new ServiceComponentHostRequest(clusterName,null,componentName2,host1,State.INSTALLED.toString());
  req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
  req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  reqs.add(req4);
  reqs.add(req5);
  RequestStatusResponse trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNotNull(trackAction);
  long requestId=trackAction.getRequestId();
  Assert.assertFalse(actionDB.getAllStages(requestId).isEmpty());
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponent() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host3,null);
  installService(clusterName,serviceName,false,false);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host3,State.INSTALLED.name());
  Set<ServiceComponentHostRequest> setReqs=new HashSet<ServiceComponentHostRequest>();
  setReqs.add(schr);
  RequestStatusResponse resp=updateHostComponents(setReqs,Collections.<String,String>emptyMap(),false);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  HostRoleCommand clientReinstallCmd=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getHostName().equals(host3) && hrc.getRole().toString().equals("HDFS_CLIENT")) {
        clientReinstallCmd=hrc;
        break;
      }
    }
  }
  Assert.assertNotNull(clientReinstallCmd);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testUpdateClusterUpgradabilityCheck() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  StackId currentStackId=new StackId("HDP-0.2");
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createCluster(clusterName);
  Cluster c=clusters.getCluster(clusterName);
  c.setDesiredStackVersion(currentStackId);
  ClusterRequest r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.3",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Illegal request to upgrade to"));
  }
  StackId unsupportedStackId=new StackId("HDP-2.2.0");
  c.setDesiredStackVersion(unsupportedStackId);
  c.setCurrentStackVersion(unsupportedStackId);
  c.refresh();
  r=new ClusterRequest(c.getClusterId(),clusterName,"HDP-0.2",null);
  try {
    controller.updateClusters(Collections.singleton(r),mapRequestProps);
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Upgrade is not allowed from"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponentFromServiceChange() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName,host2,null);
  installService(clusterName,serviceName,false,false);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName,State.STARTED.name());
  Set<ServiceRequest> setReqs=new HashSet<ServiceRequest>();
  setReqs.add(sr);
  RequestStatusResponse resp=ServiceResourceProviderTest.updateServices(controller,setReqs,Collections.<String,String>emptyMap(),false,true);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  Map<String,Role> hostsToRoles=new HashMap<String,Role>();
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      hostsToRoles.put(hrc.getHostName(),hrc.getRole());
    }
  }
  Map<String,Role> expectedHostsToRoles=new HashMap<String,Role>();
  expectedHostsToRoles.put(host1,Role.HDFS_CLIENT);
  expectedHostsToRoles.put(host2,Role.HDFS_CLIENT);
  Assert.assertEquals(expectedHostsToRoles,hostsToRoles);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkipTaskOnUnhealthyHosts() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host3,null);
  installService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEALTHY);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  clusters.getHost("h3").setState(HostState.HEARTBEAT_LOST);
  long requestId=startService(clusterName,serviceName,true,false);
  List<HostRoleCommand> commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(3,commands.size());
  int commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h1") || command.getHostName().equals("h2"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only two task.",2,commandCount);
  stopService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h2").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=startService(clusterName,serviceName,true,false);
  commands=actionDB.getRequestTasks(requestId);
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one task.",1,commandCount);
  stopService(clusterName,serviceName,false,false);
  clusters.getHost("h1").setState(HostState.HEALTHY);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=startService(clusterName,serviceName,true,false);
  commands=actionDB.getRequestTasks(requestId);
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.START) {
      Assert.assertTrue(command.getHostName().equals("h3") || command.getHostName().equals("h2") || command.getHostName().equals("h1"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect all three task.",3,commandCount);
  clusters.getHost("h2").setState(HostState.HEARTBEAT_LOST);
  requestId=stopService(clusterName,serviceName,false,false);
  commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(2,commands.size());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.STOP) {
      Assert.assertTrue(command.getHostName().equals("h3") || command.getHostName().equals("h1"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only two task.",2,commandCount);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc3=s.getServiceComponent(componentName2);
  for (  ServiceComponentHost sch : sc3.getServiceComponentHosts().values()) {
    if (sch.getHostName().equals("h3")) {
      sch.setState(State.INSTALL_FAILED);
    }
  }
  clusters.getHost("h3").setState(HostState.HEARTBEAT_LOST);
  clusters.getHost("h2").setState(HostState.HEALTHY);
  requestId=installService(clusterName,serviceName,false,false);
  Assert.assertEquals(-1,requestId);
  clusters.getHost("h3").setState(HostState.HEALTHY);
  requestId=installService(clusterName,serviceName,false,false);
  commands=actionDB.getRequestTasks(requestId);
  Assert.assertEquals(1,commands.size());
  commandCount=0;
  for (  HostRoleCommand command : commands) {
    if (command.getRoleCommand() == RoleCommand.INSTALL) {
      Assert.assertTrue(command.getHostName().equals("h3"));
      commandCount++;
    }
  }
  Assert.assertEquals("Expect only one task.",1,commandCount);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecutionCommandConfiguration() throws AmbariException {
  Map<String,Map<String,String>> config=new HashMap<String,Map<String,String>>();
  config.put("type1",new HashMap<String,String>());
  config.put("type3",new HashMap<String,String>());
  config.get("type3").put("name1","neverchange");
  configHelper.applyCustomConfig(config,"type1","name1","value11",false);
  Assert.assertEquals("value11",config.get("type1").get("name1"));
  config.put("type1",new HashMap<String,String>());
  configHelper.applyCustomConfig(config,"type1","name1","value12",false);
  Assert.assertEquals("value12",config.get("type1").get("name1"));
  configHelper.applyCustomConfig(config,"type2","name2","value21",false);
  Assert.assertEquals("value21",config.get("type2").get("name2"));
  configHelper.applyCustomConfig(config,"type2","name2","",true);
  Assert.assertEquals("",config.get("type2").get("DELETED_name2"));
  Assert.assertEquals("neverchange",config.get("type3").get("name1"));
  Map<String,String> persistedClusterConfig=new HashMap<String,String>();
  persistedClusterConfig.put("name1","value11");
  persistedClusterConfig.put("name3","value31");
  persistedClusterConfig.put("name4","value41");
  Map<String,String> override=new HashMap<String,String>();
  override.put("name1","value12");
  override.put("name2","value21");
  override.put("DELETED_name3","value31");
  Map<String,String> mergedConfig=configHelper.getMergedConfig(persistedClusterConfig,override);
  Assert.assertEquals(3,mergedConfig.size());
  Assert.assertFalse(mergedConfig.containsKey("name3"));
  Assert.assertEquals("value12",mergedConfig.get("name1"));
  Assert.assertEquals("value21",mergedConfig.get("name2"));
  Assert.assertEquals("value41",mergedConfig.get("name4"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActions() throws Exception {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  Config config3=cf.createNew(cluster,"yarn-site",new HashMap<String,String>(){
{
      put("test.password","supersecret");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addConfig(config3);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  ActionDefinition a1=new ActionDefinition("a1",ActionType.SYSTEM,"test,[optional1]","","","Does file exist",TargetHostType.SPECIFIC,Short.valueOf("100"));
  controller.getAmbariMetaInfo().addActionDefinition(a1);
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a2",ActionType.SYSTEM,"","HDFS","DATANODE","Does file exist",TargetHostType.ALL,Short.valueOf("1000")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("pwd","SECRET:yarn-site:1:test.password");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("datanode","abc");
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","DATANODE",hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h1",taskStatus.getHostName());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals("h1",task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("h1",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> hostParametersStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
  Map<String,String> commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertNotNull(hostParametersStage.get("jdk_location"));
  Assert.assertEquals("900",cmd.getCommandParams().get("command_timeout"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  a1.setDefaultTimeout((short)1800);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  List<HostRoleCommand> storedTasks1=actionDB.getRequestTasks(response.getRequestId());
  cmd=storedTasks1.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("1800",cmd.getCommandParams().get("command_timeout"));
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",null);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a2",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  final List<HostRoleCommand> storedTasks2=actionDB.getRequestTasks(response.getRequestId());
  task=storedTasks2.get(1);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a2",task.getRole().name());
  HashSet<String> expectedHosts=new HashSet<String>(){
{
      add("h2");
      add("h1");
    }
  }
;
  HashSet<String> actualHosts=new HashSet<String>(){
{
      add(storedTasks2.get(1).getHostName());
      add(storedTasks2.get(0).getHostName());
    }
  }
;
  Assert.assertEquals(expectedHosts,actualHosts);
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertEquals("h2",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  hosts=new ArrayList<String>(){
{
      add("h3");
    }
  }
;
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",hosts);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h3",taskStatus.getHostName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.2"));
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String serviceName2="HBASE";
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HBASE_MASTER";
  String componentName4="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName2,componentName3,host1,State.INIT.toString());
  ServiceComponentHostRequest r6=new ServiceComponentHostRequest(clusterName,serviceName1,componentName4,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  set1.add(r6);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  Service s2=c1.getService(serviceName2);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s2.getServiceComponent(componentName3);
  ServiceComponent sc4=s1.getServiceComponent(componentName4);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  ServiceComponentHost sch6=sc4.getServiceComponentHost(host2);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sc4.setDesiredState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch6.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  sch6.setState(State.INSTALLED);
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest req1, req2;
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.STARTED);
  sch2.setDesiredState(State.STARTED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.STARTED);
  sch5.setDesiredState(State.STARTED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,s1.getDesiredState());
  Assert.assertEquals(State.STARTED,s2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc1.getDesiredState());
  Assert.assertEquals(State.STARTED,sc2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getDesiredState());
  Assert.assertEquals(State.STARTED,sch2.getDesiredState());
  Assert.assertEquals(State.STARTED,sch3.getDesiredState());
  Assert.assertEquals(State.STARTED,sch4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch5.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch6.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getState());
  Assert.assertEquals(State.INSTALLED,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INSTALLED,sch5.getState());
  Assert.assertEquals(State.INSTALLED,sch6.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  Assert.assertTrue(!stages.isEmpty());
  Assert.assertEquals(3,stages.size());
  Stage stage1=null, stage2=null, stage3=null;
  for (  Stage s : stages) {
    if (s.getStageId() == 0) {
      stage1=s;
    }
    if (s.getStageId() == 1) {
      stage2=s;
    }
    if (s.getStageId() == 2) {
      stage3=s;
    }
  }
  Assert.assertEquals(2,stage1.getExecutionCommands(host1).size());
  Assert.assertEquals(1,stage1.getExecutionCommands(host2).size());
  Assert.assertEquals(1,stage2.getExecutionCommands(host1).size());
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"NAMENODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"DATANODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host2,"NAMENODE"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host1,"HBASE_MASTER"));
  Assert.assertNull(stage1.getExecutionCommandWrapper(host2,"DATANODE"));
  Assert.assertNotNull(stage3.getExecutionCommandWrapper(host1,"HBASE_SERVICE_CHECK"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host2,"HDFS_SERVICE_CHECK"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage s : stages) {
    for (    List<ExecutionCommandWrapper> list : s.getExecutionCommands().values()) {
      for (      ExecutionCommandWrapper ecw : list) {
        if (ecw.getExecutionCommand().getRole().contains("SERVICE_CHECK")) {
          Map<String,String> hostParams=StageUtils.getGson().fromJson(s.getHostParamsStage(),type);
          Assert.assertNotNull(hostParams);
          Assert.assertTrue(hostParams.size() > 0);
          Assert.assertTrue(hostParams.containsKey("stack_version"));
          Assert.assertEquals(hostParams.get("stack_version"),c1.getDesiredStackVersion().getStackVersion());
        }
      }
    }
  }
  sch1.setState(State.STARTED);
  sch2.setState(State.STARTED);
  sch3.setState(State.STARTED);
  sch4.setState(State.STARTED);
  sch5.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceCheckSupported() throws Exception {
  StackServiceRequest hdfsServiceRequest=new StackServiceRequest(STACK_NAME,"2.0.8",SERVICE_NAME);
  Set<StackServiceResponse> responses=controller.getStackServices(Collections.singleton(hdfsServiceRequest));
  Assert.assertEquals(1,responses.size());
  StackServiceResponse response=responses.iterator().next();
  assertTrue(response.isServiceCheckSupported());
  StackServiceRequest fakeServiceRequest=new StackServiceRequest(STACK_NAME,"2.0.8",FAKE_SERVICE_NAME);
  responses=controller.getStackServices(Collections.singleton(fakeServiceRequest));
  Assert.assertEquals(1,responses.size());
  response=responses.iterator().next();
  assertFalse(response.isServiceCheckSupported());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHostComponentInVariousStates() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-1.3.1"));
  String serviceName="HDFS";
  String mapred="MAPREDUCE";
  createService(clusterName,serviceName,null);
  createService(clusterName,mapred,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="JOBTRACKER";
  String componentName5="TASKTRACKER";
  String componentName6="MAPREDUCE_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  createServiceComponent(clusterName,mapred,componentName4,State.INIT);
  createServiceComponent(clusterName,mapred,componentName5,State.INIT);
  createServiceComponent(clusterName,mapred,componentName6,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName4,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName5,host1,null);
  createServiceComponentHost(clusterName,mapred,componentName6,host1,null);
  installService(clusterName,serviceName,false,false);
  installService(clusterName,mapred,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Service s2=cluster.getService(mapred);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  sc1.getServiceComponentHosts().values().iterator().next().setState(State.STARTED);
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  try {
    controller.deleteHostComponents(schRequests);
    Assert.fail("Expect failure while deleting.");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Host Component cannot be removed"));
  }
  sc1.getServiceComponentHosts().values().iterator().next().setDesiredState(State.STARTED);
  sc1.getServiceComponentHosts().values().iterator().next().setState(State.UNKNOWN);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  sc2.getServiceComponentHosts().values().iterator().next().setState(State.INIT);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  sc3.getServiceComponentHosts().values().iterator().next().setState(State.INSTALL_FAILED);
  ServiceComponent sc4=s2.getServiceComponent(componentName4);
  sc4.getServiceComponentHosts().values().iterator().next().setDesiredState(State.INSTALLED);
  sc4.getServiceComponentHosts().values().iterator().next().setState(State.DISABLED);
  ServiceComponent sc5=s2.getServiceComponent(componentName5);
  sc5.getServiceComponentHosts().values().iterator().next().setState(State.INSTALLED);
  ServiceComponent sc6=s2.getServiceComponent(componentName6);
  sc6.getServiceComponentHosts().values().iterator().next().setState(State.INIT);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName4,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName5,host1,null));
  schRequests.add(new ServiceComponentHostRequest(clusterName,mapred,componentName6,host1,null));
  controller.deleteHostComponents(schRequests);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceWidgetCreationOnServiceCreate() throws Exception {
  String clusterName="foo1";
  ClusterRequest r=new ClusterRequest(null,clusterName,State.INSTALLED.name(),SecurityType.NONE,"OTHER-2.0",null);
  controller.createCluster(r);
  String serviceName="HBASE";
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("OTHER-2.0"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  WidgetDAO widgetDAO=injector.getInstance(WidgetDAO.class);
  WidgetLayoutDAO widgetLayoutDAO=injector.getInstance(WidgetLayoutDAO.class);
  List<WidgetEntity> widgetEntities=widgetDAO.findAll();
  List<WidgetLayoutEntity> layoutEntities=widgetLayoutDAO.findAll();
  Assert.assertNotNull(widgetEntities);
  Assert.assertFalse(widgetEntities.isEmpty());
  Assert.assertNotNull(layoutEntities);
  Assert.assertFalse(layoutEntities.isEmpty());
  WidgetEntity candidateVisibleEntity=null;
  for (  WidgetEntity entity : widgetEntities) {
    if (entity.getWidgetName().equals("OPEN_CONNECTIONS")) {
      candidateVisibleEntity=entity;
    }
  }
  Assert.assertNotNull(candidateVisibleEntity);
  Assert.assertEquals("GRAPH",candidateVisibleEntity.getWidgetType());
  Assert.assertEquals("ambari",candidateVisibleEntity.getAuthor());
  Assert.assertEquals("CLUSTER",candidateVisibleEntity.getScope());
  Assert.assertNotNull(candidateVisibleEntity.getMetrics());
  Assert.assertNotNull(candidateVisibleEntity.getProperties());
  Assert.assertNotNull(candidateVisibleEntity.getWidgetValues());
  WidgetLayoutEntity candidateLayoutEntity=null;
  for (  WidgetLayoutEntity entity : layoutEntities) {
    if (entity.getLayoutName().equals("default_hbase_layout")) {
      candidateLayoutEntity=entity;
    }
  }
  Assert.assertNotNull(candidateLayoutEntity);
  List<WidgetLayoutUserWidgetEntity> layoutUserWidgetEntities=candidateLayoutEntity.getListWidgetLayoutUserWidgetEntity();
  Assert.assertNotNull(layoutUserWidgetEntities);
  Assert.assertEquals(4,layoutUserWidgetEntities.size());
  Assert.assertEquals("RS_READS_WRITES",layoutUserWidgetEntities.get(0).getWidget().getWidgetName());
  Assert.assertEquals("OPEN_CONNECTIONS",layoutUserWidgetEntities.get(1).getWidget().getWidgetName());
  Assert.assertEquals("FILES_LOCAL",layoutUserWidgetEntities.get(2).getWidget().getWidgetName());
  Assert.assertEquals("UPDATED_BLOCKED_TIME",layoutUserWidgetEntities.get(3).getWidget().getWidgetName());
  Assert.assertEquals("HBASE_SUMMARY",layoutUserWidgetEntities.get(0).getWidget().getDefaultSectionName());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsAttributeMapsEqual(){
  AmbariManagementControllerImpl controllerImpl=null;
  if (controller instanceof AmbariManagementControllerImpl) {
    controllerImpl=(AmbariManagementControllerImpl)controller;
  }
  Map<String,Map<String,String>> requestConfigAttributes=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> clusterConfigAttributes=new HashMap<String,Map<String,String>>();
  Assert.assertTrue(controllerImpl.isAttributeMapsEqual(requestConfigAttributes,clusterConfigAttributes));
  requestConfigAttributes.put("final",new HashMap<String,String>());
  requestConfigAttributes.get("final").put("c","true");
  clusterConfigAttributes.put("final",new HashMap<String,String>());
  clusterConfigAttributes.get("final").put("c","true");
  Assert.assertTrue(controllerImpl.isAttributeMapsEqual(requestConfigAttributes,clusterConfigAttributes));
  clusterConfigAttributes.put("final2",new HashMap<String,String>());
  clusterConfigAttributes.get("final2").put("a","true");
  Assert.assertFalse(controllerImpl.isAttributeMapsEqual(requestConfigAttributes,clusterConfigAttributes));
  requestConfigAttributes.put("final2",new HashMap<String,String>());
  requestConfigAttributes.get("final2").put("a","false");
  Assert.assertFalse(controllerImpl.isAttributeMapsEqual(requestConfigAttributes,clusterConfigAttributes));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AuthToLocalBuilderTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAdditionalRealms(){
  AuthToLocalBuilder builder=new AuthToLocalBuilder(false,"REALM2,REALM3, REALM1  ");
  builder.addRules("RULE:[1:$1@$0](.*@FOOBAR.COM)s/@.*//\n" + "DEFAULT");
  builder.addRule("nn/_HOST@EXAMPLE.COM","hdfs");
  builder.addRule("dn/_HOST@EXAMPLE.COM","hdfs");
  builder.addRule("jn/_HOST@EXAMPLE.COM","hdfs");
  builder.addRule("rm/_HOST@EXAMPLE.COM","yarn");
  builder.addRule("jhs/_HOST@EXAMPLE.COM","mapred");
  builder.addRule("hm/_HOST@EXAMPLE.COM","hbase");
  builder.addRule("rs/_HOST@EXAMPLE.COM","hbase");
  List<String> rules=Arrays.asList(new String[]{"RULE:[1:$1@$0](.*@FOOBAR.COM)s/@.*//","RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//","RULE:[1:$1@$0](.*@REALM2)s/@.*//","RULE:[1:$1@$0](.*@REALM1)s/@.*//","RULE:[1:$1@$0](.*@REALM3)s/@.*//","RULE:[2:$1@$0](dn@EXAMPLE.COM)s/.*/hdfs/","RULE:[2:$1@$0](hm@EXAMPLE.COM)s/.*/hbase/","RULE:[2:$1@$0](jhs@EXAMPLE.COM)s/.*/mapred/","RULE:[2:$1@$0](jn@EXAMPLE.COM)s/.*/hdfs/","RULE:[2:$1@$0](nn@EXAMPLE.COM)s/.*/hdfs/","RULE:[2:$1@$0](rm@EXAMPLE.COM)s/.*/yarn/","RULE:[2:$1@$0](rs@EXAMPLE.COM)s/.*/hbase/","DEFAULT"});
  assertTrue(CollectionPresentationUtils.isStringPermutationOfCollection(builder.generate("EXAMPLE.COM"),rules,"\n",0,0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.KerberosHelperTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureHeadlessIdentities() throws Exception {
  Map<String,String> propertiesKrb5Conf=new HashMap<String,String>();
  Map<String,String> propertiesKerberosEnv=new HashMap<String,String>();
  propertiesKerberosEnv.put("realm","EXAMPLE.COM");
  propertiesKerberosEnv.put("kdc_type","mit-kdc");
  propertiesKerberosEnv.put("password_length","20");
  propertiesKerberosEnv.put("password_min_lowercase_letters","1");
  propertiesKerberosEnv.put("password_min_uppercase_letters","1");
  propertiesKerberosEnv.put("password_min_digits","1");
  propertiesKerberosEnv.put("password_min_punctuation","0");
  propertiesKerberosEnv.put("password_min_whitespace","0");
  Config configKrb5Conf=createMock(Config.class);
  expect(configKrb5Conf.getProperties()).andReturn(propertiesKrb5Conf).times(1);
  Config configKerberosEnv=createMock(Config.class);
  expect(configKerberosEnv.getProperties()).andReturn(propertiesKerberosEnv).times(1);
  Host host1=createMockHost("host1");
  Host host2=createMockHost("host3");
  Host host3=createMockHost("host2");
  Map<String,ServiceComponentHost> service1Component1HostMap=new HashMap<String,ServiceComponentHost>();
  service1Component1HostMap.put("host1",createMockServiceComponentHost());
  Map<String,ServiceComponentHost> service2Component1HostMap=new HashMap<String,ServiceComponentHost>();
  service2Component1HostMap.put("host2",createMockServiceComponentHost());
  Map<String,ServiceComponent> service1ComponentMap=new HashMap<String,ServiceComponent>();
  service1ComponentMap.put("COMPONENT11",createMockComponent("COMPONENT11",true,service1Component1HostMap));
  Map<String,ServiceComponent> service2ComponentMap=new HashMap<String,ServiceComponent>();
  service2ComponentMap.put("COMPONENT21",createMockComponent("COMPONENT21",true,service2Component1HostMap));
  Service service1=createMockService("SERVICE1",service1ComponentMap);
  Service service2=createMockService("SERVICE2",service2ComponentMap);
  Map<String,Service> servicesMap=new HashMap<String,Service>();
  servicesMap.put("SERVICE1",service1);
  servicesMap.put("SERVICE2",service2);
  Cluster cluster=createMock(Cluster.class);
  expect(cluster.getDesiredConfigByType("krb5-conf")).andReturn(configKrb5Conf).times(1);
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(configKerberosEnv).times(1);
  expect(cluster.getSecurityType()).andReturn(SecurityType.KERBEROS).times(1);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.2")).times(1);
  expect(cluster.getClusterName()).andReturn("c1").times(4);
  expect(cluster.getHosts()).andReturn(Arrays.asList(host1,host2,host3)).times(1);
  expect(cluster.getServices()).andReturn(servicesMap).times(1);
  Map<String,String> kerberosDescriptorProperties=new HashMap<String,String>();
  kerberosDescriptorProperties.put("additional_realms","");
  kerberosDescriptorProperties.put("keytab_dir","/etc/security/keytabs");
  kerberosDescriptorProperties.put("realm","${kerberos-env/realm}");
  ArrayList<KerberosIdentityDescriptor> service1Component1Identities=new ArrayList<KerberosIdentityDescriptor>();
  service1Component1Identities.add(createMockIdentityDescriptor("s1c1_1.user",createMockPrincipalDescriptor("s1c1_1@${realm}",KerberosPrincipalType.USER,"s1c1",null),createMockKeytabDescriptor("s1c1_1.user.keytab",null)));
  service1Component1Identities.add(createMockIdentityDescriptor("s1c1_1.service",createMockPrincipalDescriptor("s1c1_1/_HOST@${realm}",KerberosPrincipalType.SERVICE,"s1c1",null),createMockKeytabDescriptor("s1c1_1.service.keytab",null)));
  HashMap<String,KerberosComponentDescriptor> service1ComponentDescriptorMap=new HashMap<String,KerberosComponentDescriptor>();
  service1ComponentDescriptorMap.put("COMPONENT11",createMockComponentDescriptor("COMPONENT11",service1Component1Identities,null));
  List<KerberosIdentityDescriptor> service1Identities=new ArrayList<KerberosIdentityDescriptor>();
  service1Identities.add(createMockIdentityDescriptor("s1_1.user",createMockPrincipalDescriptor("s1_1@${realm}",KerberosPrincipalType.USER,"s1",null),createMockKeytabDescriptor("s1_1.user.keytab",null)));
  service1Identities.add(createMockIdentityDescriptor("s1_1.service",createMockPrincipalDescriptor("s1/_HOST@${realm}",KerberosPrincipalType.SERVICE,"s1",null),createMockKeytabDescriptor("s1.service.keytab",null)));
  KerberosServiceDescriptor service1KerberosDescriptor=createMockServiceDescriptor("SERVICE1",service1ComponentDescriptorMap,service1Identities);
  ArrayList<KerberosIdentityDescriptor> service2Component1Identities=new ArrayList<KerberosIdentityDescriptor>();
  service2Component1Identities.add(createMockIdentityDescriptor("s2_1.user",createMockPrincipalDescriptor("s2_1@${realm}",KerberosPrincipalType.USER,"s2",null),createMockKeytabDescriptor("s2_1.user.keytab",null)));
  service2Component1Identities.add(createMockIdentityDescriptor("s2c1_1.service",createMockPrincipalDescriptor("s2c1_1/_HOST@${realm}",KerberosPrincipalType.SERVICE,"s2c1",null),createMockKeytabDescriptor("s2c1_1.service.keytab",null)));
  HashMap<String,KerberosComponentDescriptor> service2ComponentDescriptorMap=new HashMap<String,KerberosComponentDescriptor>();
  service2ComponentDescriptorMap.put("COMPONENT21",createMockComponentDescriptor("COMPONENT21",service2Component1Identities,null));
  KerberosServiceDescriptor service2KerberosDescriptor=createMockServiceDescriptor("SERVICE2",service2ComponentDescriptorMap,null);
  KerberosDescriptor kerberosDescriptor=createMock(KerberosDescriptor.class);
  expect(kerberosDescriptor.getProperties()).andReturn(kerberosDescriptorProperties);
  expect(kerberosDescriptor.getService("SERVICE1")).andReturn(service1KerberosDescriptor).times(1);
  expect(kerberosDescriptor.getService("SERVICE2")).andReturn(service2KerberosDescriptor).times(1);
  setupGetDescriptorFromStack(kerberosDescriptor);
  Map<String,Map<String,String>> existingConfigurations=new HashMap<String,Map<String,String>>();
  existingConfigurations.put("kerberos-env",propertiesKerberosEnv);
  Set<String> services=new HashSet<String>(){
{
      add("SERVICE1");
      add("SERVICE2");
    }
  }
;
  Capture<? extends String> capturePrincipal=newCapture(CaptureType.ALL);
  Capture<? extends String> capturePrincipalForKeytab=newCapture(CaptureType.ALL);
  CreatePrincipalsServerAction createPrincipalsServerAction=injector.getInstance(CreatePrincipalsServerAction.class);
  expect(createPrincipalsServerAction.createPrincipal(capture(capturePrincipal),eq(false),anyObject(Map.class),anyObject(KerberosOperationHandler.class),isNull(ActionLog.class))).andReturn(new CreatePrincipalsServerAction.CreatePrincipalResult("anything","password",1)).times(3);
  CreateKeytabFilesServerAction createKeytabFilesServerAction=injector.getInstance(CreateKeytabFilesServerAction.class);
  expect(createKeytabFilesServerAction.createKeytab(capture(capturePrincipalForKeytab),eq("password"),eq(1),anyObject(KerberosOperationHandler.class),eq(true),eq(true),isNull(ActionLog.class))).andReturn(new Keytab()).times(3);
  replayAll();
  AmbariMetaInfo ambariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ambariMetaInfo.init();
  CredentialStoreService credentialStoreService=injector.getInstance(CredentialStoreService.class);
  credentialStoreService.setCredential(cluster.getClusterName(),KerberosHelper.KDC_ADMINISTRATOR_CREDENTIAL_ALIAS,new PrincipalKeyCredential("principal","password"),CredentialStoreType.TEMPORARY);
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  kerberosHelper.ensureHeadlessIdentities(cluster,existingConfigurations,services);
  verifyAll();
  List<? extends String> capturedPrincipals=capturePrincipal.getValues();
  assertEquals(3,capturedPrincipals.size());
  assertTrue(capturedPrincipals.contains("s1_1@EXAMPLE.COM"));
  assertTrue(capturedPrincipals.contains("s1c1_1@EXAMPLE.COM"));
  assertTrue(capturedPrincipals.contains("s2_1@EXAMPLE.COM"));
  List<? extends String> capturedPrincipalsForKeytab=capturePrincipalForKeytab.getValues();
  assertEquals(3,capturedPrincipalsForKeytab.size());
  assertTrue(capturedPrincipalsForKeytab.contains("s1_1@EXAMPLE.COM"));
  assertTrue(capturedPrincipalsForKeytab.contains("s1c1_1@EXAMPLE.COM"));
  assertTrue(capturedPrincipalsForKeytab.contains("s2_1@EXAMPLE.COM"));
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testEnableKerberosMissingCredentials() throws Exception {
  try {
    testEnableKerberos(null,"mit-kdc","true",true,false);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Missing KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testEnableKerberosInvalidCredentials() throws Exception {
  try {
    testEnableKerberos(new PrincipalKeyCredential("invalid_principal","password"),"mit-kdc","true",true,false);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Invalid KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterKerberosEnabled_false() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  Cluster cluster=createStrictMock(Cluster.class);
  expect(cluster.getSecurityType()).andReturn(SecurityType.NONE);
  replay(cluster);
  assertFalse(kerberosHelper.isClusterKerberosEnabled(cluster));
  verify(cluster);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterKerberosEnabled_true() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  Cluster cluster=createStrictMock(Cluster.class);
  expect(cluster.getSecurityType()).andReturn(SecurityType.KERBEROS);
  replay(cluster);
  assertTrue(kerberosHelper.isClusterKerberosEnabled(cluster));
  verify(cluster);
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testEnsureIdentitiesMissingCredentials() throws Exception {
  try {
    testEnsureIdentities(null,null);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Missing KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testDeleteIdentitiesMissingCredentials() throws Exception {
  try {
    testDeleteIdentities(null);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Missing KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testDeleteIdentitiesInvalidCredentials() throws Exception {
  try {
    testDeleteIdentities(new PrincipalKeyCredential("invalid_principal","password"));
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Invalid KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KerberosMissingAdminCredentialsException.class) public void testEnsureIdentitiesInvalidCredentials() throws Exception {
  try {
    testEnsureIdentities(new PrincipalKeyCredential("invalid_principal","password"),null);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(e.getMessage().startsWith("Invalid KDC administrator credentials"));
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.LdapSyncRequestTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPrincipalNames() throws Exception {
  Set<String> names=new HashSet<String>();
  names.add("name1");
  LdapSyncRequest request=new LdapSyncRequest(LdapSyncSpecEntity.SyncType.SPECIFIC,names);
  names=new HashSet<String>();
  names.add("name2");
  names.add("name3");
  request.addPrincipalNames(names);
  Set<String> principalNames=request.getPrincipalNames();
  Assert.assertEquals(3,principalNames.size());
  Assert.assertTrue(principalNames.contains("name1"));
  Assert.assertTrue(principalNames.contains("name2"));
  Assert.assertTrue(principalNames.contains("name3"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrincipalNames() throws Exception {
  Set<String> names=new HashSet<String>();
  names.add("name1");
  names.add("name2");
  names.add("name3");
  LdapSyncRequest request=new LdapSyncRequest(LdapSyncSpecEntity.SyncType.SPECIFIC,names);
  Set<String> principalNames=request.getPrincipalNames();
  Assert.assertEquals(3,principalNames.size());
  Assert.assertTrue(principalNames.contains("name1"));
  Assert.assertTrue(principalNames.contains("name2"));
  Assert.assertTrue(principalNames.contains("name3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.MaintenanceStateHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCutOffHosts() throws AmbariException {
  MaintenanceStateHelper.HostPredicate predicate=createMock(MaintenanceStateHelper.HostPredicate.class);
  expect(predicate.shouldHostBeRemoved(eq("host1"))).andReturn(true);
  expect(predicate.shouldHostBeRemoved(eq("host2"))).andReturn(false);
  expect(predicate.shouldHostBeRemoved(eq("host3"))).andReturn(true);
  expect(predicate.shouldHostBeRemoved(eq("host4"))).andReturn(false);
  Set<String> candidates=new HashSet<String>();
  candidates.add("host1");
  candidates.add("host2");
  candidates.add("host3");
  candidates.add("host4");
  Injector injector=createStrictMock(Injector.class);
  MaintenanceStateHelper maintenanceStateHelper=createMockBuilder(MaintenanceStateHelper.class).withConstructor(injector).createNiceMock();
  replay(predicate,maintenanceStateHelper);
  Set<String> ignored=maintenanceStateHelper.filterHostsInMaintenanceState(candidates,predicate);
  verify(predicate,maintenanceStateHelper);
  Assert.assertEquals(candidates.size(),2);
  Assert.assertTrue(candidates.contains("host2"));
  Assert.assertTrue(candidates.contains("host4"));
  Assert.assertEquals(ignored.size(),2);
  Assert.assertTrue(ignored.contains("host1"));
  Assert.assertTrue(ignored.contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.RefreshYarnCapacitySchedulerReleaseConfigTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponent() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest("HDP","2.0.6","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigInComponentOverwrited() throws Exception {
  StackServiceRequest requestWithParams=new StackServiceRequest("HDP","2.0.7","YARN");
  Set<StackServiceResponse> responsesWithParams=controller.getStackServices(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackServiceResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getServiceName(),"YARN");
    Assert.assertTrue(responseWithParams.getConfigTypes().containsKey("capacity-scheduler"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.RootServiceResponseFactoryTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRootServices() throws Exception {
  RootServiceRequest request=new RootServiceRequest(null);
  Set<RootServiceResponse> rootServices=responseFactory.getRootServices(request);
  assertEquals(RootServiceResponseFactory.Services.values().length,rootServices.size());
  request=null;
  rootServices=responseFactory.getRootServices(request);
  assertEquals(RootServiceResponseFactory.Services.values().length,rootServices.size());
  try {
    request=new RootServiceRequest("XXX");
    rootServices=responseFactory.getRootServices(request);
  }
 catch (  Exception e) {
    assertTrue(e instanceof ObjectNotFoundException);
  }
  request=new RootServiceRequest(RootServiceResponseFactory.Services.AMBARI.name());
  rootServices=responseFactory.getRootServices(request);
  assertEquals(1,rootServices.size());
  assertTrue(rootServices.contains(new RootServiceResponse(RootServiceResponseFactory.Services.AMBARI.name())));
}

</code></pre>

<br>
<pre class="type-12 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRootServiceComponents() throws Exception {
  RootServiceComponentRequest request=new RootServiceComponentRequest(null,null);
  Set<RootServiceComponentResponse> rootServiceComponents;
  try {
    rootServiceComponents=responseFactory.getRootServiceComponents(request);
  }
 catch (  Exception e) {
    assertTrue(e instanceof ObjectNotFoundException);
  }
  RootServiceResponseFactory.Components ambariServerComponent=RootServiceResponseFactory.Components.AMBARI_SERVER;
  request=new RootServiceComponentRequest(null,ambariServerComponent.name());
  try {
    rootServiceComponents=responseFactory.getRootServiceComponents(request);
  }
 catch (  Exception e) {
    assertTrue(e instanceof ObjectNotFoundException);
  }
  request=new RootServiceComponentRequest(RootServiceResponseFactory.Services.AMBARI.name(),null);
  rootServiceComponents=responseFactory.getRootServiceComponents(request);
  assertEquals(RootServiceResponseFactory.Services.AMBARI.getComponents().length,rootServiceComponents.size());
  String ambariVersion=ambariMetaInfo.getServerVersion();
  for (int i=0; i < RootServiceResponseFactory.Services.AMBARI.getComponents().length; i++) {
    Components component=RootServiceResponseFactory.Services.AMBARI.getComponents()[i];
    if (component.name().equals(ambariServerComponent.name())) {
      for (      RootServiceComponentResponse response : rootServiceComponents) {
        if (response.getComponentName().equals(ambariServerComponent.name())) {
          assertEquals(ambariVersion,response.getComponentVersion());
          assertEquals(1,response.getProperties().size(),1);
          assertTrue(response.getProperties().containsKey("jdk_location"));
        }
      }
    }
 else {
      assertTrue(rootServiceComponents.contains(new RootServiceComponentResponse(component.name(),RootServiceResponseFactory.NOT_APPLICABLE,Collections.<String,String>emptyMap())));
    }
  }
  request=new RootServiceComponentRequest(RootServiceResponseFactory.Services.AMBARI.name(),RootServiceResponseFactory.Services.AMBARI.getComponents()[0].name());
  rootServiceComponents=responseFactory.getRootServiceComponents(request);
  assertEquals(1,rootServiceComponents.size());
  for (  RootServiceComponentResponse response : rootServiceComponents) {
    if (response.getComponentName().equals(RootServiceResponseFactory.Services.AMBARI.getComponents()[0].name())) {
      assertEquals(ambariVersion,response.getComponentVersion());
      assertEquals(2,response.getProperties().size());
      assertTrue(response.getProperties().containsKey("jdk_location"));
      assertTrue(response.getProperties().containsKey("java.version"));
    }
  }
  request=new RootServiceComponentRequest(RootServiceResponseFactory.Services.AMBARI.name(),"XXX");
  try {
    rootServiceComponents=responseFactory.getRootServiceComponents(request);
  }
 catch (  Exception e) {
    assertTrue(e instanceof ObjectNotFoundException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.StackServiceResponseTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultServiceVisibilityProperties(){
  StackServiceResponse stackServiceResponse=new StackServiceResponse(serviceInfo);
  assertTrue("true".equals(stackServiceResponse.getServiceProperties().get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("true".equals(stackServiceResponse.getServiceProperties().get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(stackServiceResponse.getServiceProperties().get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerClusterProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerClusterProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("ambari").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  Resource next=resources.iterator().next();
  Assert.assertEquals("ambari",next.getPropertyValue(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID));
  Assert.assertEquals("HDP-1.2.0",next.getPropertyValue(GSInstallerClusterProvider.CLUSTER_VERSION_PROPERTY_ID));
  predicate=new PredicateBuilder().property(GSInstallerClusterProvider.CLUSTER_NAME_PROPERTY_ID).equals("non-existent Cluster").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerComponentProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerComponentProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("TASKTRACKER").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("TASKTRACKER").or().property(GSInstallerComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("GANGLIA_MONITOR").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerComponentProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID).equals("BadComponent").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerHostComponentProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostComponentProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerHostComponentProvider.HOST_COMPONENT_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(5,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerHostComponentProvider.HOST_COMPONENT_HOST_NAME_PROPERTY_ID).equals("UnknownHost").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerHostProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerHostProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("ip-10-190-97-104.ec2.internal").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("ip-10-190-97-104.ec2.internal").or().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("ip-10-8-113-183.ec2.internal").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerHostProvider.HOST_NAME_PROPERTY_ID).equals("unknownHost").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerNoOpProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCheckPropertyIds() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerNoOpProvider provider=new GSInstallerNoOpProvider(Resource.Type.Workflow,clusterDefinition);
  Assert.assertTrue(provider.checkPropertyIds(Collections.singleton("id")).isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerServiceProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerResourceProvider provider=new GSInstallerServiceProvider(clusterDefinition);
  Predicate predicate=new PredicateBuilder().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("MAPREDUCE").toPredicate();
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(1,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("HDFS").or().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("GANGLIA").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property(GSInstallerServiceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals("NO SERVICE").toPredicate();
  resources=provider.getResources(PropertyHelper.getReadRequest(),predicate);
  Assert.assertTrue(resources.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractControllerResourceProviderTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourceProvider() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ResourceProviderFactory factory=createMock(ResourceProviderFactory.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  ResourceProvider serviceResourceProvider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  expect(factory.getServiceResourceProvider(propertyIds,keyPropertyIds,managementController)).andReturn(serviceResourceProvider);
  AbstractControllerResourceProvider.init(factory);
  replay(managementController,factory,maintenanceStateHelper);
  AbstractResourceProvider provider=(AbstractResourceProvider)AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Service,propertyIds,keyPropertyIds,managementController);
  Assert.assertTrue(provider instanceof ServiceResourceProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractDRResourceProviderTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourceProvider() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  IvoryService ivoryService=createMock(IvoryService.class);
  AbstractResourceProvider provider=(AbstractResourceProvider)AbstractDRResourceProvider.getResourceProvider(Resource.Type.DRFeed,propertyIds,keyPropertyIds,ivoryService);
  Assert.assertTrue(provider instanceof FeedResourceProvider);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractPropertyProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyInfoMap(){
  AbstractPropertyProvider provider=new TestPropertyProvider(PropertyHelper.getMetricPropertyIds(Resource.Type.HostComponent));
  Map<String,PropertyInfo> propertyInfoMap=provider.getPropertyInfoMap("NAMENODE","metrics/cpu/cpu_aidle");
  Assert.assertEquals(1,propertyInfoMap.size());
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/cpu/cpu_aidle"));
  propertyInfoMap=provider.getPropertyInfoMap("NAMENODE","metrics/disk");
  Assert.assertEquals(3,propertyInfoMap.size());
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/disk/disk_free"));
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/disk/disk_total"));
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/disk/part_max_used"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJMXPropertyInfoMap(){
  AbstractPropertyProvider provider=new TestPropertyProvider(PropertyHelper.getJMXPropertyIds(Resource.Type.HostComponent));
  Map<String,PropertyInfo> propertyInfoMap=provider.getPropertyInfoMap("DATANODE","metrics");
  Assert.assertEquals(86,propertyInfoMap.size());
  propertyInfoMap=provider.getPropertyInfoMap("DATANODE","metrics/rpc/RpcQueueTime_avg_time");
  Assert.assertEquals(1,propertyInfoMap.size());
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/rpc/RpcQueueTime_avg_time"));
  propertyInfoMap=provider.getPropertyInfoMap("DATANODE","metrics/rpc/");
  Assert.assertEquals(12,propertyInfoMap.size());
  Assert.assertTrue(propertyInfoMap.containsKey("metrics/rpc/RpcQueueTime_avg_time"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetQueryParameterValue(){
  String queryParameterId1="qp/variable1";
  String queryParameterValue1="value1";
  String queryParameterId2="qp/variable2";
  String queryParameterValue2="value2";
  Predicate predicate=new PredicateBuilder().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  String queryParameterId3="qp/variable3";
  String queryParameterValue3="value3";
  predicate=new PredicateBuilder().property(queryParameterId3).equals(queryParameterValue3).and().begin().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).end().toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  Assert.assertEquals(queryParameterValue3,AbstractResourceProvider.getQueryParameterValue(queryParameterId3,predicate));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyMaps() throws Exception {
  AbstractResourceProvider provider=new TestResourceProvider();
  Map<String,Object> updatePropertyMap=new HashMap<String,Object>();
  updatePropertyMap.put("SomeProperty","SomeUpdateValue");
  updatePropertyMap.put("SomeOtherProperty",99);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.property("ClusterName").equals("c1").and().property("ResourceName").equals("r1").toPredicate();
  Set<Map<String,Object>> propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(1,propertyMaps.size());
  Map<String,Object> map=propertyMaps.iterator().next();
  Assert.assertEquals(4,map.size());
  Assert.assertEquals("c1",map.get("ClusterName"));
  Assert.assertEquals("r1",map.get("ResourceName"));
  Assert.assertEquals("SomeUpdateValue",map.get("SomeProperty"));
  Assert.assertEquals(99,map.get("SomeOtherProperty"));
  pb=new PredicateBuilder();
  predicate=pb.property("ClusterName").equals("c1").and().begin().property("ResourceName").equals("r1").or().property("ResourceName").equals("r2").end().toPredicate();
  propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(2,propertyMaps.size());
  for (  Map<String,Object> map2 : propertyMaps) {
    Assert.assertEquals(4,map2.size());
    Assert.assertEquals("c1",map2.get("ClusterName"));
    Object resourceName=map2.get("ResourceName");
    Assert.assertTrue(resourceName.equals("r1") || resourceName.equals("r2"));
    Assert.assertEquals("SomeUpdateValue",map2.get("SomeProperty"));
    Assert.assertEquals(99,map2.get("SomeOtherProperty"));
  }
  predicate=new AlwaysPredicate();
  propertyMaps=provider.getPropertyMaps(updatePropertyMap,predicate);
  Assert.assertEquals(4,propertyMaps.size());
  for (  Map<String,Object> map2 : propertyMaps) {
    Assert.assertEquals(4,map2.size());
    Assert.assertEquals("c1",map2.get("ClusterName"));
    Object resourceName=map2.get("ResourceName");
    Assert.assertTrue(resourceName.equals("r1") || resourceName.equals("r2") || resourceName.equals("r3")|| resourceName.equals("r4"));
    Assert.assertEquals("SomeUpdateValue",map2.get("SomeProperty"));
    Assert.assertEquals(99,map2.get("SomeOtherProperty"));
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetPropertyIds(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("p1");
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  replay(maintenanceStateHelper);
  AbstractResourceProvider provider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  Set<String> supportedPropertyIds=provider.getPropertyIds();
  Assert.assertTrue(supportedPropertyIds.containsAll(propertyIds));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckPropertyIds(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  replay(maintenanceStateHelper);
  AbstractResourceProvider provider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  Set<String> unsupported=provider.checkPropertyIds(Collections.singleton("foo"));
  Assert.assertTrue(unsupported.isEmpty());
  Assert.assertTrue(provider.checkPropertyIds(Collections.singleton("cat5/subcat5/map/key")).isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("bar"));
  Assert.assertEquals(1,unsupported.size());
  Assert.assertTrue(unsupported.contains("bar"));
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1/foo"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1"));
  Assert.assertTrue(unsupported.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ActionResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Action;
  AmbariMetaInfo am=createNiceMock(AmbariMetaInfo.class);
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(am).anyTimes();
  List<ActionDefinition> allDefinition=new ArrayList<ActionDefinition>();
  allDefinition.add(new ActionDefinition("a1",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  allDefinition.add(new ActionDefinition("a2",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  allDefinition.add(new ActionDefinition("a3",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100")));
  Set<ActionResponse> allResponse=new HashSet<ActionResponse>();
  for (  ActionDefinition definition : allDefinition) {
    allResponse.add(definition.convertToResponse());
  }
  ActionDefinition namedDefinition=new ActionDefinition("a1",ActionType.SYSTEM,"fileName","HDFS","DATANODE","Does file exist",TargetHostType.ANY,Short.valueOf("100"));
  Set<ActionResponse> nameResponse=new HashSet<ActionResponse>();
  nameResponse.add(namedDefinition.convertToResponse());
  expect(am.getAllActionDefinition()).andReturn(allDefinition).once();
  expect(am.getActionDefinition("a1")).andReturn(namedDefinition).once();
  replay(managementController,am);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ActionResourceProvider.ACTION_NAME_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.ACTION_TYPE_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.DEFAULT_TIMEOUT_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.DESCRIPTION_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.INPUTS_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_COMPONENT_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_HOST_PROPERTY_ID);
  propertyIds.add(ActionResourceProvider.TARGET_SERVICE_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String actionName=(String)resource.getPropertyValue(ActionResourceProvider.ACTION_NAME_PROPERTY_ID);
    String actionType=(String)resource.getPropertyValue(ActionResourceProvider.ACTION_TYPE_PROPERTY_ID);
    String defaultTimeout=(String)resource.getPropertyValue(ActionResourceProvider.DEFAULT_TIMEOUT_PROPERTY_ID);
    String description=(String)resource.getPropertyValue(ActionResourceProvider.DESCRIPTION_PROPERTY_ID);
    String inputs=(String)resource.getPropertyValue(ActionResourceProvider.INPUTS_PROPERTY_ID);
    String comp=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_COMPONENT_PROPERTY_ID);
    String svc=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_SERVICE_PROPERTY_ID);
    String host=(String)resource.getPropertyValue(ActionResourceProvider.TARGET_HOST_PROPERTY_ID);
    Assert.assertTrue(allResponse.contains(new ActionResponse(actionName,actionType,inputs,svc,comp,description,host,defaultTimeout)));
  }
  Predicate predicate=new PredicateBuilder().property(ActionResourceProvider.ACTION_NAME_PROPERTY_ID).equals("a1").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("a1",resources.iterator().next().getPropertyValue(ActionResourceProvider.ACTION_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertDefinitionResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResourcesWithNumbersAsStrings() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<AlertDefinitionEntity> entityCapture=new Capture<AlertDefinitionEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  expect(definitionHash.invalidateHosts(EasyMock.anyObject(AlertDefinitionEntity.class))).andReturn(new HashSet<String>()).atLeastOnce();
  replay(amc,clusters,cluster,dao,definitionHash);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  MetricSource source=(MetricSource)getMockSource();
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_CLUSTER_NAME,"c1");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_INTERVAL,"1");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_NAME,"my_def");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_SERVICE_NAME,"HDFS");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_SOURCE_TYPE,"METRIC");
  requestProps.put("AlertDefinition/source/reporting/critical/text",source.getReporting().getCritical().getText());
  requestProps.put("AlertDefinition/source/reporting/critical/value","1234.5");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  AlertDefinitionResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  AlertDefinitionEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  String sourceJson=entity.getSource();
  Gson gson=new Gson();
  source=gson.fromJson(sourceJson,MetricSource.class);
  assertEquals(new Double(1234.5d),source.getReporting().getCritical().getValue());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertResourceProviderTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testResponseIsPaginated() throws Exception {
  expect(m_dao.findAll(EasyMock.anyObject(AlertCurrentRequest.class))).andReturn(getClusterMockEntities()).atLeastOnce();
  expect(m_dao.getCount(EasyMock.anyObject(Predicate.class))).andReturn(0).atLeastOnce();
  replay(m_dao);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<String> requestProperties=new HashSet<String>();
  requestProperties.add(AlertResourceProvider.ALERT_ID);
  requestProperties.add(AlertResourceProvider.ALERT_DEFINITION_NAME);
  Request request=PropertyHelper.getReadRequest(requestProperties);
  Predicate predicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_CLUSTER_NAME).equals("c1").toPredicate();
  AlertResourceProvider provider=createProvider();
  QueryResponse response=provider.queryForResources(request,predicate);
  assertFalse(response.isPagedResponse());
  PageRequest pageRequest=new PageRequestImpl(StartingPoint.Beginning,5,10,predicate,null);
  request=PropertyHelper.getReadRequest(requestProperties,null,null,pageRequest,null);
  response=provider.queryForResources(request,predicate);
  assertTrue(response.isPagedResponse());
  verify(m_dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ArtifactResourceProviderTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources_collection() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  TreeMap<String,String> foreignKeys=new TreeMap<String,String>();
  foreignKeys.put("cluster","500");
  List<ArtifactEntity> entities=new ArrayList<ArtifactEntity>();
  entities.add(entity);
  entities.add(entity2);
  Map<String,Object> artifact_data=Collections.<String,Object>singletonMap("foo","bar");
  Map<String,Object> artifact_data2=Collections.<String,Object>singletonMap("foo2","bar2");
  Map<String,String> responseForeignKeys=new HashMap<String,String>();
  responseForeignKeys.put("cluster","500");
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("test-cluster")).andReturn(cluster).anyTimes();
  expect(clusters.getClusterById(500L)).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(500L).anyTimes();
  expect(cluster.getClusterName()).andReturn("test-cluster").anyTimes();
  expect(request.getPropertyIds()).andReturn(propertyIds).anyTimes();
  expect(dao.findByForeignKeys(eq(foreignKeys))).andReturn(entities).anyTimes();
  expect(entity.getArtifactName()).andReturn("test-artifact").anyTimes();
  expect(entity.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity.getArtifactData()).andReturn(artifact_data).anyTimes();
  expect(entity2.getArtifactName()).andReturn("test-artifact2").anyTimes();
  expect(entity2.getForeignKeys()).andReturn(responseForeignKeys).anyTimes();
  expect(entity2.getArtifactData()).andReturn(artifact_data2).anyTimes();
  replay(dao,em,controller,request,clusters,cluster,entity,entity2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate=pb.begin().property("Artifacts/cluster_name").equals("test-cluster").end().toPredicate();
  Set<Resource> response=resourceProvider.getResources(request,predicate);
  assertEquals(2,response.size());
  boolean artifact1Returned=false;
  boolean artifact2Returned=false;
  for (  Resource resource : response) {
    if (resource.getPropertyValue("Artifacts/artifact_name").equals("test-artifact")) {
      artifact1Returned=true;
      assertEquals("bar",resource.getPropertyValue("artifact_data/foo"));
      assertEquals("test-cluster",resource.getPropertyValue("Artifacts/cluster_name"));
    }
 else     if (resource.getPropertyValue("Artifacts/artifact_name").equals("test-artifact2")) {
      artifact2Returned=true;
      assertEquals("bar2",resource.getPropertyValue("artifact_data/foo2"));
      assertEquals("test-cluster",resource.getPropertyValue("Artifacts/cluster_name"));
    }
 else {
      fail("unexpected artifact name");
    }
  }
  assertTrue(artifact1Returned);
  assertTrue(artifact2Returned);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BaseProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckPropertyIds(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("bar");
  propertyIds.add("cat1/prop1");
  propertyIds.add("cat2/prop2");
  propertyIds.add("cat3/subcat3/prop3");
  propertyIds.add("cat4/subcat4/map");
  BaseProvider provider=new TestProvider(propertyIds);
  assertTrue(provider.checkPropertyIds(propertyIds).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat1")).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat2")).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat3")).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat3/subcat3")).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat4/subcat4/map")).isEmpty());
  assertTrue(provider.checkPropertyIds(Collections.singleton("cat4/subcat4/map/key")).isEmpty());
  propertyIds.add("badprop");
  propertyIds.add("badcat");
  Set<String> unsupportedPropertyIds=provider.checkPropertyIds(propertyIds);
  assertFalse(unsupportedPropertyIds.isEmpty());
  assertEquals(2,unsupportedPropertyIds.size());
  assertTrue(unsupportedPropertyIds.contains("badprop"));
  assertTrue(unsupportedPropertyIds.contains("badcat"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetProperties(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("bar");
  propertyIds.add("cat1/prop1");
  propertyIds.add("cat2/prop2");
  propertyIds.add("cat3/subcat3/prop3");
  BaseProvider provider=new TestProvider(propertyIds);
  Set<String> supportedPropertyIds=provider.getPropertyIds();
  assertTrue(supportedPropertyIds.containsAll(propertyIds));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsPropertyRequested(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("p1");
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/sub5");
  assertTrue(BaseProvider.isPropertyRequested("foo",propertyIds));
  assertTrue(BaseProvider.isPropertyRequested("cat2",propertyIds));
  assertTrue(BaseProvider.isPropertyRequested("cat2/bar",propertyIds));
  assertFalse(BaseProvider.isPropertyRequested("unsupported",propertyIds));
  assertTrue(BaseProvider.isPropertyRequested("cat5/sub5/prop5",propertyIds));
  assertTrue(BaseProvider.isPropertyRequested("cat5/sub5/sub5a/prop5a",propertyIds));
  assertFalse(BaseProvider.isPropertyRequested("cat5/sub7/unsupported",propertyIds));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestPropertyIds(){
  Set<String> providerPropertyIds=new HashSet<String>();
  providerPropertyIds.add("foo");
  providerPropertyIds.add("bar");
  providerPropertyIds.add("cat1/sub1");
  BaseProvider provider=new TestProvider(providerPropertyIds);
  Request request=PropertyHelper.getReadRequest("foo");
  Set<String> requestedPropertyIds=provider.getRequestPropertyIds(request,null);
  assertEquals(1,requestedPropertyIds.size());
  assertTrue(requestedPropertyIds.contains("foo"));
  request=PropertyHelper.getReadRequest("foo","bar");
  requestedPropertyIds=provider.getRequestPropertyIds(request,null);
  assertEquals(2,requestedPropertyIds.size());
  assertTrue(requestedPropertyIds.contains("foo"));
  assertTrue(requestedPropertyIds.contains("bar"));
  request=PropertyHelper.getReadRequest("foo","baz","bar","cat","cat1/prop1");
  requestedPropertyIds=provider.getRequestPropertyIds(request,null);
  assertEquals(2,requestedPropertyIds.size());
  assertTrue(requestedPropertyIds.contains("foo"));
  assertTrue(requestedPropertyIds.contains("bar"));
  request=PropertyHelper.getReadRequest("foo","cat1/sub1/prop1");
  requestedPropertyIds=provider.getRequestPropertyIds(request,null);
  assertEquals(2,requestedPropertyIds.size());
  assertTrue(requestedPropertyIds.contains("foo"));
  assertTrue(requestedPropertyIds.contains("cat1/sub1/prop1"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegexpMethods(){
  Set<String> propertyIds=new HashSet<String>();
  String regexp="cat/$1.replaceAll(\\\"([.])\\\",\\\"/\\\")/key";
  String propertyId="cat/sub/key";
  String regexp2="cat/$1.replaceAll(\\\"([.])\\\",\\\"/\\\")/something/$2/key";
  String propertyId2="cat/sub/something/sub2/key";
  String incorrectPropertyId="some/property/id";
  propertyIds.add(regexp);
  propertyIds.add(regexp2);
  BaseProvider provider=new TestProvider(propertyIds);
  Map.Entry<String,Pattern> regexEntry=provider.getRegexEntry(propertyId);
  assertEquals(regexp,regexEntry.getKey());
  assertNull(provider.getRegexEntry(incorrectPropertyId));
  assertEquals("sub",provider.getRegexGroups(regexp,propertyId).get(0));
  assertEquals("sub2",provider.getRegexGroups(regexp2,propertyId2).get(1));
  assertTrue(provider.getRegexGroups(regexp,incorrectPropertyId).isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetResourcePropertyWithMaps(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("cat1/emptyMapProperty");
  propertyIds.add("cat1/mapProperty");
  propertyIds.add("cat2/mapMapProperty");
  propertyIds.add("cat3/mapProperty3/key2");
  propertyIds.add("cat4/mapMapProperty4/subMap1/key3");
  propertyIds.add("cat4/mapMapProperty4/subMap2");
  Resource resource=new ResourceImpl(Resource.Type.Service);
  Map<String,String> emptyMapProperty=new HashMap<String,String>();
  BaseProvider.setResourceProperty(resource,"cat1/emptyMapProperty",emptyMapProperty,propertyIds);
  assertTrue(resource.getPropertiesMap().containsKey("cat1/emptyMapProperty"));
  Map<String,String> mapProperty=new HashMap<String,String>();
  mapProperty.put("key1","value1");
  mapProperty.put("key2","value2");
  mapProperty.put("key3","value3");
  BaseProvider.setResourceProperty(resource,"cat1/mapProperty",mapProperty,propertyIds);
  assertNull(resource.getPropertyValue("cat1/mapProperty"));
  assertEquals("value1",resource.getPropertyValue("cat1/mapProperty/key1"));
  assertEquals("value2",resource.getPropertyValue("cat1/mapProperty/key2"));
  assertEquals("value3",resource.getPropertyValue("cat1/mapProperty/key3"));
  Map<String,Map<String,String>> mapMapProperty=new HashMap<String,Map<String,String>>();
  Map<String,String> mapSubProperty1=new HashMap<String,String>();
  mapSubProperty1.put("key1","value11");
  mapSubProperty1.put("key2","value12");
  mapSubProperty1.put("key3","value13");
  mapMapProperty.put("subMap1",mapSubProperty1);
  Map<String,String> mapSubProperty2=new HashMap<String,String>();
  mapSubProperty2.put("key1","value21");
  mapSubProperty2.put("key2","value22");
  mapSubProperty2.put("key3","value23");
  mapMapProperty.put("subMap2",mapSubProperty2);
  Map<String,String> mapSubProperty3=new HashMap<String,String>();
  mapMapProperty.put("subMap3",mapSubProperty3);
  BaseProvider.setResourceProperty(resource,"cat2/mapMapProperty",mapMapProperty,propertyIds);
  assertNull(resource.getPropertyValue("cat2/mapMapProperty"));
  assertNull(resource.getPropertyValue("cat2/mapMapProperty/subMap1"));
  assertNull(resource.getPropertyValue("cat2/mapMapProperty/subMap2"));
  assertTrue(resource.getPropertiesMap().containsKey("cat2/mapMapProperty/subMap3"));
  assertEquals("value11",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key1"));
  assertEquals("value12",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key2"));
  assertEquals("value13",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key3"));
  assertEquals("value21",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key1"));
  assertEquals("value22",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key2"));
  assertEquals("value23",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key3"));
  Map<String,String> mapProperty3=new HashMap<String,String>();
  mapProperty3.put("key1","value1");
  mapProperty3.put("key2","value2");
  mapProperty3.put("key3","value3");
  BaseProvider.setResourceProperty(resource,"cat3/mapProperty3",mapProperty3,propertyIds);
  assertNull(resource.getPropertyValue("cat3/mapProperty3"));
  assertNull(resource.getPropertyValue("cat3/mapProperty3/key1"));
  assertEquals("value2",resource.getPropertyValue("cat3/mapProperty3/key2"));
  assertNull(resource.getPropertyValue("cat3/mapProperty3/key3"));
  Map<String,Map<String,String>> mapMapProperty4=new HashMap<String,Map<String,String>>();
  mapMapProperty4.put("subMap1",mapSubProperty1);
  mapMapProperty4.put("subMap2",mapSubProperty2);
  BaseProvider.setResourceProperty(resource,"cat4/mapMapProperty4",mapMapProperty4,propertyIds);
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap2"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key1"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key2"));
  assertEquals("value13",resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key3"));
  assertEquals("value21",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key1"));
  assertEquals("value22",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key2"));
  assertEquals("value23",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintConfigurationProcessorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHiveConfigClusterUpdatePropertiesFilterAuthenticationOffFilterThrowsError() throws Exception {
  reset(stack);
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProperties=new HashMap<String,String>();
  properties.put("hive-site",hiveSiteProperties);
  hiveSiteProperties.put("hive.server2.authentication","NONE");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.keytab"," ");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.principal"," ");
  Map<String,Stack.ConfigProperty> mapOfMetadata=new HashMap<String,Stack.ConfigProperty>();
  Stack.ConfigProperty configProperty1=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.keytab"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  Stack.ConfigProperty configProperty2=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.principal"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  mapOfMetadata.put("hive.server2.authentication.kerberos.keytab",configProperty1);
  mapOfMetadata.put("hive.server2.authentication.kerberos.principal",configProperty2);
  expect(stack.getName()).andReturn("testStack").anyTimes();
  expect(stack.getVersion()).andReturn("1").anyTimes();
  expect(stack.isMasterComponent((String)anyObject())).andReturn(false).anyTimes();
  expect(stack.getServiceForConfigType("hive-site")).andThrow(new RuntimeException("Expected Test Error")).atLeastOnce();
  expect(stack.getConfigurationPropertiesWithMetadata("HIVE","hive-site")).andReturn(mapOfMetadata).atLeastOnce();
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  List<String> hosts=new ArrayList<String>();
  hosts.add("some-hose");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertTrue("hive.server2.authentication.kerberos.keytab should not have been filtered, due to error condition",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.keytab"));
  assertTrue("hive.server2.authentication.kerberos.principal should not have been filtered, due to error condition",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.principal"));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * There is no support currently for deploying a fully Kerberized
 * cluster with Blueprints.  This test verifies the current treatment
 * of Kerberos-related properties in a Blueprint export.
 * @throws Exception
 */
@Test public void testKerberosConfigExport() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> kerberosEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  configProperties.put("kerberos-env",kerberosEnvProperties);
  configProperties.put("core-site",coreSiteProperties);
  kerberosEnvProperties.put("admin_server_host",expectedHostName);
  kerberosEnvProperties.put("kdc_host",expectedHostName);
  coreSiteProperties.put("hadoop.proxyuser.yarn.hosts",expectedHostName);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> groupComponents=new HashSet<String>();
  groupComponents.add("TEZ_CLIENT");
  groupComponents.add("RESOURCEMANAGER");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add("serverTwo");
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,groupComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertFalse("admin_server_host should not be present in exported blueprint in kerberos-env",kerberosEnvProperties.containsKey("admin_server_host"));
  assertFalse("kdc_host should not be present in exported blueprint in kerberos-env",kerberosEnvProperties.containsKey("kdc_host"));
  assertEquals("hadoop.proxyuser.yarn.hosts was not exported correctly",createExportedHostName("host_group_1"),coreSiteProperties.get("hadoop.proxyuser.yarn.hosts"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues___YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("storm.zookeeper.servers","['localhost']");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("storm.zookeeper.servers");
  assertTrue(updatedVal.startsWith("["));
  assertTrue(updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("'testhost'");
  expectedHosts.add("'testhost2'");
  expectedHosts.add("'testhost2a'");
  expectedHosts.add("'testhost2b'");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHBaseConfigClusterUpdatePropertiesFilterAuthorizationOn() throws Exception {
  reset(stack);
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  properties.put("hbase-site",hbaseSiteProperties);
  hbaseSiteProperties.put("hbase.security.authorization","true");
  hbaseSiteProperties.put("hbase.coprocessor.regionserver.classes"," ");
  Map<String,Stack.ConfigProperty> mapOfMetadata=new HashMap<String,Stack.ConfigProperty>();
  Stack.ConfigProperty configProperty1=new Stack.ConfigProperty("hbase-site","hbase.coprocessor.regionserver.classes"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hbase-site","hbase.security.authorization");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  mapOfMetadata.put("hbase.coprocessor.regionserver.classes",configProperty1);
  expect(stack.getName()).andReturn("testStack").anyTimes();
  expect(stack.getVersion()).andReturn("1").anyTimes();
  expect(stack.isMasterComponent((String)anyObject())).andReturn(false).anyTimes();
  expect(stack.getServiceForConfigType("hbase-site")).andReturn("HBASE").atLeastOnce();
  expect(stack.getConfigurationPropertiesWithMetadata("HBASE","hbase-site")).andReturn(mapOfMetadata).atLeastOnce();
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  List<String> hosts=new ArrayList<String>();
  hosts.add("some-hose");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertTrue("hbase.coprocessor.regionserver.classes should have been included in configuration",hbaseSiteProperties.containsKey("hbase.coprocessor.regionserver.classes"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDoUpdateForBlueprintExport_SingleHostProperty__ExternalReference() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","external-host");
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertFalse(properties.get("yarn-site").containsKey("yarn.resourcemanager.hostname"));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOozieConfigExported() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="c6402.ambari.apache.org";
  final String expectedExternalHost="c6408.ambari.apache.org";
  final String expectedHostGroupName="host_group_1";
  final String expectedHostGroupNameTwo="host_group_2";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> oozieSiteProperties=new HashMap<String,String>();
  Map<String,String> oozieEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  configProperties.put("oozie-site",oozieSiteProperties);
  configProperties.put("oozie-env",oozieEnvProperties);
  configProperties.put("hive-env",oozieEnvProperties);
  configProperties.put("core-site",coreSiteProperties);
  oozieSiteProperties.put("oozie.base.url",expectedHostName);
  oozieSiteProperties.put("oozie.authentication.kerberos.principal",expectedHostName);
  oozieSiteProperties.put("oozie.service.HadoopAccessorService.kerberos.principal",expectedHostName);
  oozieSiteProperties.put("oozie.service.JPAService.jdbc.url","jdbc:mysql://" + expectedExternalHost + "/ooziedb");
  oozieEnvProperties.put("oozie_hostname",expectedHostName);
  oozieEnvProperties.put("oozie_existing_mysql_host",expectedExternalHost);
  oozieEnvProperties.put("oozie_heapsize","1024m");
  oozieEnvProperties.put("oozie_permsize","2048m");
  coreSiteProperties.put("hadoop.proxyuser.oozie.hosts",expectedHostName + "," + expectedHostNameTwo);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> groupComponents=new HashSet<String>();
  groupComponents.add("OOZIE_SERVER");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add("serverTwo");
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,groupComponents,hosts);
  Collection<String> groupComponents2=new HashSet<String>();
  groupComponents2.add("OOZIE_SERVER");
  Collection<String> hosts2=new ArrayList<String>();
  hosts2.add(expectedHostNameTwo);
  hosts2.add("serverFour");
  TestHostGroup group2=new TestHostGroup(expectedHostGroupNameTwo,groupComponents2,hosts2);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertEquals("oozie property not exported correctly",createExportedHostName(expectedHostGroupName),oozieSiteProperties.get("oozie.base.url"));
  assertEquals("oozie property not exported correctly",createExportedHostName(expectedHostGroupName),oozieSiteProperties.get("oozie.authentication.kerberos.principal"));
  assertEquals("oozie property not exported correctly",createExportedHostName(expectedHostGroupName),oozieSiteProperties.get("oozie.service.HadoopAccessorService.kerberos.principal"));
  assertEquals("oozie property not exported correctly",createExportedHostName(expectedHostGroupName),oozieEnvProperties.get("oozie_hostname"));
  assertEquals("oozie property not exported correctly",createExportedHostName(expectedHostGroupName) + "," + createExportedHostName(expectedHostGroupNameTwo),coreSiteProperties.get("hadoop.proxyuser.oozie.hosts"));
  assertFalse("oozie_existing_mysql_host should not have been present in the exported configuration",oozieEnvProperties.containsKey("oozie_existing_mysql_host"));
  assertFalse("oozie.service.JPAService.jdbc.url should not have been present in the exported configuration",oozieSiteProperties.containsKey("oozie.service.JPAService.jdbc.url"));
  assertEquals("oozie_heapsize should have been included in exported configuration","1024m",oozieEnvProperties.get("oozie_heapsize"));
  assertEquals("oozie_permsize should have been included in exported configuration","2048m",oozieEnvProperties.get("oozie_permsize"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("storm.zookeeper.servers","['%HOSTGROUP::group1%:9090','%HOSTGROUP::group2%:9091']");
  typeProps.put("nimbus.seeds","[%HOSTGROUP::group1%, %HOSTGROUP::group4%]");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  hgComponents.add("NIMBUS");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  hgComponents2.add("NIMBUS");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<String> hgComponents4=new HashSet<String>();
  hgComponents4.add("NIMBUS");
  Set<String> hosts4=new HashSet<String>();
  hosts4.add("testhost4");
  TestHostGroup group4=new TestHostGroup("group4",hgComponents4,hosts4);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  hostGroups.add(group4);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("storm.zookeeper.servers");
  assertTrue(updatedVal.startsWith("["));
  assertTrue(updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("'testhost:9090'");
  expectedHosts.add("'testhost2:9091'");
  expectedHosts.add("'testhost2a:9091'");
  expectedHosts.add("'testhost2b:9091'");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
  String updatedNimbusSeedsVal=topology.getConfiguration().getFullProperties().get("storm-site").get("nimbus.seeds");
  assertTrue("Updated YAML value should start with bracket",updatedNimbusSeedsVal.startsWith("["));
  assertTrue("Updated YAML value should end with bracket",updatedNimbusSeedsVal.endsWith("]"));
  updatedNimbusSeedsVal=updatedNimbusSeedsVal.replaceAll("[\\[\\]]","");
  String[] nimbusHosts=updatedNimbusSeedsVal.split(",");
  Collection<String> expectedNimbusHosts=new HashSet<String>();
  expectedNimbusHosts.add("testhost");
  expectedNimbusHosts.add("testhost4");
  assertEquals("Incorrect number of hosts found in updated Nimbus config property",2,nimbusHosts.length);
  for (  String host : nimbusHosts) {
    assertTrue("Expected Nimbus host = " + host + " not found in nimbus.seeds property value",expectedNimbusHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___withPorts_UsingMinusSymbolInHostGroupName() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("ha.zookeeper.quorum","%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-6%:2181,%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-5%:2181,%HOSTGROUP::os-amb-r6-secha-1427972156-hbaseha-3-7%:2181");
  properties.put("core-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-6",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-5",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("os-amb-r6-secha-1427972156-hbaseha-3-7",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("core-site").get("ha.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:2181");
  expectedHosts.add("testhost2:2181");
  expectedHosts.add("testhost2a:2181");
  expectedHosts.add("testhost2b:2181");
  expectedHosts.add("testhost3:2181");
  expectedHosts.add("testhost3a:2181");
  assertEquals(6,hosts.length);
  for (  String host : hosts) {
    assertTrue("Expected host :" + host + "was not included in the multi-server list in this property.",expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHiveConfigClusterUpdateDefaultValueWithMetaStoreHA() throws Exception {
  final String expectedHostGroupName="host_group_1";
  final String expectedHostNameOne="c6401.ambari.apache.org";
  final String expectedHostNameTwo="c6402.ambari.apache.org";
  final String expectedPropertyValue="hive.metastore.local=false,hive.metastore.uris=thrift://localhost:9933,hive.metastore.sasl.enabled=false";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> webHCatSiteProperties=new HashMap<String,String>();
  configProperties.put("webhcat-site",webHCatSiteProperties);
  webHCatSiteProperties.put("templeton.hive.properties",expectedPropertyValue);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("HIVE_METASTORE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostNameOne));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("HIVE_METASTORE");
  TestHostGroup group2=new TestHostGroup("host_group_2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertEquals("Unexpected config update for templeton.hive.properties","hive.metastore.local=false,hive.metastore.uris=",webHCatSiteProperties.get("templeton.hive.properties").substring(0,47));
  assertEquals("Unexpected config update for templeton.hive.properties",",hive.metastore.sasl.enabled=false",webHCatSiteProperties.get("templeton.hive.properties").substring(123));
  List<String> parts=Arrays.asList(new String[]{"thrift://" + expectedHostNameOne + ":9933","thrift://" + expectedHostNameTwo + ":9933"});
  assertTrue("Unexpected config update for templeton.hive.properties",CollectionPresentationUtils.isStringPermutationOfCollection(webHCatSiteProperties.get("templeton.hive.properties"),parts,"\\,",47,34));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHiveConfigClusterUpdatePropertiesFilterAuthenticationOn() throws Exception {
  reset(stack);
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProperties=new HashMap<String,String>();
  properties.put("hive-site",hiveSiteProperties);
  hiveSiteProperties.put("hive.server2.authentication","KERBEROS");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.keytab"," ");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.principal"," ");
  Map<String,Stack.ConfigProperty> mapOfMetadata=new HashMap<String,Stack.ConfigProperty>();
  Stack.ConfigProperty configProperty1=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.keytab"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  Stack.ConfigProperty configProperty2=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.principal"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  mapOfMetadata.put("hive.server2.authentication.kerberos.keytab",configProperty1);
  mapOfMetadata.put("hive.server2.authentication.kerberos.principal",configProperty2);
  expect(stack.getName()).andReturn("testStack").anyTimes();
  expect(stack.getVersion()).andReturn("1").anyTimes();
  expect(stack.isMasterComponent((String)anyObject())).andReturn(false).anyTimes();
  expect(stack.getServiceForConfigType("hive-site")).andReturn("HIVE").atLeastOnce();
  expect(stack.getConfigurationPropertiesWithMetadata("HIVE","hive-site")).andReturn(mapOfMetadata).atLeastOnce();
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  List<String> hosts=new ArrayList<String>();
  hosts.add("some-hose");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertTrue("hive.server2.authentication.kerberos.keytab should have been included in configuration",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.keytab"));
  assertTrue("hive.server2.authentication.kerberos.principal should have been included in configuration",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.principal"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyStackDefaultsOnly() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue2");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ONLY_STACK_DEFAULTS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  reset(stack);
  expect(stack.getConfiguration(bp.getServices())).andReturn(createStackDefaults()).anyTimes();
  replay(stack);
  Set<String> configTypeUpdated=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertTrue(configTypeUpdated.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_SingleHostProperty__defaultValue() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  Map<String,String> typeProps2=new HashMap<String,String>();
  typeProps.put("yarn.resourcemanager.hostname","localhost");
  typeProps2.put("oozie_heapsize","1024");
  typeProps2.put("oozie_permsize","128");
  properties.put("oozie-env",typeProps2);
  properties.put("yarn-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("NAMENODE");
  group1Components.add("SECONDARY_NAMENODE");
  group1Components.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",group1Components,Collections.singleton("testhost"));
  Collection<String> group2Components=new HashSet<String>();
  group2Components.add("DATANODE");
  group2Components.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",group2Components,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> configTypesUpdated=updater.doUpdateForClusterCreate();
  String updatedVal=properties.get("yarn-site").get("yarn.resourcemanager.hostname");
  assertEquals("testhost",updatedVal);
  String updatedVal1=properties.get("oozie-env").get("oozie_heapsize");
  assertEquals("1024m",updatedVal1);
  String updatedVal2=properties.get("oozie-env").get("oozie_permsize");
  assertEquals("128m",updatedVal2);
  assertEquals("Incorrect number of config types updated",3,configTypesUpdated.size());
  assertTrue("Expected config type not updated",configTypesUpdated.contains("oozie-env"));
  assertTrue("Expected config type not updated",configTypesUpdated.contains("yarn-site"));
  assertTrue("Expected config type not updated",configTypesUpdated.contains("cluster-env"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHBaseConfigClusterUpdatePropertiesFilterAuthorizationOff() throws Exception {
  reset(stack);
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  properties.put("hbase-site",hbaseSiteProperties);
  hbaseSiteProperties.put("hbase.security.authorization","false");
  hbaseSiteProperties.put("hbase.coprocessor.regionserver.classes"," ");
  hbaseSiteProperties.put("hbase.coprocessor.master.classes","");
  Map<String,Stack.ConfigProperty> mapOfMetadata=new HashMap<String,Stack.ConfigProperty>();
  Stack.ConfigProperty configProperty1=new Stack.ConfigProperty("hbase-site","hbase.coprocessor.regionserver.classes"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hbase-site","hbase.security.authorization");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  Stack.ConfigProperty configProperty2=new Stack.ConfigProperty("hbase-site","hbase.coprocessor.master.classes",""){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hbase-site","hbase.security.authorization");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  Stack.ConfigProperty configProperty3=new Stack.ConfigProperty("hbase-site","hbase.coprocessor.region.classes",""){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hbase-site","hbase.security.authorization");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  mapOfMetadata.put("hbase.coprocessor.regionserver.classes",configProperty1);
  mapOfMetadata.put("hbase.coprocessor.master.classes",configProperty2);
  mapOfMetadata.put("hbase.coprocessor.region.classes",configProperty3);
  expect(stack.getName()).andReturn("testStack").anyTimes();
  expect(stack.getVersion()).andReturn("1").anyTimes();
  expect(stack.isMasterComponent((String)anyObject())).andReturn(false).anyTimes();
  expect(stack.getServiceForConfigType("hbase-site")).andReturn("HBASE").atLeastOnce();
  expect(stack.getConfigurationPropertiesWithMetadata("HBASE","hbase-site")).andReturn(mapOfMetadata).atLeastOnce();
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  List<String> hosts=new ArrayList<String>();
  hosts.add("some-hose");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertFalse("hbase.coprocessor.regionserver.classes should have been filtered out of configuration",hbaseSiteProperties.containsKey("hbase.coprocessor.regionserver.classes"));
  assertTrue("hbase.coprocessor.master.classes should not have been filtered out of configuration",hbaseSiteProperties.containsKey("hbase.coprocessor.master.classes"));
  assertTrue("hbase.coprocessor.region.classes should not have been filtered out of configuration",hbaseSiteProperties.containsKey("hbase.coprocessor.master.classes"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTezConfigExport() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> tezSiteProperties=new HashMap<String,String>();
  configProperties.put("tez-site",tezSiteProperties);
  tezSiteProperties.put("tez.tez-ui.history-url.base","http://host:port/TEZ/TEZ_VIEW");
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> groupComponents=new HashSet<String>();
  groupComponents.add("TEZ_CLIENT");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add("serverTwo");
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,groupComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertFalse("tez.tez-ui.history-url.base should not be present in exported blueprint in tez-site",tezSiteProperties.containsKey("tez.tez-ui.history-url.base"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase.zookeeper.quorum","localhost");
  properties.put("hbase-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-site").get("hbase.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  expectedHosts.add("testhost2a");
  expectedHosts.add("testhost2b");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHAEnabled() throws Exception {
  final String expectedNameService="mynameservice";
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedPortNum="808080";
  final String expectedNodeOne="nn1";
  final String expectedNodeTwo="nn2";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  properties.put("core-site",coreSiteProperties);
  properties.put("hbase-site",hbaseSiteProperties);
  properties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.nameservices",expectedNameService);
  hdfsSiteProperties.put("dfs.ha.namenodes.mynameservice",expectedNodeOne + ", " + expectedNodeTwo);
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo,createExportedAddress(expectedPortNum,expectedHostGroupName));
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.https-address","localhost:8081");
  hdfsSiteProperties.put("dfs.namenode.rpc-address","localhost:8082");
  coreSiteProperties.put("fs.defaultFS","hdfs://" + expectedNameService);
  hbaseSiteProperties.put("hbase.rootdir","hdfs://" + expectedNameService + "/hbase/test/root/dir");
  accumuloSiteProperties.put("instance.volumes","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.https-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.http-address." + expectedNameService + "."+ expectedNodeTwo));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeOne));
  assertEquals("HTTPS address HA property not properly exported",expectedHostName + ":" + expectedPortNum,hdfsSiteProperties.get("dfs.namenode.rpc-address." + expectedNameService + "."+ expectedNodeTwo));
  String initialActiveHost=hadoopEnvProperties.get("dfs_ha_initial_namenode_active");
  String expectedStandbyHost=null;
  if (initialActiveHost.equals(expectedHostName)) {
    expectedStandbyHost=expectedHostNameTwo;
  }
 else   if (initialActiveHost.equals(expectedHostNameTwo)) {
    expectedStandbyHost=expectedHostName;
  }
 else {
    fail("Active Namenode hostname was not set correctly");
  }
  assertEquals("Standby Namenode hostname was not set correctly",expectedStandbyHost,hadoopEnvProperties.get("dfs_ha_initial_namenode_standby"));
  assertEquals("fs.defaultFS should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService,coreSiteProperties.get("fs.defaultFS"));
  assertEquals("hbase.rootdir should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/hbase/test/root/dir",hbaseSiteProperties.get("hbase.rootdir"));
  assertEquals("instance.volumes should not be modified by cluster update when NameNode HA is enabled.","hdfs://" + expectedNameService + "/accumulo/test/instance/volumes",accumuloSiteProperties.get("instance.volumes"));
  assertFalse("dfs.namenode.http-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.http-address"));
  assertFalse("dfs.namenode.https-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.https-address"));
  assertFalse("dfs.namenode.rpc-address should have been filtered out of this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.rpc-address"));
  assertEquals("Incorrect number of updated config types returned, set = " + updatedConfigTypes,3,updatedConfigTypes.size());
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("cluster-env"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hdfs-site"));
  assertTrue("Expected config type not found in updated set",updatedConfigTypes.contains("hadoop-env"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterWithNameNodeHANotEnabled() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedHostNameTwo="serverTwo";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsSiteProperties=new HashMap<String,String>();
  Map<String,String> hbaseSiteProperties=new HashMap<String,String>();
  Map<String,String> hadoopEnvProperties=new HashMap<String,String>();
  Map<String,String> coreSiteProperties=new HashMap<String,String>();
  Map<String,String> accumuloSiteProperties=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsSiteProperties);
  properties.put("hadoop-env",hadoopEnvProperties);
  properties.put("core-site",coreSiteProperties);
  properties.put("hbase-site",hbaseSiteProperties);
  properties.put("accumulo-site",accumuloSiteProperties);
  hdfsSiteProperties.put("dfs.secondary.http.address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.secondary.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.http-address","localhost:8080");
  hdfsSiteProperties.put("dfs.namenode.https-address","localhost:8081");
  hdfsSiteProperties.put("dfs.namenode.rpc-address","localhost:8082");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,Collections.singleton(expectedHostName));
  Collection<String> hgComponents2=new HashSet<String>();
  TestHostGroup group2=new TestHostGroup("host-group-2",hgComponents2,Collections.singleton(expectedHostNameTwo));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1-2")).anyTimes();
  expect(stack.getCardinality("SECONDARY_NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertTrue("dfs.namenode.http-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.http-address"));
  assertTrue("dfs.namenode.https-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.https-address"));
  assertTrue("dfs.namenode.rpc-address should have been included in this HA configuration",hdfsSiteProperties.containsKey("dfs.namenode.rpc-address"));
  assertEquals("Incorrect number of updated config types returned, set = " + updatedConfigTypes,2,updatedConfigTypes.size());
  assertTrue("Expected config type 'cluster-env' not found in updated set",updatedConfigTypes.contains("cluster-env"));
  assertTrue("Expected config type 'hdfs-site' not found in updated set",updatedConfigTypes.contains("hdfs-site"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_Storm_Nimbus_HA_Enabled__defaultValues_YAML() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("nimbus.seeds","localhost");
  properties.put("storm-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NIMBUS");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NIMBUS");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("storm-site").get("nimbus.seeds");
  assertTrue("Updated YAML value should start with bracket",updatedVal.startsWith("["));
  assertTrue("Updated YAML value should end with bracket",updatedVal.endsWith("]"));
  updatedVal=updatedVal.replaceAll("[\\[\\]]","");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  assertEquals("Incorrect number of hosts found in updated Nimbus config property",2,hosts.length);
  for (  String host : hosts) {
    assertTrue("Expected host name = " + host + " not found in updated Nimbus config property",expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues___withPorts() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("templeton.zookeeper.hosts","%HOSTGROUP::group1%:9090,%HOSTGROUP::group2%:9091");
  properties.put("webhcat-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("webhcat-site").get("templeton.zookeeper.hosts");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:9090");
  expectedHosts.add("testhost2:9091");
  expectedHosts.add("testhost2a:9091");
  expectedHosts.add("testhost2b:9091");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__defaultValues___withPorts() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("templeton.zookeeper.hosts","localhost:9090");
  properties.put("webhcat-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("webhcat-site").get("templeton.zookeeper.hosts");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost:9090");
  expectedHosts.add("testhost2:9090");
  expectedHosts.add("testhost2a:9090");
  expectedHosts.add("testhost2b:9090");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyAlways() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentClusterConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentClusterConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ALWAYS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  Set<String> configTypes=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNotNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertEquals(2,topology.getAdvisedConfigurations().size());
  assertFalse(configTypes.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterVerifyRetrySettingsDefault() throws Exception {
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  HashMap<String,String> clusterEnvProperties=new HashMap<String,String>();
  configProperties.put("cluster-env",clusterEnvProperties);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  TestHostGroup testHostGroup=new TestHostGroup("test-host-group-one",Collections.<String>emptySet(),Collections.<String>emptySet());
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,Collections.singleton(testHostGroup));
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Set<String> updatedConfigTypes=updater.doUpdateForClusterCreate();
  assertEquals("Incorrect number of properties added to cluster-env for retry",3,clusterEnvProperties.size());
  assertEquals("command_retry_enabled was not set to the expected default","true",clusterEnvProperties.get("command_retry_enabled"));
  assertEquals("commands_to_retry was not set to the expected default","INSTALL,START",clusterEnvProperties.get("commands_to_retry"));
  assertEquals("command_retry_max_time_in_sec was not set to the expected default","600",clusterEnvProperties.get("command_retry_max_time_in_sec"));
  assertEquals("Incorrect number of config types updated by this operation",1,updatedConfigTypes.size());
  assertTrue("Expected type not included in the updated set",updatedConfigTypes.contains("cluster-env"));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForBlueprintExport_PasswordFilterApplied() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("REPOSITORY_CONFIG_PASSWORD","test-password-one");
  typeProps.put("SSL_KEYSTORE_PASSWORD","test-password-two");
  typeProps.put("SSL_TRUSTSTORE_PASSWORD","test-password-three");
  typeProps.put("XAAUDIT.DB.PASSWORD","test-password-four");
  typeProps.put("test.ssl.password","test-password-five");
  typeProps.put("test.password.should.be.included","test-another-pwd");
  Map<String,String> customProps=new HashMap<String,String>();
  customProps.put("my_test_PASSWORD","should be excluded");
  customProps.put("PASSWORD_mytest","should be included");
  properties.put("ranger-yarn-plugin-properties",typeProps);
  properties.put("custom-test-properties",customProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertEquals("Exported properties map was not of the expected size",1,properties.get("custom-test-properties").size());
  assertEquals("ranger-yarn-plugin-properties config type was not properly exported",1,properties.get("ranger-yarn-plugin-properties").size());
  assertFalse("Password property should have been excluded",properties.get("ranger-yarn-plugin-properties").containsKey("REPOSITORY_CONFIG_PASSWORD"));
  assertFalse("Password property should have been excluded",properties.get("ranger-yarn-plugin-properties").containsKey("SSL_KEYSTORE_PASSWORD"));
  assertFalse("Password property should have been excluded",properties.get("ranger-yarn-plugin-properties").containsKey("SSL_TRUSTSTORE_PASSWORD"));
  assertFalse("Password property should have been excluded",properties.get("ranger-yarn-plugin-properties").containsKey("XAAUDIT.DB.PASSWORD"));
  assertFalse("Password property should have been excluded",properties.get("ranger-yarn-plugin-properties").containsKey("test.ssl.password"));
  assertTrue("Expected password property not found",properties.get("ranger-yarn-plugin-properties").containsKey("test.password.should.be.included"));
  assertEquals("custom-test-properties type was not properly exported",1,properties.get("custom-test-properties").size());
  assertFalse("Password property should have been excluded",properties.get("custom-test-properties").containsKey("my_test_PASSWORD"));
  assertTrue("Expected password property not found",properties.get("custom-test-properties").containsKey("PASSWORD_mytest"));
  assertEquals("Expected password property should not have been modified","should be included",properties.get("custom-test-properties").get("PASSWORD_mytest"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDoUpdateForBlueprintExport_DBHostProperty__External() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("javax.jdo.option.ConnectionURL","jdbc:mysql://external-host/hive?createDatabaseIfNotExist=true");
  properties.put("hive-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("testhost2"));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertFalse(properties.get("hive-site").containsKey("javax.jdo.option.ConnectionURL"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequiredHostGroups___multipleGroups() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.defaultFS","localhost");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  expect(stack.getCardinality("NAMENODE")).andReturn(new Cardinality("1")).anyTimes();
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("HIVE_SERVER");
  hgComponents1.add("NAMENODE");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("NAMENODE");
  hgComponents2.add("DATANODE");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton("host2"));
  Collection<TestHostGroup> hostGroups=new ArrayList<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  Collection<String> requiredGroups=updater.getRequiredHostGroups();
  assertEquals(2,requiredGroups.size());
  assertTrue(requiredGroups.containsAll(Arrays.asList("group1","group2")));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHiveConfigClusterUpdatePropertiesFilterAuthenticationOff() throws Exception {
  reset(stack);
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hiveSiteProperties=new HashMap<String,String>();
  properties.put("hive-site",hiveSiteProperties);
  hiveSiteProperties.put("hive.server2.authentication","NONE");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.keytab"," ");
  hiveSiteProperties.put("hive.server2.authentication.kerberos.principal"," ");
  Map<String,Stack.ConfigProperty> mapOfMetadata=new HashMap<String,Stack.ConfigProperty>();
  Stack.ConfigProperty configProperty1=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.keytab"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  Stack.ConfigProperty configProperty2=new Stack.ConfigProperty("hive-site","hive.server2.authentication.kerberos.principal"," "){
    @Override Set<PropertyDependencyInfo> getDependsOnProperties(){
      PropertyDependencyInfo dependencyInfo=new PropertyDependencyInfo("hive-site","hive.server2.authentication");
      return Collections.singleton(dependencyInfo);
    }
  }
;
  mapOfMetadata.put("hive.server2.authentication.kerberos.keytab",configProperty1);
  mapOfMetadata.put("hive.server2.authentication.kerberos.principal",configProperty2);
  expect(stack.getName()).andReturn("testStack").anyTimes();
  expect(stack.getVersion()).andReturn("1").anyTimes();
  expect(stack.isMasterComponent((String)anyObject())).andReturn(false).anyTimes();
  expect(stack.getServiceForConfigType("hive-site")).andReturn("HIVE").atLeastOnce();
  expect(stack.getConfigurationPropertiesWithMetadata("HIVE","hive-site")).andReturn(mapOfMetadata).atLeastOnce();
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  List<String> hosts=new ArrayList<String>();
  hosts.add("some-hose");
  TestHostGroup group1=new TestHostGroup(expectedHostGroupName,hgComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  assertFalse("hive.server2.authentication.kerberos.keytab should have been filtered out of configuration",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.keytab"));
  assertFalse("hive.server2.authentication.kerberos.principal should have been filtered out of configuration",hiveSiteProperties.containsKey("hive.server2.authentication.kerberos.principal"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoUpdateForClusterCreate_MultiHostProperty__exportedValues() throws Exception {
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> typeProps=new HashMap<String,String>();
  typeProps.put("hbase.zookeeper.quorum","%HOSTGROUP::group1%,%HOSTGROUP::group2%");
  properties.put("hbase-site",typeProps);
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("ZOOKEEPER_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_SERVER");
  Set<String> hosts2=new HashSet<String>();
  hosts2.add("testhost2");
  hosts2.add("testhost2a");
  hosts2.add("testhost2b");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,hosts2);
  Collection<String> hgComponents3=new HashSet<String>();
  hgComponents2.add("HDFS_CLIENT");
  hgComponents2.add("ZOOKEEPER_CLIENT");
  Set<String> hosts3=new HashSet<String>();
  hosts3.add("testhost3");
  hosts3.add("testhost3a");
  TestHostGroup group3=new TestHostGroup("group3",hgComponents3,hosts3);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  hostGroups.add(group3);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor updater=new BlueprintConfigurationProcessor(topology);
  updater.doUpdateForClusterCreate();
  String updatedVal=topology.getConfiguration().getFullProperties().get("hbase-site").get("hbase.zookeeper.quorum");
  String[] hosts=updatedVal.split(",");
  Collection<String> expectedHosts=new HashSet<String>();
  expectedHosts.add("testhost");
  expectedHosts.add("testhost2");
  expectedHosts.add("testhost2a");
  expectedHosts.add("testhost2b");
  assertEquals(4,hosts.length);
  for (  String host : hosts) {
    assertTrue(expectedHosts.contains(host));
    expectedHosts.remove(host);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintResourceProviderTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withOldSchema() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/hive_database","db");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationEntity_oldSchema() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  configuration.put("global/property1","val1");
  configuration.put("global/property2","val2");
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigData());
  assertNotNull(config.getConfigAttributes());
  Map<?,?> configData=StageUtils.getGson().fromJson(config.getConfigData(),Map.class);
  Map<?,Map<?,?>> configAttrs=StageUtils.getGson().fromJson(config.getConfigAttributes(),Map.class);
  assertNotNull(configData);
  assertNotNull(configAttrs);
  assertEquals(2,configData.size());
  assertTrue(configData.containsKey("property1"));
  assertTrue(configData.containsKey("property2"));
  assertEquals("val1",configData.get("property1"));
  assertEquals("val2",configData.get("property2"));
  assertEquals(0,configAttrs.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_configIsEmpty() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_configIsNull() throws Exception {
  Map<String,String> configMap=null;
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withNewSchema_attributes() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/properties_attributes/final/foo_contact","true");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationList() throws Exception {
  StackEntity stackEntity=new StackEntity();
  stackEntity.setStackName("test-stack-name");
  stackEntity.setStackVersion("test-stack-version");
  BlueprintEntity entity=createMock(BlueprintEntity.class);
  expect(entity.getStack()).andReturn(stackEntity).anyTimes();
  HashMap<PropertyInfo.PropertyType,Set<String>> pwdProperties=new HashMap<PropertyInfo.PropertyType,Set<String>>(){
{
      put(PropertyInfo.PropertyType.PASSWORD,new HashSet<String>(){
{
          add("test.password");
        }
      }
);
    }
  }
;
  StackInfo info=createMock(StackInfo.class);
  expect(info.getConfigPropertiesTypes("type1")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type2")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type3")).andReturn(pwdProperties).anyTimes();
  expect(metaInfo.getStack("test-stack-name","test-stack-version")).andReturn(info).anyTimes();
  replay(info,metaInfo,entity);
  BlueprintConfigEntity config1=new BlueprintConfigEntity();
  config1.setType("type1");
  config1.setConfigData("{\"key1\":\"value1\"}");
  config1.setBlueprintEntity(entity);
  BlueprintConfigEntity config2=new BlueprintConfigEntity();
  config2.setType("type2");
  config2.setConfigData("{\"key2\":\"value2\"}");
  config2.setConfigAttributes("{}");
  config2.setBlueprintEntity(entity);
  BlueprintConfigEntity config3=new BlueprintConfigEntity();
  config3.setType("type3");
  config3.setConfigData("{\"key3\":\"value3\",\"key4\":\"value4\",\"test.password\":\"pwdValue\"}");
  config3.setConfigAttributes("{\"final\":{\"key3\":\"attrValue1\",\"key4\":\"attrValue2\"}}");
  config3.setBlueprintEntity(entity);
  List<Map<String,Map<String,Object>>> configs=provider.populateConfigurationList(Arrays.asList(config1,config2,config3));
  assertNotNull(configs);
  assertEquals(3,configs.size());
  Map<String,Map<String,Object>> configuration1=configs.get(0);
  assertNotNull(configuration1);
  assertEquals(1,configuration1.size());
  assertTrue(configuration1.containsKey("type1"));
  Map<String,Object> typeConfig1=configuration1.get("type1");
  assertNotNull(typeConfig1);
  assertEquals(1,typeConfig1.size());
  assertTrue(typeConfig1.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties1=(Map<String,String>)typeConfig1.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties1);
  assertEquals(1,confProperties1.size());
  assertEquals("value1",confProperties1.get("key1"));
  Map<String,Map<String,Object>> configuration2=configs.get(1);
  assertNotNull(configuration2);
  assertEquals(1,configuration2.size());
  assertTrue(configuration2.containsKey("type2"));
  Map<String,Object> typeConfig2=configuration2.get("type2");
  assertNotNull(typeConfig2);
  assertEquals(1,typeConfig2.size());
  assertTrue(typeConfig2.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties2=(Map<String,String>)typeConfig2.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties2);
  assertEquals(1,confProperties2.size());
  assertEquals("value2",confProperties2.get("key2"));
  Map<String,Map<String,Object>> configuration3=configs.get(2);
  assertNotNull(configuration3);
  assertEquals(1,configuration3.size());
  assertTrue(configuration3.containsKey("type3"));
  Map<String,Object> typeConfig3=configuration3.get("type3");
  assertNotNull(typeConfig3);
  assertEquals(2,typeConfig3.size());
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties3=(Map<String,String>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties3);
  assertEquals(3,confProperties3.size());
  assertEquals("value3",confProperties3.get("key3"));
  assertEquals("value4",confProperties3.get("key4"));
  assertEquals("SECRET:type3:-1:test.password",confProperties3.get("test.password"));
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID));
  Map<String,Map<String,String>> confAttributes3=(Map<String,Map<String,String>>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID);
  assertNotNull(confAttributes3);
  assertEquals(1,confAttributes3.size());
  assertTrue(confAttributes3.containsKey("final"));
  Map<String,String> finalAttrs=confAttributes3.get("final");
  assertEquals(2,finalAttrs.size());
  assertEquals("attrValue1",finalAttrs.get("key3"));
  assertEquals("attrValue2",finalAttrs.get("key4"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationEntity_newSchema() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  configuration.put("global/properties/property1","val1");
  configuration.put("global/properties/property2","val2");
  configuration.put("global/properties_attributes/final/property1","true");
  configuration.put("global/properties_attributes/final/property2","false");
  configuration.put("global/properties_attributes/deletable/property1","true");
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigData());
  assertNotNull(config.getConfigAttributes());
  Map<?,?> configData=StageUtils.getGson().fromJson(config.getConfigData(),Map.class);
  Map<?,Map<?,?>> configAttrs=StageUtils.getGson().fromJson(config.getConfigAttributes(),Map.class);
  assertNotNull(configData);
  assertNotNull(configAttrs);
  assertEquals(2,configData.size());
  assertTrue(configData.containsKey("property1"));
  assertTrue(configData.containsKey("property2"));
  assertEquals("val1",configData.get("property1"));
  assertEquals("val2",configData.get("property2"));
  assertEquals(2,configAttrs.size());
  assertTrue(configAttrs.containsKey("final"));
  assertTrue(configAttrs.containsKey("deletable"));
  Map<?,?> finalAttrs=configAttrs.get("final");
  assertNotNull(finalAttrs);
  assertEquals(2,finalAttrs.size());
  assertTrue(finalAttrs.containsKey("property1"));
  assertTrue(finalAttrs.containsKey("property2"));
  assertEquals("true",finalAttrs.get("property1"));
  assertEquals("false",finalAttrs.get("property2"));
  Map<?,?> deletableAttrs=configAttrs.get("deletable");
  assertNotNull(deletableAttrs);
  assertEquals(1,deletableAttrs.size());
  assertTrue(deletableAttrs.containsKey("property1"));
  assertEquals("true",deletableAttrs.get("property1"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withNewSchema_properties() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/properties/foo_contact","foo@ffl.dsfds");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClientConfigResourceProviderTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetResourcesFromCommonServices() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  CommandScriptDefinition commandScriptDefinition=createNiceMock(CommandScriptDefinition.class);
  Config clusterConfig=createNiceMock(Config.class);
  DesiredConfig desiredConfig=createNiceMock(DesiredConfig.class);
  Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent serviceComponent=createNiceMock(ServiceComponent.class);
  ServiceComponentHost serviceComponentHost=createNiceMock(ServiceComponentHost.class);
  ServiceOsSpecific serviceOsSpecific=createNiceMock(ServiceOsSpecific.class);
  ConfigHelper configHelper=createNiceMock(ConfigHelper.class);
  Configuration configuration=PowerMock.createStrictMockAndExpectNew(Configuration.class);
  Map<String,String> configMap=createNiceMock(Map.class);
  File mockFile=PowerMock.createNiceMock(File.class);
  Runtime runtime=createMock(Runtime.class);
  Process process=createNiceMock(Process.class);
  Map<String,DesiredConfig> desiredConfigMap=new HashMap<String,DesiredConfig>();
  desiredConfigMap.put("hive-site",desiredConfig);
  Map<String,Map<String,String>> allConfigTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  ClientConfigFileDefinition clientConfigFileDefinition=new ClientConfigFileDefinition();
  clientConfigFileDefinition.setDictionaryName("pig-env");
  clientConfigFileDefinition.setFileName("pig-env.sh");
  clientConfigFileDefinition.setType("env");
  List<ClientConfigFileDefinition> clientConfigFileDefinitionList=new LinkedList<ClientConfigFileDefinition>();
  clientConfigFileDefinitionList.add(clientConfigFileDefinition);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Request request=PropertyHelper.getReadRequest(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID,"c1",ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID,ClientConfigResourceProvider.COMPONENT_SERVICE_NAME_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID).equals("c1").toPredicate();
  String clusterName="C1";
  String serviceName="PIG";
  String componentName="PIG";
  String hostName="Host100";
  String desiredState="INSTALLED";
  String stackName="S1";
  String stackVersion="V1";
  String stackRoot="/tmp/stacks/S1/V1";
  String packageFolder=StackManager.COMMON_SERVICES + "/PIG/package";
  String commonServicesPath="/var/lib/ambari-server/src/main/resources" + File.separator + "common-services";
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot="C:\\tmp\\stacks\\S1\\V1";
    packageFolder=StackManager.COMMON_SERVICES + "\\PIG\\package";
  }
  HashMap<String,Host> hosts=new HashMap<String,Host>();
  hosts.put(hostName,host);
  HashMap<String,Service> services=new HashMap<String,Service>();
  services.put(serviceName,service);
  HashMap<String,ServiceComponent> serviceComponentMap=new HashMap<String,ServiceComponent>();
  serviceComponentMap.put(componentName,serviceComponent);
  HashMap<String,ServiceComponentHost> serviceComponentHosts=new HashMap<String,ServiceComponentHost>();
  serviceComponentHosts.put(componentName,serviceComponentHost);
  HashMap<String,ServiceOsSpecific> serviceOsSpecificHashMap=new HashMap<String,ServiceOsSpecific>();
  serviceOsSpecificHashMap.put("key",serviceOsSpecific);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse(clusterName,serviceName,componentName,hostName,desiredState,"",null,null,null);
  Set<ServiceComponentHostResponse> responses=new LinkedHashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  Map<String,String> returnConfigMap=new HashMap<String,String>();
  returnConfigMap.put(Configuration.SERVER_TMP_DIR_KEY,Configuration.SERVER_TMP_DIR_DEFAULT);
  returnConfigMap.put(Configuration.AMBARI_PYTHON_WRAP_KEY,Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(managementController.getConfigHelper()).andReturn(configHelper);
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(configHelper.getEffectiveConfigProperties(cluster,configTags)).andReturn(properties);
  expect(clusterConfig.getType()).andReturn(Configuration.HIVE_CONFIG_TAG).anyTimes();
  expect(configHelper.getEffectiveConfigAttributes(cluster,configTags)).andReturn(attributes);
  expect(configMap.get(Configuration.SERVER_TMP_DIR_KEY)).andReturn(Configuration.SERVER_TMP_DIR_DEFAULT);
  expect(configMap.get(Configuration.AMBARI_PYTHON_WRAP_KEY)).andReturn(Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(configuration.getConfigsMap()).andReturn(returnConfigMap);
  expect(configuration.getResourceDirPath()).andReturn("/var/lib/ambari-server/src/main/resources");
  expect(configuration.getJavaVersion()).andReturn(8);
  expect(configuration.areHostsSysPrepped()).andReturn("false");
  expect(configuration.getExternalScriptTimeout()).andReturn(Integer.parseInt(Configuration.EXTERNAL_SCRIPT_TIMEOUT_DEFAULT));
  Map<String,String> props=new HashMap<String,String>();
  props.put(Configuration.HIVE_METASTORE_PASSWORD_PROPERTY,"pass");
  props.put("key","value");
  expect(clusterConfig.getProperties()).andReturn(props);
  expect(configHelper.getEffectiveDesiredTags(cluster,hostName)).andReturn(allConfigTags);
  expect(cluster.getClusterName()).andReturn(clusterName);
  expect(managementController.getHostComponents((Set<ServiceComponentHostRequest>)anyObject())).andReturn(responses).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  PowerMock.mockStaticPartial(StageUtils.class,"getClusterHostInfo");
  Map<String,Set<String>> clusterHostInfo=new HashMap<String,Set<String>>();
  Set<String> all_hosts=new HashSet<String>(Arrays.asList("Host100","Host101","Host102"));
  Set<String> some_hosts=new HashSet<String>(Arrays.asList("0-1","2"));
  Set<String> ohter_hosts=new HashSet<String>(Arrays.asList("0,1"));
  Set<String> clusterHostTypes=new HashSet<String>(Arrays.asList("nm_hosts","hs_host","namenode_host","rm_host","snamenode_host","slave_hosts","zookeeper_hosts"));
  for (  String hostTypes : clusterHostTypes) {
    if (hostTypes.equals("slave_hosts")) {
      clusterHostInfo.put(hostTypes,ohter_hosts);
    }
 else {
      clusterHostInfo.put(hostTypes,some_hosts);
    }
  }
  Map<String,Host> stringHostMap=new HashMap<String,Host>();
  stringHostMap.put(hostName,host);
  clusterHostInfo.put("all_hosts",all_hosts);
  expect(StageUtils.getClusterHostInfo(cluster)).andReturn(clusterHostInfo);
  expect(stackId.getStackName()).andReturn(stackName).anyTimes();
  expect(stackId.getStackVersion()).andReturn(stackVersion).anyTimes();
  expect(ambariMetaInfo.getComponent(stackName,stackVersion,serviceName,componentName)).andReturn(componentInfo);
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getServicePackageFolder()).andReturn(packageFolder);
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCommandScript()).andReturn(commandScriptDefinition);
  expect(componentInfo.getClientConfigFiles()).andReturn(clientConfigFileDefinitionList);
  expect(cluster.getConfig("hive-site",null)).andReturn(clusterConfig);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigMap);
  expect(clusters.getHost(hostName)).andReturn(host);
  HashMap<String,String> rcaParams=new HashMap<String,String>();
  rcaParams.put("key","value");
  expect(managementController.getRcaParameters()).andReturn(rcaParams).anyTimes();
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getOsSpecifics()).andReturn(new HashMap<String,ServiceOsSpecific>()).anyTimes();
  Set<String> userSet=new HashSet<String>();
  userSet.add("hdfs");
  expect(configHelper.getPropertyValuesWithPropertyType(stackId,PropertyInfo.PropertyType.USER,cluster)).andReturn(userSet);
  PowerMock.expectNew(File.class,new Class<?>[]{String.class},anyObject(String.class)).andReturn(mockFile).anyTimes();
  PowerMock.createNiceMockAndExpectNew(PrintWriter.class,anyObject());
  expect(mockFile.getParent()).andReturn("");
  PowerMock.mockStatic(Runtime.class);
  expect(mockFile.exists()).andReturn(true);
  String commandLine="ambari-python-wrap " + commonServicesPath + "/PIG/package/null generate_configs null "+ commonServicesPath+ "/PIG/package /var/lib/ambari-server/tmp/structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  if (System.getProperty("os.name").contains("Windows")) {
    commandLine="ambari-python-wrap " + commonServicesPath + "\\PIG\\package\\null generate_configs null "+ commonServicesPath+ "\\PIG\\package /var/lib/ambari-server/tmp\\structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  }
  ProcessBuilder processBuilder=PowerMock.createNiceMock(ProcessBuilder.class);
  PowerMock.expectNew(ProcessBuilder.class,Arrays.asList(commandLine.split("\\s+"))).andReturn(processBuilder).once();
  expect(processBuilder.start()).andReturn(process).once();
  InputStream inputStream=new ByteArrayInputStream("some logging info".getBytes());
  expect(process.getInputStream()).andReturn(inputStream);
  replay(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process,configMap);
  PowerMock.replayAll();
  Set<Resource> resources=provider.getResources(request,predicate);
  assertFalse(resources.isEmpty());
  verify(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process);
  PowerMock.verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.ClientConfig;
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  CommandScriptDefinition commandScriptDefinition=createNiceMock(CommandScriptDefinition.class);
  Config clusterConfig=createNiceMock(Config.class);
  DesiredConfig desiredConfig=createNiceMock(DesiredConfig.class);
  Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent serviceComponent=createNiceMock(ServiceComponent.class);
  ServiceComponentHost serviceComponentHost=createNiceMock(ServiceComponentHost.class);
  ServiceOsSpecific serviceOsSpecific=createNiceMock(ServiceOsSpecific.class);
  ConfigHelper configHelper=createNiceMock(ConfigHelper.class);
  Configuration configuration=PowerMock.createStrictMockAndExpectNew(Configuration.class);
  Map<String,String> configMap=createNiceMock(Map.class);
  File mockFile=PowerMock.createNiceMock(File.class);
  Runtime runtime=createMock(Runtime.class);
  Process process=createNiceMock(Process.class);
  Map<String,DesiredConfig> desiredConfigMap=new HashMap<String,DesiredConfig>();
  desiredConfigMap.put("hive-site",desiredConfig);
  Map<String,Map<String,String>> allConfigTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  ClientConfigFileDefinition clientConfigFileDefinition=new ClientConfigFileDefinition();
  clientConfigFileDefinition.setDictionaryName("pig-env");
  clientConfigFileDefinition.setFileName("pig-env.sh");
  clientConfigFileDefinition.setType("env");
  List<ClientConfigFileDefinition> clientConfigFileDefinitionList=new LinkedList<ClientConfigFileDefinition>();
  clientConfigFileDefinitionList.add(clientConfigFileDefinition);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Request request=PropertyHelper.getReadRequest(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID,"c1",ClientConfigResourceProvider.COMPONENT_COMPONENT_NAME_PROPERTY_ID,ClientConfigResourceProvider.COMPONENT_SERVICE_NAME_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ClientConfigResourceProvider.COMPONENT_CLUSTER_NAME_PROPERTY_ID).equals("c1").toPredicate();
  String clusterName="C1";
  String serviceName="PIG";
  String componentName="PIG";
  String hostName="Host100";
  String desiredState="INSTALLED";
  String stackName="S1";
  String stackVersion="V1";
  String stackRoot="/tmp/stacks/S1/V1";
  String packageFolder="PIG/package";
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot="C:\\tmp\\stacks\\S1\\V1";
    packageFolder="PIG\\package";
  }
  HashMap<String,Host> hosts=new HashMap<String,Host>();
  hosts.put(hostName,host);
  HashMap<String,Service> services=new HashMap<String,Service>();
  services.put(serviceName,service);
  HashMap<String,ServiceComponent> serviceComponentMap=new HashMap<String,ServiceComponent>();
  serviceComponentMap.put(componentName,serviceComponent);
  HashMap<String,ServiceComponentHost> serviceComponentHosts=new HashMap<String,ServiceComponentHost>();
  serviceComponentHosts.put(componentName,serviceComponentHost);
  HashMap<String,ServiceOsSpecific> serviceOsSpecificHashMap=new HashMap<String,ServiceOsSpecific>();
  serviceOsSpecificHashMap.put("key",serviceOsSpecific);
  ServiceComponentHostResponse shr1=new ServiceComponentHostResponse(clusterName,serviceName,componentName,hostName,desiredState,"",null,null,null);
  Set<ServiceComponentHostResponse> responses=new LinkedHashSet<ServiceComponentHostResponse>();
  responses.add(shr1);
  Map<String,String> returnConfigMap=new HashMap<String,String>();
  returnConfigMap.put(Configuration.SERVER_TMP_DIR_KEY,Configuration.SERVER_TMP_DIR_DEFAULT);
  returnConfigMap.put(Configuration.AMBARI_PYTHON_WRAP_KEY,Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(managementController.getConfigHelper()).andReturn(configHelper);
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(configHelper.getEffectiveConfigProperties(cluster,configTags)).andReturn(properties);
  expect(clusterConfig.getType()).andReturn(Configuration.HIVE_CONFIG_TAG).anyTimes();
  expect(configHelper.getEffectiveConfigAttributes(cluster,configTags)).andReturn(attributes);
  expect(configMap.get(Configuration.SERVER_TMP_DIR_KEY)).andReturn(Configuration.SERVER_TMP_DIR_DEFAULT);
  expect(configMap.get(Configuration.AMBARI_PYTHON_WRAP_KEY)).andReturn(Configuration.AMBARI_PYTHON_WRAP_DEFAULT);
  expect(configuration.getConfigsMap()).andReturn(returnConfigMap);
  expect(configuration.getResourceDirPath()).andReturn(stackRoot);
  expect(configuration.getJavaVersion()).andReturn(8);
  expect(configuration.areHostsSysPrepped()).andReturn("false");
  expect(configuration.getExternalScriptTimeout()).andReturn(Integer.parseInt(Configuration.EXTERNAL_SCRIPT_TIMEOUT_DEFAULT));
  Map<String,String> props=new HashMap<String,String>();
  props.put(Configuration.HIVE_METASTORE_PASSWORD_PROPERTY,"pass");
  props.put("key","value");
  expect(clusterConfig.getProperties()).andReturn(props);
  expect(configHelper.getEffectiveDesiredTags(cluster,hostName)).andReturn(allConfigTags);
  expect(cluster.getClusterName()).andReturn(clusterName);
  expect(managementController.getHostComponents((Set<ServiceComponentHostRequest>)anyObject())).andReturn(responses).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  PowerMock.mockStaticPartial(StageUtils.class,"getClusterHostInfo");
  Map<String,Set<String>> clusterHostInfo=new HashMap<String,Set<String>>();
  Set<String> all_hosts=new HashSet<String>(Arrays.asList("Host100","Host101","Host102"));
  Set<String> some_hosts=new HashSet<String>(Arrays.asList("0-1","2"));
  Set<String> ohter_hosts=new HashSet<String>(Arrays.asList("0,1"));
  Set<String> clusterHostTypes=new HashSet<String>(Arrays.asList("nm_hosts","hs_host","namenode_host","rm_host","snamenode_host","slave_hosts","zookeeper_hosts"));
  for (  String hostTypes : clusterHostTypes) {
    if (hostTypes.equals("slave_hosts")) {
      clusterHostInfo.put(hostTypes,ohter_hosts);
    }
 else {
      clusterHostInfo.put(hostTypes,some_hosts);
    }
  }
  Map<String,Host> stringHostMap=new HashMap<String,Host>();
  stringHostMap.put(hostName,host);
  clusterHostInfo.put("all_hosts",all_hosts);
  expect(StageUtils.getClusterHostInfo(cluster)).andReturn(clusterHostInfo);
  expect(stackId.getStackName()).andReturn(stackName).anyTimes();
  expect(stackId.getStackVersion()).andReturn(stackVersion).anyTimes();
  expect(ambariMetaInfo.getComponent(stackName,stackVersion,serviceName,componentName)).andReturn(componentInfo);
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getServicePackageFolder()).andReturn(packageFolder);
  expect(ambariMetaInfo.getComponent((String)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject())).andReturn(componentInfo).anyTimes();
  expect(componentInfo.getCommandScript()).andReturn(commandScriptDefinition);
  expect(componentInfo.getClientConfigFiles()).andReturn(clientConfigFileDefinitionList);
  expect(cluster.getConfig("hive-site",null)).andReturn(clusterConfig);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigMap);
  expect(clusters.getHost(hostName)).andReturn(host);
  HashMap<String,String> rcaParams=new HashMap<String,String>();
  rcaParams.put("key","value");
  expect(managementController.getRcaParameters()).andReturn(rcaParams).anyTimes();
  expect(ambariMetaInfo.getService(stackName,stackVersion,serviceName)).andReturn(serviceInfo);
  expect(serviceInfo.getOsSpecifics()).andReturn(new HashMap<String,ServiceOsSpecific>()).anyTimes();
  Set<String> userSet=new HashSet<String>();
  userSet.add("hdfs");
  expect(configHelper.getPropertyValuesWithPropertyType(stackId,PropertyInfo.PropertyType.USER,cluster)).andReturn(userSet);
  PowerMock.expectNew(File.class,new Class<?>[]{String.class},anyObject(String.class)).andReturn(mockFile).anyTimes();
  PowerMock.createNiceMockAndExpectNew(PrintWriter.class,anyObject());
  expect(mockFile.getParent()).andReturn("");
  PowerMock.mockStatic(Runtime.class);
  expect(mockFile.exists()).andReturn(true);
  String commandLine="ambari-python-wrap /tmp/stacks/S1/V1/PIG/package/null generate_configs null " + "/tmp/stacks/S1/V1/PIG/package /var/lib/ambari-server/tmp/structured-out.json " + "INFO /var/lib/ambari-server/tmp";
  if (System.getProperty("os.name").contains("Windows")) {
    commandLine="ambari-python-wrap " + stackRoot + "\\PIG\\package\\null generate_configs null "+ stackRoot+ "\\PIG\\package /var/lib/ambari-server/tmp\\structured-out.json "+ "INFO /var/lib/ambari-server/tmp";
  }
  ProcessBuilder processBuilder=PowerMock.createNiceMock(ProcessBuilder.class);
  PowerMock.expectNew(ProcessBuilder.class,Arrays.asList(commandLine.split("\\s+"))).andReturn(processBuilder).once();
  expect(processBuilder.start()).andReturn(process).once();
  InputStream inputStream=new ByteArrayInputStream("some logging info".getBytes());
  expect(process.getInputStream()).andReturn(inputStream);
  replay(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process,configMap);
  PowerMock.replayAll();
  Set<Resource> resources=provider.getResources(request,predicate);
  assertFalse(resources.isEmpty());
  verify(managementController,clusters,cluster,ambariMetaInfo,stackId,componentInfo,commandScriptDefinition,clusterConfig,host,service,serviceComponent,serviceComponentHost,serviceInfo,configHelper,runtime,process);
  PowerMock.verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterControllerImplTest </h4><pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesCheckOrder() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Iterable<Resource> iterable=controller.getResourceIterable(Resource.Type.Host,request,null);
  String lastHostName=null;
  int cnt=0;
  for (  Resource resource : iterable) {
    Assert.assertEquals(Resource.Type.Host,resource.getType());
    String hostName=(String)resource.getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name"));
    if (lastHostName != null) {
      Assert.assertTrue(hostName.compareTo(lastHostName) > 0);
    }
    lastHostName=hostName;
    ++cnt;
  }
  Assert.assertEquals(4,cnt);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateResourcesResolvePredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  Request request=PropertyHelper.getUpdateRequest(propertyMap,null);
  Predicate predicate=new PredicateBuilder().property("c3/p6").equals(1).toPredicate();
  controller.updateResources(Resource.Type.Host,request,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Update,resourceProvider.getLastAction());
  Assert.assertSame(request,resourceProvider.getLastRequest());
  Predicate lastPredicate=resourceProvider.getLastPredicate();
  Assert.assertFalse(predicate.equals(lastPredicate));
  Set<String> predicatePropertyIds=PredicateHelper.getPropertyIds(lastPredicate);
  Collection<String> keyPropertyIds=resourceProvider.getKeyPropertyIds().values();
  Assert.assertEquals(predicatePropertyIds.size(),keyPropertyIds.size());
  Assert.assertTrue(keyPropertyIds.containsAll(predicatePropertyIds));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesResolvePredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Predicate predicate=new PredicateBuilder().property("c3/p6").equals(1).toPredicate();
  controller.deleteResources(Resource.Type.Host,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Delete,resourceProvider.getLastAction());
  Assert.assertNull(resourceProvider.getLastRequest());
  Predicate lastPredicate=resourceProvider.getLastPredicate();
  Assert.assertFalse(predicate.equals(lastPredicate));
  Set<String> predicatePropertyIds=PredicateHelper.getPropertyIds(lastPredicate);
  Collection<String> keyPropertyIds=resourceProvider.getKeyPropertyIds().values();
  Assert.assertEquals(predicatePropertyIds.size(),keyPropertyIds.size());
  Assert.assertTrue(keyPropertyIds.containsAll(predicatePropertyIds));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComparator(){
  TestProviderModule providerModule=new TestProviderModule();
  ClusterControllerImpl controller=new ClusterControllerImpl(providerModule);
  Comparator<Resource> comparator=controller.getComparator();
  Resource resource1=new ResourceImpl(Resource.Type.Host);
  Resource resource2=new ResourceImpl(Resource.Type.Host);
  Resource resource3=new ResourceImpl(Resource.Type.Service);
  Assert.assertEquals(0,comparator.compare(resource1,resource2));
  Assert.assertEquals(0,comparator.compare(resource2,resource1));
  Assert.assertTrue(comparator.compare(resource1,resource3) < 0);
  Assert.assertTrue(comparator.compare(resource3,resource1) > 0);
  resource1.setProperty(PropertyHelper.getPropertyId("Hosts","cluster_name"),"c1");
  resource1.setProperty(PropertyHelper.getPropertyId("Hosts","host_name"),"h1");
  resource2.setProperty(PropertyHelper.getPropertyId("Hosts","cluster_name"),"c1");
  resource2.setProperty(PropertyHelper.getPropertyId("Hosts","host_name"),"h1");
  Assert.assertEquals(0,comparator.compare(resource1,resource2));
  Assert.assertEquals(0,comparator.compare(resource2,resource1));
  resource2.setProperty(PropertyHelper.getPropertyId("Hosts","host_name"),"h2");
  Assert.assertTrue(comparator.compare(resource1,resource2) < 0);
  Assert.assertTrue(comparator.compare(resource2,resource1) > 0);
  resource2.setProperty(PropertyHelper.getPropertyId("Hosts","host_name"),"h1");
  resource1.setProperty("p1","foo");
  resource2.setProperty("p1","foo");
  Assert.assertEquals(0,comparator.compare(resource1,resource2));
  Assert.assertEquals(0,comparator.compare(resource2,resource1));
  resource2.setProperty("p1","bar");
  Assert.assertFalse(comparator.compare(resource1,resource2) == 0);
  Assert.assertFalse(comparator.compare(resource2,resource1) == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ComponentResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that ServiceComponentNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetComponents_OR_Predicate_ServiceComponentNotFoundException() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ComponentInfo component3Info=createNiceMock(ComponentInfo.class);
  ComponentInfo component4Info=createNiceMock(ComponentInfo.class);
  ServiceComponent component1=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponentResponse response1=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentResponse response2=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentRequest request1=new ServiceComponentRequest("cluster1","service1","component1",null);
  ServiceComponentRequest request2=new ServiceComponentRequest("cluster1","service1","component2",null);
  ServiceComponentRequest request3=new ServiceComponentRequest("cluster1","service1","component3",null);
  ServiceComponentRequest request4=new ServiceComponentRequest("cluster1","service1","component4",null);
  ServiceComponentRequest request5=new ServiceComponentRequest("cluster1","service2",null,null);
  Set<ServiceComponentRequest> setRequests=new HashSet<ServiceComponentRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  setRequests.add(request5);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(stackId.getStackName()).andReturn("stackName").anyTimes();
  expect(stackId.getStackVersion()).andReturn("1").anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stackId).anyTimes();
  expect(cluster.getService("service1")).andReturn(service).anyTimes();
  expect(cluster.getService("service2")).andThrow(new ObjectNotFoundException("service2"));
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component3")).andReturn(component3Info);
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component4")).andReturn(component4Info);
  expect(component3Info.getCategory()).andReturn(null);
  expect(component4Info.getCategory()).andReturn(null);
  expect(service.getName()).andReturn("service1").anyTimes();
  expect(service.getServiceComponent("component1")).andThrow(new ServiceComponentNotFoundException("cluster1","service1","component1"));
  expect(service.getServiceComponent("component2")).andThrow(new ServiceComponentNotFoundException("cluster1","service1","component2"));
  expect(service.getServiceComponent("component3")).andReturn(component1);
  expect(service.getServiceComponent("component4")).andReturn(component2);
  expect(component1.convertToResponse()).andReturn(response1);
  expect(component2.convertToResponse()).andReturn(response2);
  replay(clusters,cluster,service,component3Info,component4Info,component1,component2,response1,response2,ambariMetaInfo,stackId,managementController);
  Set<ServiceComponentResponse> setResponses=getComponentResourceProvider(managementController).getComponents(setRequests);
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(clusters,cluster,service,component3Info,component4Info,component1,component2,response1,response2,ambariMetaInfo,stackId,managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetComponents() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  AmbariMetaInfo ambariMetaInfo=createNiceMock(AmbariMetaInfo.class);
  StackId stackId=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ComponentInfo componentInfo=createNiceMock(ComponentInfo.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponentResponse response=createNiceMock(ServiceComponentResponse.class);
  ServiceComponentRequest request1=new ServiceComponentRequest("cluster1","service1","component1",null);
  Set<ServiceComponentRequest> setRequests=new HashSet<ServiceComponentRequest>();
  setRequests.add(request1);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(stackId.getStackName()).andReturn("stackName").anyTimes();
  expect(stackId.getStackVersion()).andReturn("1").anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster);
  expect(cluster.getService("service1")).andReturn(service);
  expect(cluster.getDesiredStackVersion()).andReturn(stackId).anyTimes();
  expect(service.getName()).andReturn("service1").anyTimes();
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(ambariMetaInfo.getComponent("stackName","1","service1","component1")).andReturn(componentInfo);
  expect(componentInfo.getCategory()).andReturn(null);
  expect(component.convertToResponse()).andReturn(response);
  replay(clusters,cluster,service,componentInfo,component,response,ambariMetaInfo,stackId,managementController);
  Set<ServiceComponentResponse> setResponses=getComponentResourceProvider(managementController).getComponents(setRequests);
  assertEquals(1,setResponses.size());
  assertTrue(setResponses.contains(response));
  verify(clusters,cluster,service,componentInfo,component,response,ambariMetaInfo,stackId,managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigGroupResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Host h1=createNiceMock(Host.class);
  Host h2=createNiceMock(Host.class);
  HostEntity hostEntity1=createMock(HostEntity.class);
  HostEntity hostEntity2=createMock(HostEntity.class);
  ConfigGroupFactory configGroupFactory=createNiceMock(ConfigGroupFactory.class);
  ConfigGroup configGroup=createNiceMock(ConfigGroup.class);
  expect(managementController.getClusters()).andReturn(clusters);
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getHost("h1")).andReturn(h1);
  expect(clusters.getHost("h2")).andReturn(h2);
  expect(managementController.getConfigGroupFactory()).andReturn(configGroupFactory);
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(hostDAO.findByName("h1")).andReturn(hostEntity1).atLeastOnce();
  expect(hostDAO.findByName("h2")).andReturn(hostEntity2).atLeastOnce();
  expect(hostEntity1.getHostId()).andReturn(1L).atLeastOnce();
  expect(hostEntity2.getHostId()).andReturn(2L).atLeastOnce();
  Capture<Cluster> clusterCapture=new Capture<Cluster>();
  Capture<String> captureName=new Capture<String>();
  Capture<String> captureDesc=new Capture<String>();
  Capture<String> captureTag=new Capture<String>();
  Capture<Map<String,Config>> captureConfigs=new Capture<Map<String,Config>>();
  Capture<Map<Long,Host>> captureHosts=new Capture<Map<Long,Host>>();
  expect(configGroupFactory.createNew(capture(clusterCapture),capture(captureName),capture(captureTag),capture(captureDesc),capture(captureConfigs),capture(captureHosts))).andReturn(configGroup);
  replay(managementController,clusters,cluster,configGroupFactory,configGroup,response,hostDAO,hostEntity1,hostEntity2);
  ResourceProvider provider=getConfigGroupResourceProvider(managementController);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> hostSet=new HashSet<Map<String,Object>>();
  Map<String,Object> host1=new HashMap<String,Object>();
  host1.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID,"h1");
  hostSet.add(host1);
  Map<String,Object> host2=new HashMap<String,Object>();
  host2.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID,"h2");
  hostSet.add(host2);
  Set<Map<String,Object>> configSet=new HashSet<Map<String,Object>>();
  Map<String,String> configMap=new HashMap<String,String>();
  Map<String,Object> configs=new HashMap<String,Object>();
  configs.put("type","core-site");
  configs.put("tag","version100");
  configMap.put("key1","value1");
  configs.put("properties",configMap);
  configSet.add(configs);
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID,"test-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID,"tag-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID,hostSet);
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CONFIGS_PROPERTY_ID,configSet);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  provider.createResources(request);
  verify(managementController,clusters,cluster,configGroupFactory,configGroup,response,hostDAO,hostEntity1,hostEntity2);
  assertEquals("version100",captureConfigs.getValue().get("core-site").getTag());
  assertTrue(captureHosts.getValue().containsKey(1L));
  assertTrue(captureHosts.getValue().containsKey(2L));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConfigGroupRequest_populatesConfigAttributes() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ConfigGroupResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  Set<Map<String,String>> desiredConfigProperties=new HashSet<Map<String,String>>();
  Map<String,String> desiredConfig1=new HashMap<String,String>();
  desiredConfig1.put("tag","version2");
  desiredConfig1.put("type","type1");
  desiredConfig1.put("properties/key1","value1");
  desiredConfig1.put("properties/key2","value2");
  desiredConfig1.put("properties_attributes/attr1/key1","true");
  desiredConfig1.put("properties_attributes/attr1/key2","false");
  desiredConfig1.put("properties_attributes/attr2/key1","15");
  desiredConfigProperties.add(desiredConfig1);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("ConfigGroup/hosts",new HashMap<String,String>(){
{
      put("host_name","ambari1");
    }
  }
);
  properties.put("ConfigGroup/cluster_name","c");
  properties.put("ConfigGroup/desired_configs",desiredConfigProperties);
  ConfigGroupRequest request=resourceProvider.getConfigGroupRequest(properties);
  assertNotNull(request);
  Map<String,Config> configMap=request.getConfigs();
  assertNotNull(configMap);
  assertEquals(1,configMap.size());
  assertTrue(configMap.containsKey("type1"));
  Config config=configMap.get("type1");
  assertEquals("type1",config.getType());
  Map<String,String> configProperties=config.getProperties();
  assertNotNull(configProperties);
  assertEquals(2,configProperties.size());
  assertEquals("value1",configProperties.get("key1"));
  assertEquals("value2",configProperties.get("key2"));
  Map<String,Map<String,String>> configAttributes=config.getPropertiesAttributes();
  assertNotNull(configAttributes);
  assertEquals(2,configAttributes.size());
  assertTrue(configAttributes.containsKey("attr1"));
  Map<String,String> attr1=configAttributes.get("attr1");
  assertNotNull(attr1);
  assertEquals(2,attr1.size());
  assertEquals("true",attr1.get("key1"));
  assertEquals("false",attr1.get("key2"));
  assertTrue(configAttributes.containsKey("attr2"));
  Map<String,String> attr2=configAttributes.get("attr2");
  assertNotNull(attr2);
  assertEquals(1,attr2.size());
  assertEquals("15",attr2.get("key1"));
}

</code></pre>

<br>
<pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateNameConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ConfigGroupFactory configGroupFactory=createNiceMock(ConfigGroupFactory.class);
  ConfigGroup configGroup=createNiceMock(ConfigGroup.class);
  Map<Long,ConfigGroup> configGroupMap=new HashMap<Long,ConfigGroup>();
  configGroupMap.put(1L,configGroup);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(managementController.getConfigGroupFactory()).andReturn(configGroupFactory).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(cluster.getConfigGroups()).andReturn(configGroupMap);
  expect(configGroupFactory.createNew((Cluster)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject(),(HashMap)anyObject(),(HashMap)anyObject())).andReturn(configGroup).anyTimes();
  expect(configGroup.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(configGroup.getName()).andReturn("test-1").anyTimes();
  expect(configGroup.getTag()).andReturn("tag-1").anyTimes();
  replay(managementController,clusters,cluster,configGroupFactory,configGroup,response);
  ResourceProvider provider=getConfigGroupResourceProvider(managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID,"test-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID,"tag-1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  Exception exception=null;
  try {
    provider.createResources(request);
  }
 catch (  Exception e) {
    exception=e;
  }
  verify(managementController,clusters,cluster,configGroupFactory,configGroup,response);
  assertNotNull(exception);
  assertTrue(exception instanceof ResourceAlreadyExistsException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Configuration;
  StackId stackId=new StackId("HDP","0.1");
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<ConfigurationResponse> allResponse=new HashSet<ConfigurationResponse>();
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag3",3L,null,null));
  Set<ConfigurationResponse> orResponse=new HashSet<ConfigurationResponse>();
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  Capture<Set<ConfigurationRequest>> configRequestCapture1=new Capture<Set<ConfigurationRequest>>();
  Capture<Set<ConfigurationRequest>> configRequestCapture2=new Capture<Set<ConfigurationRequest>>();
  expect(managementController.getConfigurations(capture(configRequestCapture1))).andReturn(allResponse).once();
  expect(managementController.getConfigurations(capture(configRequestCapture2))).andReturn(orResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Set<ConfigurationRequest> setRequest=configRequestCapture1.getValue();
  assertEquals(1,setRequest.size());
  ConfigurationRequest configRequest=setRequest.iterator().next();
  assertEquals("Cluster100",configRequest.getClusterName());
  assertNull(configRequest.getType());
  assertNull(configRequest.getVersionTag());
  Assert.assertEquals(3,resources.size());
  boolean containsResource1=false;
  boolean containsResource2=false;
  boolean containsResource3=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    String stackIdProperty=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_STACK_ID_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    Assert.assertEquals(stackId.getStackId(),stackIdProperty);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
 else     if (tag.equals("tag3")) {
      containsResource3=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  assertTrue(containsResource3);
  predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag1").or().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag2").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  resources=provider.getResources(request,predicate);
  setRequest=configRequestCapture2.getValue();
  assertEquals(2,setRequest.size());
  boolean containsTag1=false;
  boolean containsTag2=false;
  for (  ConfigurationRequest cr : setRequest) {
    assertNull(cr.getClusterName());
    if (cr.getVersionTag().equals("tag1")) {
      containsTag1=true;
    }
 else     if (cr.getVersionTag().equals("tag2")) {
      containsTag2=true;
    }
  }
  assertTrue(containsTag1);
  assertTrue(containsTag2);
  Assert.assertEquals(2,resources.size());
  containsResource1=false;
  containsResource2=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.CredentialResourceProviderTest </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  tmpFolder.create();
  final File masterKeyFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"secret"));
  injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.MASTER_KEY_LOCATION,tmpFolder.getRoot().getAbsolutePath());
      properties.setProperty(Configuration.MASTER_KEYSTORE_LOCATION,tmpFolder.getRoot().getAbsolutePath());
      bind(CredentialStoreService.class).to(CredentialStoreServiceImpl.class);
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(SecurePasswordHelper.class).toInstance(new SecurePasswordHelper());
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ExportBlueprintRequestTest </h4><pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExport_noConfigs() throws Exception {
  Resource clusterResource=new ResourceImpl(Resource.Type.Cluster);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_ID_PROPERTY_ID,CLUSTER_ID);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"TEST-1.0");
  TreeNode<Resource> clusterNode=new TreeNodeImpl<Resource>(null,clusterResource,"cluster");
  Resource configResource=new ResourceImpl(Resource.Type.Configuration);
  clusterNode.addChild(configResource,"configurations");
  Resource hostsResource=new ResourceImpl(Resource.Type.Host);
  Resource host1Resource=new ResourceImpl(Resource.Type.Host);
  Resource host2Resource=new ResourceImpl(Resource.Type.Host);
  Resource host3Resource=new ResourceImpl(Resource.Type.Host);
  TreeNode<Resource> hostsNode=clusterNode.addChild(hostsResource,"hosts");
  TreeNode<Resource> host1Node=hostsNode.addChild(host1Resource,"host_1");
  TreeNode<Resource> host2Node=hostsNode.addChild(host2Resource,"host_2");
  TreeNode<Resource> host3Node=hostsNode.addChild(host3Resource,"host_3");
  host1Resource.setProperty("Hosts/host_name","host1");
  host2Resource.setProperty("Hosts/host_name","host2");
  host3Resource.setProperty("Hosts/host_name","host3");
  List<String> host1ComponentsList=Arrays.asList("NAMENODE","HDFS_CLIENT","ZOOKEEPER_SERVER","SECONDARY_NAMENODE");
  List<String> host2ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  List<String> host3ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  processHostGroupComponents(host1Node,host1ComponentsList);
  processHostGroupComponents(host2Node,host2ComponentsList);
  processHostGroupComponents(host3Node,host3ComponentsList);
  ExportBlueprintRequest exportBlueprintRequest=new ExportBlueprintRequest(clusterNode);
  assertEquals(CLUSTER_NAME,exportBlueprintRequest.getClusterName());
  Blueprint bp=exportBlueprintRequest.getBlueprint();
  assertEquals("exported-blueprint",bp.getName());
  Map<String,HostGroup> hostGroups=bp.getHostGroups();
  assertEquals(2,hostGroups.size());
  String hg1Name=null;
  String hg2Name=null;
  for (  HostGroup group : hostGroups.values()) {
    Collection<String> components=group.getComponentNames();
    if (components.containsAll(host1ComponentsList)) {
      assertEquals(host1ComponentsList.size(),components.size());
      assertEquals("1",group.getCardinality());
      hg1Name=group.getName();
    }
 else     if (components.containsAll(host2ComponentsList)) {
      assertEquals(host2ComponentsList.size(),components.size());
      assertEquals("2",group.getCardinality());
      hg2Name=group.getName();
    }
 else {
      fail("Host group contained invalid components");
    }
  }
  assertNotNull(hg1Name);
  assertNotNull(hg2Name);
  HostGroupInfo host1Info=exportBlueprintRequest.getHostGroupInfo().get(hg1Name);
  assertEquals(1,host1Info.getHostNames().size());
  assertEquals("host1",host1Info.getHostNames().iterator().next());
  HostGroupInfo host2Info=exportBlueprintRequest.getHostGroupInfo().get(hg2Name);
  assertEquals(2,host2Info.getHostNames().size());
  assertTrue(host2Info.getHostNames().contains("host2") && host2Info.getHostNames().contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostComponentResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckPropertyIds() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Injector injector=createNiceMock(Injector.class);
  HostComponentResourceProvider provider=new HostComponentResourceProvider(propertyIds,keyPropertyIds,managementController,injector);
  Set<String> unsupported=provider.checkPropertyIds(Collections.singleton("foo"));
  Assert.assertTrue(unsupported.isEmpty());
  Assert.assertTrue(provider.checkPropertyIds(Collections.singleton("cat5/subcat5/map/key")).isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("bar"));
  Assert.assertEquals(1,unsupported.size());
  Assert.assertTrue(unsupported.contains("bar"));
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1/foo"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("config"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("config/unknown_property"));
  Assert.assertTrue(unsupported.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that HostNotFoundException is handled where there are multiple requests as would be the
 * case when an OR predicate is provided in the query.
 */
@Test public void testGetHosts___OR_Predicate_HostNotFoundException() throws Exception {
  Injector injector=createInjector();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  Host host1=createNiceMock(Host.class);
  Host host2=createNiceMock(Host.class);
  HostResponse response=createNiceMock(HostResponse.class);
  HostResponse response2=createNiceMock(HostResponse.class);
  HostRequest request1=new HostRequest("host1","cluster1",Collections.<String,String>emptyMap());
  HostRequest request2=new HostRequest("host2","cluster1",Collections.<String,String>emptyMap());
  HostRequest request3=new HostRequest("host3","cluster1",Collections.<String,String>emptyMap());
  HostRequest request4=new HostRequest("host4","cluster1",Collections.<String,String>emptyMap());
  Set<HostRequest> setRequests=new HashSet<HostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  setRequests.add(request4);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(4);
  expect(clusters.getHost("host1")).andReturn(host1);
  expect(host1.getHostName()).andReturn("host1").anyTimes();
  expect(clusters.getClustersForHost("host1")).andReturn(Collections.singleton(cluster));
  expect(host1.convertToResponse()).andReturn(response);
  response.setClusterName("cluster1");
  expect(clusters.getHost("host2")).andReturn(host2);
  expect(host2.getHostName()).andReturn("host2").anyTimes();
  expect(clusters.getClustersForHost("host2")).andReturn(Collections.singleton(cluster));
  expect(host2.convertToResponse()).andReturn(response2);
  response2.setClusterName("cluster1");
  expect(clusters.getHost("host3")).andThrow(new HostNotFoundException("host3"));
  expect(clusters.getHost("host4")).andThrow(new HostNotFoundException("host4"));
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<HostResponse> setResponses=getHosts(managementController,setRequests);
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response));
  assertTrue(setResponses.contains(response2));
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HttpPropertyProviderTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testReadResourceManager() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(false);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Injector injector=createNiceMock(Injector.class);
  Config config1=createNiceMock(Config.class);
  Config config2=createNiceMock(Config.class);
  Map<String,String> map=new HashMap<String,String>();
  map.put("yarn.http.policy","HTTPS_ONLY");
  map.put("yarn.resourcemanager.webapp.https.address","ec2-54-234-33-50.compute-1.amazonaws.com:8999");
  map.put("yarn.resourcemanager.webapp.address","ec2-54-234-33-50.compute-1.amazonaws.com:8088");
  expect(injector.getInstance(Clusters.class)).andReturn(clusters);
  expect(clusters.getCluster("testCluster")).andReturn(cluster);
  expect(cluster.getDesiredConfigByType("yarn-site")).andReturn(config1).anyTimes();
  expect(cluster.getDesiredConfigByType("core-site")).andReturn(config2).anyTimes();
  expect(config1.getProperties()).andReturn(map).anyTimes();
  expect(config2.getProperties()).andReturn(new HashMap<String,String>()).anyTimes();
  replay(injector,clusters,cluster,config1,config2);
  HttpProxyPropertyProvider propProvider=new HttpProxyPropertyProvider(streamProvider,configuration,injector,PROPERTY_ID_CLUSTER_NAME,PROPERTY_ID_HOST_NAME,PROPERTY_ID_COMPONENT_NAME);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(PROPERTY_ID_HOST_NAME,"ec2-54-234-33-50.compute-1.amazonaws.com");
  resource.setProperty(PROPERTY_ID_CLUSTER_NAME,"testCluster");
  resource.setProperty(PROPERTY_ID_COMPONENT_NAME,"RESOURCEMANAGER");
  Request request=PropertyHelper.getReadRequest(Collections.<String>emptySet());
  propProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertTrue(resource.getPropertiesMap().get("HostRoles").get("ha_state").equals("ACTIVE"));
  Assert.assertTrue(streamProvider.getLastSpec().equals("https://ec2-54-234-33-50.compute-1.amazonaws.com:8999" + "/ws/v1/cluster/info"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testReadResourceManagerHA() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(false);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Injector injector=createNiceMock(Injector.class);
  Config config1=createNiceMock(Config.class);
  Config config2=createNiceMock(Config.class);
  Map<String,String> map=new HashMap<String,String>();
  map.put("yarn.http.policy","HTTPS_ONLY");
  map.put("yarn.resourcemanager.ha.rm-ids","rm1,rm2");
  map.put("yarn.resourcemanager.hostname.rm1","lc6402.ambari.apache.org");
  map.put("yarn.resourcemanager.hostname.rm2","lc6403.ambari.apache.org");
  map.put("yarn.resourcemanager.webapp.address.rm1","lc6402.ambari.apache.org:8099");
  map.put("yarn.resourcemanager.webapp.address.rm2","lc6403.ambari.apache.org:8099");
  map.put("yarn.resourcemanager.webapp.https.address.rm1","lc6402.ambari.apache.org:8066");
  map.put("yarn.resourcemanager.webapp.https.address.rm2","lc6403.ambari.apache.org:8066");
  expect(injector.getInstance(Clusters.class)).andReturn(clusters);
  expect(clusters.getCluster("testCluster")).andReturn(cluster);
  expect(cluster.getDesiredConfigByType("yarn-site")).andReturn(config1).anyTimes();
  expect(cluster.getDesiredConfigByType("core-site")).andReturn(config2).anyTimes();
  expect(config1.getProperties()).andReturn(map).anyTimes();
  expect(config2.getProperties()).andReturn(new HashMap<String,String>()).anyTimes();
  replay(injector,clusters,cluster,config1,config2);
  HttpProxyPropertyProvider propProvider=new HttpProxyPropertyProvider(streamProvider,configuration,injector,PROPERTY_ID_CLUSTER_NAME,PROPERTY_ID_HOST_NAME,PROPERTY_ID_COMPONENT_NAME);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(PROPERTY_ID_HOST_NAME,"lc6402.ambari.apache.org");
  resource.setProperty(PROPERTY_ID_CLUSTER_NAME,"testCluster");
  resource.setProperty(PROPERTY_ID_COMPONENT_NAME,"RESOURCEMANAGER");
  Request request=PropertyHelper.getReadRequest(Collections.<String>emptySet());
  propProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertTrue(resource.getPropertiesMap().get("HostRoles").get("ha_state").equals("ACTIVE"));
  Assert.assertTrue(streamProvider.getLastSpec().equals("https://lc6402.ambari.apache.org:8066" + "/ws/v1/cluster/info"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.JMXHostProviderTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetHostNames() throws AmbariException {
  JMXHostProviderModule providerModule=new JMXHostProviderModule();
  AmbariManagementController managementControllerMock=createNiceMock(AmbariManagementController.class);
  Clusters clustersMock=createNiceMock(Clusters.class);
  Cluster clusterMock=createNiceMock(Cluster.class);
  Service serviceMock=createNiceMock(Service.class);
  ServiceComponent serviceComponentMock=createNiceMock(ServiceComponent.class);
  Map<String,ServiceComponentHost> hostComponents=new HashMap<String,ServiceComponentHost>();
  hostComponents.put("host1",null);
  expect(managementControllerMock.getClusters()).andReturn(clustersMock).anyTimes();
  expect(managementControllerMock.findServiceName(clusterMock,"DATANODE")).andReturn("HDFS");
  expect(clustersMock.getCluster("c1")).andReturn(clusterMock).anyTimes();
  expect(clusterMock.getService("HDFS")).andReturn(serviceMock).anyTimes();
  expect(serviceMock.getServiceComponent("DATANODE")).andReturn(serviceComponentMock).anyTimes();
  expect(serviceComponentMock.getServiceComponentHosts()).andReturn(hostComponents).anyTimes();
  replay(managementControllerMock,clustersMock,clusterMock,serviceMock,serviceComponentMock);
  providerModule.managementController=managementControllerMock;
  Set<String> result=providerModule.getHostNames("c1","DATANODE");
  Assert.assertTrue(result.iterator().next().equals("host1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.JobResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createJobResponse("Cluster100","workflow1","job1"));
  expected.add(createJobResponse("Cluster100","workflow2","job2"));
  expected.add(createJobResponse("Cluster100","workflow2","job3"));
  Resource.Type type=Resource.Type.Job;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  JobFetcher jobFetcher=createMock(JobFetcher.class);
  expect(jobFetcher.fetchJobDetails(propertyIds,null,"workflow2",null)).andReturn(expected).once();
  replay(jobFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new JobResourceProvider(propertyIds,keyPropertyIds,jobFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(JobResourceProvider.JOB_WORKFLOW_ID_PROPERTY_ID).equals("workflow2").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(JobResourceProvider.JOB_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(JobResourceProvider.JOB_ID_PROPERTY_ID)));
  }
  verify(jobFetcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.PropertyPredicateVisitorTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisit(){
  PropertyPredicateVisitor visitor=new PropertyPredicateVisitor();
  PredicateHelper.visit(PREDICATE_1,visitor);
  Map<String,Object> properties=visitor.getProperties();
  Assert.assertEquals(1,properties.size());
  Assert.assertEquals("Monkey",properties.get(PROPERTY_A));
  visitor=new PropertyPredicateVisitor();
  PredicateHelper.visit(PREDICATE_3,visitor);
  properties=visitor.getProperties();
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("Monkey",properties.get(PROPERTY_A));
  Assert.assertEquals("Runner",properties.get(PROPERTY_B));
  visitor=new PropertyPredicateVisitor();
  PredicateHelper.visit(PREDICATE_4,visitor);
  properties=visitor.getProperties();
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("Monkey",properties.get(PROPERTY_A));
  Assert.assertEquals("Runner",properties.get(PROPERTY_B));
  visitor=new PropertyPredicateVisitor();
  PredicateHelper.visit(PREDICATE_5,visitor);
  properties=visitor.getProperties();
  Assert.assertTrue(properties.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ProvisionClusterRequestTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleGroups() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(2,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNotNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostCountSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesCountOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostNameSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesNameOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.QueryResponseImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsPagedResponse() throws Exception {
  Set<Resource> resources=new HashSet<Resource>();
  resources.add(new ResourceImpl(Resource.Type.Stage));
  QueryResponse queryResponse=new QueryResponseImpl(resources);
  Assert.assertFalse(queryResponse.isPagedResponse());
  queryResponse=new QueryResponseImpl(resources,true,false,0);
  Assert.assertFalse(queryResponse.isPagedResponse());
  queryResponse=new QueryResponseImpl(resources,true,true,0);
  Assert.assertTrue(queryResponse.isPagedResponse());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsSortedResponse() throws Exception {
  Set<Resource> resources=new HashSet<Resource>();
  resources.add(new ResourceImpl(Resource.Type.Stage));
  QueryResponse queryResponse=new QueryResponseImpl(resources);
  Assert.assertFalse(queryResponse.isSortedResponse());
  queryResponse=new QueryResponseImpl(resources,false,true,0);
  Assert.assertFalse(queryResponse.isSortedResponse());
  queryResponse=new QueryResponseImpl(resources,true,true,0);
  Assert.assertTrue(queryResponse.isSortedResponse());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestImplTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidPropertyIds(){
  Request request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.HostComponent));
  Set<String> validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("HostRoles/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("params/run_smoke_test"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/actual_configs"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/desired_stack_id"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/stack_id"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/desired_state"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/state"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/component_name"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/host_name"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("HostRoles/role_id"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Cluster));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Clusters/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Clusters/cluster_id"));
  Assert.assertTrue(validPropertyIds.contains("Clusters/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("Clusters/version"));
  Assert.assertTrue(validPropertyIds.contains("Clusters/state"));
  Assert.assertTrue(validPropertyIds.contains("Clusters/desired_configs"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Service));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("ServiceInfo/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("ServiceInfo/service_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceInfo/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceInfo/state"));
  Assert.assertTrue(validPropertyIds.contains("Services/description"));
  Assert.assertTrue(validPropertyIds.contains("Services/display_name"));
  Assert.assertTrue(validPropertyIds.contains("Services/attributes"));
  Assert.assertTrue(validPropertyIds.contains("params/run_smoke_test"));
  Assert.assertTrue(validPropertyIds.contains("params/reconfigure_client"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Host));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Hosts/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/host_name"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/ip"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/attributes"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/total_mem"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/cpu_count"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/ph_cpu_count"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/os_arch"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/os_type"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/rack_info"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/last_heartbeat_time"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/last_agent_env"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/last_registration_time"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/disk_info"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/host_status"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/host_health_report"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/public_host_name"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/host_state"));
  Assert.assertTrue(validPropertyIds.contains("Hosts/desired_configs"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Component));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("ServiceComponentInfo/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponentInfo/service_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponentInfo/component_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponentInfo/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponentInfo/state"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponents/display_name"));
  Assert.assertTrue(validPropertyIds.contains("ServiceComponents/description"));
  Assert.assertTrue(validPropertyIds.contains("params/run_smoke_test"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Action));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Action/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Actions/action_name"));
  Assert.assertTrue(validPropertyIds.contains("Actions/action_type"));
  Assert.assertTrue(validPropertyIds.contains("Actions/inputs"));
  Assert.assertTrue(validPropertyIds.contains("Actions/target_service"));
  Assert.assertTrue(validPropertyIds.contains("Actions/target_component"));
  Assert.assertTrue(validPropertyIds.contains("Actions/description"));
  Assert.assertTrue(validPropertyIds.contains("Actions/target_type"));
  Assert.assertTrue(validPropertyIds.contains("Actions/default_timeout"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Request));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Requests/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Requests/id"));
  Assert.assertTrue(validPropertyIds.contains("Requests/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("Requests/request_status"));
  Assert.assertTrue(validPropertyIds.contains("Requests/request_context"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Task));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Task/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/id"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/request_id"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/cluster_name"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/stage_id"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/host_name"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/command"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/role"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/status"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/exit_code"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/stderr"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/stdout"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/start_time"));
  Assert.assertTrue(validPropertyIds.contains("Tasks/attempt_cnt"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.User));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Users/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Users/user_name"));
  Assert.assertTrue(validPropertyIds.contains("Users/password"));
  Assert.assertTrue(validPropertyIds.contains("Users/old_password"));
  Assert.assertTrue(validPropertyIds.contains("Users/ldap_user"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.Stack));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Stacks/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Stacks/stack_name"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.StackVersion));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Versions/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Versions/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("Versions/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("Versions/min_upgrade_version"));
  request=PropertyHelper.getReadRequest(OperatingSystemResourceProvider.propertyIds);
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("OperatingSystems/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("OperatingSystems/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("OperatingSystems/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("OperatingSystems/os_type"));
  request=PropertyHelper.getReadRequest(RepositoryResourceProvider.propertyIds);
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("Repositories/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/os_type"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/base_url"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/repo_id"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/repo_name"));
  Assert.assertTrue(validPropertyIds.contains("Repositories/mirrors_list"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.StackService));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("StackServices/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/service_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/user_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/comments"));
  Assert.assertTrue(validPropertyIds.contains("StackServices/service_version"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.StackConfiguration));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("StackConfigurations/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/service_name"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/property_name"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/property_description"));
  Assert.assertTrue(validPropertyIds.contains("StackConfigurations/property_value"));
  request=PropertyHelper.getReadRequest(PropertyHelper.getPropertyIds(Resource.Type.StackServiceComponent));
  validPropertyIds=request.getPropertyIds();
  Assert.assertFalse(validPropertyIds.contains("StackServiceComponents/unsupported_property_id"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/stack_version"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/stack_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/service_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/component_name"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/component_category"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/is_master"));
  Assert.assertTrue(validPropertyIds.contains("StackServiceComponents/is_client"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesForNonCluster() throws Exception {
  Resource.Type type=Resource.Type.Request;
  Capture<ExecuteActionRequest> actionRequest=newCapture();
  Capture<HashMap<String,String>> propertyMap=newCapture();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  expect(managementController.createAction(capture(actionRequest),capture(propertyMap))).andReturn(response).anyTimes();
  expect(response.getMessage()).andReturn("Message").anyTimes();
  replay(managementController,response);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> filterSet=new HashSet<Map<String,Object>>();
  Map<String,Object> filterMap=new HashMap<String,Object>();
  filterMap.put(RequestResourceProvider.HOSTS_ID,"h1,h2");
  filterSet.add(filterMap);
  properties.put(RequestResourceProvider.REQUEST_RESOURCE_FILTER_ID,filterSet);
  propertySet.add(properties);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.ACTION_ID,"check_java");
  Request request=PropertyHelper.getCreateRequest(propertySet,requestInfoProperties);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  provider.createResources(request);
  ExecuteActionRequest capturedRequest=actionRequest.getValue();
  Assert.assertTrue(actionRequest.hasCaptured());
  Assert.assertFalse("expected an action",capturedRequest.isCommand());
  Assert.assertEquals("check_java",capturedRequest.getActionName());
  Assert.assertEquals(null,capturedRequest.getCommandName());
  Assert.assertNotNull(capturedRequest.getResourceFilters());
  Assert.assertEquals(1,capturedRequest.getResourceFilters().size());
  RequestResourceFilter capturedResourceFilter=capturedRequest.getResourceFilters().get(0);
  Assert.assertEquals(null,capturedResourceFilter.getServiceName());
  Assert.assertEquals(null,capturedResourceFilter.getComponentName());
  Assert.assertNotNull(capturedResourceFilter.getHostNames());
  Assert.assertEquals(2,capturedResourceFilter.getHostNames().size());
  Assert.assertEquals(0,actionRequest.getValue().getParameters().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesCompleted() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().completed(2));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals("COMPLETED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
    Assert.assertEquals(100.0,resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesInProgress() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=new Capture<Collection<Long>>();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts(100L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1).pending(1));
    }
  }
).once();
  expect(hrcDAO.findAggregateCounts(101L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1).queued(1));
    }
  }
).once();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
    if (id == 100L) {
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID));
      int progressPercent=((Double)resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID)).intValue();
      Assert.assertEquals(17,progressPercent);
    }
 else {
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_QUEUED_TASK_CNT_ID));
      int progressPercent=((Double)resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID)).intValue();
      Assert.assertEquals(21,progressPercent);
    }
    Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesFailed() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock0=createNiceMock(RequestEntity.class);
  expect(requestMock0.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock0.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=new Capture<Collection<Long>>();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock0));
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock1));
  expect(hrcDAO.findAggregateCounts(100L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().failed(1).completed(1));
    }
  }
).once();
  expect(hrcDAO.findAggregateCounts(101L)).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().aborted(1).timedout(1));
    }
  }
).once();
  replay(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_TASK_CNT_ID));
    if (id == 100L) {
      Assert.assertEquals("FAILED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID));
    }
 else {
      Assert.assertEquals("ABORTED",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
      Assert.assertEquals(0,resource.getPropertyValue(RequestResourceProvider.REQUEST_FAILED_TASK_CNT_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_ABORTED_TASK_CNT_ID));
      Assert.assertEquals(1,resource.getPropertyValue(RequestResourceProvider.REQUEST_TIMED_OUT_TASK_CNT_ID));
    }
    Assert.assertEquals(2,resource.getPropertyValue(RequestResourceProvider.REQUEST_COMPLETED_TASK_CNT_ID));
    Assert.assertEquals(100.0,resource.getPropertyValue(RequestResourceProvider.REQUEST_PROGRESS_PERCENT_ID));
  }
  verify(managementController,actionManager,requestMock0,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesForCommandWithHostPredicate() throws Exception {
  Resource.Type type=Resource.Type.Request;
  Capture<ExecuteActionRequest> actionRequest=new Capture<ExecuteActionRequest>();
  Capture<HashMap<String,String>> propertyMap=new Capture<HashMap<String,String>>();
  Capture<Request> requestCapture=new Capture<>();
  Capture<Predicate> predicateCapture=new Capture<>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  expect(managementController.createAction(capture(actionRequest),capture(propertyMap))).andReturn(response).anyTimes();
  expect(response.getMessage()).andReturn("Message").anyTimes();
  expect(managementController.getClusters()).andReturn(clusters);
  ClusterControllerImpl controller=createNiceMock(ClusterControllerImpl.class);
  HostComponentProcessResourceProvider hostComponentProcessResourceProvider=createNiceMock(HostComponentProcessResourceProvider.class);
  PowerMock.mockStatic(ClusterControllerHelper.class);
  Resource resource=createNiceMock(Resource.class);
  expect(ClusterControllerHelper.getClusterController()).andReturn(controller);
  expect(controller.ensureResourceProvider(Resource.Type.HostComponent)).andReturn(hostComponentProcessResourceProvider);
  expect(hostComponentProcessResourceProvider.getResources(capture(requestCapture),capture(predicateCapture))).andReturn(Collections.singleton(resource));
  replay(managementController,response,controller,hostComponentProcessResourceProvider,resource,clusters);
  PowerMock.replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID,"c1");
  Set<Map<String,Object>> filterSet=new HashSet<Map<String,Object>>();
  String predicateProperty=HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID + "=true";
  Map<String,Object> filterMap=new HashMap<String,Object>();
  filterMap.put(RequestResourceProvider.HOSTS_PREDICATE,predicateProperty);
  filterSet.add(filterMap);
  properties.put(RequestResourceProvider.REQUEST_RESOURCE_FILTER_ID,filterSet);
  propertySet.add(properties);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.COMMAND_ID,"RESTART");
  requestInfoProperties.put(RequestResourceProvider.REQUEST_CONTEXT_ID,"Restart All with Stale Configs");
  Request request=PropertyHelper.getCreateRequest(propertySet,requestInfoProperties);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  provider.createResources(request);
  ExecuteActionRequest capturedRequest=actionRequest.getValue();
  Assert.assertTrue(requestCapture.hasCaptured());
  Assert.assertTrue(predicateCapture.hasCaptured());
  Map<String,Object> predicateProperties=PredicateHelper.getProperties(predicateCapture.getValue());
  String propertyIdToAssert=null;
  Object propertyValueToAssert=null;
  for (  Map.Entry<String,Object> predicateEntry : predicateProperties.entrySet()) {
    if (predicateEntry.getKey().equals(HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID)) {
      propertyIdToAssert=predicateEntry.getKey();
      propertyValueToAssert=predicateEntry.getValue();
    }
  }
  Assert.assertNotNull(propertyIdToAssert);
  Assert.assertEquals("true",(String)propertyValueToAssert);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesOrPredicate() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  RequestEntity requestMock1=createNiceMock(RequestEntity.class);
  expect(requestMock1.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock1.getRequestId()).andReturn(101L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Arrays.asList(requestMock,requestMock1)).anyTimes();
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,requestMock,requestMock1,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").or().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("101").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  for (  Resource resource : resources) {
    long id=(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
    Assert.assertTrue(id == 100L || id == 101L);
  }
  verify(managementController,actionManager,requestMock,requestMock1,requestDAO,hrcDAO);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestStageContainerTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAddStages(){
  RequestStageContainer requestStages=new RequestStageContainer(500L,null,null,null);
  assertTrue(requestStages.getStages().isEmpty());
  Stage stage=createNiceMock(Stage.class);
  requestStages.addStages(Collections.singletonList(stage));
  assertEquals(1,requestStages.getStages().size());
  assertTrue(requestStages.getStages().contains(stage));
  Stage stage2=createNiceMock(Stage.class);
  Stage stage3=createNiceMock(Stage.class);
  List<Stage> listStages=new ArrayList<Stage>();
  listStages.add(stage2);
  listStages.add(stage3);
  requestStages.addStages(listStages);
  assertEquals(3,requestStages.getStages().size());
  listStages=requestStages.getStages();
  assertEquals(stage,listStages.get(0));
  assertEquals(stage2,listStages.get(1));
  assertEquals(stage3,listStages.get(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ResourceImplTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAddCategory(){
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.addCategory("c1");
  resource.addCategory("c2/sub2");
  resource.addCategory("c3/sub3/sub3a");
  Assert.assertTrue(resource.getPropertiesMap().containsKey("c1"));
  Assert.assertTrue(resource.getPropertiesMap().containsKey("c2/sub2"));
  Assert.assertTrue(resource.getPropertiesMap().containsKey("c3/sub3/sub3a"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEquals(){
  Resource resource1=new ResourceImpl(Resource.Type.Cluster);
  Resource resource2=new ResourceImpl(Resource.Type.Cluster);
  Resource resource3=new ResourceImpl(Resource.Type.Host);
  Assert.assertTrue(resource1.equals(resource2));
  Assert.assertTrue(resource2.equals(resource1));
  Assert.assertFalse(resource1.equals(resource3));
  Assert.assertFalse(resource3.equals(resource1));
  Assert.assertFalse(resource2.equals(resource3));
  Assert.assertFalse(resource3.equals(resource2));
  resource1.setProperty("p1","foo");
  resource2.setProperty("p1","bar");
  Assert.assertFalse(resource1.equals(resource2));
  Assert.assertFalse(resource2.equals(resource1));
  resource2.setProperty("p1","foo");
  Assert.assertTrue(resource1.equals(resource2));
  Assert.assertTrue(resource2.equals(resource1));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertiesMap(){
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  String p1=PropertyHelper.getPropertyId(null,"p1");
  String p2=PropertyHelper.getPropertyId("c1","p2");
  String p3=PropertyHelper.getPropertyId("c1/c2","p3");
  String p4=PropertyHelper.getPropertyId("c1/c2/c3","p4");
  String p5=PropertyHelper.getPropertyId("c1","p5");
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,1);
  resource.setProperty(p3,(float)1.99);
  resource.setProperty(p4,1.99);
  resource.setProperty(p5,65L);
  Map<String,Map<String,Object>> map=resource.getPropertiesMap();
  Assert.assertEquals(4,map.keySet().size());
  Assert.assertTrue(map.containsKey(""));
  Assert.assertTrue(map.containsKey("c1"));
  Assert.assertTrue(map.containsKey("c1/c2"));
  Assert.assertTrue(map.containsKey("c1/c2/c3"));
  String lastCategory=null;
  for (  Map.Entry<String,Map<String,Object>> entry : map.entrySet()) {
    String category=entry.getKey();
    if (lastCategory != null) {
      Assert.assertTrue(category.compareTo(lastCategory) > 0);
    }
    lastCategory=category;
    String lastProperty=null;
    for (    String property : entry.getValue().keySet()) {
      if (lastProperty != null) {
        Assert.assertTrue(property.compareTo(lastProperty) > 0);
      }
      lastProperty=property;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RootServiceComponentResourceProviderTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.RootServiceComponent;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<RootServiceComponentResponse> allResponse=new HashSet<RootServiceComponentResponse>();
  allResponse.add(new RootServiceComponentResponse("component1","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component2","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component3","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse(RootServiceResponseFactory.Components.AMBARI_SERVER.name(),"1.1.1",Collections.<String,String>emptyMap()));
  Set<RootServiceComponentResponse> nameResponse=new HashSet<RootServiceComponentResponse>();
  nameResponse.add(new RootServiceComponentResponse("component4","1.1.1",Collections.<String,String>emptyMap()));
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(allResponse).once();
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(nameResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RootServiceComponentResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String componentName=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
    String componentVersion=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
    Long server_clock=(Long)resource.getPropertyValue(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
    if (componentName.equals(RootServiceResponseFactory.Components.AMBARI_SERVER.name())) {
      Assert.assertNotNull(server_clock);
    }
 else {
      Assert.assertNull(server_clock);
    }
    Assert.assertTrue(allResponse.contains(new RootServiceComponentResponse(componentName,componentVersion,Collections.<String,String>emptyMap())));
  }
  Predicate predicate=new PredicateBuilder().property(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID).equals("component4").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("component4",resources.iterator().next().getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RootServiceResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.RootService;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<RootServiceResponse> allResponse=new HashSet<RootServiceResponse>();
  allResponse.add(new RootServiceResponse("service1"));
  allResponse.add(new RootServiceResponse("service2"));
  allResponse.add(new RootServiceResponse("service3"));
  Set<RootServiceResponse> nameResponse=new HashSet<RootServiceResponse>();
  nameResponse.add(new RootServiceResponse("service4"));
  expect(managementController.getRootServices(EasyMock.<Set<RootServiceRequest>>anyObject())).andReturn(allResponse).once();
  expect(managementController.getRootServices(EasyMock.<Set<RootServiceRequest>>anyObject())).andReturn(nameResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String serviceName=(String)resource.getPropertyValue(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID);
    Assert.assertTrue(allResponse.contains(new RootServiceResponse(serviceName)));
  }
  Predicate predicate=new PredicateBuilder().property(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID).equals("service4").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("service4",resources.iterator().next().getPropertyValue(RootServiceResourceProvider.SERVICE_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ScaleClusterRequestTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostNames() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName2(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"2"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(2,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertTrue(group1Info.getHostNames().contains(HOST2_NAME));
  assertEquals(2,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostName() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostGroups() throws Exception {
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostCountAndPredicate(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostCount(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"3"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(3,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP2_NAME);
  assertEquals(GROUP2_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(1,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  HostGroupInfo group3Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group3Info.getHostGroupName());
  assertEquals(0,group3Info.getHostNames().size());
  assertEquals(1,group3Info.getRequestedHostCount());
  assertEquals(PREDICATE,group3Info.getPredicateString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ServiceResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckPropertyIds() throws Exception {
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/subcat5/map");
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  MaintenanceStateHelper maintenanceStateHelperMock=createNiceMock(MaintenanceStateHelper.class);
  AbstractResourceProvider provider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelperMock);
  Set<String> unsupported=provider.checkPropertyIds(Collections.singleton("foo"));
  Assert.assertTrue(unsupported.isEmpty());
  Assert.assertTrue(provider.checkPropertyIds(Collections.singleton("cat5/subcat5/map/key")).isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("bar"));
  Assert.assertEquals(1,unsupported.size());
  Assert.assertTrue(unsupported.contains("bar"));
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1/foo"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("cat1"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("config"));
  Assert.assertTrue(unsupported.isEmpty());
  unsupported=provider.checkPropertyIds(Collections.singleton("config/unknown_property"));
  Assert.assertTrue(unsupported.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackAdvisorResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCalculateConfigurationsWithNullPropertyValues() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.emptySet();
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  RecommendationResourceProvider provider=new RecommendationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController);
  Request request=mock(Request.class);
  Set<Map<String,Object>> propertiesSet=new HashSet<Map<String,Object>>();
  Map<String,Object> propertiesMap=new HashMap<String,Object>();
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/string_prop",null);
  List array=new ArrayList();
  array.add("array1");
  array.add("array2");
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/array_prop",array);
  propertiesSet.add(propertiesMap);
  doReturn(propertiesSet).when(request).getProperties();
  Map<String,Map<String,Map<String,String>>> calculatedConfigurations=provider.calculateConfigurations(request);
  assertNotNull(calculatedConfigurations);
  assertEquals(1,calculatedConfigurations.size());
  Map<String,Map<String,String>> site=calculatedConfigurations.get("site");
  assertNotNull(site);
  assertEquals(1,site.size());
  Map<String,String> properties=site.get("properties");
  assertNotNull(properties);
  assertEquals("[array1, array2]",properties.get("array_prop"));
  assertFalse(properties.containsKey("string_prop"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackArtifactResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricsDescriptorForService() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  replay(managementController);
  StackArtifactResourceProvider resourceProvider=getStackArtifactResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ARTIFACT_NAME_PROPERTY_ID);
  propertyIds.add(STACK_NAME_PROPERTY_ID);
  propertyIds.add(STACK_VERSION_PROPERTY_ID);
  propertyIds.add(STACK_SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(ARTIFACT_DATA_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(ARTIFACT_NAME_PROPERTY_ID).equals("metrics_descriptor").and().property(STACK_NAME_PROPERTY_ID).equals("OTHER").and().property(STACK_VERSION_PROPERTY_ID).equals("1.0").and().property(STACK_SERVICE_NAME_PROPERTY_ID).equals("HDFS").toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Map<String,Map<String,Object>> propertyMap=resource.getPropertiesMap();
  Map<String,Object> descriptor=propertyMap.get(ARTIFACT_DATA_PROPERTY_ID + "/HDFS/DATANODE");
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(1,((ArrayList)descriptor.get("Component")).size());
  MetricDefinition md=(MetricDefinition)((ArrayList)descriptor.get("Component")).iterator().next();
  Metric m1=md.getMetrics().get("metrics/dfs/datanode/heartBeats_avg_time");
  Metric m2=md.getMetrics().get("metrics/rpc/closeRegion_num_ops");
  Assert.assertEquals(326,md.getMetrics().size());
  Assert.assertTrue(m1.isAmsHostMetric());
  Assert.assertEquals("unitless",m1.getUnit());
  Assert.assertFalse(m2.isAmsHostMetric());
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Stack;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackResponse> allResponse=new HashSet<StackResponse>();
  allResponse.add(new StackResponse("Stack1"));
  allResponse.add(new StackResponse("Stack2"));
  expect(managementController.getStacks(EasyMock.<Set<StackRequest>>anyObject())).andReturn(allResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackResourceProvider.STACK_NAME_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(2,resources.size());
  Set<String> stackNames=new HashSet<String>();
  stackNames.add("Stack1");
  stackNames.add("Stack2");
  for (  Resource resource : resources) {
    String stackName=(String)resource.getPropertyValue(StackResourceProvider.STACK_NAME_PROPERTY_ID);
    Assert.assertTrue(stackNames.contains(stackName));
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequiredProperties_serviceAndPropertyType() throws Exception {
  AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  AmbariMetaInfo metaInfo=createNiceMock(AmbariMetaInfo.class);
  Capture<Set<StackServiceRequest>> stackServiceRequestCapture=new Capture<Set<StackServiceRequest>>();
  StackServiceResponse stackServiceResponse=createNiceMock(StackServiceResponse.class);
  Capture<Set<StackServiceComponentRequest>> stackComponentRequestCapture=new Capture<Set<StackServiceComponentRequest>>();
  StackServiceComponentResponse stackComponentResponse=createNiceMock(StackServiceComponentResponse.class);
  Capture<Set<StackConfigurationRequest>> stackConfigurationRequestCapture=new Capture<Set<StackConfigurationRequest>>();
  Capture<Set<StackLevelConfigurationRequest>> stackLevelConfigurationRequestCapture=new Capture<Set<StackLevelConfigurationRequest>>();
  StackConfigurationResponse stackConfigurationResponse=EasyMock.createNiceMock(StackConfigurationResponse.class);
  StackConfigurationResponse stackConfigurationResponse2=EasyMock.createNiceMock(StackConfigurationResponse.class);
  expect(controller.getStackServices(capture(stackServiceRequestCapture))).andReturn(Collections.singleton(stackServiceResponse)).anyTimes();
  expect(controller.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  expect(stackServiceResponse.getServiceName()).andReturn("service1").anyTimes();
  expect(stackServiceResponse.getExcludedConfigTypes()).andReturn(Collections.<String>emptySet());
  expect(controller.getStackComponents(capture(stackComponentRequestCapture))).andReturn(Collections.singleton(stackComponentResponse)).anyTimes();
  expect(stackComponentResponse.getComponentName()).andReturn("component1").anyTimes();
  expect(stackComponentResponse.getComponentCategory()).andReturn("test-site.xml").anyTimes();
  expect(controller.getStackConfigurations(capture(stackConfigurationRequestCapture))).andReturn(new HashSet<StackConfigurationResponse>(Arrays.asList(stackConfigurationResponse,stackConfigurationResponse2))).anyTimes();
  expect(controller.getStackLevelConfigurations(capture(stackLevelConfigurationRequestCapture))).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  expect(stackConfigurationResponse.getPropertyName()).andReturn("prop1").anyTimes();
  expect(stackConfigurationResponse.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.PASSWORD)).anyTimes();
  expect(stackConfigurationResponse.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse.isRequired()).andReturn(true).anyTimes();
  expect(stackConfigurationResponse2.getPropertyName()).andReturn("prop2").anyTimes();
  expect(stackConfigurationResponse2.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse2.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse2.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.USER)).anyTimes();
  expect(stackConfigurationResponse2.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse2.isRequired()).andReturn(true).anyTimes();
  expect(metaInfo.getComponentDependencies("test","1.0","service1","component1")).andReturn(Collections.<DependencyInfo>emptyList()).anyTimes();
  replay(controller,stackServiceResponse,stackComponentResponse,stackConfigurationResponse,stackConfigurationResponse2,metaInfo);
  Stack stack=new Stack("test","1.0",controller);
  Collection<Stack.ConfigProperty> requiredPasswordProperties=stack.getRequiredConfigurationProperties("service1",PropertyInfo.PropertyType.PASSWORD);
  assertEquals(1,requiredPasswordProperties.size());
  Stack.ConfigProperty requiredPasswordConfigProperty=requiredPasswordProperties.iterator().next();
  assertEquals("test-site",requiredPasswordConfigProperty.getType());
  assertEquals("prop1",requiredPasswordConfigProperty.getName());
  assertTrue(requiredPasswordConfigProperty.getPropertyTypes().contains(PropertyInfo.PropertyType.PASSWORD));
  StackServiceRequest stackServiceRequest=stackServiceRequestCapture.getValue().iterator().next();
  assertEquals("test",stackServiceRequest.getStackName());
  assertEquals("1.0",stackServiceRequest.getStackVersion());
  StackServiceComponentRequest stackComponentRequest=stackComponentRequestCapture.getValue().iterator().next();
  assertEquals("service1",stackComponentRequest.getServiceName());
  assertEquals("test",stackComponentRequest.getStackName());
  assertEquals("1.0",stackComponentRequest.getStackVersion());
  assertNull(stackComponentRequest.getComponentName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StageResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testQueryForResources() throws Exception {
  StageResourceProvider provider=new StageResourceProvider(managementController);
  Request request=createNiceMock(Request.class);
  Predicate predicate=createNiceMock(Predicate.class);
  List<StageEntity> entities=getStageEntities(HostRoleStatus.COMPLETED);
  expect(dao.findAll(request,predicate)).andReturn(entities);
  expect(clusters.getClusterById(anyLong())).andReturn(cluster).anyTimes();
  expect(cluster.getClusterName()).andReturn("c1").anyTimes();
  replay(dao,clusters,cluster,request,predicate);
  QueryResponse response=provider.queryForResources(request,predicate);
  Set<Resource> resources=response.getResources();
  Assert.assertEquals(1,resources.size());
  Assert.assertFalse(response.isSortedResponse());
  Assert.assertFalse(response.isPagedResponse());
  Assert.assertEquals(1,response.getTotalResourceCount());
  verify(dao,clusters,cluster);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TaskAttemptResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createTaskAttemptResponse("Cluster100","workflow1","job1","taskAttempt1"));
  expected.add(createTaskAttemptResponse("Cluster100","workflow2","job2","taskAttempt2"));
  expected.add(createTaskAttemptResponse("Cluster100","workflow2","job2","taskAttempt3"));
  Resource.Type type=Resource.Type.TaskAttempt;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  TaskAttemptFetcher taskAttemptFetcher=createMock(TaskAttemptFetcher.class);
  expect(taskAttemptFetcher.fetchTaskAttemptDetails(propertyIds,null,null,"job2",null)).andReturn(expected).once();
  replay(taskAttemptFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new TaskAttemptResourceProvider(propertyIds,keyPropertyIds,taskAttemptFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(TaskAttemptResourceProvider.TASK_ATTEMPT_JOB_ID_PROPERTY_ID).equals("job2").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(TaskAttemptResourceProvider.TASK_ATTEMPT_ID_PROPERTY_ID)));
  }
  verify(taskAttemptFetcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderHDP22Test </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests upgrades from HDP-2.2.x to HDP-2.2.y
 * @throws Exception
 */
@SuppressWarnings("serial") @Test public void testCreateIntraStackUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackId oldStack=cluster.getDesiredStackVersion();
  for (  Service s : cluster.getServices().values()) {
    assertEquals(oldStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(oldStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(oldStack,sch.getDesiredStackVersion());
      }
    }
  }
  Config config=new ConfigImpl("hive-site");
  config.setProperties(configTagVersion1Properties);
  config.setTag(configTagVersion1);
  cluster.addConfig(config);
  cluster.addDesiredConfig("admin",Collections.singleton(config));
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.4.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  assertEquals("upgrade_test",upgrade.getUpgradePackage());
  assertEquals(3,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  assertEquals(3,group.getItems().size());
  group=upgrade.getUpgradeGroups().get(0);
  assertEquals(2,group.getItems().size());
  UpgradeItemEntity item=group.getItems().get(1);
  assertEquals("Value is set for the source stack upgrade pack","Goo",item.getText());
  assertTrue(cluster.getDesiredConfigs().containsKey("hive-site"));
  StackId newStack=cluster.getDesiredStackVersion();
  assertTrue(oldStack.equals(newStack));
  for (  Service s : cluster.getServices().values()) {
    assertEquals(newStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(newStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(newStack,sch.getDesiredStackVersion());
      }
    }
  }
  assertEquals(configTagVersion1,cluster.getDesiredConfigByType("hive-site").getTag());
  final Config newConfig=new ConfigImpl("hive-site");
  newConfig.setProperties(configTagVersion2Properties);
  newConfig.setTag(configTagVersion2);
  Set<Config> desiredConfigs=new HashSet<Config>(){
{
      add(newConfig);
    }
  }
;
  cluster.addConfig(newConfig);
  cluster.addDesiredConfig("admin",desiredConfigs);
  assertEquals(configTagVersion2,cluster.getDesiredConfigByType("hive-site").getTag());
  Gson gson=new Gson();
  List<ExecutionCommandEntity> currentExecutionCommands=injector.getInstance(ExecutionCommandDAO.class).findAll();
  for (  ExecutionCommandEntity ece : currentExecutionCommands) {
    String executionCommandJson=new String(ece.getCommand());
    Map<String,Object> commandMap=gson.<Map<String,Object>>fromJson(executionCommandJson,Map.class);
    Set<String> roleCommandsThatMustHaveRefresh=new HashSet<String>();
    roleCommandsThatMustHaveRefresh.add("SERVICE_CHECK");
    roleCommandsThatMustHaveRefresh.add("RESTART");
    roleCommandsThatMustHaveRefresh.add("ACTIONEXECUTE");
    String roleCommand=(String)commandMap.get("roleCommand");
    if (roleCommandsThatMustHaveRefresh.contains(roleCommand)) {
      assertTrue(commandMap.containsKey(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION));
      Object object=commandMap.get(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION);
      assertTrue(object instanceof List);
      @SuppressWarnings("unchecked") List<String> tags=(List<String>)commandMap.get(KeyNames.REFRESH_CONFIG_TAGS_BEFORE_EXECUTION);
      assertEquals(1,tags.size());
      assertEquals("*",tags.get(0));
      ExecutionCommandWrapper executionCommandWrapper=new ExecutionCommandWrapper(executionCommandJson);
      ExecutionCommand executionCommand=executionCommandWrapper.getExecutionCommand();
      Map<String,Map<String,String>> configurationTags=executionCommand.getConfigurationTags();
      assertEquals(configTagVersion2,configurationTags.get("hive-site").get("tag"));
      Map<String,Map<String,String>> configurations=executionCommand.getConfigurations();
      assertEquals("10010",configurations.get("hive-site").get("hive.server2.thrift.port"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderTest </h4><pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeToBase() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  try {
    upgradeResourceProvider.createResources(request);
    Assert.fail("Expected an exception going downgrade with no upgrade pack");
  }
 catch (  Exception e) {
  }
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.1.1.0");
  Map<String,String> requestInfoProperties=new HashMap<>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertEquals(1,status.getAssociatedResources().size());
  Resource r=status.getAssociatedResources().iterator().next();
  String id=r.getPropertyValue("Upgrade/request_id").toString();
  UpgradeEntity entity=upgradeDao.findUpgrade(Long.parseLong(id));
  assertNotNull(entity);
  assertEquals("2.1.1",entity.getFromVersion());
  assertEquals("2.2.0.0",entity.getToVersion());
  assertEquals(Direction.DOWNGRADE,entity.getDirection());
  StageDAO dao=injector.getInstance(StageDAO.class);
  List<StageEntity> stages=dao.findByRequestId(entity.getRequestId());
  Gson gson=new Gson();
  for (  StageEntity se : stages) {
    Map<String,String> map=gson.fromJson(se.getCommandParamsStage(),Map.class);
    assertTrue(map.containsKey("upgrade_direction"));
    assertEquals("downgrade",map.get("upgrade_direction"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackEntity stackEntity=stackDAO.find("HDP","2.1.1");
  RepositoryVersionEntity repoVersionEntity=new RepositoryVersionEntity();
  repoVersionEntity.setDisplayName("My New Version 3");
  repoVersionEntity.setOperatingSystems("");
  repoVersionEntity.setStack(stackEntity);
  repoVersionEntity.setVersion("2.2.2.3");
  repoVersionDao.create(repoVersionEntity);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.2.3");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  Long id=upgrade.getRequestId();
  assertEquals(3,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  Assert.assertEquals("POST_CLUSTER",group.getName());
  Assert.assertTrue(!group.getItems().isEmpty());
  for (  UpgradeItemEntity item : group.getItems()) {
    Assert.assertFalse(item.getText().toLowerCase().contains("downgrade"));
  }
  requestProps.clear();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.2.2.3");
  Map<String,String> requestInfoProps=new HashMap<String,String>();
  requestInfoProps.put("downgrade","true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProps);
  upgradeResourceProvider.createResources(request);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(2,upgrades.size());
  upgrade=null;
  for (  UpgradeEntity u : upgrades) {
    if (!u.getRequestId().equals(id)) {
      upgrade=u;
    }
  }
  assertNotNull(upgrade);
  assertEquals("Downgrade groups reduced from 3 to 2",2,upgrade.getUpgradeGroups().size());
  group=upgrade.getUpgradeGroups().get(1);
  assertEquals("Execution items increased from 1 to 2",2,group.getItems().size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateSkipFailures() throws Exception {
  testCreateResourcesWithAutoSkipFailures();
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(1);
  assertEquals(1,upgrades.size());
  UpgradeEntity entity=upgrades.get(0);
  HostRoleCommandDAO dao=injector.getInstance(HostRoleCommandDAO.class);
  List<HostRoleCommandEntity> tasks=dao.findByRequest(entity.getRequestId());
  for (  HostRoleCommandEntity task : tasks) {
    StageEntity stage=task.getStage();
    if (stage.isSkippable() && stage.isAutoSkipOnFailureSupported()) {
      assertTrue(task.isFailureAutoSkipped());
    }
 else {
      assertFalse(task.isFailureAutoSkipped());
    }
  }
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,Boolean.FALSE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,"" + entity.getRequestId());
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getUpdateRequest(requestProps,null);
  upgradeResourceProvider.updateResources(request,null);
  tasks=dao.findByRequest(entity.getRequestId());
  for (  HostRoleCommandEntity task : tasks) {
    if (task.getRoleCommand() == RoleCommand.SERVICE_CHECK) {
      assertFalse(task.isFailureAutoSkipped());
    }
 else {
      StageEntity stage=task.getStage();
      if (stage.isSkippable() && stage.isAutoSkipOnFailureSupported()) {
        assertTrue(task.isFailureAutoSkipped());
      }
 else {
        assertFalse(task.isFailureAutoSkipped());
      }
    }
  }
  requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,Boolean.FALSE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,Boolean.TRUE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,"" + entity.getRequestId());
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  upgradeResourceProvider.updateResources(request,null);
  tasks=dao.findByRequest(entity.getRequestId());
  for (  HostRoleCommandEntity task : tasks) {
    if (task.getRoleCommand() == RoleCommand.SERVICE_CHECK) {
      StageEntity stage=task.getStage();
      if (stage.isSkippable() && stage.isAutoSkipOnFailureSupported()) {
        assertTrue(task.isFailureAutoSkipped());
      }
 else {
        assertFalse(task.isFailureAutoSkipped());
      }
    }
 else {
      assertFalse(task.isFailureAutoSkipped());
    }
  }
  requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,Boolean.FALSE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,Boolean.FALSE.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,"" + entity.getRequestId());
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  upgradeResourceProvider.updateResources(request,null);
  tasks=dao.findByRequest(entity.getRequestId());
  for (  HostRoleCommandEntity task : tasks) {
    assertFalse(task.isFailureAutoSkipped());
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetry() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"ABORTED");
  UpgradeResourceProvider urp=createProvider(amc);
  Request req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
  ActionManager am=injector.getInstance(ActionManager.class);
  List<HostRoleCommand> commands=am.getRequestTasks(id);
  boolean foundOne=false;
  for (  HostRoleCommand hrc : commands) {
    if (hrc.getRole().equals(Role.AMBARI_SERVER_ACTION)) {
      assertEquals(-1L,hrc.getHostId());
      assertNull(hrc.getHostName());
      foundOne=true;
    }
  }
  assertTrue("Expected at least one server-side action",foundOne);
  HostRoleCommand cmd=commands.get(commands.size() - 1);
  HostRoleCommandDAO dao=injector.getInstance(HostRoleCommandDAO.class);
  HostRoleCommandEntity entity=dao.findByPK(cmd.getTaskId());
  entity.setStatus(HostRoleStatus.ABORTED);
  dao.merge(entity);
  requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"PENDING");
  req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testCreateCrossStackUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackId oldStack=cluster.getDesiredStackVersion();
  for (  Service s : cluster.getServices().values()) {
    assertEquals(oldStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(oldStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(oldStack,sch.getDesiredStackVersion());
      }
    }
  }
  Config config=new ConfigImpl("zoo.cfg");
  config.setProperties(new HashMap<String,String>(){
{
      put("a","b");
    }
  }
);
  config.setTag("abcdefg");
  cluster.addConfig(config);
  cluster.addDesiredConfig("admin",Collections.singleton(config));
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test_nonrolling");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  assertEquals(5,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  assertEquals(1,group.getItems().size());
  group=upgrade.getUpgradeGroups().get(0);
  assertEquals(1,group.getItems().size());
  assertTrue(cluster.getDesiredConfigs().containsKey("zoo.cfg"));
  StackId newStack=cluster.getDesiredStackVersion();
  assertFalse(oldStack.equals(newStack));
  for (  Service s : cluster.getServices().values()) {
    assertEquals(newStack,s.getDesiredStackVersion());
    for (    ServiceComponent sc : s.getServiceComponents().values()) {
      assertEquals(newStack,sc.getDesiredStackVersion());
      for (      ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
        assertEquals(newStack,sch.getDesiredStackVersion());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests merging configurations between existing and new stack values on
 * upgrade.
 * @throws Exception
 */
@Test public void testMergeConfigurations() throws Exception {
  StackId stack211=new StackId("HDP-2.1.1");
  StackId stack220=new StackId("HDP-2.2.0");
  Map<String,Map<String,String>> stack211Configs=new HashMap<String,Map<String,String>>();
  Map<String,String> stack211FooType=new HashMap<String,String>();
  Map<String,String> stack211BarType=new HashMap<String,String>();
  Map<String,String> stack211BazType=new HashMap<String,String>();
  stack211Configs.put("foo-site",stack211FooType);
  stack211Configs.put("bar-site",stack211BarType);
  stack211Configs.put("baz-site",stack211BazType);
  stack211FooType.put("1","one");
  stack211FooType.put("11","one-one");
  stack211BarType.put("2","two");
  stack211BazType.put("3","three");
  Map<String,Map<String,String>> stack220Configs=new HashMap<String,Map<String,String>>();
  Map<String,String> stack220FooType=new HashMap<String,String>();
  Map<String,String> stack220BazType=new HashMap<String,String>();
  Map<String,String> stack220FlumeEnvType=new HashMap<String,String>();
  stack220Configs.put("foo-site",stack220FooType);
  stack220Configs.put("baz-site",stack220BazType);
  stack220Configs.put("flume-env",stack220FlumeEnvType);
  stack220FooType.put("1","one-new");
  stack220FooType.put("111","one-one-one");
  stack220BazType.put("3","three-new");
  stack220FlumeEnvType.put("flume_env_key","flume-env-value");
  Map<String,String> clusterFooType=new HashMap<String,String>();
  Map<String,String> clusterBarType=new HashMap<String,String>();
  Map<String,String> clusterBazType=new HashMap<String,String>();
  Config fooConfig=EasyMock.createNiceMock(Config.class);
  Config barConfig=EasyMock.createNiceMock(Config.class);
  Config bazConfig=EasyMock.createNiceMock(Config.class);
  clusterFooType.put("1","one");
  clusterFooType.put("11","one-one");
  clusterBarType.put("2","two");
  clusterBazType.put("3","three-changed");
  expect(fooConfig.getProperties()).andReturn(clusterFooType);
  expect(barConfig.getProperties()).andReturn(clusterBarType);
  expect(bazConfig.getProperties()).andReturn(clusterBazType);
  Map<String,DesiredConfig> desiredConfigurations=new HashMap<String,DesiredConfig>();
  desiredConfigurations.put("foo-site",null);
  desiredConfigurations.put("bar-site",null);
  desiredConfigurations.put("baz-site",null);
  Cluster cluster=EasyMock.createNiceMock(Cluster.class);
  expect(cluster.getCurrentStackVersion()).andReturn(stack211);
  expect(cluster.getDesiredStackVersion()).andReturn(stack220);
  expect(cluster.getDesiredConfigs()).andReturn(desiredConfigurations);
  expect(cluster.getDesiredConfigByType("foo-site")).andReturn(fooConfig);
  expect(cluster.getDesiredConfigByType("bar-site")).andReturn(barConfig);
  expect(cluster.getDesiredConfigByType("baz-site")).andReturn(bazConfig);
  EasyMock.reset(configHelper);
  expect(configHelper.getDefaultProperties(EasyMock.eq(stack211),EasyMock.anyObject(Cluster.class))).andReturn(stack211Configs).anyTimes();
  expect(configHelper.getDefaultProperties(EasyMock.eq(stack220),EasyMock.anyObject(Cluster.class))).andReturn(stack220Configs).anyTimes();
  Capture<Map<String,Map<String,String>>> expectedConfigurationsCapture=new Capture<Map<String,Map<String,String>>>();
  configHelper.createConfigTypes(EasyMock.anyObject(Cluster.class),EasyMock.anyObject(AmbariManagementController.class),EasyMock.capture(expectedConfigurationsCapture),EasyMock.anyObject(String.class),EasyMock.anyObject(String.class));
  EasyMock.expectLastCall().once();
  EasyMock.replay(configHelper,cluster,fooConfig,barConfig,bazConfig);
  UpgradeResourceProvider upgradeResourceProvider=createProvider(amc);
  Map<String,UpgradePack> upgradePacks=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  UpgradePack upgrade=upgradePacks.get("upgrade_to_new_stack");
  upgradeResourceProvider.applyStackAndProcessConfigurations(stack211.getStackName(),cluster,"2.2.0.0",Direction.UPGRADE,upgrade,"admin");
  Map<String,Map<String,String>> expectedConfigurations=expectedConfigurationsCapture.getValue();
  Map<String,String> expectedFooType=expectedConfigurations.get("foo-site");
  Map<String,String> expectedBarType=expectedConfigurations.get("bar-site");
  Map<String,String> expectedBazType=expectedConfigurations.get("baz-site");
  assertFalse(expectedConfigurations.containsKey("flume-env"));
  assertEquals("one-new",expectedFooType.get("1"));
  assertEquals("one-one",expectedFooType.get("11"));
  assertEquals("two",expectedBarType.get("2"));
  assertEquals("three-changed",expectedBazType.get("3"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test Downgrade from the partially completed upgrade
 */
@Test public void testNotFullDowngrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Service service=cluster.addService("HIVE");
  service.setDesiredStackVersion(cluster.getDesiredStackVersion());
  service.persist();
  ServiceComponent component=service.addServiceComponent("HIVE_SERVER");
  ServiceComponentHost sch=component.addServiceComponentHost("h1");
  sch.setVersion("2.1.1.0");
  Map<String,Object> requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_nonrolling_new_stack");
  requestProps.put(UpgradeResourceProvider.UPGRADE_TYPE,"NON_ROLLING");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  List<UpgradeGroupEntity> groups=upgrades.get(0).getUpgradeGroups();
  boolean isHiveGroupFound=false;
  boolean isZKGroupFound=false;
  for (  UpgradeGroupEntity group : groups) {
    if (group.getName().equalsIgnoreCase("hive")) {
      isHiveGroupFound=true;
    }
 else     if (group.getName().equalsIgnoreCase("zookeeper")) {
      isZKGroupFound=true;
    }
  }
  assertTrue(isHiveGroupFound);
  assertTrue(isZKGroupFound);
  isHiveGroupFound=false;
  isZKGroupFound=false;
  sch.setVersion("2.2.0.0");
  StackId stackId=new StackId("HDP","2.2.0");
  cluster.setDesiredStackVersion(stackId,true);
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_nonrolling_new_stack");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.2.0.0");
  Map<String,String> requestInfoProperties=new HashMap<>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  UpgradeEntity upgradeEntity=upgradeDao.findUpgradeByRequestId(getRequestId(status));
  for (  UpgradeGroupEntity group : upgradeEntity.getUpgradeGroups()) {
    if (group.getName().equalsIgnoreCase("hive")) {
      isHiveGroupFound=true;
    }
 else     if (group.getName().equalsIgnoreCase("zookeeper")) {
      isZKGroupFound=true;
    }
  }
  assertTrue(isHiveGroupFound);
  assertFalse(isZKGroupFound);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("Upgrade");
  Predicate predicate=new PredicateBuilder().property(UpgradeResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Set<Resource> resources=upgradeResourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("Upgrade/progress_percent"));
  assertNotNull(res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(Direction.UPGRADE,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES));
  assertEquals(UpgradeType.ROLLING,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_TYPE));
  propertyIds.clear();
  propertyIds.add("UpgradeGroup");
  predicate=new PredicateBuilder().property(UpgradeGroupResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeGroupResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeGroupResourceProvider=new UpgradeGroupResourceProvider(amc);
  resources=upgradeGroupResourceProvider.getResources(request,predicate);
  assertEquals(3,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeGroup/status"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/group_id"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/total_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/in_progress_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/completed_task_count"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeItem/status"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("3").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertEquals("Confirm Finalize",res.getPropertyValue("UpgradeItem/context"));
  assertTrue(res.getPropertyValue("UpgradeItem/text").toString().startsWith("Please confirm"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetLayoutResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  WidgetEntity widgetEntity=new WidgetEntity();
  widgetEntity.setId(1l);
  widgetEntity.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  expect(widgetDAO.findById(anyLong())).andReturn(widgetEntity).anyTimes();
  replay(amc,clusters,cluster,dao,widgetDAO);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  Map<String,String> widget=new HashMap<String,String>();
  widget.put("id","1");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("CLUSTER",entity.getScope());
  Assert.assertEquals("layout_name",entity.getLayoutName());
  Assert.assertEquals("display_name",entity.getDisplayName());
  Assert.assertEquals("section_name",entity.getSectionName());
  Assert.assertEquals("admin",entity.getUserName());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0));
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0).getWidget().getListWidgetLayoutUserWidgetEntity());
  verify(amc,clusters,cluster,dao,widgetDAO);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  WidgetEntity widgetEntity=new WidgetEntity();
  widgetEntity.setId(1L);
  widgetEntity.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  WidgetEntity widgetEntity2=new WidgetEntity();
  widgetEntity2.setId(2L);
  widgetEntity2.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  expect(widgetDAO.findById(1L)).andReturn(widgetEntity).atLeastOnce();
  replay(amc,clusters,cluster,dao,widgetDAO);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  Map<String,String> widget=new HashMap<String,String>();
  widget.put("id","1");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID).equals("1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  String oldLayoutName=entity.getLayoutName();
  String oldScope=entity.getScope();
  resetToStrict(dao,widgetDAO);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  expect(dao.mergeWithFlush((WidgetLayoutEntity)anyObject())).andReturn(entity).anyTimes();
  expect(widgetDAO.merge(widgetEntity)).andReturn(widgetEntity).anyTimes();
  expect(widgetDAO.findById(2L)).andReturn(widgetEntity2).anyTimes();
  replay(dao,widgetDAO);
  requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name_new");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"USER");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID,"1");
  widget.put("id","2");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  provider.updateResources(request,predicate);
  Assert.assertFalse(oldLayoutName.equals(entity.getLayoutName()));
  Assert.assertFalse(oldScope.equals(entity.getScope()));
  verify(amc,clusters,cluster,dao,widgetDAO);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testDeleteResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID).equals("1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  dao.remove(capture(entityCapture));
  expectLastCall();
  replay(dao);
  provider.deleteResources(predicate);
  WidgetLayoutEntity entity1=entityCapture.getValue();
  Assert.assertEquals(Long.valueOf(1),entity1.getId());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  WidgetResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID).equals("1").and().property(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  String oldMetrics=entity.getMetrics();
  String oldProperties=entity.getProperties();
  String oldName=entity.getWidgetName();
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  expect(dao.merge((WidgetEntity)anyObject())).andReturn(entity).anyTimes();
  replay(dao);
  requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID,"1");
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name2");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  testSet=new LinkedHashSet();
  testMap=new HashMap();
  testMap.put("name","new_value");
  testMap.put("new_name","new_value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","new_value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/new_property","new_value2");
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  provider.updateResources(request,predicate);
  Assert.assertFalse(oldName.equals(entity.getWidgetName()));
  Assert.assertFalse(oldMetrics.equals(entity.getMetrics()));
  Assert.assertFalse(oldProperties.equals(entity.getProperties()));
  Assert.assertEquals("[{\"name\":\"new_value\",\"new_name\":\"new_value2\"}]",entity.getMetrics());
  Assert.assertTrue(CollectionPresentationUtils.isJsonsEquals("{\"new_property\":\"new_value2\",\"property1\":\"new_value1\"}",entity.getProperties()));
  Assert.assertEquals("widget name2",entity.getWidgetName());
  Assert.assertEquals(null,entity.getDefaultSectionName());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testDeleteResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID).equals("1").and().property(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  dao.remove(capture(entityCapture));
  expectLastCall();
  replay(dao);
  provider.deleteResources(predicate);
  WidgetEntity entity1=entityCapture.getValue();
  Assert.assertEquals(Long.valueOf(1),entity1.getId());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("USER",entity.getScope());
  Assert.assertEquals("widget name",entity.getWidgetName());
  Assert.assertEquals(null,entity.getDefaultSectionName());
  Assert.assertEquals("GAUGE",entity.getWidgetType());
  Assert.assertEquals("admin",entity.getAuthor());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getMetrics());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getWidgetValues());
  Assert.assertEquals("{\"property2\":\"value2\",\"property1\":\"value1\"}",entity.getProperties());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WorkflowResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws SystemException, UnsupportedPropertyException, NoSuchResourceException, NoSuchParentResourceException {
  Set<Resource> expected=new HashSet<Resource>();
  expected.add(createWorkflowResponse("Cluster100","workflow1"));
  expected.add(createWorkflowResponse("Cluster100","workflow2"));
  expected.add(createWorkflowResponse("Cluster100","workflow3"));
  Resource.Type type=Resource.Type.Workflow;
  Set<String> propertyIds=PropertyHelper.getPropertyIds(type);
  WorkflowFetcher workflowFetcher=createMock(WorkflowFetcher.class);
  expect(workflowFetcher.fetchWorkflows(propertyIds,"Cluster100",null)).andReturn(expected).once();
  replay(workflowFetcher);
  Map<Resource.Type,String> keyPropertyIds=PropertyHelper.getKeyPropertyIds(type);
  ResourceProvider provider=new WorkflowResourceProvider(propertyIds,keyPropertyIds,workflowFetcher);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(WorkflowResourceProvider.WORKFLOW_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  Set<String> names=new HashSet<String>();
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    names.add((String)resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID));
  }
  for (  Resource resource : expected) {
    Assert.assertTrue(names.contains(resource.getPropertyValue(WorkflowResourceProvider.WORKFLOW_ID_PROPERTY_ID)));
  }
  verify(workflowFetcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.ganglia.GangliaMetricTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test of setDatapoints method, of class GangliaMetric.
 */
@Test public void testSetDatapointsOfPercentValue(){
  System.out.println("setDatapoints");
  List<GangliaMetric.TemporalMetric> listTemporalMetrics=new ArrayList<GangliaMetric.TemporalMetric>();
  GangliaMetric instance=new GangliaMetric();
  instance.setDs_name("dsName");
  instance.setCluster_name("c1");
  instance.setHost_name("localhost");
  instance.setMetric_name("cpu_wio");
  listTemporalMetrics.add(new GangliaMetric.TemporalMetric("111.0",new Long(1362440880)));
  listTemporalMetrics.add(new GangliaMetric.TemporalMetric("11.0",new Long(1362440881)));
  listTemporalMetrics.add(new GangliaMetric.TemporalMetric("100.0",new Long(1362440882)));
  instance.setDatapointsFromList(listTemporalMetrics);
  assertTrue(instance.getDatapoints().length == 2);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test of GangliaMetric.TemporalMetric constructor.
 */
@Test public void testTemporalMetricFineValue(){
  System.out.println("GangliaMetric.TemporalMetric");
  GangliaMetric.TemporalMetric tm;
  tm=new GangliaMetric.TemporalMetric("100",new Long(1362440880));
  assertTrue("GangliaMetric.TemporalMetric is valid",tm.isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test of GangliaMetric.TemporalMetric constructor.
 */
@Test public void testTemporalMetricIsNaNValue(){
  System.out.println("GangliaMetric.TemporalMetric");
  GangliaMetric.TemporalMetric tm;
  tm=new GangliaMetric.TemporalMetric("any string",new Long(1362440880));
  assertFalse("GangliaMetric.TemporalMetric is invalid",tm.isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.cache.TimelineMetricCacheSizingTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTimelineMetricCacheSizing() throws Exception {
  Set<String> metricNames=new HashSet<>();
  String metric1="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName1";
  String metric2="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName2";
  String metric3="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName3";
  String metric4="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName4";
  String metric5="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName5";
  String metric6="prefix1.suffix1.suffix2.actualNamePrefix.longMetricName6";
  metricNames.add(metric1);
  metricNames.add(metric2);
  metricNames.add(metric3);
  metricNames.add(metric4);
  metricNames.add(metric5);
  metricNames.add(metric6);
  long now=System.currentTimeMillis();
  TemporalInfo temporalInfo=new TemporalInfoImpl(now - 1000,now,15);
  TimelineAppMetricCacheKey key=new TimelineAppMetricCacheKey(metricNames,"KAFKA_BROKER",temporalInfo);
  key.setSpec("http://104.196.94.129:6188/ws/v1/timeline/metrics?metricNames=" + "jvm.JvmMetrics.MemHeapCommittedM&appId=RESOURCEMANAGER&" + "startTime=1439522640000&endTime=1440127440000&precision=hours");
  TimelineMetrics metrics=new TimelineMetrics();
  metrics.getMetrics().add(getSampleTimelineMetric(metric1));
  metrics.getMetrics().add(getSampleTimelineMetric(metric2));
  metrics.getMetrics().add(getSampleTimelineMetric(metric3));
  metrics.getMetrics().add(getSampleTimelineMetric(metric4));
  metrics.getMetrics().add(getSampleTimelineMetric(metric5));
  metrics.getMetrics().add(getSampleTimelineMetric(metric6));
  TimelineMetricsCacheValue value=new TimelineMetricsCacheValue(now - 1000,now,metrics,null);
  TimelineMetricsCacheSizeOfEngine customSizeOfEngine=new TimelineMetricsCacheSizeOfEngine();
  long bytesFromReflectionEngine=reflectionSizeOf.deepSizeOf(50000,false,key).getCalculated() + reflectionSizeOf.deepSizeOf(50000,false,value).getCalculated();
  long bytesFromCustomSizeOfEngine=customSizeOfEngine.sizeOf(key,value,null).getCalculated();
  long sampleSizeInMB=bytesFromReflectionEngine / (1024 * 1024);
  long discrepancyInKB=Math.abs(bytesFromCustomSizeOfEngine - bytesFromReflectionEngine) / 1024;
  Assert.assertTrue("Sample size is " + sampleSizeInMB + ", expected to be"+ "greater that 10 MB",sampleSizeInMB > 10);
  Assert.assertTrue("Discrepancy in values is " + discrepancyInKB + ", "+ "expected to be less than 10K. "+ "Bytes from reflection = "+ bytesFromReflectionEngine+ ", bytes from custom sizing engine = "+ bytesFromCustomSizeOfEngine,discrepancyInKB < 10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.cache.TimelineMetricCacheTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsOnKeys(){
  long now=System.currentTimeMillis();
  TemporalInfo temporalInfo=new TemporalInfoImpl(now - 1000,now,1);
  TimelineAppMetricCacheKey key1=new TimelineAppMetricCacheKey(new HashSet<String>(){
{
      add("cpu_num._avg");
      add("proc_run._avg");
    }
  }
,"HOST",temporalInfo);
  TimelineAppMetricCacheKey key2=new TimelineAppMetricCacheKey(new HashSet<String>(){
{
      add("cpu_num._avg");
    }
  }
,"HOST",temporalInfo);
  Assert.assertFalse(key1.equals(key2));
  Assert.assertFalse(key2.equals(key1));
  key2.getMetricNames().add("proc_run._avg");
  Assert.assertTrue(key1.equals(key2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.AndPredicateTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId1=PropertyHelper.getPropertyId("category1","property1");
  String propertyId2=PropertyHelper.getPropertyId("category1","property2");
  String propertyId3=PropertyHelper.getPropertyId("category1","property3");
  EqualsPredicate predicate1=new EqualsPredicate<String>(propertyId1,"v1");
  EqualsPredicate predicate2=new EqualsPredicate<String>(propertyId2,"v2");
  EqualsPredicate predicate3=new EqualsPredicate<String>(propertyId3,"v3");
  AndPredicate andPredicate=new AndPredicate(predicate1,predicate2,predicate3);
  Set<String> ids=andPredicate.getPropertyIds();
  Assert.assertEquals(3,ids.size());
  Assert.assertTrue(ids.contains(propertyId1));
  Assert.assertTrue(ids.contains(propertyId2));
  Assert.assertTrue(ids.contains(propertyId3));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId1=PropertyHelper.getPropertyId("category1","property1");
  String propertyId2=PropertyHelper.getPropertyId("category1","property2");
  String propertyId3=PropertyHelper.getPropertyId("category1","property3");
  EqualsPredicate predicate1=new EqualsPredicate<String>(propertyId1,"v1");
  EqualsPredicate predicate2=new EqualsPredicate<String>(propertyId2,"v2");
  EqualsPredicate predicate3=new EqualsPredicate<String>(propertyId3,"v3");
  AndPredicate andPredicate=new AndPredicate(predicate1,predicate2,predicate3);
  resource.setProperty(propertyId1,"v1");
  resource.setProperty(propertyId2,"monkey");
  resource.setProperty(propertyId3,"v3");
  Assert.assertFalse(andPredicate.evaluate(resource));
  resource.setProperty(propertyId2,"v2");
  Assert.assertTrue(andPredicate.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.CategoryIsEmptyPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyWithMap(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","mapProperty");
  Predicate predicate=new CategoryIsEmptyPredicate(propertyId);
  Assert.assertTrue(predicate.evaluate(resource));
  Map<String,String> mapProperty=new HashMap<String,String>();
  resource.setProperty(propertyId,mapProperty);
  Assert.assertTrue(predicate.evaluate(resource));
  mapProperty.put("foo","bar");
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String categoryId=PropertyHelper.getPropertyId("category1",null);
  Predicate predicate=new CategoryIsEmptyPredicate(categoryId);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.addCategory(categoryId);
  Assert.assertTrue(predicate.evaluate(resource));
  String propertyId=PropertyHelper.getPropertyId("category1","bar");
  resource.setProperty(propertyId,"value1");
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.EqualsPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyNullValue(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new EqualsPredicate<String>(propertyId,null);
  resource.setProperty(propertyId,"monkey");
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,null);
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  EqualsPredicate predicate=new EqualsPredicate<String>(propertyId,"bar");
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyNumberValues() throws Exception {
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("propertyId1","1");
  Predicate predicate=new EqualsPredicate<String>(propertyId,"1");
  resource.setProperty(propertyId,"1");
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,"2");
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,"5");
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new EqualsPredicate<String>(propertyId,"bar");
  resource.setProperty(propertyId,"monkey");
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,"bar");
  Assert.assertTrue(predicate.evaluate(resource));
  propertyId=PropertyHelper.getPropertyId("category1","fun");
  predicate=new EqualsPredicate<String>(propertyId,"bar");
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.FilterPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyEmptyValue(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new FilterPredicate(propertyId,"");
  resource.setProperty(propertyId,"monkey");
  Assert.assertFalse(predicate.evaluate(resource));
  predicate=new FilterPredicate(propertyId,"monkey");
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyNullValue(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new FilterPredicate(propertyId,null);
  resource.setProperty(propertyId,"monkey");
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,null);
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply() throws Exception {
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","ip");
  Predicate predicate=new FilterPredicate(propertyId,IP_ADDRESS_PATTERN);
  resource.setProperty(propertyId,"monkey");
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,"10.0.0.1");
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,"127.0.0.1");
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,"0.0.0.0");
  Assert.assertTrue(predicate.evaluate(resource));
  propertyId=PropertyHelper.getPropertyId("category1","fun");
  predicate=new FilterPredicate(propertyId,IP_ADDRESS_PATTERN);
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  FilterPredicate predicate=new FilterPredicate(propertyId,"bar");
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.GreaterEqualsPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new GreaterEqualsPredicate<Integer>(propertyId,10);
  resource.setProperty(propertyId,1);
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,100);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,10);
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  GreaterEqualsPredicate predicate=new GreaterEqualsPredicate<Integer>(propertyId,10);
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.GreaterPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApplyWithSmallFloats(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new GreaterPredicate<Double>(propertyId,0.1);
  resource.setProperty(propertyId,1.3);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,0.06);
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,100.3);
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new GreaterPredicate<Integer>(propertyId,10);
  resource.setProperty(propertyId,1);
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,100);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,10);
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  GreaterPredicate predicate=new GreaterPredicate<Integer>(propertyId,10);
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.LessEqualsPredicateTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  LessEqualsPredicate predicate=new LessEqualsPredicate<Integer>(propertyId,10);
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new LessEqualsPredicate<Integer>(propertyId,10);
  resource.setProperty(propertyId,1);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,100);
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,10);
  Assert.assertTrue(predicate.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.LessPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  Predicate predicate=new LessPredicate<Integer>(propertyId,10);
  resource.setProperty(propertyId,1);
  Assert.assertTrue(predicate.evaluate(resource));
  resource.setProperty(propertyId,100);
  Assert.assertFalse(predicate.evaluate(resource));
  resource.setProperty(propertyId,10);
  Assert.assertFalse(predicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  LessPredicate predicate=new LessPredicate<Integer>(propertyId,1);
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.NotPredicateTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  EqualsPredicate predicate=new EqualsPredicate<String>(propertyId,"bar");
  Set<String> ids=predicate.getPropertyIds();
  Assert.assertEquals(1,ids.size());
  Assert.assertTrue(ids.contains(propertyId));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  EqualsPredicate predicate=new EqualsPredicate<String>(propertyId,"bar");
  NotPredicate notPredicate=new NotPredicate(predicate);
  resource.setProperty(propertyId,"monkey");
  Assert.assertTrue(notPredicate.evaluate(resource));
  resource.setProperty(propertyId,"bar");
  Assert.assertFalse(notPredicate.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.OrPredicateTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testApply(){
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  String propertyId1=PropertyHelper.getPropertyId("category1","property1");
  String propertyId2=PropertyHelper.getPropertyId("category1","property2");
  String propertyId3=PropertyHelper.getPropertyId("category1","property3");
  EqualsPredicate predicate1=new EqualsPredicate<String>(propertyId1,"v1");
  EqualsPredicate predicate2=new EqualsPredicate<String>(propertyId2,"v2");
  EqualsPredicate predicate3=new EqualsPredicate<String>(propertyId3,"v3");
  OrPredicate orPredicate=new OrPredicate(predicate1,predicate2,predicate3);
  resource.setProperty(propertyId1,"big");
  resource.setProperty(propertyId2,"monkey");
  resource.setProperty(propertyId3,"runner");
  Assert.assertFalse(orPredicate.evaluate(resource));
  resource.setProperty(propertyId2,"v2");
  Assert.assertTrue(orPredicate.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties(){
  String propertyId1=PropertyHelper.getPropertyId("category1","property1");
  String propertyId2=PropertyHelper.getPropertyId("category1","property2");
  String propertyId3=PropertyHelper.getPropertyId("category1","property3");
  EqualsPredicate predicate1=new EqualsPredicate<String>(propertyId1,"v1");
  EqualsPredicate predicate2=new EqualsPredicate<String>(propertyId2,"v2");
  EqualsPredicate predicate3=new EqualsPredicate<String>(propertyId3,"v3");
  OrPredicate orPredicate=new OrPredicate(predicate1,predicate2,predicate3);
  Set<String> ids=orPredicate.getPropertyIds();
  Assert.assertEquals(3,ids.size());
  Assert.assertTrue(ids.contains(propertyId1));
  Assert.assertTrue(ids.contains(propertyId2));
  Assert.assertTrue(ids.contains(propertyId3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.spi.ResourceTest </h4><pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResource(){
  for (  Resource.InternalType internalType : Resource.InternalType.values()) {
    Resource.Type type=null;
    try {
      type=Resource.Type.valueOf(internalType.name());
    }
 catch (    IllegalArgumentException e) {
      Assert.fail("Resource.Type should be defined for internal type " + internalType.name() + ".");
    }
    Assert.assertEquals(type.name(),internalType.name());
    Assert.assertEquals(type.ordinal(),internalType.ordinal());
  }
  Resource.Type newType=new Resource.Type("newType");
  Resource.Type newType2=new Resource.Type("newType2");
  Assert.assertFalse(newType.equals(newType2));
  Assert.assertFalse(newType2.equals(newType));
  Assert.assertEquals("newType",newType.name());
  Assert.assertFalse(newType.isInternalType());
  try {
    newType.getInternalType();
    Assert.fail("Can't get internal type for a extended resource.");
  }
 catch (  UnsupportedOperationException e) {
  }
  Resource.Type t1=Resource.Type.valueOf("newType");
  Resource.Type t2=Resource.Type.valueOf("newType2");
  Assert.assertTrue(newType.equals(t1));
  Assert.assertTrue(t1.equals(newType));
  Assert.assertTrue(newType2.equals(t2));
  Assert.assertTrue(t2.equals(newType2));
  Assert.assertFalse(t1.equals(newType2));
  Assert.assertFalse(t2.equals(newType));
  try {
    Resource.Type.valueOf("badType");
    Assert.fail("Expected IllegalArgumentException.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.test.BufferedThreadPoolExecutorCompletionServiceTest </h4><pre class="type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when unbounded queue provided to executor, only{@link ThreadPoolExecutor#getCorePoolSize()} threads are launched
 * @throws InterruptedException
 */
@Test public void testOnlyCorePoolThreadsLaunchedForUnboundedQueue() throws InterruptedException {
  int CORE_POOL_SIZE=2;
  int MAX_POOL_SIZE=5;
  int TASKS_COUNT=8;
  LinkedBlockingQueue<Runnable> queue=new LinkedBlockingQueue<Runnable>();
  ThreadPoolExecutor threadPoolExecutor=new ThreadPoolExecutor(CORE_POOL_SIZE,MAX_POOL_SIZE,30000,TimeUnit.MILLISECONDS,queue);
  BufferedThreadPoolExecutorCompletionService<Runnable> service=new BufferedThreadPoolExecutorCompletionService<>(threadPoolExecutor);
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    service.submit(new Runnable(){
      @Override public void run(){
        try {
          longOp();
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
,null);
  }
  Thread.sleep(500);
  Assert.assertEquals(CORE_POOL_SIZE,threadPoolExecutor.getActiveCount());
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    Future<Runnable> take=service.take();
    Assert.assertTrue(take.isDone());
    Assert.assertTrue("No more than CORE_POOL_SIZE threads should be launched",threadPoolExecutor.getActiveCount() <= CORE_POOL_SIZE);
  }
  threadPoolExecutor.shutdown();
}

</code></pre>

<br>
<pre class="type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when load is more than max-pool-size, the number of threads
 * scales up.
 * @throws InterruptedException
 */
@Test public void testMaxPoolSizeThreadsLaunched() throws InterruptedException {
  int CORE_POOL_SIZE=2;
  int MAX_POOL_SIZE=10;
  int TASKS_COUNT=24;
  LinkedBlockingQueue<Runnable> queue=new LinkedBlockingQueue<Runnable>(CORE_POOL_SIZE);
  ThreadPoolExecutor threadPoolExecutor=new ThreadPoolExecutor(CORE_POOL_SIZE,MAX_POOL_SIZE,30000,TimeUnit.MILLISECONDS,queue);
  BufferedThreadPoolExecutorCompletionService<Runnable> service=new BufferedThreadPoolExecutorCompletionService<>(threadPoolExecutor);
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    service.submit(new Runnable(){
      @Override public void run(){
        try {
          longOp();
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
,null);
  }
  Thread.sleep(500);
  Assert.assertEquals(MAX_POOL_SIZE,threadPoolExecutor.getActiveCount());
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    Future<Runnable> take=service.take();
    Assert.assertTrue(take.isDone());
    Assert.assertTrue("No more than MAX_POOL_SIZE threads should be launched",threadPoolExecutor.getActiveCount() <= MAX_POOL_SIZE);
  }
  threadPoolExecutor.shutdown();
}

</code></pre>

<br>
<pre class="type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when load is more than core-pool-size and less than
 * max-pool-size, the number of threads scales up.
 * @throws InterruptedException
 */
@Test public void testLessThanMaxPoolSizeThreadsLaunched() throws InterruptedException {
  int CORE_POOL_SIZE=2;
  int MAX_POOL_SIZE=10;
  int TASKS_COUNT=8;
  LinkedBlockingQueue<Runnable> queue=new LinkedBlockingQueue<Runnable>(CORE_POOL_SIZE);
  ThreadPoolExecutor threadPoolExecutor=new ThreadPoolExecutor(CORE_POOL_SIZE,MAX_POOL_SIZE,30000,TimeUnit.MILLISECONDS,queue);
  BufferedThreadPoolExecutorCompletionService<Runnable> service=new BufferedThreadPoolExecutorCompletionService<>(threadPoolExecutor);
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    service.submit(new Runnable(){
      @Override public void run(){
        try {
          longOp();
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
,null);
  }
  Thread.sleep(500);
  Assert.assertEquals(TASKS_COUNT - CORE_POOL_SIZE,threadPoolExecutor.getActiveCount());
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    Future<Runnable> take=service.take();
    Assert.assertTrue(take.isDone());
    Assert.assertTrue("No more than TASKS_COUNT threads should be launched",threadPoolExecutor.getActiveCount() <= TASKS_COUNT);
  }
  threadPoolExecutor.shutdown();
}

</code></pre>

<br>
<pre class="type-12 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when load is more than max-pool-size, the number of threads
 * scales up.
 * @throws InterruptedException
 */
@Test public void testScalingThreadPoolExecutor() throws InterruptedException {
  int CORE_POOL_SIZE=2;
  int MAX_POOL_SIZE=10;
  int TASKS_COUNT=24;
  ThreadPoolExecutor threadPoolExecutor=new ScalingThreadPoolExecutor(CORE_POOL_SIZE,MAX_POOL_SIZE,30000,TimeUnit.MILLISECONDS);
  BufferedThreadPoolExecutorCompletionService<Runnable> service=new BufferedThreadPoolExecutorCompletionService<>(threadPoolExecutor);
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    service.submit(new Runnable(){
      @Override public void run(){
        try {
          longOp();
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
,null);
  }
  Thread.sleep(500);
  Assert.assertEquals(MAX_POOL_SIZE,threadPoolExecutor.getActiveCount());
  for (int tc=0; tc < TASKS_COUNT; tc++) {
    Future<Runnable> take=service.take();
    Assert.assertTrue(take.isDone());
    Assert.assertTrue("No more than MAX_POOL_SIZE threads should be launched",threadPoolExecutor.getActiveCount() <= MAX_POOL_SIZE);
  }
  threadPoolExecutor.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PredicateBuilderTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterInteger(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThan(1).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThan(99).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").or().property(p2).equals("bar").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").or().property(p2).equals("car").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("fun").or().property(p2).equals("car").toPredicate();
  Assert.assertFalse(predicate3.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimple(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("bar").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessLong(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2L);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThan(99L).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThan(1L).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAndNot(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().not().property(p2).equals("bar").toPredicate();
  Assert.assertFalse(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().not().property(p2).equals("car").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLongOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").or().property(p2).equals("bar").or().property(p3).equals("cat").or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").or().property(p2).equals("car").or().property(p3).equals("cat").or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("fun").or().property(p2).equals("car").or().property(p3).equals("bat").or().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate3.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsDouble(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,1.999);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals(Double.valueOf(1.999)).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals(Double.valueOf(99.998)).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAnd(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().property(p2).equals("bar").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("car").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAndOr(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.property(p1).equals("foo").and().property(p2).equals("bar").or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("car").or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.property(p1).equals("foo").and().property(p2).equals("bar").or().property(p3).equals("can").toPredicate();
  Assert.assertTrue(predicate3.evaluate(resource));
  PredicateBuilder pb4=new PredicateBuilder();
  Predicate predicate4=pb4.property(p1).equals("foo").and().property(p2).equals("bat").or().property(p3).equals("can").toPredicate();
  Assert.assertFalse(predicate4.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessInteger(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThan(99).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThan(1).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterThanEqualToDouble(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2.999);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThanEqualTo(1.999).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThanEqualTo(99.998).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterDouble(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2.999);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThan(1.999).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThan(99.998).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessThanEqualToFloat(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,(float)2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThanEqualTo((float)99).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThanEqualTo((float)1).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLongAnd(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").and().property(p2).equals("bar").and().property(p3).equals("cat").and().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("foo").and().property(p2).equals("bar").and().property(p3).equals("cat").and().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterThanEqualToLong(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2L);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThanEqualTo(1L).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThanEqualTo(99L).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBlocks(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.begin().property(p1).equals("foo").and().property(p2).equals("bar").end().or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.begin().property(p1).equals("foo").and().property(p2).equals("bat").end().or().property(p3).equals("cat").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
  PredicateBuilder pb3=new PredicateBuilder();
  Predicate predicate3=pb3.begin().property(p1).equals("foo").and().property(p2).equals("bar").end().or().property(p3).equals("can").toPredicate();
  Assert.assertTrue(predicate3.evaluate(resource));
  PredicateBuilder pb4=new PredicateBuilder();
  Predicate predicate4=pb4.begin().property(p1).equals("foo").and().property(p2).equals("bat").end().or().property(p3).equals("can").toPredicate();
  Assert.assertFalse(predicate4.evaluate(resource));
  PredicateBuilder pb5=new PredicateBuilder();
  Predicate predicate5=pb5.property(p1).equals("foo").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertTrue(predicate5.evaluate(resource));
  PredicateBuilder pb6=new PredicateBuilder();
  Predicate predicate6=pb6.property(p1).equals("foo").and().begin().property(p2).equals("bat").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertTrue(predicate6.evaluate(resource));
  PredicateBuilder pb7=new PredicateBuilder();
  Predicate predicate7=pb7.property(p1).equals("foo").and().begin().property(p2).equals("bat").or().property(p3).equals("can").end().toPredicate();
  Assert.assertFalse(predicate7.evaluate(resource));
  PredicateBuilder pb8=new PredicateBuilder();
  Predicate predicate8=pb8.property(p1).equals("fat").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertFalse(predicate8.evaluate(resource));
  PredicateBuilder pb9=new PredicateBuilder();
  Predicate predicate9=pb9.property(p1).equals("foo").and().not().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().toPredicate();
  Assert.assertFalse(predicate9.evaluate(resource));
  PredicateBuilder pb10=new PredicateBuilder();
  Predicate predicate10=pb10.property(p1).equals("foo").and().not().begin().property(p2).equals("bat").or().property(p3).equals("car").end().toPredicate();
  Assert.assertTrue(predicate10.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessThanEqualToLong(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2L);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThanEqualTo(99L).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThanEqualTo(1L).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNestedBlocks(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  String p2=PropertyHelper.getPropertyId("cat1","prop2");
  String p3=PropertyHelper.getPropertyId("cat1","prop3");
  String p4=PropertyHelper.getPropertyId("cat1","prop4");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  resource.setProperty(p4,"dog");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.begin().property(p1).equals("foo").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().end().or().property(p4).equals("dog").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.begin().property(p1).equals("fat").and().begin().property(p2).equals("bar").or().property(p3).equals("cat").end().end().or().property(p4).equals("dot").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterFloat(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,(float)2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThan((float)1).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThan((float)99).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAltProperty(){
  String p1="cat1/prop1";
  String p2="cat1/prop2";
  String p3="prop3";
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  resource.setProperty(p2,"bar");
  resource.setProperty(p3,"cat");
  PredicateBuilder pb1=new PredicateBuilder();
  Predicate predicate1=pb1.begin().property("cat1/prop1").equals("foo").and().property("cat1/prop2").equals("bar").end().or().property("prop3").equals("cat").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessThanEqualToInteger(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThanEqualTo(99).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThanEqualTo(1).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterThanEqualToFloat(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,(float)2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThanEqualTo((float)1).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThanEqualTo((float)99).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterLong(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2L);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThan(1L).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThan(99L).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGreaterThanEqualToInteger(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).greaterThanEqualTo(1).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).greaterThanEqualTo(99).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleNot(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.not().property(p1).equals("foo").toPredicate();
  Assert.assertFalse(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.not().property(p1).equals("bar").toPredicate();
  Assert.assertTrue(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessDouble(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2.999);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThan(99.999).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThan(1.998).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsLong(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,1L);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals(1L).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals(99L).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessThanEqualToDouble(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,2.999);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThanEqualTo(99.999).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThanEqualTo(1.998).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsString(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,"foo");
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals("foo").toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals("bar").toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsInteger(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,1);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals(1).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals(99).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLessFloat(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,(float)2);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).lessThan((float)99).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).lessThan((float)1).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsFloat(){
  String p1=PropertyHelper.getPropertyId("cat1","prop1");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(p1,(float)1);
  PredicateBuilder pb=new PredicateBuilder();
  Predicate predicate1=pb.property(p1).equals(Float.valueOf(1)).toPredicate();
  Assert.assertTrue(predicate1.evaluate(resource));
  PredicateBuilder pb2=new PredicateBuilder();
  Predicate predicate2=pb2.property(p1).equals(Float.valueOf(99)).toPredicate();
  Assert.assertFalse(predicate2.evaluate(resource));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PropertyHelperTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testContainsArguments(){
  Assert.assertFalse(PropertyHelper.containsArguments("foo"));
  Assert.assertFalse(PropertyHelper.containsArguments("foo/bar"));
  Assert.assertFalse(PropertyHelper.containsArguments("foo/bar/baz"));
  Assert.assertTrue(PropertyHelper.containsArguments("foo/bar/$1/baz"));
  Assert.assertTrue(PropertyHelper.containsArguments("foo/bar/$1/baz/$2"));
  Assert.assertTrue(PropertyHelper.containsArguments("$1/foo/bar/$2/baz"));
  Assert.assertTrue(PropertyHelper.containsArguments("$1/foo/bar/$2/baz/$3"));
  Assert.assertTrue(PropertyHelper.containsArguments("metrics/yarn/Queue/$1.replaceAll(\",q(\\d+)=\",\"/\").substring(1)"));
  Assert.assertFalse(PropertyHelper.containsArguments("$X/foo/bar/$Y/baz/$Z"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetCategories(){
  String propertyId="metrics/yarn/Queue/$1.replaceAll(\",q(\\d+)=\",\"/\").substring(1)/AppsRunning";
  Set<String> categories=PropertyHelper.getCategories(Collections.singleton(propertyId));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue/$1"));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue"));
  Assert.assertTrue(categories.contains("metrics/yarn"));
  Assert.assertTrue(categories.contains("metrics"));
  String propertyId2="foo/bar/baz";
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(propertyId);
  propertyIds.add(propertyId2);
  categories=PropertyHelper.getCategories(propertyIds);
  Assert.assertTrue(categories.contains("metrics/yarn/Queue/$1"));
  Assert.assertTrue(categories.contains("metrics/yarn/Queue"));
  Assert.assertTrue(categories.contains("metrics/yarn"));
  Assert.assertTrue(categories.contains("metrics"));
  Assert.assertTrue(categories.contains("foo/bar"));
  Assert.assertTrue(categories.contains("foo"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.events.EventsTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that {@link ServiceInstalledEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testServiceInstalledEvent() throws Exception {
  Class<? extends AmbariEvent> eventClass=ServiceInstalledEvent.class;
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  installHdfsService();
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link MaintenanceModeEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testMaintenanceModeEvents() throws Exception {
  installHdfsService();
  Service service=m_cluster.getService("HDFS");
  Class<? extends AmbariEvent> eventClass=MaintenanceModeEvent.class;
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  service.setMaintenanceState(MaintenanceState.ON);
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
  Assert.assertEquals(1,m_listener.getAmbariEventReceivedCount(eventClass));
  m_listener.reset();
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  List<ServiceComponentHost> componentHosts=m_cluster.getServiceComponentHosts(HOSTNAME);
  ServiceComponentHost componentHost=componentHosts.get(0);
  componentHost.setMaintenanceState(MaintenanceState.OFF);
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
  Assert.assertEquals(1,m_listener.getAmbariEventReceivedCount(eventClass));
  m_listener.reset();
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  Host host=m_clusters.getHost(HOSTNAME);
  host.setMaintenanceState(m_cluster.getClusterId(),MaintenanceState.ON);
  host.setMaintenanceState(m_cluster.getClusterId(),MaintenanceState.OFF);
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
  Assert.assertEquals(2,m_listener.getAmbariEventReceivedCount(eventClass));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that {@link ServiceComponentUninstalledEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testServiceComponentUninstalledEvent() throws Exception {
  Class<? extends AmbariEvent> eventClass=ServiceComponentUninstalledEvent.class;
  installHdfsService();
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  m_cluster.getServiceComponentHosts(HOSTNAME).get(0).delete();
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that {@link ServiceRemovedEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testServiceRemovedEvent() throws Exception {
  Class<? extends AmbariEvent> eventClass=ServiceRemovedEvent.class;
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  installHdfsService();
  m_cluster.deleteAllServices();
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link ServiceComponentUninstalledEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testClusterRenameEvent() throws Exception {
  Class<? extends AmbariEvent> eventClass=ClusterEvent.class;
  installHdfsService();
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  m_cluster.setClusterName(UUID.randomUUID().toString());
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
  List<AmbariEvent> ambariEvents=m_listener.getAmbariEventInstances(eventClass);
  Assert.assertEquals(1,ambariEvents.size());
  Assert.assertEquals(AmbariEventType.CLUSTER_RENAME,ambariEvents.get(0).getType());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link ServiceRemovedEvent}s are fired correctly and alerts are
 * removed.
 * @throws Exception
 */
@Test public void testServiceRemovedEventForAlerts() throws Exception {
  Class<? extends AmbariEvent> eventClass=ServiceRemovedEvent.class;
  Assert.assertFalse(m_listener.isAmbariEventReceived(eventClass));
  installHdfsService();
  Assert.assertTrue(m_definitionDao.findAll(m_cluster.getClusterId()).size() > 0);
  List<AlertDefinitionEntity> hdfsDefinitions=m_definitionDao.findByService(m_cluster.getClusterId(),"HDFS");
  Assert.assertTrue(hdfsDefinitions.size() > 0);
  AlertDefinitionEntity definition=hdfsDefinitions.get(0);
  m_cluster.getService("HDFS").delete();
  Assert.assertTrue(m_listener.isAmbariEventReceived(eventClass));
  hdfsDefinitions=m_definitionDao.findByService(m_cluster.getClusterId(),"HDFS");
  Assert.assertEquals(0,hdfsDefinitions.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.metadata.RoleCommandOrderTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDependencies() throws IOException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  InputStream testJsonIS=getClass().getClassLoader().getResourceAsStream(TEST_RCO_DATA_FILE);
  ObjectMapper mapper=new ObjectMapper();
  Map<String,Object> testData=mapper.readValue(testJsonIS,new TypeReference<Map<String,Object>>(){
  }
);
  rco.addDependencies(testData);
  mapper.setVisibility(JsonMethod.ALL,JsonAutoDetect.Visibility.ANY);
  String dump=mapper.writeValueAsString(rco.getDependencies());
  List<String> parts=Arrays.asList(dump.substring(1,522).split(Pattern.quote("],")));
  assertEquals(3,parts.size());
  assertTrue(parts.contains("\"RoleCommandPair{role=SECONDARY_NAMENODE, cmd=UPGRADE}\":[{\"role\":{\"name\":\"NAMENODE\"},\"cmd\":\"UPGRADE\"}"));
  assertTrue(parts.contains("\"RoleCommandPair{role=SECONDARY_NAMENODE, cmd=START}\":[{\"role\":{\"name\":\"NAMENODE\"},\"cmd\":\"START\"}"));
  boolean datanodeCommandExists=false;
  for (  String part : parts) {
    if (part.contains("RoleCommandPair{role=DATANODE, cmd=STOP}")) {
      datanodeCommandExists=true;
      String[] parts2=part.split(Pattern.quote(":["));
      assertEquals(2,parts2.length);
      assertEquals("\"RoleCommandPair{role=DATANODE, cmd=STOP}\"",parts2[0]);
      List<String> components=Arrays.asList(new String[]{"\"role\":{\"name\":\"HBASE_MASTER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"RESOURCEMANAGER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"TASKTRACKER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"NODEMANAGER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"HISTORYSERVER\"},\"cmd\":\"STOP\"","\"role\":{\"name\":\"JOBTRACKER\"},\"cmd\":\"STOP\""});
      Assert.assertTrue(CollectionPresentationUtils.isStringPermutationOfCollection(parts2[1],components,"},{",1,1));
    }
  }
  assertTrue(datanodeCommandExists);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests building dependencies in HA-enabled HDFS cluster. Uses real
 * dependency mapping file (role_command_order.json)
 */
@Test public void testInitializeAtHaHDFSCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  Service hdfsService=createMock(Service.class);
  ServiceComponent journalnodeSC=createMock(ServiceComponent.class);
  expect(cluster.getService("HDFS")).andReturn(hdfsService).atLeastOnce();
  expect(cluster.getService("YARN")).andReturn(null);
  expect(hdfsService.getServiceComponent("JOURNALNODE")).andReturn(journalnodeSC);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  replay(cluster);
  replay(hdfsService);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster);
  verify(hdfsService);
  assertFalse(dependenciesContainBlockedRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.DATANODE));
  assertTrue(dependenciesContainBlockerRole(deps,Role.JOURNALNODE));
  assertTrue(dependenciesContainBlockedRole(deps,Role.ZKFC));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests building dependencies in not HA-enabled HDFS cluster. Uses real
 * dependency mapping file (role_command_order.json)
 */
@Test public void testInitializeAtHDFSCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  Service hdfsService=createMock(Service.class);
  expect(cluster.getService("HDFS")).andReturn(hdfsService).atLeastOnce();
  expect(cluster.getService("YARN")).andReturn(null).atLeastOnce();
  expect(hdfsService.getServiceComponent("JOURNALNODE")).andReturn(null);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  replay(cluster);
  replay(hdfsService);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster);
  verify(hdfsService);
  assertFalse(dependenciesContainBlockedRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.DATANODE));
  assertFalse(dependenciesContainBlockerRole(deps,Role.JOURNALNODE));
  assertFalse(dependenciesContainBlockedRole(deps,Role.ZKFC));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests building dependencies in GLUSTERFS cluster. Uses real dependency mapping
 * file (role_command_order.json)
 */
@Test public void testInitializeAtGLUSTERFSCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  Service service=createMock(Service.class);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  expect(cluster.getService("GLUSTERFS")).andReturn(service);
  expect(cluster.getService("HDFS")).andReturn(null);
  expect(cluster.getService("YARN")).andReturn(null);
  replay(cluster);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster);
  assertFalse(dependenciesContainBlockedRole(deps,Role.DATANODE));
  assertFalse(dependenciesContainBlockedRole(deps,Role.NAMENODE));
  assertFalse(dependenciesContainBlockedRole(deps,Role.SECONDARY_NAMENODE));
  assertFalse(dependenciesContainBlockedRole(deps,Role.JOURNALNODE));
  assertFalse(dependenciesContainBlockedRole(deps,Role.NAMENODE_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.HDFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.HDFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.SECONDARY_NAMENODE));
  assertFalse(dependenciesContainBlockerRole(deps,Role.JOURNALNODE));
  assertFalse(dependenciesContainBlockerRole(deps,Role.NAMENODE_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.HDFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.HDFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransitiveServices() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  Service hdfsService=createMock(Service.class);
  ServiceComponent namenode=createMock(ServiceComponent.class);
  expect(namenode.getName()).andReturn("NAMENODE").anyTimes();
  Map<String,ServiceComponent> hdfsComponents=Collections.singletonMap("NAMENODE",namenode);
  expect(hdfsService.getServiceComponents()).andReturn(hdfsComponents).anyTimes();
  Service hbaseService=createMock(Service.class);
  expect(cluster.getService("HBASE")).andReturn(hbaseService).atLeastOnce();
  expect(hbaseService.getCluster()).andReturn(cluster).anyTimes();
  ServiceComponent hbaseMaster=createMock(ServiceComponent.class);
  expect(hbaseMaster.getName()).andReturn("HBASE_MASTER").anyTimes();
  Map<String,ServiceComponent> hbaseComponents=Collections.singletonMap("HBASE_MASTER",hbaseMaster);
  expect(hbaseService.getServiceComponents()).andReturn(hbaseComponents).anyTimes();
  Map<String,Service> installedServices=new HashMap<String,Service>();
  installedServices.put("HDFS",hdfsService);
  installedServices.put("HBASE",hbaseService);
  expect(cluster.getServices()).andReturn(installedServices).atLeastOnce();
  expect(cluster.getService("HDFS")).andReturn(hdfsService).atLeastOnce();
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  expect(cluster.getService("YARN")).andReturn(null);
  expect(hdfsService.getServiceComponent("JOURNALNODE")).andReturn(null);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.5"));
  replay(cluster,hdfsService,hbaseService,hbaseMaster,namenode);
  rco.initialize(cluster);
  Set<Service> transitiveServices=rco.getTransitiveServices(cluster.getService("HBASE"),RoleCommand.START);
  Assert.assertNotNull(transitiveServices);
  Assert.assertFalse(transitiveServices.isEmpty());
  Assert.assertEquals(1,transitiveServices.size());
  Assert.assertTrue(transitiveServices.contains(hdfsService));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeAtHaRMCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  ServiceComponentHost sch1=createMock(ServiceComponentHostImpl.class);
  ServiceComponentHost sch2=createMock(ServiceComponentHostImpl.class);
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  Map<String,ServiceComponentHost> hostComponents=new HashMap<String,ServiceComponentHost>();
  hostComponents.put("1",sch1);
  hostComponents.put("2",sch2);
  Service yarnService=createMock(Service.class);
  ServiceComponent resourcemanagerSC=createMock(ServiceComponent.class);
  expect(cluster.getService("YARN")).andReturn(yarnService).atLeastOnce();
  expect(cluster.getService("HDFS")).andReturn(null);
  expect(yarnService.getServiceComponent("RESOURCEMANAGER")).andReturn(resourcemanagerSC).anyTimes();
  expect(resourcemanagerSC.getServiceComponentHosts()).andReturn(hostComponents).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  replay(cluster,yarnService,sch1,sch2,resourcemanagerSC);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster,yarnService);
  assertFalse(dependenciesContainBlockedRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.DATANODE));
  RoleCommandPair rmPair=new RoleCommandPair(Role.RESOURCEMANAGER,RoleCommand.START);
  Set<RoleCommandPair> rmRoleCommandPairs=deps.get(rmPair);
  assertNotNull(rmRoleCommandPairs);
  boolean isZookeeperStartPresent=false;
  for (  RoleCommandPair pair : rmRoleCommandPairs) {
    if (pair.cmd == RoleCommand.START && pair.getRole() == Role.ZOOKEEPER_SERVER) {
      isZookeeperStartPresent=true;
    }
  }
  assertTrue(isZookeeperStartPresent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.DBAccessorImplTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTableExists() throws Exception {
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  Statement statement=dbAccessor.getConnection().createStatement();
  String tableName=getFreeTableName();
  statement.execute("Create table " + tableName + " (id VARCHAR(255))");
  Assert.assertTrue(dbAccessor.tableExists(tableName));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTableHasFKConstraint() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  List<DBColumnInfo> columns=new ArrayList<DBColumnInfo>();
  columns.add(new DBColumnInfo("fid",Long.class,null,null,false));
  columns.add(new DBColumnInfo("fname",String.class,null,null,false));
  String foreignTableName=getFreeTableName();
  dbAccessor.createTable(foreignTableName,columns,"fid");
  Statement statement=dbAccessor.getConnection().createStatement();
  statement.execute("ALTER TABLE " + foreignTableName + " ADD CONSTRAINT FK_test FOREIGN KEY (fid) REFERENCES "+ tableName+ " (id)");
  Assert.assertTrue(dbAccessor.tableHasForeignKey(foreignTableName,tableName,"fid","id"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testColumnExists() throws Exception {
  String tableName=getFreeTableName();
  createMyTable(tableName);
  DBAccessorImpl dbAccessor=injector.getInstance(DBAccessorImpl.class);
  Assert.assertTrue(dbAccessor.tableHasColumn(tableName,"time"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.TestOrmImpl </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSortedCommands(){
  injector.getInstance(OrmTestHelper.class).createStageCommands();
  HostRoleCommandDAO hostRoleCommandDAO=injector.getInstance(HostRoleCommandDAO.class);
  HostDAO hostDAO=injector.getInstance(HostDAO.class);
  StageDAO stageDAO=injector.getInstance(StageDAO.class);
  List<HostRoleCommandEntity> list=hostRoleCommandDAO.findSortedCommandsByStageAndHost(stageDAO.findByActionId("1-1"),hostDAO.findByName("test_host1"));
  log.info("command '{}' - taskId '{}' ",list.get(0).getRoleCommand(),list.get(0).getTaskId());
  log.info("command '{}' - taskId '{}'",list.get(1).getRoleCommand(),list.get(1).getTaskId());
  assertTrue(list.get(0).getTaskId() < list.get(1).getTaskId());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * persistence provider is responsible for returning empty collection if relation doesn't exists
 */
@Test public void testEmptyPersistentCollection(){
  String testClusterName="test_cluster2";
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  ResourceTypeDAO resourceTypeDAO=injector.getInstance(ResourceTypeDAO.class);
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceType.CLUSTER.getId());
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceType.CLUSTER.getId());
    resourceTypeEntity.setName(ResourceType.CLUSTER.name());
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  StackEntity stackEntity=stackDAO.find("HDP","2.2.0");
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterName(testClusterName);
  clusterEntity.setResource(resourceEntity);
  clusterEntity.setDesiredStack(stackEntity);
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  clusterDAO.create(clusterEntity);
  clusterEntity=clusterDAO.findByName(clusterEntity.getClusterName());
  assertTrue("empty relation wasn't instantiated",clusterEntity.getHostEntities() != null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertDispatchDAOTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when creating a new {@link AlertDefinitionEntity}, if the group
 * for its service does not exist, then it will be created.
 */
@Test public void testDefaultGroupAutomaticCreation() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  AlertGroupEntity hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  m_dao.remove(hdfsGroup);
  hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNull(hdfsGroup);
  AlertDefinitionEntity datanodeProcess=new AlertDefinitionEntity();
  datanodeProcess.setClusterId(cluster.getClusterId());
  datanodeProcess.setDefinitionName("datanode_process");
  datanodeProcess.setServiceName("HDFS");
  datanodeProcess.setComponentName("DATANODE");
  datanodeProcess.setHash(UUID.randomUUID().toString());
  datanodeProcess.setScheduleInterval(60);
  datanodeProcess.setScope(Scope.SERVICE);
  datanodeProcess.setSource("{\"type\" : \"SCRIPT\"}");
  datanodeProcess.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(datanodeProcess);
  hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNotNull(hdfsGroup);
  assertTrue(hdfsGroup.isDefault());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testGlobalTargetAssociations() throws Exception {
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(0,group.getAlertTargets().size());
  AlertTargetEntity target=m_helper.createGlobalAlertTarget();
  assertTrue(target.isGlobal());
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(1,group.getAlertTargets().size());
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  target=m_dao.findTargetById(target.getTargetId());
  assertEquals(groups.size(),target.getAlertGroups().size());
  m_dao.remove(target);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(0,group.getAlertTargets().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindDefaultGroup() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  AlertGroupEntity hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNotNull(hdfsGroup);
  assertTrue(hdfsGroup.isDefault());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that a newly created group is correctly associated with all global
 * targets.
 */
@Test public void testGlobalTargetAssociatedWithNewGroup() throws Exception {
  AlertTargetEntity target1=m_helper.createGlobalAlertTarget();
  AlertTargetEntity target2=m_helper.createGlobalAlertTarget();
  assertTrue(target1.isGlobal());
  assertTrue(target2.isGlobal());
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(2,group.getAlertTargets().size());
  Iterator<AlertTargetEntity> iterator=group.getAlertTargets().iterator();
  AlertTargetEntity groupTarget1=iterator.next();
  AlertTargetEntity groupTarget2=iterator.next();
  assertTrue(groupTarget1.isGlobal());
  assertTrue(groupTarget2.isGlobal());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that JPA does the sorting work for us.
 * @throws Exception
 */
@Test public void testAlertNoticeSorting() throws Exception {
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  m_alertHelper.populateData(cluster);
  List<SortRequestProperty> sortProperties=new ArrayList<SortRequestProperty>();
  SortRequest sortRequest=new SortRequestImpl(sortProperties);
  AlertNoticeRequest request=new AlertNoticeRequest();
  request.Sort=sortRequest;
  Predicate clusterPredicate=new PredicateBuilder().property(AlertNoticeResourceProvider.ALERT_NOTICE_CLUSTER_NAME).equals("c1").toPredicate();
  request.Predicate=clusterPredicate;
  sortProperties.add(new SortRequestProperty(AlertNoticeResourceProvider.ALERT_NOTICE_ID,Order.ASC));
  List<AlertNoticeEntity> notices=m_dao.findAllNotices(request);
  assertEquals(3,notices.size());
  long lastId=0L;
  for (  AlertNoticeEntity notice : notices) {
    if (lastId == 0L) {
      lastId=notice.getNotificationId();
      continue;
    }
    long currentId=notice.getNotificationId();
    assertTrue(lastId < currentId);
    lastId=currentId;
  }
  sortProperties.clear();
  sortProperties.add(new SortRequestProperty(AlertNoticeResourceProvider.ALERT_NOTICE_ID,Order.DESC));
  notices=m_dao.findAllNotices(request);
  assertEquals(3,notices.size());
  lastId=0L;
  for (  AlertNoticeEntity notice : notices) {
    if (lastId == 0L) {
      lastId=notice.getNotificationId();
      continue;
    }
    long currentId=notice.getNotificationId();
    assertTrue(lastId > currentId);
    lastId=currentId;
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testDeleteTarget() throws Exception {
  AlertTargetEntity target=m_helper.createAlertTarget();
  target=m_dao.findTargetById(target.getTargetId());
  assertTrue(target.getAlertStates().size() > 0);
  assertNotNull(target);
  m_dao.remove(target);
  target=m_dao.findTargetById(target.getTargetId());
  assertNull(target);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 */
@Test public void testCreateGlobalTarget() throws Exception {
  AlertTargetEntity target=m_helper.createGlobalAlertTarget();
  assertTrue(target.isGlobal());
  target=m_dao.findTargetByName(target.getTargetName());
  assertTrue(target.isGlobal());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when creating a new {@link AlertDefinitionEntity}, if the group
 * for its service does not exist, then it will not be created if the service
 * is invalid.
 */
@Test(expected=AmbariException.class) public void testDefaultGroupInvalidServiceNoCreation() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  assertEquals(12,m_dao.findAllGroups().size());
  AlertDefinitionEntity datanodeProcess=new AlertDefinitionEntity();
  datanodeProcess.setClusterId(cluster.getClusterId());
  datanodeProcess.setDefinitionName("datanode_process");
  datanodeProcess.setServiceName("INVALID");
  datanodeProcess.setComponentName("DATANODE");
  datanodeProcess.setHash(UUID.randomUUID().toString());
  datanodeProcess.setScheduleInterval(60);
  datanodeProcess.setScope(Scope.SERVICE);
  datanodeProcess.setSource("{\"type\" : \"SCRIPT\"}");
  datanodeProcess.setSourceType(SourceType.SCRIPT);
  try {
    m_definitionDao.create(datanodeProcess);
  }
  finally {
    assertEquals(12,m_dao.findAllGroups().size());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testGroupDefinitions() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  for (  AlertDefinitionEntity definition : definitions) {
    group.addAlertDefinition(definition);
  }
  m_dao.merge(group);
  group=m_dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
  m_definitionDao.refresh(definitions.get(0));
  m_definitionDao.remove(definitions.get(0));
  definitions.remove(0);
  group=m_dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertsDAOTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that the Ambari sort is correctly applied to JPA quuery.
 * @throws Exception
 */
@Test public void testAlertCurrentSorting() throws Exception {
  AlertCurrentRequest request=new AlertCurrentRequest();
  Predicate clusterPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_CLUSTER_NAME).equals(m_cluster.getClusterName()).toPredicate();
  request.Predicate=clusterPredicate;
  SortRequestProperty sortRequestProperty=new SortRequestProperty(AlertResourceProvider.ALERT_ID,Order.ASC);
  request.Sort=new SortRequestImpl(Collections.singletonList(sortRequestProperty));
  List<AlertCurrentEntity> currentAlerts=m_dao.findAll(request);
  assertTrue(currentAlerts.size() >= 5);
  long lastId=Long.MIN_VALUE;
  for (  AlertCurrentEntity alert : currentAlerts) {
    assertTrue(lastId < alert.getAlertId());
    lastId=alert.getAlertId();
  }
  sortRequestProperty=new SortRequestProperty(AlertResourceProvider.ALERT_ID,Order.DESC);
  request.Sort=new SortRequestImpl(Collections.singletonList(sortRequestProperty));
  currentAlerts=m_dao.findAll(request);
  assertTrue(currentAlerts.size() >= 5);
  lastId=Long.MAX_VALUE;
  for (  AlertCurrentEntity alert : currentAlerts) {
    assertTrue(lastId > alert.getAlertId());
    lastId=alert.getAlertId();
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that JPA does the sorting work for us.
 * @throws Exception
 */
@Test public void testAlertHistorySorting() throws Exception {
  m_helper.installHdfsService(m_cluster,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  m_alertHelper.populateData(m_cluster);
  List<SortRequestProperty> sortProperties=new ArrayList<SortRequestProperty>();
  SortRequest sortRequest=new SortRequestImpl(sortProperties);
  AlertHistoryRequest request=new AlertHistoryRequest();
  request.Sort=sortRequest;
  Predicate clusterPredicate=new PredicateBuilder().property(AlertHistoryResourceProvider.ALERT_HISTORY_CLUSTER_NAME).equals("c1").toPredicate();
  request.Predicate=clusterPredicate;
  sortProperties.add(new SortRequestProperty(AlertHistoryResourceProvider.ALERT_HISTORY_SERVICE_NAME,Order.ASC));
  List<AlertHistoryEntity> histories=m_dao.findAll(request);
  assertEquals(3,histories.size());
  String lastServiceName=null;
  for (  AlertHistoryEntity history : histories) {
    if (null == lastServiceName) {
      lastServiceName=history.getServiceName();
      continue;
    }
    String currentServiceName=history.getServiceName();
    assertTrue(lastServiceName.compareTo(currentServiceName) <= 0);
    lastServiceName=currentServiceName;
  }
  sortProperties.clear();
  sortProperties.add(new SortRequestProperty(AlertHistoryResourceProvider.ALERT_HISTORY_SERVICE_NAME,Order.DESC));
  histories=m_dao.findAll(request);
  assertEquals(3,histories.size());
  lastServiceName=null;
  for (  AlertHistoryEntity history : histories) {
    if (null == lastServiceName) {
      lastServiceName=history.getServiceName();
      continue;
    }
    String currentServiceName=history.getServiceName();
    assertTrue(lastServiceName.compareTo(currentServiceName) >= 0);
    lastServiceName=currentServiceName;
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests <a
 * href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=398067">https:/
 * /bugs.eclipse.org/bugs/show_bug.cgi?id=398067</a> which causes an inner
 * entity to be stale.
 */
@Test public void testJPAInnerEntityStaleness(){
  List<AlertCurrentEntity> currents=m_dao.findCurrent();
  AlertCurrentEntity current=currents.get(0);
  AlertHistoryEntity oldHistory=current.getAlertHistory();
  AlertHistoryEntity newHistory=new AlertHistoryEntity();
  newHistory.setAlertDefinition(oldHistory.getAlertDefinition());
  newHistory.setAlertInstance(oldHistory.getAlertInstance());
  newHistory.setAlertLabel(oldHistory.getAlertLabel());
  if (oldHistory.getAlertState() == AlertState.OK) {
    newHistory.setAlertState(AlertState.CRITICAL);
  }
 else {
    newHistory.setAlertState(AlertState.OK);
  }
  newHistory.setAlertText("New History");
  newHistory.setClusterId(oldHistory.getClusterId());
  newHistory.setAlertTimestamp(System.currentTimeMillis());
  newHistory.setComponentName(oldHistory.getComponentName());
  newHistory.setHostName(oldHistory.getHostName());
  newHistory.setServiceName(oldHistory.getServiceName());
  m_dao.create(newHistory);
  assertTrue(newHistory.getAlertId().longValue() != oldHistory.getAlertId().longValue());
  current.setAlertHistory(newHistory);
  m_dao.merge(current);
  AlertCurrentEntity newCurrent=m_dao.findCurrentByHostAndName(newHistory.getClusterId(),newHistory.getHostName(),newHistory.getAlertDefinition().getDefinitionName());
  assertEquals(newHistory.getAlertId(),newCurrent.getAlertHistory().getAlertId());
  assertEquals(newHistory.getAlertState(),newCurrent.getAlertHistory().getAlertState());
  newCurrent=m_dao.findCurrentById(current.getAlertId());
  assertEquals(newHistory.getAlertId(),newCurrent.getAlertHistory().getAlertId());
  assertEquals(newHistory.getAlertState(),newCurrent.getAlertHistory().getAlertState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ConfigGroupDAOTest </h4><pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindConfigsByGroup() throws Exception {
  StackEntity stackEntity=stackDAO.find("HDP","0.1");
  ClusterConfigEntity configEntity=new ClusterConfigEntity();
  configEntity.setType("core-site");
  configEntity.setTag("version1");
  configEntity.setData("someData");
  configEntity.setAttributes("someAttributes");
  configEntity.setStack(stackEntity);
  List<ClusterConfigEntity> configEntities=new ArrayList<ClusterConfigEntity>();
  configEntities.add(configEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",null,configEntities);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupConfigMappingEntities().size() > 0);
  List<ConfigGroupConfigMappingEntity> configMappingEntities=configGroupConfigMappingDAO.findByGroup(configGroupEntity.getGroupId());
  Assert.assertNotNull(configEntities);
  Assert.assertEquals("core-site",configEntities.get(0).getType());
  Assert.assertEquals("version1",configEntities.get(0).getTag());
  Assert.assertEquals("someData",configEntities.get(0).getData());
  Assert.assertEquals("someAttributes",configEntities.get(0).getAttributes());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByHost() throws Exception {
  List<HostEntity> hosts=new ArrayList<HostEntity>();
  HostEntity hostEntity=new HostEntity();
  hostEntity.setHostName("h1");
  hostEntity.setOsType("centOS");
  hosts.add(hostEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",hosts,null);
  Assert.assertNotNull(hostEntity.getHostId());
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupHostMappingEntities().size() > 0);
  Assert.assertNotNull(configGroupEntity.getConfigGroupHostMappingEntities().iterator().next());
  Set<ConfigGroupHostMapping> hostMappingEntities=configGroupHostMappingDAO.findByHostId(hostEntity.getHostId());
  Assert.assertNotNull(hostMappingEntities);
  for (  ConfigGroupHostMapping hostMappingEntity : hostMappingEntities) {
    Assert.assertEquals(hostEntity.getHostId(),hostMappingEntity.getHostId());
    Assert.assertEquals("centOS",hostMappingEntity.getHost().getOsType());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.CrudDAOTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreate(){
  createSingleRecord();
  Assert.assertTrue(repositoryVersionDAO.findAll().size() == 1);
  createSingleRecord();
  Assert.assertTrue(repositoryVersionDAO.findAll().size() == 2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.HostRoleCommandDAOTest </h4><pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that setting the auto-skip feature of a {@link HostRoleCommandEntity}is somewhat dependenant on the {@link StageEntity}'s support for it.
 */
@Test public void testAutoSkipSupport(){
  OrmTestHelper helper=m_injector.getInstance(OrmTestHelper.class);
  helper.createDefaultData();
  Long requestId=Long.valueOf(100L);
  ClusterEntity clusterEntity=m_clusterDAO.findByName("test_cluster1");
  RequestEntity requestEntity=new RequestEntity();
  requestEntity.setRequestId(requestId);
  requestEntity.setClusterId(clusterEntity.getClusterId());
  requestEntity.setStages(new ArrayList<StageEntity>());
  m_requestDAO.create(requestEntity);
  AtomicLong stageId=new AtomicLong(1);
  HostEntity host=m_hostDAO.findByName("test_host1");
  host.setHostRoleCommandEntities(new ArrayList<HostRoleCommandEntity>());
  long stageIdAutoSkipAll=stageId.getAndIncrement();
  createStage(stageIdAutoSkipAll,3,host,requestEntity,HostRoleStatus.PENDING,true,true,true);
  List<HostRoleCommandEntity> tasks=m_hostRoleCommandDAO.findByRequest(requestId);
  for (  HostRoleCommandEntity task : tasks) {
    Assert.assertTrue(task.isFailureAutoSkipped());
  }
  long stageIdSkippableButNoAutoSkip=stageId.getAndIncrement();
  createStage(stageIdSkippableButNoAutoSkip,3,host,requestEntity,HostRoleStatus.PENDING,true,false,true);
  tasks=m_hostRoleCommandDAO.findByRequest(requestId);
  for (  HostRoleCommandEntity task : tasks) {
    StageEntity stage=task.getStage();
    if (stage.getStageId() == stageIdAutoSkipAll) {
      Assert.assertTrue(task.isFailureAutoSkipped());
    }
 else     if (stage.getStageId() == stageIdSkippableButNoAutoSkip) {
      Assert.assertFalse(task.isFailureAutoSkipped());
    }
  }
  m_hostRoleCommandDAO.updateAutomaticSkipOnFailure(requestId,false,false);
  tasks=m_hostRoleCommandDAO.findByRequest(requestId);
  for (  HostRoleCommandEntity task : tasks) {
    Assert.assertFalse(task.isFailureAutoSkipped());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RepositoryVersionDAOTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate(){
  UUID uuid=UUID.randomUUID();
  RepositoryVersionEntity first=createSingleRecord();
  Assert.assertNotNull(first);
  StackEntity stackEntity=stackDAO.find(first.getStackName(),first.getStackVersion());
  Assert.assertNotNull(stackEntity);
  RepositoryVersionEntity dupVersion=new RepositoryVersionEntity();
  dupVersion.setDisplayName("display name " + uuid.toString());
  dupVersion.setOperatingSystems("repositories");
  dupVersion.setStack(stackEntity);
  dupVersion.setVersion(first.getVersion());
  boolean exceptionThrown=false;
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("already exists"));
  }
  Assert.assertTrue(exceptionThrown);
  exceptionThrown=false;
  dupVersion.setVersion("2.3-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("needs to belong to stack"));
  }
  Assert.assertTrue(exceptionThrown);
  dupVersion.setVersion(stackEntity.getStackVersion() + "-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    Assert.fail("Did not expect a failure creating the Repository Version");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RequestScheduleDAOTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateRequestSchedule() throws Exception {
  RequestScheduleEntity scheduleEntity=createScheduleEntity();
  Assert.assertTrue(scheduleEntity.getScheduleId() > 0);
  Assert.assertEquals("SCHEDULED",scheduleEntity.getStatus());
  Assert.assertEquals("12",scheduleEntity.getHours());
  RequestScheduleBatchRequestEntity batchRequestEntity=scheduleEntity.getRequestScheduleBatchRequestEntities().iterator().next();
  Assert.assertNotNull(batchRequestEntity);
  Assert.assertEquals(testUri,batchRequestEntity.getRequestUri());
  Assert.assertEquals(testType,batchRequestEntity.getRequestType());
  Assert.assertEquals(testBody,batchRequestEntity.getRequestBodyAsString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ServiceConfigDAOTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLastServiceConfig() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.getLastServiceConfig(1L,"HDFS");
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(2222L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(2),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLastServiceConfigs() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  List<ServiceConfigEntity> serviceConfigEntities=serviceConfigDAO.getLastServiceConfigs(clusterDAO.findByName("c1").getClusterId());
  Assert.assertNotNull(serviceConfigEntities);
  Assert.assertEquals(2,serviceConfigEntities.size());
  for (  ServiceConfigEntity sce : serviceConfigEntities) {
    if ("HDFS".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(2222L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(2),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
    if ("YARN".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(3333L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(1),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
    Assert.assertEquals("admin",sce.getUser());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfiguration() throws Exception {
  initClusterEntities();
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  Assert.assertTrue(!clusterEntity.getClusterConfigEntities().isEmpty());
  Assert.assertTrue(!clusterEntity.getConfigMappingEntities().isEmpty());
  Assert.assertEquals(5,clusterEntity.getClusterConfigEntities().size());
  Assert.assertEquals(3,clusterEntity.getConfigMappingEntities().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByServiceAndVersion() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.findByServiceAndVersion("HDFS",1L);
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindServiceConfigEntity() throws Exception {
  ServiceConfigEntity sce=createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.find(sce.getServiceConfigId());
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceConfigs() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  List<ServiceConfigEntity> serviceConfigEntities=serviceConfigDAO.getServiceConfigs(clusterDAO.findByName("c1").getClusterId());
  Assert.assertNotNull(serviceConfigEntities);
  Assert.assertEquals(3,serviceConfigEntities.size());
  for (  ServiceConfigEntity sce : serviceConfigEntities) {
    if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 1)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(1111L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 2)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(2222L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("YARN".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(3333L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(1),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else {
      Assert.fail();
    }
    Assert.assertEquals("admin",sce.getUser());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceConfigVersion() throws Exception {
  ServiceConfigEntity serviceConfigEntity=createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.StageDAOTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that JPA does the sorting work for us.
 */
@Test public void testStageSorting() throws Exception {
  List<SortRequestProperty> sortProperties=new ArrayList<SortRequestProperty>();
  SortRequest sortRequest=new SortRequestImpl(sortProperties);
  Predicate predicate=new PredicateBuilder().property(StageResourceProvider.STAGE_CLUSTER_NAME).equals("c1").toPredicate();
  sortProperties.add(new SortRequestProperty(StageResourceProvider.STAGE_LOG_INFO,SortRequest.Order.ASC));
  Request request=PropertyHelper.getReadRequest(new HashSet<String>(Arrays.<String>asList()),null,null,null,sortRequest);
  List<StageEntity> entities=stageDao.findAll(request,predicate);
  assertEquals(5,entities.size());
  String lastInfo=null;
  for (  StageEntity entity : entities) {
    if (lastInfo == null) {
      lastInfo=entity.getLogInfo();
      continue;
    }
    String currentInfo=entity.getLogInfo();
    assertTrue(lastInfo.compareTo(currentInfo) <= 0);
    lastInfo=currentInfo;
  }
  sortProperties.clear();
  sortProperties.add(new SortRequestProperty(StageResourceProvider.STAGE_LOG_INFO,SortRequest.Order.DESC));
  entities=stageDao.findAll(request,predicate);
  assertEquals(5,entities.size());
  lastInfo=null;
  for (  StageEntity entity : entities) {
    if (null == lastInfo) {
      lastInfo=entity.getLogInfo();
      continue;
    }
    String currentInfo=entity.getLogInfo();
    assertTrue(lastInfo.compareTo(currentInfo) >= 0);
    lastInfo=currentInfo;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.UpgradeDAOTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that certain columns in an {@link UpgradeEntity} are updatable.
 * @throws Exception
 */
@Test public void testUpdatableColumns() throws Exception {
  UpgradeEntity upgradeEntity=new UpgradeEntity();
  upgradeEntity.setId(11L);
  upgradeEntity.setClusterId(Long.valueOf(1));
  upgradeEntity.setDirection(Direction.UPGRADE);
  upgradeEntity.setRequestId(Long.valueOf(1));
  upgradeEntity.setFromVersion("2.2.0.0-1234");
  upgradeEntity.setToVersion("2.3.0.0-4567");
  upgradeEntity.setUpgradeType(UpgradeType.ROLLING);
  upgradeEntity.setUpgradePackage("test-upgrade");
  dao.create(upgradeEntity);
  UpgradeEntity lastUpgradeForCluster=dao.findLastUpgradeForCluster(1);
  Assert.assertFalse(lastUpgradeForCluster.isComponentFailureAutoSkipped());
  Assert.assertFalse(lastUpgradeForCluster.isServiceCheckFailureAutoSkipped());
  lastUpgradeForCluster.setAutoSkipComponentFailures(true);
  lastUpgradeForCluster.setAutoSkipServiceCheckFailures(true);
  dao.merge(lastUpgradeForCluster);
  lastUpgradeForCluster=dao.findLastUpgradeForCluster(1);
  Assert.assertTrue(lastUpgradeForCluster.isComponentFailureAutoSkipped());
  Assert.assertTrue(lastUpgradeForCluster.isServiceCheckFailureAutoSkipped());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindUpgrade() throws Exception {
  List<UpgradeEntity> items=dao.findUpgrades(clusterId.longValue());
  assertTrue(items.size() > 0);
  UpgradeEntity entity=dao.findUpgrade(items.get(0).getId().longValue());
  assertNotNull(entity);
  assertEquals(1,entity.getUpgradeGroups().size());
  UpgradeGroupEntity group=dao.findUpgradeGroup(entity.getUpgradeGroups().get(0).getId().longValue());
  assertNotNull(group);
  Assert.assertNotSame(entity.getUpgradeGroups().get(0),group);
  assertEquals("group_name",group.getName());
  assertEquals("group title",group.getTitle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.BlueprintConfigEntityPKTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  BlueprintConfigEntityPK pk=new BlueprintConfigEntityPK();
  BlueprintConfigEntityPK pk2=new BlueprintConfigEntityPK();
  pk.setBlueprintName("foo");
  pk.setType("core-site");
  pk2.setBlueprintName("foo");
  pk2.setType("core-site");
  assertEquals(pk,pk2);
  assertEquals(pk2,pk);
  pk.setBlueprintName("foo2");
  assertFalse(pk.equals(pk2));
  assertFalse(pk2.equals(pk));
  pk2.setBlueprintName("foo2");
  assertEquals(pk,pk2);
  assertEquals(pk2,pk);
  pk.setType("other-type");
  assertFalse(pk.equals(pk2));
  assertFalse(pk2.equals(pk));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.HostEntityTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveHostComponentStateEntity() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentStateEntity stateEntity=new HostComponentStateEntity();
  hostEntity.setHostComponentStateEntities(new HashSet<HostComponentStateEntity>());
  Collection<HostComponentStateEntity> stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.isEmpty());
  hostEntity.addHostComponentStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.contains(stateEntity));
  hostEntity.removeHostComponentStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentStateEntities();
  assertFalse(stateEntities.contains(stateEntity));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveHostComponentDesiredStateEntity() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentDesiredStateEntity stateEntity=new HostComponentDesiredStateEntity();
  hostEntity.setHostComponentDesiredStateEntities(new HashSet<HostComponentDesiredStateEntity>());
  Collection<HostComponentDesiredStateEntity> stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.isEmpty());
  hostEntity.addHostComponentDesiredStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.contains(stateEntity));
  hostEntity.removeHostComponentDesiredStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertFalse(stateEntities.contains(stateEntity));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAddHostComponentStateEntity() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentStateEntity stateEntity=new HostComponentStateEntity();
  hostEntity.setHostComponentStateEntities(new HashSet<HostComponentStateEntity>());
  Collection<HostComponentStateEntity> stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.isEmpty());
  hostEntity.addHostComponentStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.contains(stateEntity));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponentStateEntities() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentStateEntity stateEntity=new HostComponentStateEntity();
  hostEntity.setHostComponentStateEntities(new HashSet<HostComponentStateEntity>());
  Collection<HostComponentStateEntity> stateEntities=hostEntity.getHostComponentStateEntities();
  assertTrue(stateEntities.isEmpty());
  try {
    stateEntities.add(stateEntity);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponentDesiredStateEntities() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentDesiredStateEntity stateEntity=new HostComponentDesiredStateEntity();
  hostEntity.setHostComponentDesiredStateEntities(new HashSet<HostComponentDesiredStateEntity>());
  Collection<HostComponentDesiredStateEntity> stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.isEmpty());
  try {
    stateEntities.add(stateEntity);
    fail("Expected UnsupportedOperationException");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAddHostComponentDesiredStateEntity() throws Exception {
  HostEntity hostEntity=new HostEntity();
  HostComponentDesiredStateEntity stateEntity=new HostComponentDesiredStateEntity();
  hostEntity.setHostComponentDesiredStateEntities(new HashSet<HostComponentDesiredStateEntity>());
  Collection<HostComponentDesiredStateEntity> stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.isEmpty());
  hostEntity.addHostComponentDesiredStateEntity(stateEntity);
  stateEntities=hostEntity.getHostComponentDesiredStateEntities();
  assertTrue(stateEntities.contains(stateEntity));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.HostGroupConfigEntityPKTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  HostGroupConfigEntityPK pk1=new HostGroupConfigEntityPK();
  HostGroupConfigEntityPK pk2=new HostGroupConfigEntityPK();
  pk1.setType("foo");
  pk2.setType("foo");
  pk1.setBlueprintName("bp");
  pk2.setBlueprintName("bp");
  pk1.setHostGroupName("hg");
  pk2.setHostGroupName("hg");
  assertEquals(pk1,pk2);
  pk1.setType("something_else");
  assertFalse(pk1.equals(pk2));
  pk2.setType("something_else");
  assertEquals(pk1,pk2);
  pk1.setType("other_type");
  assertFalse(pk1.equals(pk2));
  pk2.setType("other_type");
  assertEquals(pk1,pk2);
  pk1.setHostGroupName("hg2");
  assertFalse(pk1.equals(pk2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewEntityEntityTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws Exception {
  ViewEntityEntity viewEntityEntity=new ViewEntityEntity();
  viewEntityEntity.setId(99L);
  viewEntityEntity.setClassName("TestClass");
  viewEntityEntity.setIdProperty("id");
  viewEntityEntity.setViewName("foo");
  viewEntityEntity.setViewInstanceName("bar");
  ViewEntityEntity viewEntityEntity2=new ViewEntityEntity();
  viewEntityEntity2.setId(99L);
  viewEntityEntity2.setClassName("TestClass");
  viewEntityEntity2.setIdProperty("id");
  viewEntityEntity2.setViewName("foo");
  viewEntityEntity2.setViewInstanceName("bar");
  Assert.assertTrue(viewEntityEntity.equals(viewEntityEntity2));
  viewEntityEntity2.setId(100L);
  Assert.assertFalse(viewEntityEntity.equals(viewEntityEntity2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewEntityTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddGetInstanceDefinition() throws Exception {
  ViewEntity viewDefinition=getViewEntity();
  ViewInstanceEntity definition=createNiceMock(ViewInstanceEntity.class);
  expect(definition.getName()).andReturn("instance1").anyTimes();
  replay(definition);
  viewDefinition.addInstanceDefinition(definition);
  Assert.assertEquals(definition,viewDefinition.getInstanceDefinition("instance1"));
  Collection<ViewInstanceEntity> definitions=viewDefinition.getInstances();
  Assert.assertEquals(1,definitions.size());
  Assert.assertTrue(definitions.contains(definition));
  verify(definition);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSetIsSystem() throws Exception {
  ViewEntity viewDefinition=getViewEntity();
  viewDefinition.setSystem(false);
  Assert.assertFalse(viewDefinition.isSystem());
  viewDefinition.setSystem(true);
  Assert.assertTrue(viewDefinition.isSystem());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsClusterConfigurable() throws Exception {
  ViewConfig viewConfig=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=getViewEntity(viewConfig);
  Assert.assertEquals(viewConfig,viewDefinition.getConfiguration());
  ViewConfig newViewConfig=ViewConfigTest.getConfig();
  viewDefinition.setConfiguration(newViewConfig);
  Assert.assertTrue(viewDefinition.isClusterConfigurable());
  newViewConfig=ViewConfigTest.getConfig(with_ambari_versions);
  viewDefinition.setConfiguration(newViewConfig);
  Assert.assertFalse(viewDefinition.isClusterConfigurable());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddGetResourceProvider() throws Exception {
  ViewEntity viewDefinition=getViewEntity();
  ResourceProvider provider1=createNiceMock(ResourceProvider.class);
  Resource.Type type1=new Resource.Type("myType1");
  viewDefinition.addResourceProvider(type1,provider1);
  Assert.assertEquals(provider1,viewDefinition.getResourceProvider(type1));
  ResourceProvider provider2=createNiceMock(ResourceProvider.class);
  Resource.Type type2=new Resource.Type("myType2");
  viewDefinition.addResourceProvider(type2,provider2);
  Assert.assertEquals(provider2,viewDefinition.getResourceProvider(type2));
  Set<Resource.Type> types=viewDefinition.getViewResourceTypes();
  Assert.assertEquals(2,types.size());
  Assert.assertTrue(types.contains(type1));
  Assert.assertTrue(types.contains(type2));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testisDeployed() throws Exception {
  ViewEntity viewDefinition=getViewEntity();
  viewDefinition.setStatus(ViewDefinition.ViewStatus.PENDING);
  Assert.assertFalse(viewDefinition.isDeployed());
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYING);
  Assert.assertFalse(viewDefinition.isDeployed());
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYED);
  Assert.assertTrue(viewDefinition.isDeployed());
  viewDefinition.setStatus(ViewDefinition.ViewStatus.ERROR);
  Assert.assertFalse(viewDefinition.isDeployed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewInstanceEntityTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAlterNames() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.alterNames());
  viewInstanceDefinition.setAlterNames(false);
  Assert.assertFalse(viewInstanceDefinition.alterNames());
  viewInstanceDefinition.setAlterNames(true);
  Assert.assertTrue(viewInstanceDefinition.alterNames());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstanceData() throws Exception {
  TestSecurityHelper securityHelper=new TestSecurityHelper("user1");
  ViewInstanceEntity viewInstanceDefinition=getViewInstanceEntity(securityHelper);
  viewInstanceDefinition.putInstanceData("key1","foo");
  ViewInstanceDataEntity dataEntity=viewInstanceDefinition.getInstanceData("key1");
  Assert.assertNotNull(dataEntity);
  Assert.assertEquals("foo",dataEntity.getValue());
  Assert.assertEquals("user1",dataEntity.getUser());
  viewInstanceDefinition.putInstanceData("key2","bar");
  viewInstanceDefinition.putInstanceData("key3","baz");
  viewInstanceDefinition.putInstanceData("key4","monkey");
  viewInstanceDefinition.putInstanceData("key5","runner");
  Map<String,String> dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(5,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertEquals("baz",dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
  viewInstanceDefinition.removeInstanceData("key3");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertFalse(dataMap.containsKey("key3"));
  securityHelper.setUser("user2");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertTrue(dataMap.isEmpty());
  viewInstanceDefinition.putInstanceData("key1","aaa");
  viewInstanceDefinition.putInstanceData("key2","bbb");
  viewInstanceDefinition.putInstanceData("key3","ccc");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(3,dataMap.size());
  Assert.assertEquals("aaa",dataMap.get("key1"));
  Assert.assertEquals("bbb",dataMap.get("key2"));
  Assert.assertEquals("ccc",dataMap.get("key3"));
  securityHelper.setUser("user1");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertNull(dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetValidationResult() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml_valid_instance);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewEntityTest.TestValidator validator=new ViewEntityTest.TestValidator();
  validator.result=new ValidationResultImpl(true,"detail");
  viewEntity.setValidator(validator);
  InstanceValidationResultImpl result=viewInstanceEntity.getValidationResult(viewEntity,Validator.ValidationContext.PRE_CREATE);
  Map<String,ValidationResult> propertyResults=result.getPropertyResults();
  junit.framework.Assert.assertEquals(2,propertyResults.size());
  junit.framework.Assert.assertTrue(propertyResults.containsKey("p1"));
  junit.framework.Assert.assertTrue(propertyResults.containsKey("p2"));
  junit.framework.Assert.assertTrue(propertyResults.get("p1").isValid());
  junit.framework.Assert.assertTrue(propertyResults.get("p2").isValid());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIsVisible() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.isVisible());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(1);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertFalse(viewInstanceDefinition.isVisible());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_without_instance_label).get(0);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertTrue(viewInstanceDefinition.isVisible());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.resources.TestResources </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResource() throws Exception {
  File resFile=resMan.getResource(resourceFile.getName());
  assertTrue(resFile.exists());
  String resContent=FileUtils.readFileToString(resFile);
  assertEquals(resContent,RESOURCE_FILE_CONTENT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.scheduler.ExecutionScheduleManagerTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHasToleranceThresholdExceeded() throws Exception {
  Clusters clustersMock=createMock(Clusters.class);
  Cluster clusterMock=createMock(Cluster.class);
  Configuration configurationMock=createNiceMock(Configuration.class);
  ExecutionScheduler executionSchedulerMock=createMock(ExecutionScheduler.class);
  InternalTokenStorage tokenStorageMock=createMock(InternalTokenStorage.class);
  ActionDBAccessor actionDBAccessorMock=createMock(ActionDBAccessor.class);
  Gson gson=new Gson();
  RequestExecution requestExecutionMock=createMock(RequestExecution.class);
  Batch batchMock=createMock(Batch.class);
  long executionId=11L;
  String clusterName="c1";
  BatchSettings batchSettings=new BatchSettings();
  batchSettings.setTaskFailureToleranceLimit(1);
  Map<Long,RequestExecution> executionMap=new HashMap<Long,RequestExecution>();
  executionMap.put(executionId,requestExecutionMock);
  expect(clustersMock.getCluster(clusterName)).andReturn(clusterMock).anyTimes();
  expect(clusterMock.getAllRequestExecutions()).andReturn(executionMap).anyTimes();
  expect(requestExecutionMock.getBatch()).andReturn(batchMock).anyTimes();
  expect(batchMock.getBatchSettings()).andReturn(batchSettings).anyTimes();
  replay(clustersMock,clusterMock,configurationMock,requestExecutionMock,executionSchedulerMock,batchMock);
  ExecutionScheduleManager scheduleManager=new ExecutionScheduleManager(configurationMock,executionSchedulerMock,tokenStorageMock,clustersMock,actionDBAccessorMock,gson);
  HashMap<String,Integer> taskCounts=new HashMap<String,Integer>(){
{
      put(BatchRequestJob.BATCH_REQUEST_FAILED_TASKS_KEY,2);
      put(BatchRequestJob.BATCH_REQUEST_TOTAL_TASKS_KEY,10);
    }
  }
;
  boolean exceeded=scheduleManager.hasToleranceThresholdExceeded(executionId,clusterName,taskCounts);
  Assert.assertTrue(exceeded);
  verify(clustersMock,clusterMock,configurationMock,requestExecutionMock,executionSchedulerMock,batchMock);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAllJobs() throws Exception {
  RequestExecution requestExecution=createRequestExecution(true);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=scheduler.getJobDetail(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  JobDetail jobDetail2=scheduler.getJobDetail(JobKey.jobKey(jobName2,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(jobDetail2);
  Assert.assertTrue(!scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
  executionScheduleManager.deleteAllJobs(requestExecution);
  Assert.assertTrue(scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.scheduler.ExecutionSchedulerTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test @PrepareForTest({ExecutionSchedulerImpl.class}) public void testSchedulerStartDelay() throws Exception {
  StdSchedulerFactory factory=createNiceMock(StdSchedulerFactory.class);
  Scheduler scheduler=createNiceMock(Scheduler.class);
  expect(factory.getScheduler()).andReturn(scheduler).anyTimes();
  expectNew(StdSchedulerFactory.class).andReturn(factory);
  expect(scheduler.isStarted()).andReturn(false).anyTimes();
  expectPrivate(scheduler,"startDelayed",new Integer(180)).once();
  expectPrivate(scheduler,"start").once();
  PowerMock.replay(factory,StdSchedulerFactory.class,scheduler);
  ExecutionSchedulerImpl executionScheduler=new ExecutionSchedulerImpl(configuration);
  executionScheduler.startScheduler(180);
  executionScheduler.startScheduler(null);
  PowerMock.verify(factory,StdSchedulerFactory.class,scheduler);
  Assert.assertTrue(executionScheduler.isInitialized());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test @PrepareForTest({ExecutionSchedulerImpl.class}) public void testSchedulerStartStop() throws Exception {
  StdSchedulerFactory factory=createNiceMock(StdSchedulerFactory.class);
  Scheduler scheduler=createNiceMock(Scheduler.class);
  expect(factory.getScheduler()).andReturn(scheduler);
  expectPrivate(scheduler,"startDelayed",new Integer(180)).once();
  expectNew(StdSchedulerFactory.class).andReturn(factory);
  expectPrivate(scheduler,"shutdown").once();
  PowerMock.replay(factory,StdSchedulerFactory.class,scheduler);
  ExecutionSchedulerImpl executionScheduler=new ExecutionSchedulerImpl(configuration);
  executionScheduler.startScheduler(180);
  executionScheduler.stopScheduler();
  PowerMock.verify(factory,StdSchedulerFactory.class,scheduler);
  Assert.assertTrue(executionScheduler.isInitialized());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.CertGenerationTest </h4><pre class="type-2 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServerCertGen() throws Exception {
  File serverCrt=new File(temp.getRoot().getAbsoluteFile() + File.separator + Configuration.SRVR_CRT_NAME_DEFAULT);
  Assert.assertTrue(serverCrt.exists());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testRevokeExistingAgentCert() throws Exception {
  Map<String,String> config=certMan.configs.getConfigsMap();
  config.put(Configuration.PASSPHRASE_KEY,"passphrase");
  String agentHostname="agent_hostname";
  SignCertResponse scr=certMan.signAgentCrt(agentHostname,"incorrect_agentCrtReqContent","passphrase");
  Assert.assertFalse(scr.getMessage().contains("-revoke"));
  File fakeAgentCertFile=new File(temp.getRoot().getAbsoluteFile() + File.separator + agentHostname+ ".crt");
  Assert.assertTrue(fakeAgentCertFile.exists());
  scr=certMan.signAgentCrt(agentHostname,"incorrect_agentCrtReqContent","passphrase");
  Assert.assertTrue(scr.getMessage().contains("-revoke"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassFileGen() throws Exception {
  File passFile=new File(temp.getRoot().getAbsolutePath() + File.separator + passFileName);
  Assert.assertTrue(passFile.exists());
  String pass=FileUtils.readFileToString(passFile);
  Assert.assertEquals(pass.length(),passLen);
  if (ShellCommandUtil.LINUX) {
    String permissions=ShellCommandUtil.getUnixFilePermissions(passFile.getAbsolutePath());
    Assert.assertEquals(ShellCommandUtil.MASK_OWNER_ONLY_RW,permissions);
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServerKeyGen() throws Exception {
  File serverKey=new File(temp.getRoot().getAbsoluteFile() + File.separator + Configuration.SRVR_KEY_NAME_DEFAULT);
  Assert.assertTrue(serverKey.exists());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServerKeystoreGen() throws Exception {
  File serverKeyStrore=new File(temp.getRoot().getAbsoluteFile() + File.separator + Configuration.KSTR_NAME_DEFAULT);
  Assert.assertTrue(serverKeyStrore.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.SecurePasswordHelperTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSecurePassword() throws Exception {
  String password1=securePasswordHelper.createSecurePassword();
  Assert.assertNotNull(password1);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password1.length());
  String password2=securePasswordHelper.createSecurePassword();
  Assert.assertNotNull(password2);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password2.length());
  Assert.assertFalse((password1.equals(password2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.SslExecutionTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSslLogging() throws Exception {
  LOG.info("Testing sign");
  certMan.configs.getConfigsMap().put(Configuration.PASSPHRASE_KEY,"123123");
  LOG.info("key dir = " + certMan.configs.getConfigsMap().get(Configuration.SRVR_KSTR_DIR_KEY));
  SignCertResponse signAgentCrt=certMan.signAgentCrt("somehost","gdfgdfg","123123");
  LOG.info("-------------RESPONCE-------------");
  LOG.info("-------------MESSAGE--------------");
  LOG.info(signAgentCrt.getMessage());
  LOG.info("---------------------------------");
  LOG.info("-------------RESULT--------------");
  LOG.info(signAgentCrt.getResult());
  LOG.info("---------------------------------");
  assertTrue(SignCertResponse.ERROR_STATUS.equals(signAgentCrt.getResult()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariAuthorizationProviderDisableUserTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisabledUserViaDaoProvider(){
  try {
    daoProvider.authenticate(new UsernamePasswordAuthenticationToken("disabledUser","pwd"));
    Assert.fail("Disabled user passes authentication");
  }
 catch (  DisabledException e) {
    Assert.assertEquals("User is disabled",e.getMessage());
  }
  Authentication auth=daoProvider.authenticate(new UsernamePasswordAuthenticationToken("activeUser","pwd"));
  Assert.assertNotNull(auth);
  Assert.assertTrue(auth.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLdapAuthenticationProviderForDNWithSpaceTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDisabled() throws Exception {
  configuration.setClientSecurityType(ClientSecurityType.LOCAL);
  Authentication authentication=new UsernamePasswordAuthenticationToken("the allowedUser","password");
  Authentication auth=authenticationProvider.authenticate(authentication);
  assertTrue(auth == null);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticate() throws Exception {
  assertNull("User alread exists in DB",userDAO.findLdapUserByName("the allowedUser"));
  Authentication authentication=new UsernamePasswordAuthenticationToken("the allowedUser","password");
  Authentication result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
  result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLdapAuthenticationProviderTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDisabled() throws Exception {
  configuration.setClientSecurityType(ClientSecurityType.LOCAL);
  Authentication authentication=new UsernamePasswordAuthenticationToken("allowedUser","password");
  Authentication auth=authenticationProvider.authenticate(authentication);
  Assert.assertTrue(auth == null);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticate() throws Exception {
  assertNull("User alread exists in DB",userDAO.findLdapUserByName("allowedUser"));
  Authentication authentication=new UsernamePasswordAuthenticationToken("allowedUser","password");
  Authentication result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
  result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLocalUserDetailsServiceTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadUserByUsername() throws Exception {
  UserDetails userDetails=userDetailsService.loadUserByUsername("administrator");
  assertEquals("Wrong username","administrator",userDetails.getUsername());
  assertTrue("Password not matches",passwordEncoder.matches("admin",userDetails.getPassword()));
  assertFalse("Wrong password accepted",passwordEncoder.matches("wrong",userDetails.getPassword()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AuthorizationHelperTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertPrivilegesToAuthorities() throws Exception {
  Collection<PrivilegeEntity> privilegeEntities=new ArrayList<PrivilegeEntity>();
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(1);
  resourceTypeEntity.setName("CLUSTER");
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setId(1L);
  resourceEntity.setResourceType(resourceTypeEntity);
  PrincipalTypeEntity principalTypeEntity=new PrincipalTypeEntity();
  principalTypeEntity.setId(1);
  principalTypeEntity.setName("USER");
  PrincipalEntity principalEntity=new PrincipalEntity();
  principalEntity.setPrincipalType(principalTypeEntity);
  principalEntity.setId(1L);
  PermissionEntity permissionEntity1=new PermissionEntity();
  permissionEntity1.setPermissionName("Permission1");
  permissionEntity1.setResourceType(resourceTypeEntity);
  permissionEntity1.setId(2);
  permissionEntity1.setPermissionName("CLUSTER.USER");
  PermissionEntity permissionEntity2=new PermissionEntity();
  permissionEntity2.setPermissionName("Permission1");
  permissionEntity2.setResourceType(resourceTypeEntity);
  permissionEntity2.setId(3);
  permissionEntity2.setPermissionName("CLUSTER.ADMINISTRATOR");
  PrivilegeEntity privilegeEntity1=new PrivilegeEntity();
  privilegeEntity1.setId(1);
  privilegeEntity1.setPermission(permissionEntity1);
  privilegeEntity1.setPrincipal(principalEntity);
  privilegeEntity1.setResource(resourceEntity);
  PrivilegeEntity privilegeEntity2=new PrivilegeEntity();
  privilegeEntity2.setId(1);
  privilegeEntity2.setPermission(permissionEntity2);
  privilegeEntity2.setPrincipal(principalEntity);
  privilegeEntity2.setResource(resourceEntity);
  privilegeEntities.add(privilegeEntity1);
  privilegeEntities.add(privilegeEntity2);
  Collection<GrantedAuthority> authorities=new AuthorizationHelper().convertPrivilegesToAuthorities(privilegeEntities);
  assertEquals("Wrong number of authorities",2,authorities.size());
  Set<String> authorityNames=new HashSet<String>();
  for (  GrantedAuthority authority : authorities) {
    authorityNames.add(authority.getAuthority());
  }
  Assert.assertTrue(authorityNames.contains("CLUSTER.USER@1"));
  Assert.assertTrue(authorityNames.contains("CLUSTER.ADMINISTRATOR@1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsAuthorized(){
  RoleAuthorizationEntity readOnlyRoleAuthorizationEntity=new RoleAuthorizationEntity();
  readOnlyRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.CLUSTER_VIEW_METRICS.getId());
  RoleAuthorizationEntity privilegedRoleAuthorizationEntity=new RoleAuthorizationEntity();
  privilegedRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS.getId());
  RoleAuthorizationEntity administratorRoleAuthorizationEntity=new RoleAuthorizationEntity();
  administratorRoleAuthorizationEntity.setAuthorizationId(RoleAuthorization.AMBARI_MANAGE_USERS.getId());
  ResourceTypeEntity clusterResourceTypeEntity=new ResourceTypeEntity();
  clusterResourceTypeEntity.setId(1);
  clusterResourceTypeEntity.setName(ResourceType.CLUSTER.name());
  ResourceTypeEntity cluster2ResourceTypeEntity=new ResourceTypeEntity();
  cluster2ResourceTypeEntity.setId(2);
  cluster2ResourceTypeEntity.setName(ResourceType.CLUSTER.name());
  ResourceEntity clusterResourceEntity=new ResourceEntity();
  clusterResourceEntity.setResourceType(clusterResourceTypeEntity);
  clusterResourceEntity.setId(1L);
  ResourceEntity cluster2ResourceEntity=new ResourceEntity();
  cluster2ResourceEntity.setResourceType(cluster2ResourceTypeEntity);
  cluster2ResourceEntity.setId(2L);
  PermissionEntity readOnlyPermissionEntity=new PermissionEntity();
  readOnlyPermissionEntity.setAuthorizations(Collections.singleton(readOnlyRoleAuthorizationEntity));
  PermissionEntity privilegedPermissionEntity=new PermissionEntity();
  privilegedPermissionEntity.setAuthorizations(Arrays.asList(readOnlyRoleAuthorizationEntity,privilegedRoleAuthorizationEntity));
  PermissionEntity administratorPermissionEntity=new PermissionEntity();
  administratorPermissionEntity.setAuthorizations(Arrays.asList(readOnlyRoleAuthorizationEntity,privilegedRoleAuthorizationEntity,administratorRoleAuthorizationEntity));
  PrivilegeEntity readOnlyPrivilegeEntity=new PrivilegeEntity();
  readOnlyPrivilegeEntity.setPermission(readOnlyPermissionEntity);
  readOnlyPrivilegeEntity.setResource(clusterResourceEntity);
  PrivilegeEntity readOnly2PrivilegeEntity=new PrivilegeEntity();
  readOnly2PrivilegeEntity.setPermission(readOnlyPermissionEntity);
  readOnly2PrivilegeEntity.setResource(cluster2ResourceEntity);
  PrivilegeEntity privilegedPrivilegeEntity=new PrivilegeEntity();
  privilegedPrivilegeEntity.setPermission(privilegedPermissionEntity);
  privilegedPrivilegeEntity.setResource(clusterResourceEntity);
  PrivilegeEntity privileged2PrivilegeEntity=new PrivilegeEntity();
  privileged2PrivilegeEntity.setPermission(privilegedPermissionEntity);
  privileged2PrivilegeEntity.setResource(cluster2ResourceEntity);
  PrivilegeEntity administratorPrivilegeEntity=new PrivilegeEntity();
  administratorPrivilegeEntity.setPermission(administratorPermissionEntity);
  administratorPrivilegeEntity.setResource(clusterResourceEntity);
  GrantedAuthority readOnlyAuthority=new AmbariGrantedAuthority(readOnlyPrivilegeEntity);
  GrantedAuthority readOnly2Authority=new AmbariGrantedAuthority(readOnly2PrivilegeEntity);
  GrantedAuthority privilegedAuthority=new AmbariGrantedAuthority(privilegedPrivilegeEntity);
  GrantedAuthority privileged2Authority=new AmbariGrantedAuthority(privileged2PrivilegeEntity);
  GrantedAuthority administratorAuthority=new AmbariGrantedAuthority(administratorPrivilegeEntity);
  Authentication noAccessUser=new TestAuthentication(Collections.<AmbariGrantedAuthority>emptyList());
  Authentication readOnlyUser=new TestAuthentication(Collections.singleton(readOnlyAuthority));
  Authentication privilegedUser=new TestAuthentication(Arrays.asList(readOnlyAuthority,privilegedAuthority));
  Authentication privileged2User=new TestAuthentication(Arrays.asList(readOnly2Authority,privileged2Authority));
  Authentication administratorUser=new TestAuthentication(Collections.singleton(administratorAuthority));
  SecurityContext context=SecurityContextHolder.getContext();
  assertFalse(AuthorizationHelper.isAuthorized(null,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(noAccessUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(readOnlyUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(privilegedUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(privileged2User,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertTrue(AuthorizationHelper.isAuthorized(administratorUser,ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(noAccessUser);
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  context.setAuthentication(readOnlyUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(privilegedUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(privileged2User);
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertFalse(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
  context.setAuthentication(administratorUser);
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_VIEW_METRICS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.CLUSTER_TOGGLE_KERBEROS)));
  assertTrue(AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,1L,EnumSet.of(RoleAuthorization.AMBARI_MANAGE_USERS)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.LdapServerPropertiesTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws Exception {
  LdapServerProperties properties1=configuration.getLdapServerProperties();
  LdapServerProperties properties2=configuration.getLdapServerProperties();
  assertTrue("Properties object is same",properties1 != properties2);
  assertTrue("Objects are not equal",properties1.equals(properties2));
  assertTrue("Hash codes are not equal",properties1.hashCode() == properties2.hashCode());
  properties2.setSecondaryUrl("5.6.7.8:389");
  assertFalse("Objects are equal",properties1.equals(properties2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.TestUsers </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRevokeAdminPrivilege() throws Exception {
  users.createUser("admin","admin",true,true,false);
  final User admin=users.getAnyUser("admin");
  users.revokeAdminPrivilege(admin.getUserId());
  Assert.assertFalse(users.getAnyUser("admin").isAdmin());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGrantAdminPrivilege() throws Exception {
  users.createUser("user","user");
  final User user=users.getAnyUser("user");
  users.grantAdminPrivilege(user.getUserId());
  Assert.assertTrue(users.getAnyUser("user").isAdmin());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByNonAdmin() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user2",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  users.createUser("user2","user2");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  try {
    users.modifyPassword("user","user2","user_new_password");
    Assert.fail("Exception should be thrown here as user2 can't change password of user");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByAdmin() throws Exception {
  users.createUser("admin","admin",true,true,false);
  users.createUser("user","user");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  users.modifyPassword("user","admin","user_new_password");
  assertTrue(passwordEncoder.matches("user_new_password",userDAO.findUserByName("user").getUserPassword()));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGroupLdap() throws Exception {
  users.createGroup("group");
  users.setGroupLdap("group");
  Assert.assertNotNull(users.getGroup("group"));
  Assert.assertTrue(users.getGroup("group").isLdapGroup());
  try {
    users.setGroupLdap("fake group");
    Assert.fail("It shouldn't be possible to call setGroupLdap() on non-existing group");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByHimselfPasswordNotOk() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  try {
    users.modifyPassword("user","admin","user_new_password");
    Assert.fail("Exception should be thrown here as password is incorrect");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsUserCanBeRemoved() throws Exception {
  users.createUser("admin","admin",true,true,false);
  users.createUser("admin2","admin2",true,true,false);
  Assert.assertTrue(users.isUserCanBeRemoved(userDAO.findUserByName("admin")));
  Assert.assertTrue(users.isUserCanBeRemoved(userDAO.findUserByName("admin2")));
  users.removeUser(users.getAnyUser("admin"));
  Assert.assertFalse(users.isUserCanBeRemoved(userDAO.findUserByName("admin2")));
  users.createUser("user","user");
  Assert.assertFalse(users.isUserCanBeRemoved(userDAO.findUserByName("admin2")));
  users.createUser("admin3","admin3",true,true,false);
  Assert.assertTrue(users.isUserCanBeRemoved(userDAO.findUserByName("admin2")));
  Assert.assertTrue(users.isUserCanBeRemoved(userDAO.findUserByName("admin3")));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyPassword_UserByHimselfPasswordOk() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  users.modifyPassword("user","user","user_new_password");
  assertTrue(passwordEncoder.matches("user_new_password",userDAO.findUserByName("user").getUserPassword()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialProviderTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialization() throws Exception {
  CredentialProvider cr;
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  try {
    new CredentialProvider(null,null,true,null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr=new CredentialProvider("blahblah!",msFile,false,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  msFile.delete();
  mksFile.delete();
  createMasterKey();
  cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCredentialStore() throws Exception {
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  createMasterKey();
  CredentialProvider cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  try {
    cr.addAliasToCredentialStore("","xyz");
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  try {
    cr.addAliasToCredentialStore("xyz",null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr.addAliasToCredentialStore("myalias","mypassword");
  Assert.assertEquals("mypassword",new String(cr.getPasswordForAlias("myalias")));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsAliasString(){
  String test="cassablanca";
  Assert.assertFalse(CredentialProvider.isAliasString(test));
  test="${}";
  Assert.assertFalse(CredentialProvider.isAliasString(test));
  test="{}";
  Assert.assertFalse(CredentialProvider.isAliasString(test));
  test="{cassablanca}";
  Assert.assertFalse(CredentialProvider.isAliasString(test));
  test="${cassablanca}";
  Assert.assertFalse(CredentialProvider.isAliasString(test));
  test="${alias=cassablanca}";
  Assert.assertTrue(CredentialProvider.isAliasString(test));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialStoreServiceImplTest </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  tmpFolder.create();
  final File masterKeyFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"secret"));
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.MASTER_KEY_LOCATION,tmpFolder.getRoot().getAbsolutePath());
      properties.setProperty(Configuration.MASTER_KEYSTORE_LOCATION,tmpFolder.getRoot().getAbsolutePath());
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(SecurePasswordHelper.class).toInstance(new SecurePasswordHelper());
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  MasterKeyService masterKeyService=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(masterKeyService.isMasterKeyInitialized());
  credentialStoreService=injector.getInstance(CredentialStoreServiceImpl.class);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testContainsCredential() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  PrincipalKeyCredential credential3=new PrincipalKeyCredential("username3","password3");
  PrincipalKeyCredential credential4=new PrincipalKeyCredential("username4","password4");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test3",credential3,CredentialStoreType.TEMPORARY);
  credentialStoreService.setCredential(CLUSTER_NAME,"test4",credential4,CredentialStoreType.TEMPORARY);
  Assert.assertTrue(credentialStoreService.containsCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertFalse(credentialStoreService.containsCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertFalse(credentialStoreService.containsCredential(CLUSTER_NAME,"test3",CredentialStoreType.PERSISTED));
  Assert.assertFalse(credentialStoreService.containsCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertFalse(credentialStoreService.containsCredential(CLUSTER_NAME,"test3",CredentialStoreType.PERSISTED));
  Assert.assertTrue(credentialStoreService.containsCredential(CLUSTER_NAME,"test3",CredentialStoreType.TEMPORARY));
  Assert.assertTrue(credentialStoreService.containsCredential(CLUSTER_NAME,"test1"));
  Assert.assertTrue(credentialStoreService.containsCredential(CLUSTER_NAME,"test3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.MasterKeyServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeMasterKey() throws Exception {
  File masterKeyFile=new File(fileDir,"master");
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"ThisisSomePassPhrase"));
  MasterKeyService ms=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertTrue(masterKeyFile.exists());
  Set<PosixFilePermission> permissions=Files.getPosixFilePermissions(Paths.get(masterKeyFile.getAbsolutePath()));
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  MasterKeyService ms1=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms1.isMasterKeyInitialized());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms1.getMasterSecret()));
  Assert.assertEquals(new String(ms.getMasterSecret()),new String(ms1.getMasterSecret()));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFromEnvAsKey() throws Exception {
  Map<String,String> mapRet=new HashMap<String,String>();
  mapRet.put(Configuration.MASTER_KEY_ENV_PROP,"ThisisSomePassPhrase");
  mockStatic(System.class);
  expect(System.getenv()).andReturn(mapRet);
  replayAll();
  MasterKeyService ms=new MasterKeyServiceImpl();
  verifyAll();
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertNotNull(ms.getMasterSecret());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms.getMasterSecret()));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFromEnvAsPath() throws Exception {
  File masterKeyFile=new File(fileDir,"master");
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"ThisisSomePassPhrase"));
  MasterKeyService ms=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertTrue(masterKeyFile.exists());
  Map<String,String> mapRet=new HashMap<String,String>();
  mapRet.put(Configuration.MASTER_KEY_LOCATION,masterKeyFile.getAbsolutePath());
  mockStatic(System.class);
  expect(System.getenv()).andReturn(mapRet);
  replayAll();
  ms=new MasterKeyServiceImpl();
  verifyAll();
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertNotNull(ms.getMasterSecret());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms.getMasterSecret()));
  Assert.assertFalse(masterKeyFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.ldap.AmbariLdapDataPopulatorTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_remove() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(populator);
  replay(externalGroup1);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertTrue(result.getGroupsToBeRemoved().contains("group4"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshGroupMembers() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user3").anyTimes();
  expect(user4.getUserName()).andReturn("user4").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  expect(group1.isLdapGroup()).andReturn(true).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(ldapServerProperties.getGroupNamingAttr()).andReturn("cn").anyTimes();
  expect(ldapServerProperties.getUsernameAttribute()).andReturn("uid").anyTimes();
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  replay(group1,group2);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUserByMemberAttr").addMockedMethod("getLdapGroupByMemberAttr").addMockedMethod("getInternalMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup=createNiceMock(LdapGroupDto.class);
  expect(externalGroup.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup.getMemberAttributes()).andReturn(createSet("user1","user2","user4","user6")).anyTimes();
  replay(externalGroup);
  Map<String,User> internalMembers=new HashMap<String,User>();
  internalMembers.put("user1",user1);
  internalMembers.put("user3",user3);
  internalMembers.put("user4",user4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("user4").anyTimes();
  expect(externalUser4.getUserName()).andReturn("user6").anyTimes();
  replay(externalUser1,externalUser2,externalUser3,externalUser4);
  expect(populator.getLdapUserByMemberAttr("user1")).andReturn(externalUser1).anyTimes();
  expect(populator.getLdapUserByMemberAttr("user2")).andReturn(externalUser2).anyTimes();
  expect(populator.getLdapUserByMemberAttr("user4")).andReturn(null).anyTimes();
  expect(populator.getLdapGroupByMemberAttr("user4")).andReturn(externalGroup).anyTimes();
  expect(populator.getLdapUserByMemberAttr("user6")).andReturn(externalUser4).anyTimes();
  expect(populator.getInternalMembers("group1")).andReturn(internalMembers).anyTimes();
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  Map<String,User> internalUsers=new HashMap<String,User>();
  internalUsers.putAll(internalMembers);
  internalUsers.put("user2",user2);
  Map<String,Group> internalGroups=new HashMap<String,Group>();
  internalGroups.put("group2",group2);
  populator.refreshGroupMembers(batchInfo,externalGroup,internalUsers,internalGroups,null);
  Set<String> groupMembersToAdd=new HashSet<String>();
  for (  LdapUserGroupMemberDto ldapUserGroupMemberDto : batchInfo.getMembershipToAdd()) {
    groupMembersToAdd.add(ldapUserGroupMemberDto.getUserName());
  }
  assertEquals(3,groupMembersToAdd.size());
  assertTrue(groupMembersToAdd.contains("user2"));
  assertTrue(groupMembersToAdd.contains("user6"));
  Set<String> groupMembersToRemove=new HashSet<String>();
  for (  LdapUserGroupMemberDto ldapUserGroupMemberDto : batchInfo.getMembershipToRemove()) {
    groupMembersToRemove.add(ldapUserGroupMemberDto.getUserName());
  }
  assertEquals(2,groupMembersToRemove.size());
  assertTrue(groupMembersToRemove.contains("user3"));
  assertEquals(1,batchInfo.getUsersToBeCreated().size());
  assertTrue(batchInfo.getUsersToBeCreated().contains("user6"));
  assertEquals(1,batchInfo.getUsersToBecomeLdap().size());
  assertTrue(batchInfo.getUsersToBecomeLdap().contains("user1"));
  assertTrue(!batchInfo.getUsersToBecomeLdap().contains("user4"));
  assertTrue(batchInfo.getGroupsToBecomeLdap().isEmpty());
  assertEquals(1,batchInfo.getGroupsToBeCreated().size());
  assertTrue(batchInfo.getGroupsToBeRemoved().isEmpty());
  assertTrue(batchInfo.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_update() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("group3").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("group4").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getLdapGroups("group*")).andReturn(externalGroups);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("group*"),batchInfo);
  assertEquals(2,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group1"));
  assertTrue(result.getGroupsToBecomeLdap().contains("group4"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_remove() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user3").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  expect(populator.getExternalLdapUserInfo()).andReturn(Collections.EMPTY_SET);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(2,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("user3"));
  assertTrue(result.getUsersToBeRemoved().contains("user1"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_add() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user3").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user4").anyTimes();
  replay(externalUser1,externalUser2);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("user3"));
  assertTrue(result.getUsersToBeCreated().contains("user4"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsLdapEnabled_reallyDisabled(){
  final Configuration configuration=createNiceMock(Configuration.class);
  final Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(configuration.isLdapConfigured()).andReturn(false);
  expect(configuration.getLdapServerProperties()).andReturn(ldapServerProperties);
  replay(ldapTemplate,ldapServerProperties,configuration);
  final AmbariLdapDataPopulatorTestInstance populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  assertFalse(populator.isLdapEnabled());
  verify(populator.loadLdapTemplate(),populator.getLdapServerProperties(),configuration);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("serial") public void testCleanUpLdapUsersWithoutGroup() throws AmbariException {
  final Configuration configuration=createNiceMock(Configuration.class);
  final Users users=createNiceMock(Users.class);
  final GroupEntity ldapGroup=new GroupEntity();
  ldapGroup.setGroupId(1);
  ldapGroup.setGroupName("ldapGroup");
  ldapGroup.setLdapGroup(true);
  ldapGroup.setMemberEntities(new HashSet<MemberEntity>());
  final User ldapUserWithoutGroup=createLdapUserWithoutGroup();
  final User ldapUserWithGroup=createLdapUserWithGroup(ldapGroup);
  final User localUserWithoutGroup=createLocalUserWithoutGroup();
  final User localUserWithGroup=createLocalUserWithGroup(ldapGroup);
  final List<User> allUsers=new ArrayList<User>(){
{
      add(ldapUserWithoutGroup);
      add(ldapUserWithGroup);
      add(localUserWithoutGroup);
      add(localUserWithGroup);
    }
  }
;
  expect(users.getAllUsers()).andReturn(new ArrayList<User>(allUsers));
  final List<User> removedUsers=new ArrayList<User>();
  final Capture<User> userCapture=new Capture<User>();
  users.removeUser(capture(userCapture));
  expectLastCall().andAnswer(new IAnswer<Void>(){
    @Override public Void answer() throws Throwable {
      removedUsers.add(userCapture.getValue());
      allUsers.remove(userCapture.getValue());
      return null;
    }
  }
);
  replay(users);
  final AmbariLdapDataPopulatorTestInstance populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  populator.setLdapTemplate(createNiceMock(LdapTemplate.class));
  populator.setLdapServerProperties(createNiceMock(LdapServerProperties.class));
  populator.cleanUpLdapUsersWithoutGroup();
  assertEquals(removedUsers.size(),1);
  assertEquals(allUsers.size(),3);
  assertTrue(allUsers.contains(ldapUserWithGroup));
  assertTrue(allUsers.contains(localUserWithoutGroup));
  assertTrue(allUsers.contains(localUserWithGroup));
  assertEquals(removedUsers.get(0),ldapUserWithoutGroup);
  verify(users);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_add() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(false).anyTimes();
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(Arrays.asList(group1,group2));
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group4").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(externalGroup1,externalGroup2);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("group3"));
  assertTrue(result.getGroupsToBeCreated().contains("group4"));
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_add() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("xuser3").anyTimes();
  expect(externalUser4.getUserName()).andReturn("xuser4").anyTimes();
  replay(externalUser2,externalUser3,externalUser4);
  expect(populator.getLdapUsers("xuser*")).andReturn(createSet(externalUser3,externalUser4));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user2","xuser*"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("xuser3"));
  assertTrue(result.getUsersToBeCreated().contains("xuser4"));
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("synced_user1").anyTimes();
  expect(user2.getUserName()).andReturn("synced_user2").anyTimes();
  expect(user3.getUserName()).andReturn("unsynced_user1").anyTimes();
  expect(user4.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user3,user2,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("synced_user2").anyTimes();
  expect(externalUser2.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("external_user1").anyTimes();
  expect(externalUser4.getUserName()).andReturn("external_user2").anyTimes();
  replay(externalUser1,externalUser2,externalUser3,externalUser4);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2,externalUser3,externalUser4));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("synced_user1"));
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("external_user1"));
  assertTrue(result.getUsersToBeCreated().contains("external_user2"));
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("unsynced_user2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_add() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("xgroup1").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("xgroup2").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup2),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("x*")).andReturn(externalGroups);
  expect(populator.getLdapGroups("group2")).andReturn(Collections.singleton(externalGroup2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("x*","group2"),batchInfo);
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("xgroup1"));
  assertTrue(result.getGroupsToBeCreated().contains("xgroup2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsLdapEnabled_reallyEnabled(){
  final Configuration configuration=createNiceMock(Configuration.class);
  final Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(configuration.isLdapConfigured()).andReturn(true);
  expect(ldapTemplate.search(EasyMock.<String>anyObject(),EasyMock.<String>anyObject(),EasyMock.<AttributesMapper>anyObject())).andReturn(Collections.emptyList()).once();
  replay(ldapTemplate,configuration);
  final AmbariLdapDataPopulatorTestInstance populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  assertTrue(populator.isLdapEnabled());
  verify(populator.loadLdapTemplate(),configuration);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeExistingLdapUsers() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("synced_user1").anyTimes();
  expect(user2.getUserName()).andReturn("synced_user2").anyTimes();
  expect(user3.getUserName()).andReturn("unsynced_user1").anyTimes();
  expect(user4.getUserName()).andReturn("unsynced_user2").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  expect(populator.getLdapUsers("synced_user1")).andReturn(Collections.EMPTY_SET);
  expect(populator.getLdapUsers("synced_user2")).andReturn(Collections.singleton(createNiceMock(LdapUserDto.class)));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeExistingLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBeRemoved().size());
  assertTrue(result.getUsersToBeRemoved().contains("synced_user1"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapUsers_update() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user3").anyTimes();
  expect(user1.isLdapUser()).andReturn(true).anyTimes();
  expect(user2.isLdapUser()).andReturn(false).anyTimes();
  expect(user3.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapUserInfo").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user3").anyTimes();
  replay(externalUser1,externalUser2);
  expect(populator.getExternalLdapUserInfo()).andReturn(createSet(externalUser1,externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapUsers(new LdapBatchDto());
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user3"));
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_allExist() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser4=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("xuser3").anyTimes();
  expect(externalUser4.getUserName()).andReturn("xuser4").anyTimes();
  replay(externalUser1,externalUser2,externalUser3,externalUser4);
  expect(populator.getLdapUsers("xuser*")).andReturn(createSet(externalUser3,externalUser4));
  expect(populator.getLdapUsers("user1")).andReturn(Collections.singleton(externalUser1));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user1","user2","xuser*"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBeCreated().size());
  assertTrue(result.getUsersToBeCreated().contains("xuser3"));
  assertTrue(result.getUsersToBeCreated().contains("xuser4"));
  assertEquals(1,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user1"));
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  Group group5=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group5.getGroupName()).andReturn("group5").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  expect(group5.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4,group5);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4,group5);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getExternalLdapGroupInfo").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group4").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("group6").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("group7").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(1,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertEquals(1,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group3"));
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("group6"));
  assertTrue(result.getGroupsToBeCreated().contains("group7"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeAllLdapGroups_update() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(false).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("refreshGroupMembers").addMockedMethod("getExternalLdapGroupInfo").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group3").anyTimes();
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup1,externalGroup2);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  expect(populator.getExternalLdapGroupInfo()).andReturn(externalGroups);
  replay(populator);
  replay(externalGroup1,externalGroup2);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeAllLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group2"));
  assertTrue(result.getGroupsToBecomeLdap().contains("group3"));
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void synchronizeExistingLdapGroups() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  Group group5=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group5.getGroupName()).andReturn("group5").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(false).anyTimes();
  expect(group4.isLdapGroup()).andReturn(true).anyTimes();
  expect(group5.isLdapGroup()).andReturn(true).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4,group5);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4,group5);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  expect(populator.getLdapGroups("group2")).andReturn(Collections.EMPTY_SET);
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapBatchDto batchInfo=new LdapBatchDto();
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup1),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("group4")).andReturn(Collections.singleton(externalGroup1));
  expect(populator.getLdapGroups("group5")).andReturn(Collections.EMPTY_SET);
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeExistingLdapGroups(batchInfo);
  assertEquals(2,result.getGroupsToBeRemoved().size());
  assertTrue(result.getGroupsToBeRemoved().contains("group2"));
  assertTrue(result.getGroupsToBeRemoved().contains("group5"));
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapGroups_allExist() throws Exception {
  Group group1=createNiceMock(Group.class);
  Group group2=createNiceMock(Group.class);
  Group group3=createNiceMock(Group.class);
  Group group4=createNiceMock(Group.class);
  expect(group1.getGroupName()).andReturn("group1").anyTimes();
  expect(group2.getGroupName()).andReturn("group2").anyTimes();
  expect(group3.getGroupName()).andReturn("group3").anyTimes();
  expect(group4.getGroupName()).andReturn("group4").anyTimes();
  expect(group1.isLdapGroup()).andReturn(false).anyTimes();
  expect(group2.isLdapGroup()).andReturn(true).anyTimes();
  expect(group3.isLdapGroup()).andReturn(true).anyTimes();
  expect(group4.isLdapGroup()).andReturn(false).anyTimes();
  List<Group> groupList=Arrays.asList(group1,group2,group3,group4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllGroups()).andReturn(groupList);
  expect(users.getAllUsers()).andReturn(Collections.EMPTY_LIST);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(group1,group2,group3,group4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapGroups").addMockedMethod("refreshGroupMembers").withConstructor(configuration,users).createNiceMock();
  LdapGroupDto externalGroup1=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup2=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup3=createNiceMock(LdapGroupDto.class);
  LdapGroupDto externalGroup4=createNiceMock(LdapGroupDto.class);
  expect(externalGroup1.getGroupName()).andReturn("group1").anyTimes();
  expect(externalGroup2.getGroupName()).andReturn("group2").anyTimes();
  expect(externalGroup3.getGroupName()).andReturn("xgroup1").anyTimes();
  expect(externalGroup4.getGroupName()).andReturn("xgroup2").anyTimes();
  replay(externalGroup1,externalGroup2,externalGroup3,externalGroup4);
  LdapBatchDto batchInfo=new LdapBatchDto();
  Set<LdapGroupDto> externalGroups=createSet(externalGroup3,externalGroup4);
  for (  LdapGroupDto externalGroup : externalGroups) {
    populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
    expectLastCall();
  }
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup1),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  populator.refreshGroupMembers(eq(batchInfo),eq(externalGroup2),anyObject(Map.class),anyObject(Map.class),anyObject(Set.class));
  expectLastCall();
  expect(populator.getLdapGroups("x*")).andReturn(externalGroups);
  expect(populator.getLdapGroups("group1")).andReturn(Collections.singleton(externalGroup1));
  expect(populator.getLdapGroups("group2")).andReturn(Collections.singleton(externalGroup2));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapGroups(createSet("x*","group1","group2"),batchInfo);
  assertEquals(1,result.getGroupsToBecomeLdap().size());
  assertTrue(result.getGroupsToBecomeLdap().contains("group1"));
  assertEquals(2,result.getGroupsToBeCreated().size());
  assertTrue(result.getGroupsToBeCreated().contains("xgroup1"));
  assertTrue(result.getGroupsToBeCreated().contains("xgroup2"));
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  assertTrue(result.getUsersToBecomeLdap().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSynchronizeLdapUsers_update() throws Exception {
  User user1=createNiceMock(User.class);
  User user2=createNiceMock(User.class);
  User user3=createNiceMock(User.class);
  User user4=createNiceMock(User.class);
  expect(user1.getUserName()).andReturn("user1").anyTimes();
  expect(user2.getUserName()).andReturn("user2").anyTimes();
  expect(user3.getUserName()).andReturn("user5").anyTimes();
  expect(user4.getUserName()).andReturn("user6").anyTimes();
  expect(user1.isLdapUser()).andReturn(false).anyTimes();
  expect(user2.isLdapUser()).andReturn(true).anyTimes();
  expect(user3.isLdapUser()).andReturn(true).anyTimes();
  expect(user4.isLdapUser()).andReturn(false).anyTimes();
  List<User> userList=Arrays.asList(user1,user2,user3,user4);
  Configuration configuration=createNiceMock(Configuration.class);
  Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(users.getAllUsers()).andReturn(userList);
  replay(ldapTemplate,ldapServerProperties,users,configuration);
  replay(user1,user2,user3,user4);
  AmbariLdapDataPopulatorTestInstance populator=createMockBuilder(AmbariLdapDataPopulatorTestInstance.class).addMockedMethod("getLdapUsers").withConstructor(configuration,users).createNiceMock();
  LdapUserDto externalUser1=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser2=createNiceMock(LdapUserDto.class);
  LdapUserDto externalUser3=createNiceMock(LdapUserDto.class);
  expect(externalUser1.getUserName()).andReturn("user1").anyTimes();
  expect(externalUser2.getUserName()).andReturn("user2").anyTimes();
  expect(externalUser3.getUserName()).andReturn("user6").anyTimes();
  replay(externalUser2,externalUser3,externalUser1);
  expect(populator.getLdapUsers("user1")).andReturn(Collections.singleton(externalUser1));
  expect(populator.getLdapUsers("user2")).andReturn(Collections.singleton(externalUser2));
  expect(populator.getLdapUsers("user6")).andReturn(Collections.singleton(externalUser3));
  replay(populator);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  LdapBatchDto result=populator.synchronizeLdapUsers(createSet("user2","user1","user6"),new LdapBatchDto());
  assertEquals(2,result.getUsersToBecomeLdap().size());
  assertTrue(result.getUsersToBecomeLdap().contains("user1"));
  assertTrue(result.getUsersToBecomeLdap().contains("user6"));
  assertTrue(result.getUsersToBeCreated().isEmpty());
  assertTrue(result.getUsersToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeRemoved().isEmpty());
  assertTrue(result.getGroupsToBeCreated().isEmpty());
  assertTrue(result.getGroupsToBecomeLdap().isEmpty());
  assertTrue(result.getMembershipToAdd().isEmpty());
  assertTrue(result.getMembershipToRemove().isEmpty());
  verify(populator.loadLdapTemplate(),populator);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsLdapEnabled_badConfiguration(){
  final Configuration configuration=createNiceMock(Configuration.class);
  final Users users=createNiceMock(Users.class);
  LdapTemplate ldapTemplate=createNiceMock(LdapTemplate.class);
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(configuration.isLdapConfigured()).andReturn(true);
  expect(ldapTemplate.search(EasyMock.<String>anyObject(),EasyMock.<String>anyObject(),EasyMock.<AttributesMapper>anyObject())).andThrow(new NullPointerException()).once();
  replay(ldapTemplate,configuration,ldapServerProperties);
  final AmbariLdapDataPopulatorTestInstance populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  populator.setLdapTemplate(ldapTemplate);
  populator.setLdapServerProperties(ldapServerProperties);
  assertFalse(populator.isLdapEnabled());
  verify(populator.loadLdapTemplate(),configuration);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.ActionLogTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteStdErr() throws Exception {
  ActionLog actionLog=new ActionLog();
  actionLog.writeStdErr(null);
  Assert.assertEquals("",actionLog.getStdErr());
  Assert.assertEquals("",actionLog.getStdOut());
  actionLog.writeStdErr("This is a test message");
  Assert.assertNotNull(actionLog.getStdErr());
  Assert.assertTrue(actionLog.getStdErr().contains("This is a test message"));
  Assert.assertEquals("",actionLog.getStdOut());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteStdOut() throws Exception {
  ActionLog actionLog=new ActionLog();
  actionLog.writeStdOut(null);
  Assert.assertEquals("",actionLog.getStdOut());
  Assert.assertEquals("",actionLog.getStdErr());
  actionLog.writeStdOut("This is a test message");
  Assert.assertNotNull(actionLog.getStdErr());
  Assert.assertTrue(actionLog.getStdOut().contains("This is a test message"));
  Assert.assertEquals("",actionLog.getStdErr());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.ADKerberosOperationHandlerTest </h4><pre class="type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessCreateTemplateCustom() throws Exception {
  PrincipalKeyCredential kc=new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD);
  Map<String,String> kerberosEnvMap=new HashMap<String,String>(){
{
      put(ADKerberosOperationHandler.KERBEROS_ENV_LDAP_URL,DEFAULT_LDAP_URL);
      put(ADKerberosOperationHandler.KERBEROS_ENV_PRINCIPAL_CONTAINER_DN,DEFAULT_PRINCIPAL_CONTAINER_DN);
      put(ADKerberosOperationHandler.KERBEROS_ENV_AD_CREATE_ATTRIBUTES_TEMPLATE,"" + "#set( $user = \"${principal_primary}-${principal_digest}\" )" + "{"+ "  \"objectClass\": ["+ "    \"top\","+ "    \"person\","+ "    \"organizationalPerson\","+ "    \"user\""+ "  ],"+ "  \"cn\": \"$user\","+ "  \"sAMAccountName\": \"$user.substring(0,20)\","+ "  #if( $is_service )"+ "  \"servicePrincipalName\": \"$principal_name\","+ "  #end"+ "  \"userPrincipalName\": \"$normalized_principal\","+ "  \"unicodePwd\": \"$password\","+ "  \"accountExpires\": \"0\","+ "  \"userAccountControl\": \"66048\""+ "}");
    }
  }
;
  Capture<Name> capturedName=new Capture<Name>();
  Capture<Attributes> capturedAttributes=new Capture<Attributes>();
  ADKerberosOperationHandler handler=createMockBuilder(ADKerberosOperationHandler.class).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createInitialLdapContext",Properties.class,Control[].class)).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createSearchControls")).createNiceMock();
  NamingEnumeration<SearchResult> searchResult=createNiceMock(NamingEnumeration.class);
  expect(searchResult.hasMore()).andReturn(false).once();
  LdapContext ldapContext=createNiceMock(LdapContext.class);
  expect(ldapContext.search(anyObject(String.class),anyObject(String.class),anyObject(SearchControls.class))).andReturn(searchResult).once();
  expect(ldapContext.createSubcontext(capture(capturedName),capture(capturedAttributes))).andReturn(createNiceMock(DirContext.class)).once();
  expect(handler.createInitialLdapContext(anyObject(Properties.class),anyObject(Control[].class))).andReturn(ldapContext).once();
  expect(handler.createSearchControls()).andAnswer(new IAnswer<SearchControls>(){
    @Override public SearchControls answer() throws Throwable {
      SearchControls searchControls=createNiceMock(SearchControls.class);
      replay(searchControls);
      return searchControls;
    }
  }
).once();
  replayAll();
  handler.open(kc,DEFAULT_REALM,kerberosEnvMap);
  handler.createPrincipal("nn/c6501.ambari.apache.org","secret",true);
  handler.close();
  Attributes attributes=capturedAttributes.getValue();
  String[] objectClasses=new String[]{"top","person","organizationalPerson","user"};
  Assert.assertNotNull(attributes);
  Assert.assertEquals(8,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("nn-995e1580db28198e7fda1417ab5d894c877937d2",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("servicePrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("servicePrincipalName").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("sAMAccountName"));
  Assert.assertTrue(attributes.get("sAMAccountName").get().toString().length() <= 20);
  Assert.assertEquals("nn-995e1580db28198e7",attributes.get("sAMAccountName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.CreateKeytabFilesServerActionTest </h4><pre class="type-4 type-2 type-5 type-20 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureAmbariOnlyAccess() throws Exception {
  Assume.assumeTrue(ShellCommandUtil.UNIX_LIKE);
  Path path;
  Set<PosixFilePermission> permissions;
  File directory=testFolder.newFolder();
  Assert.assertNotNull(directory);
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(directory);
  path=Paths.get(directory.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(3,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  File file=File.createTempFile("temp_","",directory);
  Assert.assertNotNull(file);
  Assert.assertTrue(file.exists());
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(file);
  path=Paths.get(file.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosConfigDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosConfigDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosConfigDataFileWriter writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_SET);
  }
  for (int i=10; i < 15; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_REMOVE);
  }
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosConfigDataFileReader reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 15) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
      if (i < 10) {
        Assert.assertEquals("SET",record.get(KerberosConfigDataFileReader.OPERATION));
      }
 else {
        Assert.assertEquals("REMOVE",record.get(KerberosConfigDataFileReader.OPERATION));
      }
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_SET);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(16,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_REMOVE);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(17,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosIdentityDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosIdentityDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosIdentityDataFileWriter writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.writeRecord("hostName" + i,"serviceName" + i,"serviceComponentName" + i,"principal" + i,"principal_type" + i,"keytabFilePath" + i,"keytabFileOwnerName" + i,"keytabFileOwnerAccess" + i,"keytabFileGroupName" + i,"keytabFileGroupAccess" + i,"false");
  }
  writer.writeRecord("hostName's","serviceName#","serviceComponentName\"","principal","principal_type","keytabFilePath","'keytabFileOwnerName'","<keytabFileOwnerAccess>","\"keytabFileGroupName\"","keytab,File,Group,Access","false");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosIdentityDataFileReader reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(12,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(13,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosOperationHandlerTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileFromBase64EncodedData() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal="principal@REALM.COM";
  Assert.assertTrue(handler.createKeytabFile(principal,"some password",0,file));
  FileInputStream fis=new FileInputStream(file);
  byte[] data=new byte[(int)file.length()];
  Assert.assertEquals(data.length,fis.read(data));
  fis.close();
  File f=handler.createKeytabFile(Base64.encodeBase64String(data));
  if (f != null) {
    try {
      Keytab keytab=Keytab.read(f);
      Assert.assertNotNull(keytab);
      List<KeytabEntry> entries=keytab.getEntries();
      Assert.assertNotNull(entries);
      Assert.assertFalse(entries.isEmpty());
      for (      KeytabEntry entry : entries) {
        Assert.assertEquals(principal,entry.getPrincipalName());
      }
    }
  finally {
      if (!f.delete()) {
        f.deleteOnExit();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileOneAtATime() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  int count;
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  count=entries.size();
  for (  KeytabEntry entry : entries) {
    Assert.assertEquals(principal1,entry.getPrincipalName());
  }
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  Assert.assertEquals(count * 2,entries.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureKeytabFileContainsNoDuplicates() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  Set<String> seenEntries=new HashSet<String>();
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  for (  KeytabEntry entry : entries) {
    String seenEntry=String.format("%s|%s",entry.getPrincipalName(),entry.getKey().getKeyType().toString());
    Assert.assertFalse(seenEntries.contains(seenEntry));
    seenEntries.add(seenEntry);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosServerActionTest </h4><pre class="type-7 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  final Cluster cluster=mock(Cluster.class);
  final Clusters clusters=mock(Clusters.class);
  when(clusters.getCluster(anyString())).thenReturn(cluster);
  final ExecutionCommand mockExecutionCommand=mock(ExecutionCommand.class);
  final HostRoleCommand mockHostRoleCommand=mock(HostRoleCommand.class);
  injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(KerberosHelper.class).toInstance(createNiceMock(KerberosHelper.class));
      bind(KerberosServerAction.class).toInstance(new KerberosServerAction(){
        @Override protected CommandReport processIdentity(        Map<String,String> identityRecord,        String evaluatedPrincipal,        KerberosOperationHandler operationHandler,        Map<String,String> kerberosConfiguration,        Map<String,Object> requestSharedDataContext) throws AmbariException {
          Assert.assertNotNull(requestSharedDataContext);
          if (requestSharedDataContext.get("FAIL") != null) {
            return createCommandReport(1,HostRoleStatus.FAILED,"{}","ERROR","ERROR");
          }
 else {
            requestSharedDataContext.put(identityRecord.get(KerberosIdentityDataFileReader.PRINCIPAL),evaluatedPrincipal);
            return null;
          }
        }
        @Override public CommandReport execute(        ConcurrentMap<String,Object> requestSharedDataContext) throws AmbariException, InterruptedException {
          return processIdentities(requestSharedDataContext);
        }
      }
);
      bind(Clusters.class).toInstance(clusters);
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
    }
  }
);
  temporaryDirectory=File.createTempFile("ambari_ut_",".d");
  Assert.assertTrue(temporaryDirectory.delete());
  Assert.assertTrue(temporaryDirectory.mkdirs());
  KerberosIdentityDataFileWriter writer=new KerberosIdentityDataFileWriter(new File(temporaryDirectory,KerberosIdentityDataFileWriter.DATA_FILE_NAME));
  for (int i=0; i < 10; i++) {
    writer.writeRecord("hostName","serviceName" + i,"serviceComponentName" + i,"principal|_HOST|_REALM" + i,"principal_type","keytabFilePath" + i,"keytabFileOwnerName" + i,"keytabFileOwnerAccess" + i,"keytabFileGroupName" + i,"keytabFileGroupAccess" + i,"false");
  }
  writer.close();
  commandParams.put(KerberosServerAction.DATA_DIRECTORY,temporaryDirectory.getAbsolutePath());
  commandParams.put(KerberosServerAction.DEFAULT_REALM,"REALM.COM");
  commandParams.put(KerberosServerAction.KDC_TYPE,KDCType.MIT_KDC.toString());
  when(mockExecutionCommand.getCommandParams()).thenReturn(commandParams);
  when(mockExecutionCommand.getClusterName()).thenReturn("c1");
  action=injector.getInstance(KerberosServerAction.class);
  action.setExecutionCommand(mockExecutionCommand);
  action.setHostRoleCommand(mockHostRoleCommand);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.MITKerberosOperationHandlerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCreateServicePrincipal_AdditionalAttributes() throws Exception {
  Method invokeKAdmin=MITKerberosOperationHandler.class.getDeclaredMethod("invokeKAdmin",String.class);
  Capture<? extends String> query=new Capture<String>();
  ShellCommandUtil.Result result1=createNiceMock(ShellCommandUtil.Result.class);
  expect(result1.getStderr()).andReturn("").anyTimes();
  expect(result1.getStdout()).andReturn("Principal \"" + DEFAULT_ADMIN_PRINCIPAL + "\" created\"").anyTimes();
  ShellCommandUtil.Result result2=createNiceMock(ShellCommandUtil.Result.class);
  expect(result2.getStderr()).andReturn("").anyTimes();
  expect(result2.getStdout()).andReturn("Key: vno 1").anyTimes();
  MITKerberosOperationHandler handler=createMockBuilder(MITKerberosOperationHandler.class).addMockedMethod(invokeKAdmin).createStrictMock();
  expect(handler.invokeKAdmin(capture(query))).andReturn(result1).once();
  expect(handler.invokeKAdmin("get_principal " + DEFAULT_ADMIN_PRINCIPAL)).andReturn(result2).once();
  replay(handler,result1,result2);
  handler.open(new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD),DEFAULT_REALM,KERBEROS_ENV_MAP);
  handler.createPrincipal(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD,false);
  verify(handler,result1,result2);
  Assert.assertTrue(query.getValue().contains(" " + KERBEROS_ENV_MAP.get(MITKerberosOperationHandler.KERBEROS_ENV_KDC_CREATE_ATTRIBUTES) + " "));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTestAdministratorCredentialsNotFound() throws Exception {
  MITKerberosOperationHandler handler=createMockBuilder(MITKerberosOperationHandler.class).addMockedMethod(KerberosOperationHandler.class.getDeclaredMethod("executeCommand",String[].class)).createNiceMock();
  expect(handler.executeCommand(anyObject(String[].class))).andAnswer(new IAnswer<ShellCommandUtil.Result>(){
    @Override public ShellCommandUtil.Result answer() throws Throwable {
      ShellCommandUtil.Result result=createMock(ShellCommandUtil.Result.class);
      expect(result.getExitCode()).andReturn(0).anyTimes();
      expect(result.isSuccessful()).andReturn(true).anyTimes();
      expect(result.getStderr()).andReturn("get_principal: Principal does not exist while retrieving \"admin/admi@EXAMPLE.COM\".").anyTimes();
      expect(result.getStdout()).andReturn("Authenticating as principal admin/admin with password.").anyTimes();
      replay(result);
      return result;
    }
  }
);
  replayAll();
  handler.open(new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD),DEFAULT_REALM,KERBEROS_ENV_MAP);
  Assert.assertFalse(handler.testAdministratorCredentials());
  handler.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.ComponentVersionCheckActionTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMixedComponentVersions() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_1_0;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Clusters clusters=m_injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getCluster("c1");
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  cluster.getServiceComponentHosts("HDFS","NAMENODE").get(0).setVersion(targetRepo);
  ClusterVersionEntity upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion("c1",HDP_22_STACK,targetRepo);
  upgradingClusterVersion.setState(RepositoryVersionState.UPGRADING);
  upgradingClusterVersion=clusterVersionDAO.merge(upgradingClusterVersion);
  upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion("c1",HDP_22_STACK,targetRepo);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findByClusterStackAndVersion("c1",HDP_22_STACK,targetRepo);
  assertEquals(RepositoryVersionState.UPGRADING,upgradingClusterVersion.getState());
  assertTrue(hostVersions.size() > 0);
  for (  HostVersionEntity hostVersion : hostVersions) {
    assertEquals(RepositoryVersionState.UPGRADED,hostVersion.getState());
  }
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ComponentVersionCheckAction action=m_injector.getInstance(ComponentVersionCheckAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.FAILED.name(),report.getStatus());
  assertEquals(-1,report.getExitCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.ConfigureActionTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoerceValueOnCopy() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("zoo.server.csv","c6401,c6402,  c6403");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Transfer> transfers=new ArrayList<Transfer>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.coerceTo=TransferCoercionType.YAML_ARRAY;
  transfer.fromKey="zoo.server.csv";
  transfer.toKey="zoo.server.array";
  transfer.defaultValue="['foo','bar']";
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("c6401,c6402,  c6403",map.get("zoo.server.csv"));
  assertEquals("['c6401','c6402','c6403']",map.get("zoo.server.array"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that DELETE "*" with edit preserving works correctly.
 * @throws Exception
 */
@Test public void testDeletePreserveChanges() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("tickTime","2000");
      put("foo","bar");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Transfer> transfers=new ArrayList<>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="*";
  transfer.preserveEdits=true;
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("bar",map.get("foo"));
  assertFalse(map.containsKey("tickTime"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigTransferCopy() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("initLimit","10");
      put("copyIt","10");
      put("moveIt","10");
      put("deleteIt","10");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  List<ConfigurationKeyValue> configurations=new ArrayList<>();
  ConfigurationKeyValue keyValue=new ConfigurationKeyValue();
  configurations.add(keyValue);
  keyValue.key="initLimit";
  keyValue.value="11";
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  commandParams.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,new Gson().toJson(configurations));
  List<Transfer> transfers=new ArrayList<>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.fromKey="copyIt";
  transfer.toKey="copyKey";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.fromKey="copiedFromMissingKeyWithDefault";
  transfer.toKey="copiedToMissingKeyWithDefault";
  transfer.defaultValue="defaultValue";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.MOVE;
  transfer.fromKey="moveIt";
  transfer.toKey="movedKey";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.MOVE;
  transfer.fromKey="movedFromKeyMissingWithDefault";
  transfer.toKey="movedToMissingWithDefault";
  transfer.defaultValue="defaultValue2";
  transfer.mask=true;
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="deleteIt";
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("11",map.get("initLimit"));
  assertEquals("10",map.get("copyIt"));
  assertTrue(map.containsKey("copyKey"));
  assertEquals(map.get("copyIt"),map.get("copyKey"));
  assertFalse(map.containsKey("moveIt"));
  assertTrue(map.containsKey("movedKey"));
  assertFalse(map.containsKey("deletedKey"));
  assertTrue(map.containsKey("copiedToMissingKeyWithDefault"));
  assertEquals("defaultValue",map.get("copiedToMissingKeyWithDefault"));
  assertTrue(map.containsKey("movedToMissingWithDefault"));
  assertEquals("defaultValue2",map.get("movedToMissingWithDefault"));
  transfers.clear();
  transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="*";
  transfer.preserveEdits=true;
  transfer.keepKeys.add("copyKey");
  transfer.keepKeys.add("keyNotExisting");
  transfer.keepKeys.add(null);
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  report=action.execute(null);
  assertNotNull(report);
  assertEquals(4,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  map=config.getProperties();
  assertEquals(6,map.size());
  assertTrue(map.containsKey("initLimit"));
  assertTrue(map.containsKey("copyKey"));
  assertFalse(map.containsKey("keyNotExisting"));
  assertFalse(map.containsKey(null));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleKeyValuesPerTask() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setCurrentStackVersion(HDP_211_STACK);
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("fooKey","barValue");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  List<ConfigurationKeyValue> configurations=new ArrayList<ConfigurationKeyValue>();
  ConfigurationKeyValue fooKey2=new ConfigurationKeyValue();
  configurations.add(fooKey2);
  fooKey2.key="fooKey2";
  fooKey2.value="barValue2";
  ConfigurationKeyValue fooKey3=new ConfigurationKeyValue();
  configurations.add(fooKey3);
  fooKey3.key="fooKey3";
  fooKey3.value="barValue3";
  fooKey3.mask=true;
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  commandParams.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,new Gson().toJson(configurations));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertEquals("barValue",config.getProperties().get("fooKey"));
  assertEquals("barValue2",config.getProperties().get("fooKey2"));
  assertEquals("barValue3",config.getProperties().get("fooKey3"));
  assertTrue(report.getStdOut().contains("******"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueReplacement() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("key_to_replace","My New Cat");
      put("key_with_no_match","WxyAndZ");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Replace> replacements=new ArrayList<Replace>();
  Replace replace=new Replace();
  replace.key="key_to_replace";
  replace.find="New Cat";
  replace.replaceWith="Wet Dog";
  replacements.add(replace);
  replace=new Replace();
  replace.key="key_with_no_match";
  replace.find="abc";
  replace.replaceWith="def";
  replacements.add(replace);
  commandParams.put(ConfigureTask.PARAMETER_REPLACEMENTS,new Gson().toJson(replacements));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  assertEquals("My Wet Dog",config.getProperties().get("key_to_replace"));
  assertEquals("WxyAndZ",config.getProperties().get("key_with_no_match"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.RangerConfigCalculationTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAction() throws Exception {
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("clusterName","c1");
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hrc=EasyMock.createMock(HostRoleCommand.class);
  expect(hrc.getRequestId()).andReturn(1L).anyTimes();
  expect(hrc.getStageId()).andReturn(2L).anyTimes();
  expect(hrc.getExecutionCommandWrapper()).andReturn(new ExecutionCommandWrapper(executionCommand)).anyTimes();
  replay(hrc);
  RangerConfigCalculation action=new RangerConfigCalculation();
  m_clusterField.set(action,m_clusters);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hrc);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  Cluster c=m_clusters.getCluster("c1");
  Config config=c.getDesiredConfigByType("ranger-admin-site");
  Map<String,String> map=config.getProperties();
  assertTrue(map.containsKey("ranger.jpa.jdbc.driver"));
  assertTrue(map.containsKey("ranger.jpa.jdbc.url"));
  assertTrue(map.containsKey("ranger.jpa.jdbc.dialect"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.driver"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.url"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.dialect"));
  assertEquals("com.mysql.jdbc.Driver",map.get("ranger.jpa.jdbc.driver"));
  assertEquals("jdbc:mysql://host1/ranger",map.get("ranger.jpa.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.MySQLPlatform",map.get("ranger.jpa.jdbc.dialect"));
  assertEquals("com.mysql.jdbc.Driver",map.get("ranger.jpa.audit.jdbc.driver"));
  assertEquals("jdbc:mysql://host1/ranger_audit",map.get("ranger.jpa.audit.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.MySQLPlatform",map.get("ranger.jpa.audit.jdbc.dialect"));
  config=c.getDesiredConfigByType("admin-properties");
  config.getProperties().put("DB_FLAVOR","oracle");
  report=action.execute(null);
  assertNotNull(report);
  config=c.getDesiredConfigByType("ranger-admin-site");
  map=config.getProperties();
  assertEquals("oracle.jdbc.OracleDriver",map.get("ranger.jpa.jdbc.driver"));
  assertEquals("jdbc:oracle:thin:@//host1",map.get("ranger.jpa.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.OraclePlatform",map.get("ranger.jpa.jdbc.dialect"));
  assertEquals("oracle.jdbc.OracleDriver",map.get("ranger.jpa.audit.jdbc.driver"));
  assertEquals("jdbc:oracle:thin:@//host1",map.get("ranger.jpa.audit.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.OraclePlatform",map.get("ranger.jpa.audit.jdbc.dialect"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.SparkShufflePropertyConfigTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAction() throws Exception {
  ExecutionCommand executionCommand=new ExecutionCommand();
  Map<String,String> commandParams=new HashMap<>();
  HostRoleCommand hrc=EasyMock.createMock(HostRoleCommand.class);
  SparkShufflePropertyConfig action=new SparkShufflePropertyConfig();
  commandParams.put("clusterName","c1");
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  expect(hrc.getRequestId()).andReturn(1L).anyTimes();
  expect(hrc.getStageId()).andReturn(2L).anyTimes();
  expect(hrc.getExecutionCommandWrapper()).andReturn(new ExecutionCommandWrapper(executionCommand)).anyTimes();
  replay(cluster,hrc);
  clusterField.set(action,m_clusters);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hrc);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  Cluster c=m_clusters.getCluster("c1");
  Config config=c.getDesiredConfigByType("yarn-site");
  Map<String,String> map=config.getProperties();
  assertTrue(map.containsKey("yarn.nodemanager.aux-services"));
  assertTrue(map.containsKey("yarn.nodemanager.aux-services.spark_shuffle.class"));
  assertEquals("some_service,spark_shuffle",map.get("yarn.nodemanager.aux-services"));
  assertEquals("org.apache.spark.network.yarn.YarnShuffleService",map.get("yarn.nodemanager.aux-services.spark_shuffle.class"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.UpgradeActionTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that finalization can occur when the cluster state is{@link RepositoryVersionState#UPGRADING} if all of the hosts and components
 * are reporting correct versions and states.
 * @throws Exception
 */
@Test public void testFinalizeUpgradeWithClusterStateInconsistencies() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  cluster.getServiceComponentHosts("HDFS","NAMENODE").get(0).setVersion(targetRepo);
  cluster.getServiceComponentHosts("HDFS","DATANODE").get(0).setVersion(targetRepo);
  ClusterVersionEntity upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  upgradingClusterVersion.setState(RepositoryVersionState.UPGRADING);
  upgradingClusterVersion=clusterVersionDAO.merge(upgradingClusterVersion);
  upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findByClusterStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  assertEquals(RepositoryVersionState.UPGRADING,upgradingClusterVersion.getState());
  assertTrue(hostVersions.size() > 0);
  for (  HostVersionEntity hostVersion : hostVersions) {
    assertEquals(RepositoryVersionState.UPGRADED,hostVersion.getState());
  }
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  StackId currentStackId=cluster.getCurrentStackVersion();
  StackId desiredStackId=cluster.getDesiredStackVersion();
  assertEquals(desiredStackId,currentStackId);
  assertEquals(targetStack,currentStackId);
  assertEquals(targetStack,desiredStackId);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests some of the action items are completed when finalizing downgrade
 * across stacks (HDP 2.2 -> HDP 2.3).
 * @throws Exception
 */
@Test public void testFinalizeDowngradeAcrossStacks() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  createConfigs(cluster);
  cluster=clusters.getCluster(clusterName);
  Collection<Config> configs=cluster.getAllConfigs();
  assertEquals(8,configs.size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"downgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,sourceRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  HostVersionDAO dao=m_injector.getInstance(HostVersionDAO.class);
  List<HostVersionEntity> hosts=dao.findByClusterStackAndVersion(clusterName,targetStack,targetRepo);
  assertFalse(hosts.isEmpty());
  for (  HostVersionEntity hve : hosts) {
    assertFalse(hve.getState() == RepositoryVersionState.INSTALLED);
  }
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  StackId currentStackId=cluster.getCurrentStackVersion();
  StackId desiredStackId=cluster.getDesiredStackVersion();
  assertEquals(desiredStackId,currentStackId);
  assertEquals(sourceStack,currentStackId);
  assertEquals(sourceStack,desiredStackId);
  cluster=clusters.getCluster(clusterName);
  configs=cluster.getAllConfigs();
  assertEquals(4,configs.size());
  hosts=dao.findByClusterStackAndVersion(clusterName,targetStack,targetRepo);
  assertFalse(hosts.isEmpty());
  for (  HostVersionEntity hve : hosts) {
    assertTrue(hve.getState() == RepositoryVersionState.INSTALLED);
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * During an Express Upgrade that crosses a stack version, Ambari calls UpdateDesiredStackAction
 * in order to change the stack and apply configs.
 * The configs that are applied must be saved with the username that is passed in the role params.
 */
@Test public void testExpressUpgradeUpdateDesiredStackAction() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  String upgradePackName="upgrade_nonrolling_new_stack";
  AmbariMetaInfo metaInfo=m_injector.getInstance(AmbariMetaInfo.class);
  Map<String,UpgradePack> packs=metaInfo.getUpgradePacks(sourceStack.getStackName(),sourceStack.getStackVersion());
  Assert.assertTrue(packs.containsKey(upgradePackName));
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  RepositoryVersionEntity targetRve=repoVersionDAO.findByStackNameAndVersion("HDP",targetRepo);
  Assert.assertNotNull(targetRve);
  Cluster cluster=clusters.getCluster(clusterName);
  Service zk=installService(cluster,"ZOOKEEPER");
  addServiceComponent(cluster,zk,"ZOOKEEPER_SERVER");
  addServiceComponent(cluster,zk,"ZOOKEEPER_CLIENT");
  createNewServiceComponentHost(cluster,"ZOOKEEPER","ZOOKEEPER_SERVER","h1");
  createNewServiceComponentHost(cluster,"ZOOKEEPER","ZOOKEEPER_CLIENT","h1");
  Service hdfs=installService(cluster,"HDFS");
  addServiceComponent(cluster,hdfs,"NAMENODE");
  addServiceComponent(cluster,hdfs,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  Collection<Config> configs=cluster.getAllConfigs();
  Assert.assertFalse(configs.isEmpty());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_ORIGINAL_STACK,sourceStack.getStackId());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_TARGET_STACK,targetStack.getStackId());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_DIRECTION,Direction.UPGRADE.toString());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_VERSION,targetRepo);
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_UPGRADE_PACK,upgradePackName);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  Map<String,String> roleParams=new HashMap<>();
  String userName="admin";
  roleParams.put(ServerAction.ACTION_USER_NAME,userName);
  executionCommand.setRoleParams(roleParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  UpdateDesiredStackAction action=m_injector.getInstance(UpdateDesiredStackAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  List<ServiceConfigVersionResponse> configVersionsBefore=cluster.getServiceConfigVersions();
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  List<ServiceConfigVersionResponse> configVersionsAfter=cluster.getServiceConfigVersions();
  Assert.assertFalse(configVersionsAfter.isEmpty());
  assertTrue(configVersionsAfter.size() - configVersionsBefore.size() >= 1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a case in which a customer performs an upgrade from HDP 2.1 to 2.2 (e.g., 2.2.0.0), but skips the step to
 * finalize, which calls "Save DB State". Therefore, the cluster's current stack is still on HDP 2.1.
 * They can still modify the database manually to mark HDP 2.2 as CURRENT in the cluster_version and then begin
 * another upgrade to 2.2.0.2 and then downgrade.
 * In the downgrade, the original stack is still 2.1 but the stack for the version marked as CURRENT is 2.2; this
 * mismatch means that the downgrade should not delete configs and will report a warning.
 * @throws Exception
 */
@Test public void testFinalizeDowngradeWhenDidNotFinalizePreviousUpgrade() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId midStack=HDP_22_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String midRepo=HDP_2_2_0_1;
  String targetRepo=HDP_2_2_0_2;
  makeTwoUpgradesWhereLastDidNotComplete(sourceStack,sourceRepo,midStack,midRepo,targetStack,targetRepo);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"downgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,midRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.FAILED.name(),report.getStatus());
  assertTrue(report.getStdErr().contains(FinalizeUpgradeAction.PREVIOUS_UPGRADE_NOT_COMPLETED_MSG));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.ComponentModuleTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ClientToUpdateConfigs(){
  List<String> clientsToUpdate=new ArrayList<String>();
  String client1="one";
  String client2="two";
  clientsToUpdate.add(client1);
  clientsToUpdate.add(client2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setClientsToUpdateConfigs(clientsToUpdate);
  assertEquals(clientsToUpdate,resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs());
  info.setClientsToUpdateConfigs(clientsToUpdate);
  parentInfo.setClientsToUpdateConfigs(null);
  assertEquals(clientsToUpdate,resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs());
  List<String> clientsToUpdate2=new ArrayList<String>();
  String client3="two";
  String client4="four";
  clientsToUpdate2.add(client3);
  clientsToUpdate2.add(client4);
  info.setClientsToUpdateConfigs(clientsToUpdate2);
  parentInfo.setClientsToUpdateConfigs(clientsToUpdate);
  List<String> resolvedClientsToUpdate=resolveComponent(info,parentInfo).getModuleInfo().getClientsToUpdateConfigs();
  assertEquals(2,resolvedClientsToUpdate.size());
  assertTrue(resolvedClientsToUpdate.contains(client3));
  assertTrue(resolvedClientsToUpdate.contains(client4));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsDeleted(){
  ComponentInfo info=new ComponentInfo();
  info.setName("foo");
  ComponentModule component=new ComponentModule(info);
  assertFalse(component.isDeleted());
  info=new ComponentInfo();
  info.setName("foo");
  info.setDeleted(true);
  component=new ComponentModule(info);
  assertTrue(component.isDeleted());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Dependencies(){
  List<DependencyInfo> dependencies=new ArrayList<DependencyInfo>();
  DependencyInfo dependency1=new DependencyInfo();
  dependency1.setName("service/one");
  DependencyInfo dependency2=new DependencyInfo();
  dependency2.setName("service/two");
  dependencies.add(dependency1);
  dependencies.add(dependency2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setDependencies(dependencies);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getDependencies());
  info.setDependencies(dependencies);
  parentInfo.setDependencies(null);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getDependencies());
  List<DependencyInfo> dependencies2=new ArrayList<DependencyInfo>();
  DependencyInfo dependency3=new DependencyInfo();
  dependency3.setName("service/two");
  DependencyInfo dependency4=new DependencyInfo();
  dependency4.setName("service/four");
  dependencies2.add(dependency3);
  dependencies2.add(dependency4);
  info.setDependencies(dependencies2);
  parentInfo.setDependencies(dependencies);
  List<DependencyInfo> resolvedDependencies=resolveComponent(info,parentInfo).getModuleInfo().getDependencies();
  assertEquals(3,resolvedDependencies.size());
  assertTrue(resolvedDependencies.contains(dependency1));
  assertTrue(resolvedDependencies.contains(dependency3));
  assertTrue(resolvedDependencies.contains(dependency4));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_CustomCommands() throws Exception {
  List<CustomCommandDefinition> commands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition command1=new CustomCommandDefinition();
  setPrivateField(command1,"name","one");
  CustomCommandDefinition command2=new CustomCommandDefinition();
  setPrivateField(command2,"name","two");
  commands.add(command1);
  commands.add(command2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setCustomCommands(commands);
  assertEquals(commands,resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands());
  info.setCustomCommands(commands);
  parentInfo.setCustomCommands(null);
  assertEquals(commands,resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands());
  List<CustomCommandDefinition> commands2=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition command3=new CustomCommandDefinition();
  setPrivateField(command3,"name","two");
  CustomCommandDefinition command4=new CustomCommandDefinition();
  setPrivateField(command4,"name","four");
  commands2.add(command3);
  commands2.add(command4);
  info.setCustomCommands(commands2);
  parentInfo.setCustomCommands(commands);
  List<CustomCommandDefinition> resolvedCommands=resolveComponent(info,parentInfo).getModuleInfo().getCustomCommands();
  assertEquals(3,resolvedCommands.size());
  assertTrue(resolvedCommands.contains(command1));
  assertTrue(resolvedCommands.contains(command3));
  assertTrue(resolvedCommands.contains(command4));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ConfigDependencies(){
  List<String> dependencies=new ArrayList<String>();
  String dependency1="one";
  String dependency2="two";
  dependencies.add(dependency1);
  dependencies.add(dependency2);
  ComponentInfo info=new ComponentInfo();
  ComponentInfo parentInfo=new ComponentInfo();
  parentInfo.setConfigDependencies(dependencies);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies());
  info.setConfigDependencies(dependencies);
  parentInfo.setConfigDependencies(null);
  assertEquals(dependencies,resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies());
  List<String> dependencies2=new ArrayList<String>();
  String dependency3="two";
  String dependency4="four";
  dependencies2.add(dependency3);
  dependencies2.add(dependency4);
  info.setConfigDependencies(dependencies2);
  parentInfo.setConfigDependencies(dependencies);
  List<String> resolvedDependencies=resolveComponent(info,parentInfo).getModuleInfo().getConfigDependencies();
  assertEquals(2,resolvedDependencies.size());
  assertTrue(resolvedDependencies.contains(dependency3));
  assertTrue(resolvedDependencies.contains(dependency4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.QuickLinksConfigurationModuleTest </h4><pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveOverride() throws Exception {
  QuickLinks[] results=resolveQuickLinks("parent_quicklinks.json","child_quicklinks_to_override.json");
  QuickLinks parentQuickLinks=results[0];
  QuickLinks childQuickLinks=results[1];
  QuickLinksConfiguration childQuickLinksConfig=childQuickLinks.getQuickLinksConfiguration();
  assertNotNull(childQuickLinksConfig);
  List<Link> links=childQuickLinksConfig.getLinks();
  assertNotNull(links);
  assertEquals(7,links.size());
  assertEquals(4,parentQuickLinks.getQuickLinksConfiguration().getLinks().size());
  boolean hasLink=false;
  for (  Link link : links) {
    String name=link.getName();
    if ("thread_stacks".equals(name)) {
      hasLink=true;
      Port port=link.getPort();
      assertEquals("mapred-site",port.getSite());
    }
  }
  assertTrue(hasLink);
  Protocol protocol=childQuickLinksConfig.getProtocol();
  assertNotNull(protocol);
  assertEquals("http",protocol.getType());
  assertEquals(3,protocol.getChecks().size());
  List<Check> checks=protocol.getChecks();
  for (  Check check : checks) {
    assertEquals("mapred-site",check.getSite());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.ServiceModuleTest </h4><pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testInvalidServiceInfo(){
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setName("TEST_SERVICE");
  serviceInfo.setVersion("1.0.0");
  serviceInfo.setValid(false);
  serviceInfo.setErrors("Test error message");
  ServiceModule serviceModule=createServiceModule(serviceInfo);
  assertFalse("Service module should be invalid due to the service info being invalid !",serviceModule.isValid());
  assertTrue("Service module error collection should contain error message that caused service info being invalid !",serviceModule.getErrors().contains("Test error message"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_ConfigDependencies() throws Exception {
  List<String> configDependencies=new ArrayList<String>();
  configDependencies.add("foo");
  configDependencies.add("bar");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setConfigDependencies(configDependencies);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(configDependencies,service.getModuleInfo().getConfigDependencies());
  info.setConfigDependencies(null);
  parentInfo.setConfigDependencies(configDependencies);
  service=resolveService(info,parentInfo);
  assertEquals(configDependencies,service.getModuleInfo().getConfigDependencies());
  List<String> parentCustomCommands=new ArrayList<String>();
  parentCustomCommands.add("bar");
  parentCustomCommands.add("other");
  info.setConfigDependencies(configDependencies);
  parentInfo.setConfigDependencies(parentCustomCommands);
  service=resolveService(info,parentInfo);
  Collection<String> mergedConfigDependencies=service.getModuleInfo().getConfigDependencies();
  assertEquals(3,mergedConfigDependencies.size());
  assertTrue(mergedConfigDependencies.contains("foo"));
  assertTrue(mergedConfigDependencies.contains("bar"));
  assertTrue(mergedConfigDependencies.contains("other"));
  info.setConfigDependencies(null);
  parentInfo.setConfigDependencies(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getConfigDependencies().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__ExcludedTypes() throws Exception {
  ServiceInfo info=new ServiceInfo();
  info.setExcludedConfigTypes(Collections.singleton("BAR"));
  Collection<PropertyInfo> fooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop1=new PropertyInfo();
  prop1.setName("name1");
  prop1.setValue("val1");
  fooProperties.add(prop1);
  PropertyInfo prop2=new PropertyInfo();
  prop2.setName("name2");
  prop2.setValue("val2");
  fooProperties.add(prop2);
  Collection<PropertyInfo> barProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop3=new PropertyInfo();
  prop3.setName("name1");
  prop3.setValue("val3");
  barProperties.add(prop3);
  Collection<PropertyInfo> otherProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop4=new PropertyInfo();
  prop4.setName("name1");
  prop4.setValue("val4");
  otherProperties.add(prop4);
  ConfigurationModule configModule1=createConfigurationModule("FOO",fooProperties);
  ConfigurationModule configModule2=createConfigurationModule("BAR",barProperties);
  ConfigurationModule configModule3=createConfigurationModule("OTHER",otherProperties);
  Collection<ConfigurationModule> configModules=new ArrayList<ConfigurationModule>();
  configModules.add(configModule1);
  configModules.add(configModule2);
  configModules.add(configModule3);
  ServiceModule service=createServiceModule(info,configModules);
  List<PropertyInfo> properties=service.getModuleInfo().getProperties();
  assertEquals(4,properties.size());
  Map<String,Map<String,Map<String,String>>> attributes=service.getModuleInfo().getConfigTypeAttributes();
  assertEquals(2,attributes.size());
  assertTrue(attributes.containsKey("FOO"));
  assertTrue(attributes.containsKey("OTHER"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_CustomCommands() throws Exception {
  List<CustomCommandDefinition> customCommands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition cmd1=new CustomCommandDefinition();
  setPrivateField(cmd1,"name","cmd1");
  setPrivateField(cmd1,"background",false);
  CustomCommandDefinition cmd2=new CustomCommandDefinition();
  setPrivateField(cmd2,"name","cmd2");
  customCommands.add(cmd1);
  customCommands.add(cmd2);
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setCustomCommands(customCommands);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(customCommands,service.getModuleInfo().getCustomCommands());
  info.setCustomCommands(null);
  parentInfo.setCustomCommands(customCommands);
  service=resolveService(info,parentInfo);
  assertEquals(customCommands,service.getModuleInfo().getCustomCommands());
  List<CustomCommandDefinition> parentCustomCommands=new ArrayList<CustomCommandDefinition>();
  CustomCommandDefinition cmd3=new CustomCommandDefinition();
  setPrivateField(cmd3,"name","cmd1");
  setPrivateField(cmd3,"background",true);
  CustomCommandDefinition cmd4=new CustomCommandDefinition();
  setPrivateField(cmd4,"name","cmd4");
  parentCustomCommands.add(cmd3);
  parentCustomCommands.add(cmd4);
  info.setCustomCommands(customCommands);
  parentInfo.setCustomCommands(parentCustomCommands);
  service=resolveService(info,parentInfo);
  Collection<CustomCommandDefinition> mergedCommands=service.getModuleInfo().getCustomCommands();
  assertEquals(3,mergedCommands.size());
  assertTrue(mergedCommands.contains(cmd2));
  assertTrue(mergedCommands.contains(cmd3));
  assertTrue(mergedCommands.contains(cmd4));
  info.setCustomCommands(null);
  parentInfo.setCustomCommands(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getCustomCommands().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__ExcludedTypes__ParentType() throws Exception {
  ServiceInfo info=new ServiceInfo();
  info.setExcludedConfigTypes(Collections.singleton("BAR"));
  Collection<PropertyInfo> fooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop1=new PropertyInfo();
  prop1.setName("name1");
  prop1.setValue("val1");
  fooProperties.add(prop1);
  PropertyInfo prop2=new PropertyInfo();
  prop2.setName("name2");
  prop2.setValue("val2");
  fooProperties.add(prop2);
  ConfigurationModule childConfigModule=createConfigurationModule("FOO",fooProperties);
  Collection<ConfigurationModule> childConfigModules=new ArrayList<ConfigurationModule>();
  childConfigModules.add(childConfigModule);
  ServiceInfo parentInfo=new ServiceInfo();
  Collection<PropertyInfo> barProperties=new ArrayList<PropertyInfo>();
  PropertyInfo prop3=new PropertyInfo();
  prop3.setName("name1");
  prop3.setValue("val3");
  barProperties.add(prop3);
  ConfigurationModule parentConfigModule=createConfigurationModule("BAR",barProperties);
  Collection<ConfigurationModule> parentConfigModules=new ArrayList<ConfigurationModule>();
  parentConfigModules.add(parentConfigModule);
  ServiceModule service=createServiceModule(info,childConfigModules);
  ServiceModule parentService=createServiceModule(parentInfo,parentConfigModules);
  resolveService(service,parentService);
  List<PropertyInfo> properties=service.getModuleInfo().getProperties();
  assertEquals(2,properties.size());
  Map<String,Map<String,Map<String,String>>> attributes=service.getModuleInfo().getConfigTypeAttributes();
  assertEquals(1,attributes.size());
  assertTrue(attributes.containsKey("FOO"));
  Map<String,Map<String,Map<String,String>>> parentAttributes=parentService.getModuleInfo().getConfigTypeAttributes();
  assertEquals(1,parentAttributes.size());
  assertTrue(parentAttributes.containsKey("BAR"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_RequiredServices() throws Exception {
  List<String> requiredServices=new ArrayList<String>();
  requiredServices.add("foo");
  requiredServices.add("bar");
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  info.setRequiredServices(requiredServices);
  ServiceModule service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(null);
  parentInfo.setRequiredServices(requiredServices);
  service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(requiredServices);
  parentInfo.setRequiredServices(Collections.singletonList("other"));
  service=resolveService(info,parentInfo);
  assertEquals(requiredServices,service.getModuleInfo().getRequiredServices());
  info.setRequiredServices(null);
  parentInfo.setRequiredServices(null);
  service=resolveService(info,parentInfo);
  assertTrue(service.getModuleInfo().getRequiredServices().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeServiceProperties() throws Exception {
  ServiceInfo serviceInfo=new ServiceInfo();
  ServiceInfo parentServiceInfo=new ServiceInfo();
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("P1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("P2");
  p2.setValue("V2");
  ServicePropertyInfo p2Override=new ServicePropertyInfo();
  p2Override.setName("P2");
  p2Override.setValue("V2_OVERRIDE");
  ServicePropertyInfo p3=new ServicePropertyInfo();
  p3.setName("P3");
  p3.setValue("V3");
  List<ServicePropertyInfo> parentServicePropertyList=Lists.newArrayList(p1,p2);
  parentServiceInfo.setServicePropertyList(parentServicePropertyList);
  List<ServicePropertyInfo> servicePropertyList=Lists.newArrayList(p2Override,p3);
  serviceInfo.setServicePropertyList(servicePropertyList);
  ServiceModule serviceModule=resolveService(serviceInfo,parentServiceInfo);
  List<ServicePropertyInfo> expectedPropertyList=Lists.newArrayList(p1,p2Override,p3);
  Map<String,String> expectedServiceProperties=ImmutableMap.<String,String>builder().put("P1","V1").put("P2","V2_OVERRIDE").put("P3","V3").put(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY).put(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY).build();
  List<ServicePropertyInfo> actualPropertyList=serviceModule.getModuleInfo().getServicePropertyList();
  assertTrue(actualPropertyList.containsAll(expectedPropertyList) && expectedPropertyList.containsAll(actualPropertyList));
  assertEquals(expectedServiceProperties,serviceModule.getModuleInfo().getServiceProperties());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Configuration__attributes() throws Exception {
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  Collection<PropertyInfo> childFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo childProp1=new PropertyInfo();
  childProp1.setName("childName1");
  childProp1.setValue("childVal1");
  childFooProperties.add(childProp1);
  Map<String,String> childFooAttributes=new HashMap<String,String>();
  childFooAttributes.put(ConfigurationInfo.Supports.ADDING_FORBIDDEN.getXmlAttributeName(),"false");
  ConfigurationModule childConfigModule1=createConfigurationModule("FOO",childFooProperties,childFooAttributes);
  Collection<ConfigurationModule> childModules=new ArrayList<ConfigurationModule>();
  childModules.add(childConfigModule1);
  Collection<PropertyInfo> parentFooProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp1=new PropertyInfo();
  parentProp1.setName("parentName1");
  parentProp1.setValue("parentVal1");
  parentFooProperties.add(parentProp1);
  Map<String,String> parentFooAttributes=new HashMap<String,String>();
  parentFooAttributes.put(ConfigurationInfo.Supports.FINAL.getXmlAttributeName(),"true");
  parentFooAttributes.put(ConfigurationInfo.Supports.ADDING_FORBIDDEN.getXmlAttributeName(),"true");
  Collection<PropertyInfo> parentBarProperties=new ArrayList<PropertyInfo>();
  PropertyInfo parentProp2=new PropertyInfo();
  parentProp2.setName("parentName2");
  parentProp2.setValue("parentVal2");
  parentBarProperties.add(parentProp2);
  ConfigurationModule parentConfigModule1=createConfigurationModule("FOO",parentFooProperties,parentFooAttributes);
  ConfigurationModule parentConfigModule2=createConfigurationModule("BAR",parentBarProperties);
  Collection<ConfigurationModule> parentModules=new ArrayList<ConfigurationModule>();
  parentModules.add(parentConfigModule1);
  parentModules.add(parentConfigModule2);
  ServiceModule child=createServiceModule(info,childModules);
  ServiceModule parent=createServiceModule(parentInfo,parentModules);
  resolveService(child,parent);
  Map<String,Map<String,Map<String,String>>> childTypeAttributes=child.getModuleInfo().getConfigTypeAttributes();
  Map<String,Map<String,Map<String,String>>> parentTypeAttributes=parent.getModuleInfo().getConfigTypeAttributes();
  assertTrue(childTypeAttributes.containsKey("FOO"));
  Map<String,Map<String,String>> mergedChildFooAttributes=childTypeAttributes.get("FOO");
  assertTrue(mergedChildFooAttributes.containsKey(ConfigurationInfo.Supports.KEYWORD));
  assertEquals("true",mergedChildFooAttributes.get(ConfigurationInfo.Supports.KEYWORD).get(ConfigurationInfo.Supports.valueOf("FINAL").getPropertyName()));
  assertEquals("false",mergedChildFooAttributes.get(ConfigurationInfo.Supports.KEYWORD).get(ConfigurationInfo.Supports.valueOf("ADDING_FORBIDDEN").getPropertyName()));
  assertEquals(2,childTypeAttributes.size());
  assertEquals(2,parentTypeAttributes.size());
  assertAttributes(parentTypeAttributes.get("FOO"),parentFooAttributes);
  assertAttributes(parentTypeAttributes.get("BAR"),Collections.<String,String>emptyMap());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve_Components() throws Exception {
  ComponentInfo info1=new ComponentInfo();
  info1.setName("1");
  ComponentInfo info2=new ComponentInfo();
  info2.setName("2");
  ComponentInfo XX=new ComponentInfo();
  XX.setName("XX");
  ComponentInfo info3=new ComponentInfo();
  info3.setName("1");
  info3.setCardinality("ALL");
  info3.setCategory("category");
  ComponentInfo info4=new ComponentInfo();
  info4.setName("4");
  ComponentInfo info5=new ComponentInfo();
  info5.setName("XX");
  info5.setDeleted(true);
  ServiceInfo info=new ServiceInfo();
  ServiceInfo parentInfo=new ServiceInfo();
  List<ComponentInfo> childComponents=info.getComponents();
  childComponents.add(info3);
  childComponents.add(info4);
  childComponents.add(info5);
  List<ComponentInfo> parentComponents=parentInfo.getComponents();
  parentComponents.add(info1);
  parentComponents.add(info2);
  ServiceModule child=createServiceModule(info);
  ServiceModule parent=createServiceModule(parentInfo);
  resolveService(child,parent);
  List<ComponentInfo> components=child.getModuleInfo().getComponents();
  assertEquals(3,components.size());
  Map<String,ComponentInfo> mergedComponents=new HashMap<String,ComponentInfo>();
  for (  ComponentInfo component : components) {
    mergedComponents.put(component.getName(),component);
  }
  assertTrue(mergedComponents.containsKey("1"));
  assertTrue(mergedComponents.containsKey("2"));
  assertTrue(mergedComponents.containsKey("4"));
  assertEquals("ALL",mergedComponents.get("1").getCardinality());
  assertEquals("category",mergedComponents.get("1").getCategory());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerCommonServicesTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(2,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertFalse(pkg.getSkipUpgrade());
  ServiceOsSpecific.Package lzoPackage=packages.get(1);
  assertEquals("lzo",lzoPackage.getName());
  assertTrue(lzoPackage.getSkipUpgrade());
  assertEquals(pigService.getParent(),"common-services/PIG/1.0");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientConfigFilesInheritance() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo zkService=stack.getService("ZOOKEEPER");
  List<ComponentInfo> components=zkService.getComponents();
  assertTrue(components.size() == 2);
  ComponentInfo componentInfo=components.get(1);
  List<ClientConfigFileDefinition> clientConfigs=componentInfo.getClientConfigFiles();
  assertEquals(2,clientConfigs.size());
  assertEquals("zookeeper-env",clientConfigs.get(0).getDictionaryName());
  assertEquals("zookeeper-env.sh",clientConfigs.get(0).getFileName());
  assertEquals("env",clientConfigs.get(0).getType());
  assertEquals("zookeeper-log4j",clientConfigs.get(1).getDictionaryName());
  assertEquals("log4j.properties",clientConfigs.get(1).getFileName());
  assertEquals("env",clientConfigs.get(1).getType());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceExtension(){
  StackInfo stack=stackManager.getStack("OTHER","1.0");
  assertNotNull(stack);
  assertEquals("OTHER",stack.getName());
  assertEquals("1.0",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  assertEquals(6,stack.getService("HDFS").getComponents().size());
  ServiceInfo sqoopService=stack.getService("SQOOP2");
  assertNotNull(sqoopService);
  assertEquals("Extended SQOOP",sqoopService.getComment());
  assertEquals("Extended Version",sqoopService.getVersion());
  assertNull(sqoopService.getServicePackageFolder());
  Collection<ComponentInfo> components=sqoopService.getComponents();
  assertEquals(1,components.size());
  ComponentInfo component=components.iterator().next();
  assertEquals("SQOOP",component.getName());
  StackInfo baseStack=stackManager.getStack("HDP","2.1.1");
  ServiceInfo baseSqoopService=baseStack.getService("SQOOP");
  assertEquals(baseSqoopService.isDeleted(),sqoopService.isDeleted());
  assertEquals(baseSqoopService.getAlertsFile(),sqoopService.getAlertsFile());
  assertEquals(baseSqoopService.getClientComponent(),sqoopService.getClientComponent());
  assertEquals(baseSqoopService.getCommandScript(),sqoopService.getCommandScript());
  assertEquals(baseSqoopService.getConfigDependencies(),sqoopService.getConfigDependencies());
  assertEquals(baseSqoopService.getConfigDir(),sqoopService.getConfigDir());
  assertEquals(baseSqoopService.getConfigDependenciesWithComponents(),sqoopService.getConfigDependenciesWithComponents());
  assertEquals(baseSqoopService.getConfigTypeAttributes(),sqoopService.getConfigTypeAttributes());
  assertEquals(baseSqoopService.getCustomCommands(),sqoopService.getCustomCommands());
  assertEquals(baseSqoopService.getExcludedConfigTypes(),sqoopService.getExcludedConfigTypes());
  assertEquals(baseSqoopService.getProperties(),sqoopService.getProperties());
  assertEquals(baseSqoopService.getMetrics(),sqoopService.getMetrics());
  assertNull(baseSqoopService.getMetricsFile());
  assertNull(sqoopService.getMetricsFile());
  assertEquals(baseSqoopService.getOsSpecifics(),sqoopService.getOsSpecifics());
  assertEquals(baseSqoopService.getRequiredServices(),sqoopService.getRequiredServices());
  assertEquals(baseSqoopService.getSchemaVersion(),sqoopService.getSchemaVersion());
  ServiceInfo stormService=stack.getService("STORM");
  assertNotNull(stormService);
  assertEquals("STORM",stormService.getName());
  ServiceInfo baseStormService=baseStack.getService("STORM");
  assertEquals("Apache Hadoop Stream processing framework (Extended)",stormService.getComment());
  assertEquals("New version",stormService.getVersion());
  String packageDir=StringUtils.join(new String[]{"stacks","OTHER","1.0","services","STORM","package"},File.separator);
  assertEquals(packageDir,stormService.getServicePackageFolder());
  List<ComponentInfo> stormServiceComponents=stormService.getComponents();
  List<ComponentInfo> baseStormServiceComponents=baseStormService.getComponents();
  assertEquals(new HashSet<ComponentInfo>(stormServiceComponents),new HashSet<ComponentInfo>(baseStormServiceComponents));
  assertEquals(baseStormService.isDeleted(),stormService.isDeleted());
  assertEquals(baseStormService.getAlertsFile(),stormService.getAlertsFile());
  assertEquals(baseStormService.getClientComponent(),stormService.getClientComponent());
  assertEquals(baseStormService.getCommandScript(),stormService.getCommandScript());
  assertEquals(baseStormService.getConfigDependencies(),stormService.getConfigDependencies());
  assertEquals(baseStormService.getConfigDir(),stormService.getConfigDir());
  assertEquals(baseStormService.getConfigDependenciesWithComponents(),stormService.getConfigDependenciesWithComponents());
  assertEquals(baseStormService.getConfigTypeAttributes(),stormService.getConfigTypeAttributes());
  assertEquals(baseStormService.getCustomCommands(),stormService.getCustomCommands());
  assertEquals(baseStormService.getExcludedConfigTypes(),stormService.getExcludedConfigTypes());
  assertEquals(baseStormService.getProperties(),stormService.getProperties());
  assertEquals(baseStormService.getMetrics(),stormService.getMetrics());
  assertNotNull(baseStormService.getMetricsFile());
  assertNotNull(stormService.getMetricsFile());
  assertFalse(baseStormService.getMetricsFile().equals(stormService.getMetricsFile()));
  assertEquals(baseStormService.getOsSpecifics(),stormService.getOsSpecifics());
  assertEquals(baseStormService.getRequiredServices(),stormService.getRequiredServices());
  assertEquals(baseStormService.getSchemaVersion(),stormService.getSchemaVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMergeRoleCommandOrder() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.1.1");
  Map<String,Object> roleCommandOrder=stack.getRoleCommandOrder().getContent();
  assertTrue(roleCommandOrder.containsKey("optional_glusterfs"));
  assertTrue(roleCommandOrder.containsKey("general_deps"));
  assertTrue(roleCommandOrder.containsKey("optional_no_glusterfs"));
  assertTrue(roleCommandOrder.containsKey("namenode_optional_ha"));
  assertTrue(roleCommandOrder.containsKey("resourcemanager_optional_ha"));
  Map<String,Object> generalDeps=(Map<String,Object>)roleCommandOrder.get("general_deps");
  assertTrue(generalDeps.containsKey("HBASE_MASTER-START"));
  assertTrue(generalDeps.containsKey("HBASE_REGIONSERVER-START"));
  Map<String,Object> optionalNoGlusterfs=(Map<String,Object>)roleCommandOrder.get("optional_no_glusterfs");
  assertTrue(optionalNoGlusterfs.containsKey("SECONDARY_NAMENODE-START"));
  ArrayList<String> hbaseMasterStartValues=(ArrayList<String>)generalDeps.get("HBASE_MASTER-START");
  assertTrue(hbaseMasterStartValues.get(0).equals("ZOOKEEPER_SERVER-START"));
  assertTrue(optionalNoGlusterfs.containsKey("NAMENODE-STOP"));
  ArrayList<String> nameNodeStopValues=(ArrayList<String>)optionalNoGlusterfs.get("NAMENODE-STOP");
  assertTrue(nameNodeStopValues.contains("JOBTRACKER-STOP"));
  assertTrue(nameNodeStopValues.contains("CUSTOM_MASTER-STOP"));
  assertTrue(generalDeps.containsKey("CUSTOM_MASTER-START"));
  ArrayList<String> customMasterStartValues=(ArrayList<String>)generalDeps.get("CUSTOM_MASTER-START");
  assertTrue(customMasterStartValues.contains("ZOOKEEPER_SERVER-START"));
  assertTrue(customMasterStartValues.contains("NAMENODE-START"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServicesWithRangerPluginRoleCommandOrder() throws AmbariException {
  String stackRoot=ClassLoader.getSystemClassLoader().getResource("stacks").getPath().replace("test-classes","classes");
  String commonServices=ClassLoader.getSystemClassLoader().getResource("common-services").getPath().replace("test-classes","classes");
  MetainfoDAO metaInfoDao=createNiceMock(MetainfoDAO.class);
  StackDAO stackDao=createNiceMock(StackDAO.class);
  ActionMetadata actionMetadata=createNiceMock(ActionMetadata.class);
  Configuration config=createNiceMock(Configuration.class);
  expect(config.getSharedResourcesDirPath()).andReturn(ClassLoader.getSystemClassLoader().getResource("").getPath()).anyTimes();
  replay(config,metaInfoDao,stackDao,actionMetadata);
  OsFamily osFamily=new OsFamily(config);
  StackManager stackManager=new StackManager(new File(stackRoot),new File(commonServices),osFamily,metaInfoDao,actionMetadata,stackDao);
  String rangerUserSyncRoleCommand=Role.RANGER_USERSYNC + "-" + RoleCommand.START;
  String rangerAdminRoleCommand=Role.RANGER_ADMIN + "-" + RoleCommand.START;
  String zookeeperServerRoleCommand=Role.ZOOKEEPER_SERVER + "-" + RoleCommand.START;
  String nodeManagerRoleCommand=Role.NODEMANAGER + "-" + RoleCommand.START;
  String mySqlServerRoleCommand=Role.MYSQL_SERVER + "-" + RoleCommand.START;
  StackInfo hdp=stackManager.getStack("HDP","2.3");
  Map<String,Object> rco=hdp.getRoleCommandOrder().getContent();
  Map<String,Object> generalDeps=(Map<String,Object>)rco.get("general_deps");
  Map<String,Object> optionalNoGlusterfs=(Map<String,Object>)rco.get("optional_no_glusterfs");
  String nameNodeRoleCommand=Role.NAMENODE + "-" + RoleCommand.START;
  ArrayList<String> nameNodeBlockers=(ArrayList<String>)optionalNoGlusterfs.get(nameNodeRoleCommand);
  assertTrue(nameNodeRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,nameNodeBlockers.contains(rangerUserSyncRoleCommand));
  String dataNodeRoleCommand=Role.DATANODE + "-" + RoleCommand.START;
  ArrayList<String> dataNodeBlockers=(ArrayList<String>)optionalNoGlusterfs.get(dataNodeRoleCommand);
  assertTrue(dataNodeRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,dataNodeBlockers.contains(rangerUserSyncRoleCommand));
  String resourceManagerCommandRoleCommand=Role.RESOURCEMANAGER + "-" + RoleCommand.START;
  ArrayList<String> resourceManagerBlockers=(ArrayList<String>)generalDeps.get(resourceManagerCommandRoleCommand);
  assertTrue(resourceManagerCommandRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,resourceManagerBlockers.contains(rangerUserSyncRoleCommand));
  String hbaseRoleCommand=Role.HBASE_MASTER + "-" + RoleCommand.START;
  ArrayList<String> hbaseBlockers=(ArrayList<String>)generalDeps.get(hbaseRoleCommand);
  assertTrue(hbaseRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,hbaseBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(hbaseRoleCommand + " should be dependent of " + zookeeperServerRoleCommand,hbaseBlockers.contains(zookeeperServerRoleCommand));
  String knoxRoleCommand=Role.KNOX_GATEWAY + "-" + RoleCommand.START;
  ArrayList<String> knoxBlockers=(ArrayList<String>)generalDeps.get(knoxRoleCommand);
  assertTrue(knoxRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,knoxBlockers.contains(rangerUserSyncRoleCommand));
  String kafkaRoleCommand=Role.KAFKA_BROKER + "-" + RoleCommand.START;
  ArrayList<String> kafkaBlockers=(ArrayList<String>)generalDeps.get(kafkaRoleCommand);
  assertTrue(Role.KAFKA_BROKER + "-" + RoleCommand.START+ " should be dependent of "+ rangerUserSyncRoleCommand,kafkaBlockers.contains(rangerUserSyncRoleCommand));
  String hiveRoleCommand=Role.HIVE_SERVER + "-" + RoleCommand.START;
  ArrayList<String> hiveBlockers=(ArrayList<String>)generalDeps.get(hiveRoleCommand);
  assertTrue(hiveRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,hiveBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(hiveRoleCommand + " should be dependent of " + nodeManagerRoleCommand,hiveBlockers.contains(nodeManagerRoleCommand));
  assertTrue(hiveRoleCommand + " should be dependent of " + mySqlServerRoleCommand,hiveBlockers.contains(mySqlServerRoleCommand));
  String stormRoleCommand=Role.NIMBUS + "-" + RoleCommand.START;
  ArrayList<String> stormBlockers=(ArrayList<String>)generalDeps.get(stormRoleCommand);
  assertTrue(stormRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,stormBlockers.contains(rangerUserSyncRoleCommand));
  assertTrue(stormRoleCommand + " should be dependent of " + zookeeperServerRoleCommand,stormBlockers.contains(zookeeperServerRoleCommand));
  String kmsRoleCommand=Role.RANGER_KMS_SERVER + "-" + RoleCommand.START;
  ArrayList<String> rangerKmsBlockers=(ArrayList<String>)generalDeps.get(kmsRoleCommand);
  assertTrue(kmsRoleCommand + " should be dependent of " + rangerAdminRoleCommand,rangerKmsBlockers.contains(rangerAdminRoleCommand));
  ArrayList<String> rangerUserSyncBlockers=(ArrayList<String>)generalDeps.get(rangerUserSyncRoleCommand);
  assertTrue(rangerUserSyncRoleCommand + " should be dependent of " + rangerAdminRoleCommand,rangerUserSyncBlockers.contains(rangerAdminRoleCommand));
  assertTrue(rangerUserSyncRoleCommand + " should be dependent of " + kmsRoleCommand,rangerUserSyncBlockers.contains(kmsRoleCommand));
  ArrayList<String> zookeeperBlockers=(ArrayList<String>)generalDeps.get(zookeeperServerRoleCommand);
  assertTrue(zookeeperServerRoleCommand + " should be dependent of " + rangerUserSyncRoleCommand,zookeeperBlockers.contains(rangerUserSyncRoleCommand));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigTypes() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.7");
  ServiceInfo hdfsService=stack.getService("HDFS");
  Map<String,Map<String,Map<String,String>>> configTypes=hdfsService.getConfigTypeAttributes();
  assertEquals(4,configTypes.size());
  Map<String,Map<String,String>> configType=configTypes.get("global");
  assertEquals(1,configType.size());
  Map<String,String> supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("true",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("hdfs-site");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("core-site");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  configType=configTypes.get("hadoop-policy");
  assertEquals(1,configType.size());
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("false",supportsMap.get("adding_forbidden"));
  assertEquals("false",supportsMap.get("do_not_extend"));
  ServiceInfo yarnService=stack.getService("YARN");
  configTypes=yarnService.getConfigTypeAttributes();
  assertEquals(4,configTypes.size());
  assertTrue(configTypes.containsKey("yarn-site"));
  assertTrue(configTypes.containsKey("core-site"));
  assertTrue(configTypes.containsKey("global"));
  assertTrue(configTypes.containsKey("capacity-scheduler"));
  configType=configTypes.get("yarn-site");
  supportsMap=configType.get("supports");
  assertEquals(3,supportsMap.size());
  assertEquals("false",supportsMap.get("final"));
  assertEquals("true",supportsMap.get("adding_forbidden"));
  assertEquals("true",supportsMap.get("do_not_extend"));
  ServiceInfo mrService=stack.getService("MAPREDUCE2");
  configTypes=mrService.getConfigTypeAttributes();
  assertEquals(3,configTypes.size());
  assertTrue(configTypes.containsKey("mapred-site"));
  assertTrue(configTypes.containsKey("core-site"));
  assertTrue(configTypes.containsKey("mapred-queue-acls"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMonitoringServicePropertyInheritance() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.8");
  Collection<ServiceInfo> allServices=stack.getServices();
  assertEquals(13,allServices.size());
  boolean monitoringServiceFound=false;
  for (  ServiceInfo serviceInfo : allServices) {
    if (serviceInfo.getName().equals("FAKENAGIOS")) {
      monitoringServiceFound=true;
      assertTrue(serviceInfo.isMonitoringService());
    }
 else {
      assertNull(serviceInfo.isMonitoringService());
    }
  }
  assertTrue(monitoringServiceFound);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(1,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertNull(pigService.getParent());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackVersionInheritance(){
  StackInfo stack=stackManager.getStack("HDP","2.1.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("2.1.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(16,services.size());
  HashSet<String> expectedServices=new HashSet<String>();
  expectedServices.add("GANGLIA");
  expectedServices.add("HBASE");
  expectedServices.add("HCATALOG");
  expectedServices.add("HDFS");
  expectedServices.add("HIVE");
  expectedServices.add("MAPREDUCE2");
  expectedServices.add("OOZIE");
  expectedServices.add("PIG");
  expectedServices.add("SQOOP");
  expectedServices.add("YARN");
  expectedServices.add("ZOOKEEPER");
  expectedServices.add("STORM");
  expectedServices.add("FLUME");
  expectedServices.add("FAKENAGIOS");
  expectedServices.add("TEZ");
  expectedServices.add("AMBARI_METRICS");
  ServiceInfo pigService=null;
  for (  ServiceInfo service : services) {
    if (service.getName().equals("PIG")) {
      pigService=service;
    }
    assertTrue(expectedServices.remove(service.getName()));
  }
  assertTrue(expectedServices.isEmpty());
  assertNotNull(pigService);
  assertEquals("0.12.1.2.1.1",pigService.getVersion());
  assertEquals("Scripting platform for analyzing large datasets (Extended)",pigService.getComment());
  ServiceInfo basePigService=stackManager.getStack("HDP","2.0.5").getService("PIG");
  assertEquals("0.11.1.2.0.5.0",basePigService.getVersion());
  assertEquals(1,basePigService.getComponents().size());
  assertEquals(2,pigService.getComponents().size());
  assertEquals(0,basePigService.getProperties().size());
  assertEquals(1,pigService.getProperties().size());
  assertEquals("content",pigService.getProperties().get(0).getName());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigDependenciesInheritance() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo hdfsService=stack.getService("HDFS");
  assertEquals(5,hdfsService.getConfigDependencies().size());
  assertEquals(4,hdfsService.getConfigTypeAttributes().size());
  assertTrue(hdfsService.getConfigDependencies().contains("core-site"));
  assertTrue(hdfsService.getConfigDependencies().contains("global"));
  assertTrue(hdfsService.getConfigDependencies().contains("hdfs-site"));
  assertTrue(hdfsService.getConfigDependencies().contains("hdfs-log4j"));
  assertTrue(hdfsService.getConfigDependencies().contains("hadoop-policy"));
  assertTrue(Boolean.valueOf(hdfsService.getConfigTypeAttributes().get("core-site").get("supports").get("final")));
  assertFalse(Boolean.valueOf(hdfsService.getConfigTypeAttributes().get("global").get("supports").get("final")));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceDeletion(){
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  Collection<ServiceInfo> allServices=stack.getServices();
  assertEquals(11,allServices.size());
  HashSet<String> expectedServices=new HashSet<String>();
  expectedServices.add("GANGLIA");
  expectedServices.add("HBASE");
  expectedServices.add("HCATALOG");
  expectedServices.add("HDFS");
  expectedServices.add("HIVE");
  expectedServices.add("MAPREDUCE2");
  expectedServices.add("OOZIE");
  expectedServices.add("PIG");
  expectedServices.add("ZOOKEEPER");
  expectedServices.add("FLUME");
  expectedServices.add("YARN");
  for (  ServiceInfo service : allServices) {
    assertTrue(expectedServices.remove(service.getName()));
  }
  assertTrue(expectedServices.isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExcludedConfigTypes(){
  StackInfo stack=stackManager.getStack("HDP","2.0.8");
  ServiceInfo service=stack.getService("HBASE");
  assertFalse(service.hasConfigType("global"));
  Map<String,Map<String,Map<String,String>>> configTypes=service.getConfigTypeAttributes();
  assertEquals(2,configTypes.size());
  assertTrue(configTypes.containsKey("hbase-site"));
  assertTrue(configTypes.containsKey("hbase-policy"));
  stack=stackManager.getStack("HDP","2.1.1");
  service=stack.getService("HBASE");
  assertFalse(service.hasConfigType("global"));
  configTypes=service.getConfigTypeAttributes();
  assertEquals(2,configTypes.size());
  assertTrue(configTypes.containsKey("hbase-site"));
  assertTrue(configTypes.containsKey("hbase-policy"));
  assertFalse(configTypes.containsKey("global"));
  stack=stackManager.getStack("OTHER","2.0");
  service=stack.getService("HBASE");
  assertFalse(service.hasConfigType("hbase-policy"));
  assertFalse(service.hasConfigType("global"));
  configTypes=service.getConfigTypeAttributes();
  assertEquals(1,configTypes.size());
  assertTrue(configTypes.containsKey("hbase-site"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.CheckHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreUpgradeCheckClusterMissing() throws Exception {
  final Clusters clusters=Mockito.mock(Clusters.class);
  Mockito.when(clusters.getCluster(Mockito.anyString())).thenAnswer(new Answer<Cluster>(){
    @Override public Cluster answer(    InvocationOnMock invocation) throws Throwable {
      final String clusterName=invocation.getArguments()[0].toString();
      if (clusterName.equals("existing")) {
        return Mockito.mock(Cluster.class);
      }
 else {
        throw new ClusterNotFoundException(clusterName);
      }
    }
  }
);
  final OsFamily osFamily=Mockito.mock(OsFamily.class);
  final Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(Clusters.class).toInstance(clusters);
      bind(ClusterVersionDAO.class).toProvider(Providers.<ClusterVersionDAO>of(null));
      bind(HostVersionDAO.class).toProvider(Providers.<HostVersionDAO>of(null));
      bind(UpgradeDAO.class).toProvider(Providers.<UpgradeDAO>of(null));
      bind(RepositoryVersionDAO.class).toProvider(Providers.<RepositoryVersionDAO>of(null));
      bind(RepositoryVersionHelper.class).toProvider(Providers.<RepositoryVersionHelper>of(null));
      bind(AmbariMetaInfo.class).toProvider(Providers.<AmbariMetaInfo>of(null));
      bind(ServicesUpCheck.class).toInstance(new ServicesUpCheck());
      bind(OsFamily.class).toInstance(osFamily);
    }
  }
);
  final CheckHelper helper=injector.getInstance(CheckHelper.class);
  List<AbstractCheckDescriptor> updateChecksRegistry=new ArrayList<AbstractCheckDescriptor>();
  updateChecksRegistry.add(injector.getInstance(ServicesUpCheck.class));
  List<PrerequisiteCheck> upgradeChecks=helper.performChecks(new PrereqCheckRequest("existing"),updateChecksRegistry);
  Assert.assertEquals(PrereqCheckStatus.PASS,upgradeChecks.get(0).getStatus());
  upgradeChecks=helper.performChecks(new PrereqCheckRequest("non-existing"),updateChecksRegistry);
  Assert.assertEquals(PrereqCheckStatus.FAIL,upgradeChecks.get(0).getStatus());
  Assert.assertTrue(!upgradeChecks.get(0).getFailReason().equals("Unexpected server error happened"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigGroupTest </h4><pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveHost() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Long id=configGroup.getId();
  configGroup=cluster.getConfigGroups().get(id);
  Assert.assertNotNull(configGroup);
  clusters.unmapHostFromCluster("h1",clusterName);
  Assert.assertNull(clusters.getHostsForCluster(clusterName).get("h1"));
  Assert.assertNotNull(configGroupHostMappingDAO.findByHostId(1L));
  Assert.assertTrue(configGroupHostMappingDAO.findByHostId(1L).isEmpty());
  Assert.assertFalse(configGroup.getHosts().containsKey(1L));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Transactional public void testUpdateConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  ConfigGroupEntity configGroupEntity=configGroupDAO.findById(configGroup.getId());
  Assert.assertNotNull(configGroupEntity);
  configGroup=configGroupFactory.createExisting(cluster,configGroupEntity);
  Host host=clusters.getHost("h2");
  configGroup.addHost(host);
  Assert.assertEquals(2,configGroup.getHosts().values().size());
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("key1","value1");
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("key1","true");
  propertiesAttributes.put("final",attributes);
  Config config=new ConfigImpl("test-site");
  config.setProperties(properties);
  config.setPropertiesAttributes(propertiesAttributes);
  config.setTag("version100");
  configGroup.addConfiguration(config);
  Assert.assertEquals(2,configGroup.getConfigurations().values().size());
  configGroup.setName("NewName");
  configGroup.setDescription("NewDesc");
  configGroup.setTag("NewTag");
  configGroup.persist();
  configGroup.refresh();
  configGroupEntity=configGroupDAO.findByName("NewName");
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals(2,configGroupEntity.getConfigGroupHostMappingEntities().size());
  Assert.assertEquals(2,configGroupEntity.getConfigGroupConfigMappingEntities().size());
  Assert.assertEquals("NewTag",configGroupEntity.getTag());
  Assert.assertEquals("NewDesc",configGroupEntity.getDescription());
  Assert.assertNotNull(cluster.getConfig("test-site","version100"));
  ConfigGroupConfigMappingEntity configMappingEntity=null;
  Object[] array=configGroupEntity.getConfigGroupConfigMappingEntities().toArray();
  for (  Object o : array) {
    if ("test-site".equals(((ConfigGroupConfigMappingEntity)o).getConfigType())) {
      configMappingEntity=(ConfigGroupConfigMappingEntity)o;
      break;
    }
  }
  Assert.assertNotNull(configMappingEntity);
  Assert.assertTrue(configMappingEntity.getClusterConfigEntity().getData().contains("{\"key1\":\"value1\"}"));
  Assert.assertEquals("{\"final\":{\"key1\":\"true\"}}",configMappingEntity.getClusterConfigEntity().getAttributes());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNewConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  ConfigGroupEntity configGroupEntity=configGroupDAO.findByName("cg-test");
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  ConfigGroupConfigMappingEntity configMappingEntity=configGroupEntity.getConfigGroupConfigMappingEntities().iterator().next();
  Assert.assertNotNull(configMappingEntity);
  Assert.assertEquals("hdfs-site",configMappingEntity.getConfigType());
  Assert.assertEquals("testversion",configMappingEntity.getVersionTag());
  Assert.assertNotNull(configMappingEntity.getClusterConfigEntity());
  Assert.assertTrue(configMappingEntity.getClusterConfigEntity().getData().contains("a"));
  Assert.assertEquals("{\"final\":{\"a\":\"true\"}}",configMappingEntity.getClusterConfigEntity().getAttributes());
  ConfigGroupHostMappingEntity hostMappingEntity=configGroupEntity.getConfigGroupHostMappingEntities().iterator().next();
  Assert.assertNotNull(hostMappingEntity);
  Assert.assertEquals("h1",hostMappingEntity.getHostname());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigHelperTest.RunWithInMemoryDefaultTestModule </h4><pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMap() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","1");
  attributesValues.put("b","2");
  attributesValues.put("f","3");
  attributesValues.put("q","4");
  targetAttributesMap.put("attr",attributesValues);
  Map<String,Map<String,String>> sourceAttributesMap=new HashMap<String,Map<String,String>>();
  attributesValues=new HashMap<String,String>();
  attributesValues.put("a","5");
  attributesValues.put("f","6");
  sourceAttributesMap.put("attr",attributesValues);
  attributesValues=new HashMap<String,String>();
  attributesValues.put("f","7");
  attributesValues.put("q","8");
  sourceAttributesMap.put("attr1",attributesValues);
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(2,targetAttributesMap.size());
  Assert.assertTrue(targetAttributesMap.containsKey("attr"));
  Assert.assertTrue(targetAttributesMap.containsKey("attr1"));
  Map<String,String> attributes=targetAttributesMap.get("attr");
  Assert.assertEquals(4,attributes.size());
  Assert.assertEquals("5",attributes.get("a"));
  Assert.assertEquals("2",attributes.get("b"));
  Assert.assertEquals("6",attributes.get("f"));
  Assert.assertEquals("4",attributes.get("q"));
  attributes=targetAttributesMap.get("attr1");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("7",attributes.get("f"));
  Assert.assertEquals("8",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMapSourceIsNull() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","1");
  attributesValues.put("b","2");
  attributesValues.put("f","3");
  attributesValues.put("q","4");
  targetAttributesMap.put("attr",attributesValues);
  Map<String,Map<String,String>> sourceAttributesMap=null;
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(1,targetAttributesMap.size());
  Assert.assertTrue(targetAttributesMap.containsKey("attr"));
  Map<String,String> attributes=targetAttributesMap.get("attr");
  Assert.assertEquals(4,attributes.size());
  Assert.assertEquals("1",attributes.get("a"));
  Assert.assertEquals("2",attributes.get("b"));
  Assert.assertEquals("3",attributes.get("f"));
  Assert.assertEquals("4",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigTypeNoPropertyAttributes() throws Exception {
  Config currentConfig=cluster.getDesiredConfigByType("oozie-site");
  Map<String,String> properties=currentConfig.getProperties();
  Assert.assertEquals("version1",currentConfig.getTag());
  Assert.assertEquals("simple",properties.get("oozie.authentication.type"));
  Assert.assertEquals("false",properties.get("oozie.service.HadoopAccessorService.kerberos.enabled"));
  Map<String,String> updates=new HashMap<String,String>();
  updates.put("oozie.authentication.type","kerberos");
  updates.put("oozie.service.HadoopAccessorService.kerberos.enabled","true");
  configHelper.updateConfigType(cluster,managementController,"oozie-site",updates,null,"admin","Test " + "note");
  Config updatedConfig=cluster.getDesiredConfigByType("oozie-site");
  Assert.assertFalse("version1".equals(updatedConfig.getTag()));
  properties=updatedConfig.getProperties();
  Assert.assertTrue(properties.containsKey("oozie.authentication.type"));
  Assert.assertEquals("kerberos",properties.get("oozie.authentication.type"));
  Assert.assertTrue(properties.containsKey("oozie.service.HadoopAccessorService.kerberos.enabled"));
  Assert.assertEquals("true",properties.get("oozie.service.HadoopAccessorService.kerberos.enabled"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneAttributesMapTargetIsNull() throws Exception {
  Map<String,Map<String,String>> targetAttributesMap=null;
  Map<String,Map<String,String>> sourceAttributesMap=new HashMap<String,Map<String,String>>();
  Map<String,String> attributesValues=new HashMap<String,String>();
  attributesValues.put("a","5");
  attributesValues.put("f","6");
  sourceAttributesMap.put("attr",attributesValues);
  attributesValues=new HashMap<String,String>();
  attributesValues.put("f","7");
  attributesValues.put("q","8");
  sourceAttributesMap.put("attr1",attributesValues);
  configHelper.cloneAttributesMap(sourceAttributesMap,targetAttributesMap);
  Assert.assertEquals(2,sourceAttributesMap.size());
  Assert.assertTrue(sourceAttributesMap.containsKey("attr"));
  Assert.assertTrue(sourceAttributesMap.containsKey("attr1"));
  Map<String,String> attributes=sourceAttributesMap.get("attr");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("5",attributes.get("a"));
  Assert.assertEquals("6",attributes.get("f"));
  attributes=sourceAttributesMap.get("attr1");
  Assert.assertEquals(2,attributes.size());
  Assert.assertEquals("7",attributes.get("f"));
  Assert.assertEquals("8",attributes.get("q"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config1.setProperties(properties);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  Map<String,String> properties2=new HashMap<String,String>();
  properties2.put("namenode_heapsize","1111");
  config2.setProperties(properties2);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> propertyMap=configHelper.getEffectiveConfigProperties(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(propertyMap);
  Assert.assertTrue(propertyMap.containsKey("global"));
  Map<String,String> globalProps=propertyMap.get("global");
  Assert.assertEquals("1111",globalProps.get("namenode_heapsize"));
  Assert.assertEquals("/hadoop/hdfs/namenode",globalProps.get("dfs_namenode_name_dir"));
  Assert.assertTrue(propertyMap.containsKey("core-site"));
  Map<String,String> coreProps=propertyMap.get("core-site");
  Assert.assertTrue(coreProps.containsKey("a"));
  Assert.assertTrue(coreProps.containsKey("c"));
  Assert.assertEquals("30",coreProps.get("ipc.client.connect.max.retries"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCalculateIsStaleConfigs() throws Exception {
  Map<String,HostConfig> schReturn=new HashMap<String,HostConfig>();
  HostConfig hc=new HostConfig();
  hc.setDefaultVersionTag("version2");
  schReturn.put("flume-conf",hc);
  ServiceComponentHost sch=createNiceMock(ServiceComponentHost.class);
  expect(sch.getActualConfigs()).andReturn(schReturn).times(6);
  expect(sch.getHostName()).andReturn("h1").anyTimes();
  expect(sch.getClusterId()).andReturn(1l).anyTimes();
  expect(sch.getServiceName()).andReturn("FLUME").anyTimes();
  expect(sch.getServiceComponentName()).andReturn("FLUME_HANDLER").anyTimes();
  replay(sch);
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  HostConfig hc2=new HostConfig();
  hc2.setDefaultVersionTag("version1");
  schReturn.put("flume-conf",hc2);
  configHelper.invalidateStaleConfigsCache();
  Assert.assertFalse(configHelper.isStaleConfigs(sch));
  List<String> hosts=new ArrayList<String>();
  hosts.add("h1");
  List<Config> configs=new ArrayList<Config>();
  ConfigImpl configImpl=new ConfigImpl("flume-conf");
  configImpl.setTag("FLUME1");
  configs.add(configImpl);
  addConfigGroup("configGroup1","FLUME",hosts,configs);
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  HostConfig hc3=new HostConfig();
  hc3.setDefaultVersionTag("version1");
  hc3.getConfigGroupOverrides().put(1l,"FLUME1");
  schReturn.put("flume-conf",hc3);
  configHelper.invalidateStaleConfigsCache();
  Assert.assertFalse(configHelper.isStaleConfigs(sch));
  HostConfig hc4=new HostConfig();
  hc4.setDefaultVersionTag("version1");
  hc4.getConfigGroupOverrides().put(1l,"FLUME2");
  schReturn.put("flume-conf",hc4);
  configHelper.invalidateStaleConfigsCache();
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  HostConfig hc5=new HostConfig();
  hc5.setDefaultVersionTag("version3");
  hc5.getConfigGroupOverrides().put(1l,"FLUME1");
  schReturn.put("flume-conf",hc5);
  configHelper.invalidateStaleConfigsCache();
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  verify(sch);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesAttributesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("fs.trash.interval","11");
  attributes.put("b","y");
  Map<String,Map<String,String>> config1Attributes=new HashMap<String,Map<String,String>>();
  config1Attributes.put("attribute1",attributes);
  config1.setPropertiesAttributes(config1Attributes);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  attributes=new HashMap<String,String>();
  attributes.put("namenode_heapsize","z");
  attributes.put("c","q");
  Map<String,Map<String,String>> config2Attributes=new HashMap<String,Map<String,String>>();
  config2Attributes.put("attribute2",attributes);
  config2.setPropertiesAttributes(config2Attributes);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,Map<String,String>>> effectiveAttributes=configHelper.getEffectiveConfigAttributes(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(effectiveAttributes);
  Assert.assertEquals(4,effectiveAttributes.size());
  Assert.assertTrue(effectiveAttributes.containsKey("global"));
  Map<String,Map<String,String>> globalAttrs=effectiveAttributes.get("global");
  Assert.assertEquals(1,globalAttrs.size());
  Assert.assertTrue(globalAttrs.containsKey("attribute2"));
  Map<String,String> attribute2Occurances=globalAttrs.get("attribute2");
  Assert.assertEquals(3,attribute2Occurances.size());
  Assert.assertTrue(attribute2Occurances.containsKey("namenode_heapsize"));
  Assert.assertEquals("z",attribute2Occurances.get("namenode_heapsize"));
  Assert.assertTrue(attribute2Occurances.containsKey("dfs_namenode_name_dir"));
  Assert.assertEquals("3",attribute2Occurances.get("dfs_namenode_name_dir"));
  Assert.assertTrue(attribute2Occurances.containsKey("c"));
  Assert.assertEquals("q",attribute2Occurances.get("c"));
  Assert.assertTrue(effectiveAttributes.containsKey("core-site"));
  Map<String,Map<String,String>> coreAttrs=effectiveAttributes.get("core-site");
  Assert.assertEquals(1,coreAttrs.size());
  Assert.assertTrue(coreAttrs.containsKey("attribute1"));
  Map<String,String> attribute1Occurances=coreAttrs.get("attribute1");
  Assert.assertEquals(3,attribute1Occurances.size());
  Assert.assertTrue(attribute1Occurances.containsKey("ipc.client.connect.max.retries"));
  Assert.assertEquals("1",attribute1Occurances.get("ipc.client.connect.max.retries"));
  Assert.assertTrue(attribute1Occurances.containsKey("fs.trash.interval"));
  Assert.assertEquals("11",attribute1Occurances.get("fs.trash.interval"));
  Assert.assertTrue(attribute1Occurances.containsKey("b"));
  Assert.assertEquals("y",attribute1Occurances.get("b"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectiveTagsForHost() throws Exception {
  final Config config=new ConfigImpl("core-site");
  config.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config.setProperties(properties);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> configTags=configHelper.getEffectiveDesiredTags(cluster,"h1");
  Assert.assertNotNull(configTags);
  Map<String,String> tagsWithOverrides=configTags.get("core-site");
  Assert.assertNotNull(tagsWithOverrides);
  Assert.assertTrue(tagsWithOverrides.containsKey(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertEquals("version1",tagsWithOverrides.get(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertTrue(tagsWithOverrides.containsKey(groupId.toString()));
  Assert.assertEquals("version122",tagsWithOverrides.get(groupId.toString()));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigType() throws Exception {
  Config currentConfig=cluster.getDesiredConfigByType("core-site");
  Map<String,String> properties=currentConfig.getProperties();
  Map<String,Map<String,String>> propertiesAttributes=currentConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertEquals("version1",currentConfig.getTag());
  Assert.assertEquals("30",properties.get("fs.trash.interval"));
  Assert.assertTrue(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertTrue(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
  Map<String,String> updates=new HashMap<String,String>();
  updates.put("new-property","new-value");
  updates.put("fs.trash.interval","updated-value");
  Collection<String> removals=Collections.singletonList("ipc.client.connect.max.retries");
  configHelper.updateConfigType(cluster,managementController,"core-site",updates,removals,"admin","Test note");
  Config updatedConfig=cluster.getDesiredConfigByType("core-site");
  propertiesAttributes=updatedConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertFalse("version1".equals(updatedConfig.getTag()));
  properties=updatedConfig.getProperties();
  Assert.assertTrue(properties.containsKey("new-property"));
  Assert.assertEquals("new-value",properties.get("new-property"));
  Assert.assertTrue(properties.containsKey("fs.trash.interval"));
  Assert.assertEquals("updated-value",properties.get("fs.trash.interval"));
  Assert.assertEquals("2",propertiesAttributes.get("attribute1").get("fs.trash.interval"));
  Assert.assertFalse(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertFalse(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.PropertyInfoTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProperty(){
  PropertyInfo property=new PropertyInfo();
  property.setName("name");
  property.setValue("value");
  property.setDescription("desc");
  property.setFilename("filename");
  PropertyDependencyInfo pdi=new PropertyDependencyInfo("type","name");
  property.getDependsOnProperties().add(pdi);
  assertEquals("name",property.getName());
  assertEquals("value",property.getValue());
  assertEquals("desc",property.getDescription());
  assertEquals("filename",property.getFilename());
  assertEquals(1,property.getDependsOnProperties().size());
  assertTrue(property.getDependsOnProperties().contains(pdi));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceComponentTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  addHostToCluster("h1",service.getCluster().getClusterName());
  ServiceComponentHost sch=serviceComponentHostFactory.createNew(component,"h1");
  sch.setState(State.INSTALLED);
  Map<String,ServiceComponentHost> compHosts=new HashMap<String,ServiceComponentHost>();
  compHosts.put("h1",sch);
  component.addServiceComponentHosts(compHosts);
  Assert.assertEquals(1,component.getServiceComponentHosts().size());
  sch.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  sc.setDesiredState(State.INSTALLED);
  sc.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  ServiceComponentResponse r=sc.convertToResponse();
  Assert.assertEquals(sc.getClusterName(),r.getClusterName());
  Assert.assertEquals(sc.getClusterId(),r.getClusterId().longValue());
  Assert.assertEquals(sc.getName(),r.getComponentName());
  Assert.assertEquals(sc.getServiceName(),r.getServiceName());
  Assert.assertEquals(sc.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(sc.getDesiredState().toString(),r.getDesiredState());
  Assert.assertEquals(1,r.getTotalCount());
  Assert.assertEquals(0,r.getStartedCount());
  Assert.assertEquals(1,r.getInstalledCount());
  StringBuilder sb=new StringBuilder();
  sc.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponentHosts() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  try {
    serviceComponentHostFactory.createNew(sc,"h1");
    fail("Expected error for invalid host");
  }
 catch (  Exception e) {
  }
  addHostToCluster("h1",service.getCluster().getClusterName());
  addHostToCluster("h2",service.getCluster().getClusterName());
  addHostToCluster("h3",service.getCluster().getClusterName());
  HostEntity hostEntity1=hostDAO.findByName("h1");
  assertNotNull(hostEntity1);
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc,"h1");
  ServiceComponentHost sch2=serviceComponentHostFactory.createNew(sc,"h2");
  ServiceComponentHost failSch=serviceComponentHostFactory.createNew(sc,"h2");
  Map<String,ServiceComponentHost> compHosts=new HashMap<String,ServiceComponentHost>();
  compHosts.put("h1",sch1);
  compHosts.put("h2",sch2);
  compHosts.put("h3",failSch);
  try {
    sc.addServiceComponentHosts(compHosts);
    fail("Expected error for dups");
  }
 catch (  Exception e) {
  }
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  compHosts.remove("h3");
  sc.addServiceComponentHosts(compHosts);
  Assert.assertEquals(2,sc.getServiceComponentHosts().size());
  sch1.persist();
  sch2.persist();
  ServiceComponentHost schCheck=sc.getServiceComponentHost("h2");
  Assert.assertNotNull(schCheck);
  Assert.assertEquals("h2",schCheck.getHostName());
  ServiceComponentHost sch3=serviceComponentHostFactory.createNew(sc,"h3");
  sc.addServiceComponentHost(sch3);
  sch3.persist();
  Assert.assertNotNull(sc.getServiceComponentHost("h3"));
  sch1.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  sch1.setState(State.STARTING);
  sch1.setStackVersion(new StackId("HDP-1.2.0"));
  sch1.setDesiredState(State.STARTED);
  HostComponentDesiredStateDAO desiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentStateDAO liveStateDAO=injector.getInstance(HostComponentStateDAO.class);
  HostComponentDesiredStateEntityPK dPK=new HostComponentDesiredStateEntityPK();
  dPK.setClusterId(cluster.getClusterId());
  dPK.setComponentName(componentName);
  dPK.setHostId(hostEntity1.getHostId());
  dPK.setServiceName(serviceName);
  HostComponentDesiredStateEntity desiredStateEntity=desiredStateDAO.findByPK(dPK);
  HostComponentStateEntity stateEntity=liveStateDAO.findByIndex(cluster.getClusterId(),serviceName,componentName,hostEntity1.getHostId());
  ServiceComponentHost sch=serviceComponentHostFactory.createExisting(sc,stateEntity,desiredStateEntity);
  Assert.assertNotNull(sch);
  Assert.assertEquals(State.STARTING,sch.getState());
  Assert.assertEquals(State.STARTED,sch.getDesiredState());
  Assert.assertEquals("HDP-1.2.0",sch.getStackVersion().getStackId());
  Assert.assertEquals("HDP-1.2.0",sch.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponent() throws AmbariException {
  String componentName="DATANODE2";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  Assert.assertEquals(componentName,sc.getName());
  Assert.assertEquals(serviceName,sc.getServiceName());
  Assert.assertEquals(cluster.getClusterId(),sc.getClusterId());
  Assert.assertEquals(cluster.getClusterName(),sc.getClusterName());
  Assert.assertEquals(State.INIT,sc.getDesiredState());
  Assert.assertFalse(sc.getDesiredStackVersion().getStackId().isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCanBeRemoved() throws Exception {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  for (  State state : State.values()) {
    component.setDesiredState(state);
    if (state.isRemovableState()) {
      org.junit.Assert.assertTrue(component.canBeRemoved());
    }
 else {
      org.junit.Assert.assertFalse(component.canBeRemoved());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceInfoTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateServicePropertyValidationAfterSet(){
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("PROP1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("PROP1");
  p2.setValue("V2");
  List<ServicePropertyInfo> servicePropertyList=Lists.newArrayList(p1,p2);
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setName("TEST_NAME");
  serviceInfo.setVersion("TEST_VERSION");
  serviceInfo.setServicePropertyList(servicePropertyList);
  assertFalse("Service info should be in invalid state due to duplicate service property names !",serviceInfo.isValid());
  assertTrue("Service info error collection should contain the name of the duplicate service property !",serviceInfo.getErrors().contains("Duplicate service property with name 'PROP1' found in " + serviceInfo.getName() + ":"+ serviceInfo.getVersion()+ " service definition !"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSetRestartRequiredAfterRackChange() throws Exception {
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setRestartRequiredAfterRackChange(true);
  assertTrue(serviceInfo.isRestartRequiredAfterRackChange());
  serviceInfo.setRestartRequiredAfterRackChange(false);
  assertFalse(serviceInfo.isRestartRequiredAfterRackChange());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsRestartRequiredAfterRackChange() throws Exception {
  String serviceInfoXml="<metainfo>\n" + "  <schemaVersion>2.0</schemaVersion>\n" + "  <services>\n"+ "    <service>\n"+ "      <name>RESTART</name>\n"+ "      <displayName>RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>true</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>NO_RESTART</name>\n"+ "      <displayName>NO_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>false</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>DEFAULT_RESTART</name>\n"+ "      <displayName>DEFAULT_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>HCFS_SERVICE</name>\n"+ "      <displayName>HCFS_SERVICE</displayName>\n"+ "      <comment>Hadoop Compatible File System</comment>\n"+ "      <version>2.1.1.0</version>\n"+ "      <serviceType>HCFS</serviceType>\n"+ "    </service>\n"+ "  </services>\n"+ "</metainfo>\n";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  assertTrue(serviceInfoMap.get("RESTART").isRestartRequiredAfterRackChange());
  assertFalse(serviceInfoMap.get("NO_RESTART").isRestartRequiredAfterRackChange());
  assertNull(serviceInfoMap.get("DEFAULT_RESTART").isRestartRequiredAfterRackChange());
  assertEquals(serviceInfoMap.get("HCFS_SERVICE").getServiceType(),"HCFS");
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceProperties() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue(serviceProperties.containsKey("PROP1"));
  assertEquals("VAL1",serviceProperties.get("PROP1"));
  assertTrue(serviceProperties.containsKey("PROP2"));
  assertEquals("VAL2",serviceProperties.get("PROP2"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testVisibilityServicePropertyOverride() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "        <property>"+ "          <name>managed</name>"+ "          <value>false</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("false".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateServicePropertyValidationAfterXmlDeserialization() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <version>1.0</version>"+ "      <name>WITH_DUPLICATE_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "        <property>"+ "          <name>managed</name>"+ "          <value>false</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  ServiceInfo serviceInfo=serviceInfoMap.get("WITH_DUPLICATE_PROPS");
  assertFalse("Service info should be in invalid state due to duplicate service property names !",serviceInfo.isValid());
  assertTrue("Service info error collection should contain the name of the duplicate service property !",serviceInfo.getErrors().contains("Duplicate service property with name 'PROP1' found in " + serviceInfo.getName() + ":"+ serviceInfo.getVersion()+ " service definition !"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetServicePropertiesAfterPropertyListSet(){
  ServicePropertyInfo p1=new ServicePropertyInfo();
  p1.setName("PROP1");
  p1.setValue("V1");
  ServicePropertyInfo p2=new ServicePropertyInfo();
  p2.setName("PROP2");
  p2.setValue("V2");
  List<ServicePropertyInfo> servicePropertyList=Lists.newArrayList(p1,p2);
  ServiceInfo serviceInfo=new ServiceInfo();
  serviceInfo.setName("TEST_NAME");
  serviceInfo.setVersion("TEST_VERSION");
  serviceInfo.setServicePropertyList(servicePropertyList);
  Map<String,String> serviceProperties=serviceInfo.getServiceProperties();
  assertTrue(serviceProperties.containsKey("PROP1"));
  assertEquals("V1",serviceProperties.get("PROP1"));
  assertTrue(serviceProperties.containsKey("PROP2"));
  assertEquals("V2",serviceProperties.get("PROP2"));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultVisibilityServiceProperties() throws Exception {
  String serviceInfoXml="<metainfo>" + "  <schemaVersion>2.0</schemaVersion>" + "  <services>"+ "    <service>"+ "      <name>WITH_PROPS</name>"+ "      <displayName>WITH_PROPS</displayName>"+ "      <properties>"+ "        <property>"+ "          <name>PROP1</name>"+ "          <value>VAL1</value>"+ "        </property>"+ "        <property>"+ "          <name>PROP2</name>"+ "          <value>VAL2</value>"+ "        </property>"+ "      </properties>"+ "    </service>"+ "  </services>"+ "</metainfo>";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  Map<String,String> serviceProperties=serviceInfoMap.get("WITH_PROPS").getServiceProperties();
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_INSTALLABLE_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MANAGED_PROPERTY.getKey())));
  assertTrue("true".equals(serviceProperties.get(ServiceInfo.DEFAULT_SERVICE_MONITORED_PROPERTY.getKey())));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateService() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  Assert.assertEquals(serviceName,service.getName());
  Assert.assertEquals(cluster.getClusterId(),service.getCluster().getClusterId());
  Assert.assertEquals(cluster.getClusterName(),service.getCluster().getClusterName());
  Assert.assertEquals(State.INIT,service.getDesiredState());
  Assert.assertEquals(SecurityState.UNSECURED,service.getSecurityState());
  Assert.assertFalse(service.getDesiredStackVersion().getStackId().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteServiceComponent() throws Exception {
  Service hdfs=cluster.addService("HDFS");
  Service mapReduce=cluster.addService("MAPREDUCE");
  hdfs.persist();
  ServiceComponent nameNode=hdfs.addServiceComponent("NAMENODE");
  nameNode.persist();
  ServiceComponent jobTracker=mapReduce.addServiceComponent("JOBTRACKER");
  assertEquals(2,cluster.getServices().size());
  assertEquals(1,hdfs.getServiceComponents().size());
  assertEquals(1,mapReduce.getServiceComponents().size());
  assertTrue(hdfs.isPersisted());
  assertFalse(mapReduce.isPersisted());
  hdfs.deleteServiceComponent("NAMENODE");
  assertEquals(0,hdfs.getServiceComponents().size());
  assertEquals(1,mapReduce.getServiceComponents().size());
  mapReduce.deleteServiceComponent("JOBTRACKER");
  assertEquals(0,hdfs.getServiceComponents().size());
  assertEquals(0,mapReduce.getServiceComponents().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCanBeRemoved() throws Exception {
  Service service=cluster.addService("HDFS");
  for (  State state : State.values()) {
    service.setDesiredState(state);
    org.junit.Assert.assertTrue(service.canBeRemoved());
  }
  ServiceComponent component=service.addServiceComponent("NAMENODE");
  component.setDesiredState(State.INSTALLED);
  for (  State state : State.values()) {
    service.setDesiredState(state);
    org.junit.Assert.assertTrue(service.canBeRemoved());
  }
  component.setDesiredState(State.STARTED);
  for (  State state : State.values()) {
    service.setDesiredState(state);
    org.junit.Assert.assertFalse(service.canBeRemoved());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ServiceResponse r=s.convertToResponse();
  Assert.assertEquals(s.getName(),r.getServiceName());
  Assert.assertEquals(s.getCluster().getClusterName(),r.getClusterName());
  Assert.assertEquals(s.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(s.getDesiredState().toString(),r.getDesiredState());
  service.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  service.setDesiredState(State.INSTALLING);
  r=s.convertToResponse();
  Assert.assertEquals(s.getName(),r.getServiceName());
  Assert.assertEquals(s.getCluster().getClusterName(),r.getClusterName());
  Assert.assertEquals(s.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(s.getDesiredState().toString(),r.getDesiredState());
  StringBuilder sb=new StringBuilder();
  s.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponents() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  Assert.assertTrue(s.getServiceComponents().isEmpty());
  ServiceComponent sc1=serviceComponentFactory.createNew(s,"NAMENODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s,"DATANODE1");
  ServiceComponent sc3=serviceComponentFactory.createNew(s,"DATANODE2");
  Map<String,ServiceComponent> comps=new HashMap<String,ServiceComponent>();
  comps.put(sc1.getName(),sc1);
  comps.put(sc2.getName(),sc2);
  s.addServiceComponents(comps);
  Assert.assertEquals(2,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc1.getName()));
  Assert.assertNotNull(s.getServiceComponent(sc2.getName()));
  try {
    s.getServiceComponent(sc3.getName());
    fail("Expected error when looking for invalid component");
  }
 catch (  Exception e) {
  }
  s.addServiceComponent(sc3);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  ServiceComponent sc4=s.addServiceComponent("HDFS_CLIENT");
  Assert.assertNotNull(s.getServiceComponent(sc4.getName()));
  Assert.assertEquals(State.INIT,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
  Assert.assertTrue(sc4.isClientComponent());
  sc4.persist();
  Assert.assertEquals(4,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc3.getName()));
  Assert.assertEquals(sc3.getName(),s.getServiceComponent(sc3.getName()).getName());
  Assert.assertEquals(s.getName(),s.getServiceComponent(sc3.getName()).getServiceName());
  Assert.assertEquals(cluster.getClusterName(),s.getServiceComponent(sc3.getName()).getClusterName());
  sc4.setDesiredState(State.INSTALLING);
  Assert.assertEquals(State.INSTALLING,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.UpgradeHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckDowngradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(5,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(3);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that a Rolling Upgrades restarts the NameNodes in the following order: standby, active.
 * @throws Exception
 */
@Test public void testNamenodeOrder() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder mastersGroup=groups.get(2);
  assertEquals("CORE_MASTER",mastersGroup.name);
  List<String> orderedNameNodes=new LinkedList<String>();
  for (  StageWrapper sw : mastersGroup.items) {
    if (sw.getType().equals(StageWrapper.Type.RESTART) && sw.getText().toLowerCase().contains("NameNode".toLowerCase())) {
      for (      TaskWrapper tw : sw.getTasks()) {
        for (        String hostName : tw.getHosts()) {
          orderedNameNodes.add(hostName);
        }
      }
    }
  }
  assertEquals(2,orderedNameNodes.size());
  assertEquals("h2",orderedNameNodes.get(0));
  assertEquals("h1",orderedNameNodes.get(1));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that multiple execute tasks with an annotation of synchronized="true" each run in their own stage.
 */
@Test public void testUpgradeWithMultipleTasksInOwnStage() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> upgradePackGroups=upgrade.getGroups(Direction.UPGRADE);
  boolean foundService=false;
  for (  Grouping group : upgradePackGroups) {
    if (group.title.equals("Oozie")) {
      foundService=true;
    }
  }
  assertTrue(foundService);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  int numPrepareStages=0;
  for (  UpgradeGroupHolder group : groups) {
    if (group.name.equals("OOZIE")) {
      assertTrue(group.items.size() > 0);
      for (      StageWrapper sw : group.items) {
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2 (Batch 1 of 2)") || sw.getText().equalsIgnoreCase("Preparing Oozie Server on h3 (Batch 2 of 2)")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server.py".equalsIgnoreCase(task.script));
          assertTrue("stop".equalsIgnoreCase(task.function));
        }
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server_upgrade.py".equalsIgnoreCase(task.script));
          assertTrue("upgrade_oozie_database_and_sharelib".equalsIgnoreCase(task.function));
        }
      }
    }
  }
  assertEquals(3,numPrepareStages);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("OOZIE",groups.get(1).name);
  assertEquals("HIVE",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("CORE_MASTER",groups.get(4).name);
  assertEquals("ZOOKEEPER",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Downgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(8,groups.get(1).items.size());
  assertEquals(3,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
  assertEquals(8,groups.get(4).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTaskWithMultipleConfigurations() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  String transferJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  assertNotNull(transferJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(transferJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals("fooKey",keyValuePairs.get(0).key);
  assertEquals("fooValue",keyValuePairs.get(0).value);
  assertEquals("fooKey2",keyValuePairs.get(1).key);
  assertEquals("fooValue2",keyValuePairs.get(1).value);
  assertEquals("fooKey3",keyValuePairs.get(2).key);
  assertEquals("fooValue3",keyValuePairs.get(2).value);
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeServerActionOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_server_action_test"));
  UpgradePack upgrade=upgrades.get("upgrade_server_action_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals("CLUSTER_SERVER_ACTIONS",group.name);
  List<StageWrapper> stageWrappers=group.items;
  assertEquals(6,stageWrappers.size());
  assertEquals("Pre Upgrade",stageWrappers.get(0).getText());
  assertEquals("Pre Upgrade Zookeeper",stageWrappers.get(1).getText());
  assertEquals("Configuring",stageWrappers.get(2).getText());
  assertEquals("Configuring HDFS",stageWrappers.get(3).getText());
  assertEquals("Calculating Properties",stageWrappers.get(4).getText());
  assertEquals("Calculating HDFS Properties",stageWrappers.get(5).getText());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeAfterPartialUpgrade() throws Exception {
  Clusters clusters=injector.getInstance(Clusters.class);
  ServiceFactory serviceFactory=injector.getInstance(ServiceFactory.class);
  String clusterName="c1";
  StackId stackId=new StackId("HDP-2.1.1");
  clusters.addCluster(clusterName,stackId);
  Cluster c=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,c.getDesiredStackVersion().getStackVersion());
  c.createClusterVersion(stackId,c.getDesiredStackVersion().getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  for (int i=0; i < 2; i++) {
    String hostName="h" + (i + 1);
    clusters.addHost(hostName);
    Host host=clusters.getHost(hostName);
    Map<String,String> hostAttributes=new HashMap<String,String>();
    hostAttributes.put("os_family","redhat");
    hostAttributes.put("os_release_version","6");
    host.setHostAttributes(hostAttributes);
    host.persist();
    clusters.mapHostToCluster(hostName,clusterName);
  }
  c.addService(serviceFactory.createNew(c,"HDFS"));
  Service s=c.getService("HDFS");
  ServiceComponent sc=s.addServiceComponent("NAMENODE");
  sc.addServiceComponentHost("h1");
  sc.addServiceComponentHost("h2");
  List<ServiceComponentHost> schs=c.getServiceComponentHosts("HDFS","NAMENODE");
  assertEquals(2,schs.size());
  HostsType type=new HostsType();
  type.master="h1";
  type.secondary="h2";
  expect(m_masterHostResolver.getMasterAndHosts("ZOOKEEPER","ZOOKEEPER_SERVER")).andReturn(null).anyTimes();
  expect(m_masterHostResolver.getMasterAndHosts("HDFS","NAMENODE")).andReturn(type).anyTimes();
  expect(m_masterHostResolver.getCluster()).andReturn(c).anyTimes();
  replay(m_masterHostResolver);
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertNotNull(upgrade);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(2,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals(1,group.items.size());
  assertEquals("PRE_POST_CLUSTER",group.name);
  group=groups.get(1);
  assertEquals("POST_CLUSTER",group.name);
  assertEquals(3,group.items.size());
  StageWrapper stage=group.items.get(1);
  assertEquals("NameNode Finalize",stage.getText());
  assertEquals(1,stage.getTasks().size());
  TaskWrapper task=stage.getTasks().get(0);
  assertEquals(1,task.getHosts().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManualTaskPostProcessing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalDeleteTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  hiveConfigs.put("condition","1");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals(10,transfers.size());
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
  assertEquals("delete-key",transfers.get(2).deleteKey);
  assertEquals("delete-http",transfers.get(3).deleteKey);
  assertEquals("delete-null-if-value",transfers.get(4).deleteKey);
  assertEquals("delete-blank-if-key",transfers.get(5).deleteKey);
  assertEquals("delete-blank-if-type",transfers.get(6).deleteKey);
  assertEquals("delete-thrift",transfers.get(7).deleteKey);
  assertEquals("delete-if-key-present",transfers.get(8).deleteKey);
  assertEquals("delete-if-key-absent",transfers.get(9).deleteKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(5).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSuggestUpgradePack() throws Exception {
  final String clusterName="c1";
  final String upgradeFromVersion="2.1.1";
  final String upgradeToVersion="2.2.0";
  final Direction upgradeDirection=Direction.UPGRADE;
  final UpgradeType upgradeType=UpgradeType.ROLLING;
  makeCluster();
  try {
    String preferredUpgradePackName="upgrade_test";
    UpgradePack up=m_upgradeHelper.suggestUpgradePack(clusterName,upgradeFromVersion,upgradeToVersion,upgradeDirection,upgradeType,preferredUpgradePackName);
    assertEquals(upgradeType,up.getType());
  }
 catch (  AmbariException e) {
    assertTrue(false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that hosts in MM are not included in the upgrade.
 * @throws Exception
 */
@Test public void testUpgradeOrchestrationWithHostsInMM() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  Host hostInMaintenanceMode=cluster.getHosts().iterator().next();
  hostInMaintenanceMode.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  MasterHostResolver masterHostResolver=new MasterHostResolver(null,cluster,"");
  UpgradeContext context=new UpgradeContext(masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  for (  UpgradeGroupHolder group : groups) {
    for (    StageWrapper stageWrapper : group.items) {
      Set<String> hosts=stageWrapper.getHosts();
      assertFalse(hosts.contains(hostInMaintenanceMode.getHostName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationFullTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_to_new_stack"));
  UpgradePack upgrade=upgrades.get("upgrade_to_new_stack");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(6,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(4).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(5);
  assertEquals(postGroup.name,"POST_CLUSTER");
  assertEquals(postGroup.title,"Finalize Upgrade");
  assertEquals(4,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals("Run On All 2.2.1.0-1234",postGroup.items.get(3).getText());
  assertEquals(1,postGroup.items.get(3).getTasks().size());
  Set<String> hosts=postGroup.items.get(3).getTasks().get(0).getHosts();
  assertNotNull(hosts);
  assertEquals(4,hosts.size());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(5,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(1).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.thrift.port",keyValuePairs.get(0).key);
  assertEquals("10010",keyValuePairs.get(0).value);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.http.port",keyValuePairs.get(0).key);
  assertEquals("10011",keyValuePairs.get(0).value);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationWithNoHeartbeat() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster(false);
  Clusters clusters=injector.getInstance(Clusters.class);
  Host h4=clusters.getHost("h4");
  h4.setState(HostState.HEARTBEAT_LOST);
  h4.persist();
  List<ServiceComponentHost> schs=cluster.getServiceComponentHosts("h4");
  assertEquals(1,schs.size());
  assertEquals(HostState.HEARTBEAT_LOST,schs.get(0).getHostState());
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(7,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckUpgradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  Cluster c=makeCluster();
  Set<String> additionalServices=new HashSet<String>(){
{
      add("HBASE");
      add("PIG");
      add("TEZ");
      add("AMBARI_METRICS");
    }
  }
;
  for (  String service : additionalServices) {
    c.addService(service);
  }
  int numServiceChecksExpected=0;
  Collection<Service> services=c.getServices().values();
  for (  Service service : services) {
    ServiceInfo si=ambariMetaInfo.getService(c.getCurrentStackVersion().getStackName(),c.getCurrentStackVersion().getStackVersion(),service.getName());
    if (null == si.getCommandScript()) {
      continue;
    }
    if (service.getName().equalsIgnoreCase("TEZ")) {
      assertTrue("Expect Tez to not have any service checks",false);
    }
    if (service.getName().equalsIgnoreCase("AMBARI_METRICS")) {
      continue;
    }
    numServiceChecksExpected++;
  }
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_22,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder holder=groups.get(3);
  assertEquals(holder.name,"SERVICE_CHECK_1");
  assertEquals(7,holder.items.size());
  int numServiceChecksActual=0;
  for (  StageWrapper sw : holder.items) {
    for (    Service service : services) {
      Pattern p=Pattern.compile(".*" + service.getName(),Pattern.CASE_INSENSITIVE);
      Matcher matcher=p.matcher(sw.getText());
      if (matcher.matches()) {
        numServiceChecksActual++;
        continue;
      }
    }
  }
  assertEquals(numServiceChecksActual,numServiceChecksExpected);
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuckets() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_bucket_test"));
  UpgradePack upgrade=upgrades.get("upgrade_bucket_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.iterator().next();
  assertEquals(22,group.items.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertDefinitionEqualityTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAlertDefinitionEquality(){
  AlertDefinition ad1=getAlertDefinition(SourceType.PORT);
  AlertDefinition ad2=getAlertDefinition(SourceType.PORT);
  assertTrue(ad1.equals(ad2));
  assertTrue(ad1.deeplyEquals(ad2));
  ad2.setInterval(2);
  assertTrue(ad1.equals(ad2));
  assertFalse(ad1.deeplyEquals(ad2));
  ad2.setName(getName() + " foo");
  assertFalse(ad1.equals(ad2));
  assertFalse(ad1.deeplyEquals(ad2));
  ad2=getAlertDefinition(SourceType.AGGREGATE);
  assertFalse(ad1.deeplyEquals(ad2));
  ad2=getAlertDefinition(SourceType.PORT);
  assertTrue(ad1.deeplyEquals(ad2));
  ad2.getSource().getReporting().getOk().setText("foo");
  assertFalse(ad1.deeplyEquals(ad2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertDefinitionHashTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link AlertDefinitionHash#isHashCached(String)}.
 */
@Test public void testIsHashCached(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  m_hash.invalidate(HOSTNAME);
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  m_hash.invalidateAll();
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link AlertDefinitionHash#invalidateHosts(AlertDefinitionEntity)}.
 */
@Test public void testInvalidateHosts(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  Set<String> invalidatedHosts=m_hash.invalidateHosts(m_hdfsHost);
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertNotNull(invalidatedHosts);
  assertEquals(1,invalidatedHosts.size());
  assertTrue(invalidatedHosts.contains(HOSTNAME));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testInvalidateHost(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  m_hash.invalidate("foo",HOSTNAME);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  m_hash.invalidateAll();
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertEventPublisherTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertDefinitionNameChangeEvent() throws Exception {
  installHdfsService();
  AlertDefinitionEntity definition=definitionDao.findAll().get(0);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(definition.getServiceName());
  history.setClusterId(cluster.getClusterId());
  history.setAlertDefinition(definition);
  history.setAlertLabel(definition.getLabel());
  history.setAlertText(definition.getDefinitionName());
  history.setAlertTimestamp(Long.valueOf(1L));
  history.setHostName(null);
  history.setAlertState(AlertState.OK);
  alertsDao.create(history);
  AlertHistoryEntity history2=new AlertHistoryEntity();
  history2.setServiceName(definition.getServiceName());
  history2.setClusterId(cluster.getClusterId());
  history2.setAlertDefinition(definition);
  history2.setAlertLabel(definition.getLabel());
  history2.setAlertText(definition.getDefinitionName());
  history2.setAlertTimestamp(Long.valueOf(1L));
  history2.setHostName(null);
  history2.setAlertState(AlertState.CRITICAL);
  AlertCurrentEntity current=new AlertCurrentEntity();
  current.setOriginalTimestamp(1L);
  current.setLatestTimestamp(2L);
  current.setAlertHistory(history2);
  alertsDao.create(current);
  definition.setLabel("testAlertDefinitionNameChangeEvent");
  definitionDao.merge(definition);
  history=alertsDao.findById(history.getAlertId());
  history2=alertsDao.findById(history2.getAlertId());
  Assert.assertFalse(definition.getLabel().equals(history.getAlertLabel()));
  Assert.assertEquals(definition.getLabel(),history2.getAlertLabel());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertStateChangedEventTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link AggregateAlertRecalculateEvent}s are fired correctly.
 * @throws Exception
 */
@Test public void testAggregateAlertRecalculateEvent() throws Exception {
  Class<? extends AlertEvent> eventClass=AggregateAlertRecalculateEvent.class;
  Assert.assertFalse(m_listener.isAlertEventReceived(eventClass));
  AlertsDAO dao=injector.getInstance(AlertsDAO.class);
  dao.removeCurrentByServiceComponentHost(1,"HDFS","DATANODE","c6401");
  Assert.assertTrue(m_listener.isAlertEventReceived(eventClass));
  Assert.assertEquals(1,m_listener.getAlertEventReceivedCount(eventClass));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.AlertDataManagerTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregateAlerts() throws Exception {
  AlertDefinitionEntity definition=new AlertDefinitionEntity();
  definition.setDefinitionName("to_aggregate");
  definition.setLabel("My Label");
  definition.setLabel("My Description");
  definition.setServiceName(SERVICE);
  definition.setComponentName(null);
  definition.setClusterId(m_cluster.getClusterId());
  definition.setHash(UUID.randomUUID().toString());
  definition.setScheduleInterval(Integer.valueOf(60));
  definition.setScope(Scope.HOST);
  definition.setSource("{\"type\" : \"SCRIPT\"}");
  definition.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(definition);
  AlertDefinitionEntity aggDef=new AlertDefinitionEntity();
  aggDef.setDefinitionName("aggregate_test");
  aggDef.setServiceName(SERVICE);
  aggDef.setComponentName(null);
  aggDef.setClusterId(m_cluster.getClusterId());
  aggDef.setHash(UUID.randomUUID().toString());
  aggDef.setScheduleInterval(Integer.valueOf(60));
  aggDef.setScope(Scope.SERVICE);
  AggregateSource source=new AggregateSource();
  source.setAlertName("to_aggregate");
  Field field=Source.class.getDeclaredField("type");
  field.setAccessible(true);
  field.set(source,SourceType.AGGREGATE);
  Reporting reporting=new Reporting();
  ReportTemplate template=new ReportTemplate();
  template.setText("You are good {1}/{0}");
  reporting.setOk(template);
  template=new ReportTemplate();
  template.setText("Going bad {1}/{0}");
  template.setValue(Double.valueOf(0.33d));
  reporting.setWarning(template);
  template=new ReportTemplate();
  template.setText("On fire! {1}/{0}");
  template.setValue(Double.valueOf(0.66d));
  reporting.setCritical(template);
  source.setReporting(reporting);
  Gson gson=new Gson();
  aggDef.setSource(gson.toJson(source));
  aggDef.setSourceType(SourceType.AGGREGATE);
  m_definitionDao.create(aggDef);
  for (int i=0; i < 4; i++) {
    AlertHistoryEntity history=new AlertHistoryEntity();
    history.setAlertDefinition(definition);
    history.setAlertInstance(null);
    history.setAlertLabel(definition.getLabel());
    history.setAlertState(AlertState.OK);
    history.setAlertText("OK");
    history.setAlertTimestamp(Long.valueOf(1));
    history.setClusterId(m_cluster.getClusterId());
    history.setComponentName(definition.getComponentName());
    history.setHostName("h" + (i + 1));
    history.setServiceName(definition.getServiceName());
    m_dao.create(history);
    AlertCurrentEntity current=new AlertCurrentEntity();
    current.setAlertHistory(history);
    current.setLatestText(history.getAlertText());
    current.setLatestTimestamp(Long.valueOf(1L));
    current.setOriginalTimestamp(Long.valueOf(1L));
    m_dao.merge(current);
  }
  AlertEventPublisher publisher=m_injector.getInstance(AlertEventPublisher.class);
  EventBusSynchronizer.synchronizeAlertEventPublisher(m_injector);
  final AtomicReference<Alert> ref=new AtomicReference<Alert>();
  publisher.register(new TestListener(){
    @Override @Subscribe public void catchIt(    AlertReceivedEvent event){
      ref.set(event.getAlert());
    }
  }
);
  AlertAggregateListener listener=m_injector.getInstance(AlertAggregateListener.class);
  AlertDefinitionFactory factory=new AlertDefinitionFactory();
  AggregateDefinitionMapping aggregateMapping=m_injector.getInstance(AggregateDefinitionMapping.class);
  AlertDefinition aggregateDefinition=factory.coerce(aggDef);
  aggregateMapping.registerAggregate(m_cluster.getClusterId(),aggregateDefinition);
  Assert.assertEquals(aggregateDefinition,aggregateMapping.getAggregateDefinitions(m_cluster.getClusterId()).get(0));
  Assert.assertEquals(definition.getDefinitionName(),aggregateMapping.getAlertsWithAggregates(m_cluster.getClusterId()).get(0));
  AggregateSource as=(AggregateSource)aggregateDefinition.getSource();
  AlertDefinition aggregatedDefinition=aggregateMapping.getAggregateDefinition(m_cluster.getClusterId(),as.getAlertName());
  assertNotNull(aggregatedDefinition);
  Alert alert=new Alert(definition.getDefinitionName(),null,definition.getServiceName(),definition.getComponentName(),"h1",AlertState.OK);
  AlertCurrentEntity current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h1",definition.getDefinitionName());
  AlertStateChangeEvent event=new AlertStateChangeEvent(m_cluster.getClusterId(),alert,current,AlertState.OK);
  listener.onAlertStateChangeEvent(event);
  assertNotNull(ref.get());
  assertEquals(AlertState.OK,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("0/4") > -1);
  current.getAlertHistory().setAlertState(AlertState.CRITICAL);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.OK,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("1/4") > -1);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h2",definition.getDefinitionName());
  current.getAlertHistory().setAlertState(AlertState.WARNING);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.WARNING,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("2/4") > -1);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h3",definition.getDefinitionName());
  current.getAlertHistory().setAlertState(AlertState.CRITICAL);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.CRITICAL,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("3/4") > -1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertRecords(){
  Alert alert1=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.OK);
  alert1.setLabel(ALERT_LABEL);
  alert1.setText("Component component1 is OK");
  alert1.setTimestamp(1L);
  alert1.setCluster(m_cluster.getClusterName());
  Alert alert2=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST2,AlertState.CRITICAL);
  alert2.setLabel(ALERT_LABEL);
  alert2.setText("Component component2 is not OK");
  alert2.setCluster(m_cluster.getClusterName());
  AlertReceivedListener listener=m_injector.getInstance(AlertReceivedListener.class);
  AlertReceivedEvent event1=new AlertReceivedEvent(m_cluster.getClusterId(),alert1);
  AlertReceivedEvent event2=new AlertReceivedEvent(m_cluster.getClusterId(),alert2);
  listener.onAlertEvent(event1);
  listener.onAlertEvent(event2);
  List<AlertCurrentEntity> allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  List<AlertHistoryEntity> allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(2,allHistory.size());
  AlertCurrentEntity current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is OK",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.OK);
  assertEquals(1L,current.getOriginalTimestamp().longValue());
  assertEquals(1L,current.getLatestTimestamp().longValue());
  Long currentId=current.getAlertId();
  Long historyId=current.getAlertHistory().getAlertId();
  Alert alert3=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.OK);
  alert3.setLabel(ALERT_LABEL);
  alert3.setText("Component component1 is OK");
  alert3.setTimestamp(2L);
  alert3.setCluster(m_cluster.getClusterName());
  AlertReceivedEvent event3=new AlertReceivedEvent(m_cluster.getClusterId(),alert3);
  listener.onAlertEvent(event3);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(currentId,current.getAlertId());
  assertEquals(historyId,current.getAlertHistory().getAlertId());
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is OK",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.OK);
  assertEquals(1L,current.getOriginalTimestamp().longValue());
  assertEquals(2L,current.getLatestTimestamp().longValue());
  allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(2,allHistory.size());
  Alert alert4=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.WARNING);
  alert4.setLabel(ALERT_LABEL);
  alert4.setText("Component component1 is about to go down");
  alert4.setTimestamp(3L);
  alert4.setCluster(m_cluster.getClusterName());
  AlertReceivedEvent event4=new AlertReceivedEvent(m_cluster.getClusterId(),alert4);
  listener.onAlertEvent(event4);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(current.getAlertId(),currentId);
  assertFalse(historyId.equals(current.getAlertHistory().getAlertId()));
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is about to go down",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.WARNING);
  assertEquals(3L,current.getOriginalTimestamp().longValue());
  assertEquals(3L,current.getLatestTimestamp().longValue());
  allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(3,allHistory.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterDeadlockTest </h4><pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that while serializing a service component, writes to that service
 * component do not cause a deadlock with the global cluster lock.
 * @throws Exception
 */
@Test() public void testAddingHostComponentsWhileReading() throws Exception {
  Service service=cluster.getService("HDFS");
  ServiceComponent nameNodeComponent=service.getServiceComponent("NAMENODE");
  ServiceComponent dataNodeComponent=service.getServiceComponent("DATANODE");
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < 5; i++) {
    ServiceComponentReaderWriterThread thread=new ServiceComponentReaderWriterThread();
    thread.setDataNodeComponent(dataNodeComponent);
    thread.setNameNodeComponent(nameNodeComponent);
    thread.start();
    threads.add(thread);
  }
  DeadlockWarningThread wt=new DeadlockWarningThread(threads);
  while (true) {
    if (!wt.isAlive()) {
      break;
    }
  }
  if (wt.isDeadlocked()) {
    Assert.assertFalse(wt.getErrorMessages().toString(),wt.isDeadlocked());
  }
 else {
    Assert.assertFalse(wt.isDeadlocked());
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that concurrent impl serialization and impl writing doesn't cause a
 * deadlock.
 * @throws Exception
 */
@Test() public void testDeadlockBetweenImplementations() throws Exception {
  Service service=cluster.getService("HDFS");
  ServiceComponent nameNodeComponent=service.getServiceComponent("NAMENODE");
  ServiceComponent dataNodeComponent=service.getServiceComponent("DATANODE");
  ServiceComponentHost nameNodeSCH=createNewServiceComponentHost("HDFS","NAMENODE","c64-0");
  ServiceComponentHost dataNodeSCH=createNewServiceComponentHost("HDFS","DATANODE","c64-0");
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < NUMBER_OF_THREADS; i++) {
    DeadlockExerciserThread thread=new DeadlockExerciserThread();
    thread.setCluster(cluster);
    thread.setService(service);
    thread.setDataNodeComponent(dataNodeComponent);
    thread.setNameNodeComponent(nameNodeComponent);
    thread.setNameNodeSCH(nameNodeSCH);
    thread.setDataNodeSCH(dataNodeSCH);
    thread.start();
    threads.add(thread);
  }
  DeadlockWarningThread wt=new DeadlockWarningThread(threads);
  while (true) {
    if (!wt.isAlive()) {
      break;
    }
  }
  if (wt.isDeadlocked()) {
    Assert.assertFalse(wt.getErrorMessages().toString(),wt.isDeadlocked());
  }
 else {
    Assert.assertFalse(wt.isDeadlocked());
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that no deadlock exists while restarting components and reading from
 * the cluster.
 * @throws Exception
 */
@Test() public void testDeadlockWhileRestartingComponents() throws Exception {
  List<ServiceComponentHost> serviceComponentHosts=new ArrayList<ServiceComponentHost>();
  for (  String hostName : hostNames) {
    serviceComponentHosts.add(createNewServiceComponentHost("HDFS","NAMENODE",hostName));
    serviceComponentHosts.add(createNewServiceComponentHost("HDFS","DATANODE",hostName));
  }
  ((ClusterImpl)cluster).loadServiceHostComponents();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < NUMBER_OF_THREADS; i++) {
    ClusterReaderThread clusterReaderThread=new ClusterReaderThread();
    ClusterWriterThread clusterWriterThread=new ClusterWriterThread();
    ServiceComponentRestartThread schWriterThread=new ServiceComponentRestartThread(serviceComponentHosts);
    threads.add(clusterReaderThread);
    threads.add(clusterWriterThread);
    threads.add(schWriterThread);
    clusterReaderThread.start();
    clusterWriterThread.start();
    schWriterThread.start();
  }
  DeadlockWarningThread wt=new DeadlockWarningThread(threads);
  while (true) {
    if (!wt.isAlive()) {
      break;
    }
  }
  if (wt.isDeadlocked()) {
    Assert.assertFalse(wt.getErrorMessages().toString(),wt.isDeadlocked());
  }
 else {
    Assert.assertFalse(wt.isDeadlocked());
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDeadlockWithConfigsUpdate() throws Exception {
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < NUMBER_OF_THREADS; i++) {
    ClusterDesiredConfigsReaderThread readerThread=null;
    for (int j=0; j < NUMBER_OF_THREADS; j++) {
      readerThread=new ClusterDesiredConfigsReaderThread();
      threads.add(readerThread);
    }
    for (    Config config : cluster.getAllConfigs()) {
      ConfigUpdaterThread configUpdaterThread=new ConfigUpdaterThread(config);
      threads.add(configUpdaterThread);
    }
  }
  for (  Thread thread : threads) {
    thread.start();
  }
  DeadlockWarningThread wt=new DeadlockWarningThread(threads);
  while (true) {
    if (!wt.isAlive()) {
      break;
    }
  }
  if (wt.isDeadlocked()) {
    Assert.assertFalse(wt.getErrorMessages().toString(),wt.isDeadlocked());
  }
 else {
    Assert.assertFalse(wt.isDeadlocked());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterImplTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteService() throws Exception {
  String serviceToDelete="TEZ";
  String clusterName="TEST_CLUSTER";
  String hostName1="HOST1", hostName2="HOST2";
  clusters.addCluster(clusterName,new StackId("HDP-2.1.1"));
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.addHost(hostName1);
  clusters.addHost(hostName2);
  Host host1=clusters.getHost(hostName1);
  host1.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host1.persist();
  Host host2=clusters.getHost(hostName2);
  host2.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host2.persist();
  clusters.mapHostsToCluster(Sets.newHashSet(hostName1,hostName2),clusterName);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  ServiceComponent nameNode=hdfs.addServiceComponent("NAMENODE");
  nameNode.persist();
  nameNode.addServiceComponentHost(hostName1).persist();
  ServiceComponent dataNode=hdfs.addServiceComponent("DATANODE");
  dataNode.persist();
  dataNode.addServiceComponentHost(hostName1).persist();
  dataNode.addServiceComponentHost(hostName2).persist();
  ServiceComponent hdfsClient=hdfs.addServiceComponent("HDFS_CLIENT");
  hdfsClient.persist();
  hdfsClient.addServiceComponentHost(hostName1).persist();
  hdfsClient.addServiceComponentHost(hostName2).persist();
  Service tez=cluster.addService(serviceToDelete);
  tez.persist();
  ServiceComponent tezClient=tez.addServiceComponent("TEZ_CLIENT");
  tezClient.persist();
  ServiceComponentHost tezClientHost1=tezClient.addServiceComponentHost(hostName1);
  tezClientHost1.persist();
  ServiceComponentHost tezClientHost2=tezClient.addServiceComponentHost(hostName2);
  tezClientHost2.persist();
  cluster.deleteService(serviceToDelete);
  assertFalse("Deleted service should be removed from the service collection !",cluster.getServices().containsKey(serviceToDelete));
  assertEquals("All components of the deleted service should be removed from all hosts",0,cluster.getServiceComponentHosts(serviceToDelete,null).size());
  boolean checkHost1=!cluster.getServiceComponentHosts(hostName1).contains(tezClientHost1);
  boolean checkHost2=!cluster.getServiceComponentHosts(hostName2).contains(tezClientHost2);
  assertTrue("All components of the deleted service should be removed from all hosts",checkHost1 && checkHost2);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteHost() throws Exception {
  String clusterName="TEST_DELETE_HOST";
  String hostName1="HOSTNAME1", hostName2="HOSTNAME2";
  String hostToDelete=hostName2;
  clusters.addCluster(clusterName,new StackId("HDP-2.1.1"));
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.addHost(hostName1);
  clusters.addHost(hostName2);
  Host host1=clusters.getHost(hostName1);
  host1.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host1.persist();
  Host host2=clusters.getHost(hostName2);
  host2.setHostAttributes(ImmutableMap.of("os_family","centos","os_release_version","6.0"));
  host2.persist();
  clusters.mapHostsToCluster(Sets.newHashSet(hostName1,hostName2),clusterName);
  clusters.deleteHost(hostToDelete);
  assertTrue(clusters.getClustersForHost(hostToDelete).isEmpty());
  assertFalse(clusters.getHostsForCluster(clusterName).containsKey(hostToDelete));
  assertFalse(cluster.getHosts().contains(hostToDelete));
  try {
    clusters.getHost(hostToDelete);
    fail("getHost(hostName) should throw Exception when invoked for deleted host !");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransitionNonReportableHost() throws Exception {
  StackId stackId=new StackId("HDP-2.0.5");
  String clusterName="c1";
  clusters.addCluster(clusterName,stackId);
  Cluster c1=clusters.getCluster(clusterName);
  Assert.assertEquals(clusterName,c1.getClusterName());
  Assert.assertEquals(1,c1.getClusterId());
  clusters.addHost("h-1");
  clusters.addHost("h-2");
  clusters.addHost("h-3");
  for (  String hostName : new String[]{"h-1","h-2","h-3"}) {
    Host h=clusters.getHost(hostName);
    h.setIPv4("ipv4");
    h.setIPv6("ipv6");
    Map<String,String> hostAttributes=new HashMap<String,String>();
    hostAttributes.put("os_family","redhat");
    hostAttributes.put("os_release_version","5.9");
    h.setHostAttributes(hostAttributes);
    h.persist();
  }
  String v1="2.0.5-1";
  String v2="2.0.5-2";
  c1.setDesiredStackVersion(stackId);
  RepositoryVersionEntity rve1=helper.getOrCreateRepositoryVersion(stackId,v1);
  RepositoryVersionEntity rve2=helper.getOrCreateRepositoryVersion(stackId,v2);
  c1.setCurrentStackVersion(stackId);
  c1.createClusterVersion(stackId,v1,"admin",RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId,v1,RepositoryVersionState.CURRENT);
  clusters.mapHostToCluster("h-1",clusterName);
  clusters.mapHostToCluster("h-2",clusterName);
  clusters.mapHostToCluster("h-3",clusterName);
  ClusterVersionDAOMock.failOnCurrentVersionState=false;
  Service service=c1.addService("ZOOKEEPER");
  ServiceComponent sc=service.addServiceComponent("ZOOKEEPER_SERVER");
  sc.addServiceComponentHost("h-1");
  sc.addServiceComponentHost("h-2");
  service=c1.addService("SQOOP");
  sc=service.addServiceComponent("SQOOP");
  sc.addServiceComponentHost("h-3");
  List<HostVersionEntity> entities=hostVersionDAO.findByClusterAndHost(clusterName,"h-3");
  assertTrue("Expected no host versions",null == entities || 0 == entities.size());
  c1.createClusterVersion(stackId,v2,"admin",RepositoryVersionState.INSTALLING);
  c1.transitionClusterVersion(stackId,v2,RepositoryVersionState.INSTALLED);
  c1.transitionClusterVersion(stackId,v2,RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId,v2,RepositoryVersionState.UPGRADED);
  c1.transitionClusterVersion(stackId,v2,RepositoryVersionState.CURRENT);
  entities=hostVersionDAO.findByClusterAndHost(clusterName,"h-3");
  assertEquals(1,entities.size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDesiredConfigs() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  Config config3=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addConfig(config3);
  try {
    c1.addDesiredConfig(null,Collections.singleton(config1));
    fail("Cannot set a null user with config");
  }
 catch (  Exception e) {
  }
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  c1.addDesiredConfig("_test3",Collections.singleton(config3));
  Map<String,DesiredConfig> desiredConfigs=c1.getDesiredConfigs();
  Assert.assertFalse("Expect desired config not contain 'mapred-site'",desiredConfigs.containsKey("mapred-site"));
  Assert.assertTrue("Expect desired config contain " + config1.getType(),desiredConfigs.containsKey("global"));
  Assert.assertTrue("Expect desired config contain " + config3.getType(),desiredConfigs.containsKey("core-site"));
  Assert.assertEquals("Expect desired config for global should be " + config1.getTag(),config1.getTag(),desiredConfigs.get(config1.getType()).getTag());
  Assert.assertEquals("_test1",desiredConfigs.get(config1.getType()).getUser());
  Assert.assertEquals("_test3",desiredConfigs.get(config3.getType()).getUser());
  DesiredConfig dc=desiredConfigs.get(config1.getType());
  Assert.assertTrue("Expect no host-level overrides",(null == dc.getHostOverrides() || dc.getHostOverrides().size() == 0));
  c1.addDesiredConfig("_test2",Collections.singleton(config2));
  Assert.assertEquals("_test2",c1.getDesiredConfigs().get(config2.getType()).getUser());
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  Host host=clusters.getHost("h1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test2",config2);
  desiredConfigs=c1.getDesiredConfigs();
  dc=desiredConfigs.get(config1.getType());
  Assert.assertNotNull("Expect host-level overrides",dc.getHostOverrides());
  Assert.assertEquals("Expect one host-level override",1,dc.getHostOverrides().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that an existing configuration can be successfully updated without
 * creating a new version.
 * @throws Exception
 */
@Test public void testClusterConfigMergingWithoutNewVersion() throws Exception {
  createDefaultCluster();
  Cluster cluster=clusters.getCluster("c1");
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  assertEquals(0,clusterEntity.getClusterConfigEntities().size());
  final Config originalConfig=configFactory.createNew(cluster,"foo-site",new HashMap<String,String>(){
{
      put("one","two");
    }
  }
,new HashMap<String,Map<String,String>>());
  originalConfig.setTag("version3");
  originalConfig.persist();
  cluster.addConfig(originalConfig);
  ConfigGroup configGroup=configGroupFactory.createNew(cluster,"g1","t1","",new HashMap<String,Config>(){
{
      put("foo-site",originalConfig);
    }
  }
,Collections.<Long,Host>emptyMap());
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  clusterEntity=clusterDAO.findByName("c1");
  assertEquals(1,clusterEntity.getClusterConfigEntities().size());
  Map<String,Config> configsByType=cluster.getConfigsByType("foo-site");
  Config config=configsByType.entrySet().iterator().next().getValue();
  Map<String,String> properties=config.getProperties();
  properties.put("three","four");
  config.setProperties(properties);
  config.persist(false);
  clusterEntity=clusterDAO.findByName("c1");
  assertEquals(1,clusterEntity.getClusterConfigEntities().size());
  ClusterConfigEntity clusterConfigEntity=clusterEntity.getClusterConfigEntities().iterator().next();
  assertTrue(clusterConfigEntity.getData().contains("one"));
  assertTrue(clusterConfigEntity.getData().contains("two"));
  assertTrue(clusterConfigEntity.getData().contains("three"));
  assertTrue(clusterConfigEntity.getData().contains("four"));
  cluster.refresh();
  clusterEntity=clusterDAO.findByName("c1");
  assertEquals(1,clusterEntity.getClusterConfigEntities().size());
  clusterConfigEntity=clusterEntity.getClusterConfigEntities().iterator().next();
  assertTrue(clusterConfigEntity.getData().contains("one"));
  assertTrue(clusterConfigEntity.getData().contains("two"));
  assertTrue(clusterConfigEntity.getData().contains("three"));
  assertTrue(clusterConfigEntity.getData().contains("four"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostsDesiredConfigs() throws Exception {
  createDefaultCluster();
  Host host1=clusters.getHost("h1");
  HostEntity hostEntity1=hostDAO.findByName("h1");
  Map<String,Map<String,String>> propAttributes=new HashMap<String,Map<String,String>>();
  propAttributes.put("final",new HashMap<String,String>());
  propAttributes.get("final").put("test","true");
  Config config=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("test","test");
    }
  }
,propAttributes);
  config.setTag("1");
  host1.addDesiredConfig(c1.getClusterId(),true,"test",config);
  Map<Long,Map<String,DesiredConfig>> configs=c1.getAllHostsDesiredConfigs();
  assertTrue(configs.containsKey(hostEntity1.getHostId()));
  assertEquals(1,configs.get(hostEntity1.getHostId()).size());
  List<Long> hostIds=new ArrayList<Long>();
  hostIds.add(hostEntity1.getHostId());
  configs=c1.getHostsDesiredConfigs(hostIds);
  assertTrue(configs.containsKey(hostEntity1.getHostId()));
  assertEquals(1,configs.get(hostEntity1.getHostId()).size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests removing configurations and configuration mappings by stack.
 * @throws Exception
 */
@Test public void testRemoveConfigurations() throws Exception {
  createDefaultCluster();
  Cluster cluster=clusters.getCluster("c1");
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  StackId stackId=cluster.getCurrentStackVersion();
  StackId newStackId=new StackId("HDP-2.0.6");
  StackEntity currentStack=stackDAO.find(stackId.getStackName(),stackId.getStackVersion());
  StackEntity newStack=stackDAO.find(newStackId.getStackName(),newStackId.getStackVersion());
  Assert.assertFalse(stackId.equals(newStackId));
  String configType="foo-type";
  ClusterConfigEntity clusterConfig=new ClusterConfigEntity();
  clusterConfig.setClusterEntity(clusterEntity);
  clusterConfig.setConfigId(1L);
  clusterConfig.setStack(currentStack);
  clusterConfig.setTag("version-1");
  clusterConfig.setData("{}");
  clusterConfig.setType(configType);
  clusterConfig.setTimestamp(1L);
  clusterConfig.setVersion(1L);
  clusterDAO.createConfig(clusterConfig);
  clusterEntity.getClusterConfigEntities().add(clusterConfig);
  clusterEntity=clusterDAO.merge(clusterEntity);
  ClusterConfigEntity newClusterConfig=new ClusterConfigEntity();
  newClusterConfig.setClusterEntity(clusterEntity);
  newClusterConfig.setConfigId(2L);
  newClusterConfig.setStack(newStack);
  newClusterConfig.setTag("version-2");
  newClusterConfig.setData("{}");
  newClusterConfig.setType(configType);
  newClusterConfig.setTimestamp(2L);
  newClusterConfig.setVersion(2L);
  clusterDAO.createConfig(newClusterConfig);
  clusterEntity.getClusterConfigEntities().add(newClusterConfig);
  clusterEntity=clusterDAO.merge(clusterEntity);
  ClusterConfigMappingEntity configMapping=new ClusterConfigMappingEntity();
  configMapping.setClusterEntity(clusterEntity);
  configMapping.setCreateTimestamp(1L);
  configMapping.setSelected(1);
  configMapping.setTag("version-1");
  configMapping.setType(configType);
  configMapping.setUser("admin");
  ClusterConfigMappingEntity newConfigMapping=new ClusterConfigMappingEntity();
  newConfigMapping.setClusterEntity(clusterEntity);
  newConfigMapping.setCreateTimestamp(2L);
  newConfigMapping.setSelected(0);
  newConfigMapping.setTag("version-2");
  newConfigMapping.setType(configType);
  newConfigMapping.setUser("admin");
  clusterDAO.persistConfigMapping(configMapping);
  clusterDAO.persistConfigMapping(newConfigMapping);
  clusterEntity.getConfigMappingEntities().add(configMapping);
  clusterEntity.getConfigMappingEntities().add(newConfigMapping);
  clusterEntity=clusterDAO.merge(clusterEntity);
  List<ClusterConfigEntity> clusterConfigs=clusterDAO.getAllConfigurations(cluster.getClusterId(),newStackId);
  Assert.assertEquals(1,clusterConfigs.size());
  cluster.removeConfigurations(newStackId);
  clusterConfigs=clusterDAO.getAllConfigurations(cluster.getClusterId(),newStackId);
  Assert.assertEquals(0,clusterConfigs.size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that hosts can be correctly transitioned into the "INSTALLING" state.
 * This method also tests that hosts in MM will not be transitioned, as per
 * the contract of{@link Cluster#transitionHostsToInstalling(ClusterVersionEntity)}.
 * @throws Exception
 */
@Test public void testTransitionHostVersions() throws Exception {
  createDefaultCluster();
  StackId stackId=new StackId("HDP","0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,"0.2","admin",RepositoryVersionState.INSTALLING);
  ClusterVersionEntity entityHDP2=null;
  for (  ClusterVersionEntity entity : c1.getAllClusterVersions()) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    StackId repoVersionStackId=new StackId(repoVersionStackEntity);
    if (repoVersionStackId.getStackName().equals("HDP") && repoVersionStackId.getStackVersion().equals("0.2")) {
      entityHDP2=entity;
      break;
    }
  }
  assertNotNull(entityHDP2);
  List<HostVersionEntity> hostVersionsH1Before=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(1,hostVersionsH1Before.size());
  c1.transitionHostsToInstalling(entityHDP2);
  List<HostVersionEntity> hostVersionsH1After=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(2,hostVersionsH1After.size());
  boolean checked=false;
  for (  HostVersionEntity entity : hostVersionsH1After) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,entity.getState());
      checked=true;
      break;
    }
  }
  assertTrue(checked);
  c1.transitionHostsToInstalling(entityHDP2);
  hostVersionsH1After=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(2,hostVersionsH1After.size());
  checked=false;
  for (  HostVersionEntity entity : hostVersionsH1After) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,entity.getState());
      checked=true;
      break;
    }
  }
  assertTrue(checked);
  List<HostVersionEntity> hostVersionEntities=hostVersionDAO.findAll();
  for (  HostVersionEntity hostVersionEntity : hostVersionEntities) {
    hostVersionEntity.setState(RepositoryVersionState.INSTALL_FAILED);
    hostVersionDAO.merge(hostVersionEntity);
  }
  hostVersionEntities=hostVersionDAO.findAll();
  for (  HostVersionEntity hostVersionEntity : hostVersionEntities) {
    assertEquals(RepositoryVersionState.INSTALL_FAILED,hostVersionEntity.getState());
  }
  Collection<Host> hosts=c1.getHosts();
  Iterator<Host> iterator=hosts.iterator();
  Host hostInMaintenanceMode=iterator.next();
  Host hostNotInMaintenanceMode=iterator.next();
  hostInMaintenanceMode.setMaintenanceState(c1.getClusterId(),MaintenanceState.ON);
  c1.transitionHostsToInstalling(entityHDP2);
  List<HostVersionEntity> hostInMaintModeVersions=hostVersionDAO.findByClusterAndHost("c1",hostInMaintenanceMode.getHostName());
  List<HostVersionEntity> otherHostVersions=hostVersionDAO.findByClusterAndHost("c1",hostNotInMaintenanceMode.getHostName());
  for (  HostVersionEntity hostVersionEntity : hostInMaintModeVersions) {
    StackEntity repoVersionStackEntity=hostVersionEntity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.OUT_OF_SYNC,hostVersionEntity.getState());
    }
  }
  for (  HostVersionEntity hostVersionEntity : otherHostVersions) {
    StackEntity repoVersionStackEntity=hostVersionEntity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,hostVersionEntity.getState());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link Cluster#applyLatestConfigurations(StackId)} sets the
 * right configs to enabled.
 * @throws Exception
 */
@Test public void testApplyLatestConfigurations() throws Exception {
  createDefaultCluster();
  Cluster cluster=clusters.getCluster("c1");
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  StackId stackId=cluster.getCurrentStackVersion();
  StackId newStackId=new StackId("HDP-2.0.6");
  StackEntity currentStack=stackDAO.find(stackId.getStackName(),stackId.getStackVersion());
  StackEntity newStack=stackDAO.find(newStackId.getStackName(),newStackId.getStackVersion());
  Assert.assertFalse(stackId.equals(newStackId));
  String configType="foo-type";
  ClusterConfigEntity clusterConfig=new ClusterConfigEntity();
  clusterConfig.setClusterEntity(clusterEntity);
  clusterConfig.setConfigId(1L);
  clusterConfig.setStack(currentStack);
  clusterConfig.setTag("version-1");
  clusterConfig.setData("{}");
  clusterConfig.setType(configType);
  clusterConfig.setTimestamp(1L);
  clusterConfig.setVersion(1L);
  clusterDAO.createConfig(clusterConfig);
  clusterEntity.getClusterConfigEntities().add(clusterConfig);
  clusterEntity=clusterDAO.merge(clusterEntity);
  ClusterConfigEntity newClusterConfig=new ClusterConfigEntity();
  newClusterConfig.setClusterEntity(clusterEntity);
  newClusterConfig.setConfigId(2L);
  newClusterConfig.setStack(newStack);
  newClusterConfig.setTag("version-2");
  newClusterConfig.setData("{}");
  newClusterConfig.setType(configType);
  newClusterConfig.setTimestamp(2L);
  newClusterConfig.setVersion(2L);
  clusterDAO.createConfig(newClusterConfig);
  clusterEntity.getClusterConfigEntities().add(newClusterConfig);
  clusterEntity=clusterDAO.merge(clusterEntity);
  ClusterConfigMappingEntity configMapping=new ClusterConfigMappingEntity();
  configMapping.setClusterEntity(clusterEntity);
  configMapping.setCreateTimestamp(1L);
  configMapping.setSelected(1);
  configMapping.setTag("version-1");
  configMapping.setType(configType);
  configMapping.setUser("admin");
  ClusterConfigMappingEntity newConfigMapping=new ClusterConfigMappingEntity();
  newConfigMapping.setClusterEntity(clusterEntity);
  newConfigMapping.setCreateTimestamp(2L);
  newConfigMapping.setSelected(0);
  newConfigMapping.setTag("version-2");
  newConfigMapping.setType(configType);
  newConfigMapping.setUser("admin");
  clusterDAO.persistConfigMapping(configMapping);
  clusterDAO.persistConfigMapping(newConfigMapping);
  clusterEntity.getConfigMappingEntities().add(configMapping);
  clusterEntity.getConfigMappingEntities().add(newConfigMapping);
  clusterEntity=clusterDAO.merge(clusterEntity);
  Collection<ClusterConfigMappingEntity> clusterConfigMappings=clusterEntity.getConfigMappingEntities();
  Assert.assertEquals(2,clusterConfigMappings.size());
  for (  ClusterConfigMappingEntity clusterConfigMapping : clusterConfigMappings) {
    if (clusterConfigMapping.getTag().equals("version-1")) {
      Assert.assertEquals(1,clusterConfigMapping.isSelected());
    }
 else {
      Assert.assertEquals(0,clusterConfigMapping.isSelected());
    }
  }
  cluster.applyLatestConfigurations(newStackId);
  clusterEntity=clusterDAO.findByName("c1");
  clusterConfigMappings=clusterEntity.getConfigMappingEntities();
  Assert.assertEquals(2,clusterConfigMappings.size());
  for (  ClusterConfigMappingEntity clusterConfigMapping : clusterConfigMappings) {
    if (clusterConfigMapping.getTag().equals("version-1")) {
      Assert.assertEquals(0,clusterConfigMapping.isSelected());
    }
 else {
      Assert.assertEquals(1,clusterConfigMapping.isSelected());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBootstrapHostVersion() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  Host deadHost=cluster.getHosts().iterator().next();
  deadHost.setState(HostState.UNHEALTHY);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (hce.getHostName().equals(deadHost.getHostName())) {
      continue;
    }
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentHosts() throws Exception {
  createDefaultCluster();
  Service s=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s);
  s.persist();
  ServiceComponent sc=serviceComponentFactory.createNew(s,"NAMENODE");
  s.addServiceComponent(sc);
  sc.persist();
  ServiceComponentHost sch=serviceComponentHostFactory.createNew(sc,"h1");
  sc.addServiceComponentHost(sch);
  sch.persist();
  List<ServiceComponentHost> scHosts=c1.getServiceComponentHosts("h1");
  Assert.assertEquals(1,scHosts.size());
  Iterator<ServiceComponentHost> iterator=scHosts.iterator();
  try {
    while (iterator.hasNext()) {
      iterator.next();
      Service s1=serviceFactory.createNew(c1,"PIG");
      c1.addService(s1);
      s1.persist();
      ServiceComponent sc1=serviceComponentFactory.createNew(s1,"PIG");
      s1.addServiceComponent(sc1);
      sc1.persist();
      ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc1,"h1");
      sc1.addServiceComponentHost(sch1);
      sch1.persist();
    }
  }
 catch (  ConcurrentModificationException e) {
    Assert.assertTrue("Failed to work concurrently with sch",false);
  }
  scHosts=c1.getServiceComponentHosts("h1");
  Assert.assertEquals(2,scHosts.size());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Comprehensive test for transitionHostVersion and recalculateClusterVersion.
 * It creates a cluster with 3 hosts and 3 services, one of which does not advertise a version.
 * It then verifies that all 3 hosts have a version of CURRENT, and so does the cluster.
 * It then adds one more host with a component, so its HostVersion will initialize in CURRENT.
 * Next, it distributes a repo so that it is INSTALLED on the 4 hosts.
 * It then adds one more host, whose HostVersion will be OUT_OF_SYNC for the new repo.
 * After redistributing bits again, it simulates an RU.
 * Finally, some of the hosts will end up with a HostVersion in UPGRADED, and others still in INSTALLED.
 * @throws Exception
 */
@Test public void testTransitionHostVersionAdvanced() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.UPGRADING);
      }
      if (i == hostComponentStates.size() - 1) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
  addHost("h-4",hostAttributes);
  clusters.mapHostToCluster("h-4",clusterName);
  Service svc2=cluster.getService("ZOOKEEPER");
  Service svc3=cluster.getService("GANGLIA");
  ServiceComponent sc2CompA=svc2.getServiceComponent("ZOOKEEPER_SERVER");
  ServiceComponent sc2CompB=svc2.getServiceComponent("ZOOKEEPER_CLIENT");
  ServiceComponent sc3CompB=svc3.getServiceComponent("GANGLIA_MONITOR");
  ServiceComponentHost schHost4Serv2CompA=serviceComponentHostFactory.createNew(sc2CompA,"h-4");
  ServiceComponentHost schHost4Serv2CompB=serviceComponentHostFactory.createNew(sc2CompB,"h-4");
  ServiceComponentHost schHost4Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-4");
  sc2CompA.addServiceComponentHost(schHost4Serv2CompA);
  sc2CompB.addServiceComponentHost(schHost4Serv2CompB);
  sc3CompB.addServiceComponentHost(schHost4Serv3CompB);
  schHost4Serv2CompA.persist();
  schHost4Serv2CompB.persist();
  schHost4Serv3CompB.persist();
  simulateStackVersionListener(stackId,v1,cluster,hostComponentStateDAO.findByHost("h-4"));
  Collection<HostVersionEntity> hostVersions=hostVersionDAO.findAll();
  Assert.assertEquals(hostVersions.size(),clusters.getHosts().size());
  HostVersionEntity h4Version1=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v1,"h-4");
  Assert.assertNotNull(h4Version1);
  Assert.assertEquals(h4Version1.getState(),RepositoryVersionState.CURRENT);
  String v2="2.2.0-456";
  RepositoryVersionEntity rv2=helper.getOrCreateRepositoryVersion(stackId,v2);
  for (  String hostName : clusters.getHostsForCluster(clusterName).keySet()) {
    HostEntity host=hostDAO.findByName(hostName);
    HostVersionEntity hve=new HostVersionEntity(host,rv2,RepositoryVersionState.INSTALLED);
    hostVersionDAO.create(hve);
  }
  cluster.createClusterVersion(stackId,v2,"admin",RepositoryVersionState.INSTALLING);
  cluster.transitionClusterVersion(stackId,v2,RepositoryVersionState.INSTALLED);
  ClusterVersionEntity cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertNotNull(cv2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.INSTALLED);
  addHost("h-5",hostAttributes);
  clusters.mapHostToCluster("h-5",clusterName);
  ServiceComponentHost schHost5Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-5");
  sc3CompB.addServiceComponentHost(schHost5Serv3CompB);
  schHost5Serv3CompB.persist();
  HostVersionEntity h5Version2=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v2,"h-5");
  Assert.assertNotNull(h5Version2);
  Assert.assertEquals(h5Version2.getState(),RepositoryVersionState.OUT_OF_SYNC);
  h5Version2.setState(RepositoryVersionState.INSTALLED);
  hostVersionDAO.merge(h5Version2);
  versionedComponentCount=0;
  hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v2);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv2);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v2);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 2);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
        Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
      }
    }
  }
  cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
  Collection<HostVersionEntity> v2HostVersions=hostVersionDAO.findByClusterStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(v2HostVersions.size(),clusters.getHostsForCluster(clusterName).size());
  for (  HostVersionEntity hve : v2HostVersions) {
    if (hve.getHostName().equals("h-3") || hve.getHostName().equals("h-5")) {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.INSTALLED);
    }
 else {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.UPGRADED);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServices() throws Exception {
  createDefaultCluster();
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  Service s3=serviceFactory.createNew(c1,"MAPREDUCE");
  try {
    c1.addService(s3);
    fail("Expected error on adding dup service");
  }
 catch (  Exception e) {
  }
  Service s=c1.getService("HDFS");
  Assert.assertNotNull(s);
  Assert.assertEquals("HDFS",s.getName());
  Assert.assertEquals(c1.getClusterId(),s.getClusterId());
  try {
    c1.getService("HBASE");
    fail("Expected error for unknown service");
  }
 catch (  Exception e) {
  }
  Map<String,Service> services=c1.getServices();
  Assert.assertEquals(2,services.size());
  Assert.assertTrue(services.containsKey("HDFS"));
  Assert.assertTrue(services.containsKey("MAPREDUCE"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClustersTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterHostMapping() throws AmbariException {
  String c1="c1";
  String c2="c2";
  String h1="h1";
  String h2="h2";
  String h3="h3";
  String h4="h4";
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid cluster/host");
  }
 catch (  Exception e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(c1,stackId);
  clusters.addCluster(c2,stackId);
  Cluster cluster1=clusters.getCluster(c1);
  Cluster cluster2=clusters.getCluster(c2);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  cluster1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster1.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  cluster2.setDesiredStackVersion(stackId);
  cluster2.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster2.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid host");
  }
 catch (  Exception e) {
  }
  clusters.addHost(h1);
  clusters.addHost(h2);
  clusters.addHost(h3);
  Assert.assertNotNull(clusters.getHost(h1));
  setOsFamily(clusters.getHost(h1),"redhat","6.4");
  setOsFamily(clusters.getHost(h2),"redhat","5.9");
  setOsFamily(clusters.getHost(h3),"redhat","6.4");
  clusters.getHost(h1).persist();
  clusters.getHost(h2).persist();
  clusters.getHost(h3).persist();
  try {
    clusters.getClustersForHost(h4);
    fail("Expected exception for invalid host");
  }
 catch (  HostNotFoundException e) {
  }
  Set<Cluster> c=clusters.getClustersForHost(h3);
  Assert.assertEquals(0,c.size());
  clusters.mapHostToCluster(h1,c1);
  clusters.mapHostToCluster(h2,c1);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for duplicate");
  }
 catch (  DuplicateResourceException e) {
  }
  Cluster c3=(Cluster)clusters.getClustersForHost(h1).toArray()[0];
  Cluster c4=(Cluster)clusters.getClustersForHost(h2).toArray()[0];
  Assert.assertEquals(c3,c4);
  Set<String> hostnames=new HashSet<String>();
  hostnames.add(h1);
  hostnames.add(h2);
  clusters.mapHostsToCluster(hostnames,c2);
  c=clusters.getClustersForHost(h1);
  Assert.assertEquals(2,c.size());
  c=clusters.getClustersForHost(h2);
  Assert.assertEquals(2,c.size());
  Map<String,Host> hostsForC1=clusters.getHostsForCluster(c1);
  Assert.assertEquals(2,hostsForC1.size());
  Assert.assertTrue(hostsForC1.containsKey(h1));
  Assert.assertTrue(hostsForC1.containsKey(h2));
  Assert.assertNotNull(hostsForC1.get(h1));
  Assert.assertNotNull(hostsForC1.get(h2));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetCluster() throws AmbariException {
  StackId stackId=new StackId("HDP-2.1.1");
  String c1="foo";
  String c2="foo";
  clusters.addCluster(c1,stackId);
  try {
    clusters.addCluster(c1,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.addCluster(c2,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  c2="foo2";
  clusters.addCluster(c2,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  Assert.assertEquals(c1,clusters.getCluster(c1).getClusterName());
  Assert.assertEquals(c2,clusters.getCluster(c2).getClusterName());
  Map<String,Cluster> verifyClusters=clusters.getClusters();
  Assert.assertTrue(verifyClusters.containsKey(c1));
  Assert.assertTrue(verifyClusters.containsKey(c2));
  Assert.assertNotNull(verifyClusters.get(c1));
  Assert.assertNotNull(verifyClusters.get(c2));
  Cluster c=clusters.getCluster(c1);
  c.setClusterName("foobar");
  long cId=c.getClusterId();
  Cluster changed=clusters.getCluster("foobar");
  Assert.assertNotNull(changed);
  Assert.assertEquals(cId,changed.getClusterId());
  Assert.assertEquals("foobar",clusters.getClusterById(cId).getClusterName());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetCurrentStackVersion() throws AmbariException {
  String c1="foo3";
  try {
    clusters.setCurrentStackVersion("",null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.setCurrentStackVersion(c1,null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  try {
    clusters.setCurrentStackVersion(c1,stackId);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Cluster not found"));
  }
  clusters.addCluster(c1,stackId);
  clusters.setCurrentStackVersion(c1,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  ClusterStateEntity entity=injector.getInstance(ClusterStateDAO.class).findByPK(clusters.getCluster(c1).getClusterId());
  Assert.assertNotNull(entity);
  Assert.assertTrue(entity.getCurrentStack().getStackName().equals(stackId.getStackName()) && entity.getCurrentStack().getStackVersion().equals(stackId.getStackVersion()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackName().equals(stackId.getStackName()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackVersion().equals(stackId.getStackVersion()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ServiceComponentHostConcurrentWriteDeadlockTest </h4><pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 */
@Test() public void testConcurrentWriteDeadlock() throws Exception {
  ServiceComponentHost nameNodeSCH=createNewServiceComponentHost("HDFS","NAMENODE","c6401");
  ServiceComponentHost dataNodeSCH=createNewServiceComponentHost("HDFS","DATANODE","c6401");
  List<ServiceComponentHost> serviceComponentHosts=new ArrayList<ServiceComponentHost>();
  serviceComponentHosts.add(nameNodeSCH);
  serviceComponentHosts.add(dataNodeSCH);
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < NUMBER_OF_THREADS; i++) {
    ServiceComponentHostDeadlockWriter thread=new ServiceComponentHostDeadlockWriter();
    thread.setServiceComponentHosts(serviceComponentHosts);
    thread.start();
    threads.add(thread);
  }
  DeadlockWarningThread wt=new DeadlockWarningThread(threads);
  while (true) {
    if (!wt.isAlive()) {
      break;
    }
  }
  if (wt.isDeadlocked()) {
    Assert.assertFalse(wt.getErrorMessages().toString(),wt.isDeadlocked());
  }
 else {
    Assert.assertFalse(wt.isDeadlocked());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.host.HostTest </h4><pre class="type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostDesiredConfig() throws Exception {
  AmbariMetaInfo metaInfo=injector.getInstance(AmbariMetaInfo.class);
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster("c1",stackId);
  Cluster c1=clusters.getCluster("c1");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Assert.assertEquals("c1",c1.getClusterName());
  Assert.assertEquals(1,c1.getClusterId());
  clusters.addHost("h1");
  Host host=clusters.getHost("h1");
  host.setIPv4("ipv4");
  host.setIPv6("ipv6");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  c1.setDesiredStackVersion(stackId);
  clusters.mapHostToCluster("h1","c1");
  ConfigFactory configFactory=injector.getInstance(ConfigFactory.class);
  Config config=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  try {
    host.addDesiredConfig(c1.getClusterId(),true,null,config);
    Assert.fail("Expect failure when user is not specified.");
  }
 catch (  Exception e) {
  }
  config.setTag("v1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test",config);
  Map<String,DesiredConfig> map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertTrue("Expect desired config to contain global",map.containsKey("global"));
  Assert.assertEquals("Expect global user to be '_test'","_test",map.get("global").getUser());
  config=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("c","d");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("v2");
  host.addDesiredConfig(c1.getClusterId(),true,"_test1",config);
  map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertTrue("Expect desired config to contain global",map.containsKey("global"));
  Assert.assertEquals("Expect version to be 'v2'","v2",map.get("global").getTag());
  Assert.assertEquals("Expect user to be '_test1'","_test1",map.get("global").getUser());
  host.addDesiredConfig(c1.getClusterId(),false,"_test2",config);
  map=host.getDesiredConfigs(c1.getClusterId());
  Assert.assertEquals("Expect no mapping configs",0,map.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosComponentDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosConfigurationDescriptorTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJSONDeserializeMultiple(){
  List<Map<String,Object>> jsonData=new Gson().fromJson(JSON_MULTIPLE_VALUE,new TypeToken<List<Map<String,Object>>>(){
  }
.getType());
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Object> item : jsonData) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Assert.assertEquals(2,configurations.size());
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
      Assert.assertEquals("value3",properties.get("property3"));
      Assert.assertEquals("value1",configuration.getProperty("property1"));
      Assert.assertEquals("value2",configuration.getProperty("property2"));
      Assert.assertEquals("value3",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJSONDeserialize(){
  Map<String,Map<String,Object>> jsonData=new Gson().fromJson(JSON_SINGLE_VALUE,new TypeToken<Map<String,Map<String,Object>>>(){
  }
.getType());
  KerberosConfigurationDescriptor configuration=new KerberosConfigurationDescriptor(jsonData);
  Assert.assertNotNull(configuration);
  Assert.assertFalse(configuration.isContainer());
  Map<String,String> properties=configuration.getProperties();
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("${property-value1}",properties.get("property1"));
  Assert.assertEquals("${property.value2}",properties.get("property2"));
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDeserializeMultiple(){
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Map<String,Object>> item : MAP_MULTIPLE_VALUES) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("black",properties.get("property1"));
      Assert.assertEquals("white",properties.get("property2"));
      Assert.assertEquals("black",configuration.getProperty("property1"));
      Assert.assertEquals("white",configuration.getProperty("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("red",properties.get("property1"));
      Assert.assertEquals("yellow",properties.get("property2"));
      Assert.assertEquals("green",properties.get("property3"));
      Assert.assertEquals("red",configuration.getProperty("property1"));
      Assert.assertEquals("yellow",configuration.getProperty("property2"));
      Assert.assertEquals("green",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDeserialize(){
  KerberosConfigurationDescriptor configuration=new KerberosConfigurationDescriptor(MAP_SINGLE_VALUE);
  Map<String,String> properties=configuration.getProperties();
  Assert.assertNotNull(configuration);
  Assert.assertFalse(configuration.isContainer());
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("black",properties.get("property1"));
  Assert.assertEquals("white",properties.get("property2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosIdentityDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosKeytabDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosPrincipalDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosServiceDescriptorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws AmbariException {
  Assert.assertTrue(createFromJSON().equals(createFromJSON()));
  Assert.assertFalse(createFromJSON().equals(createFromMap()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.services.AlertNoticeDispatchServiceTest </h4><pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests a digest dispatch for email.
 * @throws Exception
 */
@Test public void testDigestDispatch() throws Exception {
  MockEmailDispatcher dispatcher=new MockEmailDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dispatchFactory.getDispatcher("EMAIL")).andReturn(dispatcher).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNotNull(notification);
  assertTrue(notification.Subject.contains("OK[1]"));
  assertTrue(notification.Subject.contains("Critical[0]"));
  assertTrue(notification.Body.contains(ALERT_UNIQUE_TEXT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.ConfigUpgradePackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigUpgradeDefinitionParsing() throws Exception {
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  Map<String,ConfigUpgradeChangeDefinition> changesByID=cup.enumerateConfigChangesByID();
  ConfigUpgradeChangeDefinition hdp_2_1_1_nm_pre_upgrade=changesByID.get("hdp_2_1_1_nm_pre_upgrade");
  assertEquals("core-site",hdp_2_1_1_nm_pre_upgrade.getConfigType());
  assertEquals(4,hdp_2_1_1_nm_pre_upgrade.getTransfers().size());
  ConfigUpgradeChangeDefinition.Transfer t1=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(0);
  assertEquals(TransferOperation.COPY,t1.operation);
  assertEquals("copy-key",t1.fromKey);
  assertEquals("copy-key-to",t1.toKey);
  ConfigUpgradeChangeDefinition.Transfer t2=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(1);
  assertEquals(TransferOperation.COPY,t2.operation);
  assertEquals("my-site",t2.fromType);
  assertEquals("my-copy-key",t2.fromKey);
  assertEquals("my-copy-key-to",t2.toKey);
  assertTrue(t2.keepKeys.isEmpty());
  ConfigUpgradeChangeDefinition.Transfer t3=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(2);
  assertEquals(TransferOperation.MOVE,t3.operation);
  assertEquals("move-key",t3.fromKey);
  assertEquals("move-key-to",t3.toKey);
  ConfigUpgradeChangeDefinition.Transfer t4=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(3);
  assertEquals(TransferOperation.DELETE,t4.operation);
  assertEquals("delete-key",t4.deleteKey);
  assertNull(t4.toKey);
  assertTrue(t4.preserveEdits);
  assertEquals(1,t4.keepKeys.size());
  assertEquals("important-key",t4.keepKeys.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.UpgradePackTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExistence() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSkippableFailures() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  Set<String> keys=upgrades.keySet();
  for (  String key : keys) {
    Assert.assertFalse(upgrades.get(key).isComponentFailureAutoSkipped());
    Assert.assertFalse(upgrades.get(key).isServiceCheckFailureAutoSkipped());
  }
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  UpgradePack upgradePack=upgrades.get("upgrade_test_skip_failures");
  Assert.assertTrue(upgradePack.isComponentFailureAutoSkipped());
  Assert.assertTrue(upgradePack.isServiceCheckFailureAutoSkipped());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupOrdersForNonRolling(){
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","Stop High-Level Daemons","Backups","Stop Low-Level Daemons","UPDATE_DESIRED_STACK_ID","ALL_HOST_OPS","ZOOKEEPER","HDFS","MR and YARN","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("Restore Backups","UPDATE_DESIRED_STACK_ID","ALL_HOST_OPS","ZOOKEEPER","HDFS","MR and YARN","POST_CLUSTER");
  Iterator<String> itr_up=expected_up.iterator();
  List<Grouping> upgrade_groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : upgrade_groups) {
    assertEquals(true,itr_up.hasNext());
    assertEquals(itr_up.next(),g.name);
  }
  Iterator<String> itr_down=expected_down.iterator();
  List<Grouping> downgrade_groups=upgrade.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : downgrade_groups) {
    assertEquals(true,itr_down.hasNext());
    assertEquals(itr_down.next(),g.name);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForNonRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  assertTrue(upgrade.getType() == UpgradeType.NON_ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(10,groups.size());
  Grouping group=null;
  ClusterGrouping clusterGroup=null;
  UpdateStackGrouping updateStackGroup=null;
  StopGrouping stopGroup=null;
  RestartGrouping restartGroup=null;
  group=groups.get(0);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Prepare Upgrade",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(1);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for High-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Take Backups",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(3);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for Low-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(4);
  assertEquals(UpdateStackGrouping.class,group.getClass());
  updateStackGroup=(UpdateStackGrouping)group;
  assertEquals("Update Desired Stack Id",updateStackGroup.title);
  assertNull(updateStackGroup.parallelScheduler);
  group=groups.get(5);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Set Version On All Hosts",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(6);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("Zookeeper",restartGroup.title);
  assertNull(restartGroup.parallelScheduler);
  group=groups.get(7);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("HDFS",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(2,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(8);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("MR and YARN",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(9);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Finalize {{direction.text.proper}}",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupOrdersForRolling(){
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  PrerequisiteCheckConfig prerequisiteCheckConfig=upgrade.getPrerequisiteCheckConfig();
  assertNotNull(prerequisiteCheckConfig);
  assertNotNull(prerequisiteCheckConfig.globalProperties);
  assertTrue(prerequisiteCheckConfig.getGlobalProperties().containsKey("global-property-1"));
  assertEquals("global-value-1",prerequisiteCheckConfig.getGlobalProperties().get("global-property-1"));
  assertNotNull(prerequisiteCheckConfig.prerequisiteCheckProperties);
  assertEquals(2,prerequisiteCheckConfig.prerequisiteCheckProperties.size());
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").get("dfs-protocols-regex"));
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").get("dfs-protocols-regex"));
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","ZOOKEEPER","CORE_MASTER","SERVICE_CHECK_1","CORE_SLAVES","SERVICE_CHECK_2","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("PRE_CLUSTER","CORE_SLAVES","SERVICE_CHECK_2","CORE_MASTER","SERVICE_CHECK_1","ZOOKEEPER","POST_CLUSTER");
  Grouping serviceCheckGroup=null;
  int i=0;
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_up.get(i),g.name);
    i++;
    if (g.name.equals("SERVICE_CHECK_1")) {
      serviceCheckGroup=g;
    }
  }
  List<String> expected_priority=Arrays.asList("HDFS","HBASE","YARN");
  assertNotNull(serviceCheckGroup);
  assertEquals(ServiceCheckGrouping.class,serviceCheckGroup.getClass());
  ServiceCheckGrouping scg=(ServiceCheckGrouping)serviceCheckGroup;
  Set<String> priorities=scg.getPriorities();
  assertEquals(3,priorities.size());
  i=0;
  for (  String s : priorities) {
    assertEquals(expected_priority.get(i++),s);
  }
  i=0;
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_down.get(i),g.name);
    i++;
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(4,groups.size());
  Grouping group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  ClusterGrouping cluster_group=(ClusterGrouping)group;
  assertEquals("Run on All",group.title);
  cluster_group=(ClusterGrouping)groups.get(3);
  List<ExecuteStage> stages=cluster_group.executionStages;
  assertEquals(3,stages.size());
  assertNotNull(stages.get(0).intendedDirection);
  assertEquals(Direction.DOWNGRADE,stages.get(0).intendedDirection);
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  assertEquals(3,groups.size());
  group=groups.get(1);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Run on All",group.title);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Finalize Upgrade",group.title);
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that the XML for not auto skipping skippable failures works.
 * @throws Exception
 */
@Test public void testNoAutoSkipFailure() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  UpgradePack upgradePack=upgrades.get("upgrade_test_skip_failures");
  List<Grouping> groups=upgradePack.getGroups(Direction.UPGRADE);
  for (  Grouping grouping : groups) {
    if (grouping.name.equals("SKIPPABLE_BUT_NOT_AUTO_SKIPPABLE")) {
      Assert.assertFalse(grouping.supportsAutoSkipOnFailure);
    }
 else {
      Assert.assertTrue(grouping.supportsAutoSkipOnFailure);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeParsing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertEquals("2.2.*.*",upgrade.getTarget());
  Map<String,List<String>> expectedStages=new LinkedHashMap<String,List<String>>(){
{
      put("ZOOKEEPER",Arrays.asList("ZOOKEEPER_SERVER"));
      put("HDFS",Arrays.asList("NAMENODE","DATANODE"));
    }
  }
;
  int i=0;
  for (  Entry<String,List<String>> entry : expectedStages.entrySet()) {
    assertTrue(upgrade.getTasks().containsKey(entry.getKey()));
    assertEquals(i++,indexOf(upgrade.getTasks(),entry.getKey()));
    assertEquals(entry.getValue().size(),upgrade.getTasks().get(entry.getKey()).size());
    int j=0;
    for (    String comp : entry.getValue()) {
      assertEquals(j++,indexOf(upgrade.getTasks().get(entry.getKey()),comp));
    }
  }
  assertTrue(upgrade.getTasks().containsKey("HDFS"));
  assertTrue(upgrade.getTasks().get("HDFS").containsKey("NAMENODE"));
  ProcessingComponent pc=upgrade.getTasks().get("HDFS").get("NAMENODE");
  assertNotNull(pc.preTasks);
  assertNotNull(pc.postTasks);
  assertNotNull(pc.tasks);
  assertNull(pc.preDowngradeTasks);
  assertNull(pc.postDowngradeTasks);
  assertEquals(1,pc.tasks.size());
  assertEquals(Task.Type.RESTART,pc.tasks.get(0).getType());
  assertEquals(RestartTask.class,pc.tasks.get(0).getClass());
  assertTrue(upgrade.getTasks().containsKey("ZOOKEEPER"));
  assertTrue(upgrade.getTasks().get("ZOOKEEPER").containsKey("ZOOKEEPER_SERVER"));
  pc=upgrade.getTasks().get("HDFS").get("DATANODE");
  assertNotNull(pc.preDowngradeTasks);
  assertEquals(0,pc.preDowngradeTasks.size());
  assertNotNull(pc.postDowngradeTasks);
  assertEquals(1,pc.postDowngradeTasks.size());
  pc=upgrade.getTasks().get("ZOOKEEPER").get("ZOOKEEPER_SERVER");
  assertNotNull(pc.preTasks);
  assertEquals(1,pc.preTasks.size());
  assertNotNull(pc.postTasks);
  assertEquals(1,pc.postTasks.size());
  assertNotNull(pc.tasks);
  assertEquals(1,pc.tasks.size());
  pc=upgrade.getTasks().get("YARN").get("NODEMANAGER");
  assertNotNull(pc.preTasks);
  assertEquals(2,pc.preTasks.size());
  Task t=pc.preTasks.get(1);
  assertEquals(ConfigureTask.class,t.getClass());
  ConfigureTask ct=(ConfigureTask)t;
  assertEquals("hdp_2_1_1_nm_pre_upgrade",ct.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.upgrade.StageWrapperBuilderTest </h4><pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the various build methods of a builder are invoked in the
 * correct order.
 * @throws Exception
 */
@Test public void testBuildOrder() throws Exception {
  UpgradeContext upgradeContext=new UpgradeContext(null,null,null,null,Direction.UPGRADE,UpgradeType.ROLLING);
  MockStageWrapperBuilder builder=new MockStageWrapperBuilder(null);
  List<StageWrapper> stageWrappers=builder.build(upgradeContext);
  List<Integer> invocationOrder=builder.getInvocationOrder();
  Assert.assertEquals(Integer.valueOf(0),invocationOrder.get(0));
  Assert.assertEquals(Integer.valueOf(1),invocationOrder.get(1));
  Assert.assertEquals(Integer.valueOf(2),invocationOrder.get(2));
  Assert.assertTrue(stageWrappers.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.svccomphost.ServiceComponentHostTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testClientStateFlow() throws Exception {
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)createNewServiceComponentHost(clusterName,"HDFS","HDFS_CLIENT",hostName1,true);
  runStateChanges(impl,ServiceComponentHostEventType.HOST_SVCCOMP_INSTALL,State.INIT,State.INSTALLING,State.INSTALL_FAILED,State.INSTALLED);
  boolean exceptionThrown=false;
  try {
    runStateChanges(impl,ServiceComponentHostEventType.HOST_SVCCOMP_START,State.INSTALLED,State.STARTING,State.INSTALLED,State.STARTED);
  }
 catch (  Exception e) {
    exceptionThrown=true;
  }
  Assert.assertTrue("Exception not thrown on invalid event",exceptionThrown);
  runStateChanges(impl,ServiceComponentHostEventType.HOST_SVCCOMP_UNINSTALL,State.INSTALLED,State.UNINSTALLING,State.UNINSTALLING,State.UNINSTALLED);
  runStateChanges(impl,ServiceComponentHostEventType.HOST_SVCCOMP_WIPEOUT,State.UNINSTALLED,State.WIPING_OUT,State.WIPING_OUT,State.INIT);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  sch.setDesiredState(State.INSTALLED);
  sch.setState(State.INSTALLING);
  sch.setStackVersion(new StackId("HDP-1.2.0"));
  ServiceComponentHostResponse r=sch.convertToResponse();
  Assert.assertEquals("HDFS",r.getServiceName());
  Assert.assertEquals("DATANODE",r.getComponentName());
  Assert.assertEquals(hostName1,r.getHostname());
  Assert.assertEquals(clusterName,r.getClusterName());
  Assert.assertEquals(State.INSTALLED.toString(),r.getDesiredState());
  Assert.assertEquals(State.INSTALLING.toString(),r.getLiveState());
  Assert.assertEquals("HDP-1.2.0",r.getStackVersion());
  Assert.assertFalse(r.isStaleConfig());
  StringBuilder sb=new StringBuilder();
  sch.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisableInVariousStates() throws AmbariException, InvalidStateTransitionException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)sch;
  long timestamp=0;
  HashSet<State> validStates=new HashSet<State>();
  validStates.add(State.INSTALLED);
  validStates.add(State.INSTALL_FAILED);
  validStates.add(State.UNKNOWN);
  validStates.add(State.DISABLED);
  for (  State state : validStates) {
    sch.setState(state);
    ServiceComponentHostEvent disableEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_DISABLE);
    impl.handleEvent(disableEvent);
    Assert.assertEquals(-1,impl.getLastOpStartTime());
    Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
    Assert.assertEquals(-1,impl.getLastOpEndTime());
    Assert.assertEquals(State.DISABLED,impl.getState());
  }
  HashSet<State> invalidStates=new HashSet<State>();
  invalidStates.add(State.INIT);
  invalidStates.add(State.INSTALLING);
  invalidStates.add(State.STARTING);
  invalidStates.add(State.STARTED);
  invalidStates.add(State.STOPPING);
  invalidStates.add(State.UNINSTALLING);
  invalidStates.add(State.UNINSTALLED);
  invalidStates.add(State.UPGRADING);
  for (  State state : invalidStates) {
    sch.setState(state);
    ServiceComponentHostEvent disableEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_DISABLE);
    boolean exceptionThrown=false;
    try {
      impl.handleEvent(disableEvent);
    }
 catch (    Exception e) {
      exceptionThrown=true;
    }
    Assert.assertTrue("Exception not thrown on invalid event",exceptionThrown);
    Assert.assertEquals(-1,impl.getLastOpStartTime());
    Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
    Assert.assertEquals(-1,impl.getLastOpEndTime());
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCanBeRemoved() throws Exception {
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)createNewServiceComponentHost(clusterName,"HDFS","HDFS_CLIENT",hostName1,true);
  for (  State state : State.values()) {
    impl.setState(state);
    if (state.isRemovableState()) {
      Assert.assertTrue(impl.canBeRemoved());
    }
 else {
      Assert.assertFalse(impl.canBeRemoved());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testStaleConfigsAttributes() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setStackVersion(new StackId(stackVersion));
  sch2.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLING);
  sch2.setStackVersion(new StackId(stackVersion));
  sch3.setDesiredState(State.INSTALLED);
  sch3.setState(State.INSTALLING);
  sch3.setStackVersion(new StackId(stackVersion));
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo1");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  makeConfig(cluster,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("hdfs-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch3.updateActualConfigs(actual);
  makeConfig(cluster,"mapred-site","version1",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("mapred-site",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch3.setRestartRequired(false);
  sch3.updateActualConfigs(actual);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  Map<String,Map<String,String>> c1PropAttributes=new HashMap<String,Map<String,String>>();
  c1PropAttributes.put("final",new HashMap<String,String>());
  c1PropAttributes.get("final").put("hdfs1","true");
  makeConfig(cluster,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,c1PropAttributes);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  Map<String,Map<String,String>> c2PropAttributes=new HashMap<String,Map<String,String>>();
  c2PropAttributes.put("final",new HashMap<String,String>());
  c2PropAttributes.get("final").put("hdfs1","false");
  makeConfig(cluster,"hdfs-site","version3",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,c2PropAttributes);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version4",new HashMap<String,String>(){
{
      put("hdfs1","hdfs1value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  sch3.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStopInVariousStates() throws AmbariException, InvalidStateTransitionException {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","DATANODE",hostName1,false);
  ServiceComponentHostImpl impl=(ServiceComponentHostImpl)sch;
  sch.setDesiredState(State.STARTED);
  sch.setState(State.INSTALLED);
  long timestamp=0;
  ServiceComponentHostEvent stopEvent=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_STOP);
  long startTime=timestamp;
  impl.handleEvent(stopEvent);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  Assert.assertEquals(State.STOPPING,impl.getState());
  sch.setState(State.INSTALL_FAILED);
  boolean exceptionThrown=false;
  try {
    impl.handleEvent(stopEvent);
  }
 catch (  Exception e) {
    exceptionThrown=true;
  }
  Assert.assertTrue("Exception not thrown on invalid event",exceptionThrown);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  sch.setState(State.INSTALLED);
  ServiceComponentHostEvent stopEvent2=createEvent(impl,++timestamp,ServiceComponentHostEventType.HOST_SVCCOMP_STOP);
  startTime=timestamp;
  impl.handleEvent(stopEvent2);
  Assert.assertEquals(startTime,impl.getLastOpStartTime());
  Assert.assertEquals(-1,impl.getLastOpLastUpdateTime());
  Assert.assertEquals(-1,impl.getLastOpEndTime());
  Assert.assertEquals(State.STOPPING,impl.getState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActualConfigs() throws Exception {
  ServiceComponentHost sch=createNewServiceComponentHost(clusterName,"HDFS","NAMENODE",hostName1,false);
  sch.setDesiredState(State.INSTALLED);
  sch.setState(State.INSTALLING);
  sch.setStackVersion(new StackId("HDP-1.2.0"));
  sch.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  Cluster cluster=clusters.getCluster(clusterName);
  final ConfigGroup configGroup=configGroupFactory.createNew(cluster,"cg1","t1","",new HashMap<String,Config>(),new HashMap<Long,Host>());
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
      put("core-site",new HashMap<String,String>(){
{
          put("tag","version1");
          put(configGroup.getId().toString(),"version2");
        }
      }
);
    }
  }
;
  sch.updateActualConfigs(actual);
  Map<String,HostConfig> confirm=sch.getActualConfigs();
  Assert.assertEquals(2,confirm.size());
  Assert.assertTrue(confirm.containsKey("global"));
  Assert.assertTrue(confirm.containsKey("core-site"));
  Assert.assertEquals(1,confirm.get("core-site").getConfigGroupOverrides().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityState() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostEntity hostEntity=hostDAO.findByName(hostName);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  HostComponentDesiredStateDAO daoHostComponentDesiredState=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity entityHostComponentDesiredState;
  HostComponentDesiredStateEntityPK pkHostComponentDesiredState=new HostComponentDesiredStateEntityPK();
  pkHostComponentDesiredState.setClusterId(cluster.getClusterId());
  pkHostComponentDesiredState.setComponentName(sch1.getServiceComponentName());
  pkHostComponentDesiredState.setServiceName(sch1.getServiceName());
  pkHostComponentDesiredState.setHostId(hostEntity.getHostId());
  HostComponentStateDAO daoHostComponentState=injector.getInstance(HostComponentStateDAO.class);
  HostComponentStateEntity entityHostComponentState;
  for (  SecurityState state : SecurityState.values()) {
    sch1.setSecurityState(state);
    entityHostComponentState=daoHostComponentState.findByIndex(cluster.getClusterId(),sch1.getServiceName(),sch1.getServiceComponentName(),hostEntity.getHostId());
    Assert.assertNotNull(entityHostComponentState);
    Assert.assertEquals(state,entityHostComponentState.getSecurityState());
    try {
      sch1.setDesiredSecurityState(state);
      Assert.assertTrue(state.isEndpoint());
      entityHostComponentDesiredState=daoHostComponentDesiredState.findByPK(pkHostComponentDesiredState);
      Assert.assertNotNull(entityHostComponentDesiredState);
      Assert.assertEquals(state,entityHostComponentDesiredState.getSecurityState());
    }
 catch (    AmbariException e) {
      Assert.assertFalse(state.isEndpoint());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaleConfigs() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  final HostEntity hostEntity=hostDAO.findByName(hostName);
  Assert.assertNotNull(hostEntity.getHostId());
  Cluster cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setStackVersion(new StackId(stackVersion));
  sch2.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLING);
  sch2.setStackVersion(new StackId(stackVersion));
  sch3.setDesiredState(State.INSTALLED);
  sch3.setState(State.INSTALLING);
  sch3.setStackVersion(new StackId(stackVersion));
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo1");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch3.updateActualConfigs(actual);
  makeConfig(cluster,"foo","version1",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.put("hdfs-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://foo");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put("tag","version2");
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  final Host host=clusters.getHostsForCluster(clusterName).get(hostName);
  Assert.assertNotNull(host);
  final Config c=configFactory.createNew(cluster,"hdfs-site",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://goo");
    }
  }
,new HashMap<String,Map<String,String>>());
  c.setTag("version3");
  c.persist();
  cluster.addConfig(c);
  host.addDesiredConfig(cluster.getClusterId(),true,"user",c);
  ConfigGroup configGroup=configGroupFactory.createNew(cluster,"g1","t1","",new HashMap<String,Config>(){
{
      put("hdfs-site",c);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put(configGroup.getId().toString(),"version3");
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version2",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo3");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  makeConfig(cluster,"core-site","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("fs.trash.interval","360");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  actual.put("core-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  final Config c1=configFactory.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("fs.trash.interval","400");
    }
  }
,new HashMap<String,Map<String,String>>());
  c1.setTag("version2");
  c1.persist();
  cluster.addConfig(c1);
  configGroup=configGroupFactory.createNew(cluster,"g2","t2","",new HashMap<String,Config>(){
{
      put("core-site",c1);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  Long id=configGroup.getId();
  HashMap<String,String> tags=new HashMap<String,String>(2);
  tags.put("tag","version1");
  tags.put(id.toString(),"version2");
  actual.put("core-site",tags);
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  cluster.deleteConfigGroup(id);
  Assert.assertNull(cluster.getConfigGroups().get(id));
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  tags.remove(id.toString());
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.testing.DBInconsistencyTests </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrphanedSCHDesiredEntityReAdd() throws Exception {
  Long clusterId=helper.createCluster();
  Assert.assertNotNull(clusterId);
  Cluster cluster=clusters.getCluster(OrmTestHelper.CLUSTER_NAME);
  Assert.assertNotNull(cluster);
  helper.addHost(clusters,cluster,"h1");
  helper.installHdfsService(cluster,serviceFactory,serviceComponentFactory,serviceComponentHostFactory,"h1");
  Collection<ServiceComponentHost> schList=clusters.getCluster(OrmTestHelper.CLUSTER_NAME).getServiceComponentHosts("HDFS","DATANODE");
  Assert.assertNotNull(schList);
  Collection<ServiceComponent> scList=cluster.getService("HDFS").getServiceComponents().values();
  Assert.assertNotNull(schList);
  cluster.deleteService("HDFS");
  List<HostComponentDesiredStateEntity> hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  Assert.assertTrue(hostComponentDesiredStateEntities == null || hostComponentDesiredStateEntities.isEmpty());
  List<ServiceComponentDesiredStateEntity> serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  Assert.assertTrue(serviceComponentDesiredStateEntities == null || serviceComponentDesiredStateEntities.isEmpty());
  EntityManager em=helper.getEntityManager();
  final EntityTransaction txn=em.getTransaction();
  txn.begin();
  for (  ServiceComponentHost sch : schList) {
    sch.setDesiredState(State.DISABLED);
  }
  for (  ServiceComponent sc : scList) {
    sc.setDesiredState(State.DISABLED);
  }
  txn.commit();
  hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  Assert.assertTrue(hostComponentDesiredStateEntities == null || hostComponentDesiredStateEntities.isEmpty());
  serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  Assert.assertTrue(serviceComponentDesiredStateEntities == null || serviceComponentDesiredStateEntities.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.AmbariContextTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTopologyResolved_True() throws Exception {
  DesiredConfig testHdfsDesiredConfig1=new DesiredConfig();
  testHdfsDesiredConfig1.setTag(TopologyManager.INITIAL_CONFIG_TAG);
  testHdfsDesiredConfig1.setVersion(1L);
  DesiredConfig testHdfsDesiredConfig2=new DesiredConfig();
  testHdfsDesiredConfig2.setTag(TopologyManager.TOPOLOGY_RESOLVED_TAG);
  testHdfsDesiredConfig2.setVersion(2L);
  DesiredConfig testHdfsDesiredConfig3=new DesiredConfig();
  testHdfsDesiredConfig3.setTag("ver123");
  testHdfsDesiredConfig3.setVersion(3L);
  DesiredConfig testCoreSiteDesiredConfig=new DesiredConfig();
  testCoreSiteDesiredConfig.setTag("ver123");
  testCoreSiteDesiredConfig.setVersion(1L);
  Map<String,Set<DesiredConfig>> testDesiredConfigs=ImmutableMap.<String,Set<DesiredConfig>>builder().put("hdfs-site",ImmutableSet.of(testHdfsDesiredConfig2,testHdfsDesiredConfig3,testHdfsDesiredConfig1)).put("core-site",ImmutableSet.of(testCoreSiteDesiredConfig)).build();
  expect(cluster.getAllDesiredConfigVersions()).andReturn(testDesiredConfigs).atLeastOnce();
  replayAll();
  boolean topologyResolved=context.isTopologyResolved(CLUSTER_ID);
  assertTrue(topologyResolved);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAmbariResources() throws Exception {
  Capture<ClusterRequest> clusterRequestCapture=new Capture<ClusterRequest>();
  controller.createCluster(capture(clusterRequestCapture));
  expectLastCall().once();
  expect(cluster.getServices()).andReturn(clusterServices).anyTimes();
  Capture<Set<ServiceRequest>> serviceRequestCapture=new Capture<Set<ServiceRequest>>();
  Capture<Set<ServiceComponentRequest>> serviceComponentRequestCapture=new Capture<Set<ServiceComponentRequest>>();
  serviceResourceProvider.createServices(capture(serviceRequestCapture));
  expectLastCall().once();
  componentResourceProvider.createComponents(capture(serviceComponentRequestCapture));
  expectLastCall().once();
  Capture<Request> serviceInstallRequestCapture=new Capture<Request>();
  Capture<Request> serviceStartRequestCapture=new Capture<Request>();
  Capture<Predicate> installPredicateCapture=new Capture<Predicate>();
  Capture<Predicate> startPredicateCapture=new Capture<Predicate>();
  expect(serviceResourceProvider.updateResources(capture(serviceInstallRequestCapture),capture(installPredicateCapture))).andReturn(null).once();
  expect(serviceResourceProvider.updateResources(capture(serviceStartRequestCapture),capture(startPredicateCapture))).andReturn(null).once();
  replayAll();
  context.createAmbariResources(topology,CLUSTER_NAME,null);
  ClusterRequest clusterRequest=clusterRequestCapture.getValue();
  assertEquals(CLUSTER_NAME,clusterRequest.getClusterName());
  assertEquals(String.format("%s-%s",STACK_NAME,STACK_VERSION),clusterRequest.getStackVersion());
  Collection<ServiceRequest> serviceRequests=serviceRequestCapture.getValue();
  assertEquals(2,serviceRequests.size());
  Collection<String> servicesFound=new HashSet<String>();
  for (  ServiceRequest serviceRequest : serviceRequests) {
    servicesFound.add(serviceRequest.getServiceName());
    assertEquals(CLUSTER_NAME,serviceRequest.getClusterName());
  }
  assertTrue(servicesFound.size() == 2 && servicesFound.containsAll(Arrays.asList("service1","service2")));
  Collection<ServiceComponentRequest> serviceComponentRequests=serviceComponentRequestCapture.getValue();
  assertEquals(3,serviceComponentRequests.size());
  Map<String,Collection<String>> foundServiceComponents=new HashMap<String,Collection<String>>();
  for (  ServiceComponentRequest componentRequest : serviceComponentRequests) {
    assertEquals(CLUSTER_NAME,componentRequest.getClusterName());
    String serviceName=componentRequest.getServiceName();
    Collection<String> serviceComponents=foundServiceComponents.get(serviceName);
    if (serviceComponents == null) {
      serviceComponents=new HashSet<String>();
      foundServiceComponents.put(serviceName,serviceComponents);
    }
    serviceComponents.add(componentRequest.getComponentName());
  }
  assertEquals(2,foundServiceComponents.size());
  Collection<String> service1Components=foundServiceComponents.get("service1");
  assertEquals(2,service1Components.size());
  assertTrue(service1Components.containsAll(Arrays.asList("s1Component1","s1Component2")));
  Collection<String> service2Components=foundServiceComponents.get("service2");
  assertEquals(1,service2Components.size());
  assertTrue(service2Components.contains("s2Component1"));
  Request installRequest=serviceInstallRequestCapture.getValue();
  Set<Map<String,Object>> installPropertiesSet=installRequest.getProperties();
  assertEquals(1,installPropertiesSet.size());
  Map<String,Object> installProperties=installPropertiesSet.iterator().next();
  assertEquals(CLUSTER_NAME,installProperties.get(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
  assertEquals("INSTALLED",installProperties.get(ServiceResourceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  assertEquals(new EqualsPredicate<String>(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME),installPredicateCapture.getValue());
  Request startRequest=serviceStartRequestCapture.getValue();
  Set<Map<String,Object>> startPropertiesSet=startRequest.getProperties();
  assertEquals(1,startPropertiesSet.size());
  Map<String,Object> startProperties=startPropertiesSet.iterator().next();
  assertEquals(CLUSTER_NAME,startProperties.get(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID));
  assertEquals("STARTED",startProperties.get(ServiceResourceProvider.SERVICE_SERVICE_STATE_PROPERTY_ID));
  assertEquals(new EqualsPredicate<String>(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME),installPredicateCapture.getValue());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTopologyResolved_WrongOrder_False() throws Exception {
  DesiredConfig testHdfsDesiredConfig1=new DesiredConfig();
  testHdfsDesiredConfig1.setTag(TopologyManager.INITIAL_CONFIG_TAG);
  testHdfsDesiredConfig1.setVersion(2L);
  DesiredConfig testHdfsDesiredConfig2=new DesiredConfig();
  testHdfsDesiredConfig2.setTag(TopologyManager.TOPOLOGY_RESOLVED_TAG);
  testHdfsDesiredConfig2.setVersion(1L);
  DesiredConfig testHdfsDesiredConfig3=new DesiredConfig();
  testHdfsDesiredConfig3.setTag("ver123");
  testHdfsDesiredConfig3.setVersion(3L);
  DesiredConfig testCoreSiteDesiredConfig=new DesiredConfig();
  testCoreSiteDesiredConfig.setTag("ver123");
  testCoreSiteDesiredConfig.setVersion(1L);
  Map<String,Set<DesiredConfig>> testDesiredConfigs=ImmutableMap.<String,Set<DesiredConfig>>builder().put("hdfs-site",ImmutableSet.of(testHdfsDesiredConfig2,testHdfsDesiredConfig3,testHdfsDesiredConfig1)).put("core-site",ImmutableSet.of(testCoreSiteDesiredConfig)).build();
  expect(cluster.getAllDesiredConfigVersions()).andReturn(testDesiredConfigs).atLeastOnce();
  replayAll();
  boolean topologyResolved=context.isTopologyResolved(CLUSTER_ID);
  assertFalse(topologyResolved);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTopologyResolved_False() throws Exception {
  DesiredConfig testHdfsDesiredConfig1=new DesiredConfig();
  testHdfsDesiredConfig1.setTag("ver1222");
  testHdfsDesiredConfig1.setVersion(1L);
  DesiredConfig testCoreSiteDesiredConfig=new DesiredConfig();
  testCoreSiteDesiredConfig.setTag("ver123");
  testCoreSiteDesiredConfig.setVersion(1L);
  Map<String,Set<DesiredConfig>> testDesiredConfigs=ImmutableMap.<String,Set<DesiredConfig>>builder().put("hdfs-site",ImmutableSet.of(testHdfsDesiredConfig1)).put("core-site",ImmutableSet.of(testCoreSiteDesiredConfig)).build();
  expect(cluster.getAllDesiredConfigVersions()).andReturn(testDesiredConfigs).atLeastOnce();
  replayAll();
  boolean topologyResolved=context.isTopologyResolved(CLUSTER_ID);
  assertFalse(topologyResolved);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.AsyncCallableServiceTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldRetryTaskExecutionTillTimeoutExceededWhenTaskThrowsException() throws Exception {
  expect(taskMock.call()).andThrow(new IllegalStateException("****************** TESTING ****************")).times(2,3);
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldCancelTaskWhenTaskHangsAndTimeoutExceeded() throws Exception {
  Callable<Boolean> hangingTask=new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      Thread.sleep(10000000);
      return false;
    }
  }
;
  asyncCallableService=new AsyncCallableService(hangingTask,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldExitWhenTaskCompleted() throws Exception {
  expect(taskMock.call()).andReturn(Boolean.TRUE).times(1);
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertTrue(serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAsyncCallableServiceRetryExecutionWhenTaskThrowsException() throws Exception {
  Callable<Boolean> hangingTask=new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      throw new IllegalStateException("****************** TESTING ****************");
    }
  }
;
  asyncCallableService=new AsyncCallableService(hangingTask,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldCancelTaskWhenTimeoutExceeded() throws Exception {
  expect(taskMock.call()).andThrow(new IllegalStateException("Prerequisites are not yet satisfied!")).anyTimes();
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(1));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.BlueprintFactoryTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateBlueprint() throws Exception {
  Map<String,Object> props=BlueprintResourceProviderTest.getBlueprintTestProperties().iterator().next();
  replay(stack,dao,entity,configEntity);
  Blueprint blueprint=testFactory.createBlueprint(props,null);
  assertEquals(BLUEPRINT_NAME,blueprint.getName());
  assertSame(stack,blueprint.getStack());
  assertEquals(2,blueprint.getHostGroups().size());
  Map<String,HostGroup> hostGroups=blueprint.getHostGroups();
  HostGroup group1=hostGroups.get("group1");
  assertEquals("group1",group1.getName());
  assertEquals("1",group1.getCardinality());
  Collection<String> components=group1.getComponentNames();
  assertEquals(2,components.size());
  assertTrue(components.contains("component1"));
  assertTrue(components.contains("component2"));
  Collection<String> services=group1.getServices();
  assertEquals(2,services.size());
  assertTrue(services.contains("test-service1"));
  assertTrue(services.contains("test-service2"));
  assertTrue(group1.containsMasterComponent());
  Configuration configuration=group1.getConfiguration();
  assertTrue(configuration.getProperties().isEmpty());
  assertTrue(configuration.getAttributes().isEmpty());
  HostGroup group2=hostGroups.get("group2");
  assertEquals("group2",group2.getName());
  assertEquals("2",group2.getCardinality());
  components=group2.getComponentNames();
  assertEquals(1,components.size());
  assertTrue(components.contains("component1"));
  services=group2.getServices();
  assertEquals(1,services.size());
  assertTrue(services.contains("test-service1"));
  assertTrue(group2.containsMasterComponent());
  configuration=group2.getConfiguration();
  assertTrue(configuration.getProperties().isEmpty());
  assertTrue(configuration.getAttributes().isEmpty());
  verify(dao,entity,configEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.BlueprintImplTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidateConfigurations__basic_positive() throws Exception {
  Stack stack=createNiceMock(Stack.class);
  HostGroup group1=createMock(HostGroup.class);
  HostGroup group2=createMock(HostGroup.class);
  Collection<HostGroup> hostGroups=new HashSet<HostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Collection<String> group1Components=new HashSet<String>();
  group1Components.add("c1");
  group1Components.add("c2");
  Set<String> group2Components=new HashSet<String>();
  group2Components.add("c1");
  group2Components.add("c3");
  Collection<Stack.ConfigProperty> requiredHDFSProperties=new HashSet<Stack.ConfigProperty>();
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","foo",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","bar",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","some_password",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("category1","prop1",null));
  Collection<Stack.ConfigProperty> requiredService2Properties=new HashSet<Stack.ConfigProperty>();
  requiredService2Properties.add(new Stack.ConfigProperty("category2","prop2",null));
  expect(stack.getServiceForComponent("c1")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c2")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c3")).andReturn("SERVICE2").atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("HDFS")).andReturn(requiredHDFSProperties).atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("SERVICE2")).andReturn(requiredService2Properties).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","foo")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","bar")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","some_password")).andReturn(true).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","category1","prop1")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("SERVICE2","category2","prop2")).andReturn(false).atLeastOnce();
  expect(group1.getConfiguration()).andReturn(EMPTY_CONFIGURATION).atLeastOnce();
  expect(group1.getName()).andReturn("group1").anyTimes();
  expect(group1.getComponentNames()).andReturn(group1Components).atLeastOnce();
  expect(group1.getCardinality()).andReturn("1").atLeastOnce();
  expect(group1.getComponents()).andReturn(Arrays.asList(new Component("c1"),new Component("c2"))).atLeastOnce();
  expect(group2.getConfiguration()).andReturn(EMPTY_CONFIGURATION).atLeastOnce();
  expect(group2.getName()).andReturn("group2").anyTimes();
  expect(group2.getComponentNames()).andReturn(group2Components).atLeastOnce();
  expect(group2.getCardinality()).andReturn("1").atLeastOnce();
  expect(group2.getComponents()).andReturn(Arrays.asList(new Component("c1"),new Component("c3"))).atLeastOnce();
  replay(stack,group1,group2);
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsProps=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsProps);
  hdfsProps.put("foo","val");
  hdfsProps.put("bar","val");
  Map<String,String> category1Props=new HashMap<String,String>();
  properties.put("category1",category1Props);
  category1Props.put("prop1","val");
  Map<String,String> category2Props=new HashMap<String,String>();
  properties.put("category2",category2Props);
  category2Props.put("prop2","val");
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  Configuration configuration=new Configuration(properties,attributes,EMPTY_CONFIGURATION);
  SecurityConfiguration securityConfiguration=new SecurityConfiguration(SecurityType.KERBEROS,"testRef",null);
  Blueprint blueprint=new BlueprintImpl("test",hostGroups,stack,configuration,securityConfiguration);
  blueprint.validateRequiredProperties();
  BlueprintEntity entity=blueprint.toEntity();
  verify(stack,group1,group2);
  assertTrue(entity.getSecurityType() == SecurityType.KERBEROS);
  assertTrue(entity.getSecurityDescriptorReference().equals("testRef"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidateConfigurations__hostGroupConfig() throws Exception {
  Stack stack=createNiceMock(Stack.class);
  HostGroup group1=createMock(HostGroup.class);
  HostGroup group2=createMock(HostGroup.class);
  Collection<HostGroup> hostGroups=new HashSet<HostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Set<String> group1Components=new HashSet<String>();
  group1Components.add("c1");
  group1Components.add("c2");
  Set<String> group2Components=new HashSet<String>();
  group2Components.add("c1");
  group2Components.add("c3");
  Map<String,Map<String,String>> group2Props=new HashMap<String,Map<String,String>>();
  Map<String,String> group2Category2Props=new HashMap<String,String>();
  group2Props.put("category2",group2Category2Props);
  group2Category2Props.put("prop2","val");
  Collection<Stack.ConfigProperty> requiredHDFSProperties=new HashSet<Stack.ConfigProperty>();
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","foo",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","bar",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("hdfs-site","some_password",null));
  requiredHDFSProperties.add(new Stack.ConfigProperty("category1","prop1",null));
  Collection<Stack.ConfigProperty> requiredService2Properties=new HashSet<Stack.ConfigProperty>();
  requiredService2Properties.add(new Stack.ConfigProperty("category2","prop2",null));
  expect(stack.getServiceForComponent("c1")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c2")).andReturn("HDFS").atLeastOnce();
  expect(stack.getServiceForComponent("c3")).andReturn("SERVICE2").atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("HDFS")).andReturn(requiredHDFSProperties).atLeastOnce();
  expect(stack.getRequiredConfigurationProperties("SERVICE2")).andReturn(requiredService2Properties).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","foo")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","bar")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","hdfs-site","some_password")).andReturn(true).atLeastOnce();
  expect(stack.isPasswordProperty("HDFS","category1","prop1")).andReturn(false).atLeastOnce();
  expect(stack.isPasswordProperty("SERVICE2","category2","prop2")).andReturn(false).atLeastOnce();
  expect(group1.getConfiguration()).andReturn(EMPTY_CONFIGURATION).atLeastOnce();
  expect(group1.getName()).andReturn("group1").anyTimes();
  expect(group1.getComponentNames()).andReturn(group1Components).atLeastOnce();
  expect(group1.getCardinality()).andReturn("1").atLeastOnce();
  expect(group1.getComponents()).andReturn(Arrays.asList(new Component("c1"),new Component("c2"))).atLeastOnce();
  expect(group2.getName()).andReturn("group2").anyTimes();
  expect(group2.getComponentNames()).andReturn(group2Components).atLeastOnce();
  expect(group2.getCardinality()).andReturn("1").atLeastOnce();
  expect(group2.getComponents()).andReturn(Arrays.asList(new Component("c1"),new Component("c3"))).atLeastOnce();
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> hdfsProps=new HashMap<String,String>();
  properties.put("hdfs-site",hdfsProps);
  hdfsProps.put("foo","val");
  hdfsProps.put("bar","val");
  Map<String,String> category1Props=new HashMap<String,String>();
  properties.put("category1",category1Props);
  category1Props.put("prop1","val");
  Map<String,Map<String,Map<String,String>>> attributes=new HashMap<String,Map<String,Map<String,String>>>();
  Configuration configuration=new Configuration(properties,attributes,EMPTY_CONFIGURATION);
  Configuration group2Configuration=new Configuration(group2Props,EMPTY_ATTRIBUTES,configuration);
  expect(group2.getConfiguration()).andReturn(group2Configuration).atLeastOnce();
  replay(stack,group1,group2);
  Blueprint blueprint=new BlueprintImpl("test",hostGroups,stack,configuration,null);
  blueprint.validateRequiredProperties();
  BlueprintEntity entity=blueprint.toEntity();
  verify(stack,group1,group2);
  assertTrue(entity.getSecurityType() == SecurityType.NONE);
  assertTrue(entity.getSecurityDescriptorReference() == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigurationFactoryTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOldSyntax() throws Exception {
  ConfigurationFactory factory=new ConfigurationFactory();
  Configuration configuration=factory.getConfiguration(getOldSyntaxConfigProps());
  assertEquals(2,configuration.getProperties().size());
  Map<String,String> configProperties1=configuration.getProperties().get("foo-type");
  assertEquals(2,configProperties1.size());
  assertEquals("prop1Value",configProperties1.get("prop1"));
  assertEquals("prop2Value",configProperties1.get("prop2"));
  Map<String,String> configProperties2=configuration.getProperties().get("bar-type");
  assertEquals(1,configProperties2.size());
  assertEquals("prop3Value",configProperties2.get("prop3"));
  assertTrue(configuration.getAttributes().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigurationTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFullAttributes_withParent(){
  Configuration configuration=createConfigurationWithParents_AttributesOnly();
  Map<String,Map<String,Map<String,String>>> fullAttributes=configuration.getFullAttributes();
  assertEquals(2,fullAttributes.size());
  Map<String,Map<String,String>> type1Attributes=fullAttributes.get("type1");
  assertEquals(4,type1Attributes.size());
  Map<String,String> attribute1Properties=type1Attributes.get("attribute1");
  assertEquals(5,attribute1Properties.size());
  assertEquals("val1.3",attribute1Properties.get("prop1"));
  assertEquals("val2.2",attribute1Properties.get("prop2"));
  assertEquals("val3.1",attribute1Properties.get("prop3"));
  assertEquals("val6.2",attribute1Properties.get("prop6"));
  assertEquals("val9.3",attribute1Properties.get("prop9"));
  Map<String,String> attribute2Properties=type1Attributes.get("attribute2");
  assertEquals(2,attribute2Properties.size());
  assertEquals("val4.3",attribute2Properties.get("prop4"));
  assertEquals("val5.1",attribute2Properties.get("prop5"));
  Map<String,String> attribute3Properties=type1Attributes.get("attribute3");
  assertEquals(2,attribute3Properties.size());
  assertEquals("val7.3",attribute3Properties.get("prop7"));
  assertEquals("val8.2",attribute3Properties.get("prop8"));
  Map<String,String> attribute4Properties=type1Attributes.get("attribute4");
  assertEquals(2,attribute4Properties.size());
  assertEquals("val10.3",attribute4Properties.get("prop10"));
  assertEquals("val11.3",attribute4Properties.get("prop11"));
  Map<String,Map<String,String>> type2Attributes=fullAttributes.get("type2");
  assertEquals(2,type2Attributes.size());
  Map<String,String> attribute100Properties=type2Attributes.get("attribute100");
  assertEquals(3,attribute100Properties.size());
  assertEquals("val100.3",attribute100Properties.get("prop100"));
  assertEquals("val101.1",attribute100Properties.get("prop101"));
  assertEquals("val102.3",attribute100Properties.get("prop102"));
  Map<String,String> attribute101Properties=type2Attributes.get("attribute101");
  assertEquals(2,attribute101Properties.size());
  assertEquals("val100.2",attribute101Properties.get("prop100"));
  assertEquals("val101.1",attribute101Properties.get("prop101"));
  Configuration expectedConfiguration=createConfigurationWithParents_AttributesOnly();
  assertEquals(expectedConfiguration.getAttributes(),configuration.getAttributes());
  assertEquals(expectedConfiguration.getParentConfiguration().getAttributes(),configuration.getParentConfiguration().getAttributes());
  assertEquals(expectedConfiguration.getParentConfiguration().getParentConfiguration().getAttributes(),configuration.getParentConfiguration().getParentConfiguration().getAttributes());
  assertEquals(EMPTY_PROPERTIES,configuration.getProperties());
  Collection<String> configTypes=configuration.getAllConfigTypes();
  assertEquals(2,configTypes.size());
  assertTrue(configTypes.containsAll(Arrays.asList("type1","type2")));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFullProperties_withParent(){
  Configuration configuration=createConfigurationWithParents_PropsOnly();
  Map<String,Map<String,String>> fullProperties=configuration.getFullProperties();
  assertEquals(4,fullProperties.size());
  Map<String,String> type1Props=fullProperties.get("type1");
  assertEquals(5,type1Props.size());
  assertEquals("val1.3",type1Props.get("prop1"));
  assertEquals("val2.2",type1Props.get("prop2"));
  assertEquals("val3.1",type1Props.get("prop3"));
  assertEquals("val6.2",type1Props.get("prop6"));
  assertEquals("val9.3",type1Props.get("prop9"));
  Map<String,String> type2Props=fullProperties.get("type2");
  assertEquals(2,type2Props.size());
  assertEquals("val4.3",type2Props.get("prop4"));
  assertEquals("val5.1",type2Props.get("prop5"));
  Map<String,String> type3Props=fullProperties.get("type3");
  assertEquals(2,type3Props.size());
  assertEquals("val7.3",type3Props.get("prop7"));
  assertEquals("val8.2",type3Props.get("prop8"));
  Map<String,String> type4Props=fullProperties.get("type4");
  assertEquals(2,type4Props.size());
  assertEquals("val10.3",type4Props.get("prop10"));
  assertEquals("val11.3",type4Props.get("prop11"));
  Configuration expectedConfiguration=createConfigurationWithParents_PropsOnly();
  assertEquals(expectedConfiguration.getProperties(),configuration.getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getProperties(),configuration.getParentConfiguration().getProperties());
  assertEquals(expectedConfiguration.getParentConfiguration().getParentConfiguration().getProperties(),configuration.getParentConfiguration().getParentConfiguration().getProperties());
  assertEquals(EMPTY_ATTRIBUTES,configuration.getAttributes());
  Collection<String> configTypes=configuration.getAllConfigTypes();
  assertEquals(4,configTypes.size());
  assertTrue(configTypes.containsAll(Arrays.asList("type1","type2","type3","type4")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigureClusterTaskTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testShouldConfigureClusterTaskLogicBeExecutedWhenRequiredHostgroupsAreResolved() throws Exception {
  expect(clusterConfigurationRequest.getRequiredHostGroups()).andReturn(Collections.EMPTY_LIST);
  expect(clusterTopology.getHostGroupInfo()).andReturn(Collections.EMPTY_MAP);
  clusterConfigurationRequest.process();
  replay(clusterConfigurationRequest,clusterTopology);
  Boolean result=testSubject.call();
  verify();
  Assert.assertTrue(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.HostGroupInfoTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetHostNames(){
  HostGroupInfo group=new HostGroupInfo("test-name");
  group.addHost("host1");
  assertEquals(1,group.getHostNames().size());
  assertTrue(group.getHostNames().contains("host1"));
  group.addHosts(Arrays.asList("host2","host3","host1"));
  Collection<String> hostNames=group.getHostNames();
  assertEquals(3,hostNames.size());
  assertTrue(hostNames.contains("host1"));
  assertTrue(hostNames.contains("host2"));
  assertTrue(hostNames.contains("host3"));
  hostNames.clear();
  hostNames=group.getHostNames();
  assertEquals(3,hostNames.size());
  assertTrue(hostNames.contains("host1"));
  assertTrue(hostNames.contains("host2"));
  assertTrue(hostNames.contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.SecurityConfigurationFactoryTest </h4><pre class="type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testCreateInvalidSecurityType() throws Exception {
  Map<String,Object> reuqestMap=new HashMap<>();
  Map<String,Object> security=new HashMap<>();
  security.put(SecurityConfigurationFactory.TYPE_PROPERTY_ID,"INVALID_SECURITY_TYPE");
  reuqestMap.put(SecurityConfigurationFactory.SECURITY_PROPERTY_ID,security);
  SecurityConfiguration securityConfiguration=testSubject.createSecurityConfigurationFromRequest(reuqestMap,false);
  assertTrue(securityConfiguration.getType() == SecurityType.KERBEROS);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreateKerberosSecurityTypeNone() throws Exception {
  Map<String,Object> reuqestMap=new HashMap<>();
  Map<String,Object> security=new HashMap<>();
  security.put(SecurityConfigurationFactory.TYPE_PROPERTY_ID,SecurityType.NONE.toString());
  reuqestMap.put(SecurityConfigurationFactory.SECURITY_PROPERTY_ID,security);
  SecurityConfiguration securityConfiguration=testSubject.createSecurityConfigurationFromRequest(reuqestMap,false);
  assertTrue(securityConfiguration.getType() == SecurityType.NONE);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreateEmpty() throws Exception {
  Map<String,Object> reuqestMap=new HashMap<>();
  SecurityConfiguration securityConfiguration=testSubject.createSecurityConfigurationFromRequest(reuqestMap,false);
  assertTrue(securityConfiguration == null);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testShouldLoadKerberosDescriptorWhenKDReferenceFoundInRequest() throws Exception {
  EasyMock.expect(kerberosDescriptorDAO.findByName(TEST_KERBEROS_DESCRIPTOR_REFERENCE)).andReturn(testKDEntity());
  Map<String,Object> reuqestMap=new HashMap<>();
  Map<String,Object> security=new HashMap<>();
  security.put(SecurityConfigurationFactory.TYPE_PROPERTY_ID,SecurityType.KERBEROS.toString());
  security.put(SecurityConfigurationFactory.KERBEROS_DESCRIPTOR_REFERENCE_PROPERTY_ID,TEST_KERBEROS_DESCRIPTOR_REFERENCE);
  reuqestMap.put(SecurityConfigurationFactory.SECURITY_PROPERTY_ID,security);
  EasyMock.replay(kerberosDescriptorDAO);
  SecurityConfiguration securityConfiguration=testSubject.createSecurityConfigurationFromRequest(reuqestMap,false);
  EasyMock.verify(kerberosDescriptorDAO);
  assertTrue(securityConfiguration.getType() == SecurityType.KERBEROS);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreateKerberosSecurityWithoutDescriptor() throws Exception {
  Map<String,Object> reuqestMap=new HashMap<>();
  Map<String,Object> security=new HashMap<>();
  security.put(SecurityConfigurationFactory.TYPE_PROPERTY_ID,SecurityType.KERBEROS.toString());
  reuqestMap.put(SecurityConfigurationFactory.SECURITY_PROPERTY_ID,security);
  SecurityConfiguration securityConfiguration=testSubject.createSecurityConfigurationFromRequest(reuqestMap,false);
  assertTrue(securityConfiguration.getType() == SecurityType.KERBEROS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.update.HostUpdateHelperTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testUpdateHostsInConfigurations() throws AmbariException {
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  final AmbariManagementController mockAmbariManagementController=easyMockSupport.createNiceMock(AmbariManagementController.class);
  final ClusterDAO mockClusterDAO=easyMockSupport.createNiceMock(ClusterDAO.class);
  final EntityManager entityManager=createNiceMock(EntityManager.class);
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  Clusters mockClusters=easyMockSupport.createStrictMock(Clusters.class);
  Cluster mockCluster=easyMockSupport.createNiceMock(Cluster.class);
  ClusterEntity mockClusterEntity1=easyMockSupport.createNiceMock(ClusterEntity.class);
  ClusterEntity mockClusterEntity2=easyMockSupport.createNiceMock(ClusterEntity.class);
  ClusterConfigEntity mockClusterConfigEntity1=easyMockSupport.createNiceMock(ClusterConfigEntity.class);
  ClusterConfigEntity mockClusterConfigEntity2=easyMockSupport.createNiceMock(ClusterConfigEntity.class);
  ClusterConfigEntity mockClusterConfigEntity3=easyMockSupport.createNiceMock(ClusterConfigEntity.class);
  ClusterConfigEntity mockClusterConfigEntity4=easyMockSupport.createNiceMock(ClusterConfigEntity.class);
  StackEntity mockStackEntity=easyMockSupport.createNiceMock(StackEntity.class);
  ReadWriteLock mockReadWriteLock=easyMockSupport.createNiceMock(ReadWriteLock.class);
  Lock mockLock=easyMockSupport.createNiceMock(Lock.class);
  Map<String,Map<String,String>> clusterHostsToChange=new HashMap<>();
  Map<String,String> hosts=new HashMap<>();
  List<ClusterConfigEntity> clusterConfigEntities1=new ArrayList<>();
  List<ClusterConfigEntity> clusterConfigEntities2=new ArrayList<>();
  final Injector mockInjector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(AmbariManagementController.class).toInstance(mockAmbariManagementController);
      bind(DBAccessor.class).toInstance(dbAccessor);
      bind(EntityManager.class).toInstance(entityManager);
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(ClusterDAO.class).toInstance(mockClusterDAO);
    }
  }
);
  hosts.put("host11","host55");
  hosts.put("host5","host1");
  hosts.put("host1","host5");
  hosts.put("host55","host11");
  clusterConfigEntities1.add(mockClusterConfigEntity1);
  clusterConfigEntities1.add(mockClusterConfigEntity2);
  clusterConfigEntities2.add(mockClusterConfigEntity3);
  clusterConfigEntities2.add(mockClusterConfigEntity4);
  clusterHostsToChange.put("cl1",hosts);
  expect(mockClusterDAO.findByName("cl1")).andReturn(mockClusterEntity1).once();
  expect(mockClusterDAO.findById(1L)).andReturn(mockClusterEntity2).atLeastOnce();
  expect(mockAmbariManagementController.getClusters()).andReturn(mockClusters).once();
  expect(mockClusters.getCluster("cl1")).andReturn(mockCluster).once();
  expect(mockCluster.getClusterGlobalLock()).andReturn(mockReadWriteLock).atLeastOnce();
  expect(mockCluster.getClusterId()).andReturn(1L).atLeastOnce();
  expect(mockReadWriteLock.writeLock()).andReturn(mockLock).atLeastOnce();
  expect(mockClusterEntity1.getClusterConfigEntities()).andReturn(clusterConfigEntities1).atLeastOnce();
  expect(mockClusterEntity2.getClusterConfigEntities()).andReturn(clusterConfigEntities2).atLeastOnce();
  expect(mockClusterConfigEntity1.getStack()).andReturn(mockStackEntity).once();
  expect(mockClusterConfigEntity1.getData()).andReturn("{\"testProperty1\" : \"testValue_host1\", " + "\"testProperty2\" : \"testValue_host5\", \"testProperty3\" : \"testValue_host11\", " + "\"testProperty4\" : \"testValue_host55\"}").atLeastOnce();
  expect(mockClusterConfigEntity1.getTag()).andReturn("testTag1").atLeastOnce();
  expect(mockClusterConfigEntity1.getType()).andReturn("testType1").atLeastOnce();
  expect(mockClusterConfigEntity1.getVersion()).andReturn(1L).atLeastOnce();
  expect(mockClusterConfigEntity2.getStack()).andReturn(mockStackEntity).once();
  expect(mockClusterConfigEntity2.getData()).andReturn("{\"testProperty5\" : \"test_host1_test_host5_test_host11_test_host55\"}").atLeastOnce();
  expect(mockClusterConfigEntity2.getTag()).andReturn("testTag2").atLeastOnce();
  expect(mockClusterConfigEntity2.getType()).andReturn("testType2").atLeastOnce();
  expect(mockClusterConfigEntity2.getVersion()).andReturn(2L).atLeastOnce();
  expect(mockClusterConfigEntity3.getTag()).andReturn("testTag1").atLeastOnce();
  expect(mockClusterConfigEntity3.getType()).andReturn("testType1").atLeastOnce();
  expect(mockClusterConfigEntity3.getVersion()).andReturn(1L).atLeastOnce();
  expect(mockClusterConfigEntity4.getTag()).andReturn("testTag2").atLeastOnce();
  expect(mockClusterConfigEntity4.getType()).andReturn("testType2").atLeastOnce();
  expect(mockClusterConfigEntity4.getVersion()).andReturn(2L).atLeastOnce();
  Capture<String> dataCapture=EasyMock.newCapture();
  mockClusterConfigEntity3.setData(EasyMock.capture(dataCapture));
  expectLastCall();
  mockClusterConfigEntity4.setData("{\"testProperty5\":\"test_host5_test_host1_test_host55_test_host11\"}");
  expectLastCall();
  HostUpdateHelper hostUpdateHelper=new HostUpdateHelper(null,null,mockInjector);
  hostUpdateHelper.setHostChangesFileMap(clusterHostsToChange);
  easyMockSupport.replayAll();
  hostUpdateHelper.updateHostsInConfigurations();
  easyMockSupport.verifyAll();
  Assert.assertTrue(CollectionPresentationUtils.isJsonsEquals("{\"testProperty4\":\"testValue_host11\",\"testProperty3\":\"testValue_host55\"," + "\"testProperty2\":\"testValue_host1\",\"testProperty1\":\"testValue_host5\"}",dataCapture.getValue()));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testInitHostChangesFileMap_SUCCESS() throws AmbariException {
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  final Configuration mockConfiguration=easyMockSupport.createNiceMock(Configuration.class);
  JsonObject cluster=new JsonObject();
  JsonObject hostPairs=new JsonObject();
  hostPairs.add("Host1",new JsonPrimitive("Host11"));
  hostPairs.add("Host2",new JsonPrimitive("Host22"));
  cluster.add("cl1",hostPairs);
  expect(mockConfiguration.getHostChangesJson(null)).andReturn(cluster).once();
  HostUpdateHelper hostUpdateHelper=new HostUpdateHelper(null,mockConfiguration,null);
  easyMockSupport.replayAll();
  hostUpdateHelper.initHostChangesFileMap();
  easyMockSupport.verifyAll();
  Map<String,Map<String,String>> hostChangesFileMap=hostUpdateHelper.getHostChangesFileMap();
  Assert.assertTrue(hostChangesFileMap.get("cl1").containsKey("host1"));
  Assert.assertTrue(hostChangesFileMap.get("cl1").containsKey("host2"));
  Assert.assertTrue(hostChangesFileMap.get("cl1").get("host1").equals("host11"));
  Assert.assertTrue(hostChangesFileMap.get("cl1").get("host2").equals("host22"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.StackUpgradeUtilTest </h4><pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeStack() throws Exception {
  StackUpgradeUtil stackUpgradeUtil=injector.getInstance(StackUpgradeUtil.class);
  String stackName="HDP";
  String stackVersion="1.3.0";
  String localRepoUrl="http://foo.bar";
  stackUpgradeUtil.updateLocalRepo(stackName,stackVersion,localRepoUrl,null);
  MetainfoDAO dao=injector.getInstance(MetainfoDAO.class);
  Collection<MetainfoEntity> entities=dao.findAll();
  Assert.assertTrue(entities.size() > 0);
  for (  MetainfoEntity entity : entities) {
    Assert.assertTrue(entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/"));
    Assert.assertEquals(localRepoUrl,entity.getMetainfoValue());
  }
  reset(stackName,stackVersion);
  entities=dao.findAll();
  Assert.assertEquals(0,entities.size());
  stackUpgradeUtil.updateLocalRepo(stackName,stackVersion,localRepoUrl,"centos6");
  entities=dao.findAll();
  for (  MetainfoEntity entity : entities) {
    Assert.assertTrue(entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/centos6") || entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/redhat6"));
    Assert.assertEquals(localRepoUrl,entity.getMetainfoValue());
  }
  reset(stackName,stackVersion);
  entities=dao.findAll();
  Assert.assertTrue(0 == entities.size());
  stackUpgradeUtil.updateLocalRepo(stackName,stackVersion,localRepoUrl,"centos6,centos5");
  entities=dao.findAll();
  for (  MetainfoEntity entity : entities) {
    Assert.assertTrue(entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/centos6") || entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/redhat6") || entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/redhat5")|| entity.getMetainfoName().startsWith("repo:/HDP/1.3.0/centos5"));
    Assert.assertEquals(localRepoUrl,entity.getMetainfoValue());
  }
  localRepoUrl="http://newfoo.bar";
  stackUpgradeUtil.updateLocalRepo(stackName,stackVersion,localRepoUrl,"centos6");
  entities=dao.findAll();
  boolean foundCentos6=false;
  boolean foundRedhat6=false;
  for (  MetainfoEntity entity : entities) {
    if (-1 != entity.getMetainfoName().indexOf("centos6")) {
      foundCentos6=true;
      Assert.assertEquals(localRepoUrl,entity.getMetainfoValue());
    }
 else     if (-1 != entity.getMetainfoName().indexOf("redhat6")) {
      foundRedhat6=true;
      Assert.assertEquals(localRepoUrl,entity.getMetainfoValue());
    }
 else {
      Assert.assertFalse(localRepoUrl.equals(entity.getMetainfoValue()));
    }
  }
  Assert.assertTrue(foundCentos6);
  Assert.assertTrue(foundRedhat6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog150Test </h4><pre class="type-13 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMissingLog4jConfigs() throws Exception {
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  ClusterServiceEntity clusterServiceEntityMR=upgradeCatalogHelper.addService(injector,clusterEntity,"HDFS",desiredStackEntity);
  Long clusterId=clusterEntity.getClusterId();
  ClusterConfigEntity configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNull(configEntity);
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      Assert.fail();
    }
  }
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  upgradeCatalog150.addMissingLog4jConfigs();
  configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNotNull(configEntity);
  clusterEntity=clusterDAO.findById(1L);
  boolean failFlag=true;
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      failFlag=false;
    }
  }
  Assert.assertFalse(failFlag);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog200Test </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  Configuration configuration=createNiceMock(Configuration.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(configuration.getDatabaseUrl()).andReturn(Configuration.JDBC_IN_MEMORY_URL).anyTimes();
  Capture<DBAccessor.DBColumnInfo> alertDefinitionIgnoreColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> alertDefinitionDescriptionColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> alertTargetGlobalColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> hostComponentStateColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> hostComponentVersionColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> clustersSecurityTypeColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> hostComponentStateSecurityStateColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> hostComponentDesiredStateSecurityStateColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> hostRoleCommandRetryColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> stageSkippableColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> viewparameterLabelColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> viewparameterPlaceholderColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> viewparameterDefaultValueColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> serviceDesiredStateSecurityStateColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<List<DBAccessor.DBColumnInfo>> clusterVersionCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> hostVersionCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<DBAccessor.DBColumnInfo> valueColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<DBAccessor.DBColumnInfo> dataValueColumnCapture=new Capture<DBAccessor.DBColumnInfo>();
  Capture<List<DBAccessor.DBColumnInfo>> alertTargetStatesCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> artifactCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> kerberosPrincipalCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> kerberosPrincipalHostCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> upgradeCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> upgradeGroupCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  Capture<List<DBAccessor.DBColumnInfo>> upgradeItemCapture=new Capture<List<DBAccessor.DBColumnInfo>>();
  dbAccessor.addColumn(eq("alert_definition"),capture(alertDefinitionIgnoreColumnCapture));
  dbAccessor.addColumn(eq("alert_definition"),capture(alertDefinitionDescriptionColumnCapture));
  dbAccessor.createTable(eq("alert_target_states"),capture(alertTargetStatesCapture));
  dbAccessor.addColumn(eq("alert_target"),capture(alertTargetGlobalColumnCapture));
  dbAccessor.addColumn(eq("hostcomponentstate"),capture(hostComponentStateColumnCapture));
  dbAccessor.addColumn(eq("hostcomponentstate"),capture(hostComponentVersionColumnCapture));
  dbAccessor.addColumn(eq("host_role_command"),capture(hostRoleCommandRetryColumnCapture));
  dbAccessor.addColumn(eq("stage"),capture(stageSkippableColumnCapture));
  dbAccessor.addColumn(eq("clusters"),capture(clustersSecurityTypeColumnCapture));
  dbAccessor.addColumn(eq("hostcomponentstate"),capture(hostComponentStateSecurityStateColumnCapture));
  dbAccessor.addColumn(eq("hostcomponentdesiredstate"),capture(hostComponentDesiredStateSecurityStateColumnCapture));
  dbAccessor.addColumn(eq("viewparameter"),capture(viewparameterLabelColumnCapture));
  dbAccessor.addColumn(eq("viewparameter"),capture(viewparameterPlaceholderColumnCapture));
  dbAccessor.addColumn(eq("viewparameter"),capture(viewparameterDefaultValueColumnCapture));
  dbAccessor.addColumn(eq("servicedesiredstate"),capture(serviceDesiredStateSecurityStateColumnCapture));
  dbAccessor.createTable(eq("cluster_version"),capture(clusterVersionCapture),eq("id"));
  dbAccessor.createTable(eq("host_version"),capture(hostVersionCapture),eq("id"));
  dbAccessor.createTable(eq("upgrade"),capture(upgradeCapture),eq("upgrade_id"));
  dbAccessor.createTable(eq("upgrade_group"),capture(upgradeGroupCapture),eq("upgrade_group_id"));
  dbAccessor.createTable(eq("upgrade_item"),capture(upgradeItemCapture),eq("upgrade_item_id"));
  dbAccessor.createTable(eq("artifact"),capture(artifactCapture),eq("artifact_name"),eq("foreign_keys"));
  dbAccessor.createTable(eq("kerberos_principal"),capture(kerberosPrincipalCapture),eq("principal_name"));
  dbAccessor.createTable(eq("kerberos_principal_host"),capture(kerberosPrincipalHostCapture),eq("principal_name"),eq("host_name"));
  expect(dbAccessor.tableHasColumn("kerberos_principal_host","host_name")).andReturn(true).atLeastOnce();
  dbAccessor.addFKConstraint(eq("kerberos_principal_host"),eq("FK_krb_pr_host_hostname"),eq("host_name"),eq("hosts"),eq("host_name"),eq(true),eq(false));
  dbAccessor.addFKConstraint(eq("kerberos_principal_host"),eq("FK_krb_pr_host_principalname"),eq("principal_name"),eq("kerberos_principal"),eq("principal_name"),eq(true),eq(false));
  setViewInstancePropertyExpectations(dbAccessor,valueColumnCapture);
  setViewInstanceDataExpectations(dbAccessor,dataValueColumnCapture);
  dbAccessor.getConnection();
  expectLastCall().andReturn(connection).anyTimes();
  connection.createStatement();
  expectLastCall().andReturn(statement).anyTimes();
  statement.executeQuery(anyObject(String.class));
  expectLastCall().andReturn(resultSet).anyTimes();
  replay(dbAccessor,configuration,resultSet,statement,connection);
  AbstractUpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor);
  Class<?> c=AbstractUpgradeCatalog.class;
  Field f=c.getDeclaredField("configuration");
  f.setAccessible(true);
  f.set(upgradeCatalog,configuration);
  upgradeCatalog.executeDDLUpdates();
  verify(dbAccessor,configuration,resultSet,statement,connection);
  verifyAlertDefinitionIgnoreColumn(alertDefinitionIgnoreColumnCapture);
  verifyAlertDefinitionDescriptionColumn(alertDefinitionDescriptionColumnCapture);
  verifyAlertTargetGlobal(alertTargetGlobalColumnCapture);
  verifyAlertTargetStatesTable(alertTargetStatesCapture);
  DBAccessor.DBColumnInfo upgradeStateColumn=hostComponentStateColumnCapture.getValue();
  assertEquals("upgrade_state",upgradeStateColumn.getName());
  assertEquals(32,(int)upgradeStateColumn.getLength());
  assertEquals(String.class,upgradeStateColumn.getType());
  assertEquals("NONE",upgradeStateColumn.getDefaultValue());
  assertFalse(upgradeStateColumn.isNullable());
  DBAccessor.DBColumnInfo upgradeVersionColumn=hostComponentVersionColumnCapture.getValue();
  assertEquals("version",upgradeVersionColumn.getName());
  assertEquals(32,(int)upgradeVersionColumn.getLength());
  assertEquals(String.class,upgradeVersionColumn.getType());
  assertEquals("UNKNOWN",upgradeVersionColumn.getDefaultValue());
  assertFalse(upgradeVersionColumn.isNullable());
  DBAccessor.DBColumnInfo upgradeRetryColumn=hostRoleCommandRetryColumnCapture.getValue();
  assertEquals("retry_allowed",upgradeRetryColumn.getName());
  assertEquals(1,(int)upgradeRetryColumn.getLength());
  assertEquals(Integer.class,upgradeRetryColumn.getType());
  assertEquals(0,upgradeRetryColumn.getDefaultValue());
  assertFalse(upgradeRetryColumn.isNullable());
  DBAccessor.DBColumnInfo upgradeSkippableColumn=stageSkippableColumnCapture.getValue();
  assertEquals("skippable",upgradeSkippableColumn.getName());
  assertEquals(1,(int)upgradeSkippableColumn.getLength());
  assertEquals(Integer.class,upgradeSkippableColumn.getType());
  assertEquals(0,upgradeSkippableColumn.getDefaultValue());
  assertFalse(upgradeSkippableColumn.isNullable());
  verifyClustersSecurityType(clustersSecurityTypeColumnCapture);
  verifyComponentSecurityStateColumn(hostComponentStateSecurityStateColumnCapture);
  verifyComponentSecurityStateColumn(hostComponentDesiredStateSecurityStateColumnCapture);
  verifyServiceSecurityStateColumn(serviceDesiredStateSecurityStateColumnCapture);
  verifyViewParameterColumns(viewparameterLabelColumnCapture,viewparameterPlaceholderColumnCapture,viewparameterDefaultValueColumnCapture);
  List<DBAccessor.DBColumnInfo> artifactColumns=artifactCapture.getValue();
  testCreateArtifactTable(artifactColumns);
  testCreateKerberosPrincipalTable(kerberosPrincipalCapture.getValue());
  testCreateKerberosPrincipalHostTable(kerberosPrincipalHostCapture.getValue());
  assertEquals(7,clusterVersionCapture.getValue().size());
  assertEquals(4,hostVersionCapture.getValue().size());
  assertViewInstancePropertyColumns(valueColumnCapture);
  assertViewInstanceDataColumns(dataValueColumnCapture);
  assertEquals(6,upgradeCapture.getValue().size());
  assertEquals(4,upgradeGroupCapture.getValue().size());
  assertEquals(7,upgradeItemCapture.getValue().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog211Test </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  Injector injector=initInjector();
  try {
    Provider<EntityManager> entityManagerProvider=initEntityManagerProvider();
    final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
    final OsFamily osFamily=createNiceMock(OsFamily.class);
    Configuration configuration=createNiceMock(Configuration.class);
    Connection connection=createNiceMock(Connection.class);
    Statement statement=createNiceMock(Statement.class);
    ResultSet resultSet=createNiceMock(ResultSet.class);
    expect(configuration.getDatabaseUrl()).andReturn(Configuration.JDBC_IN_MEMORY_URL).anyTimes();
    expect(configuration.getDatabaseType()).andReturn(DatabaseType.DERBY).anyTimes();
    dbAccessor.getConnection();
    expectLastCall().andReturn(connection).anyTimes();
    connection.createStatement();
    expectLastCall().andReturn(statement).anyTimes();
    statement.executeQuery("SELECT COUNT(*) from ambari_sequences where sequence_name='hostcomponentstate_id_seq'");
    expectLastCall().andReturn(resultSet).atLeastOnce();
    ResultSet rs1=createNiceMock(ResultSet.class);
    expect(rs1.next()).andReturn(Boolean.TRUE).once();
    statement.executeQuery(anyObject(String.class));
    expectLastCall().andReturn(rs1).anyTimes();
    Capture<String> queryCapture=new Capture<String>();
    dbAccessor.executeQuery(capture(queryCapture));
    expectLastCall().once();
    dbAccessor.setColumnNullable("viewinstanceproperty","value",true);
    expectLastCall().once();
    dbAccessor.setColumnNullable("viewinstancedata","value",true);
    expectLastCall().once();
    replayAll();
    AbstractUpgradeCatalog upgradeCatalog=getUpgradeCatalog(dbAccessor,osFamily,entityManagerProvider.get());
    Class<?> c=AbstractUpgradeCatalog.class;
    Field f=c.getDeclaredField("configuration");
    f.setAccessible(true);
    f.set(upgradeCatalog,configuration);
    f=UpgradeCatalog211.class.getDeclaredField("m_hcsId");
    f.setAccessible(true);
    f.set(upgradeCatalog,new AtomicLong(1001));
    upgradeCatalog.executeDDLUpdates();
    verifyAll();
    Assert.assertTrue(queryCapture.hasCaptured());
    Assert.assertTrue(queryCapture.getValue().contains("1001"));
  }
  finally {
    destroyInjector(injector);
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateKerberosConfiguration() throws Exception {
  final AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  final OsFamily osFamily=createNiceMock(OsFamily.class);
  final Map<String,String> propertiesKerberosEnv=new HashMap<String,String>(){
{
      put("create_attributes_template","create_attributes_template content");
      put("realm","EXAMPLE.COM");
      put("container_dn","");
      put("ldap_url","");
      put("encryption_types","aes des3-cbc-sha1 rc4 des-cbc-md5");
      put("kdc_host","c6407.ambari.apache.org");
      put("admin_server_host","c6407.ambari.apache.org");
      put("kdc_type","mit-kdc");
    }
  }
;
  final Config configKerberosEnv=createNiceMock(Config.class);
  expect(configKerberosEnv.getProperties()).andReturn(propertiesKerberosEnv).anyTimes();
  expect(configKerberosEnv.getTag()).andReturn("tag1").anyTimes();
  final Cluster cluster=createNiceMock(Cluster.class);
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(configKerberosEnv).once();
  final Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(AmbariManagementController.class).toInstance(controller);
      bind(DBAccessor.class).toInstance(dbAccessor);
      bind(OsFamily.class).toInstance(osFamily);
    }
  }
);
  expect(cluster.getConfigsByType("kerberos-env")).andReturn(Collections.singletonMap("tag1",configKerberosEnv)).once();
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(configKerberosEnv).once();
  Capture<ConfigurationRequest> captureCR=new Capture<ConfigurationRequest>();
  Capture<Cluster> clusterCapture=newCapture();
  Capture<String> typeCapture=newCapture();
  Capture<Map> propertiesCapture=newCapture();
  Capture<String> tagCapture=newCapture();
  Capture<Map> attributesCapture=newCapture();
  expect(controller.createConfig(capture(clusterCapture),capture(typeCapture),capture(propertiesCapture),capture(tagCapture),capture(attributesCapture))).andReturn(createNiceMock(Config.class)).once();
  replayAll();
  injector.getInstance(UpgradeCatalog211.class).updateKerberosConfigurations(cluster);
  verifyAll();
  Map<String,String> capturedCRProperties=propertiesCapture.getValue();
  Assert.assertNotNull(capturedCRProperties);
  Assert.assertFalse(capturedCRProperties.containsKey("create_attributes_template"));
  Assert.assertTrue(capturedCRProperties.containsKey("ad_create_attributes_template"));
  for (  String property : propertiesKerberosEnv.keySet()) {
    if ("create_attributes_template".equals(property)) {
      Assert.assertEquals("create_attributes_template/ad_create_attributes_template",propertiesKerberosEnv.get(property),capturedCRProperties.get("ad_create_attributes_template"));
    }
 else {
      Assert.assertEquals(property,propertiesKerberosEnv.get(property),capturedCRProperties.get(property));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog220Test </h4><pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldDDLsBeExecutedOnUpgrade() throws Exception {
  Injector mockedInjector=mocksControl.createMock(Injector.class);
  DBAccessor mockedDbAccessor=mocksControl.createMock(DBAccessor.class);
  DaoUtils mockedDaoUtils=mocksControl.createMock(DaoUtils.class);
  Configuration mockedConfiguration=mocksControl.createMock(Configuration.class);
  StackUpgradeUtil mockedStackUpgradeUtil=mocksControl.createMock(StackUpgradeUtil.class);
  Capture<String> capturedTableName=EasyMock.newCapture();
  Capture<String> capturedPKColumn=EasyMock.newCapture();
  Capture<List<DBAccessor.DBColumnInfo>> capturedColumns=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> capturedColumn=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> capturedHostRoleCommandColumn=EasyMock.newCapture();
  Capture<String> capturedBlueprintTableName=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> capturedNewBlueprintColumn1=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> capturedNewBlueprintColumn2=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> stageSkipColumnCapture=EasyMock.newCapture();
  EasyMock.expect(mockedInjector.getInstance(DaoUtils.class)).andReturn(mockedDaoUtils);
  mockedInjector.injectMembers(anyObject(UpgradeCatalog.class));
  EasyMock.expect(mockedConfiguration.getDatabaseType()).andReturn(Configuration.DatabaseType.POSTGRES).anyTimes();
  EasyMock.expect(mockedConfiguration.getDatabaseUser()).andReturn("ambari");
  EasyMock.expect(mockedConfiguration.getServerJDBCPostgresSchemaName()).andReturn("fo");
  mockedDbAccessor.executeQuery("ALTER SCHEMA fo OWNER TO \"ambari\";");
  mockedDbAccessor.executeQuery("ALTER ROLE \"ambari\" SET search_path to 'fo';");
  mockedDbAccessor.addColumn(eq("upgrade"),capture(capturedColumn));
  mockedDbAccessor.addColumn(eq("upgrade"),capture(capturedColumn));
  mockedDbAccessor.addColumn(eq("upgrade"),capture(capturedColumn));
  mockedDbAccessor.createTable(capture(capturedTableName),capture(capturedColumns),capture(capturedPKColumn));
  mockedDbAccessor.alterColumn(eq("host_role_command"),capture(capturedHostRoleCommandColumn));
  mockedDbAccessor.addColumn(capture(capturedBlueprintTableName),capture(capturedNewBlueprintColumn1));
  mockedDbAccessor.addColumn(capture(capturedBlueprintTableName),capture(capturedNewBlueprintColumn2));
  mockedDbAccessor.addColumn(eq("stage"),capture(stageSkipColumnCapture));
  mocksControl.replay();
  UpgradeCatalog220 testSubject=new UpgradeCatalog220(mockedInjector);
  EasyMockSupport.injectMocks(testSubject);
  testSubject.stackUpgradeUtil=mockedStackUpgradeUtil;
  testSubject.dbAccessor=mockedDbAccessor;
  testSubject.configuration=mockedConfiguration;
  testSubject.upgradeSchema();
  Assert.assertEquals("The table name is wrong!","kerberos_descriptor",capturedTableName.getValue());
  Assert.assertEquals("The primary key is wrong!","kerberos_descriptor_name",capturedPKColumn.getValue());
  Assert.assertTrue("Ther number of columns is wrong!",capturedColumns.getValue().size() == 2);
  Assert.assertEquals("The table name is wrong!","blueprint",capturedBlueprintTableName.getValue());
  Assert.assertEquals("The column name is wrong!","security_type",capturedNewBlueprintColumn1.getValue().getName());
  Assert.assertEquals("The column name is wrong!","security_descriptor_reference",capturedNewBlueprintColumn2.getValue().getName());
  Assert.assertEquals("The column name is wrong!","supports_auto_skip_failure",stageSkipColumnCapture.getValue().getName());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAmsHbaseSiteUpdateConfigs() throws Exception {
  Map<String,String> oldPropertiesAmsHbaseSite=new HashMap<String,String>(){
{
      put("zookeeper.session.timeout.localHBaseCluster",String.valueOf(20000));
    }
  }
;
  Map<String,String> newPropertiesAmsSite=new HashMap<String,String>(){
{
      put("zookeeper.session.timeout.localHBaseCluster",String.valueOf(120000));
      put("hbase.normalizer.enabled",String.valueOf(true));
      put("hbase.normalizer.period",String.valueOf(600000));
      put("hbase.master.normalizer.class","org.apache.hadoop.hbase.master.normalizer.SimpleRegionNormalizer");
    }
  }
;
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  Clusters clusters=easyMockSupport.createNiceMock(Clusters.class);
  final Cluster cluster=easyMockSupport.createNiceMock(Cluster.class);
  Config mockAmsHbaseSite=easyMockSupport.createNiceMock(Config.class);
  expect(clusters.getClusters()).andReturn(new HashMap<String,Cluster>(){
{
      put("normal",cluster);
    }
  }
).once();
  expect(cluster.getDesiredConfigByType("ams-hbase-site")).andReturn(mockAmsHbaseSite).atLeastOnce();
  expect(mockAmsHbaseSite.getProperties()).andReturn(oldPropertiesAmsHbaseSite).atLeastOnce();
  Injector injector=easyMockSupport.createNiceMock(Injector.class);
  expect(injector.getInstance(Gson.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class)).anyTimes();
  replay(injector,clusters,mockAmsHbaseSite,cluster);
  AmbariManagementControllerImpl controller=createMockBuilder(AmbariManagementControllerImpl.class).addMockedMethod("createConfiguration").addMockedMethod("getClusters",new Class[]{}).addMockedMethod("createConfig").withConstructor(createNiceMock(ActionManager.class),clusters,injector).createNiceMock();
  Injector injector2=easyMockSupport.createNiceMock(Injector.class);
  Capture<Map> propertiesCapture=EasyMock.newCapture();
  expect(injector2.getInstance(AmbariManagementController.class)).andReturn(controller).anyTimes();
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(controller.createConfig(anyObject(Cluster.class),anyString(),capture(propertiesCapture),anyString(),anyObject(Map.class))).andReturn(createNiceMock(Config.class)).once();
  replay(controller,injector2);
  new UpgradeCatalog220(injector2).updateAMSConfigs();
  easyMockSupport.verifyAll();
  Map<String,String> updatedProperties=propertiesCapture.getValue();
  assertTrue(Maps.difference(newPropertiesAmsSite,updatedProperties).areEqual());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAmsSiteUpdateConfigs() throws Exception {
  Map<String,String> oldPropertiesAmsSite=new HashMap<String,String>(){
{
      put("timeline.metrics.service.default.result.limit",String.valueOf(5760));
      put("timeline.metrics.cluster.aggregator.minute.interval",String.valueOf(1000));
      put("timeline.metrics.host.aggregator.minute.interval",String.valueOf(1000));
      put("timeline.metrics.cluster.aggregator.minute.ttl",String.valueOf(1000));
    }
  }
;
  Map<String,String> newPropertiesAmsSite=new HashMap<String,String>(){
{
      put("timeline.metrics.service.default.result.limit",String.valueOf(15840));
      put("timeline.metrics.cluster.aggregator.second.interval",String.valueOf(120));
      put("timeline.metrics.cluster.aggregator.minute.interval",String.valueOf(300));
      put("timeline.metrics.host.aggregator.minute.interval",String.valueOf(300));
      put("timeline.metrics.cluster.aggregator.second.ttl",String.valueOf(2592000));
      put("timeline.metrics.cluster.aggregator.minute.ttl",String.valueOf(7776000));
      put("timeline.metrics.cluster.aggregator.second.checkpointCutOffMultiplier",String.valueOf(2));
      put("timeline.metrics.cluster.aggregator.second.disabled",String.valueOf(false));
      put("timeline.metrics.hbase.fifo.compaction.enabled",String.valueOf(true));
    }
  }
;
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  Clusters clusters=easyMockSupport.createNiceMock(Clusters.class);
  final Cluster cluster=easyMockSupport.createNiceMock(Cluster.class);
  Config mockAmsSite=easyMockSupport.createNiceMock(Config.class);
  expect(clusters.getClusters()).andReturn(new HashMap<String,Cluster>(){
{
      put("normal",cluster);
    }
  }
).once();
  expect(cluster.getDesiredConfigByType("ams-site")).andReturn(mockAmsSite).atLeastOnce();
  expect(mockAmsSite.getProperties()).andReturn(oldPropertiesAmsSite).times(2);
  Injector injector=easyMockSupport.createNiceMock(Injector.class);
  expect(injector.getInstance(Gson.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class)).anyTimes();
  replay(injector,clusters,mockAmsSite,cluster);
  AmbariManagementControllerImpl controller=createMockBuilder(AmbariManagementControllerImpl.class).addMockedMethod("createConfiguration").addMockedMethod("getClusters",new Class[]{}).addMockedMethod("createConfig").withConstructor(createNiceMock(ActionManager.class),clusters,injector).createNiceMock();
  Injector injector2=easyMockSupport.createNiceMock(Injector.class);
  Capture<Map> propertiesCapture=EasyMock.newCapture();
  expect(injector2.getInstance(AmbariManagementController.class)).andReturn(controller).anyTimes();
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(controller.createConfig(anyObject(Cluster.class),anyString(),capture(propertiesCapture),anyString(),anyObject(Map.class))).andReturn(createNiceMock(Config.class)).once();
  replay(controller,injector2);
  new UpgradeCatalog220(injector2).updateAMSConfigs();
  easyMockSupport.verifyAll();
  Map<String,String> updatedProperties=propertiesCapture.getValue();
  assertTrue(Maps.difference(newPropertiesAmsSite,updatedProperties).areEqual());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog221Test </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUpdateAmsHbaseSecuritySiteConfigs() throws Exception {
  Map<String,String> oldPropertiesAmsHbaseSecuritySite=new HashMap<String,String>(){
{
      put("zookeeper.znode.parent","/ams-hbase-secure");
    }
  }
;
  Map<String,String> newPropertiesAmsHbaseSecuritySite=new HashMap<String,String>(){
{
    }
  }
;
  EasyMockSupport easyMockSupport=new EasyMockSupport();
  Clusters clusters=easyMockSupport.createNiceMock(Clusters.class);
  final Cluster cluster=easyMockSupport.createNiceMock(Cluster.class);
  Config mockAmsHbaseSecuritySite=easyMockSupport.createNiceMock(Config.class);
  expect(clusters.getClusters()).andReturn(new HashMap<String,Cluster>(){
{
      put("normal",cluster);
    }
  }
).once();
  expect(cluster.getDesiredConfigByType("ams-hbase-security-site")).andReturn(mockAmsHbaseSecuritySite).atLeastOnce();
  expect(mockAmsHbaseSecuritySite.getProperties()).andReturn(oldPropertiesAmsHbaseSecuritySite).times(2);
  Injector injector=easyMockSupport.createNiceMock(Injector.class);
  expect(injector.getInstance(Gson.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(null).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class)).anyTimes();
  replay(injector,clusters,mockAmsHbaseSecuritySite,cluster);
  AmbariManagementControllerImpl controller=createMockBuilder(AmbariManagementControllerImpl.class).addMockedMethod("createConfiguration").addMockedMethod("getClusters",new Class[]{}).addMockedMethod("createConfig").withConstructor(createNiceMock(ActionManager.class),clusters,injector).createNiceMock();
  Injector injector2=easyMockSupport.createNiceMock(Injector.class);
  Capture<Map> propertiesCapture=EasyMock.newCapture();
  expect(injector2.getInstance(AmbariManagementController.class)).andReturn(controller).anyTimes();
  expect(controller.getClusters()).andReturn(clusters).anyTimes();
  expect(controller.createConfig(anyObject(Cluster.class),anyString(),capture(propertiesCapture),anyString(),anyObject(Map.class))).andReturn(createNiceMock(Config.class)).once();
  replay(controller,injector2);
  new UpgradeCatalog221(injector2).updateAMSConfigs();
  easyMockSupport.verifyAll();
  Map<String,String> updatedProperties=propertiesCapture.getValue();
  assertTrue(Maps.difference(newPropertiesAmsHbaseSecuritySite,updatedProperties).areEqual());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  dbAccessor.createIndex(eq("idx_stage_request_id"),eq("stage"),eq("request_id"));
  expectLastCall().once();
  dbAccessor.createIndex(eq("idx_hrc_request_id"),eq("host_role_command"),eq("request_id"));
  expectLastCall().once();
  dbAccessor.createIndex(eq("idx_rsc_request_id"),eq("role_success_criteria"),eq("request_id"));
  expectLastCall().once();
  Capture<DBAccessor.DBColumnInfo> capturedHostGroupComponentProvisionColumn=EasyMock.newCapture();
  dbAccessor.addColumn(eq("hostgroup_component"),capture(capturedHostGroupComponentProvisionColumn));
  expectLastCall().once();
  replay(dbAccessor);
  Module module=new Module(){
    @Override public void configure(    Binder binder){
      binder.bind(DBAccessor.class).toInstance(dbAccessor);
      binder.bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      binder.bind(EntityManager.class).toInstance(entityManager);
    }
  }
;
  Injector injector=Guice.createInjector(module);
  UpgradeCatalog221 upgradeCatalog221=injector.getInstance(UpgradeCatalog221.class);
  upgradeCatalog221.executeDDLUpdates();
  assertEquals("Incorrect column name added","provision_action",capturedHostGroupComponentProvisionColumn.getValue().getName());
  assertNull("Incorrect default value added",capturedHostGroupComponentProvisionColumn.getValue().getDefaultValue());
  assertEquals("Incorrect column type added",String.class,capturedHostGroupComponentProvisionColumn.getValue().getType());
  assertEquals("Incorrect column length added",255,capturedHostGroupComponentProvisionColumn.getValue().getLength().intValue());
  assertTrue("Incorrect column nullable state added",capturedHostGroupComponentProvisionColumn.getValue().isNullable());
  verify(dbAccessor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog230Test </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  final DBAccessor dbAccessor=injector.getInstance(DBAccessor.class);
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getDatabaseUrl()).andReturn(Configuration.JDBC_IN_MEMORY_URL).anyTimes();
  Capture<DBAccessor.DBColumnInfo> columnCapture=EasyMock.newCapture();
  Capture<DBAccessor.DBColumnInfo> columnCapturePermissionLabel=EasyMock.newCapture();
  Capture<List<DBAccessor.DBColumnInfo>> columnsCaptureRoleAuthorization=EasyMock.newCapture();
  Capture<List<DBAccessor.DBColumnInfo>> columnsCapturePermissionRoleAuthorization=EasyMock.newCapture();
  dbAccessor.alterColumn(eq("host_role_command"),capture(columnCapture));
  expectLastCall();
  dbAccessor.addColumn(eq("adminpermission"),capture(columnCapturePermissionLabel));
  expectLastCall();
  dbAccessor.createTable(eq("roleauthorization"),capture(columnsCaptureRoleAuthorization),eq("authorization_id"));
  expectLastCall();
  dbAccessor.createTable(eq("permission_roleauthorization"),capture(columnsCapturePermissionRoleAuthorization),eq("permission_id"),eq("authorization_id"));
  expectLastCall();
  dbAccessor.addFKConstraint("permission_roleauthorization","FK_permission_roleauth_pid","permission_id","adminpermission","permission_id",false);
  expectLastCall();
  dbAccessor.addFKConstraint("permission_roleauthorization","FK_permission_roleauth_aid","authorization_id","roleauthorization","authorization_id",false);
  expectLastCall();
  replayAll();
  AbstractUpgradeCatalog upgradeCatalog=injector.getInstance(UpgradeCatalog230.class);
  Class<?> c=AbstractUpgradeCatalog.class;
  Field f=c.getDeclaredField("configuration");
  f.setAccessible(true);
  f.set(upgradeCatalog,configuration);
  upgradeCatalog.executeDDLUpdates();
  verifyAll();
  assertTrue(columnCapture.getValue().isNullable());
  assertEquals(columnCapturePermissionLabel.getValue().getName(),"permission_label");
  assertEquals(columnCapturePermissionLabel.getValue().getType(),String.class);
  assertEquals(columnCapturePermissionLabel.getValue().getLength(),Integer.valueOf(255));
  assertEquals(columnCapturePermissionLabel.getValue().isNullable(),true);
  List<DBAccessor.DBColumnInfo> columnInfos;
  DBAccessor.DBColumnInfo columnInfo;
  columnInfos=columnsCaptureRoleAuthorization.getValue();
  assertEquals(2,columnInfos.size());
  columnInfo=columnInfos.get(0);
  assertEquals("authorization_id",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(100),columnInfo.getLength());
  columnInfo=columnInfos.get(1);
  assertEquals("authorization_name",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(255),columnInfo.getLength());
  columnInfos=columnsCapturePermissionRoleAuthorization.getValue();
  assertEquals(2,columnInfos.size());
  columnInfo=columnInfos.get(0);
  assertEquals("permission_id",columnInfo.getName());
  assertEquals(Long.class,columnInfo.getType());
  assertEquals(null,columnInfo.getLength());
  columnInfo=columnInfos.get(1);
  assertEquals("authorization_id",columnInfo.getName());
  assertEquals(String.class,columnInfo.getType());
  assertEquals(Integer.valueOf(100),columnInfo.getLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalogTest </h4><pre class="type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigurationProperties() throws Exception {
  AmbariManagementController controller=injector.getInstance(AmbariManagementController.class);
  ClusterRequest r=new ClusterRequest(null,"c1","HDP-0.1",null);
  controller.createCluster(r);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getCluster("c1");
  Assert.assertNotNull(cluster);
  Map<String,String> properties=new HashMap<String,String>(){
{
      put("a","b");
    }
  }
;
  final ClusterRequest cl=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  ConfigurationRequest cr=new ConfigurationRequest();
  cr.setClusterName(cluster.getClusterName());
  cr.setType("global");
  cr.setVersionTag("version1");
  cr.setProperties(properties);
  cl.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(new HashSet<ClusterRequest>(){
{
      add(cl);
    }
  }
,null);
  Config config=cluster.getConfig("global","version1");
  Assert.assertNotNull(config);
  Assert.assertEquals(properties,config.getProperties());
  UpgradeCatalog149 testCatalog=injector.getInstance(UpgradeCatalog149.class);
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","y"),false,false);
  config=cluster.getDesiredConfigByType("global");
  String version=config.getTag();
  Assert.assertNotNull(config);
  Assert.assertNotSame("version1",version);
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("y",config.getProperties().get("x"));
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","z"),true,false);
  config=cluster.getDesiredConfigByType("global");
  Assert.assertNotNull(config);
  Assert.assertNotSame(version,config.getTag());
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("z",config.getProperties().get("x"));
  version=config.getTag();
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","y"),false,false);
  config=cluster.getDesiredConfigByType("global");
  Assert.assertNotNull(config);
  Assert.assertSame(version,config.getTag());
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("z",config.getProperties().get("x"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.CollectionPresentationUtils </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsStringPermutationOfCollection(){
  String input1="{\"foo\":\"bar\",\"foobar\":\"baz\"}";
  String input2="{\"foobar\":\"baz\",\"foo\":\"bar\"}";
  String input3="{\"fooba\":\"baz\",\"foo\":\"bar\"}";
  Set<String> expected=new HashSet<>(Arrays.asList(new String[]{"\"foo\":\"bar\"","\"foobar\":\"baz\""}));
  Assert.assertTrue(CollectionPresentationUtils.isStringPermutationOfCollection(input1,expected,",",1,1));
  Assert.assertTrue(CollectionPresentationUtils.isStringPermutationOfCollection(input2,expected,",",1,1));
  Assert.assertFalse(CollectionPresentationUtils.isStringPermutationOfCollection(input3,expected,",",1,1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.StageUtilsTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterHostInfo() throws Exception {
  final HashMap<String,String> hostAttributes=new HashMap<String,String>(){
{
      put("os_family","redhat");
      put("os_release_version","5.9");
    }
  }
;
  final Clusters clusters=createNiceMock(Clusters.class);
  List<Host> hosts=new ArrayList<Host>();
  List<String> hostNames=new ArrayList<String>();
  List<Integer> pingPorts=Arrays.asList(StageUtils.DEFAULT_PING_PORT,StageUtils.DEFAULT_PING_PORT,StageUtils.DEFAULT_PING_PORT,8671,8671,null,8672,8672,null,8673);
  for (int i=0; i < 10; i++) {
    String hostname=String.format("h%d",i);
    Host host=createNiceMock(Host.class);
    expect(host.getHostName()).andReturn(hostname).anyTimes();
    expect(host.getHostAttributes()).andReturn(hostAttributes).anyTimes();
    expect(host.getCurrentPingPort()).andReturn(pingPorts.get(i)).anyTimes();
    hosts.add(host);
    hostNames.add(hostname);
    expect(clusters.getHost(hostname)).andReturn(host).anyTimes();
  }
  final ServiceComponentHost nnh0ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(nnh0ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost snnh1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(snnh1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh0ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh0ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh2ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh2ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh8ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh8ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost dnh9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(dnh9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbm5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbm5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs8ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs8ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost hbrs9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(hbrs9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrjt5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrjt5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt1ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt1ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt2ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt2ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.DECOMMISSIONED).anyTimes();
  final ServiceComponentHost mrtt3ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt3ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.DECOMMISSIONED).anyTimes();
  final ServiceComponentHost mrtt4ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt4ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt5ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt5ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost mrtt9ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(mrtt9ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  final ServiceComponentHost nns7ServiceComponentHost=createMock(ServiceComponentHost.class);
  expect(nns7ServiceComponentHost.getComponentAdminState()).andReturn(HostComponentAdminState.INSERVICE).anyTimes();
  Map<String,Collection<String>> projectedTopology=new HashMap<String,Collection<String>>();
  final HashMap<String,ServiceComponentHost> nnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h0",nnh0ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"NAMENODE",nnServiceComponentHosts.keySet());
  final HashMap<String,ServiceComponentHost> snnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",snnh1ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"SECONDARY_NAMENODE",snnServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> dnServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h0",dnh0ServiceComponentHost);
      put("h1",dnh1ServiceComponentHost);
      put("h2",dnh2ServiceComponentHost);
      put("h3",dnh3ServiceComponentHost);
      put("h5",dnh5ServiceComponentHost);
      put("h7",dnh7ServiceComponentHost);
      put("h8",dnh8ServiceComponentHost);
      put("h9",dnh9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"DATANODE",dnServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> hbmServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h5",hbm5ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"HBASE_MASTER",hbmServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> hbrsServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",hbrs1ServiceComponentHost);
      put("h3",hbrs3ServiceComponentHost);
      put("h5",hbrs5ServiceComponentHost);
      put("h8",hbrs8ServiceComponentHost);
      put("h9",hbrs9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"HBASE_REGIONSERVER",hbrsServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> mrjtServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h5",mrjt5ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"JOBTRACKER",mrjtServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> mrttServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h1",mrtt1ServiceComponentHost);
      put("h2",mrtt2ServiceComponentHost);
      put("h3",mrtt3ServiceComponentHost);
      put("h4",mrtt4ServiceComponentHost);
      put("h5",mrtt5ServiceComponentHost);
      put("h7",mrtt7ServiceComponentHost);
      put("h9",mrtt9ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"TASKTRACKER",mrttServiceComponentHosts.keySet());
  final Map<String,ServiceComponentHost> nnsServiceComponentHosts=new HashMap<String,ServiceComponentHost>(){
{
      put("h7",nns7ServiceComponentHost);
    }
  }
;
  insertTopology(projectedTopology,"NONAME_SERVER",nnsServiceComponentHosts.keySet());
  final ServiceComponent nnComponent=createMock(ServiceComponent.class);
  expect(nnComponent.getName()).andReturn("NAMENODE").anyTimes();
  expect(nnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return nnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(nnComponent.getServiceComponentHosts()).andReturn(nnServiceComponentHosts).anyTimes();
  expect(nnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent snnComponent=createMock(ServiceComponent.class);
  expect(snnComponent.getName()).andReturn("SECONDARY_NAMENODE").anyTimes();
  expect(snnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return snnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(snnComponent.getServiceComponentHosts()).andReturn(snnServiceComponentHosts).anyTimes();
  expect(snnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent dnComponent=createMock(ServiceComponent.class);
  expect(dnComponent.getName()).andReturn("DATANODE").anyTimes();
  expect(dnComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return dnServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(dnComponent.getServiceComponentHosts()).andReturn(dnServiceComponentHosts).anyTimes();
  expect(dnComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent hbmComponent=createMock(ServiceComponent.class);
  expect(hbmComponent.getName()).andReturn("HBASE_MASTER").anyTimes();
  expect(hbmComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return hbmServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(hbmComponent.getServiceComponentHosts()).andReturn(hbmServiceComponentHosts).anyTimes();
  expect(hbmComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent hbrsComponent=createMock(ServiceComponent.class);
  expect(hbrsComponent.getName()).andReturn("HBASE_REGIONSERVER").anyTimes();
  expect(hbrsComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return hbrsServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  Map<String,ServiceComponentHost> hbrsHosts=Maps.filterKeys(hbrsServiceComponentHosts,new Predicate<String>(){
    @Override public boolean apply(    String s){
      return s.equals("h1");
    }
  }
);
  expect(hbrsComponent.getServiceComponentHosts()).andReturn(hbrsServiceComponentHosts).anyTimes();
  expect(hbrsComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent mrjtComponent=createMock(ServiceComponent.class);
  expect(mrjtComponent.getName()).andReturn("JOBTRACKER").anyTimes();
  expect(mrjtComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return mrjtServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(mrjtComponent.getServiceComponentHosts()).andReturn(mrjtServiceComponentHosts).anyTimes();
  expect(mrjtComponent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent mrttCompomnent=createMock(ServiceComponent.class);
  expect(mrttCompomnent.getName()).andReturn("TASKTRACKER").anyTimes();
  expect(mrttCompomnent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return mrttServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(mrttCompomnent.getServiceComponentHosts()).andReturn(mrttServiceComponentHosts).anyTimes();
  expect(mrttCompomnent.isClientComponent()).andReturn(false).anyTimes();
  final ServiceComponent nnsComponent=createMock(ServiceComponent.class);
  expect(nnsComponent.getName()).andReturn("NONAME_SERVER").anyTimes();
  expect(nnsComponent.getServiceComponentHost(anyObject(String.class))).andAnswer(new IAnswer<ServiceComponentHost>(){
    @Override public ServiceComponentHost answer() throws Throwable {
      Object[] args=getCurrentArguments();
      return nnsServiceComponentHosts.get((String)args[0]);
    }
  }
).anyTimes();
  expect(nnsComponent.getServiceComponentHosts()).andReturn(nnsServiceComponentHosts).anyTimes();
  expect(nnsComponent.isClientComponent()).andReturn(false).anyTimes();
  final Service hdfsService=createMock(Service.class);
  expect(hdfsService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("NAMENODE",nnComponent);
      put("SECONDARY_NAMENODE",snnComponent);
      put("DATANODE",dnComponent);
    }
  }
).anyTimes();
  final Service hbaseService=createMock(Service.class);
  expect(hbaseService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("HBASE_MASTER",hbmComponent);
      put("HBASE_REGIONSERVER",hbrsComponent);
    }
  }
).anyTimes();
  final Service mrService=createMock(Service.class);
  expect(mrService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("JOBTRACKER",mrjtComponent);
      put("TASKTRACKER",mrttCompomnent);
    }
  }
).anyTimes();
  final Service nnService=createMock(Service.class);
  expect(nnService.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>(){
{
      put("NONAME_SERVER",nnsComponent);
    }
  }
).anyTimes();
  Cluster cluster=createMock(Cluster.class);
  expect(cluster.getHosts()).andReturn(hosts).anyTimes();
  expect(cluster.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("HDFS",hdfsService);
      put("HBASE",hbaseService);
      put("MAPREDUCE",mrService);
      put("NONAME",nnService);
    }
  }
).anyTimes();
  final TopologyManager topologyManager=injector.getInstance(TopologyManager.class);
  topologyManager.getPendingHostComponents();
  expectLastCall().andReturn(projectedTopology).once();
  replayAll();
  injector.getInstance(AmbariMetaInfo.class).init();
  Map<String,Set<String>> info=StageUtils.getClusterHostInfo(cluster);
  verifyAll();
  Set<String> allHosts=info.get(StageUtils.HOSTS_LIST);
  assertEquals(hosts.size(),allHosts.size());
  for (  Host host : hosts) {
    assertTrue(allHosts.contains(host.getHostName()));
  }
  checkServiceHostIndexes(info,"DATANODE","slave_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"NAMENODE","namenode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"SECONDARY_NAMENODE","snamenode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"HBASE_MASTER","hbase_master_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"HBASE_REGIONSERVER","hbase_rs_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"JOBTRACKER","jtnode_host",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"TASKTRACKER","mapred_tt_hosts",projectedTopology,hostNames);
  checkServiceHostIndexes(info,"NONAME_SERVER","noname_server_hosts",projectedTopology,hostNames);
  Set<String> actualPingPorts=info.get(StageUtils.PORTS);
  if (pingPorts.contains(null)) {
    assertEquals(new HashSet<Integer>(pingPorts).size(),actualPingPorts.size() + 1);
  }
 else {
    assertEquals(new HashSet<Integer>(pingPorts).size(),actualPingPorts.size());
  }
  List<Integer> pingPortsActual=getRangeMappedDecompressedSet(actualPingPorts);
  List<Integer> reindexedPorts=getReindexedList(pingPortsActual,new ArrayList<String>(allHosts),hostNames);
  List<Integer> expectedPingPorts=new ArrayList<Integer>(pingPorts);
  for (int i=0; i < expectedPingPorts.size(); i++) {
    if (expectedPingPorts.get(i) == null) {
      expectedPingPorts.set(i,StageUtils.DEFAULT_PING_PORT);
    }
  }
  assertEquals(expectedPingPorts,reindexedPorts);
  assertTrue(info.containsKey("decom_tt_hosts"));
  Set<String> decommissionedHosts=info.get("decom_tt_hosts");
  assertEquals(2,decommissionedHosts.toString().split(",").length);
  assertTrue(info.containsKey(StageUtils.AMBARI_SERVER_HOST));
  Set<String> serverHost=info.get(StageUtils.AMBARI_SERVER_HOST);
  assertEquals(1,serverHost.size());
  assertEquals(StageUtils.getHostName(),serverHost.iterator().next());
  assertTrue(getDecompressedSet(info.get("hbase_rs_hosts")).contains(9));
  info=StageUtils.substituteHostIndexes(info);
  checkServiceHostNames(info,"DATANODE","slave_hosts",projectedTopology);
  checkServiceHostNames(info,"NAMENODE","namenode_host",projectedTopology);
  checkServiceHostNames(info,"SECONDARY_NAMENODE","snamenode_host",projectedTopology);
  checkServiceHostNames(info,"HBASE_MASTER","hbase_master_hosts",projectedTopology);
  checkServiceHostNames(info,"HBASE_REGIONSERVER","hbase_rs_hosts",projectedTopology);
  checkServiceHostNames(info,"JOBTRACKER","jtnode_host",projectedTopology);
  checkServiceHostNames(info,"TASKTRACKER","mapred_tt_hosts",projectedTopology);
  checkServiceHostNames(info,"NONAME_SERVER","noname_server_hosts",projectedTopology);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestParallel </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration exceptions
 * @throws Exception
 */
@Test public void testParallelForLoopIterationExceptions() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        throw new RuntimeException("Ignore this exception");
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests nested {@link org.apache.ambari.server.utils.Parallel} forLoop
 * @throws Exception
 */
@Test public void testNestedParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final ParallelLoopResult<Integer>[] innerLoopResults=new ParallelLoopResult[input.size()];
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    final Integer in1){
      int sq=in1 * in1;
      ParallelLoopResult<Integer> innerLoopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
        @Override public Integer run(        Integer in2){
          return in1 * in2;
        }
      }
);
      innerLoopResults[in1]=innerLoopResult;
      return in1 * in1;
    }
  }
);
  Assert.assertNotNull(loopResult);
  Assert.assertTrue(loopResult.getIsCompleted());
  List<Integer> output=loopResult.getResult();
  Assert.assertNotNull(output);
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
    ParallelLoopResult<Integer> innerLoopResult=innerLoopResults[i];
    Assert.assertNotNull(innerLoopResult);
    Assert.assertTrue(innerLoopResult.getIsCompleted());
    List<Integer> innerOutput=innerLoopResult.getResult();
    Assert.assertNotNull(innerOutput);
    Assert.assertEquals(input.size(),innerOutput.size());
    for (int j=0; j < input.size(); j++) {
      Assert.assertEquals(i * j,(int)innerOutput.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop base cases.
 * @throws Exception
 */
@Test public void testParallelForLoopBaseCases() throws Exception {
  ParallelLoopResult<Integer> nullLoopResult=Parallel.forLoop(null,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(nullLoopResult.getIsCompleted());
  Assert.assertTrue(nullLoopResult.getResult().isEmpty());
  ParallelLoopResult<Integer> emptyLoopResult=Parallel.forLoop(new ArrayList<Integer>(),new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(emptyLoopResult.getIsCompleted());
  Assert.assertTrue(emptyLoopResult.getResult().isEmpty());
  ParallelLoopResult<Integer> singleElementLoopResult=Parallel.forLoop(Collections.singletonList(7),new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(singleElementLoopResult.getIsCompleted());
  List<Integer> singleElementList=singleElementLoopResult.getResult();
  Assert.assertTrue(singleElementLoopResult.getIsCompleted());
  Assert.assertFalse(singleElementList.isEmpty());
  Assert.assertEquals(1,singleElementList.size());
  Assert.assertNotNull(singleElementList.get(0));
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests Parallel.forLoop
 * @throws Exception
 */
@Test public void testParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      return in1 * in1;
    }
  }
);
  Assert.assertTrue(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration failures
 * @throws Exception
 */
@Test public void testParallelForLoopIterationFailures() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        return null;
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestShellCommandUtil </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHideOpenSslPassword(){
  String command_pass="openssl ca -config ca.config -in agent_hostname1.csr -out " + "agent_hostname1.crt -batch -passin pass:1234 -keyfile ca.key -cert ca.crt";
  String command_key="openssl ca -create_serial -out /var/lib/ambari-server/keys/ca.crt -days 365 -keyfile /var/lib/ambari-server/keys/ca.key " + "-key 1234 -selfsign -extensions jdk7_ca " + "-config /var/lib/ambari-server/keys/ca.config -batch "+ "-infiles /var/lib/ambari-server/keys/ca.csr";
  assertFalse(ShellCommandUtil.hideOpenSslPassword(command_pass).contains("1234"));
  assertFalse(ShellCommandUtil.hideOpenSslPassword(command_key).contains("1234"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testOSDetection() throws Exception {
  assertTrue(ShellCommandUtil.LINUX ^ ShellCommandUtil.WINDOWS ^ ShellCommandUtil.MAC);
  assertTrue(ShellCommandUtil.LINUX || ShellCommandUtil.MAC == ShellCommandUtil.UNIX_LIKE);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRunCommand() throws Exception {
  ShellCommandUtil.Result result=null;
  if (ShellCommandUtil.LINUX) {
    result=ShellCommandUtil.runCommand(new String[]{"echo","dummy"});
    assertEquals(0,result.getExitCode());
    assertEquals("dummy\n",result.getStdout());
    assertEquals("",result.getStderr());
    assertTrue(result.isSuccessful());
    result=ShellCommandUtil.runCommand(new String[]{"false"});
    assertEquals(1,result.getExitCode());
    assertFalse(result.isSuccessful());
  }
 else {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestVersionUtils </h4><pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVersionCompareSuccess(){
  Assert.assertTrue(VersionUtils.areVersionsEqual("1.2.3","1.2.3",false));
  Assert.assertTrue(VersionUtils.areVersionsEqual("1.2.3","1.2.3",true));
  Assert.assertTrue(VersionUtils.areVersionsEqual("","",true));
  Assert.assertTrue(VersionUtils.areVersionsEqual(null,null,true));
  Assert.assertTrue(VersionUtils.areVersionsEqual(BootStrapImpl.DEV_VERSION,"1.2.3",false));
  Assert.assertTrue(VersionUtils.areVersionsEqual(BootStrapImpl.DEV_VERSION,"",true));
  Assert.assertTrue(VersionUtils.areVersionsEqual(BootStrapImpl.DEV_VERSION,null,true));
  Assert.assertFalse(VersionUtils.areVersionsEqual("1.2.3.1","1.2.3",false));
  Assert.assertFalse(VersionUtils.areVersionsEqual("2.1.3","1.2.3",false));
  Assert.assertFalse(VersionUtils.areVersionsEqual("1.2.3.1","1.2.3",true));
  Assert.assertFalse(VersionUtils.areVersionsEqual("2.1.3","1.2.3",true));
  Assert.assertFalse(VersionUtils.areVersionsEqual("","1.2.3",true));
  Assert.assertFalse(VersionUtils.areVersionsEqual("",null,true));
  Assert.assertFalse(VersionUtils.areVersionsEqual(null,"",true));
  Assert.assertFalse(VersionUtils.areVersionsEqual(null,"1.2.3",true));
  Assert.assertEquals(-1,VersionUtils.compareVersions("1.2.3","1.2.4"));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.4","1.2.3"));
  Assert.assertEquals(0,VersionUtils.compareVersions("1.2.3","1.2.3"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("1.2.3","1.2.4",3));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.4","1.2.3",3));
  Assert.assertEquals(0,VersionUtils.compareVersions("1.2.3","1.2.3",3));
  Assert.assertEquals(-1,VersionUtils.compareVersions("1.2.3.9","1.2.4.6",3));
  Assert.assertEquals(-1,VersionUtils.compareVersions("1.2.3","1.2.4.6",3));
  Assert.assertEquals(-1,VersionUtils.compareVersions("1.2","1.2.4.6",3));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.4.8","1.2.3.6.7",3));
  Assert.assertEquals(0,VersionUtils.compareVersions("1.2.3","1.2.3.4",3));
  Assert.assertEquals(0,VersionUtils.compareVersions("1.2.3.6.7","1.2.3.4",3));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.3.6.7","1.2.3.4",4));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.3.6.7\n","1.2.3.4\n",4));
  Assert.assertEquals(1,VersionUtils.compareVersions("1.2.3.1","1.2.3",true));
  Assert.assertEquals(1,VersionUtils.compareVersions("2.1.3","1.2.3",true));
  Assert.assertEquals(-1,VersionUtils.compareVersions("","1.2.3",true));
  Assert.assertEquals(1,VersionUtils.compareVersions("",null,true));
  Assert.assertEquals(-1,VersionUtils.compareVersions(null,"",true));
  Assert.assertEquals(-1,VersionUtils.compareVersions(null,"1.2.3",true));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackVersions(){
  Assert.assertTrue(VersionUtils.areVersionsEqual("2.2.0.0","2.2.0.0",false));
  Assert.assertTrue(VersionUtils.areVersionsEqual("2.2.0.0-111","2.2.0.0-999",false));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.0.0","2.2.0.1"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.0.0","2.2.0.10"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.2.0.20","2.2.2.145"));
  Assert.assertEquals(1,VersionUtils.compareVersions("2.2.0.1","2.2.0.0"));
  Assert.assertEquals(1,VersionUtils.compareVersions("2.2.0.10","2.2.0.0"));
  Assert.assertEquals(1,VersionUtils.compareVersions("2.2.2.145","2.2.2.20"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.0.0-200","2.2.0.1-100"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.0.0-101","2.2.0.10-20"));
  Assert.assertEquals(-1,VersionUtils.compareVersions("2.2.2.0.20-996","2.2.2.145-846"));
  Assert.assertEquals(0,VersionUtils.compareVersions("2.2","2.2.VER"));
  Assert.assertEquals(0,VersionUtils.compareVersions("2.2.VAR","2.2.VER"));
  Assert.assertEquals(0,VersionUtils.compareVersions("2.2.3","2.2.3.VER1.V"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.DefaultMaskerTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMask() throws Exception {
  final String source="unmasked";
  final String masked=masker.mask(source);
  Assert.assertNotNull(masked);
  Assert.assertTrue(masked.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewExtractorTest </h4><pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEnsureExtractedArchiveDirectory() throws Exception {
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  expect(extractedArchiveDir.exists()).andReturn(true);
  replay(extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,viewJarFile,jarEntry,fos,configuration,viewDir,fileEntry,viewDAO);
  ViewExtractor viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,viewJarFile,jarEntry,fos,configuration,viewDir,fileEntry,viewDAO);
  reset(extractedArchiveDir);
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(true);
  replay(extractedArchiveDir);
  viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertTrue(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir);
  reset(extractedArchiveDir);
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(false);
  replay(extractedArchiveDir);
  viewExtractor=getViewExtractor(viewDefinition);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertFalse(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work"));
  }
 else {
    Assert.assertFalse(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work"));
  }
  verify(extractedArchiveDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewRegistryTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCheckViewVersions(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  ViewConfig config=createNiceMock(ViewConfig.class);
  expect(viewEntity.getConfiguration()).andReturn(config).anyTimes();
  expect(config.getMinAmbariVersion()).andReturn(null);
  expect(config.getMaxAmbariVersion()).andReturn(null);
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("1.5");
  expect(config.getMinAmbariVersion()).andReturn("2.5");
  expect(config.getMinAmbariVersion()).andReturn(null);
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn(null);
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("*");
  expect(config.getMinAmbariVersion()).andReturn("*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("2.*");
  expect(config.getMinAmbariVersion()).andReturn("1.*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("2.1.*");
  expect(config.getMinAmbariVersion()).andReturn("1.5.*");
  expect(config.getMaxAmbariVersion()).andReturn("3.0.0");
  expect(config.getMinAmbariVersion()).andReturn("1.0.0");
  expect(config.getMaxAmbariVersion()).andReturn("1.9.9.*");
  expect(config.getMinAmbariVersion()).andReturn("2.0.0.1.*");
  replay(viewEntity,config);
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertTrue(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  Assert.assertFalse(registry.checkViewVersions(viewEntity,"2.0.0"));
  verify(viewEntity,config);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubResourceDefinitions() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  viewDefinition.setConfiguration(config);
  registry.setupViewDefinition(viewDefinition,getClass().getClassLoader());
  Set<SubResourceDefinition> subResourceDefinitions=registry.getSubResourceDefinitions(viewDefinition.getCommonName(),viewDefinition.getVersion());
  Assert.assertEquals(3,subResourceDefinitions.size());
  Set<String> names=new HashSet<String>();
  for (  SubResourceDefinition definition : subResourceDefinitions) {
    names.add(definition.getType().name());
  }
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/resources"));
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/resource"));
  Assert.assertTrue(names.contains("MY_VIEW{1.0.0}/subresource"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForAdmin(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  replay(configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Assert.assertTrue(registry.includeDefinition(viewEntity));
  verify(configuration);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForUserHasAccess(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  ViewInstanceEntity instanceEntity=createNiceMock(ViewInstanceEntity.class);
  ResourceEntity resourceEntity=createNiceMock(ResourceEntity.class);
  ResourceTypeEntity resourceTypeEntity=createNiceMock(ResourceTypeEntity.class);
  Collection<ViewInstanceEntity> instances=new ArrayList<ViewInstanceEntity>();
  instances.add(instanceEntity);
  expect(viewEntity.getInstances()).andReturn(instances);
  expect(instanceEntity.getResource()).andReturn(resourceEntity);
  expect(resourceEntity.getId()).andReturn(54L).anyTimes();
  expect(resourceEntity.getResourceType()).andReturn(resourceTypeEntity).anyTimes();
  expect(resourceTypeEntity.getId()).andReturn(ResourceType.VIEW.getId()).anyTimes();
  expect(resourceTypeEntity.getName()).andReturn(ResourceType.VIEW.name()).anyTimes();
  replay(viewEntity,instanceEntity,resourceEntity,resourceTypeEntity,configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createViewUser(resourceEntity.getId()));
  Assert.assertTrue(registry.includeDefinition(viewEntity));
  verify(viewEntity,instanceEntity,resourceEntity,resourceTypeEntity,configuration);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallViewInstance_validatorFail() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  Validator validator=createNiceMock(Validator.class);
  ValidationResult result=createNiceMock(ValidationResult.class);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  viewEntity.setValidator(validator);
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(validator.validateInstance(viewInstanceEntity,Validator.ValidationContext.PRE_CREATE)).andReturn(result).anyTimes();
  expect(result.isValid()).andReturn(false).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
  registry.addDefinition(viewEntity);
  try {
    registry.installViewInstance(viewInstanceEntity);
    Assert.fail("expected a ValidationException");
  }
 catch (  ValidationException e) {
  }
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertTrue(viewInstanceDefinitions.isEmpty());
  verify(viewDAO,viewInstanceDAO,securityHelper,handlerList,validator,result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIncludeDefinitionForUserNoInstances(){
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  expect(viewEntity.getInstances()).andReturn(Collections.<ViewInstanceEntity>emptyList()).anyTimes();
  replay(viewEntity,configuration);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createViewUser(1L));
  Assert.assertFalse(registry.includeDefinition(viewEntity));
  verify(viewEntity,configuration);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateViewInstance() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(XML_VALID_INSTANCE);
  ViewEntity viewEntity=getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewInstanceEntity viewInstanceEntity=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  ViewInstanceEntity updateInstance=getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  expect(viewInstanceDAO.findByName("MY_VIEW{1.0.0}",viewInstanceEntity.getInstanceName())).andReturn(viewInstanceEntity).anyTimes();
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.addDefinition(viewEntity);
  registry.installViewInstance(viewInstanceEntity);
  Assert.assertTrue(viewInstanceEntity.isVisible());
  updateInstance.setLabel("new label");
  updateInstance.setDescription("new description");
  updateInstance.setVisible(false);
  registry.updateViewInstance(updateInstance);
  Collection<ViewInstanceEntity> viewInstanceDefinitions=registry.getInstanceDefinitions(viewEntity);
  Assert.assertEquals(1,viewInstanceDefinitions.size());
  ViewInstanceEntity instanceEntity=viewInstanceDefinitions.iterator().next();
  Assert.assertEquals("v2-1",instanceEntity.getProperty("p2").getValue());
  Assert.assertEquals("new label",instanceEntity.getLabel());
  Assert.assertEquals("new description",instanceEntity.getDescription());
  Assert.assertFalse(instanceEntity.isVisible());
  Assert.assertEquals(viewInstanceEntity,viewInstanceDefinitions.iterator().next());
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExtractViewArchive() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  InputStream is=createMock(InputStream.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ViewExtractor viewExtractor=createMock(ViewExtractor.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",viewArchive);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF\\lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",viewArchive);
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views");
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views");
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  Capture<ViewEntity> viewEntityCapture=new Capture<ViewEntity>();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewExtractor.ensureExtractedArchiveDirectory("\\var\\lib\\ambari-server\\resources\\views\\work")).andReturn(true);
  }
 else {
    expect(viewExtractor.ensureExtractedArchiveDirectory("/var/lib/ambari-server/resources/views/work")).andReturn(true);
  }
  expect(viewExtractor.extractViewArchive(capture(viewEntityCapture),eq(viewArchive),eq(archiveDir))).andReturn(null);
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  TestViewModule module=new TestViewModule(viewExtractor,archiveUtility,configuration);
  if (System.getProperty("os.name").contains("Windows")) {
    Assert.assertTrue(ViewRegistry.extractViewArchive("\\var\\lib\\ambari-server\\resources\\views\\my_view-1.0.0.jar",module,true));
  }
 else {
    Assert.assertTrue(ViewRegistry.extractViewArchive("/var/lib/ambari-server/resources/views/my_view-1.0.0.jar",module,true));
  }
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,is,fos,viewExtractor,resourceDAO,viewDAO,viewInstanceDAO);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourceProviders() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig();
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  viewDefinition.setConfiguration(config);
  registry.setupViewDefinition(viewDefinition,getClass().getClassLoader());
  Map<Resource.Type,ResourceProvider> providerMap=registry.getResourceProviders();
  Assert.assertEquals(3,providerMap.size());
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/resource")));
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/subresource")));
  Assert.assertTrue(providerMap.containsKey(Resource.Type.valueOf("MY_VIEW{1.0.0}/resources")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewSubResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Properties properties=new Properties();
  properties.put("p1","v1");
  Configuration ambariConfig=new Configuration(properties);
  ViewConfig config=ViewConfigTest.getConfig(xml);
  ViewEntity viewEntity=ViewRegistryTest.getViewEntity(config,ambariConfig,getClass().getClassLoader(),"");
  ViewRegistryTest.getViewInstanceEntity(viewEntity,config.getInstances().get(0));
  Map<Resource.Type,ViewSubResourceDefinition> resourceDefinitions=viewEntity.getResourceDefinitions();
  Assert.assertEquals(1,resourceDefinitions.size());
  Resource.Type type=resourceDefinitions.keySet().iterator().next();
  ViewSubResourceProvider viewSubResourceProvider=new ViewSubResourceProvider(type,MyResource.class,"id",viewEntity);
  Request request=PropertyHelper.getReadRequest("id","properties","metrics/myMetric");
  Predicate predicate=new AlwaysPredicate();
  Set<Resource> resources=viewSubResourceProvider.getResources(request,predicate);
  Assert.assertEquals(2,resources.size());
  predicate=new PredicateBuilder().property("metrics/myMetric").greaterThan(1).toPredicate();
  resources=viewSubResourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertTrue(((Integer)resources.iterator().next().getPropertyValue("metrics/myMetric")) > 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewURLStreamProviderTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProxyRestriction() throws Exception {
  ViewURLStreamProvider viewURLStreamProvider=new ViewURLStreamProvider(null,null);
  Properties ambariProperties=new Properties();
  Configuration configuration=new Configuration(ambariProperties);
  Assert.assertEquals(Configuration.PROXY_ALLOWED_HOST_PORTS_DEFAULT,configuration.getConfigsMap().get(Configuration.PROXY_ALLOWED_HOST_PORTS));
  ViewURLStreamProvider.HostPortRestrictionHandler hprh=viewURLStreamProvider.new HostPortRestrictionHandler(configuration.getProperty(Configuration.PROXY_ALLOWED_HOST_PORTS));
  Assert.assertFalse(hprh.proxyCallRestricted());
  Assert.assertTrue(hprh.allowProxy("host1.com",null));
  Assert.assertTrue(hprh.allowProxy(null,null));
  Assert.assertTrue(hprh.allowProxy("host1.com"," "));
  Assert.assertTrue(hprh.allowProxy("host1.com "," "));
  Assert.assertTrue(hprh.allowProxy(" host1.com ","8080"));
  ambariProperties=new Properties();
  ambariProperties.setProperty(Configuration.PROXY_ALLOWED_HOST_PORTS,"");
  configuration=new Configuration(ambariProperties);
  hprh=viewURLStreamProvider.new HostPortRestrictionHandler(configuration.getProperty(Configuration.PROXY_ALLOWED_HOST_PORTS));
  Assert.assertFalse(hprh.proxyCallRestricted());
  Assert.assertTrue(hprh.allowProxy("host1.com",null));
  Assert.assertTrue(hprh.allowProxy(null,null));
  Assert.assertTrue(hprh.allowProxy("host1.com"," "));
  Assert.assertTrue(hprh.allowProxy("host1.com "," "));
  Assert.assertTrue(hprh.allowProxy(" host1.com ","8080"));
  ambariProperties=new Properties();
  ambariProperties.setProperty(Configuration.PROXY_ALLOWED_HOST_PORTS,"host1.com:*");
  configuration=new Configuration(ambariProperties);
  hprh=viewURLStreamProvider.new HostPortRestrictionHandler(configuration.getProperty(Configuration.PROXY_ALLOWED_HOST_PORTS));
  Assert.assertTrue(hprh.proxyCallRestricted());
  Assert.assertTrue(hprh.allowProxy("host1.com",null));
  Assert.assertTrue(hprh.allowProxy(null,null));
  Assert.assertTrue(hprh.allowProxy("host1.com","20"));
  Assert.assertFalse(hprh.allowProxy("host2.com "," "));
  Assert.assertFalse(hprh.allowProxy(" host2.com ","8080"));
  ambariProperties=new Properties();
  ambariProperties.setProperty(Configuration.PROXY_ALLOWED_HOST_PORTS," host1.com:80 ,host2.org:443, host2.org:22");
  configuration=new Configuration(ambariProperties);
  hprh=viewURLStreamProvider.new HostPortRestrictionHandler(configuration.getProperty(Configuration.PROXY_ALLOWED_HOST_PORTS));
  Assert.assertTrue(hprh.proxyCallRestricted());
  Assert.assertTrue(hprh.allowProxy("host1.com","80"));
  Assert.assertFalse(hprh.allowProxy("host1.com","20"));
  Assert.assertFalse(hprh.allowProxy("host2.org","404"));
  Assert.assertFalse(hprh.allowProxy("host2.com","22"));
  ViewContext viewContext=createNiceMock(ViewContext.class);
  expect(viewContext.getAmbariProperty(anyObject(String.class))).andReturn(" host1.com:80 ,host2.org:443, host2.org:22");
  replay(viewContext);
  viewURLStreamProvider=new ViewURLStreamProvider(viewContext,null);
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("http://host1.com/tt"));
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("https://host2.org/tt"));
  Assert.assertFalse(viewURLStreamProvider.isProxyCallAllowed("https://host2.org:444/tt"));
  viewContext=createNiceMock(ViewContext.class);
  expect(viewContext.getAmbariProperty(anyObject(String.class))).andReturn("c6401.ambari.apache.org:8088");
  replay(viewContext);
  viewURLStreamProvider=new ViewURLStreamProvider(viewContext,null);
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("http://c6401.ambari.apache.org:8088/ws/v1/cluster/get-node-labels"));
  viewContext=createNiceMock(ViewContext.class);
  expect(viewContext.getAmbariProperty(anyObject(String.class))).andReturn("*:8088");
  replay(viewContext);
  viewURLStreamProvider=new ViewURLStreamProvider(viewContext,null);
  Assert.assertFalse(viewURLStreamProvider.isProxyCallAllowed("http://c6401.ambari.apache.org:8088/ws/v1/cluster/get-node-labels"));
  viewContext=createNiceMock(ViewContext.class);
  expect(viewContext.getAmbariProperty(anyObject(String.class))).andReturn("c6401.ambari.apache.org:*");
  replay(viewContext);
  viewURLStreamProvider=new ViewURLStreamProvider(viewContext,null);
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("http://c6401.ambari.apache.org:8088/ws/v1/cluster/get-node-labels"));
  viewContext=createNiceMock(ViewContext.class);
  expect(viewContext.getAmbariProperty(anyObject(String.class))).andReturn("c6401.ambari.apache.org:80,c6401.ambari.apache.org:443");
  replay(viewContext);
  viewURLStreamProvider=new ViewURLStreamProvider(viewContext,null);
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("http://c6401.ambari.apache.org/ws/v1/cluster/get-node-labels"));
  Assert.assertTrue(viewURLStreamProvider.isProxyCallAllowed("https://c6401.ambari.apache.org/ws/v1/cluster/get-node-labels"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.AutoInstanceConfigTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServices() throws Exception {
  AutoInstanceConfig config=getAutoInstanceConfigs(VIEW_XML);
  List<String> serviceNames=config.getServices();
  assertEquals(2,serviceNames.size());
  assertTrue(serviceNames.contains("HIVE"));
  assertTrue(serviceNames.contains("HDFS"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.InstanceConfigTest </h4><pre class="type-4 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsVisible() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs(xml_visible);
  Assert.assertEquals(3,instances.size());
  Assert.assertTrue(instances.get(0).isVisible());
  Assert.assertFalse(instances.get(1).isVisible());
  Assert.assertTrue(instances.get(2).isVisible());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.PersistenceConfigTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntities() throws Exception {
  ViewConfig config=ViewConfigTest.getConfig(xml);
  PersistenceConfig persistenceConfig=config.getPersistence();
  Assert.assertEquals(2,persistenceConfig.getEntities().size());
  config=ViewConfigTest.getConfig(xml_no_entities);
  persistenceConfig=config.getPersistence();
  Assert.assertTrue(persistenceConfig.getEntities().isEmpty());
  config=ViewConfigTest.getConfig(xml_no_persistence);
  persistenceConfig=config.getPersistence();
  Assert.assertTrue(persistenceConfig.getEntities().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.PropertyConfigTest </h4><pre class="type-13 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetValue() throws Exception {
  List<InstanceConfig> instanceConfigs=InstanceConfigTest.getInstanceConfigs();
  for (  InstanceConfig instanceConfig : instanceConfigs) {
    List<PropertyConfig> propertyConfigs=instanceConfig.getProperties();
    Assert.assertTrue(propertyConfigs.size() <= 2);
    Assert.assertTrue(propertyConfigs.get(0).getValue().startsWith("v1-"));
    if (propertyConfigs.size() == 2) {
      Assert.assertTrue(propertyConfigs.get(1).getValue().startsWith("v2-"));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKey() throws Exception {
  List<InstanceConfig> instanceConfigs=InstanceConfigTest.getInstanceConfigs();
  for (  InstanceConfig instanceConfig : instanceConfigs) {
    List<PropertyConfig> propertyConfigs=instanceConfig.getProperties();
    Assert.assertTrue(propertyConfigs.size() <= 2);
    Assert.assertEquals("p1",propertyConfigs.get(0).getKey());
    if (propertyConfigs.size() == 2) {
      Assert.assertEquals("p2",propertyConfigs.get(1).getKey());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.ResourceConfigTest </h4><pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourceClass() throws Exception {
  List<ResourceConfig> resourceConfigs=getResourceConfigs();
  Assert.assertEquals(2,resourceConfigs.size());
  Assert.assertTrue(resourceConfigs.get(0).getServiceClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResourceService.class));
  Assert.assertTrue(resourceConfigs.get(1).getServiceClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResourceService.class));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceClass() throws Exception {
  List<ResourceConfig> resourceConfigs=getResourceConfigs();
  Assert.assertEquals(2,resourceConfigs.size());
  Assert.assertTrue(resourceConfigs.get(0).getResourceClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResource.class));
  Assert.assertTrue(resourceConfigs.get(1).getResourceClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResource.class));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProviderClass() throws Exception {
  List<ResourceConfig> resourceConfigs=getResourceConfigs();
  Assert.assertEquals(2,resourceConfigs.size());
  Assert.assertTrue(resourceConfigs.get(0).getProviderClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResourceProvider.class));
  Assert.assertTrue(resourceConfigs.get(1).getProviderClass(getClass().getClassLoader()).equals(ViewConfigTest.MyResourceProvider.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.ViewConfigTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIsSystem() throws Exception {
  ViewConfig config=getConfig(system_xml);
  Assert.assertTrue(config.isSystem());
  config=getConfig(non_system_xml);
  Assert.assertFalse(config.isSystem());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.validation.InstanceValidationResultImplTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyResults() throws Exception {
  ValidationResult result=new ValidationResultImpl(true,"detail");
  Map<String,ValidationResult> propertyResults=new HashMap<String,ValidationResult>();
  propertyResults.put("foo",new ValidationResultImpl(true,"foo detail"));
  propertyResults.put("bar",new ValidationResultImpl(false,"bar detail"));
  InstanceValidationResultImpl instanceValidationResult=new InstanceValidationResultImpl(result,propertyResults);
  propertyResults=instanceValidationResult.getPropertyResults();
  Assert.assertEquals(2,propertyResults.size());
  Assert.assertTrue(propertyResults.containsKey("foo"));
  Assert.assertTrue(propertyResults.containsKey("bar"));
  Assert.assertTrue(propertyResults.get("foo").isValid());
  Assert.assertFalse(propertyResults.get("bar").isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.validation.ValidationResultImplTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  ValidationResult result=ValidationResultImpl.create(new ValidationResultImpl(true,"is true"));
  Assert.assertTrue(result.isValid());
  Assert.assertEquals("is true",result.getDetail());
  result=ValidationResultImpl.create(new ValidationResultImpl(false,"is false"));
  Assert.assertFalse(result.isValid());
  Assert.assertEquals("is false",result.getDetail());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsValid() throws Exception {
  ValidationResult result=new ValidationResultImpl(true,"detail");
  Assert.assertTrue(result.isValid());
  result=new ValidationResultImpl(false,"detail");
  Assert.assertFalse(result.isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.shell.commands.ClusterCommandsTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterPreviewCommandAvailable(){
  when(context.isFocusOnClusterBuild()).thenReturn(true);
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",singletonMap("group1",asList("host1")));
  boolean result=clusterCommands.isClusterPreviewCommandAvailable();
  assertTrue(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreateCluster() throws HttpResponseException {
  String blueprint="blueprint";
  Map<String,List<String>> map=singletonMap("group1",asList("host","host2"));
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",map);
  when(context.getFocusValue()).thenReturn(blueprint);
  when(client.getClusterName()).thenReturn("cluster");
  String result=clusterCommands.createCluster(false);
  verify(client).createCluster(blueprint,blueprint,map);
  verify(context).resetFocus();
  assertFalse(result.contains("Failed"));
  assertTrue(result.contains("Successfully"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterBuildCommandAvailableAndFocusOnBuild(){
  when(context.isConnectedToCluster()).thenReturn(false);
  when(context.isFocusOnClusterBuild()).thenReturn(true);
  when(context.areBlueprintsAvailable()).thenReturn(true);
  boolean result=clusterCommands.isClusterBuildCommandAvailable();
  assertFalse(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCreateClusterForException() throws HttpResponseException {
  String blueprint="blueprint";
  Map<String,List<String>> map=singletonMap("group1",asList("host","host2"));
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",map);
  when(context.getFocusValue()).thenReturn(blueprint);
  doThrow(responseException).when(client).createCluster(blueprint,blueprint,map);
  doThrow(responseException).when(client).deleteCluster(blueprint);
  String result=clusterCommands.createCluster(false);
  verify(client).createCluster(blueprint,blueprint,map);
  verify(client).getHostGroups(blueprint);
  verify(client).deleteCluster(blueprint);
  assertTrue(result.contains("Failed"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterBuildCommandAvailableAndNoBlueprints(){
  when(context.isConnectedToCluster()).thenReturn(false);
  when(context.isFocusOnClusterBuild()).thenReturn(false);
  when(context.areBlueprintsAvailable()).thenReturn(false);
  boolean result=clusterCommands.isClusterBuildCommandAvailable();
  assertFalse(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterBuildCommandAvailable(){
  when(context.isConnectedToCluster()).thenReturn(false);
  when(context.isFocusOnClusterBuild()).thenReturn(false);
  when(context.areBlueprintsAvailable()).thenReturn(true);
  boolean result=clusterCommands.isClusterBuildCommandAvailable();
  assertTrue(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterResetCommandAvailable(){
  when(context.isFocusOnClusterBuild()).thenReturn(true);
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",singletonMap("group1",asList("host1")));
  boolean result=clusterCommands.isClusterResetCommandAvailable();
  assertTrue(result);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsClusterPreviewCommandAvailableForNoAssignments(){
  when(context.isFocusOnClusterBuild()).thenReturn(true);
  ReflectionTestUtils.setField(clusterCommands,"hostGroups",singletonMap("group1",emptyList()));
  boolean result=clusterCommands.isClusterPreviewCommandAvailable();
  assertFalse(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.capacityscheduler.PropertyValidatorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void shouldValidateUrlWithNonStandardTLDs() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://cl1-node.nova:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertTrue(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void shouldValidateLocalhost() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://localhost:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertTrue(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyNoCluster() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://hostname.com:8080");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyHttps() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("https://hostname.com:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertTrue(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyNoPort() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://hostname.com/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyOk() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://hostname.com:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertTrue(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyNoClusterName() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://hostname.com:8080/api/v1/clusters/");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyNoProtocol() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("hostname.com:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyOnlyHostname() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("hostname.com");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void shouldValidateUrlsWithHyphenInHostName() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://sub-domain.hostname.com:8080/api/v1/clusters/Cluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertTrue(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyMisspell() throws Exception {
  ViewInstanceDefinition instanceDefinition=getViewInstanceDefinition("http://hostname.com:8080/api/v1/clAsters/MyCluster");
  PropertyValidator propertyValidator=new PropertyValidator();
  assertFalse(propertyValidator.validateProperty(PropertyValidator.AMBARI_SERVER_URL,instanceDefinition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.filebrowser.FilebrowserTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListDir() throws Exception {
  FileOperationService.MkdirRequest request=new FileOperationService.MkdirRequest();
  request.path="/tmp1";
  fileBrowserService.fileOps().mkdir(request);
  Response response=fileBrowserService.fileOps().listdir("/");
  JSONObject responseObject=(JSONObject)response.getEntity();
  JSONArray statuses=(JSONArray)responseObject.get("files");
  System.out.println(response.getEntity());
  Assert.assertEquals(200,response.getStatus());
  Assert.assertTrue(statuses.size() > 0);
  System.out.println(statuses);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.PropertyValidatorTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyWebHDFSCom() throws Exception {
  PropertyValidator validator=new PropertyValidator();
  ViewInstanceDefinition definition=getViewInstanceDefinition();
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"hdfs://hostname.com:8020");
  assertTrue(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"webhdfs://hostname.com:50070");
  assertTrue(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"http://hostname.com:50070");
  assertFalse(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyWebHDFSInternal() throws Exception {
  PropertyValidator validator=new PropertyValidator();
  ViewInstanceDefinition definition=getViewInstanceDefinition();
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"hdfs://hostname.internal:8020");
  assertTrue(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"webhdfs://hostname.internal:50070");
  assertTrue(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
  definition.getPropertyMap().put(PropertyValidator.WEBHDFS_URL,"http://hostname.internal:50070");
  assertFalse(validator.validateProperty(PropertyValidator.WEBHDFS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyATSCom() throws Exception {
  PropertyValidator validator=new PropertyValidator();
  ViewInstanceDefinition definition=getViewInstanceDefinition();
  definition.getPropertyMap().put(PropertyValidator.YARN_ATS_URL,"http://hostname.com:8088");
  assertTrue(validator.validateProperty(PropertyValidator.YARN_ATS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidatePropertyATSInternal() throws Exception {
  PropertyValidator validator=new PropertyValidator();
  ViewInstanceDefinition definition=getViewInstanceDefinition();
  definition.getPropertyMap().put(PropertyValidator.YARN_ATS_URL,"http://hostname.internal:8088");
  assertTrue(validator.validateProperty(PropertyValidator.YARN_ATS_URL,definition,Validator.ValidationContext.PRE_CREATE).isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.files.FileServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFakeFile() throws IOException, InterruptedException {
  String content="Fake file content";
  String encodedContent=Base64.encodeBase64String(content.getBytes());
  String filepath="fakefile://" + encodedContent;
  Response response=fileService.getFilePage(filepath,0l);
  ServiceTestUtils.assertHTTPResponseOK(response);
  JSONObject obj=((JSONObject)response.getEntity());
  assertFileJsonResponseSanity(obj);
  FileResource fileResource=(FileResource)obj.get("file");
  Assert.assertEquals(content,fileResource.getFileContent());
  Assert.assertEquals(0,fileResource.getPage());
  Assert.assertFalse(fileResource.isHasNext());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJsonFakeFile() throws IOException, InterruptedException, Exception {
  String content="{\"queryText\":\"Query Content\"}";
  String url="http://fileurl/content#queryText";
  String filepath="jsonpath:" + url;
  URLStreamProvider urlStreamProvider=createNiceMock(URLStreamProvider.class);
  InputStream inputStream=IOUtils.toInputStream(content);
  reset(context);
  expect(context.getProperties()).andReturn(properties).anyTimes();
  expect(context.getURLStreamProvider()).andReturn(urlStreamProvider);
  expect(urlStreamProvider.readFrom(eq(url),eq("GET"),anyString(),EasyMock.<Map<String,String>>anyObject())).andReturn(inputStream);
  fileService=getService(FileService.class,handler,context);
  replay(context,urlStreamProvider);
  Response response=fileService.getFilePage(filepath,0l);
  ServiceTestUtils.assertHTTPResponseOK(response);
  JSONObject obj=((JSONObject)response.getEntity());
  assertFileJsonResponseSanity(obj);
  FileResource fileResource=(FileResource)obj.get("file");
  Assert.assertEquals("Query Content",fileResource.getFileContent());
  Assert.assertEquals(0,fileResource.getPage());
  Assert.assertFalse(fileResource.isHasNext());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPagination() throws Exception {
  createFile("/tmp/testPagination","1234567890");
  Response response=fileService.getFilePage("/tmp/testPagination",0L);
  ServiceTestUtils.assertHTTPResponseOK(response);
  JSONObject obj=((JSONObject)response.getEntity());
  assertFileJsonResponseSanity(obj);
  FileResource firstPage=(FileResource)obj.get("file");
  Assert.assertEquals("1234",firstPage.getFileContent());
  Assert.assertEquals(3,firstPage.getPageCount());
  Assert.assertEquals(0,firstPage.getPage());
  Assert.assertTrue(firstPage.isHasNext());
  Assert.assertEquals("/tmp/testPagination",firstPage.getFilePath());
  response=fileService.getFilePage("/tmp/testPagination",1L);
  ServiceTestUtils.assertHTTPResponseOK(response);
  FileResource secondPage=(FileResource)((JSONObject)response.getEntity()).get("file");
  Assert.assertEquals("5678",secondPage.getFileContent());
  Assert.assertEquals(1,secondPage.getPage());
  Assert.assertTrue(secondPage.isHasNext());
  response=fileService.getFilePage("/tmp/testPagination",2L);
  ServiceTestUtils.assertHTTPResponseOK(response);
  FileResource thirdPage=(FileResource)((JSONObject)response.getEntity()).get("file");
  Assert.assertEquals("90",thirdPage.getFileContent());
  Assert.assertEquals(2,thirdPage.getPage());
  Assert.assertFalse(thirdPage.isHasNext());
  thrown.expect(BadRequestFormattedException.class);
  fileService.getFilePage("/tmp/testPagination",3L);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZeroLengthFile() throws Exception {
  createFile("/tmp/testZeroLengthFile","");
  Response response=fileService.getFilePage("/tmp/testZeroLengthFile",0L);
  ServiceTestUtils.assertHTTPResponseOK(response);
  JSONObject obj=((JSONObject)response.getEntity());
  assertFileJsonResponseSanity(obj);
  FileResource fileResource=(FileResource)obj.get("file");
  Assert.assertEquals("",fileResource.getFileContent());
  Assert.assertEquals(0,fileResource.getPage());
  Assert.assertFalse(fileResource.isHasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.jobs.ATSParserTest </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHiveJobsList() throws Exception {
  IATSParser jobLoader=new ATSParser(new ATSRequestsDelegateStub());
  List<HiveQueryId> jobs=jobLoader.getHiveQueryIdsList("hive");
  Assert.assertEquals(1,jobs.size());
  HiveQueryId job=jobs.get(0);
  Assert.assertEquals("hive_20150209144848_c3a5a07b-c3b6-4f57-a6d5-3dadecdd6fd0",job.entity);
  Assert.assertEquals(1423493324L,job.starttime);
  Assert.assertEquals("hive",job.user);
  Assert.assertEquals(1423493342L - 1423493324L,job.duration);
  Assert.assertEquals("select count(*) from z",job.query);
  Assert.assertEquals(1,job.dagNames.size());
  Assert.assertEquals("hive_20150209144848_c3a5a07b-c3b6-4f57-a6d5-3dadecdd6fd0:4",job.dagNames.get(0));
  Assert.assertEquals(2,job.stages.size());
  Assert.assertTrue(HiveQueryId.ATS_15_RESPONSE_VERSION > job.version);
  jobLoader=new ATSParser(new ATSV15RequestsDelegateStub());
  List<HiveQueryId> jobsv2=jobLoader.getHiveQueryIdsList("hive");
  Assert.assertEquals(1,jobsv2.size());
  HiveQueryId jobv2=jobsv2.get(0);
  Assert.assertTrue(HiveQueryId.ATS_15_RESPONSE_VERSION <= jobv2.version);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.resources.FileResourceServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createFileResourceItem(){
  Response response=doCreateFileResourceItem();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("fileResource"));
  Assert.assertNotNull(((FileResourceItem)obj.get("fileResource")).getId());
  Assert.assertFalse(((FileResourceItem)obj.get("fileResource")).getId() == null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateFileResourceItem(){
  Response createdFileResourceItem=doCreateFileResourceItem();
  Object createdUdfId=((FileResourceItem)((JSONObject)createdFileResourceItem.getEntity()).get("fileResource")).getId();
  FileResourceService.ResourceRequest request=new FileResourceService.ResourceRequest();
  request.fileResource=new FileResourceItem();
  request.fileResource.setPath("/tmp/updatedFileResourceItem.jar");
  request.fileResource.setName("TestFileResourceItem2");
  Response response=resourceService.update(request,String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=resourceService.getOne(String.valueOf(createdUdfId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("fileResource"));
  Assert.assertEquals(((FileResourceItem)obj.get("fileResource")).getName(),request.fileResource.getName());
  Assert.assertEquals(((FileResourceItem)obj.get("fileResource")).getPath(),request.fileResource.getPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.savedQueries.SavedQueryServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSavedQuery(){
  Response response=doCreateSavedQuery();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertNotNull(((SavedQuery)obj.get("savedQuery")).getId());
  Assert.assertTrue(((SavedQuery)obj.get("savedQuery")).getId() != null);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void list(){
  doCreateSavedQuery("Title 1","/path/to/file.hql");
  doCreateSavedQuery("Title 2","/path/to/file.hql");
  Response response=savedQueryService.getList();
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("savedQueries"));
  List<SavedQuery> items=(List<SavedQuery>)obj.get("savedQueries");
  boolean containsTitle=false;
  for (  SavedQuery item : items)   containsTitle=containsTitle || item.getTitle().compareTo("Title 1") == 0;
  Assert.assertTrue(containsTitle);
  containsTitle=false;
  for (  SavedQuery item : items)   containsTitle=containsTitle || item.getTitle().compareTo("Title 2") == 0;
  Assert.assertTrue(containsTitle);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSavedQueryAutoCreate(){
  Response response=doCreateSavedQuery("Test",null);
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertNotNull(((SavedQuery)obj.get("savedQuery")).getId());
  Assert.assertFalse(((SavedQuery)obj.get("savedQuery")).getId() == null);
  Assert.assertFalse(((SavedQuery)obj.get("savedQuery")).getQueryFile().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void update(){
  Response created=doCreateSavedQuery();
  Object createdId=((SavedQuery)((JSONObject)created.getEntity()).get("savedQuery")).getId();
  SavedQueryService.SavedQueryRequest request=new SavedQueryService.SavedQueryRequest();
  request.savedQuery=new SavedQuery();
  request.savedQuery.setTitle("Updated Query");
  Response response=savedQueryService.update(request,String.valueOf(createdId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=savedQueryService.getOne(String.valueOf(createdId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertEquals(((SavedQuery)obj.get("savedQuery")).getTitle(),request.savedQuery.getTitle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.udfs.UDFServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createUDF(){
  Response response=doCreateUDF();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertNotNull(((UDF)obj.get("udf")).getId());
  Assert.assertFalse(((UDF)obj.get("udf")).getId() == null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateUDF(){
  Response createdUDF=doCreateUDF();
  Object createdUdfId=((UDF)((JSONObject)createdUDF.getEntity()).get("udf")).getId();
  UDFService.UDFRequest request=new UDFService.UDFRequest();
  request.udf=new UDF();
  request.udf.setClassname("/tmp/updatedUDF.jar");
  request.udf.setName("TestUDF2");
  Response response=udfService.update(request,String.valueOf(createdUdfId));
  Assert.assertEquals(204,response.getStatus());
  Response response2=udfService.getOne(String.valueOf(createdUdfId));
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertEquals(((UDF)obj.get("udf")).getName(),request.udf.getName());
  Assert.assertEquals(((UDF)obj.get("udf")).getClassname(),request.udf.getClassname());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.FileTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZeroLengthFile() throws Exception {
  String name=UUID.randomUUID().toString().replaceAll("-","");
  String filePath="/tmp/" + name;
  doCreateFile(name,"");
  Response response=fileService.getFile(filePath,0L,null);
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=((JSONObject)response.getEntity());
  Assert.assertEquals("",((FileResource)obj.get("file")).getFileContent());
  Assert.assertEquals(0,((FileResource)obj.get("file")).getPage());
  Assert.assertFalse(((FileResource)obj.get("file")).isHasNext());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFileContent() throws Exception {
  String name=UUID.randomUUID().toString().replaceAll("-","");
  String filePath="/tmp/" + name;
  Response createdFile=doCreateFile(name,"some content");
  FileService.FileResourceRequest request=new FileService.FileResourceRequest();
  request.file=new FileResource();
  request.file.setFilePath(filePath);
  request.file.setFileContent("1234567890");
  Response response=fileService.updateFile(request,filePath);
  Assert.assertEquals(204,response.getStatus());
  Response response2=fileService.getFile(filePath,0L,null);
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("file"));
  Assert.assertEquals("1234",((FileResource)obj.get("file")).getFileContent());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPagination() throws Exception {
  String name=UUID.randomUUID().toString().replaceAll("-","");
  String filePath="/tmp/" + name;
  doCreateFile(name,"1234567890");
  Response response=fileService.getFile(filePath,0L,null);
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=((JSONObject)response.getEntity());
  Assert.assertTrue(obj.containsKey("file"));
  Assert.assertEquals("1234",((FileResource)obj.get("file")).getFileContent());
  Assert.assertEquals(3,((FileResource)obj.get("file")).getPageCount());
  Assert.assertEquals(0,((FileResource)obj.get("file")).getPage());
  Assert.assertTrue(((FileResource)obj.get("file")).isHasNext());
  Assert.assertEquals(filePath,((FileResource)obj.get("file")).getFilePath());
  response=fileService.getFile(filePath,1L,null);
  Assert.assertEquals(200,response.getStatus());
  obj=((JSONObject)response.getEntity());
  Assert.assertEquals("5678",((FileResource)obj.get("file")).getFileContent());
  Assert.assertEquals(1,((FileResource)obj.get("file")).getPage());
  Assert.assertTrue(((FileResource)obj.get("file")).isHasNext());
  response=fileService.getFile(filePath,2L,null);
  Assert.assertEquals(200,response.getStatus());
  obj=((JSONObject)response.getEntity());
  Assert.assertEquals("90",((FileResource)obj.get("file")).getFileContent());
  Assert.assertEquals(2,((FileResource)obj.get("file")).getPage());
  Assert.assertFalse(((FileResource)obj.get("file")).isHasNext());
  thrown.expect(BadRequestFormattedException.class);
  fileService.getFile(filePath,3L,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.HelpTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void configTest(){
  Response response=helpService.config();
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("webhdfs.url"));
  Assert.assertEquals(hdfsURI,obj.get("webhdfs.url"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.JobTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobStatusFlow() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  data.id="job_id_#";
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  PigJob job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  reset(api);
  TempletonApi.JobInfo info=api.new JobInfo();
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_RUNNING);
  info.percentComplete="30% complete";
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  Assert.assertEquals(30,(Object)job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_SUCCEEDED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_COMPLETED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  Assert.assertNull(job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_PREP);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_FAILED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_FAILED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_KILLED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_KILLED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJobNoArguments() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),(String)isNull())).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig",null,jobService);
  Assert.assertEquals("",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSubmitJobUsernameProvided() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  properties.put("dataworker.username","luke");
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListJobs() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream).anyTimes();
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),(String)isNull())).andReturn(data).anyTimes();
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig",null,null,"x42",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=doCreateJob("Test","/tmp/script.pig",null,null,"x42",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=doCreateJob("Test","/tmp/script.pig",null,null,"100",jobService);
  Assert.assertEquals(201,response.getStatus());
  response=jobService.getJobList("x42");
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("jobs"));
  Assert.assertEquals(2,((List)obj.get("jobs")).size());
  response=jobService.getJobList(null);
  Assert.assertEquals(200,response.getStatus());
  obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("jobs"));
  Assert.assertTrue(((List)obj.get("jobs")).size() > 2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJob() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.ScriptTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createScript(){
  Response response=doCreateScript();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("script"));
  Assert.assertNotNull(((PigScript)obj.get("script")).getId());
  Assert.assertFalse(((PigScript)obj.get("script")).getId().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateScript(){
  Response createdScript=doCreateScript();
  String createdScriptId=((PigScript)((JSONObject)createdScript.getEntity()).get("script")).getId();
  ScriptService.PigScriptRequest request=new ScriptService.PigScriptRequest();
  request.script=new PigScript();
  request.script.setTitle("Updated Script");
  Response response=scriptService.updateScript(request,createdScriptId);
  Assert.assertEquals(204,response.getStatus());
  Response response2=scriptService.getScript(createdScriptId);
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("script"));
  Assert.assertEquals(((PigScript)obj.get("script")).getTitle(),request.script.getTitle());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listScripts(){
  Response createdScript1=doCreateScript("Title 1","/path/to/file.pig");
  Response createdScript2=doCreateScript("Title 2","/path/to/file.pig");
  String createdScriptId=((PigScript)((JSONObject)createdScript1.getEntity()).get("script")).getId();
  Response response=scriptService.getScriptList();
  Assert.assertEquals(200,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("scripts"));
  List<PigScript> scripts=(List<PigScript>)obj.get("scripts");
  boolean containsTitle=false;
  for (  PigScript script : scripts)   containsTitle=containsTitle || script.getTitle().compareTo("Title 1") == 0;
  Assert.assertTrue(containsTitle);
  containsTitle=false;
  for (  PigScript script : scripts)   containsTitle=containsTitle || script.getTitle().compareTo("Title 2") == 0;
  Assert.assertTrue(containsTitle);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createScriptAutoCreate(){
  Response response=doCreateScript("Test",null);
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("script"));
  Assert.assertNotNull(((PigScript)obj.get("script")).getId());
  Assert.assertFalse(((PigScript)obj.get("script")).getId().isEmpty());
  Assert.assertFalse(((PigScript)obj.get("script")).getPigScript().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.ScriptTestHDFSUnmanaged </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void createScriptAutoCreateUsername() throws IOException, InterruptedException {
  Map<String,String> properties=new HashMap<String,String>();
  baseDir=new File(DATA_DIRECTORY).getAbsoluteFile();
  pigStorageFile=new File("./target/BasePigTest/storage.dat").getAbsoluteFile();
  properties.put("dataworker.storagePath",pigStorageFile.toString());
  properties.put("scripts.dir","/tmp/.pigscripts");
  properties.put("webhdfs.url",hdfsURI);
  expect(context.getProperties()).andReturn(properties).anyTimes();
  expect(context.getUsername()).andReturn("ambari-qa").anyTimes();
  replay(handler,context);
  scriptService=getService(ScriptService.class,handler,context);
  Response createdScript=doCreateScript("Test",null);
  String createdScriptPath=((PigScript)((JSONObject)createdScript.getEntity()).get("script")).getPigScript();
  Assert.assertTrue(createdScriptPath.startsWith("/tmp/.pigscripts/"));
  properties.put("dataworker.username","luke");
  Response createdScript2=doCreateScript("Test",null);
  String createdScriptPath2=((PigScript)((JSONObject)createdScript2.getEntity()).get("script")).getPigScript();
  Assert.assertTrue(createdScriptPath2.startsWith("/tmp/.pigscripts/"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.UDFTest </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateUDF(){
  Response createdUDF=doCreateUDF();
  String createdUdfId=((UDF)((JSONObject)createdUDF.getEntity()).get("udf")).getId();
  UDFService.UDFRequest request=new UDFService.UDFRequest();
  request.udf=new UDF();
  request.udf.setPath("/tmp/updatedUDF.jar");
  request.udf.setName("TestUDF2");
  Response response=udfService.updateUDF(request,createdUdfId);
  Assert.assertEquals(204,response.getStatus());
  Response response2=udfService.getUDF(createdUdfId);
  Assert.assertEquals(200,response2.getStatus());
  JSONObject obj=((JSONObject)response2.getEntity());
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertEquals(((UDF)obj.get("udf")).getName(),request.udf.getName());
  Assert.assertEquals(((UDF)obj.get("udf")).getPath(),request.udf.getPath());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createUDF(){
  Response response=doCreateUDF();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertNotNull(((UDF)obj.get("udf")).getId());
  Assert.assertFalse(((UDF)obj.get("udf")).getId().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.sink.SqlServerSinkTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEnsureConnection() throws Exception {
  SubsetConfiguration configuration=createNiceMock(SubsetConfiguration.class);
  Connection connection=createNiceMock(Connection.class);
  expect(configuration.getParent()).andReturn(null);
  expect(configuration.getPrefix()).andReturn("prefix");
  expect(configuration.getString("databaseUrl")).andReturn("url");
  replay(configuration,connection);
  SqlServerSink sink=createInstance();
  sink.init(configuration);
  Assert.assertTrue(sink.ensureConnection());
  SQLServerDriver.setConnection(connection);
  Assert.assertTrue(sink.ensureConnection());
  verify(configuration,connection);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.sink.kafka.KafkaTimelineMetricsReporterTest </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMetricsExclusionPolicy() throws Exception {
  mockStatic(Metrics.class);
  EasyMock.expect(Metrics.defaultRegistry()).andReturn(registry).times(2);
  TimelineMetricsCache timelineMetricsCache=getTimelineMetricsCache(kafkaTimelineMetricsReporter);
  kafkaTimelineMetricsReporter.setMetricsCache(timelineMetricsCache);
  replay(Metrics.class,timelineMetricsCache);
  kafkaTimelineMetricsReporter.init(props);
  Assert.assertTrue(kafkaTimelineMetricsReporter.isExcludedMetric("a.b.c"));
  Assert.assertFalse(kafkaTimelineMetricsReporter.isExcludedMetric("a.b"));
  Assert.assertFalse(kafkaTimelineMetricsReporter.isExcludedMetric("a.b.c.d"));
  Assert.assertFalse(kafkaTimelineMetricsReporter.isExcludedMetric("a.b.c.d.e"));
  kafkaTimelineMetricsReporter.stopReporter();
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestFileSystemApplicationHistoryStore </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMassiveWriteContainerHistoryData() throws IOException {
  long mb=1024 * 1024;
  long usedDiskBefore=fs.getContentSummary(fsWorkingPath).getLength() / mb;
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  for (int i=1; i <= 100000; ++i) {
    ContainerId containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  writeApplicationFinishData(appId);
  long usedDiskAfter=fs.getContentSummary(fsWorkingPath).getLength() / mb;
  Assert.assertTrue((usedDiskAfter - usedDiskBefore) < 20);
}

</code></pre>

<br>
<pre class="type-10 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteAfterApplicationFinish() throws IOException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is not opened"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestMemoryApplicationHistoryStore </h4><pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationAttemptHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numAppAttempts=5;
  writeApplicationStartData(appId);
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    writeApplicationAttemptStartData(appAttemptId);
    writeApplicationAttemptFinishData(appAttemptId);
  }
  Assert.assertEquals(numAppAttempts,store.getApplicationAttempts(appId).size());
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    ApplicationAttemptHistoryData data=store.getApplicationAttempt(appAttemptId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appAttemptId.toString(),data.getHost());
    Assert.assertEquals(appAttemptId.toString(),data.getDiagnosticsInfo());
  }
  writeApplicationFinishData(appId);
  appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numApps=5;
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    writeApplicationStartData(appId);
    writeApplicationFinishData(appId);
  }
  Assert.assertEquals(numApps,store.getAllApplications().size());
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    ApplicationHistoryData data=store.getApplication(appId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appId.toString(),data.getApplicationName());
    Assert.assertEquals(appId.toString(),data.getDiagnosticsInfo());
  }
  appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationStartData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteContainerHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  writeApplicationAttemptStartData(appAttemptId);
  int numContainers=5;
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  Assert.assertEquals(numContainers,store.getContainers(appAttemptId).size());
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    ContainerHistoryData data=store.getContainer(containerId);
    Assert.assertNotNull(data);
    Assert.assertEquals(Priority.newInstance(containerId.getId()),data.getPriority());
    Assert.assertEquals(containerId.toString(),data.getDiagnosticsInfo());
  }
  ContainerHistoryData masterContainer=store.getAMContainer(appAttemptId);
  Assert.assertNotNull(masterContainer);
  Assert.assertEquals(ContainerId.newInstance(appAttemptId,1),masterContainer.getContainerId());
  writeApplicationAttemptFinishData(appAttemptId);
  containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testMassiveWriteContainerHistory() throws IOException {
  long mb=1024 * 1024;
  Runtime runtime=Runtime.getRuntime();
  long usedMemoryBefore=(runtime.totalMemory() - runtime.freeMemory()) / mb;
  int numContainers=100000;
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  for (int i=1; i <= numContainers; ++i) {
    ContainerId containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  long usedMemoryAfter=(runtime.totalMemory() - runtime.freeMemory()) / mb;
  Assert.assertTrue((usedMemoryAfter - usedMemoryBefore) < 200);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.loadsimulator.util.TestRandomMetricsProvider </h4><pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testReturnSingle(){
  double from=5.25;
  double to=5.40;
  RandomMetricsProvider provider=new RandomMetricsProvider(from,to);
  double metric=provider.next();
  assertTrue("Generated metric should be in range",from < metric && metric < to);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.ITPhoenixHBaseAccessor </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordLatestWithFunction() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,new Configuration(),new TimelineMetricMetadataManager(hdb,new Configuration()));
  long startTime=System.currentTimeMillis();
  long ctime=startTime + 1;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute + 1;
  boolean success=agg.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),null,null,null,null,null,Precision.SECONDS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,Collections.singletonMap("disk_free",Collections.singletonList(new Function(Function.ReadFunction.SUM,null))));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free._sum",metric.getMetricName());
  assertEquals(1,metric.getMetricValues().size());
  assertEquals(3,metric.getMetricValues().values().iterator().next().intValue());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordsSeconds() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,new Configuration(),new TimelineMetricMetadataManager(hdb,new Configuration()));
  long startTime=System.currentTimeMillis();
  long ctime=startTime + 1;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  ctime+=minute;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",1));
  long endTime=ctime + minute + 1;
  boolean success=agg.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),null,null,null,startTime,endTime,Precision.SECONDS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,singletonValueFunctionMap("disk_free"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free",metric.getMetricName());
  assertEquals(5,metric.getMetricValues().size());
  assertEquals(1.5,metric.getMetricValues().values().iterator().next(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricRecordsHours() throws IOException, SQLException {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorHourly(hdb,new Configuration());
  MetricHostAggregate expectedAggregate=createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  long startTime=System.currentTimeMillis();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_MINUTE_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_used"),Collections.singletonList("test_host"),"test_app",null,startTime,endTime,Precision.HOURS,null,true);
  TimelineMetrics timelineMetrics=hdb.getMetricRecords(condition,singletonValueFunctionMap("disk_used"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_used",metric.getMetricName());
  assertEquals("test_host",metric.getHostName());
  assertEquals(1,metric.getMetricValues().size());
  Iterator<Map.Entry<Long,Double>> iterator=metric.getMetricValues().entrySet().iterator();
  assertEquals(0.75,iterator.next().getValue(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterMetricRecordsHours() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorHourly(hdb,new Configuration());
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  Map<TimelineClusterMetric,MetricClusterAggregate> records=new HashMap<TimelineClusterMetric,MetricClusterAggregate>();
  records.put(createEmptyTimelineClusterMetric(ctime),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=minute),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  hdb.saveClusterAggregateRecords(records);
  boolean success=agg.doWork(startTime,ctime + minute);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_used"),null,null,null,startTime,ctime + minute,Precision.HOURS,null,true);
  TimelineMetrics timelineMetrics=hdb.getAggregateMetricRecords(condition,singletonValueFunctionMap("disk_used"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_used",metric.getMetricName());
  assertEquals("test_app",metric.getAppId());
  assertEquals(1,metric.getMetricValues().size());
  assertEquals(2.0,metric.getMetricValues().values().iterator().next(),0.00001);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricRecordsMinutes() throws IOException, SQLException {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,new Configuration());
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","disk_free",1));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime + minute,"local1","disk_free",2));
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","disk_free",2));
  long endTime=ctime + minute;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(Collections.singletonList("disk_free"),Collections.singletonList("local1"),null,null,startTime,endTime,Precision.MINUTES,null,false);
  TimelineMetrics timelineMetrics=hdb.getMetricRecords(condition,singletonValueFunctionMap("disk_free"));
  assertEquals(1,timelineMetrics.getMetrics().size());
  TimelineMetric metric=timelineMetrics.getMetrics().get(0);
  assertEquals("disk_free",metric.getMetricName());
  assertEquals("local1",metric.getHostName());
  assertEquals(1,metric.getMetricValues().size());
  Iterator<Map.Entry<Long,Double>> iterator=metric.getMetricValues().entrySet().iterator();
  assertEquals(1.5,iterator.next().getValue(),0.00001);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.TestPhoenixTransactSQL </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareGetMetricsNoPrecision() throws SQLException {
  Long endTime=1407959918L;
  Long startTime=endTime - 200;
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD"));
  Assert.assertEquals(Precision.SECONDS,condition.getPrecision());
  verify(connection,preparedStatement);
  reset(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.HOUR * 2 / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD"));
  Assert.assertEquals(Precision.SECONDS,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD_MINUTE"));
  Assert.assertEquals(Precision.MINUTES,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY * 30 / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD_HOURLY"));
  Assert.assertEquals(Precision.HOURS,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY * 30 * 2 / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD_DAILY"));
  Assert.assertEquals(Precision.DAYS,condition.getPrecision());
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetAggregatePrecisionHours() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,Precision.HOURS,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE_HOURLY"));
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetLatestMetricSqlStmtMultipleHostNames() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Arrays.asList("h1","h2"),"a1","i1",null,null,null,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  ParameterMetaData parameterMetaData=createNiceMock(ParameterMetaData.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  expect(preparedStatement.getParameterMetaData()).andReturn(parameterMetaData).once();
  expect(parameterMetaData.getParameterCount()).andReturn(6).once();
  replay(connection,preparedStatement,parameterMetaData);
  PhoenixTransactSQL.prepareGetLatestMetricSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD"));
  Assert.assertTrue(stmt.contains("JOIN"));
  verify(connection,preparedStatement,parameterMetaData);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetMetricsPrecisionHours() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,Precision.HOURS,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD_HOURLY"));
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetAggregatePrecisionMINUTES() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,Precision.MINUTES,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE"));
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareGetAggregateNoPrecision() throws SQLException {
  Long endTime=1407959918L;
  Long startTime=1407959718L;
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE"));
  Assert.assertEquals(Precision.SECONDS,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE"));
  Assert.assertEquals(Precision.MINUTES,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY * 30 / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE_HOURLY"));
  Assert.assertEquals(Precision.HOURS,condition.getPrecision());
  verify(connection,preparedStatement);
  startTime=endTime - PhoenixTransactSQL.DAY * 30 * 2 / 1000;
  condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",startTime,endTime,null,null,false);
  connection=createNiceMock(Connection.class);
  preparedStatement=createNiceMock(PreparedStatement.class);
  stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetAggregateSqlStmt(connection,condition);
  stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_AGGREGATE_DAILY"));
  Assert.assertEquals(Precision.DAYS,condition.getPrecision());
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetLatestMetricSqlStmtSortMergeJoinAlgorithm() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Arrays.asList("h1"),"a1","i1",null,null,null,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  ParameterMetaData parameterMetaData=createNiceMock(ParameterMetaData.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  expect(preparedStatement.getParameterMetaData()).andReturn(parameterMetaData).anyTimes();
  expect(parameterMetaData.getParameterCount()).andReturn(6).anyTimes();
  replay(connection,preparedStatement,parameterMetaData);
  PhoenixTransactSQL.setSortMergeJoinEnabled(true);
  PhoenixTransactSQL.prepareGetLatestMetricSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("/*+ USE_SORT_MERGE_JOIN NO_CACHE */"));
}

</code></pre>

<br>
<pre class="type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrepareGetMetricsPrecisionMinutes() throws SQLException {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,Precision.MINUTES,null,false);
  Connection connection=createNiceMock(Connection.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  Capture<String> stmtCapture=new Capture<String>();
  expect(connection.prepareStatement(EasyMock.and(EasyMock.anyString(),EasyMock.capture(stmtCapture)))).andReturn(preparedStatement);
  replay(connection,preparedStatement);
  PhoenixTransactSQL.prepareGetMetricsSqlStmt(connection,condition);
  String stmt=stmtCapture.getValue();
  Assert.assertTrue(stmt.contains("FROM METRIC_RECORD_MINUTE"));
  verify(connection,preparedStatement);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITClusterAggregator </h4><pre class="type-12 type-13 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateClusterOnMinuteProperly() throws Exception {
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorMinute(hdb,getConfigurationForTest(false));
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long second=1000;
  long minute=60 * second;
  Map<TimelineClusterMetric,MetricClusterAggregate> records=new HashMap<TimelineClusterMetric,MetricClusterAggregate>();
  records.put(createEmptyTimelineClusterMetric(ctime),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  hdb.saveClusterAggregateRecords(records);
  agg.doWork(startTime,ctime + second);
  long oldCtime=ctime + second;
  ctime=startTime + minute;
  records.put(createEmptyTimelineClusterMetric(ctime),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  records.put(createEmptyTimelineClusterMetric(ctime+=second),new MetricClusterAggregate(4.0,2,0.0,4.0,0.0));
  hdb.saveClusterAggregateRecords(records);
  agg.doWork(oldCtime,ctime + second);
  ResultSet rs=executeQuery("SELECT * FROM METRIC_AGGREGATE_MINUTE");
  int count=0;
  long diff=0;
  while (rs.next()) {
    assertEquals("METRIC_NAME","disk_used",rs.getString("METRIC_NAME"));
    assertEquals("APP_ID","test_app",rs.getString("APP_ID"));
    assertEquals("METRIC_SUM",16.0,rs.getDouble("METRIC_SUM"));
    assertEquals("METRIC_COUNT",8,rs.getLong("METRIC_COUNT"));
    assertEquals("METRIC_MAX",4.0,rs.getDouble("METRIC_MAX"));
    assertEquals("METRIC_MIN",0.0,rs.getDouble("METRIC_MIN"));
    if (count == 0) {
      diff+=rs.getLong("SERVER_TIME");
    }
 else {
      diff-=rs.getLong("SERVER_TIME");
      if (diff < 0) {
        diff*=-1;
      }
      assertTrue(diff == minute);
    }
    count++;
  }
  assertEquals("One hourly aggregated row expected ",2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITMetricAggregator </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAggregateHourProperly() throws Exception {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorHourly(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_MINUTE_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_HOURLY_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(12 * 20,currentHostAggregate.getNumberOfSamples());
      assertEquals(12 * 15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-10 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregationUsingGroupByQuery() throws Exception {
  TimelineMetricAggregator aggregatorMinute=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorMinute(hdb,getConfigurationForTest(true));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareTimelineMetrics(startTime,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  hdb.insertMetricRecords(prepareTimelineMetrics(ctime+=minute,"local"));
  long endTime=startTime + 1000 * 60 * 4;
  boolean success=aggregatorMinute.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_MINUTE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  int count=0;
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else     if ("mem_free".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(20,currentHostAggregate.getNumberOfSamples());
      assertEquals(15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
      count++;
    }
 else {
      fail("Unexpected entry");
    }
  }
  assertEquals("Two aggregated entries expected",2,count);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricAggregateDaily() throws Exception {
  TimelineMetricAggregator aggregator=TimelineMetricAggregatorFactory.createTimelineMetricAggregatorDaily(hdb,getConfigurationForTest(false));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  MetricHostAggregate expectedAggregate=MetricTestHelper.createMetricHostAggregate(2.0,0.0,20,15.0);
  Map<TimelineMetric,MetricHostAggregate> aggMap=new HashMap<TimelineMetric,MetricHostAggregate>();
  int min_5=5 * 60 * 1000;
  long ctime=startTime - min_5;
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  aggMap.put(createEmptyTimelineMetric(ctime+=min_5),expectedAggregate);
  hdb.saveHostAggregateRecords(aggMap,METRICS_AGGREGATE_HOURLY_TABLE_NAME);
  long endTime=ctime + min_5;
  boolean success=aggregator.doWork(startTime,endTime);
  assertTrue(success);
  Condition condition=new DefaultCondition(null,null,null,null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_METRIC_AGGREGATE_ONLY_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_AGGREGATE_DAILY_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  while (rs.next()) {
    TimelineMetric currentMetric=readHelper.getTimelineMetricKeyFromResultSet(rs);
    MetricHostAggregate currentHostAggregate=readHelper.getMetricHostAggregateFromResultSet(rs);
    if ("disk_used".equals(currentMetric.getMetricName())) {
      assertEquals(2.0,currentHostAggregate.getMax());
      assertEquals(0.0,currentHostAggregate.getMin());
      assertEquals(12 * 20,currentHostAggregate.getNumberOfSamples());
      assertEquals(12 * 15.0,currentHostAggregate.getSum());
      assertEquals(15.0 / 20,currentHostAggregate.getAvg());
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
